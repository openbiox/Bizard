[
  {
    "objectID": "Ranking/BarPlot.html",
    "href": "Ranking/BarPlot.html",
    "title": "条形图",
    "section": "",
    "text": "条形图是用条形的高度或长短来表示数据多少的图形。",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Bar Plot"
    ]
  },
  {
    "objectID": "Ranking/BarPlot.html#示例",
    "href": "Ranking/BarPlot.html#示例",
    "title": "条形图",
    "section": "示例",
    "text": "示例\n\n\n\n\n\n正如上图，各组条形分别反映了五种基因的表达情况。",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Bar Plot"
    ]
  },
  {
    "objectID": "Ranking/BarPlot.html#环境配置",
    "href": "Ranking/BarPlot.html#环境配置",
    "title": "条形图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：magrittr; tidyr; ggplot2; cowplot; forcats; dplyr; hrbrthemes; ggpattern; rstatix; ggpubr\n\n\n# 安装包\nif (!requireNamespace(\"magrittr\", quietly = TRUE)) {\n  install.packages(\"magrittr\")\n}\nif (!requireNamespace(\"tidyr\", quietly = TRUE)) {\n  install.packages(\"tidyr\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"cowplot\", quietly = TRUE)) {\n  install.packages(\"cowplot\")\n}\nif (!requireNamespace(\"forcats\", quietly = TRUE)) {\n  install.packages(\"forcats\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"hrbrthemes\", quietly = TRUE)) {\n  install.packages(\"hrbrthemes\")\n}\nif (!requireNamespace(\"ggpattern\", quietly = TRUE)) {\n  install.packages(\"ggpattern\")\n}\nif (!requireNamespace(\"ggpubr\", quietly = TRUE)) {\n  install.packages(\"ggpubr\")\n}\nif (!requireNamespace(\"rstatix\", quietly = TRUE)) {\n  install.packages(\"rstatix\")\n}\nif (!requireNamespace(\"palmerpenguins\", quietly = TRUE)) {\n  install.packages(\"palmerpenguins\")\n}\n\n# 加载包\nlibrary(magrittr)\nlibrary(tidyr)\nlibrary(ggplot2)\nlibrary(cowplot)\nlibrary(forcats)\nlibrary(dplyr)\nlibrary(hrbrthemes)\nlibrary(ggpattern)\nlibrary(rstatix)\nlibrary(ggpubr)\nlibrary(palmerpenguins)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package        * version date (UTC) lib source\n cowplot        * 1.2.0   2025-07-07 [1] RSPM\n dplyr          * 1.1.4   2023-11-17 [1] RSPM\n forcats        * 1.0.1   2025-09-25 [1] RSPM\n ggpattern      * 1.2.1   2025-08-27 [1] RSPM\n ggplot2        * 4.0.1   2025-11-14 [1] RSPM\n ggpubr         * 0.6.2   2025-10-17 [1] RSPM\n hrbrthemes     * 0.9.2   2025-11-02 [1] Github (hrbrmstr/hrbrthemes@d3fd029)\n magrittr       * 2.0.4   2025-09-12 [1] RSPM\n palmerpenguins * 0.1.1   2022-08-15 [1] RSPM\n rstatix        * 0.7.3   2025-10-18 [1] RSPM\n tidyr          * 1.3.2   2025-12-19 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Bar Plot"
    ]
  },
  {
    "objectID": "Ranking/BarPlot.html#数据准备",
    "href": "Ranking/BarPlot.html#数据准备",
    "title": "条形图",
    "section": "数据准备",
    "text": "数据准备\n主要利用来自TCGA的数据和 R 中自带的数据集进行绘图。\n\ndata_TCGA &lt;- readr::read_csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/TCGA-BRCA.htseq_counts_processed.csv\")\n\ndata_TCGA1 &lt;- data_TCGA[1:5,] %&gt;%\n  gather(key = \"sample\",value = \"gene_expression\",3:1219)\n\ndata_tcga_mean &lt;- aggregate(data_TCGA1$gene_expression, \n                            by=list(data_TCGA1$gene_name), mean) #均值\ncolnames(data_tcga_mean) &lt;- c(\"gene\",\"expression\")\n\ndata_tcga_sd &lt;- aggregate(data_TCGA1$gene_expression, \n                            by=list(data_TCGA1$gene_name), sd)\ncolnames(data_tcga_sd) &lt;- c(\"gene\",\"sd\")\n\ndata_tcga &lt;- merge(data_tcga_mean, data_tcga_sd, by=\"gene\")\n\ndata_penguins &lt;- penguins\n\ndata_penguins_flipper_length &lt;- aggregate(data_penguins$flipper_length_mm,\n                                by=list(data_penguins$species,data_penguins$sex),\n                                mean)\ncolnames(data_penguins_flipper_length) &lt;- c(\"species\",\"sex\",\"flipper_length_mm\")\n\ndata_mpg &lt;- mpg",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Bar Plot"
    ]
  },
  {
    "objectID": "Ranking/BarPlot.html#可视化",
    "href": "Ranking/BarPlot.html#可视化",
    "title": "条形图",
    "section": "可视化",
    "text": "可视化\n\n1. 基础条形图\n\n1.1 简单条形图\n这里我们以TCGA数据库数据为例。\n\n# 基础条形图\np &lt;- ggplot(data_tcga_mean, aes(x=gene, y=expression)) + \n  geom_bar(stat = \"identity\")\n\np\n\n\n\n\n\n\n\n图 1: 基础条形图\n\n\n\n\n\n展示了五种基因样本表达的均值。\n\n\n1.2 水平条形图\n利用 coord_flip() 翻转坐标轴。\n\n# 水平条形图\np &lt;- data_tcga_mean %&gt;%\n  mutate(gene=fct_reorder(gene,expression)) %&gt;% # fct_reorder排序\n  ggplot(aes(x=gene, y=expression)) + \n  geom_bar(stat = \"identity\",width=0.5)+ # width调整宽度\n  coord_flip() # 翻转坐标轴\n\np\n\n\n\n\n\n\n\n图 2: 水平条形图\n\n\n\n\n\n\n\n1.3 颜色设置\nggplot2 可以实现多种颜色设置方式，这里我们提供六个例子。\n\n# 颜色设置\np1 &lt;- ggplot(data_tcga_mean, aes(x=gene, y=expression)) + \n  geom_bar(stat = \"identity\",color=\"blue\", fill=rgb(0.1,0.4,0.5,0.7))+\n  labs(title = \"统一颜色\")+\n  theme(plot.title = element_text(hjust = 0.5)) +\n  geom_text(aes(label=round(expression,2)),  #添加数据标签\n            position = position_dodge2(width = 0.9, preserve = 'single'), \n    vjust = -0.2, hjust = 0.5) +\n  scale_y_continuous(limits = c(0, 17),breaks = seq(0,17,5))\n\np2 &lt;- ggplot(data_tcga_mean, aes(x=gene, y=expression, fill=gene)) + \n  geom_bar(stat = \"identity\")+\n  scale_fill_hue(c = 40) +\n  labs(title = \"渐变颜色\")+\n  theme(plot.title = element_text(hjust = 0.5),\n        legend.position=\"none\") +\n  geom_text(aes(label=round(expression,2)),  #添加数据标签\n            position = position_dodge2(width = 0.9, preserve = 'single'), \n            vjust = -0.2, hjust = 0.5) +\n  scale_y_continuous(limits = c(0, 17),breaks = seq(0,17,5))\n\np3 &lt;- ggplot(data_tcga_mean, aes(x=gene, y=expression, fill=gene)) + \n  geom_bar(stat = \"identity\")+\n  scale_fill_brewer(palette = \"Set1\")+\n  labs(title = \"RColorBrewer调色盘1\")+\n  theme(plot.title = element_text(hjust = 0.5),\n        legend.position=\"none\") +\n  geom_text(aes(label=round(expression,2)),  #添加数据标签\n            position = position_dodge2(width = 0.9, preserve = 'single'), \n            vjust = -0.2, hjust = 0.5) +\n  scale_y_continuous(limits = c(0, 17),breaks = seq(0,17,5))\n\np4 &lt;- ggplot(data_tcga_mean, aes(x=gene, y=expression, fill=gene)) + \n  geom_bar(stat = \"identity\")+\n  scale_fill_brewer(palette = \"Set2\") +\n  labs(title = \"RColorBrewer调色盘2\")+\n  theme(plot.title = element_text(hjust = 0.5),\n        legend.position=\"none\") +\n  geom_text(aes(label=round(expression,2)),  #添加数据标签\n            position = position_dodge2(width = 0.9, preserve = 'single'), \n            vjust = -0.2, hjust = 0.5) +\n  scale_y_continuous(limits = c(0, 17),breaks = seq(0,17,5))\n\np5 &lt;- ggplot(data_tcga_mean, aes(x=gene, y=expression, fill=gene)) + \n  geom_bar(stat = \"identity\")+\n  scale_fill_grey(start = 0.25, end = 0.75) +\n  labs(title = \"灰度\")+\n  theme(plot.title = element_text(hjust = 0.5),\n        legend.position=\"none\") +\n  geom_text(aes(label=round(expression,2)),  #添加数据标签\n            position = position_dodge2(width = 0.9, preserve = 'single'), \n            vjust = -0.2, hjust = 0.5) +\n  scale_y_continuous(limits = c(0, 17),breaks = seq(0,17,5))\n\n\np6 &lt;- ggplot(data_tcga_mean, aes(x=gene, y=expression, fill=gene)) + \n  geom_bar(stat = \"identity\")+\n  scale_fill_manual(values = c(\"red\", \"green\", \"blue\",\"pink\",\"yellow\") ) +\n  labs(title = \"手动设置\")+\n  theme(plot.title = element_text(hjust = 0.5),\n        legend.position=\"none\") +\n  geom_text(aes(label=round(expression,2)),  #添加数据标签\n            position = position_dodge2(width = 0.9, preserve = 'single'), \n            vjust = -0.2, hjust = 0.5) +\n  scale_y_continuous(limits = c(0, 17),breaks = seq(0,17,5))\n\nplot_grid(p1, p2, p3, p4, p5, p6, labels = LETTERS[1:6], ncol = 3)\n\n\n\n\n\n\n\n图 3: 颜色设置\n\n\n\n\n\n\n\n1.4 灰度条形图与纹理条形图\n处理颜色的设置，ggplot2还可以绘制灰度条形图和纹理条形图。\n\n# 灰度条形图\np &lt;- \n  ggplot(data_tcga_mean, aes(x=gene, y=expression, fill=gene)) +\n  geom_bar(stat=\"identity\", alpha=.6, width=.4) +\n  scale_fill_grey(start=0, end=0.8) +  # 设置灰度范围\n  theme_bw()\np\n\n\n\n\n\n\n\n图 4: 灰度条形图\n\n\n\n\n\n\n# 纹理条形图\np &lt;- ggplot(data_tcga_mean, aes(x=gene, y=expression)) +\n  geom_col_pattern(\n    aes(pattern=gene,\n        pattern_angle=gene,\n        pattern_spacing=gene\n    ), \n    fill            = 'white',\n    colour          = 'black', \n    pattern_density = 0.5, \n    pattern_fill    = 'black',\n    pattern_colour  = 'darkgrey'\n  ) +\n  theme_bw()\np\n\n\n\n\n\n\n\n图 5: 纹理条形图\n\n\n\n\n\n\n\n\n\n\n\n提示\n\n\n\n关键参数: \n\nfill：图案后的基础填充颜色\ncolour：条形的边框颜色\npattern_density：条形内图案的密度\npattern_fill：图案颜色\npattern_colour：图案的辅助色\n\n\n\n\n\n\n2. 可变宽度条形图\n可变宽度条形图实现了样本数量的可视化，用条形宽度来表示样本数量。\n\n# 可变宽度条形图----\ndata &lt;- data.frame(\n  group=c(\"A \",\"B \",\"C \",\"D \") , \n  value=c(33,62,56,67) , \n  number_of_obs=c(100,500,459,342)\n)\n\n# 设置宽度左右界限\ndata$right &lt;- cumsum(data$number_of_obs) + 30*c(0:(nrow(data)-1))\ndata$left &lt;- data$right - data$number_of_obs \n\n# 绘图\np &lt;- \n  ggplot(data, aes(ymin = 0)) + \n  geom_rect(aes(xmin = left, xmax = right, # 设置宽度上下限\n                ymax = value, \n                colour = group, fill = group),alpha=0.8) +\n  xlab(\"number of obs\") + \n  ylab(\"value\") +\n  theme_ipsum() +\n  scale_fill_brewer(palette = \"Set1\") +\n  theme(legend.position=\"none\") \np\n\n\n\n\n\n\n\n图 6: 可变宽度条形图\n\n\n\n\n\n上图用条形宽度展示了样本量。\n\n\n3. 误差线条形图\n条形图允许添加误差线，我们可以通过 geom_errorbar 实现。\n\n3.1 基础误差线条形图\n\n# 基础误差条形图\np &lt;- \n  ggplot(data_tcga) +\n  geom_bar( aes(x=gene, y=expression), stat=\"identity\", fill=\"skyblue\", alpha=0.7) +\n  geom_errorbar(aes(x=gene, \n                    ymin=expression-sd, ymax=expression+sd), \n                width=0.4, colour=\"orange\", alpha=0.9, size=1) +\n  labs(title = \"基础误差条形图\") +\n  theme(plot.title = element_text(hjust = 0.5))\np\n\n\n\n\n\n\n\n图 7: 基础误差线条形图\n\n\n\n\n\n上图在展示各基因表达量的同时添加了标准差误差线。\n\n\n3.2 多种类型误差线条形图\n同时，ggplot2提供了多种误差线的类型，这里我们提供四种示例。\n\n# 误差线条形图（以标准差为例）----\n## 多种类型误差条形图\np1 &lt;- ggplot(data_tcga) +\n  geom_bar( aes(x=gene, y=expression), stat=\"identity\", fill=\"skyblue\", alpha=0.7) +\n  geom_crossbar( aes(x=gene, y=expression, \n                     ymin=expression-sd, ymax=expression+sd), \n                 width=0.4, colour=\"orange\", alpha=0.9, size=1.3) +\n  labs(title = \"箱形误差条形图\")+\n  theme(plot.title = element_text(hjust = 0.5))\n\np2 &lt;- ggplot(data_tcga) +\n  geom_bar( aes(x=gene, y=expression), stat=\"identity\", fill=\"skyblue\", alpha=0.7) +\n  geom_linerange( aes(x=gene, \n                      ymin=expression-sd, ymax=expression+sd), \n                  colour=\"orange\", alpha=0.9, size=1.3) +\n  labs(title = \"线形误差条形图\")+\n  theme(plot.title = element_text(hjust = 0.5))\n\n\np3 &lt;- ggplot(data_tcga) +\n  geom_bar( aes(x=gene, y=expression), stat=\"identity\", fill=\"skyblue\", alpha=0.7) +\n  geom_pointrange( aes(x=gene, y=expression, \n                       ymin=expression-sd, ymax=expression+sd), \n                   colour=\"orange\", alpha=0.9, size=1) +\n  labs(title = \"线+点型误差条形图\")+\n  theme(plot.title = element_text(hjust = 0.5))\n\n\np4 &lt;- ggplot(data_tcga) +\n  geom_bar( aes(x=gene, y=expression), stat=\"identity\", fill=\"skyblue\", alpha=0.7) +\n  geom_errorbar( aes(x=gene, ymin=expression-sd, ymax=expression+sd), \n                 width=0.4, colour=\"orange\", alpha=0.9, size=1.3) +\n  coord_flip() +\n  labs(title = \"水平误差条形图\")+\n  theme(plot.title = element_text(hjust = 0.5))\n\nplot_grid(p1, p2, p3, p4, labels = LETTERS[1:4], ncol = 2)\n\n\n\n\n\n\n\n图 8: 多种类型误差线条形图\n\n\n\n\n\n\n\n3.3 添加差异分析\n\n# 添加差异分析\ndata_tcga_p &lt;- filter(data_TCGA1,\n                      gene_name == \"A1BG\" | gene_name == \"A1CF\" | gene_name == \"A2M\")\n\ndata_tcga_plot &lt;- filter(data_tcga,\n                         gene == \"A1BG\" | gene == \"A1CF\" | gene == \"A2M\")\n\n# 组间p值计算\ndf_p_val &lt;- data_tcga_p %&gt;% \n  wilcox_test(formula = gene_expression~gene_name) %&gt;% \n  add_significance(p.col = 'p',cutpoints = c(0,0.001,0.01,0.05,1),symbols = c('***','**','*','ns')) %&gt;% \n  add_xy_position()\n\np &lt;- \n  ggplot(data_tcga_plot) +\n  geom_bar( aes(x=gene, y=expression), stat=\"identity\", fill=\"skyblue\", alpha=0.7) +\n  geom_errorbar( aes(x=gene, \n                     ymin=expression-sd, ymax=expression+sd), \n                 width=0.4, colour=\"orange\", alpha=0.9, size=1) +\n  stat_pvalue_manual(df_p_val,label = '{p.signif}', #添加差异分析线\n                     tip.length = 0.01,\n                     y.position = c(15,17,19)) +\n  labs(title = \"添加差异分析\") +\n  theme(plot.title = element_text(hjust = 0.5))\np\n\n\n\n\n\n\n\n图 9: 添加差异分析\n\n\n\n\n\n上图添加了三种基因表达数据的差异分析线。\n\n\n\n4. 堆积条形图\n在包含组内分组时，我们可以选择绘制堆积条形图。\n以penguins数据集为例。\n\n# 堆积条形图----\np &lt;- \n  ggplot(data_penguins_flipper_length,aes(x=species,y=flipper_length_mm,fill=sex))+\n  geom_bar(stat=\"identity\",  \n           position = position_stack(reverse = TRUE))+ #改变堆积顺序\n  guides(fill=guide_legend(reverse = TRUE)) + #改变图例顺序\n  scale_fill_manual(values = c(\"#87CEFA\",\"#8DB6CD\"))\np\n\n\n\n\n\n\n\n图 10: 堆积条形图\n\n\n\n\n\n展示了不同性别企鹅翅膀长度的堆积条形图。\n\n\n5. 百分比条形图\n同样的，在进行比例分析时还可以选择绘制百分比条形图。\n\n# 百分比条图----\np &lt;- \n  ggplot(data_mpg,aes(class))+\n  geom_bar(aes(fill = drv), \n           position = 'fill') + #绘制百分占比\n  scale_fill_manual(values = c(\"#87CEFA\",\"#8DB6CD\",\"#84B6BD\"))\np\n\n\n\n\n\n\n\n图 11: 百分比条形图\n\n\n\n\n\n上图展示了各车型中驱动类型（四轮驱动、前轮驱动、后轮驱动）的百分比例。\n\n\n6. 并列条形图\n在包含组内分组时，我们还可以通过设置 position 参数来绘制并列条形图。\n\n# 并列条形图----\np &lt;- \n  ggplot(data_mpg,aes(class)) +\n  geom_bar(aes(fill = drv), \n           position = position_dodge2(preserve = 'single')) +\n  scale_fill_manual(values = c(\"#87CEFA\",\"#8DB6CD\",\"#84B6BD\"))\np\n\n\n\n\n\n\n\n图 12: 并列条形图\n\n\n\n\n\n\n\n7. 条形图的变形\n\n7.1 金字塔图\n\ndf &lt;- tibble(\n  gene = factor(paste0(\"gene_\", rep(1:16, 2)), levels = paste0(\"gene_\", 16:1)),\n  stat = c(seq(-10, -100, -10), seq(-90, -40, 10), seq(10, 100, 10), seq(90, 40, -10)),\n  direct = rep(c(\"down\", \"up\"), each=16)\n)\n\np &lt;- \n  ggplot(df, aes(gene, stat, fill = direct)) + \n  geom_col() +\n  coord_flip() + \n  scale_y_continuous(breaks = seq(-100, 100, 20),\n                     labels = c(seq(100, 0, -20), seq(20, 100, 20)))\np\n\n\n\n\n\n\n\n图 13: 金字塔图\n\n\n\n\n\n\n\n7.2 偏差图\n\n# 偏差图\ndf &lt;- tibble(\n  gene = factor(paste0(\"gene_\", 1:20), levels = paste0(\"gene_\", 20:1)),\n  stat = c(seq(100, 10, -10), seq(-10, -100, -10)),\n  direct = factor(rep(c(\"up\", \"down\"), each=10), levels = c(\"up\", \"down\"))\n)\n\np &lt;- \n  ggplot(df, aes(gene, stat, fill = direct)) + \n  geom_col() +\n  coord_flip()\np\n\n\n\n\n\n\n\n图 14: 偏差图",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Bar Plot"
    ]
  },
  {
    "objectID": "Ranking/BarPlot.html#应用场景",
    "href": "Ranking/BarPlot.html#应用场景",
    "title": "条形图",
    "section": "应用场景",
    "text": "应用场景\n\n1. 基础条形图\n\n\n\n\n\n\n图 15: 基础条形图应用\n\n\n\n数据来自TCGA数据库。顶部的条形图显示了截至2015年1月36种癌症类型中每种癌症类型的可用数据类型数量；下方的条形图显示了每种数据类型可用的癌症类型的数量。[1]\n\n\n2. 误差线条形图\n\n\n\n\n\n\n图 16: 误差线条形图应用\n\n\n\n(A)为大面积染色PBS、MSC、GENE、MSC +GENE各组胶原体积分数的条形图；(B)为天狼星红染色PBS、MSC、GENE、MSC +GENE各组胶原体积分数的条形图。[2]\n\n\n3. 并列条形图\n\n\n\n\n\n\n图 17: 并列条形图应用\n\n\n\n上图 B 展示了使用CryoProbe（CP）或 room temperature coil（RT）采集的六节段模型（A）中不同节段中所有小鼠的平均LV心肌信号噪比（SNR）；图D展示了不同切片中所有小鼠的平均LV心肌SNR。[3]",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Bar Plot"
    ]
  },
  {
    "objectID": "Ranking/BarPlot.html#参考文献",
    "href": "Ranking/BarPlot.html#参考文献",
    "title": "条形图",
    "section": "参考文献",
    "text": "参考文献\n[1] Kannan L, Ramos M, Re A, El-Hachem N, Safikhani Z, Gendoo DM, Davis S, Gomez-Cabrero D, Castelo R, Hansen KD, Carey VJ, Morgan M, Culhane AC, Haibe-Kains B, Waldron L. Public data and open source tools for multi-assay genomic investigation of disease. Brief Bioinform. 2016 Jul;17(4):603-15. doi: 10.1093/bib/bbv080. Epub 2015 Oct 12. PMID: 26463000; PMCID: PMC4945830.\n[2] Yu Q, Fang W, Zhu N, Zheng X, Na R, Liu B, Meng L, Li Z, Li Q, Li X. Beneficial effects of intramyocardial mesenchymal stem cells and VEGF165 plasmid injection in rats with furazolidone induced dilated cardiomyopathy. J Cell Mol Med. 2015 Aug;19(8):1868-76. doi: 10.1111/jcmm.12558. Epub 2015 Mar 5. PMID: 25753859; PMCID: PMC4549037.\n[3] Wagenhaus B, Pohlmann A, Dieringer MA, Els A, Waiczies H, Waiczies S, Schulz-Menger J, Niendorf T. Functional and morphological cardiac magnetic resonance imaging of mice using a cryogenic quadrature radiofrequency coil. PLoS One. 2012;7(8):e42383. doi: 10.1371/journal.pone.0042383. Epub 2012 Aug 1. PMID: 22870323; PMCID: PMC3411643.\n[4] Bache S, Wickham H (2022). magrittr: A Forward-Pipe Operator for R. R package version 2.0.3, https://CRAN.R-project.org/package=magrittr.\n[5] Wickham H, Vaughan D, Girlich M (2024). tidyr: Tidy Messy Data. R package version 1.3.1, https://CRAN.R-project.org/package=tidyr.\n[6] H. Wickham. ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York, 2016.\n[7] Wilke C (2024). cowplot: Streamlined Plot Theme and Plot Annotations for ‘ggplot2’. R package version 1.1.3, https://CRAN.R-project.org/package=cowplot.\n[8] Wickham H (2023). forcats: Tools for Working with Categorical Variables (Factors). R package version 1.0.0, https://CRAN.R-project.org/package=forcats.\n[9] Wickham H, François R, Henry L, Müller K, Vaughan D (2023). dplyr: A Grammar of Data Manipulation. R package version 1.1.4, https://CRAN.R-project.org/package=dplyr.\n[10] Rudis B (2024). hrbrthemes: Additional Themes, Theme Components and Utilities for ‘ggplot2’. R package version 0.8.7, https://CRAN.R-project.org/package=hrbrthemes.\n[11] FC M, Davis T, ggplot2 authors (2024). ggpattern: ‘ggplot2’ Pattern Geoms. R package version 1.1.1, https://CRAN.R-project.org/package=ggpattern.\n[12] Kassambara A (2023). rstatix: Pipe-Friendly Framework for Basic Statistical Tests. R package version 0.7.2, https://CRAN.R-project.org/package=rstatix.",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Bar Plot"
    ]
  },
  {
    "objectID": "Ranking/CircularBarplot.html",
    "href": "Ranking/CircularBarplot.html",
    "title": "圆形条形图",
    "section": "",
    "text": "圆形条形图是著名的条形图的一种变体，其中条形沿着圆周而不是直线显示。请注意，尽管视觉上吸引人，但圆形条形图必须谨慎使用，因为各组并不共享相同的 Y 轴。不过，它非常适合周期性数据。",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Circular Barplot"
    ]
  },
  {
    "objectID": "Ranking/CircularBarplot.html#示例",
    "href": "Ranking/CircularBarplot.html#示例",
    "title": "圆形条形图",
    "section": "示例",
    "text": "示例",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Circular Barplot"
    ]
  },
  {
    "objectID": "Ranking/CircularBarplot.html#环境配置",
    "href": "Ranking/CircularBarplot.html#环境配置",
    "title": "圆形条形图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：tidyverse\n\n\n# 安装包\nif (!requireNamespace(\"tidyverse\", quietly = TRUE)) {\n  install.packages(\"tidyverse\")\n}\n\n# 加载包\nlibrary(tidyverse)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package   * version date (UTC) lib source\n dplyr     * 1.1.4   2023-11-17 [1] RSPM\n forcats   * 1.0.1   2025-09-25 [1] RSPM\n ggplot2   * 4.0.1   2025-11-14 [1] RSPM\n lubridate * 1.9.4   2024-12-08 [1] RSPM\n purrr     * 1.2.0   2025-11-04 [1] RSPM\n readr     * 2.1.6   2025-11-14 [1] RSPM\n stringr   * 1.6.0   2025-11-04 [1] RSPM\n tibble    * 3.3.0   2025-06-08 [1] RSPM\n tidyr     * 1.3.2   2025-12-19 [1] RSPM\n tidyverse * 2.0.0   2023-02-22 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Circular Barplot"
    ]
  },
  {
    "objectID": "Ranking/CircularBarplot.html#数据准备",
    "href": "Ranking/CircularBarplot.html#数据准备",
    "title": "圆形条形图",
    "section": "数据准备",
    "text": "数据准备\n主要运用R内置的iris数据集，自建数据集和TCGA数据库\n\n# 1.R内置的data——iris\nhead(iris)\n\n  Sepal.Length Sepal.Width Petal.Length Petal.Width Species\n1          5.1         3.5          1.4         0.2  setosa\n2          4.9         3.0          1.4         0.2  setosa\n3          4.7         3.2          1.3         0.2  setosa\n4          4.6         3.1          1.5         0.2  setosa\n5          5.0         3.6          1.4         0.2  setosa\n6          5.4         3.9          1.7         0.4  setosa\n\n# 2.自建数据集\ndata_customize &lt;- data.frame(\n  individual=paste( \"Mister \", seq(1,60), sep=\"\"),\n  group=c( rep('A', 10), rep('B', 30), rep('C', 14), rep('D', 6)) ,\n  value=sample( seq(10,100), 60, replace=T)\n)\n\n# 3.TCGA数据库（肝癌的基因表达数据）\ntcga_circle &lt;- readr::read_csv(\n\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/tcga_circle.csv\")",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Circular Barplot"
    ]
  },
  {
    "objectID": "Ranking/CircularBarplot.html#可视化",
    "href": "Ranking/CircularBarplot.html#可视化",
    "title": "圆形条形图",
    "section": "可视化",
    "text": "可视化\n\n1. 基本绘图\n\n1.1 iris 数据\n基本上，这种方法与制作经典的条形图相同。最后，我们调用 coord_polar() 来使图表呈圆形。需要注意的是ylim()参数非常重要。如果它从0开始，条形将从圆心开始。如果你提供一个负值，就会出现一个白色的圆圈空间！\n\niris_id &lt;- iris[order(iris$Species),]\niris_id$new_column &lt;- 1:nrow(iris_id)\np &lt;- ggplot(iris_id, aes(x = new_column, y = Sepal.Length, fill = Species)) +\n  geom_bar(stat = \"identity\", width = 1) +\n  coord_polar(start = 0) +\n  theme_void() + \n  labs(fill = \"Species\", y = \"Sepal.Length\", x = NULL) +\n  theme(legend.title = element_blank()) \n\np\n\n\n\n\n\n\n\n图 1: 基本绘图\n\n\n\n\n\n这个圆形条形图描述了不同物种间Sepal.Length变量的数量关系。\n\n\n1.2 TCGA 数据\n（1）添加标签\n\n# 获取每个标签的名称和y位置\nlabel_data &lt;- tcga_circle\n# 计算标签的角度\nnumber_of_bar &lt;- nrow(label_data)\nangle &lt;-  90 - 360 * (label_data$id-0.5) /number_of_bar    \n# 计算标签的对齐方式：右对齐还是左对齐\nlabel_data$hjust &lt;- ifelse(angle &lt; -90, 1, 0)\n# 将翻转角度BY调整为可读\nlabel_data$angle &lt;- ifelse(angle &lt; -90, angle+180, angle)\n#画图\ntcga_circle_id &lt;- tcga_circle\ntcga_circle_id$id &lt;- as.factor(tcga_circle_id$id)\np &lt;- ggplot(tcga_circle_id, aes(x = id, y = tcga_circle)) +\n  geom_bar(stat = \"identity\", fill=alpha(\"skyblue\", 0.7)) +\n  ylim(-10,20) +\n  coord_polar(start = 0) +\n  theme_minimal() +\n  theme(\n    axis.text = element_blank (),\n    axis.title = element_blank(),\n    panel.grid = element_blank (),\n    plot.margin = unit(rep(-1,4), \"cm\")  )+   \n  labs(fill = \"RowNames\", y = \"tcga_circle\", x = NULL) +\n  theme(legend.title = element_blank()) +\n  geom_text(data=label_data, \n            aes(x=id, y=tcga_circle+10, label=RowNames, hjust=hjust), \n            color=\"black\", fontface=\"bold\",alpha=0.6, size=2.5, \n            angle= label_data$angle, inherit.aes = FALSE )\n\np\n\n\n\n\n\n\n\n图 2: 添加标签\n\n\n\n\n\n这个圆形条形图描述了肝癌某一样本中不同基因的表达数值。\n（2）增加一段间隙\n\n# 增加一段间隙\nempty_bar &lt;- 20\nto_add &lt;- matrix(NA, empty_bar, ncol(tcga_circle))\ncolnames(to_add) &lt;- colnames(tcga_circle)\ntcga_circle_id &lt;- rbind(tcga_circle, to_add)\ntcga_circle_id$id &lt;- seq(1, nrow(tcga_circle_id))\n# 获取每个标签的名称和y位置\nlabel_data &lt;- tcga_circle_id\n# 计算标签的角度\nnumber_of_bar &lt;- nrow(label_data)\nangle &lt;-  90 - 360 * (label_data$id-0.5) /number_of_bar    \n# 计算标签的对齐方式：右对齐还是左对齐\nlabel_data$hjust &lt;- ifelse( angle &lt; -90, 1, 0)\n# 将翻转角度BY调整为可读\nlabel_data$angle &lt;- ifelse(angle &lt; -90, angle+180, angle)\n\np &lt;- ggplot(tcga_circle_id, aes(x = id, y = tcga_circle)) +\n  geom_bar(stat = \"identity\", fill=alpha(\"skyblue\", 0.7)) +\n  ylim(-10,20) +\n  coord_polar(start = 0) +\n  theme_minimal() +\n  theme(\n    axis.text = element_blank (),\n    axis.title = element_blank(),\n    panel.grid = element_blank (),\n    plot.margin = unit(rep(-1,4), \"cm\")  )+   \n  labs(fill = \"RowNames\", y = \"tcga_circle\", x = NULL) +\n  theme(legend.title = element_blank()) +\n  geom_text(data=label_data, \n            aes(x=id, y=tcga_circle+10, label=RowNames, hjust=hjust), \n            color=\"black\", fontface=\"bold\",alpha=0.6, size=2.5, \n            angle= label_data$angle, inherit.aes = FALSE )\n\np\n\n\n\n\n\n\n\n图 3: 增加一段间隙\n\n\n\n\n\n这个圆形条形图描述了肝癌某一样本中不同基因的表达数值。\n\n\n\n2. 分组\n\n2.1 组间添加间隙\n以iris数据为例\n\niris_id &lt;- iris[order(iris$Species),]\niris_id$new_column &lt;- 1:nrow(iris_id)\n#添加间隙\nempty_bar &lt;- 4\nto_add &lt;- data.frame( matrix(NA, empty_bar*nlevels(iris_id$Species), ncol(iris_id)) )\n\ncolnames(to_add) &lt;- colnames(iris_id)\nto_add$Species &lt;- rep(levels(iris_id$Species), each=empty_bar)\niris_id &lt;- rbind(iris_id, to_add)\niris_id &lt;- iris_id %&gt;% arrange(Species)\niris_id$new_column &lt;- seq(1, nrow(iris_id))\n#画图\niris_id$new_column&lt;-as.factor(iris_id$new_column)\np &lt;- ggplot(iris_id, aes(x = new_column, y = Sepal.Length,fill = Species)) +\n  geom_bar(stat = \"identity\") +\n  ylim(-20,10) +\n  coord_polar(start = 0) +\n  theme_minimal() +\n  theme(\n    axis.text = element_blank (),\n    axis.title = element_blank(),\n    panel.grid = element_blank (),\n    plot.margin = unit(rep(-1,4), \"cm\")  )+   \n  labs(fill = \"Species\", y = \"Sepal.Length\", x = NULL) +\n  theme(legend.title = element_blank()) \n\np\n\n\n\n\n\n\n\n图 4: 组间添加间隙\n\n\n\n\n\n这个圆形条形图描述了不同物种间Sepal.Length变量的数量关系。\n\n\n2.2 按组间大小排列\n以自建数据为例\n\n# 创建每组间的间隙\nempty_bar &lt;- 4\nto_add &lt;- data.frame( matrix(NA, empty_bar*nlevels(data_customize$group), ncol(data_customize)) )\ncolnames(to_add) &lt;- colnames(data_customize)\nto_add$group &lt;- rep(levels(data_customize$group), each=empty_bar)\ndata_customize_id &lt;- rbind(data_customize, to_add)\ndata_customize_id &lt;- data_customize_id %&gt;% arrange(group,value)\ndata_customize_id$id &lt;- seq(1, nrow(data_customize_id))\n\n# 添加标签\nlabel_data2 &lt;- data_customize_id\nnumber_of_bar &lt;- nrow(label_data2)\nangle &lt;- 90 - 360 * (label_data2$id-0.5) /number_of_bar    \nlabel_data2$hjust &lt;- ifelse( angle &lt; -90, 1, 0)\nlabel_data2$angle &lt;- ifelse(angle &lt; -90, angle+180, angle)\n\n# 画图\ndata_customize_id$id &lt;- as.factor(data_customize_id$id)\np &lt;- ggplot(data_customize_id, aes(x=id, y=value, fill=group)) +       \n  geom_bar(stat=\"identity\", alpha=0.5) +\n  ylim(-100,120) +\n  theme_minimal() +\n  theme(\n    legend.position = \"none\",\n    axis.text = element_blank(),\n    axis.title = element_blank(),\n    panel.grid = element_blank(),\n    plot.margin = unit(rep(-1,4), \"cm\") \n  ) +\n  coord_polar() + \n  geom_text(data=label_data2, \n            aes(x=id, y=value+10, label=individual, hjust=hjust), \n            color=\"black\", fontface=\"bold\",alpha=0.6, size=2.5, \n            angle= label_data2$angle, inherit.aes = FALSE )\n\np\n\n\n\n\n\n\n\n图 5: 按组间大小排列\n\n\n\n\n\n这个圆形条形图描述了不同id的数值大小。\n\n\n\n3. 美化图形\n\n# 设置要在每组末尾添加的“空栏”数量\ndata_customize_id &lt;- data_customize\nempty_bar &lt;- 3\nto_add &lt;- data.frame(matrix(NA, empty_bar*nlevels(data_customize$group),\n                            ncol(data_customize)))\ncolnames(to_add) &lt;- colnames(data_customize)\nto_add$group &lt;- rep(levels(data_customize_id$group), each=empty_bar)\ndata_customize_id &lt;- rbind(data_customize, to_add)\ndata_customize_id &lt;- data_customize_id %&gt;% arrange(group)\ndata_customize_id$id &lt;- seq(1, nrow(data_customize_id))\n\n# 获取每个标签的名称和 y 位置\nlabel_data &lt;- data_customize_id\nnumber_of_bar &lt;- nrow(label_data)\nangle &lt;- 90 - 360 * (label_data2$id-0.5) /number_of_bar    \nlabel_data$hjust &lt;- ifelse( angle &lt; -90, 1, 0)\nlabel_data$angle &lt;- ifelse(angle &lt; -90, angle+180, angle)\n\n# 准备基线数据框\nbase_data &lt;- data_customize_id %&gt;% \n  group_by(group) %&gt;% \n  summarize(start=min(id), end=max(id) - empty_bar) %&gt;% \n  rowwise() %&gt;% \n  mutate(title=mean(c(start, end)))\n\n# 准备网格数据框（比例尺）\ngrid_data &lt;- base_data\ngrid_data$end &lt;- grid_data$end[ c( nrow(grid_data), 1:nrow(grid_data)-1)] + 1\ngrid_data$start &lt;- grid_data$start - 1\ngrid_data &lt;- grid_data[-1,]\n\n# 画图\np &lt;- ggplot(data_customize_id, aes(x=as.factor(id), y=value, fill=group)) +        \n  geom_bar(aes(x=as.factor(id), y=value, fill=group), stat=\"identity\", alpha=0.5) +\n  geom_segment(data=grid_data, aes(x = end, y = 80, xend = start, yend = 80), colour = \"grey\", alpha=1, size=0.3 , inherit.aes = FALSE ) +\n  geom_segment(data=grid_data, aes(x = end, y = 60, xend = start, yend = 60), colour = \"grey\", alpha=1, size=0.3 , inherit.aes = FALSE ) +\n  geom_segment(data=grid_data, aes(x = end, y = 40, xend = start, yend = 40), colour = \"grey\", alpha=1, size=0.3 , inherit.aes = FALSE ) +\n  geom_segment(data=grid_data, aes(x = end, y = 20, xend = start, yend = 20), colour = \"grey\", alpha=1, size=0.3 , inherit.aes = FALSE ) +\n  annotate(\"text\", x = rep(max(data$id),4), y = c(20, 40, 60, 80), label = c(\"20\", \"40\", \"60\", \"80\") , color=\"grey\", size=3 , angle=0, fontface=\"bold\", hjust=1) + \n  geom_bar(aes(x=as.factor(id), y=value, fill=group), stat=\"identity\", alpha=0.5) +\n  ylim(-100,120) +\n  theme_minimal() +\n  theme(\n    legend.position = \"none\",\n    axis.text = element_blank(),\n    axis.title = element_blank(),\n    panel.grid = element_blank(),\n    plot.margin = unit(rep(-1,4), \"cm\") \n  ) +\n  coord_polar() + \n  geom_text(data=label_data, aes(x=id, y=value+10, label=individual, hjust=hjust), color=\"black\", fontface=\"bold\",alpha=0.6, size=2.5, angle= label_data$angle, inherit.aes = FALSE ) +\n\n# 添加基线信息\n  geom_segment(data=base_data, aes(x = start, y = -5, xend = end, yend = -5), colour = \"black\", alpha=0.8, size=0.6 , inherit.aes = FALSE )  +\n  geom_text(data=base_data, aes(x = title, y = -18, label=group), hjust=c(1,1,0,0), colour = \"black\", alpha=0.8, size=4, fontface=\"bold\", inherit.aes = FALSE)\n\np\n\n\n\n\n\n\n\n图 6: 美化图形\n\n\n\n这个圆形条形图描述了不同id的数值大小。",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Circular Barplot"
    ]
  },
  {
    "objectID": "Ranking/CircularBarplot.html#应用场景",
    "href": "Ranking/CircularBarplot.html#应用场景",
    "title": "圆形条形图",
    "section": "应用场景",
    "text": "应用场景\n\n\n\n\n\n\n图 7: 圆形条形图应用\n\n\n\n该圆形条形图基于Corpas等人的家族全基因组数据，对人类第21号染色体的所有基因变异进行了可视化。[1]",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Circular Barplot"
    ]
  },
  {
    "objectID": "Ranking/CircularBarplot.html#参考文献",
    "href": "Ranking/CircularBarplot.html#参考文献",
    "title": "圆形条形图",
    "section": "参考文献",
    "text": "参考文献\n[1] Parveen A, Khurana S, Kumar A. Overview of Genomic Tools for Circular Visualization in the Next-generation Genomic Sequencing Era. Curr Genomics. 2019 Feb;20(2):90-99.",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Circular Barplot"
    ]
  },
  {
    "objectID": "Ranking/Wordcloud.html",
    "href": "Ranking/Wordcloud.html",
    "title": "词云图",
    "section": "",
    "text": "词云是文本词语的可视化表示，可以清楚得看到大量文本数据中的关键词（高频词）。",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Wordcloud"
    ]
  },
  {
    "objectID": "Ranking/Wordcloud.html#示例",
    "href": "Ranking/Wordcloud.html#示例",
    "title": "词云图",
    "section": "示例",
    "text": "示例\n\n\n\n\n\n图中是一个关于英语文本的词云，其中的单词词频越高，单词就越大。我们能从词云中很清楚得辨别出词频较高的单词，它同时也是这段文本的关键词。将大段文本以词云的形式显示，我们可以用较少的时间了解这段文本的主要内容。",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Wordcloud"
    ]
  },
  {
    "objectID": "Ranking/Wordcloud.html#环境配置",
    "href": "Ranking/Wordcloud.html#环境配置",
    "title": "词云图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：wordcloud2, jiebaRD, jiebaR, dplyr, tidyverse, htmlwidgets, webshot2\n\n\n# 安装包\nif (!requireNamespace(\"wordcloud2\", quietly = TRUE)) {\n  install.packages(\"wordcloud2\")\n}\nif (!requireNamespace(\"jiebaRD\", quietly = TRUE)) {\n  install.packages(\"https://cran.r-project.org/src/contrib/Archive/jiebaRD/jiebaRD_0.1.tar.gz\")\n}\nif (!requireNamespace(\"jiebaR\", quietly = TRUE)) {\n  install.packages(\"https://cran.r-project.org/src/contrib/Archive/jiebaR/jiebaR_0.11.1.tar.gz\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"tidyverse\", quietly = TRUE)) {\n  install.packages(\"tidyverse\")\n}\nif (!requireNamespace(\"htmlwidgets\", quietly = TRUE)) {\n  install.packages(\"htmlwidgets\")\n}\nif (!requireNamespace(\"webshot2\", quietly = TRUE)) {\n  install.packages(\"webshot2\")\n}\n\n# 载入包\nlibrary(wordcloud2)\nlibrary(jiebaR)    # 将中文文本分解成词语\nlibrary(dplyr)\nlibrary(tidyverse)\nlibrary(htmlwidgets)\nlibrary(webshot2)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package     * version date (UTC) lib source\n dplyr       * 1.1.4   2023-11-17 [1] RSPM\n forcats     * 1.0.1   2025-09-25 [1] RSPM\n ggplot2     * 4.0.1   2025-11-14 [1] RSPM\n htmlwidgets * 1.6.4   2023-12-06 [1] RSPM\n jiebaR      * 0.11.1  2025-03-29 [1] CRAN (R 4.5.2)\n jiebaRD     * 0.1     2015-01-04 [1] CRAN (R 4.5.2)\n lubridate   * 1.9.4   2024-12-08 [1] RSPM\n purrr       * 1.2.0   2025-11-04 [1] RSPM\n readr       * 2.1.6   2025-11-14 [1] RSPM\n stringr     * 1.6.0   2025-11-04 [1] RSPM\n tibble      * 3.3.0   2025-06-08 [1] RSPM\n tidyr       * 1.3.2   2025-12-19 [1] RSPM\n tidyverse   * 2.0.0   2023-02-22 [1] RSPM\n webshot2    * 0.1.2   2025-04-23 [1] RSPM\n wordcloud2  * 0.2.1   2018-01-03 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Wordcloud"
    ]
  },
  {
    "objectID": "Ranking/Wordcloud.html#数据准备",
    "href": "Ranking/Wordcloud.html#数据准备",
    "title": "词云图",
    "section": "数据准备",
    "text": "数据准备\n中文文本使用CNKI上检索的有关肺癌的免疫治疗的25个中文摘要文本；英文文本使用R自带的demoFreq数据集以及PubMed上检索的有关肺癌的免疫治疗的24个英文摘要文本。\n\n# 1.中文摘要文本\nwords &lt;- read.csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/words.txt\",header = FALSE,sep=\"\\n\")\nwords &lt;- as.character(words)\n\nhead_words &lt;- substr(words, start = 1, stop = 20)\n\nhead_words\n\n[1] \"肺癌可分为非小细胞肺癌(NSCLC)和小\"\n\n# 2.demoFreq数据集\ndata &lt;- demoFreq\n\nhead(data)\n\n         word freq\noil       oil   85\nsaid     said   73\nprices prices   48\nopec     opec   42\nmln       mln   31\nthe       the   26\n\n# 3.英文摘要文本\nwords_english &lt;- read.csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/words_english.txt\",header = FALSE,sep=\"\\n\")\n\nwords_english &lt;- as.character(words_english)\n\nhead_words_english &lt;- substr(words_english, start = 1, stop = 20)\n\nhead_words_english\n\n[1] \"Persistent inflammat\"\n\n\n文本转换成短语/单词\n\n\n\n\n\n\n提示\n\n\n\n注:  可以直接用示例数据demoFreq，这样不用了解文本的预处理过程。下面主要使用中文文本绘图。\n\n\n中文文本\n\n# 使用jiebaR包将文本拆成短语\nwords_seg &lt;- words %&gt;%\n  segment(worker()) %&gt;%                    # 将文本拆分成词语\n  tibble(word = .) %&gt;%  \n  filter(nchar(word) &gt; 1) %&gt;%              # 去除单字的词语\n  count(word, sort = TRUE) %&gt;%             # 统计词频\n  filter(!str_detect(word, \"[0-9]+\")) %&gt;%  # 去除数字\n  slice_max(n, n = 50)                     # 选择频率高的词语\n\nhead(words_seg)\n\n# A tibble: 6 × 2\n  word         n\n  &lt;chr&gt;    &lt;int&gt;\n1 患者       153\n2 治疗        79\n3 免疫治疗    64\n4 NSCLC       55\n5 细胞        55\n6 肺癌        54\n\n\n英文文本\n\n# 直接拆分，拆分成单个单词\nwords_english %&gt;%\n str_replace_all(\",\", \" \") %&gt;%         # 将标点符号替换成空格\n str_replace_all(\"\\\\.\", \" \") %&gt;%\n str_replace_all(\"\\\\(\", \" \") %&gt;%\n str_replace_all(\"\\\\)\", \" \") %&gt;%\n str_split(\" \", simplify = TRUE) %&gt;%  # 将文本拆分为单词\n .[nchar(.) &gt; 1] %&gt;%                  # 去除长度为1或0的单词\n tibble(word = .) %&gt;%\n filter(!grepl(\"[0-9]+\", word)) %&gt;%   # 去除数字\n table() %&gt;%\n as.data.frame() %&gt;%\n arrange(desc(Freq)) %&gt;%\n slice(1:60) -&gt; words_english_sep     # 选取词频前60的单词\n\n# 根据词列表，去除无意义的词\nwords_english_sep1 &lt;- words_english_sep[c(-1, -2, -3, -4, -5, -6, -7, -14, -20, -22, -23, -24, -26, -27, -29, -30, -31, -33, -34, -35, -36, -44, -46, -53, -55),]\n\nhead(words_english_sep1)\n\n            word Freq\n8       patients   56\n9  immunotherapy   51\n10        cancer   46\n11         NSCLC   46\n12          lung   44\n13          cell   40\n\n\n图中是拆分成单词后，统计的词频较高的单词及词频。",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Wordcloud"
    ]
  },
  {
    "objectID": "Ranking/Wordcloud.html#可视化",
    "href": "Ranking/Wordcloud.html#可视化",
    "title": "词云图",
    "section": "可视化",
    "text": "可视化\n\n1. 基本绘图\n\n# 基本绘图\nBasicPlot &lt;- wordcloud2(data = words_seg, size = 1)\nBasicPlot\n\n\n\n\n\n\n\n图 1: 基本绘图\n\n\n\n这个图是一个基础的词云图，wordcloud2函数加上词频数据就可以绘制。\n\n\n2. 设置颜色\ncolor 参数\n\n# （1）设置文字颜色\nSetcolors &lt;- wordcloud2(data = words_seg, size = 1, color = \"random-dark\")\nSetcolors\n\n\n\n\n\n\n\n图 2: color 参数\n\n\n\n这个图通过对color参数的设置，其中的词语颜色是随机的暗色调。\n\n\n\n\n\n\n提示\n\n\n\n关键参数: color\n文本的颜色，可选项有”random-dark”,“random-light”,也可以使用向量自定义颜色。\n\n\n自定义颜色\n\n# （2）vector自定义颜色\nCustomizeColors &lt;- wordcloud2(\n  data = words_seg, size = 1, \n  color = rep_len(c(\"green\", \"blue\"),nrow(words_seg)))\nCustomizeColors\n\n\n\n\n\n\n\n图 3: 自定义颜色\n\n\n\n这个图中使用了rep_len()函数重复两种颜色形成向量，用于词语颜色的定义。\n背景颜色\n\n# （3）设置背景颜色\nBackgroundColor &lt;- wordcloud2(data = words_seg, size = 1, color = \"random-light\",\n                              backgroundColor = \"black\")\nBackgroundColor\n\n\n\n\n\n\n\n图 4: 背景颜色\n\n\n\n这个图通过代码中的backgroundColor=\"black\"将词云的颜色设置成背景色。\n\n\n3. 设置形状\n\n# 设置为星形\nSetShape &lt;- wordcloud2(data = words_seg, size = 0.5, shape = \"star\")\nSetShape\n\n\n\n\n\n\n\n图 5: 设置形状\n\n\n\n这个图通过代码中的shape = 'star'将词云的形状设置成星形，除星形外还有很多形状可以使用，使词云的绘制更加个性化。\n\n\n\n\n\n\n提示\n\n\n\n关键参数: shape\n词云的形状，可选项有 ‘circle’ (默认选项，原形), ‘cardioid’ (心形), ‘diamond’ (菱形), ‘triangle-forward’(三角形-向前), ‘triangle’(三角形), ‘pentagon’(五边形), ‘star’(星形)。\n\n\n\n\n4. 词云旋转\n固定旋转\n\n# （1）设置一定的旋转角度(最大最小转角设置一致，旋转比例为1)\nSpecificRotation &lt;- wordcloud2(data = words_seg, size = 1, minRotation = -pi / 6,\n                               maxRotation = -pi / 6, rotateRatio = 1)\nSpecificRotation\n\n\n\n\n\n\n\n图 6: 固定旋转\n\n\n\n这个图所用词语的方向顺时针旋转了30度，需要将最大最小转角设置一致，旋转比例设为1。\n\n\n\n\n\n\n提示\n\n\n\n关键参数: minRotation/maxRotation/rotateRatio\n\nminRotation: 最小的旋转角度。\nmaxRotation: 最大的旋转角度。\nrotateRatio: 词语旋转的比例，rotateRatio = 1时全部旋转。\n\n\n\n随机旋转\n\n# （2）随机旋转\nRandomRotation &lt;- wordcloud2(data = words_seg, size = 1, minRotation = -pi / 6,\n                             maxRotation = pi / 6, rotateRatio = 0.8)\nRandomRotation\n\n\n\n\n\n\n\n图 7: 随机旋转\n\n\n\n这个图词云的旋转角度在(-30°，30°)之间，选择角度随机，旋转比例为0.8。\n\n\n5. 英语词云\n使用demoFreq数据\n\n# 使用demoFreq数据\nEnglishWordcloud1 &lt;- wordcloud2(data = demoFreq[1:75, ], size = 1)\nEnglishWordcloud1\n\n\n\n\n\n\n\n图 8: 使用demoFreq数据\n\n\n\n这个图的词云使用demoFreq数据集的前75项进行绘图，英文词云和中文词云的绘图代码没有差别\n使用PubMed摘要文本\n\n# 使用PubMed摘要文本\nEnglishWordcloud2 &lt;- wordcloud2(data = words_english_sep1, size = 0.6)\nEnglishWordcloud2\n\n\n\n\n\n\n\n图 9: 使用PubMed摘要文本\n\n\n\n图中的词云使用PubMed摘要文本进行绘制，显示了肺癌的免疫治疗主题的关键词。",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Wordcloud"
    ]
  },
  {
    "objectID": "Ranking/Wordcloud.html#应用场景",
    "href": "Ranking/Wordcloud.html#应用场景",
    "title": "词云图",
    "section": "应用场景",
    "text": "应用场景\n\n\n\n\n\n\n图 10: 词云图应用1\n\n\n\n图中描述的可视化表明，世界云可视化字体中的粗体大字体旨在识别单词数量的映射形式，这些单词成为海事安全研究中每篇文章摘要的主题。一些国家的名字，例如中国、印度、印度尼西亚、澳大利亚、美国，都包含在世界云中，因为大多数文章都讨论了某些国家或地区。 [1]\n\n\n\n\n\n\n图 11: 词云图应用2\n\n\n\n图中DATA_SET 1的三个词云分别显示了积极、消极和中性情绪中使用最多的单词，验证了作者的社交媒体无法提供网民应对新冠肺炎等流行病的适当课程的看法。 [2]\n\n\n\n\n\n\n图 12: 词云图应用3\n\n\n\n图中的词云是基于幸存者军团民意调查的162条评论创建的，该调查询问了受访者关于振动或嗡嗡声的感觉以及神经性疼痛。这个词云显示，疼痛、灼热、新冠肺炎、腿、手和脚是评论中提到的最常见的术语。这个词云包括与灼热等感觉和带状疱疹和鹅口疮等症状相关的术语。 [3]",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Wordcloud"
    ]
  },
  {
    "objectID": "Ranking/Wordcloud.html#参考文献",
    "href": "Ranking/Wordcloud.html#参考文献",
    "title": "词云图",
    "section": "参考文献",
    "text": "参考文献\n[1] KISMARTINI K, YUSUF I M, SABILLA K R, et al. A bibliometric analysis of maritime security policy: Research trends and future agenda[J]. Heliyon, 2024,10(8): e28988.\n[2] CHAKRABORTY K, BHATIA S, BHATTACHARYYA S, et al. Sentiment Analysis of COVID-19 tweets by Deep Learning Classifiers-A study to show how popularity is affecting accuracy in social media[J]. Appl Soft Comput, 2020,97: 106754.\n[3] MASSEY D, SAWANO M, BAKER A D, et al. Characterisation of internal tremors and vibration symptoms[J]. BMJ Open, 2023,13(12): e77389.",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Wordcloud"
    ]
  },
  {
    "objectID": "Ranking/VennPlot.html",
    "href": "Ranking/VennPlot.html",
    "title": "韦恩图",
    "section": "",
    "text": "对于Venn图的可视化，常用的R包有ggVennDiagram和VennDiagram包，相比于VennDiagram包而言ggVennDiagram具有适用于更多分组、可以适配ggplot2语法和可以灵活设置的输出格式等优点，学习和后期处理更简单。然而ggVennDiagram的集合颜色只能设置为与元素个数相关的连续型渐变色，不能设置为每个集合一种颜色的离散型色彩，VennDiagram则恰好相反，因此可以根据具体需求选择需要使用哪个R包进行绘图。",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "VeenPlot"
    ]
  },
  {
    "objectID": "Ranking/VennPlot.html#示例",
    "href": "Ranking/VennPlot.html#示例",
    "title": "韦恩图",
    "section": "示例",
    "text": "示例",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "VeenPlot"
    ]
  },
  {
    "objectID": "Ranking/VennPlot.html#环境配置",
    "href": "Ranking/VennPlot.html#环境配置",
    "title": "韦恩图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：ggplot2; ggVennDiagram; VennDiagram\n\n\n# 安装包\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"ggVennDiagram\", quietly = TRUE)) {\n  install.packages(\"ggVennDiagram\")\n}\nif (!requireNamespace(\"VennDiagram\", quietly = TRUE)) {\n  install.packages(\"VennDiagram\")\n}\n\n# 加载包\nlibrary(ggplot2)\nlibrary(ggVennDiagram)\nlibrary(VennDiagram)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package       * version date (UTC) lib source\n futile.logger * 1.4.3   2016-07-10 [1] RSPM\n ggplot2       * 4.0.1   2025-11-14 [1] RSPM\n ggVennDiagram * 1.5.4   2025-06-21 [1] RSPM\n VennDiagram   * 1.7.3   2022-04-12 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "VeenPlot"
    ]
  },
  {
    "objectID": "Ranking/VennPlot.html#数据准备",
    "href": "Ranking/VennPlot.html#数据准备",
    "title": "韦恩图",
    "section": "数据准备",
    "text": "数据准备\n数据使用模拟基因集，假设我们有多组不同的处理A~D，在不同处理下各自产生了一定数量的差异表达基因。 ggVennDiagram要求的输入格式为一个list，list中的每个元素都需要有对应的名称以及包含的子元素。\n\ngenes &lt;- paste(\"gene\",1:1000,sep=\"\")\nset.seed(123)\nx &lt;- list(A=sample(genes,300),\n          B=sample(genes,525),\n          C=sample(genes,440),\n          D=sample(genes,350))",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "VeenPlot"
    ]
  },
  {
    "objectID": "Ranking/VennPlot.html#可视化",
    "href": "Ranking/VennPlot.html#可视化",
    "title": "韦恩图",
    "section": "可视化",
    "text": "可视化\n\n\n\n\n\n\n提示\n\n\n\nggVennDiagram基本参数:\n\nx: 需要输入的list集合数据\ncategory.names: 集合名称，默认为list中定义的名称\nshow_intersect: 设置为TRUE时，输出可交互式图像\nset_color: 集合的描边颜色，可输入一个或数量与集合一致的颜色\nset_size: 集合标签的大小\nlabel: 集合中数字标签的类型，可从”both”, “count”, “percent”, “none”中选择一个输入，默认为”both”\nlabel_alpha: 数字标签的背景透明度\nlabel_geom: 数字标签的图层位置，可从”label”, “text”中选择一个，默认为”label”，当输入”text“时标签将位于集合色块的下方\nlabel_color: 数字标签的颜色\nlabel_size: 数字标签的大小\nlabel_percent_digit: 数字标签的小数保留位数\nlabel_txtWidth: 在交互模式时，显示交集元素的文本框宽度\nedge_lty: 集合描边的线条类型，默认为”solid“实线，其他可以设置的线条类型有：“blank”, “solid”, “dashed”, “dotted”, “dotdash”, “longdash”, “twodash”\nedge_size: 集合描边的线条宽度\nforce_upset: 是否使用upset图展示交集情况\nnintersects: 绘图采用的集合数量，如果为NULL则使用所有的集合\norder.intersect.by: 绘制upset图时交集的排列方式\norder.set.by: 绘制upset图时集合的排列方式\nrelative_height: 绘制upset图时上方柱状图的相对高度\nrelative_width: 绘制upset图时左侧柱状图的相对宽度\n\n\n\n\n1. 基础韦恩图\n\n# 基础韦恩图\nggVennDiagram(x)\n\n\n\n\n\n\n\n图 1: 基础韦恩图\n\n\n\n\n\n此图展示了在不同处理下差异基因的交集情况。\n\n\n2. 美化韦恩图\nggVennDiagram中集合的颜色是根据集合中包含的元素数量设置的连续型变量。可以通过ggplot2中的scale_fill_gradient或scale_fill_gradient2等函数修改集合颜色，例如使用以下代码实现连续色彩设置：\n\n# 颜色设置\nggVennDiagram(x) + scale_fill_gradient(low=\"grey90\",high = \"red\")\n\n\n\n\n\n\n\n图 2: 颜色设置\n\n\n\n\n\n也可以使用scale_fill_gradient2来更自由地定义颜色：\n\n# 颜色设置\nggVennDiagram(x) + scale_fill_gradient2(low=\"grey90\",mid = \"yellow\",midpoint = 100,high = \"red\")\n\n\n\n\n\n\n\n图 3: 颜色设置\n\n\n\n\n\n更复杂的色彩设置可以通过调用调色板完成：\n\n# 颜色设置\nggVennDiagram(x) + scale_fill_distiller(palette = \"Set1\") \n\n\n\n\n\n\n\n图 4: 颜色设置\n\n\n\n\n\n需要自定义调色板也非常简单：\n\n# 颜色设置\ncols &lt;- c('#E64E00','#65B48E','#E6EB00','#E64E00')\npal &lt;- colorRampPalette(cols)\nggVennDiagram(x) + scale_fill_gradientn(colors = pal(10)) # 数字为色阶数量\n\n\n\n\n\n\n\n图 5: 颜色设置\n\n\n\n\n\nggVennDiagram同样可以通过edge_lty、edge_size、set_color自定义集合的边框。\n\n# 边框设置\nggVennDiagram(x, set_color=c(\"blue\",\"red\",\"green\",\"purple\"), edge_lty=\"dashed\", edge_size=2)\n\n\n\n\n\n\n\n图 6: 边框设置\n\n\n\n\n\n字体设置可以通过以下参数修改：\n\n# 字体设置\n# 下列参数中较为特殊的是label，label的四个可选输入中\"percent\"为仅显示百分比， \"count\"为仅显示数量，“none”为不显示。\nggVennDiagram(x, set_size = 5, label = \"percent\", label_alpha = 0, \n              label_color = \"red\", label_size = 5, label_percent_digit = 2)\n\n\n\n\n\n\n\n图 7: 字体设置\n\n\n\n\n\n\n\n3. VennDiagram\n我们还可以通过VennDiagram包来绘制韦恩图。\n\n\n\n\n\n\n提示\n\n\n\nvenn.diagram基本参数:\n\nx: 需要输入的list集合数据\nfilename: 输出文件名\nimagetype: 输出文件类型可从”tiff”,“png”,“svg”中选择\nunits: 图片尺寸单位可从”cm”,“px”,“unit”中选择\nheight: 图片高度\nwidth: 图片宽度\nresolution: 图片分辨率\ncompression: 图片压缩算法\nscaled: 根据比例显示集合大小\nalpha: 集合透明度\nfill: 集合颜色\ncol: 线条颜色\nlwd: 线条粗细\nlty: 线条形状，1为实线, 2为虚线, blank为无线条\nlabel.col: 数字颜色\ncex: 数字大小\ncat.dist: 标签距离集合的远近\ncat.pos: 标签相对于集合的角度\ncat.cex: 标签字体大小\ncat.col: 标签颜色\n\n\n\nVennDiagram包的核心函数为venn.diagram，该函数不能直接将图像绘制到画板上，可以通过与grid::grid.draw()函数配合将图像绘制到画板。\n\np &lt;- venn.diagram(x,filename = NULL);grid::grid.draw(p)\n\n\n\n\n\n\n\n图 8: venn.diagram\n\n\n\n\n\nVennDiagram集合颜色设置于ggVennDiagram最大的区别在于颜色是根据不同集合设置的离散型颜色，设置方法如下：\n\n# 仅输入一个颜色时，所有集合显示同一个颜色，当输入颜色数量与集合数量一致时每个集合各自一个颜色，也可以使用指定命名的方式精确设置集合的颜色\np &lt;- venn.diagram(\n  x, filename = NULL,\n  fill = c(\"A\"=\"#2E75A2\",\"B\"=\"#FBD75F\",\"C\"=\"#379337\",\"D\"=\"#C13A3C\"),\n  alpha= 0.3);grid::grid.draw(p)\n\n\n\n\n\n\n\n图 9: 颜色设置\n\n\n\n\n\n线条设置：\n\np &lt;- venn.diagram(\n  x, filename = NULL,\n  col = c(\"A\"=\"#2E75A2\",\"B\"=\"#FBD75F\",\"C\"=\"#379337\",\"D\"=\"#C13A3C\"),\n  lwd = 0.3, lty = 2);grid::grid.draw(p)\n\n\n\n\n\n\n\n图 10: 线条设置\n\n\n\n\n\n字体设置，如果需要调整位置请使用 cat.dist、cat.pos 参数：\n\np &lt;- venn.diagram(\n  x, filename = NULL, \n  cat.col =c(\"A\"=\"#2E75A2\",\"B\"=\"#FBD75F\",\"C\"=\"#379337\",\"D\"=\"#C13A3C\"),\n  label.col = \"red\");grid::grid.draw(p)\n\n\n\n\n\n\n\n图 11: 字体设置\n\n\n\n\n\n按照比例展示集合大小，该模式仅适用于两个集合使用：\n\np &lt;- venn.diagram(\n  x[c(\"A\",\"B\")], filename = NULL, fill= c(\"A\"=\"#2E75A2\",\"B\"=\"#FBD75F\"),\n  scaled = T\n);grid::grid.draw(p)\n\n\n\n\n\n\n\n图 12: scaled",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "VeenPlot"
    ]
  },
  {
    "objectID": "Ranking/VennPlot.html#应用场景",
    "href": "Ranking/VennPlot.html#应用场景",
    "title": "韦恩图",
    "section": "应用场景",
    "text": "应用场景\n\n\n\n\n\n\n图 13: 韦恩图应用\n\n\n\n此图中R1-R4为四种不同的基因型，由于R2 R4在目的基因处基因型完全相同，因此R2R4共有的差异表达基因可能就是目的基因的下游 [4]。",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "VeenPlot"
    ]
  },
  {
    "objectID": "Ranking/VennPlot.html#参考文献",
    "href": "Ranking/VennPlot.html#参考文献",
    "title": "韦恩图",
    "section": "参考文献",
    "text": "参考文献\n[1] Yu Y, Li W, Liu Y, Liu Y, Zhang Q, Ouyang Y, Ding W, Xue Y, Zou Y, Yan J, Jia A, Yan J, Hao X, Gou Y, Zhai Z, Liu L, Zheng Y, Zhang B, Xu J, Yang N, Xiao Y, Zhuo L, Lai Z, Yin P, Liu HJ, Fernie AR, Jackson D, Yan J. A Zea genus-specific micropeptide controls kernel dehydration in maize. Cell. 2025 Jan 9;188(1):44-59.e21. doi: 10.1016/j.cell.2024.10.030. Epub 2024 Nov 12. PMID: 39536747.",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "VeenPlot"
    ]
  },
  {
    "objectID": "Ranking/Table.html",
    "href": "Ranking/Table.html",
    "title": "表格",
    "section": "",
    "text": "表格既是一种可视化交流模式，又是一种组织整理数据的手段。",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Table"
    ]
  },
  {
    "objectID": "Ranking/Table.html#示例",
    "href": "Ranking/Table.html#示例",
    "title": "表格",
    "section": "示例",
    "text": "示例\n\n\n\n\n\n以上图表是一个基本表格，包含标题行和6行数据。",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Table"
    ]
  },
  {
    "objectID": "Ranking/Table.html#环境配置",
    "href": "Ranking/Table.html#环境配置",
    "title": "表格",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：gt, gtExtras, dplyr\n\n\n# 安装包\nif (!requireNamespace(\"gt\", quietly = TRUE)) {\n  install.packages(\"gt\", type = \"binary\")\n}\nif (!requireNamespace(\"gtExtras\", quietly = TRUE)) {\n  install.packages(\"gtExtras\")\n}\nif (!requireNamespace(\"readr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\n\n# 加载包\nlibrary(gt)\nlibrary(gtExtras) # 用于绘制高亮行/列\nlibrary(dplyr)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package  * version date (UTC) lib source\n dplyr    * 1.1.4   2023-11-17 [1] RSPM\n gt       * 1.2.0   2025-12-16 [1] RSPM\n gtExtras * 0.6.1   2025-10-10 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Table"
    ]
  },
  {
    "objectID": "Ranking/Table.html#数据准备",
    "href": "Ranking/Table.html#数据准备",
    "title": "表格",
    "section": "数据准备",
    "text": "数据准备\n选取iris数据集前7行和UCSC Xena数据库的胃癌临床数据前7行。\n\n# 1.选取iris数据集前7行\ndata &lt;- iris[1:7,]\n\nhead(data)\n\n  Sepal.Length Sepal.Width Petal.Length Petal.Width Species\n1          5.1         3.5          1.4         0.2  setosa\n2          4.9         3.0          1.4         0.2  setosa\n3          4.7         3.2          1.3         0.2  setosa\n4          4.6         3.1          1.5         0.2  setosa\n5          5.0         3.6          1.4         0.2  setosa\n6          5.4         3.9          1.7         0.4  setosa\n\n# 2.UCSC Xena数据库胃癌临床数据前7行（仅在绘制三线表的时候使用了该临床数据）\ndata_clinical &lt;- read.table(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/TCGA-STAD.survival.tsv\", header = TRUE, sep = \"\\t\")\ndata_clinical &lt;- data_clinical[1:7,]\n\nhead(data_clinical)\n\n            sample OS.time OS    X_PATIENT\n1 TCGA-CG-4306-01A       1  1 TCGA-CG-4306\n2 TCGA-HU-A4GQ-01A       3  1 TCGA-HU-A4GQ\n3 TCGA-FP-A8CX-01A       7  0 TCGA-FP-A8CX\n4 TCGA-HU-A4GY-01A       8  0 TCGA-HU-A4GY\n5 TCGA-HU-A4GY-11A       8  0 TCGA-HU-A4GY\n6 TCGA-BR-8363-01A       8  1 TCGA-BR-8363",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Table"
    ]
  },
  {
    "objectID": "Ranking/Table.html#可视化",
    "href": "Ranking/Table.html#可视化",
    "title": "表格",
    "section": "可视化",
    "text": "可视化\n\n1. 基本绘图\n\n# 调用gt()函数即可绘图\ngt(data)\n\n\n\n\n\n\n\n\n\nSepal.Length\nSepal.Width\nPetal.Length\nPetal.Width\nSpecies\n\n\n\n\n5.1\n3.5\n1.4\n0.2\nsetosa\n\n\n4.9\n3.0\n1.4\n0.2\nsetosa\n\n\n4.7\n3.2\n1.3\n0.2\nsetosa\n\n\n4.6\n3.1\n1.5\n0.2\nsetosa\n\n\n5.0\n3.6\n1.4\n0.2\nsetosa\n\n\n5.4\n3.9\n1.7\n0.4\nsetosa\n\n\n4.6\n3.4\n1.4\n0.3\nsetosa\n\n\n\n\n\n\n\n图 1: 基本绘图\n\n\n\n\n这个表直接调用gt()函数就可绘制。\n\n\n2. 数据居中\n\n# auto_align = FALSE即取消自动对齐就是居中\ngt(data,auto_align = FALSE)\n\n\n\n\n\n\n\n\n\nSepal.Length\nSepal.Width\nPetal.Length\nPetal.Width\nSpecies\n\n\n\n\n5.1\n3.5\n1.4\n0.2\nsetosa\n\n\n4.9\n3.0\n1.4\n0.2\nsetosa\n\n\n4.7\n3.2\n1.3\n0.2\nsetosa\n\n\n4.6\n3.1\n1.5\n0.2\nsetosa\n\n\n5.0\n3.6\n1.4\n0.2\nsetosa\n\n\n5.4\n3.9\n1.7\n0.4\nsetosa\n\n\n4.6\n3.4\n1.4\n0.3\nsetosa\n\n\n\n\n\n\n\n图 2: 数据居中\n\n\n\n\n表中的数据处于居中的布局。\n\n\n3. 添加标题\n\n# tab_heade()添加主标题和副标题\ngt(data) %&gt;%                   # \"%&gt;%\"是管道操作符，可以完成一系列管道化操作\n  tab_header(title = md(\"**Iris** DataSet\"),     # 添加标题,md是以markdown格式显示文本\n             # 添加副标题\n             subtitle = md(\"The species includes *Iris setosa, versicolor, and virginica*\"))\n\n\n\n\n\n\n\n\n\nIris DataSet\n\n\nThe species includes Iris setosa, versicolor, and virginica\n\n\nSepal.Length\nSepal.Width\nPetal.Length\nPetal.Width\nSpecies\n\n\n\n\n5.1\n3.5\n1.4\n0.2\nsetosa\n\n\n4.9\n3.0\n1.4\n0.2\nsetosa\n\n\n4.7\n3.2\n1.3\n0.2\nsetosa\n\n\n4.6\n3.1\n1.5\n0.2\nsetosa\n\n\n5.0\n3.6\n1.4\n0.2\nsetosa\n\n\n5.4\n3.9\n1.7\n0.4\nsetosa\n\n\n4.6\n3.4\n1.4\n0.3\nsetosa\n\n\n\n\n\n\n\n图 3: 添加标题\n\n\n\n\n表中按照markdown格式添加了标题和副标题。\n\n\n4. 添加脚注\n\n# 使用tab_footnote()添标题的脚注\ngt(data) %&gt;%\n  tab_header(title = md(\"**Iris** DataSet\"),\n             subtitle = md(\"The species includes *Iris setosa\n                           , versicolor, and virginica*\")) %&gt;%\n  tab_footnote(footnote = \"Source: R help files\",\n               locations = cells_title(groups=\"title\"))\n\n\n\n\n\n\n\n\n\nIris DataSet1\n\n\nThe species includes Iris setosa , versicolor, and virginica\n\n\nSepal.Length\nSepal.Width\nPetal.Length\nPetal.Width\nSpecies\n\n\n\n\n5.1\n3.5\n1.4\n0.2\nsetosa\n\n\n4.9\n3.0\n1.4\n0.2\nsetosa\n\n\n4.7\n3.2\n1.3\n0.2\nsetosa\n\n\n4.6\n3.1\n1.5\n0.2\nsetosa\n\n\n5.0\n3.6\n1.4\n0.2\nsetosa\n\n\n5.4\n3.9\n1.7\n0.4\nsetosa\n\n\n4.6\n3.4\n1.4\n0.3\nsetosa\n\n\n\n1 Source: R help files\n\n\n\n\n\n\n\n\n图 4: 添加脚注\n\n\n\n\n这个表添加了标题Iris数据集的脚注。\n\n\n5. 添加合并单元格标签\n\n# tab_spanner()添加合并单元格标签\ngt(data) %&gt;%\n  tab_header(title = md(\"**Iris** DataSet\"),\n             subtitle = md(\"The species includes *Iris setosa\n                           , versicolor, and virginica*\")) %&gt;%\n  tab_footnote(footnote = \"Source: R help files\",\n               locations = cells_title(groups=\"title\")) %&gt;%\n  tab_spanner(\n    label = \"Sepal\",columns = c(Sepal.Length, Sepal.Width)) %&gt;%\n  tab_spanner(\n    label = \"Petal\",columns = c(Petal.Length, Petal.Width))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nIris DataSet1\n\n\nThe species includes Iris setosa , versicolor, and virginica\n\n\n\nSepal\n\n\nPetal\n\nSpecies\n\n\nSepal.Length\nSepal.Width\nPetal.Length\nPetal.Width\n\n\n\n\n5.1\n3.5\n1.4\n0.2\nsetosa\n\n\n4.9\n3.0\n1.4\n0.2\nsetosa\n\n\n4.7\n3.2\n1.3\n0.2\nsetosa\n\n\n4.6\n3.1\n1.5\n0.2\nsetosa\n\n\n5.0\n3.6\n1.4\n0.2\nsetosa\n\n\n5.4\n3.9\n1.7\n0.4\nsetosa\n\n\n4.6\n3.4\n1.4\n0.3\nsetosa\n\n\n\n1 Source: R help files\n\n\n\n\n\n\n\n\n图 5: 添加合并单元格标签\n\n\n\n\n这个表使用了tab_spanner()添加”Sepal”，“Petal”合并单元格标签。\n\n\n6. 添加高亮列/高亮行\n\n# 添加高亮列\\高亮行\ngt(data,auto_align = FALSE) %&gt;% \n  gt_highlight_cols(Petal.Length,fill = \"blue\", \n                    alpha = 0.5) %&gt;% \n  gt_highlight_rows(rows = c(1,3))      \n\n\n\n\n\n\n\n\n\nSepal.Length\nSepal.Width\nPetal.Length\nPetal.Width\nSpecies\n\n\n\n\n5.1\n3.5\n1.4\n0.2\nsetosa\n\n\n4.9\n3.0\n1.4\n0.2\nsetosa\n\n\n4.7\n3.2\n1.3\n0.2\nsetosa\n\n\n4.6\n3.1\n1.5\n0.2\nsetosa\n\n\n5.0\n3.6\n1.4\n0.2\nsetosa\n\n\n5.4\n3.9\n1.7\n0.4\nsetosa\n\n\n4.6\n3.4\n1.4\n0.3\nsetosa\n\n\n\n\n\n\n\n图 6: 添加高亮列/高亮行\n\n\n\n\n这个表设置了高亮列Petal.Length，和高亮行1、3行。\n\n\n7. md()和html()添加文本\n\n# md()和html()添加文本\ngt(data) %&gt;%\n# title使用md()加粗，以及添加超链接。subtitle使用html()加下划线，斜体和颜色。\n  tab_header(title = md(\"[**Iris** DataSet](https://r-graph-gallery.com/)\"),\n             subtitle = html(\"&lt;u style='color:red;'&gt;The species includes Iris\n                                 &lt;i&gt;setosa, versicolor, and virginica\n                             &lt;/i&gt;&lt;/u&gt;\"))   \n\n\n\n\n\n\n\n\n\nIris DataSet\n\n\nThe species includes Iris setosa, versicolor, and virginica\n\n\nSepal.Length\nSepal.Width\nPetal.Length\nPetal.Width\nSpecies\n\n\n\n\n5.1\n3.5\n1.4\n0.2\nsetosa\n\n\n4.9\n3.0\n1.4\n0.2\nsetosa\n\n\n4.7\n3.2\n1.3\n0.2\nsetosa\n\n\n4.6\n3.1\n1.5\n0.2\nsetosa\n\n\n5.0\n3.6\n1.4\n0.2\nsetosa\n\n\n5.4\n3.9\n1.7\n0.4\nsetosa\n\n\n4.6\n3.4\n1.4\n0.3\nsetosa\n\n\n\n\n\n\n\n图 7: md()和html()添加文本\n\n\n\n\n这个表通过md()和html()添加文本，修改文本样式。可以了解markdown格式和html格式的基本语法对添加的文本格式进行更改。\n\n\n8. 更改表格样式\ntab_style()有着丰富的表格样式内容，包含表格颜色填充，表格内容颜色、对齐方式、大小等，边框样式的更改。参数style设置样式，locations设置样式生效的位置。\n三线表\n\n# cell_borders()表示单元格边框，cells_body()是表格主体的位置\ngt(data_clinical,auto_align = FALSE) %&gt;% \n  tab_style(\n    style=cell_borders(sides = \"bottom\", \n                       style=\"hidden\"),             # 样式设置为隐藏\n    locations=cells_body(rows=c(1,2,3,4,5,6))       # 定位到主体行除最后一行的底部\n  )\n\n\n\n\n\n\n\n\n\nsample\nOS.time\nOS\nX_PATIENT\n\n\n\n\nTCGA-CG-4306-01A\n1\n1\nTCGA-CG-4306\n\n\nTCGA-HU-A4GQ-01A\n3\n1\nTCGA-HU-A4GQ\n\n\nTCGA-FP-A8CX-01A\n7\n0\nTCGA-FP-A8CX\n\n\nTCGA-HU-A4GY-01A\n8\n0\nTCGA-HU-A4GY\n\n\nTCGA-HU-A4GY-11A\n8\n0\nTCGA-HU-A4GY\n\n\nTCGA-BR-8363-01A\n8\n1\nTCGA-BR-8363\n\n\nTCGA-BR-A4J9-01A\n14\n0\nTCGA-BR-A4J9\n\n\n\n\n\n\n\n图 8: 三线表\n\n\n\n\n这个表类似于常用的三线表的图表格式，表格内容是胃癌的临床数据。\n\n\n\n\n\n\n提示\n\n\n\n关键参数: style / locations\n\nstyle：设置单元格的样式，可选项有cell_fill()：单元格填充，cell_text()：单元格文本，cell_borders()：单元格边框。可用list()包含多项样式内容。\nlocations：将style样式应用到的位置，可选项有cells_title()：表格标题，cells_body()：表格主体，cells_footnotes()：表格脚注， cells_column_labels()：表格列名等。可用list()表示多项位置。 cells_body()的参数有rows和columns，用于指定行和列。cells_column_labels()的参数有columns，用于指定列。\n\n\n\n全边框表格\n\n# 全边框表格\ngt(data,auto_align = FALSE) %&gt;% \n  tab_style(\n    style=cell_borders(sides = c(\"top\", \"bottom\",\"left\",\"right\"),\n                       weight = px(2)),            # 上下左右边框都设置出来\n    locations=list(cells_body(),cells_column_labels())  # 多类型或者多位置可以用list，cells_column_labels()是指列名。\n  )\n\n\n\n\n\n\n\n\n\nSepal.Length\nSepal.Width\nPetal.Length\nPetal.Width\nSpecies\n\n\n\n\n5.1\n3.5\n1.4\n0.2\nsetosa\n\n\n4.9\n3.0\n1.4\n0.2\nsetosa\n\n\n4.7\n3.2\n1.3\n0.2\nsetosa\n\n\n4.6\n3.1\n1.5\n0.2\nsetosa\n\n\n5.0\n3.6\n1.4\n0.2\nsetosa\n\n\n5.4\n3.9\n1.7\n0.4\nsetosa\n\n\n4.6\n3.4\n1.4\n0.3\nsetosa\n\n\n\n\n\n\n\n图 9: 全边框表格\n\n\n\n\n这个表的边框全部显示了出来，除了三线格和全边框表格，只要用tab_style()可以任意改变单元框的有无，颜色，粗细，样式。\n\n\n9. 更改文本样式\n\n# 更改文本样式\ngt(data) %&gt;% \n  tab_style(\n    style=cell_text(color=\"blue\",font=\"bold\",size=\"large\",align=\"center\",\n                    v_align=\"middle\",style=\"italic\",weight=\"normal\",\n                    decorate=\"underline\"),            \n    locations=cells_body(rows=2,columns=Sepal.Length)\n  )\n\n\n\n\n\n\n\n\n\nSepal.Length\nSepal.Width\nPetal.Length\nPetal.Width\nSpecies\n\n\n\n\n5.1\n3.5\n1.4\n0.2\nsetosa\n\n\n4.9\n3.0\n1.4\n0.2\nsetosa\n\n\n4.7\n3.2\n1.3\n0.2\nsetosa\n\n\n4.6\n3.1\n1.5\n0.2\nsetosa\n\n\n5.0\n3.6\n1.4\n0.2\nsetosa\n\n\n5.4\n3.9\n1.7\n0.4\nsetosa\n\n\n4.6\n3.4\n1.4\n0.3\nsetosa\n\n\n\n\n\n\n\n图 10: 更改文本样式\n\n\n\n\n这个表更改了第二行第一列的文本样式。\n\n\n\n\n\n\n提示\n\n\n\n关键参数: size/align/v_align/style/weight/decorate\n\nsize：文本大小，可选项有”xx-small”,“x-small”,“small”,“medium”,“large”,“x-large”,“xx-large”，或者px()自定义值。\nalign：水平对齐方式，可选项有”center”,“left”,“right”,“justify”(每行对齐)。\nv_align：垂直对齐方式，可选项有”top”,“bottom”,“middle”。\nstyle：文本样式，可选项有 “normal”,“italic”(斜体),“oblique”(也是斜体)。\nweight：文本的粗细，可选项有”normal”,“bold”(粗),“lighter”(更细),“bolder”(更粗)，或者1-1000的数字。\ndecorate：添加线段，可选项有”overline”(线在文本上),“line-through”(线从文本穿过),“underline”(线在文本下)。\n\n\n\n\n\n10. 更改填充样式\n\n# 更改填充样式\ngt(data) %&gt;% \n  tab_style(\n    style=cell_fill(color = \"yellow\", alpha =0.5),  #就两个参数，颜色和透明度         \n    locations=cells_body(rows=2,columns=Sepal.Length) \n  )\n\n\n\n\n\n\n\n\n\nSepal.Length\nSepal.Width\nPetal.Length\nPetal.Width\nSpecies\n\n\n\n\n5.1\n3.5\n1.4\n0.2\nsetosa\n\n\n4.9\n3.0\n1.4\n0.2\nsetosa\n\n\n4.7\n3.2\n1.3\n0.2\nsetosa\n\n\n4.6\n3.1\n1.5\n0.2\nsetosa\n\n\n5.0\n3.6\n1.4\n0.2\nsetosa\n\n\n5.4\n3.9\n1.7\n0.4\nsetosa\n\n\n4.6\n3.4\n1.4\n0.3\nsetosa\n\n\n\n\n\n\n\n图 11: 更改填充样式\n\n\n\n\n这个表增加了第二行第一列的填充样式。",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Table"
    ]
  },
  {
    "objectID": "Ranking/Table.html#应用场景",
    "href": "Ranking/Table.html#应用场景",
    "title": "表格",
    "section": "应用场景",
    "text": "应用场景\n\n\n\n\n\n\n图 12: 表格应用场景1\n\n\n\n以上图表是Bahir Dar市综合性专科公立医院收治的RTA成年患者生存状况及其预测因素的样本量统计。 [1]\n\n\n\n\n\n\n图 13: 表格应用场景2\n\n\n\n以上图表显示了，2021年6月1日至2022年2月30日，亚的斯亚贝巴泽曼初级医院门诊和自愿咨询检测诊所（n=240）疟疾患者和健康对照组的基本凝血情况比较。[2]\n\n\n\n\n\n\n图 14: 表格应用场景3\n\n\n\n以上图表是对长期新冠肺炎症状患者和无长期新冠病毒症状患者的手术特征和结果的比较。[3]",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Table"
    ]
  },
  {
    "objectID": "Ranking/Table.html#参考文献",
    "href": "Ranking/Table.html#参考文献",
    "title": "表格",
    "section": "参考文献",
    "text": "参考文献\n[1] KEBEDE A G, TEGENAW A, TAMIR Y, et al. Survival status and its predictors among adult victims of road traffic accident admitted to public hospitals of Bahir Bar City, Amhara regional state, Northwest, Ethiopia, 2023: multi center retrospective follow-up study[J]. BMC Emerg Med, 2024,24(1): 177.\n[2] TIRUNEH T, ALMAW A, ABEBAW A, et al. Basic coagulation parameters and platelet count among malaria patients attending at Addis Zemen Primary Hospital, Northwest Ethiopia[J]. BMC Infect Dis, 2024,24(1): 1069.\n[3] GOLDHABER N H, RAMESH K, HORTON L E, et al. The Long Haul to Surgery: Long COVID Has Minimal Burden on Surgical Departments[J]. Int J Environ Res Public Health, 2024,21(9).",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Table"
    ]
  },
  {
    "objectID": "Correlation/PCAplot.html",
    "href": "Correlation/PCAplot.html",
    "title": "PCA图",
    "section": "",
    "text": "在高维数据的分析中，主成分分析(PCA)是一种常用的降维技术，其主要原理是通过找出方差最大的两个主成分方向来变换数据，通过线性变换将高维数据投影到低维空间，同时保留数据的主要特征。本文将展示如何在R中进行PCA分析，并使用鸢尾花数据集进行可视化。",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "PCA Plot"
    ]
  },
  {
    "objectID": "Correlation/PCAplot.html#示例",
    "href": "Correlation/PCAplot.html#示例",
    "title": "PCA图",
    "section": "",
    "text": "在高维数据的分析中，主成分分析(PCA)是一种常用的降维技术，其主要原理是通过找出方差最大的两个主成分方向来变换数据，通过线性变换将高维数据投影到低维空间，同时保留数据的主要特征。本文将展示如何在R中进行PCA分析，并使用鸢尾花数据集进行可视化。",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "PCA Plot"
    ]
  },
  {
    "objectID": "Correlation/PCAplot.html#环境配置",
    "href": "Correlation/PCAplot.html#环境配置",
    "title": "PCA图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：ggplot2, dplyr, ggfortify, FactoMineR, factoextra\n\n\n# 安装包\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"ggfortify\", quietly = TRUE)) {\n  install.packages(\"ggfortify\")\n}\nif (!requireNamespace(\"FactoMineR\", quietly = TRUE)) {\n  install.packages(\"FactoMineR\")\n}\nif (!requireNamespace(\"factoextra\", quietly = TRUE)) {\n  install.packages(\"factoextra\")\n}\n\n# 加载包\nlibrary(ggplot2)\nlibrary(ggfortify)\nlibrary(FactoMineR)\nlibrary(factoextra)\nlibrary(dplyr)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n dplyr      * 1.1.4   2023-11-17 [1] RSPM\n factoextra * 1.0.7   2020-04-01 [1] RSPM\n FactoMineR * 2.12    2025-07-23 [1] RSPM\n ggfortify  * 0.4.19  2025-07-27 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "PCA Plot"
    ]
  },
  {
    "objectID": "Correlation/PCAplot.html#数据准备",
    "href": "Correlation/PCAplot.html#数据准备",
    "title": "PCA图",
    "section": "数据准备",
    "text": "数据准备\n使用R自带数据集iris中的鸢尾花数据集进行演示\n\ndata(\"iris\")\nhead(iris) \n\n  Sepal.Length Sepal.Width Petal.Length Petal.Width Species\n1          5.1         3.5          1.4         0.2  setosa\n2          4.9         3.0          1.4         0.2  setosa\n3          4.7         3.2          1.3         0.2  setosa\n4          4.6         3.1          1.5         0.2  setosa\n5          5.0         3.6          1.4         0.2  setosa\n6          5.4         3.9          1.7         0.4  setosa",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "PCA Plot"
    ]
  },
  {
    "objectID": "Correlation/PCAplot.html#可视化",
    "href": "Correlation/PCAplot.html#可视化",
    "title": "PCA图",
    "section": "可视化",
    "text": "可视化\nPCA分析\n我们首先对数据进行执行PCA分析。需要注意的是，数据需要在标准化后进行分析，函数prcomp()中的参数scale为我们提供了自动标准化的选项：\n\niris.pca &lt;- prcomp(iris[, -5], scale = TRUE)\nsummary(iris.pca)\n\nImportance of components:\n                          PC1    PC2     PC3     PC4\nStandard deviation     1.7084 0.9560 0.38309 0.14393\nProportion of Variance 0.7296 0.2285 0.03669 0.00518\nCumulative Proportion  0.7296 0.9581 0.99482 1.00000\n\n\n\n1. 方差解释与变量贡献可视化\n在summary(iris.pca)中可以看到，我们已经从数据集中提取出了多个主成分PC从新的”视角”描述数据。我们可以使用fviz_eig()绘制下面的柱状图来显示每个主成分所解释的数据方差比例。同时fviz_pca_var()绘制的变量贡献图显示了原始变量（即花瓣长度、宽度等原始特征）与前两名的主成分的关系，箭头长度表示变量贡献度（参数指定col.var = \"contrib\"）：\n\nfviz_eig(iris.pca, \n         addlabels = TRUE, \n         ylim = c(0, 85),\n         main = \"PCA方差解释比例\",\n         xlab = \"PC\",\n         ylab = \"解释方差百分比\")\n\n\n\n\n\n\n\n图 1: fviz_eig\n\n\n\n\n\n\nfviz_pca_var(iris.pca,\n             col.var = \"contrib\",\n             gradient.cols = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"),\n             repel = TRUE,\n             title = \"变量贡献图\")\n\n\n\n\n\n\n\n图 2: fviz_pca_var\n\n\n\n\n\n\n\n2. 样本在主成分空间上的分布\n上面我们已经完成了对数据的变换，现在可以展示样本在这个新的主成分空间上的分布。如果主成分对方差的解释度高，那么我们将看到不同种类的鸢尾花在主成分空间上相互远离，而同种类的鸢尾花则相互靠近。fviz_pca_ind()可以绘制PC1和PC2方向上的数据散点图，按鸢尾花种类着色并添加置信椭圆。\n\nfviz_pca_ind(iris.pca,\n             col.ind = iris$Species,\n             geom.ind = \"point\",\n             palette = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"),\n             addEllipses = TRUE,\n             ellipse.type = \"confidence\",\n             legend.title = \"Species\",\n             # repel = TRUE,\n             title = \"样本PCA得分图\")\n\n\n\n\n\n\n\n图 3: fviz_pca_ind\n\n\n\n\n\n\n\n\n\n\n\n提示\n\n\n\n参数说明：\n\ncol.ind: 输入数据的分类变量\ngeom.ind: 选择绘制的散点形状类型，默认为带有label的散点，这里输入”point”会让散点不显示label\npalette: 应用于分类变量的颜色向量\naddEllipses: 是否添加椭圆圈\nellipse.type: 椭圆圈的计算方式，允许值有”convex”、“confidence”、“t”、“norm”、“euclid”等\nlegend.title: 图例标题\nrepel: 是否使用延长线标记数据点\ntitle: 图片标题\n\n\n\n与fviz_pca_ind()类似，fviz_pca_biplot()可以在样本散点的基础上添加原始的变量信息。\n\nfviz_pca_biplot(iris.pca,\n                col.ind = iris$Species,\n                palette = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"),\n                addEllipses = TRUE,\n                geom.ind = \"point\",\n                ellipse.type = \"confidence\",\n                legend.title = \"Species\",\n                # repel = TRUE,\n                title = \"PCA双标图\")\n\n\n\n\n\n\n\n图 4: fviz_pca_biplot\n\n\n\n\n\n此外，我们还可以使用ggplot2自定义绘制PCA样本图：\n\npca_scores &lt;- as.data.frame(iris.pca$x)\npca_scores$Species &lt;- iris$Species\n\nggplot(pca_scores, aes(x = PC1, y = PC2, color = Species)) +\n  geom_point(size = 3, alpha = 0.8) +\n  stat_ellipse(level = 0.95, linewidth = 1) +\n  scale_color_manual(values = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\")) +\n  labs(title = \"鸢尾花数据集PCA分析\",\n       x = paste0(\"PC1 (\", round(summary(iris.pca)$importance[2,1]*100, 1), \"%)\"),\n       y = paste0(\"PC2 (\", round(summary(iris.pca)$importance[2,2]*100, 1), \"%)\"),\n       caption = \"置信水平: 95%\") +\n  theme_minimal(base_size = 12) +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\n\n\n图 5: ggplot2自定义绘制PCA样本图\n\n\n\n\n\n\n\n3. 使用FactoMineR进行PCA分析\nFactoMineR是一个专门为多维数据分析和探索设计的R包，其中也提供了便捷的PCA分析函数PCA()。下面简单演示其使用与可视化：\n\nres.pca &lt;- PCA(iris[, -5], scale.unit = TRUE, graph = FALSE)\nfviz_pca_ind(res.pca, \n             label = \"none\", \n             habillage = iris$Species,\n             addEllipses = TRUE, \n             ellipse.level = 0.95,\n             title = \"FactoMineR PCA结果\")\n\n\n\n\n\n\n\n图 6: FactoMineR绘制PCA图",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "PCA Plot"
    ]
  },
  {
    "objectID": "Correlation/PCAplot.html#应用场景",
    "href": "Correlation/PCAplot.html#应用场景",
    "title": "PCA图",
    "section": "应用场景",
    "text": "应用场景\n\n\n\n\n\n\n图 7: PCA图应用\n\n\n\n该图展示了梨状皮层输出神经元到 AON、CoA、lENT 和 OT 的平均投射强度的前两个主成分，每个点表示一个切片。[1]",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "PCA Plot"
    ]
  },
  {
    "objectID": "Correlation/PCAplot.html#参考文献",
    "href": "Correlation/PCAplot.html#参考文献",
    "title": "PCA图",
    "section": "参考文献",
    "text": "参考文献\n[1] Chen Y, Chen X, Baserdem B. et al. High-throughput sequencing of single neuron projections reveals spatial organization in the olfactory cortex. Cell. 2022 Oct 27;185(22):4117-4134.e28.",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "PCA Plot"
    ]
  },
  {
    "objectID": "Correlation/UMAPplot.html",
    "href": "Correlation/UMAPplot.html",
    "title": "UMAP图",
    "section": "",
    "text": "UMAP（Uniform Manifold Approximation and Projection，均匀流形近似和投影）是一种强大的非线性降维技术，主要应用于处理高维数据。UMAP算法的核心在于保持数据的局部和全局结构，通过构建数据点之间的邻近关系图，利用图的拓扑结构进行流形近似和优化。它能够将高维数据有效地映射到低维空间，以便于可视化和进一步分析，在生物信息学中，非常适合用于处理基因表达、微生物组等具有高维特征的数据。下面我们将分别展示在二分类的临床数据和单细胞测序数据中UMAP的应用。",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "UMAP Plot"
    ]
  },
  {
    "objectID": "Correlation/UMAPplot.html#示例",
    "href": "Correlation/UMAPplot.html#示例",
    "title": "UMAP图",
    "section": "",
    "text": "UMAP（Uniform Manifold Approximation and Projection，均匀流形近似和投影）是一种强大的非线性降维技术，主要应用于处理高维数据。UMAP算法的核心在于保持数据的局部和全局结构，通过构建数据点之间的邻近关系图，利用图的拓扑结构进行流形近似和优化。它能够将高维数据有效地映射到低维空间，以便于可视化和进一步分析，在生物信息学中，非常适合用于处理基因表达、微生物组等具有高维特征的数据。下面我们将分别展示在二分类的临床数据和单细胞测序数据中UMAP的应用。",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "UMAP Plot"
    ]
  },
  {
    "objectID": "Correlation/UMAPplot.html#环境配置",
    "href": "Correlation/UMAPplot.html#环境配置",
    "title": "UMAP图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：umap, ggplot2, patchwork, RColorBrewer, Seurat, SeuratData, dplyr, mlbench\n\n\n# 安装包\nif (!requireNamespace(\"umap\", quietly = TRUE)) {\n  install.packages(\"umap\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"patchwork\", quietly = TRUE)) {\n  install.packages(\"patchwork\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\nif (!requireNamespace(\"Seurat\", quietly = TRUE)) {\n  install.packages(\"Seurat\")\n}\nif (!requireNamespace(\"SeuratData\", quietly = TRUE)) {\n  remotes::install_github('satijalab/seurat-data')\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"mlbench\", quietly = TRUE)) {\n  install.packages(\"mlbench\")\n}\n\n# 加载包\nlibrary(umap)\nlibrary(ggplot2)\nlibrary(patchwork)\nlibrary(RColorBrewer) \nlibrary(Seurat)      \nlibrary(SeuratData)\nlibrary(dplyr)\nlibrary(mlbench)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "UMAP Plot"
    ]
  },
  {
    "objectID": "Correlation/UMAPplot.html#数据准备",
    "href": "Correlation/UMAPplot.html#数据准备",
    "title": "UMAP图",
    "section": "数据准备",
    "text": "数据准备\n\n1. 临床表型数据：威斯康星乳腺癌数据集\n使用mlbench包中的BreastCancer数据集。该数据最初由威斯康星州医院的Dr. William H. Wolberg收集，包含了从乳腺癌患者收集的肿瘤特征的测量值，如肿瘤的半径、纹理、对称性等，以及相应的良性（benign）或恶性（malignant）标签。为了便于分析，下面对数据进行简单的预处理：\n\ndata(BreastCancer)\nwdbc_data &lt;- BreastCancer[, -1]  # 移除ID列\nwdbc_data &lt;- na.omit(wdbc_data)\nfeatures &lt;- wdbc_data[, 1:9]  # 使用前9个特征\nfeatures &lt;- as.data.frame(lapply(features, function(x) as.numeric(as.character(x))))\ndiagnosis &lt;- wdbc_data$Class\nhead(features) \n\n\n\n2. 单细胞测序数据：IFNB数据集\nIFNB是基于PBMC的数据集，PBMC（Peripheral Blood Mononuclear Cells）是由10x Genomics提供的外周血单个核细胞scRNA-seq数据集，包含了已注释的B 细胞、T 细胞、NK 细胞、单核细胞等。IFNB包含了两个PBMC数据，分别来自干扰素刺激组和对照组。\n单细胞测序数据由于其高维、稀疏的特点，非常适合应用于UMAP降维技术。下面将以IFNB单细胞RNA-seq数据集为例展示单细胞分析中的UMAP降维。该数据集可以通过SeuratData加载。\nRunUMAP()是Seurat提供的UMAP降维函数。下面的代码中提供了单细胞数据UMAP前预处理的简单说明，具体原理及说明可以参照专业的单细胞数据分析教程，这里不再赘述。\n\n# InstallData(\"ifnb\")\n# ifnb &lt;- LoadData(\"ifnb\") # Seurat V4\n\ndata(\"ifnb\") \nifnb &lt;- UpdateSeuratObject(ifnb) # Seurat V5\n\nifnb &lt;- NormalizeData(ifnb) # 对数据进行Log2(x+1)变换\nifnb &lt;- FindVariableFeatures(ifnb) # 提取方差最大的特征用于降维\nifnb &lt;- ScaleData(ifnb) # 数据缩放\nifnb &lt;- RunPCA(ifnb) # PCA预先降维\nifnb &lt;- RunUMAP(ifnb, dims = 1:20) # UMAP降维",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "UMAP Plot"
    ]
  },
  {
    "objectID": "Correlation/UMAPplot.html#可视化",
    "href": "Correlation/UMAPplot.html#可视化",
    "title": "UMAP图",
    "section": "可视化",
    "text": "可视化\n\n1. 临床表型数据UMAP可视化\numap是一个用于进行UMAP降维的R包，其中提供了便捷的umap()函数进行降维和调参。\n\nset.seed(123)\nwdbc_umap &lt;- umap(features, \n                 n_neighbors = 15, \n                 min_dist = 0.2,\n                 metric = \"euclidean\")\n\nggplot(data.frame(wdbc_umap$layout, Diagnosis = diagnosis),\n       aes(X1, X2, color = Diagnosis)) +\n  geom_point(size = 3, alpha = 0.8) +\n  stat_ellipse(level = 0.9) +\n  theme_minimal() +\n  labs(title = \"UMAP of Wisconsin Breast Cancer Dataset\",\n       x = \"UMAP1\", y = \"UMAP2\",\n       subtitle = \"n_neighbors=15, min_dist=0.2\") +\n  scale_color_manual(values = c(\"benign\" = \"#1b9e77\", \"malignant\" = \"#d95f02\"))\n\n\n\n\n\n\n\n图 1: 临床表型数据UMAP可视化\n\n\n\n\n\n\n\n\n\n提示\n\n\n\n参数说明：\n\nn_neighbors: 用于控制局部结构的粒度，较小值能够捕捉更精细的局部结构，但可能过度拟合噪声；较大值有利于保留更多全局结构，但可能模糊局部细节。默认为15\nmin_dist: 控制流形空间中嵌入点的最小间距，较小值下数据点更紧密，局部结构更清晰；较大值下的点会更分散，全局结构更明显\nmetric: 定义距离度量方式，可选\"euclidean\", \"cosine\", \"manhattan\", \"pearson\"\n\n\n\n参数敏感性分析\n我们可以尝试调整UMAP中的不同参数来调整降维效果，下面展示了采用三种不同的参数组合得到的UMAP结果比较。\n\n# 定义参数组合\nparams &lt;- list(\n  list(n_neighbors=5, min_dist=0.1, label=\"Aggressive\"),\n  list(n_neighbors=15, min_dist=0.2, label=\"Default\"),\n  list(n_neighbors=50, min_dist=0.5, label=\"Conservative\")\n)\n\n# 生成UMAP并绘图\nplots &lt;- list()\nfor (i in seq_along(params)) {\n  set.seed(123)\n  umap_res &lt;- umap::umap(features, \n                  n_neighbors = params[[i]]$n_neighbors,\n                  min_dist = params[[i]]$min_dist)\n  \n  df &lt;- data.frame(umap_res$layout, Diagnosis = diagnosis)\n  \n  plots[[i]] &lt;- ggplot(df, aes(X1, X2, color = Diagnosis)) +\n    geom_point(size = 2, alpha = 0.7) +\n    labs(title = paste(\"Params:\", params[[i]]$label),\n         subtitle = sprintf(\"n_neighbors=%d, min_dist=%.1f\", \n                          params[[i]]$n_neighbors, params[[i]]$min_dist),\n         x = \"UMAP1\", y = \"UMAP2\") +\n    theme_minimal(base_size = 10) +\n    scale_color_manual(values = c(\"benign\" = \"#1b9e77\", \"malignant\" = \"#d95f02\"))\n}\n\n# 使用patchwork排版\n(plots[[1]] / plots[[2]] / plots[[3]])\n\n\n\n\n\n\n\n图 2: 参数敏感性分析\n\n\n\n\n\n2. Seurat UMAP可视化\nSeurat中提供了UMAP降维可视化的接口函数DimPlot()，能帮助用户快速可视化单细胞数据。 下面分别展示了我们上面得到的同一个降维空间中，将细胞分别按照细胞类型和处理组别着色的结果。\n（注意：上面的代码中并未进行细胞的聚类，类别结果均来自数据集中预设的注释）\n\nplots &lt;- list()\ngroup_ident &lt;- c('seurat_annotations', 'stim')\nfor (i in seq_along(group_ident)) {\n  p &lt;- DimPlot(ifnb, reduction = 'umap', group.by = group_ident[i])\n  plots[[i]] &lt;- p\n}\n\n(plots[[1]] / plots[[2]])\n\n\n\n\n\n\n\n图 3: Seurat UMAP可视化\n\n\n\n\n\n3. ggplot2自定义UMAP可视化\n除了利用接口函数，我们还可以使用ggplot2自定义绘制UMAP图。\n\n# 提取UMAP坐标和元数据\numap_df &lt;- Embeddings(ifnb, \"umap\") %&gt;% as.data.frame() %&gt;% mutate(CellType = ifnb$seurat_annotations, Treatment = ifnb$stim) \nhead(umap_df)\n\ncustom_colors &lt;- c(\n  \"#8DD3C7\", \"#FFFFB3\", \"#BEBADA\", \"#FB8072\", \"#80B1D3\",\n  \"#FDB462\", \"#B3DE69\", \"#FCCDE5\", \"#D9D9D9\", \"#BC80BD\",\n  \"#CCEBC5\", \"#FFED6F\", \"#A6CEE3\")\n\nggplot(umap_df, aes(UMAP_1, UMAP_2, color = CellType)) +\n      geom_point(size = 1.5, alpha = 0.8) + \n      theme_minimal() + labs(title = \"IFNB UMAP\", x = \"UMAP1\", y = \"UMAP2\") +\n      scale_color_manual(values = custom_colors)\n\n\n\n\n\n\n\n图 4: ggplot2自定义UMAP可视化",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "UMAP Plot"
    ]
  },
  {
    "objectID": "Correlation/UMAPplot.html#应用场景",
    "href": "Correlation/UMAPplot.html#应用场景",
    "title": "UMAP图",
    "section": "应用场景",
    "text": "应用场景\n\n\n\n\n\n\n图 5: UMAP图应用\n\n\n\n如图A-H展示了八个胰岛细胞数据集的 UMAP 图。[1]",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "UMAP Plot"
    ]
  },
  {
    "objectID": "Correlation/UMAPplot.html#参考文献",
    "href": "Correlation/UMAPplot.html#参考文献",
    "title": "UMAP图",
    "section": "参考文献",
    "text": "参考文献\n[1] Stuart T, Butler A, Hoffman P, et al. Comprehensive Integration of Single-Cell Data. Cell. 2019;177(7):1888-1902.e21.",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "UMAP Plot"
    ]
  },
  {
    "objectID": "Correlation/Correlogram.html",
    "href": "Correlation/Correlogram.html",
    "title": "相关图",
    "section": "",
    "text": "相关图或相关矩阵多用于概述整个数据集中各组数据的相关性信息。",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Correlogram"
    ]
  },
  {
    "objectID": "Correlation/Correlogram.html#示例",
    "href": "Correlation/Correlogram.html#示例",
    "title": "相关图",
    "section": "示例",
    "text": "示例\n\n\n\n\n\n例如上图则为mtcars数据集中各组数据的相关性热图，用颜色来表示不同组别数据的两两相关性，颜色的深浅代表了P值的大小。",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Correlogram"
    ]
  },
  {
    "objectID": "Correlation/Correlogram.html#环境配置",
    "href": "Correlation/Correlogram.html#环境配置",
    "title": "相关图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：GGally; corrplot; ggcorrplot; corrgram\n\n\n# 安装包\nif (!requireNamespace(\"GGally\", quietly = TRUE)) {\n  install.packages(\"GGally\")\n}\nif (!requireNamespace(\"corrplot\", quietly = TRUE)) {\n  install.packages(\"corrplot\")\n}\nif (!requireNamespace(\"ggcorrplot\", quietly = TRUE)) {\n  install.packages(\"ggcorrplot\")\n}\nif (!requireNamespace(\"corrgram\", quietly = TRUE)) {\n  install.packages(\"corrgram\")\n}\n\n# 加载包\nlibrary(GGally)\nlibrary(corrplot)\nlibrary(ggcorrplot)\nlibrary(corrgram)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n corrgram   * 1.14    2021-04-29 [1] RSPM\n corrplot   * 0.95    2024-10-14 [1] RSPM\n GGally     * 2.4.0   2025-08-23 [1] RSPM\n ggcorrplot * 0.1.4.1 2023-09-05 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Correlogram"
    ]
  },
  {
    "objectID": "Correlation/Correlogram.html#数据准备",
    "href": "Correlation/Correlogram.html#数据准备",
    "title": "相关图",
    "section": "数据准备",
    "text": "数据准备\n相关性热图主要应用内置数据集进行绘图。\n\ndata(\"flea\", package = \"GGally\")\ndata_flea &lt;- flea\n\ndata(\"mtcars\", package = \"datasets\")\ndata_mtcars &lt;- mtcars\n\ndata(\"tips\", package = \"GGally\")\ndata_tips &lt;- tips",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Correlogram"
    ]
  },
  {
    "objectID": "Correlation/Correlogram.html#可视化",
    "href": "Correlation/Correlogram.html#可视化",
    "title": "相关图",
    "section": "可视化",
    "text": "可视化\n\n1. GGally 包\n\nGGally 是常用的相关性图绘制工具，允许注入ggplot2代码，但不具有排序功能。\n\n\n基础相关图绘制\n\nggpairs(data_flea, columns = 2:5)\n\n\n\n\n\n\n\n\n\n上图展示了flea数据集各组数据的相关性可视化。图片共有三部分：下半部分的对应两组数据的相关散点图；对角线的单组数据密度图；上半部分的对应两组数据的Pearson相关系数值。\n\n\n\n注入 ggplot2 代码，为每个类别着色\n\nggpairs(data_flea, columns = 2:4, ggplot2::aes(colour=species,alpha=0.7)) \n\n\n\n\n\n\n\n\n\n上图在进行相关性可视化的基础上，对各个类别进行了颜色分类。\n\n\n\n自定义绘图类型\n\nggpairs(data_tips[, c(1, 3, 4, 2)])\n\n\n\n\n\n\n\nsummary(data_tips)\n\n   total_bill         tip             sex      smoker      day         time    \n Min.   : 3.07   Min.   : 1.000   Female: 87   No :151   Fri :19   Dinner:176  \n 1st Qu.:13.35   1st Qu.: 2.000   Male  :157   Yes: 93   Sat :87   Lunch : 68  \n Median :17.80   Median : 2.900                          Sun :76               \n Mean   :19.79   Mean   : 2.998                          Thur:62               \n 3rd Qu.:24.13   3rd Qu.: 3.562                                                \n Max.   :50.81   Max.   :10.000                                                \n      size     \n Min.   :1.00  \n 1st Qu.:2.00  \n Median :2.00  \n Mean   :2.57  \n 3rd Qu.:3.00  \n Max.   :6.00  \n\n\n\n上图中，tatal_bill与tip为定量数据，sex与smoker为定性数据。下半部分主要根据数据类型的不同绘制了两两相关的散点图、直方图和直条图；对角线部分则为各组数据的分布图；上半部分根据数据类型分别绘制了两两相关的线形图，对于两个定量数据则给出了Pearson相关系数值。\n\n\n# Changing the plotting type\nggpairs(\n  data_tips[, c(1, 3, 4, 2)],\n  upper = list(continuous = \"density\",\n               combo = \"box_no_facet\"),\n  lower = list(continuous = \"points\",\n               combo = \"dot_no_facet\")\n)\n\n\n\n\n\n\n\n\n\n通过自定义，将下半部分的直方图修改为散点图，上半部分的相关系数值修改为密度图。\n\n\n\n相关性可视化\n将相关系数可视化呈现。\n\nggcorr(data_mtcars) # 绘制相关系数热图，默认为Pearson\n\n\n\n\n\n\n\n\n\n上图通过ggcorr()函数进行相关系数可视化\nggcorr的method参数：\n默认为c(\"pairwise\",\"pearson\")的形式，第一个参数为确定协方差计算时对于缺失值的处理，第二个参数则用于确定相关系数的类型，比如\"pearson\", \"kendall\", \"spearman\"\n\n\n\n\n2. corrplot 包\n\ncorrplot包是常用的相关性可视化工具，其具有强大的自定义功能和排序功能。\n\n\n基础绘图\n\ncorr &lt;- cor(data_mtcars)\ncorrplot(corr)\n\n\n\n\n\n\n\n\n\n\n参数自定义\n\ncorrplot()的主要关键参数:\ncorr 需要可视化的相关系数矩阵\nmethod 可视化的形状\ntype 显示范围（full 、lower、upper）\ncol 图形展示的颜色\naddCoef.col 相关系数值的颜色\norder 相关系数排序方法\nis.corr 是否为相关系数绘图，默认为TRUE，同样也可以实现非相关系数的可视化，只需使该参数设为FALSE即可\n……\n\n\ncorrplot(corr,method = \"ellipse\" ,# method,指定可视化形状\n         order = \"AOE\", # order，相关系数排序方式\n         addCoef.col=\"black\", # 指定相关系数颜色\n         type=\"lower\") # 指定显示部位\n\n\n\n\n\n\n\n\n\n上图为mtcars数据集的相关系数热图。\n\ntype=\"lower\" 指定显示热图的下半部分。\n颜色的深浅代表相关系数的大小。\n椭圆的形状表示相关系数：离心率越大，椭圆越扁，相关系数绝对值较大；离心率越小，椭圆越圆，相关系数绝对值较小。椭圆长轴的方向表示相关系数的正负，右上-左下方向对应正值，左上-右下方向对应负值。\n\n\n\n\n添加显著性标签\n\nres1 &lt;-cor.mtest(data_mtcars, conf.level= .95)\ncorrplot(corr, method= \"circle\",\n         p.mat= res1$p, sig.level= 0.01, # p值大于0.01被认为无统计学意义\n         mar= c(1,1,1,1))\n\n\n\n\n\n\n\n\n\n上图在相关系数热图的基础上添加了显著性标签，P值大于0.01视为无统计学意义。\n\n\n\n\n3. ggcorrplot 包\n\nggcorrplot包相当于corrplot包的精简版，主要包括cor_pmat计算功能和ggcorrplot绘图功能。\n\n\ncor_pmat计算p值\n\np.mat &lt;- cor_pmat(data_mtcars)\nhead(p.mat[, 1:6])\n\n              mpg          cyl         disp           hp         drat\nmpg  0.000000e+00 6.112687e-10 9.380327e-10 1.787835e-07 1.776240e-05\ncyl  6.112687e-10 0.000000e+00 1.802838e-12 3.477861e-09 8.244636e-06\ndisp 9.380327e-10 1.802838e-12 0.000000e+00 7.142679e-08 5.282022e-06\nhp   1.787835e-07 3.477861e-09 7.142679e-08 0.000000e+00 9.988772e-03\ndrat 1.776240e-05 8.244636e-06 5.282022e-06 9.988772e-03 0.000000e+00\nwt   1.293959e-10 1.217567e-07 1.222320e-11 4.145827e-05 4.784260e-06\n               wt\nmpg  1.293959e-10\ncyl  1.217567e-07\ndisp 1.222320e-11\nhp   4.145827e-05\ndrat 4.784260e-06\nwt   0.000000e+00\n\n\n\n\nggcorrplot绘图\n\nggcorrplot(corr, method = \"square\" )\n\nWarning: `aes_string()` was deprecated in ggplot2 3.0.0.\nℹ Please use tidy evaluation idioms with `aes()`.\nℹ See also `vignette(\"ggplot2-in-packages\")` for more information.\nℹ The deprecated feature was likely used in the ggcorrplot package.\n  Please report the issue at &lt;https://github.com/kassambara/ggcorrplot/issues&gt;.\n\n\n\n\n\n\n\n\n\n\n上图为mtcar数据集相关系数的颜色热图\n\n\nggcorrplot(corr, method = \"circle\" )\n\n\n\n\n\n\n\n\n\n这里我们把绘图类型改为了圆形\n\n\n\n\n4. corrgram 包\n\ncorrgram 包也是绘制相关图的一个不错选择，它可以选择在上、下和对角线中显示的内容。\n我们主要利用corrgram()函数进行相关图的绘制：\n\ncor.method 确定相关系数类型pearson（默认）, spearman, kendall\n\n可以使用不同的方法可视化：\n\npanel.ellipse 显示椭圆\npanel.shade 用于色块\npanel.pie 用于饼图\npanel.pts 用于散点图\n\n\n\ncorrgram(data_mtcars, order=TRUE, \n         lower.panel=panel.shade, # 彩色方块\n         upper.panel=panel.pie, # 饼图\n         text.panel=panel.txt, \n         main=\"Car Milage Data in PC2/PC1 Order\") \n\n\n\n\n\n\n\n\n\n通过lower.panel=panel.shade,upper.panel=panel.pie将上半部分设置为饼图，下半部分设置为颜色图。\n\n\ncorrgram(data_mtcars, order=TRUE, \n         lower.panel=panel.ellipse, # 显示椭圆\n         upper.panel=panel.pts,  # 散点图\n         text.panel=panel.txt, \n         diag.panel=panel.minmax, \n         main=\"Car Milage Data in PC2/PC1 Order\") \n\n\n\n\n\n\n\n\n\n通过lower.panel=panel.ellipse,upper.panel=panel.pts将上半部分设置为散点图，下半部分设置为椭圆图（其中红线为拟合曲线）。\n\n\ncorrgram(data_mtcars, order=NULL, \n         lower.panel=panel.shade, # 彩色方块\n         upper.panel=NULL, \n         text.panel=panel.txt, \n         main=\"Car Milage Data (unsorted)\")\n\n\n\n\n\n\n\n\n\n通过lower.panel=panel.shade,upper.panel=NULL只显示下半部分的颜色图",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Correlogram"
    ]
  },
  {
    "objectID": "Correlation/Correlogram.html#应用场景",
    "href": "Correlation/Correlogram.html#应用场景",
    "title": "相关图",
    "section": "应用场景",
    "text": "应用场景\n\n\n\n\n\n\n图 1: 相关图应用\n\n\n\n\n上图为基于菌株 ANI 值的相关图。 使用 JSpecies 软件计算每个指示菌株之间的 ANI 值，并用于Pearson相关矩阵构建。该图显示了使用 corrplot 包通过层次聚类构建和排序的相关性。 [1]\n\n\n\n\n\n\n\n图 2: 相关图应用\n\n\n\n\n上图展示了Gain [FF]、ILP、wpm、RR、R r-words、R p-words、 RN 、VA之间的相关性。左图显示未排除儿童年级影响的相关性；右图显示分化年级后的相关性。相关性的大小由圆圈的大小（和颜色）表示。使用了 corrplot 包进行绘制。 [2]",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Correlogram"
    ]
  },
  {
    "objectID": "Correlation/Correlogram.html#参考文献",
    "href": "Correlation/Correlogram.html#参考文献",
    "title": "相关图",
    "section": "参考文献",
    "text": "参考文献\n[1] Espariz M, Zuljan FA, Esteban L, Magni C. Taxonomic Identity Resolution of Highly Phylogenetically Related Strains and Selection of Phylogenetic Markers by Using Genome-Scale Methods: The Bacillus pumilus Group Case. PLoS One. 2016 Sep 22;11(9):e0163098. doi: 10.1371/journal.pone.0163098. PMID: 27658251; PMCID: PMC5033322.\n[2] Marx C, Hutzler F, Schuster S, Hawelka S. On the Development of Parafoveal Preprocessing: Evidence from the Incremental Boundary Paradigm. Front Psychol. 2016 Apr 14;7:514. doi: 10.3389/fpsyg.2016.00514. PMID: 27148123; PMCID: PMC4830847.\n[3] Schloerke B, Cook D, Larmarange J, Briatte F, Marbach M, Thoen E, Elberg A, Crowley J (2024). GGally: Extension to ‘ggplot2’. R package version 2.2.1, CRAN: Package GGally.\n[4] Taiyun Wei and Viliam Simko (2024). R package ‘corrplot’: Visualization of a Correlation Matrix (Version 0.94). Available from GitHub - taiyun/corrplot: A visual exploratory tool on correlation matrix\n[5] Kassambara A (2023). ggcorrplot: Visualization of a Correlation Matrix using ‘ggplot2’. R package version 0.1.4.1, CRAN: Package ggcorrplot.\n[6] Wright K (2021). corrgram: Plot a Correlogram. R package version 1.14, CRAN: Package corrgram.",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Correlogram"
    ]
  },
  {
    "objectID": "Correlation/ConnectedScatter.html",
    "href": "Correlation/ConnectedScatter.html",
    "title": "连接散点图",
    "section": "",
    "text": "连接散点图是在散点图的基础上，添加了按数据点出现顺序的连线，这使得从连接散点图中，既可以看出自变量和因变量间的相关性，也可以看出数据点的变化趋势。",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Connected Scatter"
    ]
  },
  {
    "objectID": "Correlation/ConnectedScatter.html#示例",
    "href": "Correlation/ConnectedScatter.html#示例",
    "title": "连接散点图",
    "section": "示例",
    "text": "示例\n\n\n\n\n\n如图是一个基本的连接散点图，图中Sepal.Length与Sepal.Width间的变化曲线上下波动，但是总体上是因变量Sepal.Length随着自变量Sepal.Width的增大而增大。",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Connected Scatter"
    ]
  },
  {
    "objectID": "Correlation/ConnectedScatter.html#环境配置",
    "href": "Correlation/ConnectedScatter.html#环境配置",
    "title": "连接散点图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：ggplot2, dplyr\n\n\n# 安装包\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\n\n# 加载包\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(stringr)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package * version date (UTC) lib source\n dplyr   * 1.1.4   2023-11-17 [1] RSPM\n ggplot2 * 4.0.1   2025-11-14 [1] RSPM\n stringr * 1.6.0   2025-11-04 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Connected Scatter"
    ]
  },
  {
    "objectID": "Correlation/ConnectedScatter.html#数据准备",
    "href": "Correlation/ConnectedScatter.html#数据准备",
    "title": "连接散点图",
    "section": "数据准备",
    "text": "数据准备\n使用R自带的数据集iris和economics，iris数据集包含3种鸢尾属植物的萼片长度和宽度以及花瓣长度和宽度的测量值；economics是美国经济的时序数据。同时使用了NCBI数据库的乳腺癌的基因表达数据，共有24个样本列，选取了两行基因表达数据进行绘图。\n\n# 1.载入iris数据\ndata(\"iris\", package = \"datasets\")\ndata &lt;- iris\n\n# 2. 载入时序数据\n# 为了简化绘图过程，仅选择 12 月份的数据来代表全年\ndata_economics &lt;- economics %&gt;%\n  select(date, psavert, uempmed) %&gt;%\n  filter(str_detect(date, \"-12-01\")) %&gt;%\n  slice_head(n = 25) %&gt;%\n  mutate(date = str_extract(date, \"^\\\\d{4}\")) %&gt;% # 从每个日期字符串的开头提取 4 位数的年份。\n  select(date, psavert, uempmed)\n\n# 3.载入基因表达数据（前两行）\ndata_counts &lt;- read.csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/GSE243555_all_genes_with_counts.txt\", sep = \"\\t\", header = TRUE, nrows = 10)\n\naxis_names &lt;- data_counts[c(1, 2), 1]        # 保存名称\n\ndata_counts &lt;- data_counts %&gt;%      \n  select(-1) %&gt;%               # 去除第一列\n  slice(1:2) %&gt;%               # 保留前两行\n  t()  %&gt;%                     # 倒置\n  as.data.frame() %&gt;%\n  setNames(c(\"V1\", \"V2\"))      # 设置列名\n\nhead(data_counts)\n\n                           V1  V2\nMCF7.HG..1.              2905 178\nMCF7.HG..LG..2.          2496 161\nADIPO.HG..2.             1802 184\nADIPO.HG..LG..2.         1400 174\nMCF7...ADIPO..HG..2.     2180 154\nMCF7...ADIPO..HG..LG..2. 2123 118",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Connected Scatter"
    ]
  },
  {
    "objectID": "Correlation/ConnectedScatter.html#可视化",
    "href": "Correlation/ConnectedScatter.html#可视化",
    "title": "连接散点图",
    "section": "可视化",
    "text": "可视化\n\n1. 基本绘图\n图 1 在散点图的基础上，添加geom_line绘制的。\n\n# 基本绘图，只添加了geom_line\np &lt;- ggplot(data[data$Species == \"setosa\", ], aes(x = Sepal.Width, y = Sepal.Length)) +\n  geom_point(shape = 17, size = 1.5, color = \"blue\") +\n  geom_line()\n\np\n\n\n\n\n\n\n\n图 1: 基本绘图\n\n\n\n\n\n\n\n2. 设置线样式\n图 2 通过参数设置线的朝向，宽度，类型，颜色。\n\n## 设置线样式\np &lt;- ggplot(data[data$Species == \"setosa\", ], aes(x = Sepal.Width, y = Sepal.Length)) +\n  geom_point(shape = 17, size = 1.5, color = \"blue\") +\n  geom_line(orientation = \"x\", linetype = 1, color = \"red\", linewidth = 0.1)\n\np\n\n\n\n\n\n\n\n图 2: 设置线样式\n\n\n\n\n\n\n\n\n\n\n\n提示\n\n\n\n关键参数: geom_line\nlinetype:\nlinetype 表示线的类型，可选项范围0-6(其中0 = blank, 1 = solid, 2 = dashed, 3 = dotted, 4 = dotdash, 5 = longdash, 6 = twodash)，具体形状如下图：\n\n\n\n\n\norientation:\n线段的朝向，可选项有”x”，“y”，orientation=\"x\"是以x为自变量，y为因变量绘制。\nlinewidth:\n线段的粗细。\n\n\n\n\n3. 多类数据绘图\n图 3 使用color=Species,shape=Species,linetype=Species将分类变量映射到多种特征中。\n\n## 多类数据绘图\n## 使用 `color=Species`,`shape=Species`,`linetype=Species` 将分类变量映射到多种特征中\np &lt;- ggplot(\n  data[data$Species == \"setosa\" | data$Species == \"virginica\", ],\n  aes(x = Sepal.Width, y = Sepal.Length)\n) +\n  geom_point(aes(color = Species, shape = Species), size = 1.5) +\n  geom_line(aes(linetype = Species)) +\n  # 更改图例位置\n  theme(legend.position = \"inside\", legend.position.inside = c(0.85, 0.8))\n\np\n\n\n\n\n\n\n\n图 3: 多类数据绘图\n\n\n\n\n\n\n\n4. 使用基因数据绘图\n图 4 显示了乳腺癌的两种基因的连接散点图。\n\n# 使用基因数据绘图\np &lt;- ggplot(data_counts, aes(x = V1, y = V2)) +\n  geom_point(shape = 17, size = 1.5, color = \"blue\") +\n  geom_line(orientation = \"x\", linetype = 1, color = \"red\", linewidth = 0.1) +\n  theme(axis.text.x = element_text(angle = 90)) + # 避免文本重叠\n  labs(x = axis_names[1], y = axis_names[2]) # 添加x,y轴标签\n\np\n\n\n\n\n\n\n\n图 4: 使用基因数据绘图\n\n\n\n\n\n\n\n5. 按时序连线\n\n不按时序连线(做对比)\n图 5 使用了geom_line()绘图，geom_line()默认沿着x轴方向绘图(orientation=\"y\"时沿y轴绘图)。\n\np &lt;- ggplot(data_economics, aes(x = psavert, y = uempmed)) +\n  geom_point(shape = 17, size = 1.5, color = \"blue\") +\n  geom_text(\n    label = data_economics$date, nudge_x = 0,\n    nudge_y = -0.1, size = 3\n  ) +\n  geom_line(linewidth = 1)\n\np\n\n\n\n\n\n\n\n图 5: 比较绘图\n\n\n\n\n\n\n\n按时序连线\n图 6 使用geom_segment()实现按照时序进行点的连线，和geom_line()绘制的图差别较大。\n\n# 按照日期排序\ndata_economics &lt;- data_economics[order(data_economics$date), ]\n\n# 使用 `geom_segment()` 绘制线段\np &lt;- ggplot(data_economics, aes(x = psavert, y = uempmed)) +\n  geom_point(shape = 17, size = 1.5, color = \"blue\") +\n  geom_text(\n    label = data_economics$date, nudge_x = 0,\n    nudge_y = -0.1, size = 5\n  ) +\n  geom_segment(\n    aes(\n      xend = c(tail(psavert, n = 24), NA),\n      yend = c(tail(uempmed, n = 24), NA)\n    ),\n    linewidth = 1\n  )\n\np\n\n\n\n\n\n\n\n图 6: 按时序连线\n\n\n\n\n\n\n\n\n\n\n\n提示\n\n\n\n关键参数: geom_segment\nxend,yend：\n与x,y相对应，也就是(x,y)指向(xend,yend)绘制线段。代码中c(tail(psavert, n=24),NA)是取psavert列的后面24个值，并加上了一个NA。这样就使前面的点指向后面一个点绘制线段，最后的点指向NA，不绘制线段。\n\n\n\n\n绘制箭头\n图 7 为每个连线添加了箭头，使连接散点图中的时序特征更加明显。\n\n# 按照日期对数据进行排序\ndata_economics &lt;- data_economics[order(data_economics$date), ]\n\n# 使用 `geom_segment()` 绘制线段\np &lt;- ggplot(data_economics, aes(x = psavert, y = uempmed)) +\n  geom_point(shape = 17, size = 1.5, color = \"blue\") +\n  geom_text(\n    label = data_economics$date, nudge_x = 0,\n    nudge_y = -0.1, size = 5\n  ) +\n  geom_segment(\n    aes(\n      xend = c(tail(psavert, n = 24), NA),\n      yend = c(tail(uempmed, n = 24), NA)\n    ),\n    linewidth = 1, arrow = arrow(length = unit(0.5, \"cm\"))\n  )\n\np\n\n\n\n\n\n\n\n图 7: 绘制箭头",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Connected Scatter"
    ]
  },
  {
    "objectID": "Correlation/ConnectedScatter.html#应用场景",
    "href": "Correlation/ConnectedScatter.html#应用场景",
    "title": "连接散点图",
    "section": "应用场景",
    "text": "应用场景\n\n\n\n\n\n图中显示了基于未使用、原始和改进方法的模型方法相应的相对误差曲线， 其中基于改进方法的成分含量模型的平均相对误差优于基于未使用和原始方法的模型。[1]\n\n\n\n\n\n癌症分类（SCCA-CC）与iCluster的稀疏规范相关分析的比较。使用基于MAD预选的不同数量的基因，我们比较了SCCA-CC和iCluster之间的分类性能。（A）表示与生存相关的P值，通过log-rank测试计算；（B）表示聚类一致性的Silhouette分数；（C）评估计算复杂度的算法运行时间。[2]\n\n\n\n\n\n（A） HCC患者合并症数量的分布。（B） 不同年龄和性别的HCC患者的平均合并症数量。（C） 各年龄组男性HCC患者合并症数量的分布。（D） 各年龄组女性HCC患者合并症数量的分布。[3]",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Connected Scatter"
    ]
  },
  {
    "objectID": "Correlation/ConnectedScatter.html#参考文献",
    "href": "Correlation/ConnectedScatter.html#参考文献",
    "title": "连接散点图",
    "section": "参考文献",
    "text": "参考文献\n[1] LU R, LIU H, YANG H, et al. Multi-Delay Identification of Rare Earth Extraction Process Based on Improved Time-Correlation Analysis[J]. Sensors (Basel), 2023,23(3).\n[2] QI L, WANG W, WU T, et al. Multi-Omics Data Fusion for Cancer Molecular Subtyping Using Sparse Canonical Correlation Analysis[J]. Front Genet, 2021,12: 607817.\n[3] MU X M, WANG W, JIANG Y Y, et al. Patterns of Comorbidity in Hepatocellular Carcinoma: A Network Perspective[J]. Int J Environ Res Public Health, 2020,17(9).",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Connected Scatter"
    ]
  },
  {
    "objectID": "Correlation/Biplot.html",
    "href": "Correlation/Biplot.html",
    "title": "载荷图",
    "section": "",
    "text": "载荷图（Biplot）是一种可视化工具，用于展示主成分分析（principal component analysis，PCA）的结果。它可以同时显示数据集中的样本和变量在主成分空间中的位置。在二维Biplot图中，样本通常以点的形式表示，而变量则以箭头表示，箭头的方向和长度分别代表了变量对主成分的贡献度和相关性。",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Biplot"
    ]
  },
  {
    "objectID": "Correlation/Biplot.html#示例",
    "href": "Correlation/Biplot.html#示例",
    "title": "载荷图",
    "section": "",
    "text": "载荷图（Biplot）是一种可视化工具，用于展示主成分分析（principal component analysis，PCA）的结果。它可以同时显示数据集中的样本和变量在主成分空间中的位置。在二维Biplot图中，样本通常以点的形式表示，而变量则以箭头表示，箭头的方向和长度分别代表了变量对主成分的贡献度和相关性。",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Biplot"
    ]
  },
  {
    "objectID": "Correlation/Biplot.html#环境配置",
    "href": "Correlation/Biplot.html#环境配置",
    "title": "载荷图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：dplyr, ggbiplot\n\n\n# 安装包\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"ggbiplot\", quietly = TRUE)) {\n  install.packages(\"ggbiplot\")\n}\n\n# 加载包\nlibrary(ggbiplot)\nlibrary(dplyr)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package  * version date (UTC) lib source\n dplyr    * 1.1.4   2023-11-17 [1] RSPM\n ggbiplot * 0.6.2   2024-01-08 [1] RSPM\n ggplot2  * 4.0.1   2025-11-14 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Biplot"
    ]
  },
  {
    "objectID": "Correlation/Biplot.html#数据准备",
    "href": "Correlation/Biplot.html#数据准备",
    "title": "载荷图",
    "section": "数据准备",
    "text": "数据准备\n数据来源于R自带的iris数据集。\n\ndata(\"iris\")\nhead(iris) \n\n  Sepal.Length Sepal.Width Petal.Length Petal.Width Species\n1          5.1         3.5          1.4         0.2  setosa\n2          4.9         3.0          1.4         0.2  setosa\n3          4.7         3.2          1.3         0.2  setosa\n4          4.6         3.1          1.5         0.2  setosa\n5          5.0         3.6          1.4         0.2  setosa\n6          5.4         3.9          1.7         0.4  setosa",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Biplot"
    ]
  },
  {
    "objectID": "Correlation/Biplot.html#可视化",
    "href": "Correlation/Biplot.html#可视化",
    "title": "载荷图",
    "section": "可视化",
    "text": "可视化\n通过prcomp函数进行主成分分析。\n\niris.pca &lt;- prcomp (~ Sepal.Length + Sepal.Width + Petal.Length + Petal.Width,\n                    data=iris,\n                    scale. = TRUE)\nsummary(iris.pca)\n\nImportance of components:\n                          PC1    PC2     PC3     PC4\nStandard deviation     1.7084 0.9560 0.38309 0.14393\nProportion of Variance 0.7296 0.2285 0.03669 0.00518\nCumulative Proportion  0.7296 0.9581 0.99482 1.00000\n\n\n\n1. 基础绘图\n通过ggbipolot绘制PCA结果的载荷图。\n\niris.gg &lt;-\n  ggbiplot(iris.pca, obs.scale = 1, var.scale = 1,\n           groups = iris$Species, point.size=2,\n           varname.size = 3, \n           varname.color = \"black\",\n           varname.adjust = 1.2,\n           ellipse = TRUE, \n           circle = TRUE) +\n  labs(fill = \"Species\", color = \"Species\") +\n  theme_minimal(base_size = 14) +\n  theme(legend.direction = 'horizontal', legend.position = 'top')\n\niris.gg\n\n\n\n\n\n\n\n图 1: 基础绘图\n\n\n\n\n\n注：图题为基因名，横轴为PC1，纵轴为PC2，图中箭头所示向量长短代表差异贡献，方向为与主成分的相关性，颜色为不同种类的鸢尾花。\n我们可以发现PC1和PC2可将三组样品明显分开，可以看到向量Petal.Length，Petal.width与X轴近平行，表示PC1的差异主要由此变量贡献，而PC2的差异则主要由Sepal.Width贡献。每个向量之间夹角大于90°代表负相关，夹角小于90%的代表正相关。\n\n\n2. 增加聚类标签\n我们可以通过计算聚类中心，添加标签，更直观地展示不同类别地名称。\n\ngroup.labs &lt;-\n  iris.gg$data %&gt;%\n  dplyr::summarise(xvar = mean(xvar),\n            yvar = mean(yvar), .by = groups)\ngroup.labs\n\n      groups       xvar       yvar\n1     setosa -2.2099215 -0.2870013\n2 versicolor  0.4931384  0.5465027\n3  virginica  1.7167831 -0.2595014\n\n\n\niris.gg + geom_label(data = group.labs,\n                     aes(x = xvar, y=yvar, label=groups),\n                     size = 5) +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n图 2: 增加聚类标签\n\n\n\n\n\n\n\n3. 使用样本名替代点\n为了展示不同样本在PCA分析中所处地位置，我们可以通过设置labels来进行展示。\n\nggbiplot(iris.pca, obs.scale = 1, \n         var.scale = 1,\n         groups = iris$Species, \n         labels = rownames(iris),\n         point.size=2,\n         varname.size = 3, \n         varname.color = \"black\",\n         varname.adjust = 1.2,\n         ellipse = TRUE, \n         circle = TRUE) +\n  labs(fill = \"Species\", color = \"Species\") +\n  theme_minimal(base_size = 14) +\n  theme(legend.direction = 'horizontal', legend.position = 'top')\n\n\n\n\n\n\n\n图 3: 使用样本名替代点",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Biplot"
    ]
  },
  {
    "objectID": "Correlation/Biplot.html#应用场景",
    "href": "Correlation/Biplot.html#应用场景",
    "title": "载荷图",
    "section": "应用场景",
    "text": "应用场景\n\n1. 宏基因组主成分分析载荷图\n\n\n\n\n\n\n图 4: 宏基因组主成分分析载荷图\n\n\n\n箭头代表菌种，字母代表样本，菌种与样本地距离越近表明相关性越高，图中与H1,H2,H3,H4,H7菌种最近的菌种是双歧杆菌属（bifidobacteria），表明该菌种是对照组中的优势菌种。[1]\n\n\n2. 转录组主成分分析载荷图\n\n\n\n\n\n\n图 5: 转录组主成分分析载荷图\n\n\n\n四组之间有显著差异，其中PC1和PC2的贡献值分别为40.92%和24.26%，PC2中，对照组（PBS）与哮喘+羊肉组（OVA+Lamb）正向分布，哮喘+鱼肉组（OVA+fish）与哮喘组（OVA）主要呈负向分布，对照组与其余三组有显著差异，哮喘+羊肉组（OVA+Lamb）与哮喘+鱼肉组（OVA+Fish）有显著分离。[2]",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Biplot"
    ]
  },
  {
    "objectID": "Correlation/Biplot.html#参考文献",
    "href": "Correlation/Biplot.html#参考文献",
    "title": "载荷图",
    "section": "参考文献",
    "text": "参考文献\n[1] Balasubramaniam C, Mallappa RH, Singh DK, et al. Gut bacterial profile in Indian children of varying nutritional status: a comparative pilot study. Eur J Nutr. 2021;60(7):3971-3985. doi:10.1007/s00394-021-02571-7.\n[2] Zheng HC, Wang YA, Liu ZR, et al. Consumption of Lamb Meat or Basa Fish Shapes the Gut Microbiota and Aggravates Pulmonary Inflammation in Asthmatic Mice. J Asthma Allergy. 2020;13:509-520. Published 2020 Oct 19. doi:10.2147/JAA.S266584.",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Biplot"
    ]
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Bizard",
    "section": "",
    "text": "在生物医学研究中，数据可视化是解读复杂数据集、推动科学发现和指导临床决策的关键工具。R语言凭借其强大的统计功能和丰富的扩展包生态系统，已成为创建高质量可视化的基石。然而，R语言绘图工具包数量庞大且持续更新，研究人员常面临方法选择与图表定制的双重挑战——他们需要根据特定研究需求筛选合适方案并进行个性化调整。这一过程不仅需要高超的编程技能、跨学科协作能力，还需投入大量时间，这些因素都可能延缓研究进度，甚至影响实验结果的准确性。\n为应对这些挑战，我们开发了 Bizard。这个社区驱动的综合性平台整合了精选可视化代码库、进阶教程和协作论坛，通过优化资源获取路径与促进知识共享，致力于提升生物医学研究者的数据分析能力，加速科研成果向临床实践的转化。",
    "crumbs": [
      "<i class='fa-solid fa-house'></i> Welcome"
    ]
  },
  {
    "objectID": "index.html#welcome",
    "href": "index.html#welcome",
    "title": "Bizard",
    "section": "",
    "text": "在生物医学研究中，数据可视化是解读复杂数据集、推动科学发现和指导临床决策的关键工具。R语言凭借其强大的统计功能和丰富的扩展包生态系统，已成为创建高质量可视化的基石。然而，R语言绘图工具包数量庞大且持续更新，研究人员常面临方法选择与图表定制的双重挑战——他们需要根据特定研究需求筛选合适方案并进行个性化调整。这一过程不仅需要高超的编程技能、跨学科协作能力，还需投入大量时间，这些因素都可能延缓研究进度，甚至影响实验结果的准确性。\n为应对这些挑战，我们开发了 Bizard。这个社区驱动的综合性平台整合了精选可视化代码库、进阶教程和协作论坛，通过优化资源获取路径与促进知识共享，致力于提升生物医学研究者的数据分析能力，加速科研成果向临床实践的转化。",
    "crumbs": [
      "<i class='fa-solid fa-house'></i> Welcome"
    ]
  },
  {
    "objectID": "index.html#什么是-bizard",
    "href": "index.html#什么是-bizard",
    "title": "Bizard",
    "section": "什么是 Bizard?",
    "text": "什么是 Bizard?\nBizard 汇聚了强大的可视化工具、精选代码和协作功能，助力研究人员高效完成数据分析，并以清晰有力的方式呈现研究成果。\n\n全面可视化资源库: 整合来自多方的可视化代码，既有经典图表库（graphgallery）资源，也有全球专家的创新贡献，为生物医学研究提供前沿工具集。\n多样化图表支持: 提供涵盖变量分布、相关性分析、排序图表及交互式可视化等场景的R代码实现，满足多元数据分析需求。\n真实场景应用: 基于R原生数据集与真实生物医学数据案例，让可视化技术的学习和应用更贴近实际研究场景，加速临床转化进程。\n生物医学数据适配: 包含预处理算法、带注释的绘图代码和专用方法，适配生物医学数据的复杂性，即使编程基础有限也能实现高级可视化。\n统计分析一体化: 将统计分析与可视化模块无缝结合，确保结果兼具严谨性与表现力，提升研究可信度，推动循证医学发展。\n开放协作生态: 积极吸纳生物医学领域专家的贡献，通过集体智慧优化功能，应对数据可视化领域的动态挑战。\n多平台便捷访问: 通过开源GitHub仓库、互动论坛及微信公众号教程等多渠道提供资源，促进知识共享与协作创新。\n推动研究卓越: 赋能研究人员提升可视化技能，完善方法学标准，助力精准医疗与个性化治疗发展。\n未来愿景: 致力于拓展国际协作，持续提供创新解决方案，以应对生物医学数据可视化与分析日益增长的复杂性。\n\n\n\n\n\n\n\n注记\n\n\n\n如果您觉得这有用或有改进的建议，请在任何页面底部的GitHub讨论中留下您的评论，让我们知道。",
    "crumbs": [
      "<i class='fa-solid fa-house'></i> Welcome"
    ]
  },
  {
    "objectID": "Hiplot/161-scatter.html",
    "href": "Hiplot/161-scatter.html",
    "title": "散点图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Scatter 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/scatter?lang=zh_cn\n用两组数据构成多个坐标点，通过观察坐标点的分布，判断变量间是否存在关联或总结坐标点分布模式的数据处理方式。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Scatter"
    ]
  },
  {
    "objectID": "Hiplot/161-scatter.html#环境配置",
    "href": "Hiplot/161-scatter.html#环境配置",
    "title": "散点图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Scatter"
    ]
  },
  {
    "objectID": "Hiplot/161-scatter.html#数据准备",
    "href": "Hiplot/161-scatter.html#数据准备",
    "title": "散点图",
    "section": "数据准备",
    "text": "数据准备\n载入数据为横轴数值及其对应的纵轴数值和分组。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/scatter/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 查看数据\nhead(data)\n\n  Value1 Value2  Group\n1      1      1 treat1\n2      2      4 treat1\n3      3      9 treat1\n4      4     16 treat1\n5      5     25 treat1\n6      6     36 treat1",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Scatter"
    ]
  },
  {
    "objectID": "Hiplot/161-scatter.html#可视化",
    "href": "Hiplot/161-scatter.html#可视化",
    "title": "散点图",
    "section": "可视化",
    "text": "可视化\n\n# 散点图\np &lt;- ggplot(data, aes(x = Value1, y = Value2)) +\n  geom_point(size = 1, alpha = 1, aes(color = Group, shape = Group)) +\n  ggtitle(\"Scatter Plot\") +\n  scale_color_manual(values = c(\"#00468BFF\", \"#ED0000FF\")) +\n  theme_bw() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 1: 散点图\n\n\n\n\n\nValue1 表示横轴，Value2 表示纵轴，图示表示治疗方案一中 Value1 与 Value2 两个变量呈正相关： 即 Value1 变大时， Value2 随之变大； 治疗方案二中两个变量则呈负相关： 即 Value1 变大时，Value2 随之变小。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Scatter"
    ]
  },
  {
    "objectID": "Hiplot/039-density-histogram.html",
    "href": "Hiplot/039-density-histogram.html",
    "title": "密度图-直方图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Density-Histogram 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/density-histogram?lang=zh_cn\n使用密度图或直方图展示数据分布。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Density-Histogram"
    ]
  },
  {
    "objectID": "Hiplot/039-density-histogram.html#环境配置",
    "href": "Hiplot/039-density-histogram.html#环境配置",
    "title": "密度图-直方图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; grafify; dplyr\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"grafify\", quietly = TRUE)) {\n  install.packages(\"grafify\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(grafify)\nlibrary(dplyr)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n dplyr      * 1.1.4   2023-11-17 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n grafify    * 5.1.0   2025-08-25 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Density-Histogram"
    ]
  },
  {
    "objectID": "Hiplot/039-density-histogram.html#数据准备",
    "href": "Hiplot/039-density-histogram.html#数据准备",
    "title": "密度图-直方图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/density-histogram/data.json\")$exampleData[[1]]$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ny &lt;- \"Doubling_time\"\ngroup &lt;- \"Student\"\ndata[, group] &lt;- factor(data[, group], levels = unique(data[, group]))\ndata &lt;- data %&gt;% \n  mutate(median = median(get(y), na.rm = TRUE),\n         mean = mean(get(y), na.rm = TRUE))\n\n# 查看数据\nhead(data)\n\n  Experiment Student Doubling_time facet   median     mean\n1       Exp1       A      17.36765    F1 20.18114 19.91642\n2       Exp1       B      18.04119    F1 20.18114 19.91642\n3       Exp1       C      18.70120    F1 20.18114 19.91642\n4       Exp1       D      20.06762    F1 20.18114 19.91642\n5       Exp1       E      20.19807    F2 20.18114 19.91642\n6       Exp1       F      22.11908    F2 20.18114 19.91642",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Density-Histogram"
    ]
  },
  {
    "objectID": "Hiplot/039-density-histogram.html#可视化",
    "href": "Hiplot/039-density-histogram.html#可视化",
    "title": "密度图-直方图",
    "section": "可视化",
    "text": "可视化\n\n1. 密度图\n\n# 密度图\np &lt;- plot_density(\n  data = data, \n  ycol = get(y), \n  group = get(group),\n  linethick = 0.5,\n  c_alpha = 0.6) + \n  ggtitle(\"Density Plot\") + \n  geom_vline(aes_string(xintercept = \"median\"),\n        colour = 'black', linetype = 2, size = 0.5) + \n  xlab(y) + \n  ylab(\"density\") + \n  guides(fill = guide_legend(title = group), color = FALSE) +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"bottom\",\n        legend.direction = \"horizontal\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 1: 密度图\n\n\n\n\n\n\n\n2. 直方图\n\n# 直方图\np &lt;- plot_histogram(\n  data = data, \n  ycol = get(y), \n  group = get(group),\n  linethick = 0.5,\n  BinSize = 30)  + \n  ggtitle(\"Histogram Plot\") + \n  geom_vline(aes_string(xintercept = \"median\"),\n        colour = 'black', linetype = 2, size = 0.5) + \n  xlab(y) + \n  ylab(\"density\") + \n  guides(fill = guide_legend(title = group), color = FALSE) +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"bottom\",\n        legend.direction = \"horizontal\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 2: 直方图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Density-Histogram"
    ]
  },
  {
    "objectID": "Hiplot/169-survival.html",
    "href": "Hiplot/169-survival.html",
    "title": "生存分析",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Survival Analysis 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/survival?lang=zh_cn\n生存曲线是显示特定物种或群体 (如雄性或雌性) 在每个年龄存活下来的个体数量或比例的图表。",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Survival Analysis"
    ]
  },
  {
    "objectID": "Hiplot/169-survival.html#环境配置",
    "href": "Hiplot/169-survival.html#环境配置",
    "title": "生存分析",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; survminer; survival; ggplotify\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"survminer\", quietly = TRUE)) {\n  install.packages(\"survminer\")\n}\nif (!requireNamespace(\"survival\", quietly = TRUE)) {\n  install.packages(\"survival\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(survminer)\nlibrary(survival)\nlibrary(ggplotify)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n ggplotify  * 0.1.3   2025-09-20 [1] RSPM\n ggpubr     * 0.6.2   2025-10-17 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n survival   * 3.8-3   2024-12-17 [3] CRAN (R 4.5.2)\n survminer  * 0.5.1   2025-09-02 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Survival Analysis"
    ]
  },
  {
    "objectID": "Hiplot/169-survival.html#数据准备",
    "href": "Hiplot/169-survival.html#数据准备",
    "title": "生存分析",
    "section": "数据准备",
    "text": "数据准备\n载入数据为时间点，生存状态及分组。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/survival/data.json\")$exampleData[[1]]$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ncolnames(data) &lt;- c(\"Time\", \"Status\", \"Group\")\ndata[,1] &lt;- as.numeric(data[,1])\nfit &lt;- survfit(Surv(Time, Status == 1) ~ Group, data = data)\ndata &lt;- data[data[,1] &lt; 1100,]\n\n# 查看数据\nhead(data)\n\n  Time Status Group\n1  306      1    G1\n2  455      1    G1\n3 1010      0    G1\n4  210      1    G1\n5  883      1    G1\n6 1022      0    G1",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Survival Analysis"
    ]
  },
  {
    "objectID": "Hiplot/169-survival.html#可视化",
    "href": "Hiplot/169-survival.html#可视化",
    "title": "生存分析",
    "section": "可视化",
    "text": "可视化\n\n# 生存分析\np &lt;- ggsurvplot(\n  fit, data = data, risk.table = T, pval = T, conf.int = T, fun = \"pct\", \n  size = 0.5, xlab = \"Time\", ylab = \"Survival probability\",\n  ggtheme = theme_bw(), risk.table.y.text.col = TRUE,\n  risk.table.height = 0.25, risk.table.y.text = T,\n  ncensor.plot = T, ncensor.plot.height = 0.25,\n  conf.int.style = \"ribbon\", surv.median.line = \"hv\",\n  palette = c(\"#00468BFF\", \"#ED0000FF\"),\n  xlim = c(0, 1100), ylim = c(0, 100),\n  break.x.by = 150)\n\np\n\n\n\n\n\n\n\n图 1: 生存分析\n\n\n\n\n\n横轴表示时间轴，纵轴表示生存概率。蓝色曲线表示 G1 组生存曲线，红色曲线表示 G2 组生存曲线。经过 logrank 检验后发现 P 值 = 0.0013 &lt; 0.05，表明两组患者生存状况的差异不能用抽样误差来解释，分组因素才是导致两条曲线生存率出现差异的原因。该示例图形表明，G2 组的总体生存率要好于 G1 组。",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Survival Analysis"
    ]
  },
  {
    "objectID": "Hiplot/008-barplot-gradient.html",
    "href": "Hiplot/008-barplot-gradient.html",
    "title": "渐变柱状图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Barplot Gradient 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/barplot-gradient?lang=zh_cn\n同气泡图相似，不过是在柱状图的基础上，用颜色渐变的长方形同时展示两个变量的可视化图形。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Barplot Gradient"
    ]
  },
  {
    "objectID": "Hiplot/008-barplot-gradient.html#环境配置",
    "href": "Hiplot/008-barplot-gradient.html#环境配置",
    "title": "渐变柱状图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2; stringr\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"stringr\", quietly = TRUE)) {\n  install.packages(\"stringr\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(stringr)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n stringr    * 1.6.0   2025-11-04 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Barplot Gradient"
    ]
  },
  {
    "objectID": "Hiplot/008-barplot-gradient.html#数据准备",
    "href": "Hiplot/008-barplot-gradient.html#数据准备",
    "title": "渐变柱状图",
    "section": "数据准备",
    "text": "数据准备\n案例数据，第一列为Go Term（Go语言编号），第二列为基因数，第三列输入pvalue。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/barplot-gradient/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndata[, 1] &lt;- str_to_sentence(str_remove(data[, 1], pattern = \"\\\\w+:\\\\d+\\\\W\"))\ntopnum &lt;- 7\ndata &lt;- data[1:topnum, ]\ndata[, 1] &lt;- factor(data[, 1], level = rev(unique(data[, 1])))\n\n# 查看数据\nhead(data)\n\n                               Term Count   PValue\n1                   Immune response    20 9.61e-08\n2     Defense response to bacterium    11 3.02e-06\n3                   Cell chemotaxis     8 5.14e-06\n4                     Cell adhesion    17 2.73e-05\n5             Complement activation     8 3.56e-05\n6 Extracellular matrix organization    11 4.23e-05",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Barplot Gradient"
    ]
  },
  {
    "objectID": "Hiplot/008-barplot-gradient.html#可视化",
    "href": "Hiplot/008-barplot-gradient.html#可视化",
    "title": "渐变柱状图",
    "section": "可视化",
    "text": "可视化\n\n# 渐变柱状图\np &lt;- ggplot(data, aes(x = Term, y = Count, fill = -log10(PValue))) +\n  geom_bar(stat = \"identity\") +\n  ggtitle(\"GO BarPlot\") +\n  scale_fill_continuous(low = \"#00438E\", high = \"#E43535\") +\n  scale_x_discrete(labels = function(x) {str_wrap(x, width = 65)}) +\n  labs(fill = \"-log10 (PValue)\", y = \"Term\", x = \"Count\") +\n  coord_flip() +\n  theme_bw() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 1: 渐变柱状图\n\n\n\n\n\n如图示，蓝色为低pvalue颜色，红色为高pvalue颜色，随着pvalue增大颜色由蓝向红渐变。横坐标表示基因数目。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Barplot Gradient"
    ]
  },
  {
    "objectID": "Hiplot/026-connected-scatterplot.html",
    "href": "Hiplot/026-connected-scatterplot.html",
    "title": "连接散点图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Connected Scatterplot 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/connected-scatterplot?lang=zh_cn\n连接散点图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Connected Scatterplot"
    ]
  },
  {
    "objectID": "Hiplot/026-connected-scatterplot.html#环境配置",
    "href": "Hiplot/026-connected-scatterplot.html#环境配置",
    "title": "连接散点图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2; dplyr; ggrepel\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"ggrepel\", quietly = TRUE)) {\n  install.packages(\"ggrepel\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(ggrepel)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n dplyr      * 1.1.4   2023-11-17 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n ggrepel    * 0.9.6   2024-09-07 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Connected Scatterplot"
    ]
  },
  {
    "objectID": "Hiplot/026-connected-scatterplot.html#数据准备",
    "href": "Hiplot/026-connected-scatterplot.html#数据准备",
    "title": "连接散点图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/connected-scatterplot/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 查看数据\nhead(data)\n\n  year Alice Anna\n1 1991   724 7118\n2 1992   686 6846\n3 1993   684 6808\n4 1994   595 7523\n5 1995   579 8564\n6 1996   593 8565",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Connected Scatterplot"
    ]
  },
  {
    "objectID": "Hiplot/026-connected-scatterplot.html#可视化",
    "href": "Hiplot/026-connected-scatterplot.html#可视化",
    "title": "连接散点图",
    "section": "可视化",
    "text": "可视化\n\n# 连接散点图\nconnected_scatterplot &lt;- function(data, x, y, label, label_ratio, line_color, arrow_size, label_size) {\n\n  draw_data &lt;- data.frame(\n    x = data[[x]],\n    y = data[[y]],\n    label = data[[label]]\n  )\n\n  add_label_data &lt;- draw_data %&gt;% sample_frac(label_ratio)\n  rm(data)\n\n  p &lt;- ggplot(draw_data, aes(x = x, y = y, label = label)) +\n    geom_point(color = line_color) +\n    geom_text_repel(data = add_label_data, size = label_size) +\n    geom_segment(\n      color = line_color,\n      aes(\n        xend = c(tail(x, n = -1), NA),\n        yend = c(tail(y, n = -1), NA)\n      ),\n      arrow = arrow(length = unit(arrow_size, \"mm\"))\n    )\n\n  return(p)\n}\n\np &lt;- connected_scatterplot(\n  data = if (exists(\"data\") && is.data.frame(data)) data else \"\",\n  x = \"Alice\",\n  y = \"Anna\",\n  label = \"year\",\n  label_ratio = 0.5,\n  line_color = \"#1A237E\",\n  arrow_size = 2,\n  label_size = 2.5\n) +\n  theme_bw() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 1: 连接散点图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Connected Scatterplot"
    ]
  },
  {
    "objectID": "Hiplot/179-venn2.html",
    "href": "Hiplot/179-venn2.html",
    "title": "韦恩图2",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Venn2 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/venn2?lang=zh_cn\n维恩图是一种表示不同有限集合之间所有可能的逻辑关系的图。这些图将集合内元素描述为平面上的点，将集合描述为封闭曲线内的区域。维恩图由多个重叠的闭合曲线 (通常是圆) 组成，每个曲线代表一个集合。标记为S曲线内的点表示集合 S 中的元素，而边界外的点表示集合 S 中不存在的元素。例如，两个集合中的所有元素的交集，S∩T，在视觉上用集合 S 和 T 的重叠区域来表示。在维恩图中，曲线以各种可能的方式重叠，显示了集合之间所有可能的关系。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Venn2"
    ]
  },
  {
    "objectID": "Hiplot/179-venn2.html#环境配置",
    "href": "Hiplot/179-venn2.html#环境配置",
    "title": "韦恩图2",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; venn\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"venn\", quietly = TRUE)) {\n  install.packages(\"venn\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(venn)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n venn       * 1.12    2024-01-08 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Venn2"
    ]
  },
  {
    "objectID": "Hiplot/179-venn2.html#数据准备",
    "href": "Hiplot/179-venn2.html#数据准备",
    "title": "韦恩图2",
    "section": "数据准备",
    "text": "数据准备\n载入数据为 5 个含有基因名称的集合。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/venn2/data.json\")$exampleData[[1]]$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndata_venn &lt;- as.list(data)\ndata_venn &lt;- lapply(data_venn, function(x) {\n  x[is.na(x)] &lt;- \"\"\n  x &lt;- x[x != \"\"]\n  return(x)\n})\n\n# 查看数据\nhead(data)\n\n     Set1      Set2     Set3      Set4    Set5\n1   ISG15      HES5     DVL1   MATP6P1 FAM132A\n2  TTLL10  AURKAIP1 ARHGEF16   MIR551A    AGRN\n3    HES4 LINC00982   OR4F16  C1orf222 WBP1LP6\n4  OR4G4P    FAM87B      SKI   MIR200B  KLHL17\n5 MND2P28       SKI   WASH7P LINC00115  FAM41C\n6  FAM87B     GABRD    MEGF6    ATAD3B   PANK4",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Venn2"
    ]
  },
  {
    "objectID": "Hiplot/179-venn2.html#可视化",
    "href": "Hiplot/179-venn2.html#可视化",
    "title": "韦恩图2",
    "section": "可视化",
    "text": "可视化\n\n# 韦恩图2\ncol &lt;- c(\"#E64B35FF\",\"#4DBBD5FF\",\"#00A087FF\",\"#3C5488FF\",\"#F39B7FFF\")\nvenn(x=data_venn, opacity=0.8, ggplot=F, ilabels = TRUE, zcolor=col, box=F)\ntitle(main = \"Vene Plot (5 sets)\", line = -1)\n\n\n\n\n\n\n\n图 1: 韦恩图2\n\n\n\n\n\n5 种颜色的闭合曲线代表 5 个集合，数字表示多个集合重叠或者未重叠的基因数，例如：示例图中 8 代表 5 个示例集合中均含有 8 个相同的基因名称。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Venn2"
    ]
  },
  {
    "objectID": "Hiplot/114-map-usa-county.html",
    "href": "Hiplot/114-map-usa-county.html",
    "title": "美国地图 (县)",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot USA Map (County) 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/map-usa-county?lang=zh_cn",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Oceania/Antarc Map"
    ]
  },
  {
    "objectID": "Hiplot/114-map-usa-county.html#环境配置",
    "href": "Hiplot/114-map-usa-county.html#环境配置",
    "title": "美国地图 (县)",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2; RColorBrewer\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(RColorBrewer)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package      * version date (UTC) lib source\n data.table   * 1.17.8  2025-07-10 [1] RSPM\n ggplot2      * 4.0.1   2025-11-14 [1] RSPM\n jsonlite     * 2.0.0   2025-03-27 [1] RSPM\n RColorBrewer * 1.1-3   2022-04-03 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Oceania/Antarc Map"
    ]
  },
  {
    "objectID": "Hiplot/114-map-usa-county.html#数据准备",
    "href": "Hiplot/114-map-usa-county.html#数据准备",
    "title": "美国地图 (县)",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/map-usa-county/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\ndt_map &lt;- readRDS(url(\"https://download.hiplot.cn/ui/basic/map-usa-county/usa.county.rds\"))\n\n# 整理数据格式\ndt_map$Value &lt;- data$value[match(dt_map$county, data$name)]\n\n# 查看数据\nhead(data)\n\n               name value\n1 Lake of the Woods   167\n2             Ferry   801\n3           Stevens   785\n4          Okanogan   783\n5      Pend Oreille   796\n6          Boundary   126",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Oceania/Antarc Map"
    ]
  },
  {
    "objectID": "Hiplot/114-map-usa-county.html#可视化",
    "href": "Hiplot/114-map-usa-county.html#可视化",
    "title": "美国地图 (县)",
    "section": "可视化",
    "text": "可视化\n\n# 美国地图 (县)\np &lt;- ggplot(dt_map) +\n  geom_polygon(aes(x = long, y = lat, group = group, fill = Value),\n               alpha = 0.9, size = 0.5) +\n  geom_path(aes(x = long, y = lat, group = group), color = \"black\", size = 0.2) +\n  coord_fixed() +\n  scale_fill_gradientn(\n    colours = colorRampPalette(rev(brewer.pal(11,\"RdYlBu\")))(500),\n    breaks = seq(min(data$value), max(data$value), \n                 round((max(data$value)-min(data$value))/7)),\n    name = \"Color Key\",\n    guide = guide_legend(\n      direction = \"vertical\", keyheight = unit(1, units = \"mm\"),\n      keywidth = unit(8, units = \"mm\"),\n      title.position = \"top\", title.hjust = 0.5, label.hjust = 0.5,\n      nrow = 1, byrow = T, reverse = F, label.position = \"bottom\")) +\n  theme(text = element_text(color = \"#3A3F4A\"),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank(),\n        legend.position = \"top\",\n        legend.text = element_text(size = 4 * 1.5, color = \"black\"),\n        legend.title = element_text(size = 5 * 1.5, color = \"black\"),\n        plot.title = element_text(\n          face = \"bold\", size = 5 * 1.5, hjust = 0.5, \n          margin = margin(t = 4, b = 5), color = \"black\"),\n        plot.background = element_rect(fill = \"#FFFFFF\", color = \"#FFFFFF\"),\n        panel.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        legend.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        plot.margin = unit(c(1.5, 1.5, 1.5, 1.5), \"cm\")) +\n  labs(x = NULL, y = NULL, title = \"USA County Map\")\n\np\n\n\n\n\n\n\n\n图 1: 美国地图 (县)",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Oceania/Antarc Map"
    ]
  },
  {
    "objectID": "Hiplot/062-gene-trend.html",
    "href": "Hiplot/062-gene-trend.html",
    "title": "基因聚类趋势图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Gene Cluster Trend 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/gene-trend?lang=zh_cn\n基因聚类趋势图用于显示不同的基因表达趋势，多条线显示了每个类群中相似的表达模式。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Gene Cluster Trend"
    ]
  },
  {
    "objectID": "Hiplot/062-gene-trend.html#环境配置",
    "href": "Hiplot/062-gene-trend.html#环境配置",
    "title": "基因聚类趋势图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; Mfuzz; ggplotify; RColorBrewer\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"Mfuzz\", quietly = TRUE)) {\n  remotes::install_github(\"MatthiasFutschik/Mfuzz\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(Mfuzz)\nlibrary(ggplotify)\nlibrary(RColorBrewer)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package      * version date (UTC) lib source\n Biobase      * 2.70.0  2025-10-29 [1] Bioconduc~\n BiocGenerics * 0.56.0  2025-10-29 [1] Bioconduc~\n data.table   * 1.17.8  2025-07-10 [1] RSPM\n DynDoc       * 1.88.0  2025-10-29 [1] Bioconduc~\n e1071        * 1.7-17  2025-12-18 [1] RSPM\n generics     * 0.1.4   2025-05-09 [1] RSPM\n ggplotify    * 0.1.3   2025-09-20 [1] RSPM\n jsonlite     * 2.0.0   2025-03-27 [1] RSPM\n Mfuzz        * 2.65.0  2025-11-02 [1] Github (MatthiasFutschik/Mfuzz@2f02e7f)\n RColorBrewer * 1.1-3   2022-04-03 [1] RSPM\n widgetTools  * 1.88.0  2025-10-29 [1] Bioconduc~\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Gene Cluster Trend"
    ]
  },
  {
    "objectID": "Hiplot/062-gene-trend.html#数据准备",
    "href": "Hiplot/062-gene-trend.html#数据准备",
    "title": "基因聚类趋势图",
    "section": "数据准备",
    "text": "数据准备\n加载的数据是行为基因列为时间点样本的基因表达矩阵。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/gene-trend/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\n## 将基因表达矩阵转换为 ExpressionSet 对象\nrow.names(data) &lt;- data[,1]\ndata &lt;- data[,-1]\ndata &lt;- as.matrix(data)\neset &lt;- new(\"ExpressionSet\", exprs = data)\n## 过滤缺失值超过 25% 的基因\neset &lt;- filter.NA(eset, thres=0.25)\n\n0 genes excluded.\n\n## 根据标准差去除样本间差异太小的基因\neset &lt;- filter.std(eset, min.std=0, visu = F)\n\n0 genes excluded.\n\n## 数据标准化\neset &lt;- standardise(eset)\n## 设定聚类数目\nc &lt;- 6\n## 评估出最佳的m值\nm &lt;- mestimate(eset)\n## 进行mfuzz聚类\ncl &lt;- mfuzz(eset, c = c, m = m)\n\n# 查看数据\nhead(data)\n\n           Time1      Time2       Time3\nGene1  0.1774993  1.6563226 -1.15259948\nGene2 -0.5037254 -0.5207024  0.46416071\nGene3  0.1050310  0.6079246  0.72893247\nGene4 -1.1791537  0.4340085  0.41061745\nGene5  0.8368975 -0.7047414 -1.46114720\nGene6  0.2611762  0.1351524 -0.01890809",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Gene Cluster Trend"
    ]
  },
  {
    "objectID": "Hiplot/062-gene-trend.html#可视化",
    "href": "Hiplot/062-gene-trend.html#可视化",
    "title": "基因聚类趋势图",
    "section": "可视化",
    "text": "可视化\n\n# 基因聚类趋势图\np &lt;- as.ggplot(function(){\n  mfuzz.plot2(\n  eset,\n  cl,\n  xlab = \"Time\",\n  ylab = \"Expression changes\",\n  mfrow = c(2,(c/2+0.5)),\n  colo = \"fancy\",\n  centre = T,\n  centre.col = \"red\",\n  time.labels = colnames(eset),\n  x11=F)\n  })\n\np\n\n\n\n\n\n\n\n图 1: 基因聚类趋势图\n\n\n\n\n\n如示例图所示，将基因聚集到不同的组中，每个组在不同时间点上显示出相似的表达模式。每个类群中突出显示了平均表达趋势。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Gene Cluster Trend"
    ]
  },
  {
    "objectID": "Hiplot/033-corrplot.html",
    "href": "Hiplot/033-corrplot.html",
    "title": "相关性热图 (Corrplot)",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Corrplot 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/corrplot?lang=zh_cn\n相关性热图是一种分析多个变量，两两之间相关性的图形。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Corrplot"
    ]
  },
  {
    "objectID": "Hiplot/033-corrplot.html#环境配置",
    "href": "Hiplot/033-corrplot.html#环境配置",
    "title": "相关性热图 (Corrplot)",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; corrplot; ggcorrplot; ggplotify\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"corrplot\", quietly = TRUE)) {\n  install.packages(\"corrplot\")\n}\nif (!requireNamespace(\"ggcorrplot\", quietly = TRUE)) {\n  install.packages(\"ggcorrplot\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(corrplot)\nlibrary(ggcorrplot)\nlibrary(ggplotify)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n corrplot   * 0.95    2024-10-14 [1] RSPM\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggcorrplot * 0.1.4.1 2023-09-05 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n ggplotify  * 0.1.3   2025-09-20 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Corrplot"
    ]
  },
  {
    "objectID": "Hiplot/033-corrplot.html#数据准备",
    "href": "Hiplot/033-corrplot.html#数据准备",
    "title": "相关性热图 (Corrplot)",
    "section": "数据准备",
    "text": "数据准备\n载入数据为基因名称及每个样本的表达量。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/corrplot/data.json\")$exampleData[[1]]$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndata &lt;- data[!is.na(data[, 1]), ]\nidx &lt;- duplicated(data[, 1])\ndata[idx, 1] &lt;- paste0(data[idx, 1], \"--dup-\", cumsum(idx)[idx])\nrownames(data) &lt;- data[, 1]\ndata &lt;- data[, -1]\nstr2num_df &lt;- function(x) {\n  final &lt;- NULL\n  for (i in seq_len(ncol(x))) {\n    final &lt;- cbind(final, as.numeric(x[, i]))\n  }\n  colnames(final) &lt;- colnames(x)\n  return(final)\n}\ntmp &lt;- str2num_df(t(data))\ncorr &lt;- round(cor(tmp, use = \"na.or.complete\", method = \"pearson\"), 3)\np_mat &lt;- round(cor_pmat(tmp, method = \"pearson\"), 3)\n\n# 查看数据\nhead(data)\n\n             M1       M2       M3       M4       M5       M6        M7       M8\nRGL4   8.454808 8.019389 8.990836 9.718631 7.908075 4.147051  4.985084 4.576711\nMPP7   8.690520 8.630346 7.080873 9.838476 8.271824 5.179200  5.200868 3.266993\nUGCG   8.648366 8.600555 9.431046 7.923021 8.309214 4.902510  5.750804 4.492856\nCYSTM1 8.628884 9.238677 8.487243 8.958537 7.357109 4.541605  6.370533 4.246651\nANXA2  4.983769 6.748022 6.220791 4.719403 3.284346 8.089850 10.637472 7.214912\nENDOD1 5.551640 5.406465 4.663785 3.550765 4.103507 8.393991  9.538503 9.069923\n             M9      M10\nRGL4   4.930349 4.293700\nMPP7   5.565226 4.300309\nUGCG   4.659987 3.306275\nCYSTM1 4.745769 3.449627\nANXA2  9.002710 5.123359\nENDOD1 8.639664 7.106392",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Corrplot"
    ]
  },
  {
    "objectID": "Hiplot/033-corrplot.html#可视化",
    "href": "Hiplot/033-corrplot.html#可视化",
    "title": "相关性热图 (Corrplot)",
    "section": "可视化",
    "text": "可视化\n\n# 相关性热图 (Corrplot)\np &lt;- as.ggplot(function(){\n  corrplot(\n    corr, \n    method = \"circle\", \n    type = \"upper\",\n    tl.col = \"black\", \n    diag = F,\n    col = colorRampPalette(c(\"#4477AA\", \"#FFFFFF\", \"#BB4444\"))(200),\n    order = \"hclust\",\n    hclust.method = \"ward.D2\")\n  }) +\n  xlab(\"\") + ylab(\"\") +\n  ggtitle(\"Cor Heatmap Plot\") +\n  theme_void() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_blank(), axis.text.y = element_blank(),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\np\n\n\n\n\n\n\n\n图 1: 相关性热图 (Corrplot)\n\n\n\n\n\n红色系表示两个基因之间呈正相关，蓝色系表示两个基因之间呈负相关，每一格中的数字表示相关系数。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Corrplot"
    ]
  },
  {
    "objectID": "Hiplot/080-grdotplot.html",
    "href": "Hiplot/080-grdotplot.html",
    "title": "分组排序点图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Group Rank Dotplot 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/grdotplot?lang=zh_cn\n不同组别连续变量样本值及分布比较。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Group Rank Dotplot"
    ]
  },
  {
    "objectID": "Hiplot/080-grdotplot.html#环境配置",
    "href": "Hiplot/080-grdotplot.html#环境配置",
    "title": "分组排序点图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; sigminer; ggplot2\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"sigminer\", quietly = TRUE)) {\n  remotes::install_github(\"ShixiangWang/sigminer\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(sigminer)\nlibrary(ggplot2)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package      * version date (UTC) lib source\n Biobase      * 2.70.0  2025-10-29 [1] Bioconduc~\n BiocGenerics * 0.56.0  2025-10-29 [1] Bioconduc~\n data.table   * 1.17.8  2025-07-10 [1] RSPM\n generics     * 0.1.4   2025-05-09 [1] RSPM\n ggplot2      * 4.0.1   2025-11-14 [1] RSPM\n jsonlite     * 2.0.0   2025-03-27 [1] RSPM\n sigminer     * 2.3.1   2024-05-11 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Group Rank Dotplot"
    ]
  },
  {
    "objectID": "Hiplot/080-grdotplot.html#数据准备",
    "href": "Hiplot/080-grdotplot.html#数据准备",
    "title": "分组排序点图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/grdotplot/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 查看数据\nhead(data)\n\n  gvar       dvar\n1    A  0.4871212\n2    A -0.1370275\n3    A  0.1717455\n4    A -0.9447939\n5    A -1.2876203\n6    A  1.4077657",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Group Rank Dotplot"
    ]
  },
  {
    "objectID": "Hiplot/080-grdotplot.html#可视化",
    "href": "Hiplot/080-grdotplot.html#可视化",
    "title": "分组排序点图",
    "section": "可视化",
    "text": "可视化\n\n# 分组排序点图\np &lt;- show_group_distribution(data, gvar = \"gvar\",  dvar = \"dvar\", \n                             order_by_fun = F)\n\np\n\n\n\n\n\n\n\n图 1: 分组排序点图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Group Rank Dotplot"
    ]
  },
  {
    "objectID": "Hiplot/040-density.html",
    "href": "Hiplot/040-density.html",
    "title": "密度图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Density 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/density?lang=zh_cn\n核密度图是一种用来观察连续型变量分布的图形。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Density"
    ]
  },
  {
    "objectID": "Hiplot/040-density.html#环境配置",
    "href": "Hiplot/040-density.html#环境配置",
    "title": "密度图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2; ggthemes\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"ggthemes\", quietly = TRUE)) {\n  install.packages(\"ggthemes\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(ggthemes)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n ggthemes   * 5.2.0   2025-11-30 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Density"
    ]
  },
  {
    "objectID": "Hiplot/040-density.html#数据准备",
    "href": "Hiplot/040-density.html#数据准备",
    "title": "密度图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/density/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndata[,2] &lt;- factor(data[,2], levels = unique(data[,2]))\n\n# 查看数据\nhead(data)\n\n  Value Group2\n1   4.2 treat1\n2  11.5 treat1\n3   7.3 treat1\n4   5.8 treat1\n5   6.4 treat1\n6  10.0 treat1",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Density"
    ]
  },
  {
    "objectID": "Hiplot/040-density.html#可视化",
    "href": "Hiplot/040-density.html#可视化",
    "title": "密度图",
    "section": "可视化",
    "text": "可视化\n\n# 密度图\ndata[\"group_add_by_code\"] &lt;- \"g1\"\n\np &lt;- ggplot(data, aes_(as.name(colnames(data[1])))) +\n  geom_density(col = \"white\", alpha = 0.85,\n               aes_(fill = as.name(colnames(data[2])))) +\n  ggtitle(\"\") +\n  scale_fill_manual(values = c(\"#e04d39\",\"#5bbad6\")) +\n  theme_stata() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 1: 密度图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Density"
    ]
  },
  {
    "objectID": "Hiplot/091-likert.html",
    "href": "Hiplot/091-likert.html",
    "title": "李克特图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Likert Plot 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/likert?lang=zh_cn\n对李克特量表带数据进行可视化描述性统计分析。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Likert Plot"
    ]
  },
  {
    "objectID": "Hiplot/091-likert.html#环境配置",
    "href": "Hiplot/091-likert.html#环境配置",
    "title": "李克特图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplotify; likert\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\nif (!requireNamespace(\"likert\", quietly = TRUE)) {\n  install.packages(\"likert\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplotify)\nlibrary(likert)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n ggplotify  * 0.1.3   2025-09-20 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n likert     * 1.3.5.1 2025-08-02 [1] RSPM\n xtable     * 1.8-4   2019-04-21 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Likert Plot"
    ]
  },
  {
    "objectID": "Hiplot/091-likert.html#数据准备",
    "href": "Hiplot/091-likert.html#数据准备",
    "title": "李克特图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/likert/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\nlevs &lt;- unique(unlist(data))\nfor (i in 1:ncol(data)) {\n  data[,i] &lt;- factor(data[, i], levels = levs)\n}\n\n# 查看数据\nhead(data)\n\n            ST24Q01           ST24Q02        ST24Q03           ST24Q04\n1 Strongly disagree    Strongly agree          Agree Strongly disagree\n2          Disagree    Strongly agree Strongly agree Strongly disagree\n3          Disagree          Disagree       Disagree             Agree\n4          Disagree          Disagree       Disagree          Disagree\n5          Disagree             Agree       Disagree Strongly disagree\n6             Agree Strongly disagree          Agree Strongly disagree\n            ST24Q05           ST24Q06        ST24Q07           ST24Q08\n1             Agree Strongly disagree          Agree          Disagree\n2    Strongly agree Strongly disagree          Agree          Disagree\n3          Disagree          Disagree       Disagree          Disagree\n4          Disagree Strongly disagree       Disagree          Disagree\n5             Agree Strongly disagree Strongly agree Strongly disagree\n6 Strongly disagree          Disagree       Disagree             Agree\n            ST24Q09           ST24Q10           ST24Q11\n1 Strongly disagree             Agree             Agree\n2 Strongly disagree             Agree             Agree\n3          Disagree          Disagree          Disagree\n4 Strongly disagree          Disagree          Disagree\n5 Strongly disagree Strongly disagree             Agree\n6          Disagree             Agree Strongly disagree",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Likert Plot"
    ]
  },
  {
    "objectID": "Hiplot/091-likert.html#可视化",
    "href": "Hiplot/091-likert.html#可视化",
    "title": "李克特图",
    "section": "可视化",
    "text": "可视化\n\n# 李克特图\npobj &lt;- likert(data)\ncolrs &lt;- c(\"#3B4992FF\",\"#EE0000FF\")\np &lt;- as.ggplot(plot(pobj, type = \"bar\", \n                    low.color = colrs[1], high.color = colrs[2], wrap = 50))\n\np\n\n\n\n\n\n\n\n图 1: 李克特图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Likert Plot"
    ]
  },
  {
    "objectID": "Hiplot/056-flowerplot.html",
    "href": "Hiplot/056-flowerplot.html",
    "title": "花瓣图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Flower plot 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/flowerplot?lang=zh_cn\n绘制多集合花瓣图。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Flower plot"
    ]
  },
  {
    "objectID": "Hiplot/056-flowerplot.html#环境配置",
    "href": "Hiplot/056-flowerplot.html#环境配置",
    "title": "花瓣图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; flowerplot; ggplotify\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"flowerplot\", quietly = TRUE)) {\n  remotes::install_github(\"dongwei1220/flowerplot\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(flowerplot)\nlibrary(ggplotify)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package      * version date (UTC) lib source\n data.table   * 1.17.8  2025-07-10 [1] RSPM\n flowerplot   * 0.1.0   2025-11-02 [1] Github (dongwei1220/flowerplot@64880d0)\n ggplotify    * 0.1.3   2025-09-20 [1] RSPM\n jsonlite     * 2.0.0   2025-03-27 [1] RSPM\n plotrix      * 3.8-13  2025-11-15 [1] RSPM\n RColorBrewer * 1.1-3   2022-04-03 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Flower plot"
    ]
  },
  {
    "objectID": "Hiplot/056-flowerplot.html#数据准备",
    "href": "Hiplot/056-flowerplot.html#数据准备",
    "title": "花瓣图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/flowerplot/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 查看数据\nhead(data)\n\n     Set1   Set2  Set3  Set4   Set5    Set6   Set7     Set8\n1   ZMIZ1  ADCY5  TNS1  TNS1   TNS1   ZMIZ1 SORBS1     RGS3\n2    TNS1  ACTN4 ZMIZ1 ZMIZ1  ZMIZ1    TNS1   TNS1    FHOD3\n3   CASZ1 SORBS1  RXRA  RXRA TSPAN9   CASZ1  ZMIZ1 PPARGC1B\n4    NFIC   TNS1 AHDC1 NCOR2   MIDN    NFIC  RBM20     NNMT\n5 CACNA1C  ZMIZ1 ACTN4  MIDN  NCOR2 CACNA1C TSPAN9   SORBS2\n6   AHDC1  RBM20  MIDN AHDC1  AHDC1   AHDC1  SYNPO   FAM53B",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Flower plot"
    ]
  },
  {
    "objectID": "Hiplot/056-flowerplot.html#可视化",
    "href": "Hiplot/056-flowerplot.html#可视化",
    "title": "花瓣图",
    "section": "可视化",
    "text": "可视化\n\n# 花瓣图\np &lt;- as.ggplot(function(){\n  flowerplot(\n    flower_dat = data,\n    angle = 90,\n    a = 0.5,\n    b = 2,\n    r = 1,\n    ellipse_col = \"RdBu\",\n    circle_col = \"#FFFFFF\",\n    label_text_cex = 1\n  )})\n\np\n\n\n\n\n\n\n\n图 1: 花瓣图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Flower plot"
    ]
  },
  {
    "objectID": "Hiplot/060-gene-density.html",
    "href": "Hiplot/060-gene-density.html",
    "title": "基因密度图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Gene Density 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/gene-density?lang=zh_cn\n染色体数据展示。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Gene Density"
    ]
  },
  {
    "objectID": "Hiplot/060-gene-density.html#环境配置",
    "href": "Hiplot/060-gene-density.html#环境配置",
    "title": "基因密度图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; circlize; ComplexHeatmap; gtrellis; tidyverse; ggplotify; RColorBrewer\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"circlize\", quietly = TRUE)) {\n  install.packages(\"circlize\")\n}\nif (!requireNamespace(\"ComplexHeatmap\", quietly = TRUE)) {\n  BiocManager::install(\"ComplexHeatmap\")\n}\nif (!requireNamespace(\"gtrellis\", quietly = TRUE)) {\n  remotes::install_github(\"jokergoo/gtrellis\")\n}\nif (!requireNamespace(\"tidyverse\", quietly = TRUE)) {\n  install.packages(\"tidyverse\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(circlize)\nlibrary(ComplexHeatmap)\nlibrary(gtrellis)\nlibrary(tidyverse)\nlibrary(ggplotify)\nlibrary(RColorBrewer)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package        * version date (UTC) lib source\n BiocGenerics   * 0.56.0  2025-10-29 [1] Bioconduc~\n circlize       * 0.4.17  2025-12-08 [1] RSPM\n ComplexHeatmap * 2.26.0  2025-10-29 [1] Bioconduc~\n data.table     * 1.17.8  2025-07-10 [1] RSPM\n dplyr          * 1.1.4   2023-11-17 [1] RSPM\n forcats        * 1.0.1   2025-09-25 [1] RSPM\n generics       * 0.1.4   2025-05-09 [1] RSPM\n GenomicRanges  * 1.62.1  2025-12-08 [1] Bioconduc~\n ggplot2        * 4.0.1   2025-11-14 [1] RSPM\n ggplotify      * 0.1.3   2025-09-20 [1] RSPM\n gtrellis       * 1.35.1  2025-11-02 [1] Github (jokergoo/gtrellis@86749f0)\n IRanges        * 2.44.0  2025-10-29 [1] Bioconduc~\n jsonlite       * 2.0.0   2025-03-27 [1] RSPM\n lubridate      * 1.9.4   2024-12-08 [1] RSPM\n purrr          * 1.2.0   2025-11-04 [1] RSPM\n RColorBrewer   * 1.1-3   2022-04-03 [1] RSPM\n readr          * 2.1.6   2025-11-14 [1] RSPM\n S4Vectors      * 0.48.0  2025-10-29 [1] Bioconduc~\n Seqinfo        * 1.0.0   2025-10-29 [1] Bioconduc~\n stringr        * 1.6.0   2025-11-04 [1] RSPM\n tibble         * 3.3.0   2025-06-08 [1] RSPM\n tidyr          * 1.3.2   2025-12-19 [1] RSPM\n tidyverse      * 2.0.0   2023-02-22 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Gene Density"
    ]
  },
  {
    "objectID": "Hiplot/060-gene-density.html#数据准备",
    "href": "Hiplot/060-gene-density.html#数据准备",
    "title": "基因密度图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata1 &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/gene-density/data.json\")$exampleData$textarea[[1]])\ndata1 &lt;- as.data.frame(data1)\ndata2 &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/gene-density/data.json\")$exampleData$textarea[[2]])\ndata2 &lt;- as.data.frame(data2)\n\n# 整理数据格式\nchrNum &lt;- str_replace(unique(data1$chr), \"Chr|chr\", \"\")\ndata1$chr &lt;- factor(data1$chr, levels = paste0(\"Chr\", chrNum))\ndata2$chr &lt;- factor(data2$chr, levels = paste0(\"Chr\", chrNum))\n# 设置窗口计算基因密度\nwindows &lt;- 100 * 1000 # 默认:100kb\ngene_density &lt;- genomicDensity(data2, window.size = windows)\ngene_density$chr &lt;- factor(gene_density$chr,\n  levels =  paste0(\"Chr\", chrNum)\n)\n\n# 查看数据\nhead(data1)\n\n    chr start      end\n1  Chr5     0 29958434\n2  Chr8     0 28443022\n3  Chr9     0 23012720\n4 Chr10     0 23207287\n5 Chr12     0 27531856\n\nhead(data2)\n\n    chr start   end\n1 Chr10 38648 40060\n2 Chr10 45941 58338\n3 Chr10 67119 72971\n4 Chr10 75410 76305\n5 Chr10 80964 82250\n6 Chr10 94798 97746",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Gene Density"
    ]
  },
  {
    "objectID": "Hiplot/060-gene-density.html#可视化",
    "href": "Hiplot/060-gene-density.html#可视化",
    "title": "基因密度图",
    "section": "可视化",
    "text": "可视化\n\n# 设置画板颜色\npalettes &lt;- c(\"#B2182B\",\"#EF8A62\",\"#FDDBC7\",\"#D1E5F0\",\"#67A9CF\",\"#2166AC\")\ncol_fun &lt;- colorRamp2(\n  seq(0, max(gene_density[[4]]), length = 6), rev(palettes)\n  )\ncm &lt;- ColorMapping(col_fun = col_fun)\n# 设置图例\nlgd &lt;- color_mapping_legend(\n  cm, plot = F, title = \"density\", color_bar = \"continuous\"\n  )\n# 绘制基因密度分布热图\np &lt;- as.ggplot(function() {\n  gtrellis_layout(\n    data1, n_track = 2, ncol = 1, byrow = FALSE,\n    track_axis = FALSE, add_name_track = FALSE,\n    xpadding = c(0.1, 0), gap = unit(1, \"mm\"),\n    track_height = unit.c(unit(1, \"null\"), unit(4, \"mm\")),\n    track_ylim = c(0, max(gene_density[[4]]), 0, 1),\n    border = FALSE, asist_ticks = FALSE,\n    legend = lgd\n    )\n  # 添加基因面积图 track\n  add_lines_track(gene_density, gene_density[[4]],\n                  area = TRUE, gp = gpar(fill = \"pink\"))\n  # 添加基因密度热图 track\n  add_heatmap_track(gene_density, gene_density[[4]], fill = col_fun)\n  add_track(track = 2, clip = FALSE, panel_fun = function(gr) {\n    chr &lt;- get_cell_meta_data(\"name\")\n    if (chr == paste(\"Chr\", length(chrNum), sep = \"\")) {\n      grid.lines(get_cell_meta_data(\"xlim\"), unit(c(0, 0), \"npc\"),\n                 default.units = \"native\")\n      }\n    grid.text(chr, x = 0.01, y = 0.38, just = c(\"left\", \"bottom\"))\n    })\n  circos.clear()\n  })\n\np\n\n\n\n\n\n\n\n图 1: 基因密度图",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Gene Density"
    ]
  },
  {
    "objectID": "Hiplot/068-ggpie.html",
    "href": "Hiplot/068-ggpie.html",
    "title": "饼状图（GGPIE）",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot GGPIE 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/ggpie?lang=zh_cn\n饼图是通过将一个圆形切分成多个切片以显示每一部分所占总体比例的统计图表。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "GGPIE"
    ]
  },
  {
    "objectID": "Hiplot/068-ggpie.html#环境配置",
    "href": "Hiplot/068-ggpie.html#环境配置",
    "title": "饼状图（GGPIE）",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggpie; dplyr; ggplot2; cowplot\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggpie\", quietly = TRUE)) {\n  install.packages(\"ggpie\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"cowplot\", quietly = TRUE)) {\n  install.packages(\"cowplot\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggpie)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(cowplot)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n cowplot    * 1.2.0   2025-07-07 [1] RSPM\n data.table * 1.17.8  2025-07-10 [1] RSPM\n dplyr      * 1.1.4   2023-11-17 [1] RSPM\n ggpie      * 0.2.5   2025-11-17 [1] Github (showteeth/ggpie@b2b8b9a)\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "GGPIE"
    ]
  },
  {
    "objectID": "Hiplot/068-ggpie.html#数据准备",
    "href": "Hiplot/068-ggpie.html#数据准备",
    "title": "饼状图（GGPIE）",
    "section": "数据准备",
    "text": "数据准备\n载入数据为不同分组及其数据。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/ggpie/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\naxis &lt;- c(\"am\", \"cyl\")\ndata[, axis[1]] &lt;- factor(data[, axis[1]], levels = unique(data[, axis[1]]))\ndata[, axis[2]] &lt;- factor(data[, axis[2]], levels = unique(data[, axis[2]]))\n\n# 查看数据\nhead(data)\n\n   mpg cyl disp  hp drat    wt  qsec vs am gear carb\n1 21.0   6  160 110 3.90 2.620 16.46  0  1    4    4\n2 21.0   6  160 110 3.90 2.875 17.02  0  1    4    4\n3 22.8   4  108  93 3.85 2.320 18.61  1  1    4    1\n4 21.4   6  258 110 3.08 3.215 19.44  1  0    3    1\n5 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2\n6 18.1   6  225 105 2.76 3.460 20.22  1  0    3    1",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "GGPIE"
    ]
  },
  {
    "objectID": "Hiplot/068-ggpie.html#可视化",
    "href": "Hiplot/068-ggpie.html#可视化",
    "title": "饼状图（GGPIE）",
    "section": "可视化",
    "text": "可视化\n\n# 饼状图\nplist &lt;- list()\nfor (j in unique(data[, axis[2]])) {\n  plist[[j]] &lt;- ggpie(\n    data = data[data[, axis[2]] == j,],\n    group_key = axis[1], count_type = \"full\",\n    label_type = \"horizon\", label_size = 8,\n    label_info = \"all\", label_pos = \"out\") + \n    scale_fill_manual(values = c(\"#00468BFF\",\"#ED0000FF\")) +\n    ggtitle(j)\n  }\n\nplot_grid(plotlist = plist, ncol = 3)\n\n\n\n\n\n\n\n饼状图\n\n在一个圆图中，每个切片的弧长（其中心角和中心角所对应区域的弧长）与所表示的数量成正比。该饼图展示了 1~4 组分别的样本数量及样本数量所对应的占比。一组样本数量 13，占比 11.71%，二组样本数量 34，占比 30.63%，三组样本数量 21，占比 18.92%，四组样本数量 43，占比38.74%。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "GGPIE"
    ]
  },
  {
    "objectID": "Hiplot/162-scatter2.html",
    "href": "Hiplot/162-scatter2.html",
    "title": "散点图2",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Scatter2 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/scatter2?lang=zh_cn\n二维空间散点展示多数值变量关系。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Scatter2"
    ]
  },
  {
    "objectID": "Hiplot/162-scatter2.html#环境配置",
    "href": "Hiplot/162-scatter2.html#环境配置",
    "title": "散点图2",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; grafify; ggplot2\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"grafify\", quietly = TRUE)) {\n  install.packages(\"grafify\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(grafify)\nlibrary(ggplot2)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n grafify    * 5.1.0   2025-08-25 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Scatter2"
    ]
  },
  {
    "objectID": "Hiplot/162-scatter2.html#数据准备",
    "href": "Hiplot/162-scatter2.html#数据准备",
    "title": "散点图2",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/scatter2/data.json\")$exampleData[[1]]$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 查看数据\nhead(data)\n\n                car  mpg cyl  disp  hp drat    wt  qsec vs am gear carb\n1    Hornet 4 Drive 21.4   6 258.0 110 3.08 3.215 19.44  1  0    3    1\n2 Hornet Sportabout 18.7   8 360.0 175 3.15 3.440 17.02  0  0    3    2\n3           Valiant 18.1   6 225.0 105 2.76 3.460 20.22  1  0    3    1\n4        Duster 360 14.3   8 360.0 245 3.21 3.570 15.84  0  0    3    4\n5        Merc 450SE 16.4   8 275.8 180 3.07 4.070 17.40  0  0    3    3\n6        Merc 450SL 17.3   8 275.8 180 3.07 3.730 17.60  0  0    3    3",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Scatter2"
    ]
  },
  {
    "objectID": "Hiplot/162-scatter2.html#可视化",
    "href": "Hiplot/162-scatter2.html#可视化",
    "title": "散点图2",
    "section": "可视化",
    "text": "可视化\n\n# 散点图2\nsymsize &lt;- data[,\"gear\"]\ndata[,\"gear\"] &lt;- factor(data[,\"gear\"], levels = unique(data[,\"gear\"]))\np &lt;- ggplot(data, aes(x = mpg, y = disp)) + \n  geom_point(alpha = 1, aes(size = gear, fill = gear), shape = 21, stroke = 0.5) +\n  labs(fill = \"gear\", color = \"gear\") +\n  guides(x = guide_axis(angle = 0),\n         fill = guide_legend(title = \"gear\"),\n         color = FALSE,\n         size = guide_legend(title = \"gear\")) +\n  ggtitle(\"Scatter2 Plot\") +\n  scale_fill_grafify() +\n  theme_classic(base_size = 20) +\n  theme(text = element_text(family = \"Arial\"),\n        strip.background = element_blank(),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 1: 散点图2",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Scatter2"
    ]
  },
  {
    "objectID": "Hiplot/061-gene-rank.html",
    "href": "Hiplot/061-gene-rank.html",
    "title": "基因差异表达排序图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Gene Ranking Dotplot 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/gene-rank?lang=zh_cn\n基因表达排序可视化。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Gene Ranking Dotplot"
    ]
  },
  {
    "objectID": "Hiplot/061-gene-rank.html#环境配置",
    "href": "Hiplot/061-gene-rank.html#环境配置",
    "title": "基因差异表达排序图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggrepel; ggplot2; RColorBrewer\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggrepel\", quietly = TRUE)) {\n  install.packages(\"ggrepel\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggrepel)\nlibrary(ggplot2)\nlibrary(RColorBrewer)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package      * version date (UTC) lib source\n data.table   * 1.17.8  2025-07-10 [1] RSPM\n ggplot2      * 4.0.1   2025-11-14 [1] RSPM\n ggrepel      * 0.9.6   2024-09-07 [1] RSPM\n jsonlite     * 2.0.0   2025-03-27 [1] RSPM\n RColorBrewer * 1.1-3   2022-04-03 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Gene Ranking Dotplot"
    ]
  },
  {
    "objectID": "Hiplot/061-gene-rank.html#数据准备",
    "href": "Hiplot/061-gene-rank.html#数据准备",
    "title": "基因差异表达排序图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/gene-rank/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\n## 按 log2FoldChange 和 pvalue 排序\ndata &lt;- data[order(-data$log2FC, data$pvalue), ]\n## 添加 rank 列\ndata$rank &lt;- 1:nrow(data)\n## 获取 top n 上调和下调基因进行标记\ntop_n &lt;- 5\ntop_n_up &lt;- rownames(head(data, top_n))\ntop_n_down &lt;- rownames(tail(data, top_n))\ngenes_to_label &lt;- c(top_n_up, top_n_down)\ndata2 &lt;- data[genes_to_label, ]\n\n\n# 查看数据\nhead(data)\n\n        gene   log2FC       pvalue rank\n514 LOC91370 3.889820 8.478310e-03    1\n293   LRRC25 3.492413 5.000000e-05    2\n470   BEGAIN 3.312996 3.347634e-03    3\n159   RDM1P5 3.125070 1.538852e-02    4\n194    CLDN1 3.096516 2.622163e-02    5\n626    KCNS1 2.949729 2.770000e-09    6",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Gene Ranking Dotplot"
    ]
  },
  {
    "objectID": "Hiplot/061-gene-rank.html#可视化",
    "href": "Hiplot/061-gene-rank.html#可视化",
    "title": "基因差异表达排序图",
    "section": "可视化",
    "text": "可视化\n\n# 基因差异表达排序图\np &lt;- \n  ggplot(data, aes(rank, log2FC, color = pvalue, size = abs(log2FC))) + \n  geom_point() + \n  scale_color_gradientn(colours = colorRampPalette(brewer.pal(11,'RdYlBu'))(100)) +\n  geom_hline(yintercept = c(-1, 1), linetype = 2, size = 0.3) +\n  geom_hline(yintercept = 0, linetype = 1, size = 0.5) +\n  geom_vline(xintercept = median(data$rank), linetype = 2, size = 0.3) + \n  geom_text_repel(data = data2, aes(rank, log2FC, label = gene),\n                  size = 3, color = \"red\") +\n  xlab(\"\") + ylab(\"\") + \n  ylim(c(-max(abs(data$log2FC)), max(abs(data$log2FC)))) +\n  labs(color = \"Pvalue\", size = \"Log2FoldChange\") +\n  theme_bw(base_size = 12) +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 1: 基因差异表达排序图",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Gene Ranking Dotplot"
    ]
  },
  {
    "objectID": "Hiplot/025-complex-heatmap.html",
    "href": "Hiplot/025-complex-heatmap.html",
    "title": "复合热图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Complex Heatmap 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/complex-heatmap?lang=zh_cn\n一个多组学插件同时绘制热图、注释和突变信息。",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Complex Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/025-complex-heatmap.html#环境配置",
    "href": "Hiplot/025-complex-heatmap.html#环境配置",
    "title": "复合热图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ComplexHeatmap; circlize; randomcoloR; ggplotify; stringr; cowplot; hiplotlib\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ComplexHeatmap\", quietly = TRUE)) {\n  BiocManager::install(\"ComplexHeatmap\")\n}\nif (!requireNamespace(\"circlize\", quietly = TRUE)) {\n  install.packages(\"circlize\")\n}\nif (!requireNamespace(\"randomcoloR\", quietly = TRUE)) {\n  install.packages(\"randomcoloR\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\nif (!requireNamespace(\"stringr\", quietly = TRUE)) {\n  install.packages(\"stringr\")\n}\nif (!requireNamespace(\"cowplot\", quietly = TRUE)) {\n  install.packages(\"cowplot\")\n}\nif (!requireNamespace(\"hiplotlib\", quietly = TRUE)) {\n  remotes::install_github(\"hiplot/hiplotlib\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ComplexHeatmap)\nlibrary(circlize)\nlibrary(randomcoloR)\nlibrary(ggplotify)\nlibrary(stringr)\nlibrary(cowplot)\nlibrary(hiplotlib)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package        * version date (UTC) lib source\n circlize       * 0.4.17  2025-12-08 [1] RSPM\n ComplexHeatmap * 2.26.0  2025-10-29 [1] Bioconduc~\n cowplot        * 1.2.0   2025-07-07 [1] RSPM\n data.table     * 1.17.8  2025-07-10 [1] RSPM\n ggplotify      * 0.1.3   2025-09-20 [1] RSPM\n hiplotlib      * 0.2.1-2 2025-11-02 [1] Github (hiplot/hiplotlib@2d28690)\n jsonlite       * 2.0.0   2025-03-27 [1] RSPM\n randomcoloR    * 1.1.0.1 2019-11-24 [1] RSPM\n stringr        * 1.6.0   2025-11-04 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Complex Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/025-complex-heatmap.html#数据准备",
    "href": "Hiplot/025-complex-heatmap.html#数据准备",
    "title": "复合热图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/complex-heatmap/data.json\")$exampleData[[1]]$textarea[[1]])\ndata &lt;- as.data.frame(data)\ndata2 &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/complex-heatmap/data.json\")$exampleData[[1]]$textarea[[2]])\ndata2 &lt;- as.data.frame(data2)\n\n# 整理数据格式\nkeep_vars_ref &lt;- ls() \nrow.names(data) &lt;- data[, 1]\ndata &lt;- data[, -1]\naxis_raw &lt;- c(\"KRAS\",\"GBP4\")\nexp_start_col &lt;- which(colnames(data) == axis_raw[2])\nmut_start_col &lt;- which(colnames(data) == axis_raw[1])\nheat_mat &lt;- as.matrix(t(data[, exp_start_col:ncol(data)]))\nmut_mat &lt;- as.matrix(t(data[, mut_start_col:(exp_start_col - 1)]))\nmut_mat[is.na(mut_mat)] &lt;- \"\"\n\ncolor_key &lt;- c(\"#196ABD\", \"#3399FF\", \"#3399FF\", \"#f4f4f4\", \"#f4f4f4\", \"#f4f4f4\", \"#FF3333\", \"#FF3333\", \"#C20B01\")\n\ncols &lt;- c()\nfor (i in 1:nrow(data2)) {\n  cols[data2[i,1]] &lt;- data2[i,2]\n}\ncol_meta &lt;- list()\ncol_meta_pre &lt;- list()\nitems &lt;- c()\nfor (i in 1:(mut_start_col - 1)) {\n  ref &lt;- unique(data[, i])\n  ref &lt;- ref[!is.na(ref) & ref != \"\"]\n  if (any(is.numeric(ref)) & length(ref) &gt; 2) {\n    col_meta_pre[[colnames(data)[i]]] &lt;- hiplotlib::col_fun_cont(data[,i])\n  } else if (length(ref) == 2 & any(is.numeric(ref))) {\n    col_meta_pre[[colnames(data)[i]]] &lt;- c(\"#f4f4f4\", \"#5a5a5a\")\n    items &lt;- c(items, ref)\n  } else if (length(ref) == 2 & any(is.character(ref))) {\n    col_meta_pre[[colnames(data)[i]]] &lt;- c(\"#196ABD\", \"#C20B01\")\n    items &lt;- c(items, unique(data[, i]))\n  } else if (length(unique(data[, i])) &gt; 2) {\n    col_meta_pre[[colnames(data)[i]]] &lt;- distinctColorPalette(\n      length(unique(data[, i]))\n    )\n    items &lt;- c(items, unique(data[, i]))\n  }\n}\nmeta_mat2 &lt;- NULL\nmeta_mat2_unique_names &lt;- c()\nmeta_mat2_unique_cols &lt;- c()\nfor (i in names(col_meta_pre)) {\n  if (!is.function(col_meta_pre[[i]])) {\n    meta_mat2_unique_names &lt;- c(meta_mat2_unique_names, i)\n    meta_mat2_unique_cols &lt;- c(meta_mat2_unique_cols, col_meta_pre[[i]])\n    meta_mat2 &lt;- cbind(meta_mat2, data[, i])\n    colnames(meta_mat2)[ncol(meta_mat2)] &lt;- i\n  } else {\n    col_meta[[i]] &lt;- col_meta_pre[[i]]\n  }\n}\nmeta_mat2 &lt;- as.matrix(meta_mat2)\ncol_meta[[\"Meta2\"]] &lt;- structure(\n  names = items[!duplicated(items)],\n  meta_mat2_unique_cols[!duplicated(items)]\n)\n\n# 查看数据\nhead(data)\n\n   Age Gender      Fusion Death Relapse     KRAS       TP53                NRAS\nM1  12 Female   ETV6-PMEL     0       0 missense       &lt;NA&gt; missense/frameshift\nM2   5   Male ETV6-BORCS5     0       1 missense       &lt;NA&gt;                &lt;NA&gt;\nM3  16 Female   ETV6-NID1     0       0 missense       &lt;NA&gt;                &lt;NA&gt;\nM4  26 Female     ERG-FUS     0       0     &lt;NA&gt;       &lt;NA&gt;                &lt;NA&gt;\nM5  32 Female RUNX1-UGGT2     1       0     &lt;NA&gt; frameshift                &lt;NA&gt;\nM6   1 Female  ETV6-RUNX1     1       1 missense       &lt;NA&gt;                &lt;NA&gt;\n         JAK1       JAK3       PTEN   NOTCH1      KMT2A               SETD2\nM1       &lt;NA&gt; frameshift       &lt;NA&gt;     &lt;NA&gt;       &lt;NA&gt; missense/frameshift\nM2       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;     &lt;NA&gt;       &lt;NA&gt;                &lt;NA&gt;\nM3       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; missense   nonsense            nonsense\nM4       &lt;NA&gt;       &lt;NA&gt; proteinIns     &lt;NA&gt;       &lt;NA&gt;                &lt;NA&gt;\nM5       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; missense frameshift                &lt;NA&gt;\nM6 frameshift       &lt;NA&gt; proteinIns     &lt;NA&gt;       &lt;NA&gt;                &lt;NA&gt;\n        KDM6A     DNMT3A                        DDX3X     GBP4    BCAT1\nM1                  &lt;NA&gt;                         &lt;NA&gt; 6.599344 5.760380\nM2   nonsense       &lt;NA&gt;                         &lt;NA&gt; 5.226266 4.892783\nM3       &lt;NA&gt;       &lt;NA&gt;                         &lt;NA&gt; 3.693288 5.448924\nM4       &lt;NA&gt;       &lt;NA&gt;                         &lt;NA&gt; 3.938501 3.485413\nM5       &lt;NA&gt;       &lt;NA&gt;                         &lt;NA&gt; 4.527193 3.855669\nM6 proteinDel frameshift missense/frameshift/missense 9.308119 8.662081\n      CMPK2    STOX2    PADI2   SCARNA5 ALOX12P2  SNORA74B HIST1H2BL     MNDA\nM1 9.561905 8.396409 8.419766  7.653074 9.001421  5.538709  6.181270 8.702635\nM2 4.549168 8.717055 8.268430  5.780393 7.753542  7.169053  4.448419 7.322352\nM3 3.998655 8.039064 8.451181 10.633550 4.920960 11.441646  5.604961 9.271821\nM4 5.614384 7.643060 9.200732  5.913684 7.636354  5.982566  6.485168 9.134515\nM5 3.904793 9.274649 8.598207  8.805605 9.888625  8.394403  2.599574 8.339114\nM6 9.790770 4.417013 4.590033  5.890120 6.211944  4.751559  7.630177 4.571902\n      OLFM4     FLT3     CHD7    NFIL3   HSPA1B    AP5B1   IPCEF1     LRG1\nM1 9.345308 5.164306 8.373475 8.055416 5.008199 8.236820 8.263067 8.553083\nM2 6.438607 4.419355 8.728032 8.365100 9.194650 8.972639 9.287856 9.053322\nM3 8.716761 5.063551 8.408818 9.239194 6.598850 8.204217 8.602233 9.074509\nM4 9.685545 5.412784 8.716476 8.536825 7.129509 8.432428 8.491156 8.736700\nM5 7.688262 3.337863 8.373771 8.452351 3.885270 9.224007 8.447699 7.656333\nM6 5.969804 8.585164 4.613199 4.478527 5.712179 4.424204 4.483936 4.529944\n      THBS4     RGL4     MPP7     UGCG   CYSTM1    ANXA2   ENDOD1 ARHGAP24\nM1 8.881039 8.454808 8.690520 8.648366 8.628884 4.983769 5.551640 6.890079\nM2 8.896205 8.019389 8.630346 8.600555 9.238677 6.748022 5.406465 8.883941\nM3 7.844801 8.990836 7.080873 9.431046 8.487243 6.220791 4.663785 9.560651\nM4 8.739369 9.718631 9.838476 7.923021 8.958537 4.719403 3.550765 8.285674\nM5 8.627063 7.908075 8.271824 8.309214 7.357109 3.284346 4.103507 9.043752\nM6 4.699310 4.147051 5.179200 4.902510 4.541605 8.089850 8.393991 3.544010\n       CST7 HIST1H2BM     EREG     EMP1    NFAM1  SLC40A1     CD52 HIST1H2BH\nM1 7.883061  6.186908 8.598145 4.837475 8.656290 9.520822 4.230927  5.805177\nM2 8.546585  4.448803 4.920184 5.999576 9.957289 4.630086 5.932496  4.343197\nM3 8.364553  5.428771 9.227645 6.115168 7.319900 5.116486 5.011898  6.139380\nM4 9.540110  6.747681 5.222157 5.056323 8.073514 9.346003 5.101308  5.817530\nM5 8.697473  2.577579 4.689850 4.808930 9.016658 9.813192 4.398327  2.513284\nM6 3.557674  7.828233 8.703617 6.713164 4.517623 6.101416 6.380094  8.188458\n     PFKFB3 SNORD116-20    STX11    SYNE2     TCN1  SNORA74A     CD74   EIF4E3\nM1 7.424257    8.377058 8.338488 9.110726 8.193179  5.498904 5.017443 9.366888\nM2 9.676785    5.359553 8.565954 9.678361 8.907285  5.062103 5.383978 8.360189\nM3 8.935156    8.694841 8.767868 8.405612 8.713848 12.561499 3.405651 5.655052\nM4 8.045833    8.044567 9.403257 6.946242 8.980928  5.839202 3.264327 4.287721\nM5 8.890690    2.953568 7.892702 8.156073 7.627558  7.581051 5.602966 8.713765\nM6 4.273864    7.268419 4.205835 5.791007 4.626609  5.498296 8.550157 8.880801\n      MYO7B       MX1      LDLR    S100P  PTPRCAP      KIT     OLR1      NKG7\nM1 8.796115 10.739903  3.302395 8.356363 5.028667 5.888212 9.018682  7.312523\nM2 9.265837  4.504043 10.582430 7.915491 4.724011 2.533194 7.936957 10.372964\nM3 7.865640  4.714303  6.209913 9.481770 4.122229 5.077111 9.390897  7.937744\nM4 8.785320  6.244798  3.804214 9.642993 4.188948 4.744693 8.897994  8.161249\nM5 9.209703  4.891501  4.631391 8.363519 3.803051 4.839051 8.668925  9.671051\nM6 4.272202 10.727879  5.534046 3.699451 8.525159 9.085158 5.261595  4.164076",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Complex Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/025-complex-heatmap.html#可视化",
    "href": "Hiplot/025-complex-heatmap.html#可视化",
    "title": "复合热图",
    "section": "可视化",
    "text": "可视化\n\n# 复合热图\nparams &lt;- list()\nfor (i in names(col_meta)) {\n  if (i != \"Meta2\") {\n    params[[i]] &lt;- data[, i]\n  }\n}\nparams2 &lt;- list(\n  Meta2 = meta_mat2,\n  gap = 0,\n  border = TRUE,\n  show_annotation_name = TRUE,\n  col = col_meta,\n  na_col = \"#FFFFFF\",\n  show_legend = FALSE,\n  annotation_legend_param = list(direction = \"horizontal\")\n)\nfor (i in names(params2)) {\n  params[[i]] &lt;- params2[[i]]\n}\nha &lt;- do.call(HeatmapAnnotation, params)\nhlist &lt;- Heatmap(heat_mat,\n      col = hiplotlib::col_fun_cont(heat_mat, cols = color_key),\n      name = \"Expression\",\n      gap = 0,\n      clustering_distance_columns = \"euclidean\",\n      clustering_distance_rows = \"euclidean\",\n      clustering_method_columns = \"ward.D2\",\n      show_row_dend = TRUE, show_column_dend = TRUE,\n      show_row_names = FALSE,\n      row_title_gp = gpar(col = \"#FFFFFF00\"),\n      cluster_rows = TRUE,\n      cluster_columns = TRUE,\n      bottom_annotation = ha,\n      show_heatmap_legend = TRUE,\n      heatmap_legend_param = list(direction = \"horizontal\")\n    )\np1 &lt;- as.ggplot(\n  function() {\n    draw(hlist, annotation_legend_side = \"right\", heatmap_legend_side = \"top\")\n  }\n)\nidx &lt;- sort(rowSums(!is.na(mut_mat) & mut_mat != \"0\" & mut_mat != \"\"), decreasing = TRUE)\nmut_mat &lt;- mut_mat[names(idx),]\n\np2 &lt;- as.ggplot(\n  function() {\n    params &lt;- list(\n      mut_mat,\n      get_type = function(x) strsplit(x, \"/\")[[1]],\n      alter_fun = hiplotlib::alter_fun, col = cols, row_order = 1:nrow(mut_mat),\n      show_column_names = TRUE,\n      show_pct = TRUE,\n      right_annotation = NULL,\n      top_annotation = NULL,\n      border = TRUE,\n      heatmap_legend_param = list(direction = \"horizontal\"),\n      show_heatmap_legend = FALSE)\n      params$column_order &lt;- unlist(column_order(hlist))\n      draw(do.call(oncoPrint, params), annotation_legend_side = \"bottom\", heatmap_legend_side = \"bottom\")\n    }\n  )\n\np3 &lt;- as.ggplot(function() {\n    legend_tmp &lt;- list()\n    for (i in names(col_meta_pre)) {\n      if (is.function(col_meta_pre[[i]])) {\n        legend_tmp[[i]] &lt;- Legend(\n          col_fun = col_meta_pre[[i]],\n          title = i, direction = \"horizontal\"\n        )\n      } else if (identical(col_meta_pre[[i]], c(\"#f4f4f4\", \"#5a5a5a\"))) {\n        legend_tmp[[i]] &lt;- Legend(\n          at = unique(data[, i]), title = i,\n          direction = \"horizontal\",\n          labels = c(\"No\", \"Yes\"),\n          legend_gp = gpar(fill = col_meta_pre[[i]])\n        )\n      } else {\n         legend_tmp[[i]] &lt;- Legend(\n          at = unique(data[, i]), title = i,\n          direction = \"horizontal\",\n          legend_gp = gpar(fill = col_meta_pre[[i]])\n        )\n      }\n    }\n    ref_mut &lt;- unique(unlist(str_split(mut_mat, \"/\")))\n    ref_mut &lt;- ref_mut[ref_mut != \"\" & ref_mut != \"NANA\"]\n    ref_mut &lt;- ref_mut[!is.na(ref_mut)]\n    lgd_mut &lt;- Legend(\n      at = ref_mut, title = \"Mutations\",\n      direction = \"horizontal\",\n      legend_gp = gpar(fill = cols[ref_mut])\n    )\n    legend_tmp[[length(legend_tmp) + 1]] &lt;- lgd_mut\n    legend_tmp$direction &lt;- \"horizontal\"\n    legend_tmp$max_width &lt;- unit(14, \"cm\")\n    legend_tmp$column_gap &lt;- unit(5, \"mm\")\n    legend_tmp$row_gap &lt;- unit(0.5, \"cm\")\n    draw(do.call(packLegend, legend_tmp))\n  })\nrel_height &lt;- as.numeric(str_split(\"4, 2, 2\", \", |,| |;\")[[1]])\np &lt;- plot_grid(p1, p2, p3, ncol = 1, rel_heights = rel_height)\np\n\n\n\n\n\n\n\n图 1: 复合热图",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Complex Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/078-gobubble.html",
    "href": "Hiplot/078-gobubble.html",
    "title": "GO气泡图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot GOBubble Plot 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/gobubble?lang=zh_cn\nGO气泡图用于显示按z-score或adjusted p-value的负相对序列的Z-score彩色气泡图。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "GOBubble Plot"
    ]
  },
  {
    "objectID": "Hiplot/078-gobubble.html#环境配置",
    "href": "Hiplot/078-gobubble.html#环境配置",
    "title": "GO气泡图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; GOplot; ggplotify\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"GOplot\", quietly = TRUE)) {\n  install.packages(\"GOplot\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(GOplot)\nlibrary(ggplotify)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package      * version date (UTC) lib source\n data.table   * 1.17.8  2025-07-10 [1] RSPM\n ggdendro     * 0.2.0   2024-02-23 [1] RSPM\n ggplot2      * 4.0.1   2025-11-14 [1] RSPM\n ggplotify    * 0.1.3   2025-09-20 [1] RSPM\n GOplot       * 1.0.2   2016-03-30 [1] RSPM\n gridExtra    * 2.3     2017-09-09 [1] RSPM\n jsonlite     * 2.0.0   2025-03-27 [1] RSPM\n RColorBrewer * 1.1-3   2022-04-03 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "GOBubble Plot"
    ]
  },
  {
    "objectID": "Hiplot/078-gobubble.html#数据准备",
    "href": "Hiplot/078-gobubble.html#数据准备",
    "title": "GO气泡图",
    "section": "数据准备",
    "text": "数据准备\n加载的数据是具有七个列的GO富集的结果：category, GO id, GO term, gene count, gene name, logFC, adjust pvalue and zscore。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/gobubble/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ncolnames(data) &lt;- c(\"category\",\"ID\",\"term\",\"count\",\"genes\",\"logFC\",\"adj_pval\",\"zscore\")\ndata &lt;- data[data$category %in% c(\"BP\",\"CC\",\"MF\"),]\ndata &lt;- data[!is.na(data$adj_pval),]\ndata$adj_pval &lt;- as.numeric(data$adj_pval)\ndata$zscore &lt;- as.numeric(data$zscore)\n\n# 查看数据\nhead(data)\n\n  category         ID              term count  genes      logFC adj_pval\n1       BP GO:0007507 heart development    54   DLC1 -0.9707875 2.17e-06\n2       BP GO:0007507 heart development    54   NRP2 -1.5153173 2.17e-06\n3       BP GO:0007507 heart development    54   NRP1 -1.1412315 2.17e-06\n4       BP GO:0007507 heart development    54   EDN1  1.3813006 2.17e-06\n5       BP GO:0007507 heart development    54 PDLIM3 -0.8876939 2.17e-06\n6       BP GO:0007507 heart development    54   GJA1 -0.8179480 2.17e-06\n      zscore\n1 -0.8164966\n2 -0.8164966\n3 -0.8164966\n4 -0.8164966\n5 -0.8164966\n6 -0.8164966",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "GOBubble Plot"
    ]
  },
  {
    "objectID": "Hiplot/078-gobubble.html#可视化",
    "href": "Hiplot/078-gobubble.html#可视化",
    "title": "GO气泡图",
    "section": "可视化",
    "text": "可视化\n\n# GO气泡图\np &lt;- function () {\n  GOBubble(data, display = \"single\", title = \"GO Enrichment Bubbleplot\",\n           colour = c(\"#FC8D59\",\"#FFFFBF\",\"#99D594\"),\n           labels = 0,  ID = T, table.legend = T, table.col = T, bg.col = F) + \n  theme(plot.title = element_text(hjust = 0.5))\n}\np &lt;- as.ggplot(p)\n\np\n\n\n\n\n\n\n\n图 1: GO气泡图\n\n\n\n\n\n如示例图所示，图的x轴表示z-score。y轴上显示了 adjusted p-value 的负对数（对应于该 term 的重要性）。绘制圆圈的面积与分配给该 term 的基因数量成正比。每个圆都根据其类别进行着色，并用 ID 或 term 名称标记。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "GOBubble Plot"
    ]
  },
  {
    "objectID": "Hiplot/150-radar.html",
    "href": "Hiplot/150-radar.html",
    "title": "雷达图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Radar 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/radar?lang=zh_cn\n雷达图是以从同一点开始的轴上表示的三个或更多个定量变量的二维图表的形式显示多变量数据，以直观的表达某个研究对象在多种参数的对比。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Radar"
    ]
  },
  {
    "objectID": "Hiplot/150-radar.html#环境配置",
    "href": "Hiplot/150-radar.html#环境配置",
    "title": "雷达图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggradar; dplyr; scales; tibble; ggplot2\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggradar\", quietly = TRUE)) {\n  remotes::install_github(\"ricardo-bion/ggradar\", dependencies = TRUE)\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"scales\", quietly = TRUE)) {\n  install.packages(\"scales\")\n}\nif (!requireNamespace(\"tibble\", quietly = TRUE)) {\n  install.packages(\"tibble\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggradar)\nlibrary(dplyr)\nlibrary(scales)\nlibrary(tibble)\nlibrary(ggplot2)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n dplyr      * 1.1.4   2023-11-17 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n ggradar    * 0.2     2025-11-02 [1] Github (ricardo-bion/ggradar@f99517a)\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n scales     * 1.4.0   2025-04-24 [1] RSPM\n tibble     * 3.3.0   2025-06-08 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Radar"
    ]
  },
  {
    "objectID": "Hiplot/150-radar.html#数据准备",
    "href": "Hiplot/150-radar.html#数据准备",
    "title": "雷达图",
    "section": "数据准备",
    "text": "数据准备\n数据载入为数据集 (4 种疾病中 5 个基因的表达水平)。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/radar/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndata &lt;- as.data.frame(t(data))\ncolnames(data) &lt;- data[1, ]\ndata &lt;- data[-1, ]\nfor (i in seq_len(ncol(data))) {\n  data[, i] &lt;- as.numeric(data[, i])\n}\ndata_radar &lt;- data %&gt;%\n  rownames_to_column(var = \"sample\")\ndata_radar &lt;- data_radar %&gt;% mutate_at(vars(-sample), rescale)\n\n# 查看数据\nhead(data)\n\n   value1 value2 value3 value4 value5\nS1      6    160    110   3.90  2.620\nS2      6    160    110   3.90  2.875\nS3      4    108     93   3.85  2.320\nS4      6    258    110   3.08  3.215",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Radar"
    ]
  },
  {
    "objectID": "Hiplot/150-radar.html#可视化",
    "href": "Hiplot/150-radar.html#可视化",
    "title": "雷达图",
    "section": "可视化",
    "text": "可视化\n\n# 雷达图\np &lt;- ggradar(data_radar, gridline.max.linetype = 1, group.point.size = 4,\n             group.line.width = 1, font.radar = \"Arial\", fill.alpha = 0.5,\n             gridline.min.colour = \"grey\", gridline.mid.colour = \"#007A87\",\n             gridline.max.colour = \"grey\") +\n  ggtitle(\"Radar Plot\") +\n  scale_color_manual(values = c(\"#E64B35FF\",\"#4DBBD5FF\",\"#00A087FF\",\"#3C5488FF\")) +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_blank(),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_blank(),\n        axis.title.y=element_blank(),\n        axis.ticks.y=element_blank(),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n \np\n\n\n\n\n\n\n\n图 1: 雷达图\n\n\n\n\n\n雷达图每种颜色表示一种疾病，每个点所在的位置表示不同基因表达情况，基因表达值越高，则越远离圆心，反之则越靠近圆心。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Radar"
    ]
  },
  {
    "objectID": "Hiplot/127-network-igraph.html",
    "href": "Hiplot/127-network-igraph.html",
    "title": "网路图 (igraph)",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Network (igraph) 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/network-igraph?lang=zh_cn\n基于 igrpah 可视化基础网路图。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Network (igraph)"
    ]
  },
  {
    "objectID": "Hiplot/127-network-igraph.html#环境配置",
    "href": "Hiplot/127-network-igraph.html#环境配置",
    "title": "网路图 (igraph)",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; igraph; stringr; ggplotify; RColorBrewer\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"igraph\", quietly = TRUE)) {\n  install.packages(\"igraph\")\n}\nif (!requireNamespace(\"stringr\", quietly = TRUE)) {\n  install.packages(\"stringr\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(igraph)\nlibrary(stringr)\nlibrary(ggplotify)\nlibrary(RColorBrewer)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package      * version date (UTC) lib source\n data.table   * 1.17.8  2025-07-10 [1] RSPM\n ggplotify    * 0.1.3   2025-09-20 [1] RSPM\n igraph       * 2.2.1   2025-10-27 [1] RSPM\n jsonlite     * 2.0.0   2025-03-27 [1] RSPM\n RColorBrewer * 1.1-3   2022-04-03 [1] RSPM\n stringr      * 1.6.0   2025-11-04 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Network (igraph)"
    ]
  },
  {
    "objectID": "Hiplot/127-network-igraph.html#数据准备",
    "href": "Hiplot/127-network-igraph.html#数据准备",
    "title": "网路图 (igraph)",
    "section": "数据准备",
    "text": "数据准备\n需要输入两个数据表，表 1 为节点信息，包含节点的 ID 和 其余注释信息（用于映射颜色和大小），表 2 为连线信息，包含节点的 ID 以及节点之间的关联信息（用于连接不同节点，并映射连线的宽度信息）。\n\n# 加载数据\nnodes_data &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/network-igraph/data.json\")$exampleData[[1]]$textarea[[1]])\nnodes_data &lt;- as.data.frame(nodes_data)\nedges_data &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/network-igraph/data.json\")$exampleData[[1]]$textarea[[2]])\nedges_data &lt;- as.data.frame(edges_data)\n\n# 整理数据格式\nnodes_data[,\"type.label\"] &lt;- factor(nodes_data[,\"type.label\"], \n                                    levels = unique(nodes_data[,\"type.label\"]))\nnodes_data$hiplot_color_type &lt;- as.numeric(nodes_data[,\"type.label\"])\nnet &lt;- graph_from_data_frame(d = edges_data, vertices = nodes_data, directed = T)\n## 根据类型生成颜色\ncolrs &lt;- c(\"#7f7f7f\",\"#ff6347\",\"#ffd700\")\ncolrs2 &lt;- c(\"#BC3C29FF\",\"#0072B5FF\",\"#E18727FF\",\"#20854EFF\",\"#7876B1FF\",\n            \"#6F99ADFF\",\"#FFDC91FF\",\"#EE4C97FF\")\nV(net)$color &lt;- colrs[V(net)$hiplot_color_type]\n## 计算节点度（#links）并使用它来设置节点大小\ndeg &lt;- degree(net, mode=\"all\")\nV(net)$size &lt;- deg*3\n## 设置标签\nV(net)$label.color &lt;- \"black\"\nV(net)$label &lt;- NA\n## 根据权重设置边宽度\nweight_column &lt;- edges_data$weight\nE(net)$width &lt;- weight_column/6\n## 改变箭头大小和边颜色\nE(net)$arrow.size &lt;- .2\nE(net)$edge.color &lt;- \"gray80\"\nedge.start &lt;- ends(net, es=E(net), names=F)[,1]\nedge.col &lt;- V(net)$color[edge.start]\n\n# 查看数据\nhead(nodes_data)\n\n   id               media media.type type.label audience.size hiplot_color_type\n1 s01            NY Times          1  Newspaper            20                 1\n2 s02     Washington Post          1  Newspaper            25                 1\n3 s03 Wall Street Journal          1  Newspaper            30                 1\n4 s04           USA Today          1  Newspaper            32                 1\n5 s05            LA Times          1  Newspaper            20                 1\n6 s06       New York Post          1  Newspaper            50                 1\n\nhead(edges_data)\n\n  from  to      type weight\n1  s01 s02 hyperlink     22\n2  s01 s03 hyperlink     22\n3  s01 s04 hyperlink     21\n4  s01 s15   mention     20\n5  s02 s01 hyperlink     23\n6  s02 s03 hyperlink     21",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Network (igraph)"
    ]
  },
  {
    "objectID": "Hiplot/127-network-igraph.html#可视化",
    "href": "Hiplot/127-network-igraph.html#可视化",
    "title": "网路图 (igraph)",
    "section": "可视化",
    "text": "可视化\n\n# 网路图 (igraph)\nraw &lt;- par()\np &lt;- as.ggplot(function () {\n  par(mar=c(8,2,2,2))\n  radian.rescale &lt;- function(x, start=0, direction=1) {\n    c.rotate &lt;- function(x) (x + start) %% (4 * pi) * direction\n    c.rotate(scales::rescale(x, c(0, 2 * pi), range(x)))\n  }\n\n  label &lt;- eval(parse(text = sprintf(\"V(net)$%s\", \"media\")))\n\n  l &lt;- do.call(layout_as_star, list(net))\n  params &lt;- list(net, layout = l, main = \"Network1\",\n      edge.color = edge.col, edge.curved = .1,\n      vertex.shape = \"circle\",\n      edge.lty = \"solid\",\n      label.family = \"Arial\",\n      vertex.label.family = \"Arial\",\n      vertex.label.dist = 3.1,\n      edge.arrow.mode = F\n  )\n  lab.locs &lt;- radian.rescale(x=1:length(label), direction=-1, start=0)\n  params$vertex.label.degree &lt;- lab.locs\n  params$vertex.label &lt;- label\n  params$vertex.color = V(net)$color\n  do.call(plot, params)\n  legend(x = -1.7, y = -1.4, unique(nodes_data[,\"type.label\"]), pch = 21,\n        col = \"#777777\", pt.bg = colrs, pt.cex = 2, cex = .8, bty = \"n\",\n        ncol = 1)\n  legend(x = -1.2, y = -1.37,\n    legend=round(sort(unique(E(net)$width)), 2), pt.cex= 0.8,\n      col='black', ncol = 3, bty = \"n\", lty = 1,\n      lwd = round(sort(unique(E(net)$width)), 2)\n  )\n  if (length(unique(V(net)$size)) &gt; 8) {\n    size_leg &lt;- sort(unique(V(net)$size))[seq(1, length(unique(V(net)$size)), 2)]\n  } else {\n    size_leg &lt;- sort(unique(V(net)$size))\n  }\n  legend(x = 0.5, y = -1.3,\n        size_leg,\n        pch = 21,\n        col = \"black\", pt.bg = \"#777777\",\n        pt.cex = size_leg / 3.8, cex = .8, bty = \"n\",\n        ncol = 3,\n        y.intersp = 3,\n        x.intersp = 2.5,\n        text.width = 0.25\n  )\n  par(mar=raw$mar)\n})\n\np\n\n\n\n\n\n\n\n图 1: 网路图 (igraph)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Network (igraph)"
    ]
  },
  {
    "objectID": "Hiplot/021-circle-packing.html",
    "href": "Hiplot/021-circle-packing.html",
    "title": "圆堆图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Circle Packing 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/circle-packing?lang=zh_cn\n用于展示不同类型之间的数量差异。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Circle Packing"
    ]
  },
  {
    "objectID": "Hiplot/021-circle-packing.html#环境配置",
    "href": "Hiplot/021-circle-packing.html#环境配置",
    "title": "圆堆图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; packcircles; ggplot2; viridis\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"packcircles\", quietly = TRUE)) {\n  install.packages(\"packcircles\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"viridis\", quietly = TRUE)) {\n  install.packages(\"viridis\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(packcircles)\nlibrary(ggplot2)\nlibrary(viridis)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package     * version date (UTC) lib source\n data.table  * 1.17.8  2025-07-10 [1] RSPM\n ggplot2     * 4.0.1   2025-11-14 [1] RSPM\n jsonlite    * 2.0.0   2025-03-27 [1] RSPM\n packcircles * 0.3.7   2024-11-21 [1] RSPM\n viridis     * 0.6.5   2024-01-29 [1] RSPM\n viridisLite * 0.4.2   2023-05-02 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Circle Packing"
    ]
  },
  {
    "objectID": "Hiplot/021-circle-packing.html#数据准备",
    "href": "Hiplot/021-circle-packing.html#数据准备",
    "title": "圆堆图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/circle-packing/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\npacking &lt;- circleProgressiveLayout(data[[\"v\"]], sizetype = \"area\")\ndata &lt;- cbind(data, packing)\ndat_gg &lt;- circleLayoutVertices(packing, npoints = 50)\ncolors &lt;- c(\"#E57164\",\"#F8ECA7\",\"#9389C1\",\"#3F9C78\",\"#769F8D\",\"#E5F9A9\",\"#7CE9A4\",\n            \"#CE9FCA\",\"#78F197\",\"#8BB085\",\"#D88880\",\"#A6E4C3\",\"#F7F6B1\",\"#C5E69A\",\n            \"#F45FDE\",\"#5CF371\",\"#9259CF\",\"#2B6D9B\",\"#F3C096\",\"#EEADBE\")\ndat_gg$value &lt;- rep(colors, each = 51)\n\n# 查看数据\nhead(data)\n\n  g   v           x          y   radius\n1 A 100  -5.6418958  0.0000000 5.641896\n2 B 120   6.1803872  0.0000000 6.180387\n3 C  80  -0.2298516 -9.2166458 5.046265\n4 D  10  -6.7961670 -7.3357638 1.784124\n5 E  60 -12.9322538 -6.8624061 4.370194\n6 F  30 -14.3618753  0.4597221 3.090194",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Circle Packing"
    ]
  },
  {
    "objectID": "Hiplot/021-circle-packing.html#可视化",
    "href": "Hiplot/021-circle-packing.html#可视化",
    "title": "圆堆图",
    "section": "可视化",
    "text": "可视化\n\n# 圆堆图\np &lt;- ggplot() +\n  geom_polygon(data = dat_gg, aes(x, y, group = id, fill = value), colour = \"black\", alpha = 0.4) +\n  scale_fill_manual(values = magma(nrow(data))) +\n  theme_void() +\n  theme(legend.position = \"none\") +\n  coord_equal() +\n  scale_size_continuous(range = c(2.3, 4.5)) +\n  geom_text(data = data, aes(x, y, size = v, label = g), vjust = 0) +\n  geom_text(data = data, aes(x, y, label = v, size = v), vjust = 1.2)\n\np\n\n\n\n\n\n\n\n图 1: 圆堆图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Circle Packing"
    ]
  },
  {
    "objectID": "Hiplot/090-interval-bar-chart.html",
    "href": "Hiplot/090-interval-bar-chart.html",
    "title": "区间条形图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Interval Bar Chart 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/interval-bar-chart?lang=zh_cn",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Interval Bar Chart"
    ]
  },
  {
    "objectID": "Hiplot/090-interval-bar-chart.html#环境配置",
    "href": "Hiplot/090-interval-bar-chart.html#环境配置",
    "title": "区间条形图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Interval Bar Chart"
    ]
  },
  {
    "objectID": "Hiplot/090-interval-bar-chart.html#数据准备",
    "href": "Hiplot/090-interval-bar-chart.html#数据准备",
    "title": "区间条形图",
    "section": "数据准备",
    "text": "数据准备\n案例数据为一年十二个月份的最高和最低温度和对应的月份简称。通过案例数据绘制了每个月份的温度区间及温度均线。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/interval-bar-chart/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndata$name_num &lt;- match(data[[\"month\"]], unique(data[[\"month\"]]))\n\n# 查看数据\nhead(data)\n\n  month min_temperature max_temperature mean name_num\n1   Jan              15              20   16        1\n2   Feb              17              25   20        2\n3   Mar              20              26   23        3\n4   Apr              25              30   27        4\n5   May              30              35   32        5\n6   Jun              32              35   34        6",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Interval Bar Chart"
    ]
  },
  {
    "objectID": "Hiplot/090-interval-bar-chart.html#可视化",
    "href": "Hiplot/090-interval-bar-chart.html#可视化",
    "title": "区间条形图",
    "section": "可视化",
    "text": "可视化\n\n# 区间条形图\np &lt;- ggplot(data, aes(x = month, y = max_temperature)) +\n  geom_rect(aes(xmin = name_num - 0.4, xmax = name_num + 0.4,\n                ymin = min_temperature, ymax = max_temperature), \n            fill = \"#282726\", alpha = 0.7) +\n  geom_line(aes(x = name_num, y = mean), color = \"#006064\", size = 0.8) +\n  labs(x = \"Month\", y = \"Temperature\") +\n  scale_x_discrete() +\n  theme_bw()\n\np\n\n\n\n\n\n\n\n图 1: 区间条形图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Interval Bar Chart"
    ]
  },
  {
    "objectID": "Hiplot/030-cor-heatmap.html",
    "href": "Hiplot/030-cor-heatmap.html",
    "title": "相关性热图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Correlation Heatmap 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/cor-heatmap?lang=zh_cn\n相关性热图是一种分析多个变量，两两之间相关性的图形。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Correlation Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/030-cor-heatmap.html#环境配置",
    "href": "Hiplot/030-cor-heatmap.html#环境配置",
    "title": "相关性热图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggcorrplot\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggcorrplot\", quietly = TRUE)) {\n  install.packages(\"ggcorrplot\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggcorrplot)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggcorrplot * 0.1.4.1 2023-09-05 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Correlation Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/030-cor-heatmap.html#数据准备",
    "href": "Hiplot/030-cor-heatmap.html#数据准备",
    "title": "相关性热图",
    "section": "数据准备",
    "text": "数据准备\n载入数据为基因名称及每个样本的表达量。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/cor-heatmap/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndata &lt;- data[!is.na(data[, 1]), ]\nidx &lt;- duplicated(data[, 1])\ndata[idx, 1] &lt;- paste0(data[idx, 1], \"--dup-\", cumsum(idx)[idx])\nrownames(data) &lt;- data[, 1]\ndata &lt;- data[, -1]\nstr2num_df &lt;- function(x) {\n  final &lt;- NULL\n  for (i in seq_len(ncol(x))) {\n    final &lt;- cbind(final, as.numeric(x[, i]))\n  }\n  colnames(final) &lt;- colnames(x)\n  return(final)\n}\ntmp &lt;- str2num_df(t(data))\ncorr &lt;- round(cor(tmp, use = \"na.or.complete\", method = \"pearson\"), 3)\np_mat &lt;- round(cor_pmat(tmp, method = \"pearson\"), 3)\n\n# 查看数据\nhead(data)\n\n             M1       M2       M3       M4       M5       M6        M7       M8\nRGL4   8.454808 8.019389 8.990836 9.718631 7.908075 4.147051  4.985084 4.576711\nMPP7   8.690520 8.630346 7.080873 9.838476 8.271824 5.179200  5.200868 3.266993\nUGCG   8.648366 8.600555 9.431046 7.923021 8.309214 4.902510  5.750804 4.492856\nCYSTM1 8.628884 9.238677 8.487243 8.958537 7.357109 4.541605  6.370533 4.246651\nANXA2  4.983769 6.748022 6.220791 4.719403 3.284346 8.089850 10.637472 7.214912\nENDOD1 5.551640 5.406465 4.663785 3.550765 4.103507 8.393991  9.538503 9.069923\n             M9      M10\nRGL4   4.930349 4.293700\nMPP7   5.565226 4.300309\nUGCG   4.659987 3.306275\nCYSTM1 4.745769 3.449627\nANXA2  9.002710 5.123359\nENDOD1 8.639664 7.106392",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Correlation Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/030-cor-heatmap.html#可视化",
    "href": "Hiplot/030-cor-heatmap.html#可视化",
    "title": "相关性热图",
    "section": "可视化",
    "text": "可视化\n\n# 相关性热图\np &lt;- ggcorrplot(\n  corr,\n  colors = c(\"#4477AA\", \"#FFFFFF\", \"#BB4444\"),\n  method = \"circle\",\n  hc.order = T,\n  hc.method = \"ward.D2\",\n  outline.col = \"white\",\n  ggtheme = theme_bw(),\n  type = \"upper\",\n  lab = F,\n  lab_size = 3,\n  legend.title = \"Correlation\"\n  ) +\n  ggtitle(\"Cor Heatmap Plot\") +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\np\n\n\n\n\n\n\n\n图 1: 相关性热图\n\n\n\n\n\n红色系表示两个基因之间呈正相关，蓝色系表示两个基因之间呈负相关，每一格中的数字表示相关系数。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Correlation Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/166-stack-violin.html",
    "href": "Hiplot/166-stack-violin.html",
    "title": "堆叠小提琴图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Stack Violin 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/stack-violin?lang=zh_cn\n单细胞转录组（single cell RNA-Seq）分析中每个簇关键基因的表达。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Simple Funnel Diagram"
    ]
  },
  {
    "objectID": "Hiplot/166-stack-violin.html#环境配置",
    "href": "Hiplot/166-stack-violin.html#环境配置",
    "title": "堆叠小提琴图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: readr; limma; Seurat; ggplot2\n\n\n# 安装包\nif (!requireNamespace(\"readr\", quietly = TRUE)) {\n  install.packages(\"readr\")\n}\nif (!requireNamespace(\"limma\", quietly = TRUE)) {\n  install.packages(\"limma\")\n}\nif (!requireNamespace(\"limma\", quietly = TRUE)) {\n  install.packages(\"limma\")\n}\nif (!requireNamespace(\"Seurat\", quietly = TRUE)) {\n  install.packages(\"Seurat\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# 加载包\nlibrary(readr)\nlibrary(limma)\nlibrary(Seurat)\nlibrary(ggplot2)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package      * version date (UTC) lib source\n ggplot2      * 4.0.1   2025-11-14 [1] RSPM\n limma        * 3.66.0  2025-10-29 [1] Bioconduc~\n readr        * 2.1.6   2025-11-14 [1] RSPM\n Seurat       * 5.4.0   2025-12-14 [1] RSPM\n SeuratObject * 5.3.0   2025-12-12 [1] RSPM\n sp           * 2.2-0   2025-02-01 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Simple Funnel Diagram"
    ]
  },
  {
    "objectID": "Hiplot/166-stack-violin.html#数据准备",
    "href": "Hiplot/166-stack-violin.html#数据准备",
    "title": "堆叠小提琴图",
    "section": "数据准备",
    "text": "数据准备\n基因表达矩阵。单细胞转录组分析中所有细胞和组的基因表达矩阵（单细胞RNA序列）。\n\n# 加载数据\ndata &lt;- readr::read_delim(\"https://download.hiplot.cn/api/file/fetch/?path=/c622f9b0-54da-11f0-ba5f-8dc116702904/public/demo/stack-violin.txt\")\n\n# 整理数据格式\ndata &lt;- as.matrix(data)\nrownames(data) &lt;- data[, 1]\nexp &lt;- data[, 2:ncol(data)]\ndimnames &lt;- list(\n  rownames(exp),\n  colnames(exp)\n)\ndata &lt;- matrix(as.numeric(as.matrix(exp)),\n  nrow = nrow(exp),\n  dimnames = dimnames\n)\ndata &lt;- avereps(data,\n  ID = rownames(data)\n)\n## 将矩阵转换为Seurat对象，并对数据进行过滤\npbmc &lt;- CreateSeuratObject(\n  counts = data,\n  project = \"seurat\",\n  min.cells = 0,\n  min.features = 0,\n  names.delim = \"_\",\n)\n## 使用PercentageFeatureSet函数计算线粒体基因的百分比\npbmc[[\"percent.mt\"]] &lt;- PercentageFeatureSet(\n  object = pbmc,\n  pattern = \"^MT-\"\n)\n## 对数据进行过滤\npbmc &lt;- subset(\n  x = pbmc,\n  subset = nFeature_RNA &gt; 50 & percent.mt &lt; 5\n)\n## 对数据进行标准化\npbmc &lt;- NormalizeData(\n  object = pbmc,\n  normalization.method = \"LogNormalize\",\n  scale.factor = 10000, verbose = F\n)\n## 提取那些在细胞间变异系数较大的基因\npbmc &lt;- FindVariableFeatures(\n  object = pbmc,\n  selection.method = \"vst\",\n  nfeatures = 1500, verbose = F\n)\n## PCA降维之前的标准预处理步骤\npbmc &lt;- ScaleData(pbmc)\npbmc &lt;- RunPCA(\n  object = pbmc,\n  npcs = 20,\n  pc.genes = VariableFeatures(object = pbmc)\n)\n## 每个PC的p值分布和均匀分布\npbmc &lt;- JackStraw(\n  object = pbmc,\n  num.replicate = 100\n)\npbmc &lt;- ScoreJackStraw(\n  object = pbmc,\n  dims = 1:20\n)\n## 计算邻接距离\npbmc &lt;- FindNeighbors(\n  object = pbmc,\n  dims = 1:20\n)\n## 对细胞分组,优化标准模块化\npbmc &lt;- FindClusters(\n  object = pbmc,\n  resolution = 0.5\n)\n\nModularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck\n\nNumber of nodes: 653\nNumber of edges: 19073\n\nRunning Louvain algorithm...\nMaximum modularity in 10 random starts: 0.8659\nNumber of communities: 8\nElapsed time: 0 seconds\n\n## TSNE聚类\npbmc &lt;- RunTSNE(\n  object = pbmc,\n  dims = 1:20\n)\n## 寻找差异表达的特征\nlog_fc_filter &lt;- 0.5\nadj_pval_filter &lt;- 0.05\npbmc_markers &lt;- FindAllMarkers(\n  object = pbmc,\n  only.pos = FALSE,\n  min.pct = 0.25,\n  logfc.threshold = log_fc_filter\n)\npbmc_sig_markers &lt;- pbmc_markers[(abs(as.numeric(\n  as.vector(pbmc_markers$avg_logFC)\n)) &gt; log_fc_filter &\n  as.numeric(as.vector(pbmc_markers$p_val_adj)) &lt;\n    adj_pval_filter), ]\n\n# 查看数据\nhead(data[,1:5])\n\n         PT089_P1_A01 PT089_P1_A02 PT089_P1_A03 PT089_P1_A04 PT089_P1_A05\nA1BG             0.00            0            0            0            0\nA1BG-AS1         0.00            0            0            0            0\nA1CF             0.00            0            0            1            0\nA2M              0.00            0            0          339            0\nA2M-AS1          0.00            0            0            0            0\nA2ML1            1.08            0            0            0            0",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Simple Funnel Diagram"
    ]
  },
  {
    "objectID": "Hiplot/166-stack-violin.html#可视化",
    "href": "Hiplot/166-stack-violin.html#可视化",
    "title": "堆叠小提琴图",
    "section": "可视化",
    "text": "可视化\n\n# 堆叠小提琴图\n## 定义绘图函数\nmodify_vlnplot &lt;- function(obj,\n                           feature,\n                           pt.size = 0,\n                           plot.margin = unit(c(-0.75, 0, -0.75, 0), \"cm\"),\n                           ...) {\n  p &lt;- VlnPlot(obj,\n    features = feature,\n    pt.size = pt.size,\n    ...\n  )\n\n  p &lt;- p +\n    xlab(\"\") +\n    ylab(feature) +\n    theme(\n      axis.text.x = element_blank(),\n      axis.text.y = element_blank(),\n      axis.ticks.x = element_blank(),\n      axis.ticks.y = element_line(),\n      axis.title.y = element_text(angle = 0, vjust = 0.5),\n      plot.margin = plot.margin,\n      text = element_text(\n        family = \"Arial\"\n      ),\n      plot.title = element_blank(),\n      axis.title = element_text(\n        size = 10\n      ),\n      legend.position = \"none\",\n      legend.direction = \"vertical\",\n      legend.title = element_text(\n        size = 10\n      ),\n      legend.text = element_text(\n        size = 10\n      )\n    ) +\n    scale_fill_manual(values = c(\"#00468BFF\",\"#ED0000FF\",\"#42B540FF\",\"#0099B4FF\",\n                                 \"#925E9FFF\",\"#FDAF91FF\",\"#AD002AFF\",\"#ADB6B6FF\"))\n  return(p)\n}\n\n## main function\nstacked_vln_plot &lt;- function(obj,\n                           features,\n                           pt.size = 0,\n                           plot.margin = unit(c(-0.75, 0, -0.75, 0), \"cm\"),\n                           ...) {\n  plot_list &lt;- purrr::map(\n    features,\n    function(x) {\n      modify_vlnplot(\n        obj = obj,\n        feature = x,\n        ...\n      )\n    }\n  )\n  plot_list[[length(plot_list)]] &lt;- plot_list[[length(plot_list)]] +\n    theme(\n      axis.text.x = element_text(),\n      axis.ticks.x = element_line()\n    )\n  p &lt;- patchwork::wrap_plots(\n    plotlist = plot_list,\n    ncol = 1\n  )\n  return(p)\n}\n\n## 绘图\np &lt;- stacked_vln_plot(pbmc, c(\"ACTG1\",\"ARF1\",\"ALDOA\",\"ARHGDIA\",\"ACTB\"), pt.size = 0)\n\np\n\n\n\n\n\n\n\n图 1: 堆叠小提琴图",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Simple Funnel Diagram"
    ]
  },
  {
    "objectID": "Hiplot/044-diy-gsea.html",
    "href": "Hiplot/044-diy-gsea.html",
    "title": "自定义基因富集分析",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot DIY GSEA 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/diy-gsea?lang=zh_cn\n自定义基因集。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "DIY GSEA"
    ]
  },
  {
    "objectID": "Hiplot/044-diy-gsea.html#环境配置",
    "href": "Hiplot/044-diy-gsea.html#环境配置",
    "title": "自定义基因富集分析",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; clusterProfiler\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"clusterProfiler\", quietly = TRUE)) {\n  BiocManager::install(\"clusterProfiler\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(clusterProfiler)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package         * version date (UTC) lib source\n clusterProfiler * 4.18.4  2025-12-15 [1] Bioconduc~\n data.table      * 1.17.8  2025-07-10 [1] RSPM\n jsonlite        * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "DIY GSEA"
    ]
  },
  {
    "objectID": "Hiplot/044-diy-gsea.html#数据准备",
    "href": "Hiplot/044-diy-gsea.html#数据准备",
    "title": "自定义基因富集分析",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata1 &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/diy-gsea/data.json\")$exampleData$textarea[[1]])\ndata1 &lt;- as.data.frame(data1)\ndata2 &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/diy-gsea/data.json\")$exampleData$textarea[[2]])\ndata2 &lt;- as.data.frame(data2)\n\n# 整理数据格式\ndata1[,2] &lt;- as.numeric(data1[,2])\ngeneList &lt;- data1[,2]\nnames(geneList) &lt;- data1[,1]\ngeneList &lt;- sort(geneList, decreasing = TRUE)\nterm &lt;- data.frame(term=data2[,1], gene=data2[,2])\n\n# 查看数据\nhead(term)\n\n                         term   gene\n1 GO_ADAPTIVE_IMMUNE_RESPONSE ADAM17\n2 GO_ADAPTIVE_IMMUNE_RESPONSE  AICDA\n3 GO_ADAPTIVE_IMMUNE_RESPONSE  ALCAM\n4 GO_ADAPTIVE_IMMUNE_RESPONSE  ANXA1\n5 GO_ADAPTIVE_IMMUNE_RESPONSE   BATF\n6 GO_ADAPTIVE_IMMUNE_RESPONSE  BCL10",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "DIY GSEA"
    ]
  },
  {
    "objectID": "Hiplot/044-diy-gsea.html#可视化",
    "href": "Hiplot/044-diy-gsea.html#可视化",
    "title": "自定义基因富集分析",
    "section": "可视化",
    "text": "可视化\n\n# 自定义基因富集分析\ny &lt;- clusterProfiler::GSEA(geneList, TERM2GENE = term, pvalueCutoff = 1)\np &lt;- gseaplot(\n  y,\n  y@result$Description[1],\n  color = \"#000000\",\n  by = \"runningScore\",\n  color.line = \"#4CAF50\",\n  color.vline= \"#FA5860\",\n  title = \"DIY GSEA Plot\",\n  )\n\np\n\n\n\n\n\n\n\n图 1: 自定义基因富集分析",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "DIY GSEA"
    ]
  },
  {
    "objectID": "Hiplot/089-interval-area-chart.html",
    "href": "Hiplot/089-interval-area-chart.html",
    "title": "区间区域图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Interval Area Chart 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/interval-area-chart?lang=zh_cn",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Interval Area Chart"
    ]
  },
  {
    "objectID": "Hiplot/089-interval-area-chart.html#环境配置",
    "href": "Hiplot/089-interval-area-chart.html#环境配置",
    "title": "区间区域图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Interval Area Chart"
    ]
  },
  {
    "objectID": "Hiplot/089-interval-area-chart.html#数据准备",
    "href": "Hiplot/089-interval-area-chart.html#数据准备",
    "title": "区间区域图",
    "section": "数据准备",
    "text": "数据准备\n案例数据为一年十二个月份的最高和最低温度和对应的月份简称。通过案例数据绘制了每个月份的温度区间及温度均线。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/interval-area-chart/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndata[[\"month\"]] &lt;- factor(data[[\"month\"]], levels = data[[\"month\"]])\n\n# 查看数据\nhead(data)\n\n  month min_temperature max_temperature mean\n1   Jan              15              20   16\n2   Feb              17              25   20\n3   Mar              20              26   23\n4   Apr              25              30   27\n5   May              30              35   32\n6   Jun              32              35   34",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Interval Area Chart"
    ]
  },
  {
    "objectID": "Hiplot/089-interval-area-chart.html#可视化",
    "href": "Hiplot/089-interval-area-chart.html#可视化",
    "title": "区间区域图",
    "section": "可视化",
    "text": "可视化\n\n# 区间区域图\np &lt;- ggplot(data, aes(x = month, group = 1)) +\n  geom_line(aes(y = max_temperature), size = 1.2, color = \"#EA3323\", \n            linetype = \"solid\") +\n  geom_line(aes(y = min_temperature), size = 1.2, color = \"#0000F5\", \n            linetype = \"solid\") +\n  geom_line(aes(x = month, y = mean), size = 1.2, color = \"#BEBEBE\", \n            linetype = \"dashed\") +\n  geom_ribbon(aes(ymin = min_temperature, ymax = max_temperature), \n              fill = \"#F2F2F2\", alpha = 0.5) +\n  geom_text(aes(x = month, y = max_temperature + 1, label = max_temperature),\n            color = \"#EA3323\", size = 2.5, vjust = -0.5, hjust = 0) +\n  geom_text(aes(x = month, y = min_temperature - 1, label = min_temperature),\n            color = \"#0000F5\", size = 2.5, vjust = 1.5, hjust = 0) +\n  geom_text(aes(x = month, y = mean, label = mean),\n            color = \"#BEBEBE\", size = 2.5, vjust = 1.5, hjust = 0) +\n  labs(title = \"Temperature\", x = \"Month\", y = \"Temperature\") +\n  scale_color_manual(values = c(max = \"#EA3323\", min = \"#0000F5\")) +\n  theme_bw() +\n  theme(plot.title = element_text(hjust = 0.5))\n\np\n\n\n\n\n\n\n\n图 1: 区间区域图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Interval Area Chart"
    ]
  },
  {
    "objectID": "Hiplot/108-map-north-america.html",
    "href": "Hiplot/108-map-north-america.html",
    "title": "北美洲地图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot North America Map 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/map-north-america?lang=zh_cn",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "North America Map"
    ]
  },
  {
    "objectID": "Hiplot/108-map-north-america.html#环境配置",
    "href": "Hiplot/108-map-north-america.html#环境配置",
    "title": "北美洲地图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2; RColorBrewer\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(RColorBrewer)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package      * version date (UTC) lib source\n data.table   * 1.17.8  2025-07-10 [1] RSPM\n ggplot2      * 4.0.1   2025-11-14 [1] RSPM\n jsonlite     * 2.0.0   2025-03-27 [1] RSPM\n RColorBrewer * 1.1-3   2022-04-03 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "North America Map"
    ]
  },
  {
    "objectID": "Hiplot/108-map-north-america.html#数据准备",
    "href": "Hiplot/108-map-north-america.html#数据准备",
    "title": "北美洲地图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/map-north-america/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\ndt_map &lt;- readRDS(url(\"https://download.hiplot.cn/ui/basic/map-north-america/na.rds\"))\n\n# 整理数据格式\ndt_map$Value &lt;- data$value[match(dt_map$ENG_NAME, data$region)]\n\n# 查看数据\nhead(data)\n\n             region value\n1 ANTIGUA & BARBUDA   918\n2     Anguilla (UK)    95\n3          BARBADOS   878\n4            BELIZE   874\n5      Bermuda (UK)   159\n6            CANADA   118",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "North America Map"
    ]
  },
  {
    "objectID": "Hiplot/108-map-north-america.html#可视化",
    "href": "Hiplot/108-map-north-america.html#可视化",
    "title": "北美洲地图",
    "section": "可视化",
    "text": "可视化\n\n# 北美洲地图\np &lt;- ggplot(dt_map) +\n  geom_polygon(aes(x = long, y = lat, group = group, fill = Value),\n               alpha = 0.9, size = 0.5) +\n  geom_path(aes(x = long, y = lat, group = group), color = \"black\", size = 0.2) +\n  coord_fixed() +\n  scale_fill_gradientn(\n    colours = colorRampPalette(rev(brewer.pal(11,\"RdYlBu\")))(500),\n    breaks = seq(min(data$value), max(data$value), \n                 round((max(data$value)-min(data$value))/7)),\n    name = \"Color Key\",\n    guide = guide_legend(\n      direction = \"vertical\", keyheight = unit(1, units = \"mm\"),\n      keywidth = unit(8, units = \"mm\"),\n      title.position = \"top\", title.hjust = 0.5, label.hjust = 0.5,\n      nrow = 1, byrow = T, reverse = F, label.position = \"bottom\")) +\n  theme(text = element_text(color = \"#3A3F4A\"),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank(),\n        legend.position = \"top\",\n        legend.text = element_text(size = 4 * 1.5, color = \"black\"),\n        legend.title = element_text(size = 5 * 1.5, color = \"black\"),\n        plot.title = element_text(\n          face = \"bold\", size = 5 * 1.5, hjust = 0.5, \n          margin = margin(t = 4, b = 5), color = \"black\"),\n        plot.background = element_rect(fill = \"#FFFFFF\", color = \"#FFFFFF\"),\n        panel.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        legend.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        plot.margin = unit(c(1.5, 1.5, 1.5, 1.5), \"cm\")) +\n  labs(x = NULL, y = NULL, title = \"North America Map\")\n\np\n\n\n\n\n\n\n\n图 1: 北美洲地图",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "North America Map"
    ]
  },
  {
    "objectID": "Hiplot/137-perspective.html",
    "href": "Hiplot/137-perspective.html",
    "title": "透视图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Perspective 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/perspective?lang=zh_cn\n三维透视图是一种能将一个矩阵中包含的高等数值用曲面连接起来的三维立体图形。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Perspective"
    ]
  },
  {
    "objectID": "Hiplot/137-perspective.html#环境配置",
    "href": "Hiplot/137-perspective.html#环境配置",
    "title": "透视图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; shape; ggplotify\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"shape\", quietly = TRUE)) {\n  install.packages(\"shape\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(shape)\nlibrary(ggplotify)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplotify  * 0.1.3   2025-09-20 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n shape      * 1.4.6.1 2024-02-23 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Perspective"
    ]
  },
  {
    "objectID": "Hiplot/137-perspective.html#数据准备",
    "href": "Hiplot/137-perspective.html#数据准备",
    "title": "透视图",
    "section": "数据准备",
    "text": "数据准备\n载入数据为一个矩阵。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/perspective/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndata &lt;- as.matrix(data)\ncol &lt;- drapecol(data)\n\n# 查看数据\nhead(data[,1:5])\n\n      V1  V2  V3  V4  V5\n[1,] 100 101 102 103 104\n[2,] 100 101 102 103 104\n[3,] 101 102 103 104 105\n[4,] 101 102 103 104 105\n[5,] 101 102 103 104 105\n[6,] 101 102 103 104 105",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Perspective"
    ]
  },
  {
    "objectID": "Hiplot/137-perspective.html#可视化",
    "href": "Hiplot/137-perspective.html#可视化",
    "title": "透视图",
    "section": "可视化",
    "text": "可视化\n\n# 透视图\np &lt;- as.ggplot(function() {\n  persp(as.matrix(data),\n    theta = 45, phi = 20,\n    expand = 0.5,\n    r = 180, col = col,\n    ltheta = 120,\n    shade = 0.5,\n    ticktype = \"detailed\",\n    xlab = \"X\", ylab = \"Y\", zlab = \"Z\",\n    border = \"black\" # could be NA\n  )\n  title(\"Perspective Plot\", line = 0)\n})\n\np\n\n\n\n\n\n\n\n图 1: 透视图\n\n\n\n\n\n清晰观测一个山峰的全貌。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Perspective"
    ]
  },
  {
    "objectID": "Hiplot/082-group-comparison.html",
    "href": "Hiplot/082-group-comparison.html",
    "title": "分组比较热图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Group-comparison Heatmap 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/group-comparison?lang=zh_cn\n分组比较热图提供了一种进行多组比较并使用热图可视化的紧凑方式，以替换绘制许多个箱线图。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Group-comparison Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/082-group-comparison.html#环境配置",
    "href": "Hiplot/082-group-comparison.html#环境配置",
    "title": "分组比较热图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; sigminer\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"sigminer\", quietly = TRUE)) {\n  remotes::install_github(\"ShixiangWang/sigminer\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(sigminer)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package      * version date (UTC) lib source\n Biobase      * 2.70.0  2025-10-29 [1] Bioconduc~\n BiocGenerics * 0.56.0  2025-10-29 [1] Bioconduc~\n data.table   * 1.17.8  2025-07-10 [1] RSPM\n generics     * 0.1.4   2025-05-09 [1] RSPM\n jsonlite     * 2.0.0   2025-03-27 [1] RSPM\n sigminer     * 2.3.1   2024-05-11 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Group-comparison Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/082-group-comparison.html#数据准备",
    "href": "Hiplot/082-group-comparison.html#数据准备",
    "title": "分组比较热图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/group-comparison/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 查看数据\nhead(data)\n\n  g1 g2 e1         e2\n1  A AA  N -1.8060313\n2  A AA  N -0.5820759\n3  A AA  N -1.1088896\n4  A AA  N -1.0149620\n5  A AA  P -0.1623095\n6  A AA  N  0.5630558",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Group-comparison Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/082-group-comparison.html#可视化",
    "href": "Hiplot/082-group-comparison.html#可视化",
    "title": "分组比较热图",
    "section": "可视化",
    "text": "可视化\n\n# 定义绘图函数\nunlist_and_covert &lt;- function(x, recursive = FALSE) {\n  if (!is.null(x)) {\n    x &lt;- unlist(x, recursive = recursive)\n    if (!is.null(x)) {\n      y &lt;- sapply(x, function(x) {\n        if (identical(x, \"NA\")) NA else x\n      })\n      names(y) &lt;- names(x)\n      x &lt;- y\n    }\n  }\n  x\n}\n\nplotentry &lt;- function(data,\n                      grp_vars = NULL, enrich_vars = NULL, cross = TRUE,\n                      co_method = c(\"t.test\", \"wilcox.test\"), ref_group = NA,\n                      scales = \"free\", add_text_annotation = TRUE,\n                      fill_by_p_value = TRUE, use_fdr = TRUE, cut_p_value = FALSE,\n                      cluster_row = FALSE) {\n  ref_group &lt;- unlist_and_covert(ref_group)\n  if (is.null(ref_group)) ref_group &lt;- NA\n  rv &lt;- group_enrichment(data, grp_vars, enrich_vars, cross, co_method, ref_group)\n  if (length(unique(rv$grp_var)) == 1) {\n    p &lt;- show_group_enrichment(rv,\n      return_list = TRUE,\n      scales = scales, add_text_annotation = add_text_annotation,\n      fill_by_p_value = fill_by_p_value, use_fdr = use_fdr, cut_p_value = cut_p_value,\n      cluster_row = cluster_row\n    )\n    p &lt;- p[[1]]\n  } else {\n    p &lt;- show_group_enrichment(rv,\n      scales = scales, add_text_annotation = add_text_annotation,\n      fill_by_p_value = fill_by_p_value, use_fdr = use_fdr, cut_p_value = cut_p_value,\n      cluster_row = cluster_row\n    )\n  }\n  return(p)\n}\n\n# 绘制图形\np &lt;- plotentry(\n  data = data,\n  grp_vars = \"g1\",\n  enrich_vars = c(\"e1\", \"e2\"),\n  cross = T,\n  add_text_annotation = T,\n  fill_by_p_value = T,\n  use_fdr = T,\n  cut_p_value = F,\n  cluster_row = F,\n  co_method = \"t.test\",\n  scales = \"free\"\n)\n\np\n\n\n\n\n\n\n\n图 1: 分组比较热图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Group-comparison Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/076-ggwordcloud.html",
    "href": "Hiplot/076-ggwordcloud.html",
    "title": "ggplot2 词云",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot ggwordcloud 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/ggwordcloud?lang=zh_cn\n词云是通过形成“关键字云层”或“关键字渲染”来可视化Web文本中经常出现的“关键字”。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "ggwordcloud"
    ]
  },
  {
    "objectID": "Hiplot/076-ggwordcloud.html#环境配置",
    "href": "Hiplot/076-ggwordcloud.html#环境配置",
    "title": "ggplot2 词云",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggwordcloud\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggwordcloud\", quietly = TRUE)) {\n  install.packages(\"ggwordcloud\")\n}\nif (!requireNamespace(\"curl\", quietly = TRUE)) {\n  install.packages(\"curl\")\n}\nif (!requireNamespace(\"png\", quietly = TRUE)) {\n  install.packages(\"png\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggwordcloud)\nlibrary(curl)\nlibrary(png)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package     * version date (UTC) lib source\n curl        * 7.0.0   2025-08-19 [1] RSPM\n data.table  * 1.17.8  2025-07-10 [1] RSPM\n ggplot2     * 4.0.1   2025-11-14 [1] RSPM\n ggwordcloud * 0.6.2   2024-05-30 [1] RSPM\n jsonlite    * 2.0.0   2025-03-27 [1] RSPM\n png         * 0.1-8   2022-11-29 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "ggwordcloud"
    ]
  },
  {
    "objectID": "Hiplot/076-ggwordcloud.html#数据准备",
    "href": "Hiplot/076-ggwordcloud.html#数据准备",
    "title": "ggplot2 词云",
    "section": "数据准备",
    "text": "数据准备\n加载数据名词和名词频率。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/ggwordcloud/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\ninmask &lt;- \"https://download.hiplot.cn/api/file/fetch/?path=public/demo/ggwordcloud/hearth.png\"\n\n# 整理数据格式\ncol &lt;- data[, 2]\ndata &lt;- cbind(data, col)\n\n# 查看数据\nhead(data)\n\n    word freq col\n1    oil   85  85\n2   said   73  73\n3 prices   48  48\n4   opec   42  42\n5    mln   31  31\n6    the   26  26",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "ggwordcloud"
    ]
  },
  {
    "objectID": "Hiplot/076-ggwordcloud.html#可视化",
    "href": "Hiplot/076-ggwordcloud.html#可视化",
    "title": "ggplot2 词云",
    "section": "可视化",
    "text": "可视化\n\n# ggplot2 词云\np &lt;- ggplot(data, aes(label = word, size = freq, color = col)) +\n  scale_size_area(max_size = 40) +\n  theme_minimal() + \n  geom_text_wordcloud_area(\n    mask = png::readPNG(curl::curl_fetch_memory(inmask)$content), \n    rm_outside = TRUE) +\n  scale_color_gradient(low = \"#8B0000\", high = \"#FF0000\")\n\np\n\n\n\n\n\n\n\n图 1: ggplot2 词云\n\n\n\n\n\n根据名词的频率在词云图中显示名词的比例。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "ggwordcloud"
    ]
  },
  {
    "objectID": "Hiplot/104-map-france.html",
    "href": "Hiplot/104-map-france.html",
    "title": "法国地图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot France Map 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/map-france?lang=zh_cn",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "France Map"
    ]
  },
  {
    "objectID": "Hiplot/104-map-france.html#环境配置",
    "href": "Hiplot/104-map-france.html#环境配置",
    "title": "法国地图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2; RColorBrewer\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(RColorBrewer)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package      * version date (UTC) lib source\n data.table   * 1.17.8  2025-07-10 [1] RSPM\n ggplot2      * 4.0.1   2025-11-14 [1] RSPM\n jsonlite     * 2.0.0   2025-03-27 [1] RSPM\n RColorBrewer * 1.1-3   2022-04-03 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "France Map"
    ]
  },
  {
    "objectID": "Hiplot/104-map-france.html#数据准备",
    "href": "Hiplot/104-map-france.html#数据准备",
    "title": "法国地图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/map-france/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\ndt_map &lt;- readRDS(url(\"https://download.hiplot.cn/ui/basic/map-france/france.rds\"))\n\n# 整理数据格式\ndt_map$Value &lt;- data$value[match(dt_map$ENG_NAME, data$name)]\n\n# 查看数据\nhead(data)\n\n            name value\n1       Bas-Rhin   338\n2      Haut-Rhin   353\n3       Dordogne   168\n4        Gironde   158\n5         Landes   221\n6 Lot-et-Garonne   658",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "France Map"
    ]
  },
  {
    "objectID": "Hiplot/104-map-france.html#可视化",
    "href": "Hiplot/104-map-france.html#可视化",
    "title": "法国地图",
    "section": "可视化",
    "text": "可视化\n\n# 法国地图\np &lt;- ggplot(dt_map) +\n  geom_polygon(aes(x = long, y = lat, group = group, fill = Value),\n               alpha = 0.9, size = 0.5) +\n  geom_path(aes(x = long, y = lat, group = group), color = \"black\", size = 0.2) +\n  coord_fixed() +\n  scale_fill_gradientn(\n    colours = colorRampPalette(rev(brewer.pal(11,\"RdYlBu\")))(500),\n    breaks = seq(min(data$value), max(data$value), \n                 round((max(data$value)-min(data$value))/7)),\n    name = \"Color Key\",\n    guide = guide_legend(\n      direction = \"vertical\", keyheight = unit(1, units = \"mm\"),\n      keywidth = unit(8, units = \"mm\"),\n      title.position = \"top\", title.hjust = 0.5, label.hjust = 0.5,\n      nrow = 1, byrow = T, reverse = F, label.position = \"bottom\")) +\n  theme(text = element_text(color = \"#3A3F4A\"),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank(),\n        legend.position = \"top\",\n        legend.text = element_text(size = 4 * 1.5, color = \"black\"),\n        legend.title = element_text(size = 5 * 1.5, color = \"black\"),\n        plot.title = element_text(\n          face = \"bold\", size = 5 * 1.5, hjust = 0.5, \n          margin = margin(t = 4, b = 5), color = \"black\"),\n        plot.background = element_rect(fill = \"#FFFFFF\", color = \"#FFFFFF\"),\n        panel.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        legend.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        plot.margin = unit(c(1.5, 1.5, 1.5, 1.5), \"cm\")) +\n  labs(x = NULL, y = NULL, title = \"France Map\")\n\np\n\n\n\n\n\n\n\n图 1: 法国地图",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "France Map"
    ]
  },
  {
    "objectID": "Hiplot/048-dumbbell.html",
    "href": "Hiplot/048-dumbbell.html",
    "title": "哑铃图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Dumbbell Chart 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/dumbbell?lang=zh_cn\n哑铃图用于展示数据变化。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Dumbbell Chart"
    ]
  },
  {
    "objectID": "Hiplot/048-dumbbell.html#环境配置",
    "href": "Hiplot/048-dumbbell.html#环境配置",
    "title": "哑铃图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2; ggalt\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"ggalt\", quietly = TRUE)) {\n  remotes::install_github(\"hrbrmstr/ggalt\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(ggalt)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggalt      * 0.6.1   2025-11-02 [1] Github (hrbrmstr/ggalt@8941f8c)\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Dumbbell Chart"
    ]
  },
  {
    "objectID": "Hiplot/048-dumbbell.html#数据准备",
    "href": "Hiplot/048-dumbbell.html#数据准备",
    "title": "哑铃图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/dumbbell/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 查看数据\nhead(data)\n\n    country  y1952  y2007\n1 Argentina 62.485 75.320\n2   Bolivia 40.414 65.554\n3    Brazil 50.917 72.390\n4    Canada 68.750 80.653\n5     Chile 54.745 78.553\n6  Colombia 50.643 72.889",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Dumbbell Chart"
    ]
  },
  {
    "objectID": "Hiplot/048-dumbbell.html#可视化",
    "href": "Hiplot/048-dumbbell.html#可视化",
    "title": "哑铃图",
    "section": "可视化",
    "text": "可视化\n\n# 哑铃图\ncolors &lt;- c(\"#3B4992FF\",\"#EE0000FF\")\np &lt;- ggplot(data, aes(y = reorder(country, y1952), x = y1952, xend = y2007)) +\n  geom_dumbbell(size = 1, size_x = 3,  size_xend = 3, colour = \"#AFAFAF\",  \n                colour_x = colors[1],  colour_xend = colors[2]) +\n  labs(title = \"Dummbbell Chart\", x = \"Life Expectancy (years)\",\n       y = \"country\") +\n  theme_minimal() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 1: 哑铃图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Dumbbell Chart"
    ]
  },
  {
    "objectID": "Hiplot/052-extended-scatter.html",
    "href": "Hiplot/052-extended-scatter.html",
    "title": "扩展散点图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Extended Scatter 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/extended-scatter?lang=zh_cn\n在散点图的基础上拓展边缘图像。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Extended Scatter"
    ]
  },
  {
    "objectID": "Hiplot/052-extended-scatter.html#环境配置",
    "href": "Hiplot/052-extended-scatter.html#环境配置",
    "title": "扩展散点图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2; ggExtra\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"ggExtra\", quietly = TRUE)) {\n  install.packages(\"ggExtra\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(ggExtra)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggExtra    * 0.11.0  2025-09-01 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Extended Scatter"
    ]
  },
  {
    "objectID": "Hiplot/052-extended-scatter.html#数据准备",
    "href": "Hiplot/052-extended-scatter.html#数据准备",
    "title": "扩展散点图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/extended-scatter/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 查看数据\nhead(data)\n\n   mpg cyl disp  hp drat    wt  qsec vs am gear carb\n1 21.0   6  160 110 3.90 2.620 16.46  0  1    4    4\n2 21.0   6  160 110 3.90 2.875 17.02  0  1    4    4\n3 22.8   4  108  93 3.85 2.320 18.61  1  1    4    1\n4 21.4   6  258 110 3.08 3.215 19.44  1  0    3    1\n5 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2\n6 18.1   6  225 105 2.76 3.460 20.22  1  0    3    1",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Extended Scatter"
    ]
  },
  {
    "objectID": "Hiplot/052-extended-scatter.html#可视化",
    "href": "Hiplot/052-extended-scatter.html#可视化",
    "title": "扩展散点图",
    "section": "可视化",
    "text": "可视化\n\n# 比例韦恩图\np &lt;- ggplot(data, aes(x = wt, y = mpg, color = cyl, size = cyl)) +\n  geom_point() +\n  geom_rug(alpha = 0.2, size = 1.5, col = \"#4f80b3\") +\n  theme(legend.position = \"none\")\n\np &lt;- ggMarginal(\n  p, type = \"densigram\", fill = \"#7054cc\", color = \"#7f0080\",\n  size = 4, bins = 30)\n\np\n\n\n\n\n\n\n\n图 1: 比例韦恩图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Extended Scatter"
    ]
  },
  {
    "objectID": "Hiplot/075-ggwithinstats.html",
    "href": "Hiplot/075-ggwithinstats.html",
    "title": "复杂小提琴图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Complex-Violin 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/ggwithinstats?lang=zh_cn",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Complex-Violin"
    ]
  },
  {
    "objectID": "Hiplot/075-ggwithinstats.html#环境配置",
    "href": "Hiplot/075-ggwithinstats.html#环境配置",
    "title": "复杂小提琴图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggstatsplot; ggplot2; cowplot\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggstatsplot\", quietly = TRUE)) {\n  install.packages(\"ggstatsplot\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"cowplot\", quietly = TRUE)) {\n  install.packages(\"cowplot\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggstatsplot)\nlibrary(ggplot2)\nlibrary(cowplot)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package     * version date (UTC) lib source\n cowplot     * 1.2.0   2025-07-07 [1] RSPM\n data.table  * 1.17.8  2025-07-10 [1] RSPM\n ggplot2     * 4.0.1   2025-11-14 [1] RSPM\n ggstatsplot * 0.13.4  2025-12-09 [1] RSPM\n jsonlite    * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Complex-Violin"
    ]
  },
  {
    "objectID": "Hiplot/075-ggwithinstats.html#数据准备",
    "href": "Hiplot/075-ggwithinstats.html#数据准备",
    "title": "复杂小提琴图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/ggwithinstats/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\naxis &lt;- c(\"condition\", \"desire\", \"region\")\ndata[, axis[1]] &lt;- factor(data[, axis[1]], levels = unique(data[, axis[1]]))\ndata[, axis[3]] &lt;- factor(data[, axis[3]], levels = unique(data[, axis[3]]))\n\n# 查看数据\nstr(data)\n\n'data.frame':   172 obs. of  6 variables:\n $ subject  : int  1 2 3 4 5 6 7 8 9 11 ...\n $ gender   : chr  \"Female\" \"Female\" \"Female\" \"Female\" ...\n $ region   : Factor w/ 2 levels \"North America\",..: 1 1 2 1 1 2 1 1 1 1 ...\n $ education: chr  \"some\" \"advance\" \"college\" \"college\" ...\n $ condition: Factor w/ 2 levels \"LDLF\",\"LDHF\": 1 1 1 1 1 1 1 1 1 1 ...\n $ desire   : num  6 10 5 6 3 2 10 10 9.5 0 ...",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Complex-Violin"
    ]
  },
  {
    "objectID": "Hiplot/075-ggwithinstats.html#可视化",
    "href": "Hiplot/075-ggwithinstats.html#可视化",
    "title": "复杂小提琴图",
    "section": "可视化",
    "text": "可视化\n\n# 复杂小提琴图\ng &lt;- unique(data[,axis[3]])\nplist &lt;- list()\nfor (i in 1:length(g)) {\n  fil &lt;- data[,axis[3]] == g[i]\n  plist[[i]] &lt;- ggwithinstats(\n    data = data[fil,], x = condition, y = desire,\n    title= paste('', axis[3], g[i], sep = ':'),\n    p.adjust.method = \"holm\",\n    plot.type = \"boxviolin\",\n    pairwise.comparisons = T,\n    pairwise.display = \"significant\",\n    effsize.type = \"unbiased\",\n    notch = T,\n    type = \"parametric\",\n    k = 2,\n    plotgrid.args = list(ncol = 2)\n  ) +\n    scale_color_manual(values = c(\"#3B4992FF\",\"#EE0000FF\"))\n}\n\nplot_grid(plotlist = plist, ncol = 2)\n\n\n\n\n\n\n\n图 1: 复杂小提琴图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Complex-Violin"
    ]
  },
  {
    "objectID": "Hiplot/053-ezcox.html",
    "href": "Hiplot/053-ezcox.html",
    "title": "Cox 模型森林图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Cox Models Forest 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/ezcox?lang=zh_cn\nCOX 模型森林图对 COX 模型构建风险森林图，以便于筛选变量的一种可视化图形。",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Cox Models Forest"
    ]
  },
  {
    "objectID": "Hiplot/053-ezcox.html#环境配置",
    "href": "Hiplot/053-ezcox.html#环境配置",
    "title": "Cox 模型森林图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ezcox\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ezcox\", quietly = TRUE)) {\n  install.packages(\"ezcox\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ezcox)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ezcox      * 1.0.4   2023-05-08 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Cox Models Forest"
    ]
  },
  {
    "objectID": "Hiplot/053-ezcox.html#数据准备",
    "href": "Hiplot/053-ezcox.html#数据准备",
    "title": "Cox 模型森林图",
    "section": "数据准备",
    "text": "数据准备\n载入数据为时间，生存结局及多个变量因素。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/ezcox/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 查看数据\nhead(data)\n\n  time status sex ph.ecog age\n1  306      2   1       1  74\n2  455      2   1       0  68\n3 1010      1   1       0  56\n4  210      2   1       1  57\n5  883      2   1       0  60\n6 1022      1   1       1  74",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Cox Models Forest"
    ]
  },
  {
    "objectID": "Hiplot/053-ezcox.html#可视化",
    "href": "Hiplot/053-ezcox.html#可视化",
    "title": "Cox 模型森林图",
    "section": "可视化",
    "text": "可视化\n\n# Cox 模型森林图\np &lt;- show_forest(\n  data = data,\n  covariates = c(\"sex\", \"ph.ecog\"),\n  controls = \"age\",\n  merge_models = F,\n  drop_controls = F,\n  add_caption = T\n)\n\np\n\n\n\n\n\n\n\n图 1: Cox 模型森林图\n\n\n\n\n\n图示表格第一列表示变量及样本数，第二列森林图图示，第三列表示CI95%置信区间范围及其平均值和 P 值\n森林图解读\n中间垂直线表示无效线，横线表示该变量因素的95%置信区间，长短表示置信区间范围的大小，若某变量因素置信区间与无效线相交，则认为该变量因素无统计学意义，方块的位置是HR的点估计。\nage 因素为控制变量。\nph.ecog 因素的发生率大于年龄因素的发生率，且 ph.ecog 因素会增加生存的发生（P &lt; 0.001，有统计学意义）。\nsex 因素的发生率小于年龄因素的发生率，且 sex 因素会减少生存的发生（P = 0.002 &lt; 0.05，有统计学意义）。",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Cox Models Forest"
    ]
  },
  {
    "objectID": "Hiplot/015-boxplot.html",
    "href": "Hiplot/015-boxplot.html",
    "title": "箱式图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Boxplot 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/boxplot?lang=zh_cn\n箱形图是一种通过四分位数图形象化地描述一组数据分布特征的方法。",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Boxplot"
    ]
  },
  {
    "objectID": "Hiplot/015-boxplot.html#环境配置",
    "href": "Hiplot/015-boxplot.html#环境配置",
    "title": "箱式图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggpubr; ggthemes\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggpubr\", quietly = TRUE)) {\n  install.packages(\"ggpubr\")\n}\nif (!requireNamespace(\"ggthemes\", quietly = TRUE)) {\n  install.packages(\"ggthemes\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggpubr)\nlibrary(ggthemes)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n ggpubr     * 0.6.2   2025-10-17 [1] RSPM\n ggthemes   * 5.2.0   2025-11-30 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Boxplot"
    ]
  },
  {
    "objectID": "Hiplot/015-boxplot.html#数据准备",
    "href": "Hiplot/015-boxplot.html#数据准备",
    "title": "箱式图",
    "section": "数据准备",
    "text": "数据准备\n载入数据为数据集 (不同治疗方案的治疗效果数据)。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/boxplot/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ngroups &lt;- unique(data[, 2])\nmy_comparisons &lt;- combn(groups, 2, simplify = FALSE)\nmy_comparisons &lt;- lapply(my_comparisons, as.character)\n\n# 查看数据\nhead(data)\n\n  Value Group1 Group2\n1   4.2    low treat1\n2  11.5    low treat1\n3   7.3    low treat1\n4   5.8    low treat1\n5   6.4    low treat1\n6  10.0    low treat1",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Boxplot"
    ]
  },
  {
    "objectID": "Hiplot/015-boxplot.html#可视化",
    "href": "Hiplot/015-boxplot.html#可视化",
    "title": "箱式图",
    "section": "可视化",
    "text": "可视化\n\n# 箱式图\np &lt;- ggboxplot(data, x = \"Group1\", y = \"Value\", notch = F, facet.by = \"Group2\",\n               add = \"point\", color = \"Group1\", xlab = \"Group2\", ylab = \"Value\",\n               palette = c(\"#e04d39\",\"#5bbad6\",\"#1e9f86\"),\n               title = \"Box Plot\") +\n  stat_compare_means(comparisons = my_comparisons, label = \"p.format\", \n                     method = \"t.test\") +\n  scale_y_continuous(expand = expansion(mult = c(0.1, 0.1))) +\n  theme_stata() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 1: 箱式图\n\n\n\n\n\n横坐标表示几组不同的数据，纵坐标分别表示各组数据的四分位数；即方框上、中、下的横线分别代表上四分位数，中位数，下四分位数；上下方线段代表的数值分别指数据最大值和最小值，方框以外的点代表离群值。图示上方数值表示两两变量间的 P 值，可认为治疗方案 1 中，中剂量组同低剂量组疗效有显著差异，以此类推。",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Boxplot"
    ]
  },
  {
    "objectID": "Hiplot/043-diverging-scale.html",
    "href": "Hiplot/043-diverging-scale.html",
    "title": "双侧标准化图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Diverging Scale 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/diverging-scale?lang=zh_cn\n双侧标准化图是一种将连续的，定量的输入映射到连续的固定的插值器上的图形。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Diverging Scale"
    ]
  },
  {
    "objectID": "Hiplot/043-diverging-scale.html#环境配置",
    "href": "Hiplot/043-diverging-scale.html#环境配置",
    "title": "双侧标准化图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggcharts\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggcharts\", quietly = TRUE)) {\n  install.packages(\"ggcharts\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggcharts)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggcharts   * 0.2.1   2020-05-20 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Diverging Scale"
    ]
  },
  {
    "objectID": "Hiplot/043-diverging-scale.html#数据准备",
    "href": "Hiplot/043-diverging-scale.html#数据准备",
    "title": "双侧标准化图",
    "section": "数据准备",
    "text": "数据准备\n导入数据第一列为模型名称列表，其余列输入相关指标及对应数值。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/diverging-scale/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndata &lt;- dplyr::transmute(.data = data, x = model, y = scale(hp))\n\n# 查看数据\nhead(data)\n\n                  x          y\n1         Mazda RX4 -0.6130929\n2     Mazda RX4 Wag -0.6130929\n3        Datsun 710 -0.9123057\n4    Hornet 4 Drive -0.6130929\n5 Hornet Sportabout  0.5309561\n6           Valiant -0.7010967",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Diverging Scale"
    ]
  },
  {
    "objectID": "Hiplot/043-diverging-scale.html#可视化",
    "href": "Hiplot/043-diverging-scale.html#可视化",
    "title": "双侧标准化图",
    "section": "可视化",
    "text": "可视化\n\n1.条形图\n\n# 双侧条形图\nfill_colors &lt;- c(\"#C20B01\", \"#196ABD\")\nfill_colors &lt;- fill_colors[c(any(data[, \"y\"] &gt; 0), any(data[, \"y\"] &lt; 0))]\np &lt;- diverging_bar_chart(data = data, x = x, y = y, bar_colors = fill_colors,\n                         text_color = '#000000') + \n  theme(axis.text.x = element_text(color = \"#000000\"),\n        axis.title.x = element_text(colour = \"#000000\"),\n        axis.title.y = element_text(colour = \"#000000\"),\n        plot.background = element_blank()) + \n  labs(x = \"model\", y = \"scale(hp)\", title = \"\")\n\np\n\n\n\n\n\n\n\n图 1: 双侧条形图\n\n\n\n\n\n图示横轴表示hp数据，纵轴表示模型名称（分类），红色表示超过平均值的模型，蓝色表示低于平均值的模型，数据是按照大小赋值于 2 的比例尺上面。\n\n\n2.棒棒糖图\n\n# 双侧棒棒糖图\nfill_colors &lt;- c(\"#C20B01\", \"#196ABD\")\nfill_colors &lt;- fill_colors[c(any(data[, \"y\"] &gt; 0), any(data[, \"y\"] &lt; 0))]\np &lt;- diverging_lollipop_chart(\n  data = data, x = x, y = y, lollipop_colors = fill_colors,\n  line_size = 0.3, point_size = 1.9, text_color = '#000000') + \n  theme(axis.text.x = element_text(color = \"#000000\"),\n        axis.title.x = element_text(colour = \"#000000\"),\n        axis.title.y = element_text(colour = \"#000000\"),\n        plot.background = element_blank()) + \n  labs(x = \"model\", y = \"scale(hp)\", title = \"\")\n\np\n\n\n\n\n\n\n\n图 2: 双侧棒棒糖图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Diverging Scale"
    ]
  },
  {
    "objectID": "Hiplot/102-map-europe.html",
    "href": "Hiplot/102-map-europe.html",
    "title": "欧洲地图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Europe Map 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/map-europe?lang=zh_cn",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Europe Map"
    ]
  },
  {
    "objectID": "Hiplot/102-map-europe.html#环境配置",
    "href": "Hiplot/102-map-europe.html#环境配置",
    "title": "欧洲地图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2; RColorBrewer\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(RColorBrewer)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package      * version date (UTC) lib source\n data.table   * 1.17.8  2025-07-10 [1] RSPM\n ggplot2      * 4.0.1   2025-11-14 [1] RSPM\n jsonlite     * 2.0.0   2025-03-27 [1] RSPM\n RColorBrewer * 1.1-3   2022-04-03 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Europe Map"
    ]
  },
  {
    "objectID": "Hiplot/102-map-europe.html#数据准备",
    "href": "Hiplot/102-map-europe.html#数据准备",
    "title": "欧洲地图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/map-europe/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\ndt_map &lt;- readRDS(url(\"https://download.hiplot.cn/ui/basic/map-europe/eu.rds\"))\n\n# 整理数据格式\ndt_map$Value &lt;- data$value[match(dt_map$ENG_NAME, data$region)]\n\n# 查看数据\nhead(data)\n\n              region value\n1            Albania   758\n2            Andorra   139\n3            Austria   256\n4            Belgium   959\n5 Bosnia Herzegovina   422\n6            Croatia   791",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Europe Map"
    ]
  },
  {
    "objectID": "Hiplot/102-map-europe.html#可视化",
    "href": "Hiplot/102-map-europe.html#可视化",
    "title": "欧洲地图",
    "section": "可视化",
    "text": "可视化\n\n# 欧洲地图\np &lt;- ggplot(dt_map) +\n  geom_polygon(aes(x = long, y = lat, group = group, fill = Value),\n               alpha = 0.9, size = 0.5) +\n  geom_path(aes(x = long, y = lat, group = group), color = \"black\", size = 0.2) +\n  coord_fixed() +\n  scale_fill_gradientn(\n    colours = colorRampPalette(rev(brewer.pal(11,\"RdYlBu\")))(500),\n    breaks = seq(min(data$value), max(data$value), \n                 round((max(data$value)-min(data$value))/7)),\n    name = \"Color Key\",\n    guide = guide_legend(\n      direction = \"vertical\", keyheight = unit(1, units = \"mm\"),\n      keywidth = unit(8, units = \"mm\"),\n      title.position = \"top\", title.hjust = 0.5, label.hjust = 0.5,\n      nrow = 1, byrow = T, reverse = F, label.position = \"bottom\")) +\n  theme(text = element_text(color = \"#3A3F4A\"),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank(),\n        legend.position = \"top\",\n        legend.text = element_text(size = 4 * 1.5, color = \"black\"),\n        legend.title = element_text(size = 5 * 1.5, color = \"black\"),\n        plot.title = element_text(\n          face = \"bold\", size = 5 * 1.5, hjust = 0.5, \n          margin = margin(t = 4, b = 5), color = \"black\"),\n        plot.background = element_rect(fill = \"#FFFFFF\", color = \"#FFFFFF\"),\n        panel.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        legend.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        plot.margin = unit(c(1.5, 1.5, 1.5, 1.5), \"cm\")) +\n  labs(x = NULL, y = NULL, title = \"Europe Map\")\n\np\n\n\n\n\n\n\n\n图 1: 欧洲地图",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Europe Map"
    ]
  },
  {
    "objectID": "Hiplot/159-scatter-3d.html",
    "href": "Hiplot/159-scatter-3d.html",
    "title": "三维散点图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot 3D Scatter 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/scatter-3d?lang=zh_cn\n三维散点图是将多个定量变量运用于空间中的不同轴上，并将不同的变量组合成空间中的坐标，从而对三个定量变量的交互关系进行清晰的解释。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "3D-Scatter"
    ]
  },
  {
    "objectID": "Hiplot/159-scatter-3d.html#环境配置",
    "href": "Hiplot/159-scatter-3d.html#环境配置",
    "title": "三维散点图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; plot3D; ggplotify\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"plot3D\", quietly = TRUE)) {\n  install.packages(\"plot3D\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(plot3D)\nlibrary(ggplotify)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplotify  * 0.1.3   2025-09-20 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n plot3D     * 1.4.2   2025-07-25 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "3D-Scatter"
    ]
  },
  {
    "objectID": "Hiplot/159-scatter-3d.html#数据准备",
    "href": "Hiplot/159-scatter-3d.html#数据准备",
    "title": "三维散点图",
    "section": "数据准备",
    "text": "数据准备\n载入数据为三个变量和分组。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/scatter-3d/data.json\")$exampleData[[1]]$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ncol_idx &lt;- which(colnames(data) == \"group\")\ndata[, col_idx] &lt;- as.factor(data[, col_idx])\nshapes &lt;- 19\nshape_idx &lt;- \"\"\n\n# 查看数据\nhead(data)\n\n      temp    pressure dtime group\n1 41.11057  0.49351190     1    G1\n2 35.23429  0.76636476     2    G1\n3 26.58407  0.63885937     3    G1\n4 34.76097 -0.08106332     4    G1\n5 25.76521 -0.31731579     5    G1\n6 20.30115 -1.91132873     6    G1",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "3D-Scatter"
    ]
  },
  {
    "objectID": "Hiplot/159-scatter-3d.html#可视化",
    "href": "Hiplot/159-scatter-3d.html#可视化",
    "title": "三维散点图",
    "section": "可视化",
    "text": "可视化\n\n# 三维散点图\np &lt;- as.ggplot(function() {\n  plot3d &lt;- scatter3D(data[, 1], data[, 2], data[, 3],\n    pch = shapes, cex = 1,\n    phi = 0, theta = 45, ticktype = \"detailed\",\n    bty = \"b2\", colkey = FALSE, alpha = 1,\n    xlab = colnames(data)[1], ylab = colnames(data)[2],\n    zlab = colnames(data)[3],\n    main = \"3D-Scatter Plot\",\n    colvar = as.numeric(as.factor(data[, 4])),\n    col = c(\"#e04d39\",\"#5bbad6\",\"#1e9f86\")\n  )\n  \n  legend(\"right\", pch=19, legend = levels(data[, col_idx]),\n         cex = 1.1, bty = 'n', xjust = 0.5, horiz = F,\n         title = colnames(data)[col_idx],\n         col = c(\"#e04d39\",\"#5bbad6\",\"#1e9f86\"))\n})\n\np\n\n\n\n\n\n\n\n图 1: 三维散点图\n\n\n\n\n\n图中分别将温度、压力、时间放置在 x（水平轴）、y（垂直轴）、z（透视轴）上，生成一幅三维散点图，直观发现三者变量间的相关关系及相关强弱程度。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "3D-Scatter"
    ]
  },
  {
    "objectID": "Hiplot/170-taylor-diagram.html",
    "href": "Hiplot/170-taylor-diagram.html",
    "title": "泰勒图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Taylor Diagram 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/taylor-diagram?lang=zh_cn\n可以用于同时展示模型标准差（standard deviation, SD）、均方根（root mean square，RMS）误差和相关系数。",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Taylor Diagram"
    ]
  },
  {
    "objectID": "Hiplot/170-taylor-diagram.html#环境配置",
    "href": "Hiplot/170-taylor-diagram.html#环境配置",
    "title": "泰勒图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: openair\n\n\n# 安装包\nif (!requireNamespace(\"openair\", quietly = TRUE)) {\n  install.packages(\"openair\")\n}\n\n# 加载包\nlibrary(openair)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package * version date (UTC) lib source\n openair * 2.19.0  2025-08-28 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Taylor Diagram"
    ]
  },
  {
    "objectID": "Hiplot/170-taylor-diagram.html#数据准备",
    "href": "Hiplot/170-taylor-diagram.html#数据准备",
    "title": "泰勒图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndat &lt;- selectByDate(mydata, year = 2003)\n\n# 整理数据格式\ndat &lt;- data.frame(date = mydata$date, obs = mydata$nox, mod = mydata$nox)\ndat &lt;- transform(dat, month = as.numeric(format(date, \"%m\")))\nmod1 &lt;- transform(dat, mod = mod + 10 * month + 10 * month * rnorm(nrow(dat)),\nmodel = \"model 1\")\nmod1 &lt;- transform(mod1, mod = c(mod[5:length(mod)], mod[(length(mod) - 3) :\nlength(mod)]))\nmod2 &lt;- transform(dat, mod = mod + 7 * month + 7 * month * rnorm(nrow(dat)),\nmodel = \"model 2\")\nmod3 &lt;- transform(dat, mod = mod + 3 * month + 3 * month * rnorm(nrow(dat)),\nmodel = \"model 3\")\nmod.dat &lt;- rbind(mod1, mod2, mod3)\n\n# 查看数据\nhead(mod.dat)\n\n                 date obs      mod month   model\n1 1998-01-01 00:00:00 285 454.8798     1 model 1\n2 1998-01-01 01:00:00  NA 295.9648     1 model 1\n3 1998-01-01 02:00:00  NA 183.4318     1 model 1\n4 1998-01-01 03:00:00 493 211.9225     1 model 1\n5 1998-01-01 04:00:00 468 146.3648     1 model 1\n6 1998-01-01 05:00:00 264 120.6815     1 model 1",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Taylor Diagram"
    ]
  },
  {
    "objectID": "Hiplot/170-taylor-diagram.html#可视化",
    "href": "Hiplot/170-taylor-diagram.html#可视化",
    "title": "泰勒图",
    "section": "可视化",
    "text": "可视化\n\n# 泰勒图\nTaylorDiagram(mod.dat, obs = \"obs\", mod = \"mod\", group = \"model\",\n              main = \"Taylor diagram\", \n              cols = c(\"#00468BFF\",\"#8e6097\",\"#BFACF0FF\"))\n\n\n\n\n\n\n\n图 1: 泰勒图",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Taylor Diagram"
    ]
  },
  {
    "objectID": "Hiplot/107-map-germany.html",
    "href": "Hiplot/107-map-germany.html",
    "title": "德国地图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Germany Map 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/map-germany?lang=zh_cn",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Germany Map"
    ]
  },
  {
    "objectID": "Hiplot/107-map-germany.html#环境配置",
    "href": "Hiplot/107-map-germany.html#环境配置",
    "title": "德国地图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2; RColorBrewer\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(RColorBrewer)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package      * version date (UTC) lib source\n data.table   * 1.17.8  2025-07-10 [1] RSPM\n ggplot2      * 4.0.1   2025-11-14 [1] RSPM\n jsonlite     * 2.0.0   2025-03-27 [1] RSPM\n RColorBrewer * 1.1-3   2022-04-03 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Germany Map"
    ]
  },
  {
    "objectID": "Hiplot/107-map-germany.html#数据准备",
    "href": "Hiplot/107-map-germany.html#数据准备",
    "title": "德国地图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/map-germany/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\ndt_map &lt;- readRDS(url(\"https://download.hiplot.cn/ui/basic/map-germany/germany.rds\"))\n\n# 整理数据格式\ndt_map$Value &lt;- data$value[match(dt_map$ENG_NAME, data$name)]\n\n# 查看数据\nhead(data)\n\n               name value\n1 Baden-Württemberg   334\n2            Bayern   562\n3            Berlin   980\n4       Brandenburg   577\n5            Bremen    54\n6           Hamburg   528",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Germany Map"
    ]
  },
  {
    "objectID": "Hiplot/107-map-germany.html#可视化",
    "href": "Hiplot/107-map-germany.html#可视化",
    "title": "德国地图",
    "section": "可视化",
    "text": "可视化\n\n# 德国地图\np &lt;- ggplot(dt_map) +\n  geom_polygon(aes(x = long, y = lat, group = group, fill = Value),\n               alpha = 0.9, size = 0.5) +\n  geom_path(aes(x = long, y = lat, group = group), color = \"black\", size = 0.2) +\n  coord_fixed() +\n  scale_fill_gradientn(\n    colours = colorRampPalette(rev(brewer.pal(11,\"RdYlBu\")))(500),\n    breaks = seq(min(data$value), max(data$value), \n                 round((max(data$value)-min(data$value))/7)),\n    name = \"Color Key\",\n    guide = guide_legend(\n      direction = \"vertical\", keyheight = unit(1, units = \"mm\"),\n      keywidth = unit(8, units = \"mm\"),\n      title.position = \"top\", title.hjust = 0.5, label.hjust = 0.5,\n      nrow = 1, byrow = T, reverse = F, label.position = \"bottom\")) +\n  theme(text = element_text(color = \"#3A3F4A\"),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank(),\n        legend.position = \"top\",\n        legend.text = element_text(size = 4 * 1.5, color = \"black\"),\n        legend.title = element_text(size = 5 * 1.5, color = \"black\"),\n        plot.title = element_text(\n          face = \"bold\", size = 5 * 1.5, hjust = 0.5, \n          margin = margin(t = 4, b = 5), color = \"black\"),\n        plot.background = element_rect(fill = \"#FFFFFF\", color = \"#FFFFFF\"),\n        panel.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        legend.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        plot.margin = unit(c(1.5, 1.5, 1.5, 1.5), \"cm\")) +\n  labs(x = NULL, y = NULL, title = \"Germany Map\")\n\np\n\n\n\n\n\n\n\n图 1: 德国地图",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Germany Map"
    ]
  },
  {
    "objectID": "Hiplot/012-beeswarm.html",
    "href": "Hiplot/012-beeswarm.html",
    "title": "蜜蜂群图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Beeswarm 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/beeswarm?lang=zh_cn\n蜜蜂群图是一种类似蜜蜂群，样本间互不干涉的列散点图。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Beeswarm"
    ]
  },
  {
    "objectID": "Hiplot/012-beeswarm.html#环境配置",
    "href": "Hiplot/012-beeswarm.html#环境配置",
    "title": "蜜蜂群图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2; ggthemes\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"ggthemes\", quietly = TRUE)) {\n  install.packages(\"ggthemes\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggbeeswarm)\nlibrary(ggthemes)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggbeeswarm * 0.7.3   2025-11-29 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n ggthemes   * 5.2.0   2025-11-30 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Beeswarm"
    ]
  },
  {
    "objectID": "Hiplot/012-beeswarm.html#数据准备",
    "href": "Hiplot/012-beeswarm.html#数据准备",
    "title": "蜜蜂群图",
    "section": "数据准备",
    "text": "数据准备\n载入数据为不同分组及其数据。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/beeswarm/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndata[, 1] &lt;- factor(data[, 1], levels = unique(data[, 1]))\ncolnames(data) &lt;- c(\"Group\", \"y\")\n\n# 查看数据\nhead(data)\n\n  Group   y\n1    G1 5.1\n2    G1 4.9\n3    G1 4.7\n4    G1 4.6\n5    G1 5.0\n6    G1 5.4",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Beeswarm"
    ]
  },
  {
    "objectID": "Hiplot/012-beeswarm.html#可视化",
    "href": "Hiplot/012-beeswarm.html#可视化",
    "title": "蜜蜂群图",
    "section": "可视化",
    "text": "可视化\n\n# 蜜蜂群图\np &lt;- ggplot(data, aes(Group, y, color = Group)) +\n  geom_beeswarm(alpha = 1, size = 0.8) +\n  labs(x = NULL, y = \"value\") +\n  ggtitle(\"BeeSwarm Plot\") +\n  scale_color_manual(values = c(\"#e04d39\",\"#5bbad6\",\"#1e9f86\")) +\n  theme_stata() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 1: 蜜蜂群图\n\n\n\n\n\n不同颜色表示不同组群 ，点表示数据。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Beeswarm"
    ]
  },
  {
    "objectID": "Hiplot/073-ggscatterstats.html",
    "href": "Hiplot/073-ggscatterstats.html",
    "title": "散点图（Scatterstats）",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Scatterstats 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/ggscatterstats?lang=zh_cn",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Scatterstats"
    ]
  },
  {
    "objectID": "Hiplot/073-ggscatterstats.html#环境配置",
    "href": "Hiplot/073-ggscatterstats.html#环境配置",
    "title": "散点图（Scatterstats）",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggpubr; ggthemes\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggstatsplot\", quietly = TRUE)) {\n  install.packages(\"ggstatsplot\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggstatsplot)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package     * version date (UTC) lib source\n data.table  * 1.17.8  2025-07-10 [1] RSPM\n ggstatsplot * 0.13.4  2025-12-09 [1] RSPM\n jsonlite    * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Scatterstats"
    ]
  },
  {
    "objectID": "Hiplot/073-ggscatterstats.html#数据准备",
    "href": "Hiplot/073-ggscatterstats.html#数据准备",
    "title": "散点图（Scatterstats）",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/ggscatterstats/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 查看数据\nhead(data)\n\n                                                                 title year\n1                       Lord of the Rings: The Return of the King, The 2003\n2                   Lord of the Rings: The Fellowship of the Ring, The 2001\n3                               Lord of the Rings: The Two Towers, The 2002\n4                                                            Star Wars 1977\n5                       Star Wars: Episode V - The Empire Strikes Back 1980\n6 Dr. Strangelove or: How I Learned to Stop Worrying and Love the Bomb 1964\n  length budget rating  votes  mpaa  genre\n1    251   94.0    9.0 103631 PG-13 Action\n2    208   93.0    8.8 157608 PG-13 Action\n3    223   94.0    8.8 114797 PG-13 Action\n4    125   11.0    8.8 134640    PG Action\n5    129   18.0    8.8 103706    PG Action\n6     93    1.8    8.7  63471    PG Comedy",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Scatterstats"
    ]
  },
  {
    "objectID": "Hiplot/073-ggscatterstats.html#可视化",
    "href": "Hiplot/073-ggscatterstats.html#可视化",
    "title": "散点图（Scatterstats）",
    "section": "可视化",
    "text": "可视化\n\n# GGPubr 箱线图\np &lt;- ggscatterstats(\n  data = data, x = rating, y = budget\n)\n\np\n\n\n\n\n\n\n\n图 1: GGPubr 箱线图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Scatterstats"
    ]
  },
  {
    "objectID": "Hiplot/011-beanplot.html",
    "href": "Hiplot/011-beanplot.html",
    "title": "豆荚图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Beanplot 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/beanplot?lang=zh_cn\n豆荚图是一种描述一组数据分布特征的方法。",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Beanplot"
    ]
  },
  {
    "objectID": "Hiplot/011-beanplot.html#环境配置",
    "href": "Hiplot/011-beanplot.html#环境配置",
    "title": "豆荚图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplotify; beanplot\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\nif (!requireNamespace(\"beanplot\", quietly = TRUE)) {\n  install.packages(\"beanplot\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplotify)\nlibrary(beanplot)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n beanplot   * 1.3.1   2022-04-09 [1] RSPM\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplotify  * 0.1.3   2025-09-20 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Beanplot"
    ]
  },
  {
    "objectID": "Hiplot/011-beanplot.html#数据准备",
    "href": "Hiplot/011-beanplot.html#数据准备",
    "title": "豆荚图",
    "section": "数据准备",
    "text": "数据准备\n载入数据为数据集 (不同治疗方案的治疗效果数据)。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/beanplot/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\nGroupOrder &lt;- as.numeric(factor(data[, 2], levels = unique(data[, 2])))\ndata[, 2] &lt;- paste0(data[,2], \" \", as.numeric(factor(data[, 3])))\ndata &lt;- cbind(data, GroupOrder)\n\n# 查看数据\nhead(data)\n\n     Y     X  Group GroupOrder\n1  4.2 low 1 treat1          1\n2 11.5 low 1 treat1          1\n3  7.3 low 1 treat1          1\n4  5.8 low 1 treat1          1\n5  6.4 low 1 treat1          1\n6 10.0 low 1 treat1          1",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Beanplot"
    ]
  },
  {
    "objectID": "Hiplot/011-beanplot.html#可视化",
    "href": "Hiplot/011-beanplot.html#可视化",
    "title": "豆荚图",
    "section": "可视化",
    "text": "可视化\n\n# 豆荚图\np &lt;- as.ggplot(function() {\n  beanplot(Y ~ reorder(X, GroupOrder, mean), data = data, ll = 0.04,\n           main = \"Bean Plot\", ylab = \"Y\", xlab = \"X\", side = \"both\",\n           border = NA, horizontal = F, \n           col = list(c(\"#2b70c4\", \"#2b70c4\"),c(\"#e9c216\", \"#e9c216\")),\n           beanlines = \"mean\", overallline = \"mean\", kernel = \"gaussian\")\n  \n  legend(\"bottomright\", fill = c(\"#2b70c4\", \"#e9c216\"),\n         legend = levels(factor(data[, 3])))\n})\n\np\n\n\n\n\n\n\n\n图 1: 豆荚图",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Beanplot"
    ]
  },
  {
    "objectID": "Hiplot/142-point-sd.html",
    "href": "Hiplot/142-point-sd.html",
    "title": "点图（标准差）",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Point (SD) 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/point-sd?lang=zh_cn\n用于展示多组数据点标准差。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Point (SD)"
    ]
  },
  {
    "objectID": "Hiplot/142-point-sd.html#环境配置",
    "href": "Hiplot/142-point-sd.html#环境配置",
    "title": "点图（标准差）",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; grafify; dplyr\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"grafify\", quietly = TRUE)) {\n  install.packages(\"grafify\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(grafify)\nlibrary(dplyr)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n dplyr      * 1.1.4   2023-11-17 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n grafify    * 5.1.0   2025-08-25 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Point (SD)"
    ]
  },
  {
    "objectID": "Hiplot/142-point-sd.html#数据准备",
    "href": "Hiplot/142-point-sd.html#数据准备",
    "title": "点图（标准差）",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/point-sd/data.json\")$exampleData[[1]]$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ny &lt;- \"Doubling_time\"\ngroup &lt;- \"Student\"\ndata[, group] &lt;- factor(data[, group], levels = unique(data[, group]))\ndata &lt;- data %&gt;% \n  mutate(median = median(get(y), na.rm = TRUE),\n         mean = mean(get(y), na.rm = TRUE))\n\n# 查看数据\nhead(data)\n\n  Experiment Student Doubling_time facet   median     mean\n1       Exp1       A      17.36765    F1 20.18114 19.91642\n2       Exp1       B      18.04119    F1 20.18114 19.91642\n3       Exp1       C      18.70120    F1 20.18114 19.91642\n4       Exp1       D      20.06762    F1 20.18114 19.91642\n5       Exp1       E      20.19807    F2 20.18114 19.91642\n6       Exp1       F      22.11908    F2 20.18114 19.91642",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Point (SD)"
    ]
  },
  {
    "objectID": "Hiplot/142-point-sd.html#可视化",
    "href": "Hiplot/142-point-sd.html#可视化",
    "title": "点图（标准差）",
    "section": "可视化",
    "text": "可视化\n\n# 点图（标准差）\np &lt;- plot_point_sd(data = data, Student, Doubling_time, symsize = 5,\n                   symthick = 0.5, s_alpha = 1, ewid = 0, symshape = 21,\n                   all_alpha = 0) +\n  geom_hline(aes(yintercept = median), colour = 'black', linetype = 2, \n             size = 0.5) +\n  xlab(group) + ylab(y) + \n  guides(fill = guide_legend(title = group)) +\n  ggtitle(\"Point-SD\") +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n    \n  \np\n\n\n\n\n\n\n\n图 1: 点图（标准差）",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Point (SD)"
    ]
  },
  {
    "objectID": "Hiplot/176-umap.html",
    "href": "Hiplot/176-umap.html",
    "title": "UMAP",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot UMAP 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/umap?lang=zh_cn\nUMAP 是一种非线性降维算法，适用于高维数据降维到 2 维或 3 维并进行可视化。该算法能够使较大相似度的点，t 分布在低维空间中的距离更近；而对于低相似度的点，t 分布在低维空间中的距离更远。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "UMAP"
    ]
  },
  {
    "objectID": "Hiplot/176-umap.html#环境配置",
    "href": "Hiplot/176-umap.html#环境配置",
    "title": "UMAP",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; umap; ggpubr\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"umap\", quietly = TRUE)) {\n  install.packages(\"umap\")\n}\nif (!requireNamespace(\"ggpubr\", quietly = TRUE)) {\n  install.packages(\"ggpubr\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(umap)\nlibrary(ggpubr)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version  date (UTC) lib source\n data.table * 1.17.8   2025-07-10 [1] RSPM\n ggplot2    * 4.0.1    2025-11-14 [1] RSPM\n ggpubr     * 0.6.2    2025-10-17 [1] RSPM\n jsonlite   * 2.0.0    2025-03-27 [1] RSPM\n umap       * 0.2.10.0 2023-02-01 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "UMAP"
    ]
  },
  {
    "objectID": "Hiplot/176-umap.html#数据准备",
    "href": "Hiplot/176-umap.html#数据准备",
    "title": "UMAP",
    "section": "数据准备",
    "text": "数据准备\n载入数据为数据集（基因名称及其对应的基因表达值）和样本信息（样本名称及分组）。\n\n# 加载数据\ndata1 &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/umap/data.json\")$exampleData$textarea[[1]])\ndata1 &lt;- as.data.frame(data1)\ndata2 &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/umap/data.json\")$exampleData$textarea[[2]])\ndata2 &lt;- as.data.frame(data2)\n\n\n# 整理数据格式\nsample.info &lt;- data2\nrownames(data1) &lt;- data1[, 1]\ndata1 &lt;- as.matrix(data1[, -1])\n## umap\nset.seed(123)\numap_info &lt;- umap(t(data1))\ncolnames(umap_info$layout) &lt;- c(\"UMAP_1\", \"UMAP_2\")\n# handle data\numap_data &lt;- data.frame(\n  sample = colnames(data1),\n  umap_info$layout\n)\ncolorBy &lt;- sample.info[match(colnames(data1), sample.info[, 1]), \"Species\"]\ncolorBy &lt;- factor(colorBy, level = colorBy[!duplicated(colorBy)])\numap_data$colorBy = colorBy\nshapeBy &lt;- NULL\n\n# 查看数据\nhead(data1[,1:5])\n\n              M1  M2  M3  M4  M5\nSepal.Length 5.1 4.9 4.7 4.6 5.0\nSepal.Width  3.5 3.0 3.2 3.1 3.6\nPetal.Length 1.4 1.4 1.3 1.5 1.4\nPetal.Width  0.2 0.2 0.2 0.2 0.2\n\nhead(data2)\n\n  Samples Species\n1      M1  setosa\n2      M2  setosa\n3      M3  setosa\n4      M4  setosa\n5      M5  setosa\n6      M6  setosa",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "UMAP"
    ]
  },
  {
    "objectID": "Hiplot/176-umap.html#可视化",
    "href": "Hiplot/176-umap.html#可视化",
    "title": "UMAP",
    "section": "可视化",
    "text": "可视化\n\n# umap\np &lt;- ggscatter(data = umap_data, x = \"UMAP_1\", y = \"UMAP_2\", size = 2, \n               palette = \"lancet\", color = \"colorBy\") +\n  labs(color = \"group\") +\n  ggtitle(\"UMAP Plot\") +\n  theme_classic() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 1: umap\n\n\n\n\n\n不同颜色表示不同样本，与 PCA（主成分分析）图形解释相同，不同之处在于可视化效果，t-SNE 中对于不相似的点，用一个较小的距离会产生较大的梯度来让这些点排斥开来。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "UMAP"
    ]
  },
  {
    "objectID": "Hiplot/086-heatmap.html",
    "href": "Hiplot/086-heatmap.html",
    "title": "热图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Heatmap 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/heatmap?lang=zh_cn\n热图是对实验数据分布情况进行分析的直观可视化方法，可以用来进行实验数据的质量控制和差异数据的具象化展示，还可以对数据和样品进行聚类分析，观测样品质量。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/086-heatmap.html#环境配置",
    "href": "Hiplot/086-heatmap.html#环境配置",
    "title": "热图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ComplexHeatmap; genefilter\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ComplexHeatmap\", quietly = TRUE)) {\n  BiocManager::install(\"ComplexHeatmap\")\n}\nif (!requireNamespace(\"genefilter\", quietly = TRUE)) {\n  install.packages(\"genefilter\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ComplexHeatmap)\nlibrary(genefilter)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package        * version date (UTC) lib source\n ComplexHeatmap * 2.26.0  2025-10-29 [1] Bioconduc~\n data.table     * 1.17.8  2025-07-10 [1] RSPM\n genefilter     * 1.92.0  2025-10-29 [1] Bioconduc~\n jsonlite       * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/086-heatmap.html#数据准备",
    "href": "Hiplot/086-heatmap.html#数据准备",
    "title": "热图",
    "section": "数据准备",
    "text": "数据准备\n载入数据为 count (基因名称及其对应的基因表达值)，样本信息（样本名称，所属组群及其他相关信息，如年龄），基因信息（基因名称及其所属通路，如肿瘤通路和生理状况下通路）。\n\n# 加载数据\ndata_count &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/heatmap/data.json\")$exampleData[[1]]$textarea[[1]])\ndata_count &lt;- as.data.frame(data_count)\ndata_sample &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/heatmap/data.json\")$exampleData[[1]]$textarea[[2]])\ndata_sample &lt;- as.data.frame(data_sample)\ndata_gene &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/heatmap/data.json\")$exampleData[[1]]$textarea[[3]])\ndata_gene &lt;- as.data.frame(data_gene)\n\n# 整理数据格式\ndata_count &lt;- data_count[!is.na(data_count[, 1]), ]\nidx &lt;- duplicated(data_count[, 1])\ndata_count[idx, 1] &lt;- paste0(data_count[idx, 1], \"--dup-\", cumsum(idx)[idx])\nfor (i in 2:ncol(data_count)) {\n  data_count[, i] &lt;- as.numeric(data_count[, i])\n}\ndata &lt;- as.matrix(data_count[, -1])\nrownames(data) &lt;- data_count[, 1]\n\n## 给样本添加标注信息\nsample.info &lt;- data_sample[-1]\nrow.names(sample.info) &lt;- data_sample[, 1]\nsample_info_reorder &lt;- as.data.frame(sample.info[match(\n  colnames(data), rownames(sample.info)\n  ), ])\ncolnames(sample_info_reorder) &lt;- colnames(sample.info)\nrownames(sample_info_reorder) &lt;- colnames(data)\n\n## 给基因添加标注信息\ngene_info &lt;- data_gene[-1]\nrownames(gene_info) &lt;- data_gene[, 1]\ngene_info_reorder &lt;- as.data.frame(gene_info[match(\n  rownames(data), rownames(gene_info)\n  ), ])\ncolnames(gene_info_reorder) &lt;- colnames(gene_info)\nrownames(gene_info_reorder) &lt;- rownames(data)\n\n# 查看数据\nhead(data)\n\n              M1       M2        M3       M4       M5       M6       M7\nGBP4    6.599344 5.226266  3.693288 3.938501 4.527193 9.308119 8.987865\nBCAT1   5.760380 4.892783  5.448924 3.485413 3.855669 8.662081 8.793320\nCMPK2   9.561905 4.549168  3.998655 5.614384 3.904793 9.790770 7.133188\nSTOX2   8.396409 8.717055  8.039064 7.643060 9.274649 4.417013 4.725270\nPADI2   8.419766 8.268430  8.451181 9.200732 8.598207 4.590033 5.368268\nSCARNA5 7.653074 5.780393 10.633550 5.913684 8.805605 5.890120 5.527945\n              M8       M9      M10\nGBP4    7.658312 8.666038 7.419708\nBCAT1   8.765915 8.097206 8.262942\nCMPK2   7.379591 7.938063 6.154118\nSTOX2   3.542217 4.305187 6.964710\nPADI2   4.136667 4.910986 4.080363\nSCARNA5 3.822596 4.041078 7.956589",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/086-heatmap.html#可视化",
    "href": "Hiplot/086-heatmap.html#可视化",
    "title": "热图",
    "section": "可视化",
    "text": "可视化\n\n# 热图\n## 设置annotation_col和annotation_row，分别对样本和基因添加附注\ntop_var &lt;- 100\ntop_var_genes &lt;- rownames(data)[head(\n  order(genefilter::rowVars(data), decreasing = TRUE),\n  nrow(data) * top_var / 100\n)]\n## 设置annotation_colors\ncol &lt;- colorRampPalette(c(\"#0060BF\",\"#FFFFFF\",\"#CA1111\"))(50)\nannotation_colors &lt;- list()\nfor(i in colnames(sample_info_reorder)) {\n  if (is.numeric(sample_info_reorder[,i])) {\n    annotation_colors[[i]] &lt;- col\n  } else {\n    ref &lt;- c(\"#323232\",\"#1B6393\")\n    annotation_colors[[i]] &lt;- ref\n    names(annotation_colors[[i]]) &lt;- unique(sample_info_reorder[,i])\n  }\n}\nfor(i in colnames(gene_info_reorder)) {\n  if (is.numeric(gene_info_reorder[,i])) {\n    annotation_colors[[i]] &lt;- col\n  } else {\n    ref &lt;- c(\"#323232\",\"#1B6393\")\n    annotation_colors[[i]] &lt;- ref\n    names(annotation_colors[[i]]) &lt;- unique(gene_info_reorder[,i])\n  }\n}\n\np &lt;- \n  ComplexHeatmap::pheatmap(\n    data[row.names(data) %in% top_var_genes,],\n    color = col, \n    border_color = NA,\n    fontsize_row = 6, fontsize_col = 6,\n    main = \"Heatmap Plot\",\n    cluster_rows = T, cluster_cols = T,\n    scale = \"none\",\n    clustering_method = \"ward.D2\",\n    clustering_distance_cols = \"euclidean\",\n    clustering_distance_rows = \"euclidean\",\n    fontfamily = \"Arial\",\n    display_numbers = F,\n    number_color = \"black\",\n    annotation_col = sample_info_reorder,\n    annotation_row = gene_info_reorder,\n    annotation_colors = annotation_colors\n  )\n\np\n\n\n\n\n\n\n\n图 1: 热图\n\n\n\n\n\n示例图每个小格表示每个基因，颜色深浅表示该基因表达量大小，表达量越大颜色越深（红色为上调，绿色为下调）。每行表示每个基因在不同样本中的表达量状况，每列表示每个样本所有基因的表达量情况。上方树形图表示不同组群和年龄的不同样本的聚类分析结果，左侧树形图表示来自不同样本的不同基因的聚类分析结果。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/177-upset-plot.html",
    "href": "Hiplot/177-upset-plot.html",
    "title": "Upset 图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Upset Plot 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/upset-plot?lang=zh_cn\nUpset 可用于展示集合之间的交互关系。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Upset Plot"
    ]
  },
  {
    "objectID": "Hiplot/177-upset-plot.html#环境配置",
    "href": "Hiplot/177-upset-plot.html#环境配置",
    "title": "Upset 图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; VennDiagram; ComplexHeatmap; ggplotify; ggplot2\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"VennDiagram\", quietly = TRUE)) {\n  install.packages(\"VennDiagram\")\n}\nif (!requireNamespace(\"ComplexHeatmap\", quietly = TRUE)) {\n  BiocManager::install(\"ComplexHeatmap\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(VennDiagram)\nlibrary(ComplexHeatmap)\nlibrary(ggplotify)\nlibrary(ggplot2)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package        * version date (UTC) lib source\n ComplexHeatmap * 2.26.0  2025-10-29 [1] Bioconduc~\n data.table     * 1.17.8  2025-07-10 [1] RSPM\n futile.logger  * 1.4.3   2016-07-10 [1] RSPM\n ggplot2        * 4.0.1   2025-11-14 [1] RSPM\n ggplotify      * 0.1.3   2025-09-20 [1] RSPM\n jsonlite       * 2.0.0   2025-03-27 [1] RSPM\n VennDiagram    * 1.7.3   2022-04-12 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Upset Plot"
    ]
  },
  {
    "objectID": "Hiplot/177-upset-plot.html#数据准备",
    "href": "Hiplot/177-upset-plot.html#数据准备",
    "title": "Upset 图",
    "section": "数据准备",
    "text": "数据准备\n数据表可输入两种类型：list 和 binary。其中 list 格式为每列为一个集合，并包含所有集合对应的元素。binary 格式第一列为全部集合的全部元素，后续列为 0 和 1 组成的数值矩阵，1 则表明对应行元素存在于某个集合，0 则表示不存在。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/upset-plot/data.json\")$exampleData[[1]]$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\nfor (i in seq_len(ncol(data))) {\n  data[is.na(data[, i]), i] &lt;- \"\"\n}\ndata2 &lt;- as.list(data)\ndata2 &lt;- lapply(data2, function(x) {x[x != \"\"]})\ndata2 &lt;- list_to_matrix(data2)\nm = make_comb_mat(data2, mode = \"distinct\")\nss = set_size(m)\ncs = comb_size(m)\nset_order &lt;- order(ss)\ncomb_order &lt;- order(comb_degree(m), -cs)\n\n# 查看数据\nhead(data)\n\n     Set1      Set2     Set3      Set4    Set5      Set6    Set7     Set8\n1   ISG15      HES5     DVL1   MATP6P1 FAM132A   FAM132A FAM132A  TNFRSF4\n2  TTLL10  AURKAIP1 ARHGEF16   MIR551A    AGRN   MIR551A WBP1LP6   WASH7P\n3    HES4 LINC00982   OR4F16  C1orf222 WBP1LP6   MIR200B   PANK4   TMEM52\n4  OR4G4P    FAM87B      SKI   MIR200B  KLHL17    ATAD3C  OR4G4P   MMP23B\n5 MND2P28       SKI   WASH7P LINC00115  FAM41C   ANKRD65   SSU72   CDK11B\n6  FAM87B     GABRD    MEGF6    ATAD3B   PANK4 LINC01128 MND2P28 C1orf170",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Upset Plot"
    ]
  },
  {
    "objectID": "Hiplot/177-upset-plot.html#可视化",
    "href": "Hiplot/177-upset-plot.html#可视化",
    "title": "Upset 图",
    "section": "可视化",
    "text": "可视化\n\n# Upset 图\np &lt;- as.ggplot(function(){\n  top_annotation &lt;- HeatmapAnnotation(\n    Intersections = anno_barplot(\n      cs, ylim = c(0, max(cs)*1.1), \n      border = FALSE, \n      gp = gpar(fill = \"#000000\", fontsize = 10), \n      height = unit(5, \"cm\")\n    ), \n    annotation_name_side = \"left\", \n    annotation_name_rot = 90\n  )\n  \n  left_annotation &lt;- rowAnnotation(\n    Numbers = anno_barplot(-ss, axis_param = list(\n      at = seq(-max(ss), 0, round(max(ss)/5)),\n      labels = rev(seq(0, max(ss), round(max(ss)/5))),\n      labels_rot = 0),\n      baseline = 0,\n      border = FALSE, \n      gp = gpar(fill = \"#000000\", fontsize = 10), \n      width = unit(4, \"cm\")\n    ),\n    set_name = anno_text(set_name(m), location = 0.5,  just = \"center\",\n                         width = max_text_width(set_name(m)) + unit(5, \"mm\"))\n  )\n  \n  ht = UpSet(m, comb_col = \"#000000\", bg_col = \"#F0F0F0\", bg_pt_col = \"#CCCCCC\",\n             pt_size = unit(3, \"mm\"), lwd = 2, set_order = set_order,\n             comb_order = comb_order, top_annotation = top_annotation,\n             left_annotation = left_annotation,  right_annotation = NULL,\n             show_row_names = FALSE)\n  ht = draw(ht)\n  od = column_order(ht)\n  decorate_annotation(\"Intersections\", {\n    grid.text(cs[od], x = seq_along(cs), y = unit(cs[od], \"native\") + unit(2, \"pt\"),\n              default.units = \"native\", just = c(\"left\", \"bottom\"), \n              gp = gpar(fontsize = 10, col = \"#000000\",\n              fontfamily = \"Arial\"), hjust = 0.5)\n  })\n})\np &lt;- p + ggtitle(\"Upset Plot\") + \n  theme(plot.title = element_text(hjust = 0.6))\n\np\n\n\n\n\n\n\n\n图 1: Upset 图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Upset Plot"
    ]
  },
  {
    "objectID": "Hiplot/138-pie-3d.html",
    "href": "Hiplot/138-pie-3d.html",
    "title": "三维饼图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot 3D Pie 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/pie-3d?lang=zh_cn\n三维饼图是指具有三维外观的饼图。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "PCAtools"
    ]
  },
  {
    "objectID": "Hiplot/138-pie-3d.html#环境配置",
    "href": "Hiplot/138-pie-3d.html#环境配置",
    "title": "三维饼图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; plotrix; ggplotify\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"plotrix\", quietly = TRUE)) {\n  install.packages(\"plotrix\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(plotrix)\nlibrary(ggplotify)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplotify  * 0.1.3   2025-09-20 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n plotrix    * 3.8-13  2025-11-15 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "PCAtools"
    ]
  },
  {
    "objectID": "Hiplot/138-pie-3d.html#数据准备",
    "href": "Hiplot/138-pie-3d.html#数据准备",
    "title": "三维饼图",
    "section": "数据准备",
    "text": "数据准备\n载入数据为一个矩阵。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/pie-3d/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ncolnames(data) &lt;- c(\"Group\", \"Value\")\ndata$Value &lt;- as.numeric(data$Value)\ndata &lt;- data[data$Value != 0,]\n\n# 查看数据\nhead(data)\n\n   Group Value\n1 Group1    13\n2 Group2    34\n3 Group3    21\n4 Group4    43",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "PCAtools"
    ]
  },
  {
    "objectID": "Hiplot/138-pie-3d.html#可视化",
    "href": "Hiplot/138-pie-3d.html#可视化",
    "title": "三维饼图",
    "section": "可视化",
    "text": "可视化\n\n# 三维饼图\npie3D(data$Value, radius = 0.8, height = 0.05, theta = 0.8,\n      labels = paste(data$Group, \"\\n(n=\", data$Value, \", \",\n                     round(data$Value / sum(data$Value) * 100, 2), \"%)\",\n                     sep = \"\"),\n      explode = 0.1, main = \"\", labelcex = 1, shade = 0.4, labelcol = \"black\",\n      col = c(\"#E64B35FF\",\"#4DBBD5FF\",\"#00A087FF\",\"#3C5488FF\"))\n\n\n\n\n\n\n\n图 1: 三维饼图\n\n\n\n\n\n该图通过三维形式，更美观的展示了 1 ~ 4 组的样本数量及样本数量所对应的占比。一组样本数量 13，占比 11.71%，二组样本数量 34，占比30.63%，三组样本数量 21，占比 18.92%，四组样本数量 43，占比 38.74%。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "PCAtools"
    ]
  },
  {
    "objectID": "Hiplot/125-multiple-histograms.html",
    "href": "Hiplot/125-multiple-histograms.html",
    "title": "多直方图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Multiple Histograms 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/multiple-histograms?lang=zh_cn\n将多个直方图绘制在同一图像上，可对比多组数据之间的差异。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Multiple Histograms"
    ]
  },
  {
    "objectID": "Hiplot/125-multiple-histograms.html#环境配置",
    "href": "Hiplot/125-multiple-histograms.html#环境配置",
    "title": "多直方图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Multiple Histograms"
    ]
  },
  {
    "objectID": "Hiplot/125-multiple-histograms.html#数据准备",
    "href": "Hiplot/125-multiple-histograms.html#数据准备",
    "title": "多直方图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/multiple-histograms/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 查看数据\nhead(data)\n\n  type    value\n1   v1 3.059937\n2   v1 1.907186\n3   v1 4.278629\n4   v1 3.834794\n5   v1 5.493830\n6   v1 1.380032",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Multiple Histograms"
    ]
  },
  {
    "objectID": "Hiplot/125-multiple-histograms.html#可视化",
    "href": "Hiplot/125-multiple-histograms.html#可视化",
    "title": "多直方图",
    "section": "可视化",
    "text": "可视化\n\n# 多直方图\np &lt;- ggplot(data, aes(x = value, fill = type)) +\n  geom_histogram(color = \"black\", alpha = 0.5, \n                 position = \"identity\", binwidth = 0.3) +\n  scale_fill_manual(values = c(\"#BC3C29FF\",\"#0072B5FF\")) +\n  theme_bw()\n\np\n\n\n\n\n\n\n\n图 1: 多直方图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Multiple Histograms"
    ]
  },
  {
    "objectID": "Hiplot/050-easy-som.html",
    "href": "Hiplot/050-easy-som.html",
    "title": "简易 SOM",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Easy SOM 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/easy-som?lang=zh_cn\n建立 SOM 模型，并可视化结果。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Easy SOM"
    ]
  },
  {
    "objectID": "Hiplot/050-easy-som.html#环境配置",
    "href": "Hiplot/050-easy-som.html#环境配置",
    "title": "简易 SOM",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; GGally\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"kohonen\", quietly = TRUE)) {\n  install.packages(\"kohonen\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(kohonen)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n kohonen    * 3.0.12  2023-06-09 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Easy SOM"
    ]
  },
  {
    "objectID": "Hiplot/050-easy-som.html#数据准备",
    "href": "Hiplot/050-easy-som.html#数据准备",
    "title": "简易 SOM",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/easy-som/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ntarget &lt;- data[,1]\ntarget &lt;- factor(target, levels = unique(target))\ndata &lt;- data[,-1]\ndata &lt;- as.data.frame(data)\nfor (i in 1:ncol(data)) {\n  data[,i] &lt;- as.numeric(data[,i])\n}\ndata &lt;- as.matrix(data)\nset.seed(7)\nkohmap &lt;- xyf(scale(data), target, grid = somgrid(xdim=6, ydim=4, topo=\"hexagonal\"), rlen=100)\n\ncolor_key &lt;- c(\"#A50026\",\"#D73027\",\"#F46D43\",\"#FDAE61\",\"#FEE090\",\"#FFFFBF\",\"#E0F3F8\",\n               \"#ABD9E9\",\"#74ADD1\",\"#4575B4\",\"#313695\")\ncolors &lt;- function (n, alpha, rev = FALSE) {\n  colorRampPalette(color_key)(n)\n}\n\n# 查看数据\nhead(data)\n\n     alcohol malic acid  ash ash alkalinity magnesium tot. phenols flavonoids\n[1,]   12.86       1.35 2.32           18.0       122         1.51       1.25\n[2,]   12.88       2.99 2.40           20.0       104         1.30       1.22\n[3,]   12.81       2.31 2.40           24.0        98         1.15       1.09\n[4,]   12.70       3.55 2.36           21.5       106         1.70       1.20\n[5,]   12.51       1.24 2.25           17.5        85         2.00       0.58\n[6,]   12.60       2.46 2.20           18.5        94         1.62       0.66\n     non-flav. phenols proanth col. int. col. hue OD ratio proline\n[1,]              0.21    0.94      4.10     0.76     1.29     630\n[2,]              0.24    0.83      5.40     0.74     1.42     530\n[3,]              0.27    0.83      5.70     0.66     1.36     560\n[4,]              0.17    0.84      5.00     0.78     1.29     600\n[5,]              0.60    1.25      5.45     0.75     1.51     650\n[6,]              0.63    0.94      7.10     0.73     1.58     695",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Easy SOM"
    ]
  },
  {
    "objectID": "Hiplot/050-easy-som.html#可视化",
    "href": "Hiplot/050-easy-som.html#可视化",
    "title": "简易 SOM",
    "section": "可视化",
    "text": "可视化\n\n# 简易 SOM\np &lt;- function () {\n  par(mfrow = c(3,2))\n  xyfpredictions &lt;- classmat2classvec(getCodes(kohmap, 2))\n  plot(kohmap, type=\"counts\", col = as.integer(target),\n       palette.name = colors,\n       pchs = as.integer(target), \n       main = \"Counts plot\", shape = \"straight\", border = NA)\n  \n  som.hc &lt;- cutree(hclust(object.distances(kohmap, \"codes\")), 3)\n  add.cluster.boundaries(kohmap, som.hc)\n\n  plot(kohmap, type=\"mapping\",\n       labels = as.integer(target), col = colors(3)[as.integer(target)],\n       palette.name = colors,\n       shape = \"straight\",\n       main = \"Mapping plot\")\n\n  ## 根据预测的类别标签为单元添加背景颜色\n  xyfpredictions &lt;- classmat2classvec(getCodes(kohmap, 2))\n  bgcols &lt;- colors(3)\n  plot(kohmap, type=\"mapping\", col = as.integer(target),\n       pchs = as.integer(target), bgcol = bgcols[as.integer(xyfpredictions)],\n       main = \"Another mapping plot\", shape = \"straight\", border = NA)\n  \n  similarities &lt;- plot(kohmap, type=\"quality\", shape = \"straight\",\n                       palette.name = colors)\n  \n  plot(kohmap, type=\"codes\", shape = \"straight\", \n       main = c(\"Codes X\", \"Codes Y\"), palette.name = colors)\n}\n\np()\n\n\n\n\n\n\n\n图 1: 简易 SOM",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Easy SOM"
    ]
  },
  {
    "objectID": "Hiplot/057-funnel-plot-metafor.html",
    "href": "Hiplot/057-funnel-plot-metafor.html",
    "title": "漏斗图 (metafor)",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Funnel Plot (metafor) 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/funnel-plot-metafor?lang=zh_cn\n可以用于分析 Meta 分析结果中潜在偏倚因子。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Funnel Plot (metafor)"
    ]
  },
  {
    "objectID": "Hiplot/057-funnel-plot-metafor.html#环境配置",
    "href": "Hiplot/057-funnel-plot-metafor.html#环境配置",
    "title": "漏斗图 (metafor)",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; metafor; ggplotify\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"metafor\", quietly = TRUE)) {\n  install.packages(\"metafor\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(metafor)\nlibrary(ggplotify)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version    date (UTC) lib source\n data.table * 1.17.8     2025-07-10 [1] RSPM\n ggplotify  * 0.1.3      2025-09-20 [1] RSPM\n jsonlite   * 2.0.0      2025-03-27 [1] RSPM\n Matrix     * 1.7-4      2025-08-28 [3] CRAN (R 4.5.2)\n metadat    * 1.4-0      2025-02-04 [1] RSPM\n metafor    * 4.8-0      2025-01-28 [1] RSPM\n numDeriv   * 2016.8-1.1 2019-06-06 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Funnel Plot (metafor)"
    ]
  },
  {
    "objectID": "Hiplot/057-funnel-plot-metafor.html#数据准备",
    "href": "Hiplot/057-funnel-plot-metafor.html#数据准备",
    "title": "漏斗图 (metafor)",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/funnel-plot-metafor/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndata2 &lt;- escalc(ri=ri, ni=ni, data = data, measure=\"ZCOR\")\nres &lt;- rma(yi, vi, data = data2)\n\n# 查看数据\nhead(data)\n\n              authors year  ni    ri controls          design   a_measure\n1     Axelsson et al. 2009 109 0.187     none cross-sectional self-report\n2     Axelsson et al. 2011 749 0.162     none cross-sectional self-report\n3        Bruce et al. 2010  55 0.340     none     prospective       other\n4  Christensen et al. 1999 107 0.320     none cross-sectional self-report\n5 Christensen & Smith 1995  72 0.270     none     prospective       other\n6        Cohen et al. 2004  65 0.000     none     prospective       other\n  c_measure meanage quality\n1     other   22.00       1\n2       NEO   53.59       1\n3       NEO   43.36       2\n4     other   41.70       1\n5       NEO   46.39       2\n6       NEO   41.20       2",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Funnel Plot (metafor)"
    ]
  },
  {
    "objectID": "Hiplot/057-funnel-plot-metafor.html#可视化",
    "href": "Hiplot/057-funnel-plot-metafor.html#可视化",
    "title": "漏斗图 (metafor)",
    "section": "可视化",
    "text": "可视化\n\n# 漏斗图\np &lt;- as.ggplot(function(){\n  funnel(x = res, main = \"Funnel Plot (metafor)\",\n         level = c(90, 95, 99), shade = c(\"white\",\"#a90e07\",\"#d23e0b\"), refline = 0)\n  })\n\np\n\n\n\n\n\n\n\n图 1: 漏斗图",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Funnel Plot (metafor)"
    ]
  },
  {
    "objectID": "Hiplot/136-pcatools.html",
    "href": "Hiplot/136-pcatools.html",
    "title": "主成分分析 (PCAtools)",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot PCAtools 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/pcatools?lang=zh_cn\nPCAtools 可以通过主成分分析对数据进行降维，并在二维水平查看主成分相关特征。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "PCAtools"
    ]
  },
  {
    "objectID": "Hiplot/136-pcatools.html#环境配置",
    "href": "Hiplot/136-pcatools.html#环境配置",
    "title": "主成分分析 (PCAtools)",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; PCAtools; ggplotify; cowplot\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"PCAtools\", quietly = TRUE)) {\n  install.packages('PCAtools', repos = c('https://bioc.r-universe.dev', 'https://cloud.r-project.org'))\n\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\nif (!requireNamespace(\"cowplot\", quietly = TRUE)) {\n  install.packages(\"cowplot\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(PCAtools)\nlibrary(ggplotify)\nlibrary(cowplot)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n cowplot    * 1.2.0   2025-07-07 [1] RSPM\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n ggplotify  * 0.1.3   2025-09-20 [1] RSPM\n ggrepel    * 0.9.6   2024-09-07 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n PCAtools   * 2.21.0  2025-04-15 [1] https://bioc.r-universe.dev (R 4.5.2)\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "PCAtools"
    ]
  },
  {
    "objectID": "Hiplot/136-pcatools.html#数据准备",
    "href": "Hiplot/136-pcatools.html#数据准备",
    "title": "主成分分析 (PCAtools)",
    "section": "数据准备",
    "text": "数据准备\n\n数据表格 1（数值矩阵）：\n\n每一列为一个样本，每一行为一个特征（如基因、芯片探针）。\n\n数据表格 2 （样本信息）：\n\n第一列为样本名，其他列为该样本的表型特征，可用于标注点的颜色和形状，并与主成分进行相关性分析。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/pcatools/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\ndata2 &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/pcatools/data.json\")$exampleData$textarea[[2]])\ndata2 &lt;- as.data.frame(data2)\n\n# 查看数据\nhead(data[,1:5])\n\n       Probes GSM65752 GSM65753 GSM65755 GSM65757\n1   220050_at 6.566843 5.902831 5.185271 5.474453\n2 213944_x_at 8.722271 9.088407 9.106401 8.900869\n3   215441_at 3.812778 3.852745 3.846690 3.842543\n4 214792_x_at 6.499815 6.731196 5.951202 6.578830\n5 217251_x_at 6.607354 6.555413 6.715821 6.628053\n6   207406_at 3.997302 3.964112 3.836560 3.833057\n\nhead(data2[,1:5])\n\n  Samplename    Study Age Distant.RFS  ER\n1   GSM65752 GSE47561  40           0 ER-\n2   GSM65753 GSE47561  46           0 ER+\n3   GSM65755 GSE47561  41           1 ER+\n4   GSM65757 GSE47561  34           0 ER+\n5   GSM65758 GSE47561  46           1 ER+\n6   GSM65760 GSE47561  57           1 ER+",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "PCAtools"
    ]
  },
  {
    "objectID": "Hiplot/136-pcatools.html#可视化",
    "href": "Hiplot/136-pcatools.html#可视化",
    "title": "主成分分析 (PCAtools)",
    "section": "可视化",
    "text": "可视化\n\n# 主成分分析 (PCAtools)\n## 定义绘图函数\ncall_pcatools &lt;- function(datTable, sampleInfo,\n                          top_var,\n                          screeplotComponents, screeplotColBar,\n                          pairsplotComponents,\n                          biplotShapeBy, biplotColBy,\n                          plotloadingsComponents,\n                          plotloadingsLowCol,\n                          plotloadingsMidCol,\n                          plotloadingsHighCol,\n                          eigencorplotMetavars,\n                          eigencorplotComponents) {\n  row.names(datTable) &lt;- datTable[, 1]\n  datTable &lt;- datTable[, -1]\n  row.names(sampleInfo) &lt;- sampleInfo[, 1]\n  data3 &lt;&lt;- pca(datTable, metadata = sampleInfo, removeVar = (100 - top_var) / 100)\n\n  for (i in c(\"screeplotComponents\", \"pairsplotComponents\",\n              \"plotloadingsComponents\", \"eigencorplotComponents\")) {\n    if (ncol(data3$rotated) &lt; get(i)) {\n      assign(i, ncol(data3$rotated))\n    }\n  }\n\n  p1 &lt;- PCAtools::screeplot(\n    data3,\n    components = getComponents(data3, 1:screeplotComponents),\n    axisLabSize = 14, titleLabSize = 20,\n    colBar = screeplotColBar,\n    gridlines.major = FALSE, gridlines.minor = FALSE,\n    returnPlot = TRUE\n  )\n\n  params_pairsplot &lt;- list(\n    data3,\n    components = getComponents(data3, c(1:pairsplotComponents)),\n    triangle = TRUE, trianglelabSize = 12,\n    hline = 0, vline = 0,\n    pointSize = 0.8, gridlines.major = FALSE, gridlines.minor = FALSE,\n    title = \"\", plotaxes = FALSE,\n    margingaps = unit(c(0.01, 0.01, 0.01, 0.01), \"cm\"),\n    returnPlot = TRUE,\n    colkey = c(\"#00468BFF\",\"#ED0000FF\"),\n    legendPosition = \"none\"\n  )\n  params_biplot &lt;- list(data3,\n    showLoadings = TRUE,\n    lengthLoadingsArrowsFactor = 1.5,\n    sizeLoadingsNames = 4,\n    colLoadingsNames = \"red4\",\n    # other parameters\n    lab = NULL,\n    hline = 0, vline = c(-25, 0, 25),\n    vlineType = c(\"dotdash\", \"solid\", \"dashed\"),\n    gridlines.major = FALSE, gridlines.minor = FALSE,\n    pointSize = 5,\n    legendLabSize = 16, legendIconSize = 8.0,\n    drawConnectors = FALSE,\n    title = \"PCA bi-plot\",\n    subtitle = \"PC1 versus PC2\",\n    caption = \"27 PCs ≈ 80%\",\n    returnPlot = TRUE,\n    legendPosition = \"bottom\"\n  )\n  if (!is.null(biplotShapeBy) && biplotShapeBy != \"\") {\n    params_biplot$shape &lt;- biplotShapeBy\n    params_pairsplot$shape &lt;- biplotShapeBy\n    t &lt;- params_biplot[[1]]$metadata[,biplotShapeBy]\n    params_biplot[[1]]$metadata[,biplotShapeBy] &lt;- factor(t,\n      levels = t[!duplicated(t)]\n    )\n    params_pairsplot[[1]]$metadata[,biplotShapeBy] &lt;- factor(t,\n      levels = t[!duplicated(t)]\n    )\n  }\n  if (!is.null(biplotColBy) && biplotColBy != \"\") {\n    params_pairsplot$colby &lt;- biplotColBy\n    params_pairsplot$colkey &lt;- c(\"#00468BFF\",\"#ED0000FF\")\n    params_biplot$colby &lt;- biplotColBy\n    params_biplot$colkey &lt;- c(\"#00468BFF\",\"#ED0000FF\")\n    t1 &lt;- params_biplot[[1]]$metadata[,biplotColBy]\n    params_biplot[[1]]$metadata[,biplotColBy] &lt;- factor(t1,\n      levels = t1[!duplicated(t1)]\n    )\n    params_pairsplot[[1]]$metadata[,biplotColBy] &lt;- factor(t1,\n      levels = t1[!duplicated(t1)]\n    )\n  }\n\n  p2 &lt;- do.call(PCAtools::pairsplot, params_pairsplot)\n  p3 &lt;- do.call(PCAtools::biplot, params_biplot)\n\n  p4 &lt;- PCAtools::plotloadings(\n    data3,\n    rangeRetain = 0.01, labSize = 4,\n    components = getComponents(data3, c(1:plotloadingsComponents)),\n    title = \"Loadings plot\", axisLabSize = 12,\n    subtitle = \"PC1, PC2, PC3, PC4, PC5\",\n    caption = \"Top 1% variables\",\n    gridlines.major = FALSE, gridlines.minor = FALSE,\n    shape = 24, shapeSizeRange = c(4, 8),\n    col = c(plotloadingsLowCol, plotloadingsMidCol, plotloadingsHighCol),\n    legendPosition = \"none\",\n    drawConnectors = FALSE,\n    returnPlot = TRUE\n  )\n\n  if (length(eigencorplotMetavars) &gt; 0 && all(eigencorplotMetavars != \"\")) {\n    metavars &lt;- eigencorplotMetavars\n  } else {\n    metavars &lt;- colnames(sampleInfo)[2:ncol(sampleInfo)]\n  }\n  if (length(metavars) == 1 && metavars != colnames(sampleInfo)[1]) {\n    metavars &lt;- c(colnames(sampleInfo)[1], metavars)\n  } else if (length(metavars) == 1 && metavars == colnames(sampleInfo)[1]) {\n    stop('eigencorplotMetavars need &gt;= 2 feature')\n  }\n\n  p5 &lt;- PCAtools::eigencorplot(\n    data3,\n    components = getComponents(data3, 1:eigencorplotComponents),\n    metavars = metavars,\n    cexCorval = 1.0,\n    fontCorval = 2,\n    posLab = \"all\",\n    rotLabX = 45,\n    scale = TRUE,\n    main = \"PC clinical correlates\",\n    cexMain = 1.5,\n    plotRsquared = FALSE,\n    corFUN = \"pearson\",\n    corUSE = \"na.or.complete\",\n    signifSymbols = c(\"****\", \"***\", \"**\", \"*\", \"\"),\n    signifCutpoints = c(0, 0.0001, 0.001, 0.01, 0.05, 1),\n    returnPlot = TRUE\n  )\n\n  p6 &lt;- plot_grid(\n    p1, p2, p3,\n    ncol = 3,\n    labels = c(\"A\", \"B  Pairs plot\", \"C\"),\n    label_fontfamily = \"Arial\",\n    label_fontface = \"bold\",\n    label_size = 22,\n    align = \"h\",\n    rel_widths = c(1.10, 0.80, 1.10)\n  )\n\n  p7 &lt;- plot_grid(\n    p4,\n    as.grob(p5),\n    ncol = 2,\n    labels = c(\"D\", \"E\"),\n    label_fontfamily = \"Arial\",\n    label_fontface = \"bold\",\n    label_size = 22,\n    align = \"h\",\n    rel_widths = c(0.8, 1.2)\n  )\n\n  p &lt;- plot_grid(\n    p6, p7,\n    ncol = 1,\n    rel_heights = c(1.1, 0.9)\n  )\n\n  return(p)\n}\n\n## 绘图\np &lt;- call_pcatools(\n  datTable = data,\n  sampleInfo = data2,\n  biplotColBy = \"ER\",\n  biplotShapeBy = \"Grade\",\n  eigencorplotMetavars = colnames(data2)[-1],\n  screeplotComponents = 30,\n  pairsplotComponents = 3,\n  plotloadingsComponents = 5,\n  eigencorplotComponents = 10,\n  top_var = 90,\n  screeplotColBar = \"#0085FF\",\n  plotloadingsLowCol = \"#0085FF\",\n  plotloadingsMidCol = \"#FFFFFF\",\n  plotloadingsHighCol = \"#FF0000\"\n)\n\np\n\n\n\n\n\n\n\n图 1: 主成分分析 (PCAtools)",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "PCAtools"
    ]
  },
  {
    "objectID": "Hiplot/065-ggdag.html",
    "href": "Hiplot/065-ggdag.html",
    "title": "有向无环图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Directed Acyclic Graphs 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/ggdag?lang=zh_cn\n有向无环图可视化。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Directed Acyclic Graphs"
    ]
  },
  {
    "objectID": "Hiplot/065-ggdag.html#环境配置",
    "href": "Hiplot/065-ggdag.html#环境配置",
    "title": "有向无环图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: ggdag\n\n\n# 安装包\nif (!requireNamespace(\"ggdag\", quietly = TRUE)) {\n  install.packages(\"ggdag\")\n}\n\n# 加载包\nlibrary(ggdag)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package * version date (UTC) lib source\n ggdag   * 0.2.13  2024-07-22 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Directed Acyclic Graphs"
    ]
  },
  {
    "objectID": "Hiplot/065-ggdag.html#数据准备",
    "href": "Hiplot/065-ggdag.html#数据准备",
    "title": "有向无环图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ntidy_ggdag &lt;- dagify(\n  y ~ x + z2 + w2 + w1,\n  x ~ z1 + w1 + w2,\n  z1 ~ w1 + v,\n  z2 ~ w2 + v,\n  w1 ~ ~w2, # bidirected path\n  exposure = \"x\",\n  outcome = \"y\") %&gt;%\n  tidy_dagitty()\n\n# 查看数据\nhead(tidy_ggdag)\n\n$data\n# A tibble: 13 × 8\n   name       x       y direction to      xend   yend circular\n   &lt;chr&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;fct&gt;     &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;lgl&gt;   \n 1 v     -1.49   0.0196 -&gt;        z1    -0.505  1.02  FALSE   \n 2 v     -1.49   0.0196 -&gt;        z2    -0.507 -0.999 FALSE   \n 3 w1     0.301  0.429  -&gt;        x      0.918  0.604 FALSE   \n 4 w1     0.301  0.429  -&gt;        y      0.334 -0.522 FALSE   \n 5 w1     0.301  0.429  -&gt;        z1    -0.505  1.02  FALSE   \n 6 w1     0.301  0.429  &lt;-&gt;       w2     0.953 -0.553 FALSE   \n 7 w2     0.953 -0.553  -&gt;        x      0.918  0.604 FALSE   \n 8 w2     0.953 -0.553  -&gt;        y      0.334 -0.522 FALSE   \n 9 w2     0.953 -0.553  -&gt;        z2    -0.507 -0.999 FALSE   \n10 x      0.918  0.604  -&gt;        y      0.334 -0.522 FALSE   \n11 y      0.334 -0.522  &lt;NA&gt;      &lt;NA&gt;  NA     NA     FALSE   \n12 z1    -0.505  1.02   -&gt;        x      0.918  0.604 FALSE   \n13 z2    -0.507 -0.999  -&gt;        y      0.334 -0.522 FALSE   \n\n$dag\ndag {\nv\nw1\nw2\nx [exposure]\ny [outcome]\nz1\nz2\nv -&gt; z1\nv -&gt; z2\nw1 -&gt; x\nw1 -&gt; y\nw1 -&gt; z1\nw1 &lt;-&gt; w2\nw2 -&gt; x\nw2 -&gt; y\nw2 -&gt; z2\nx -&gt; y\nz1 -&gt; x\nz2 -&gt; y\n}",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Directed Acyclic Graphs"
    ]
  },
  {
    "objectID": "Hiplot/065-ggdag.html#可视化",
    "href": "Hiplot/065-ggdag.html#可视化",
    "title": "有向无环图",
    "section": "可视化",
    "text": "可视化\n\n# 有向无环图\np &lt;- ggdag(tidy_ggdag) +\n  theme_dag() \n\np\n\n\n\n\n\n\n\n图 1: 有向无环图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Directed Acyclic Graphs"
    ]
  },
  {
    "objectID": "Hiplot/153-ribbon.html",
    "href": "Hiplot/153-ribbon.html",
    "title": "丝带图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Ribbon 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/ribbon?lang=zh_cn\n丝带图是一种类似丝带的图形。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Ribbon"
    ]
  },
  {
    "objectID": "Hiplot/153-ribbon.html#环境配置",
    "href": "Hiplot/153-ribbon.html#环境配置",
    "title": "丝带图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2; ggthemes\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"ggthemes\", quietly = TRUE)) {\n  install.packages(\"ggthemes\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(ggthemes)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n ggthemes   * 5.2.0   2025-11-30 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Ribbon"
    ]
  },
  {
    "objectID": "Hiplot/153-ribbon.html#数据准备",
    "href": "Hiplot/153-ribbon.html#数据准备",
    "title": "丝带图",
    "section": "数据准备",
    "text": "数据准备\n载入数据为 x 轴数值及其对应的两个 y 轴数值和分组。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/ribbon/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ncolnames(data) &lt;- c(\"group\", \"xvalue\", \"yvalue1\", \"yvalue2\")\ndata$yvalue &lt;- (data$yvalue1 + data$yvalue2) / 2\n\n# 查看数据\nhead(data)\n\n   group xvalue yvalue1 yvalue2 yvalue\n1 Group1   1900  -0.279  -0.063 -0.171\n2 Group1   1901  -0.271  -0.053 -0.162\n3 Group1   1902  -0.285  -0.069 -0.177\n4 Group1   1903  -0.303  -0.095 -0.199\n5 Group1   1904  -0.328  -0.118 -0.223\n6 Group1   1905  -0.348  -0.134 -0.241",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Ribbon"
    ]
  },
  {
    "objectID": "Hiplot/153-ribbon.html#可视化",
    "href": "Hiplot/153-ribbon.html#可视化",
    "title": "丝带图",
    "section": "可视化",
    "text": "可视化\n\n# 丝带图\np &lt;- ggplot(data, aes(xvalue, yvalue, fill = group)) +\n  geom_ribbon(alpha = 0.2, aes(ymin = yvalue1, ymax = yvalue2)) +\n  geom_line(aes(y = yvalue, color = group), lwd = 1) +\n  geom_line(aes(y = yvalue1, color = group), linetype = \"dotted\") +\n  geom_line(aes(y = yvalue2, color = group), linetype = \"dotted\") +\n  ylab(\"y axis value\") +\n  xlab(\"x axis value\") +\n  ggtitle(\"Ribbon Plot\") +\n  scale_fill_manual(values = c(\"#e04d39\",\"#5bbad6\")) +\n  scale_color_manual(values = c(\"#e04d39\",\"#5bbad6\")) +\n  theme_stata() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n \np\n\n\n\n\n\n\n\n图 1: 丝带图\n\n\n\n\n\n每种颜色表示不同的分组，可以透过其中折线，观测每组数据随时间的变化。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Ribbon"
    ]
  },
  {
    "objectID": "Hiplot/172-treeheatr.html",
    "href": "Hiplot/172-treeheatr.html",
    "title": "热图决策树",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Treeheatr 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/treeheatr?lang=zh_cn\n热图决策图是一种拼接热图和决策树可视化即决策图两种图形的一种可视化图形。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Treeheatr"
    ]
  },
  {
    "objectID": "Hiplot/172-treeheatr.html#环境配置",
    "href": "Hiplot/172-treeheatr.html#环境配置",
    "title": "热图决策树",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; treeheatr; ggplotify\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"treeheatr\", quietly = TRUE)) {\n  install.packages(\"treeheatr\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(treeheatr)\nlibrary(ggplotify)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplotify  * 0.1.3   2025-09-20 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n treeheatr  * 0.2.1   2020-11-19 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Treeheatr"
    ]
  },
  {
    "objectID": "Hiplot/172-treeheatr.html#数据准备",
    "href": "Hiplot/172-treeheatr.html#数据准备",
    "title": "热图决策树",
    "section": "数据准备",
    "text": "数据准备\n第一列为物种种类名称，第二列为岛屿，其余列为物种特征。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/treeheatr/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\nx &lt;- data\nwrong_cols &lt;- suppressWarnings(sapply(x, function(x) {\n  if (!is.numeric(x)) {\n    sum(!is.na(as.numeric(x))) &gt; 0.7 * length(x)\n  } else {\n    FALSE\n  }\n}))\nif (any(wrong_cols)) {\n  ix &lt;- which(wrong_cols)\n  for (i in ix) {\n    data[[i]] &lt;- suppressWarnings(as.numeric(data[[i]]))\n  }\n  rm(ix)\n}\nrm(x, wrong_cols)\n\n# 查看数据\nhead(data)\n\n  species    island culmen_length_mm culmen_depth_mm flipper_length_mm\n1  Adelie Torgersen             39.1            18.7               181\n2  Adelie Torgersen             39.5            17.4               186\n3  Adelie Torgersen             40.3            18.0               195\n4  Adelie Torgersen               NA              NA                NA\n5  Adelie Torgersen             36.7            19.3               193\n6  Adelie Torgersen             39.3            20.6               190\n  body_mass_g    sex\n1        3750   MALE\n2        3800 FEMALE\n3        3250 FEMALE\n4          NA   &lt;NA&gt;\n5        3450 FEMALE\n6        3650   MALE",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Treeheatr"
    ]
  },
  {
    "objectID": "Hiplot/172-treeheatr.html#可视化",
    "href": "Hiplot/172-treeheatr.html#可视化",
    "title": "热图决策树",
    "section": "可视化",
    "text": "可视化\n\n# 热图决策树\np &lt;- as.ggplot(function() {\n  print(heat_tree(data,\n    target_lab = \"species\",\n    task = 'classification',\n    show = \"heat-tree\",\n    heat_rel_height = 0.2,\n    panel_space = 0.001,\n    clust_samps = T,\n    clust_target = T,\n    lev_fac = 1.3,\n    cont_legend = F,\n    cate_legend = F\n  ))\n})\n\np\n\n\n\n\n\n\n\n图 1: 热图决策树\n\n\n\n\n\n图示上半个图为决策图，下半个图为热图。\n决策图：最上层 island 对 species 分类影响最大，根据不同条件最终可以归为不同 species。\n热图：可以观测出每个物种每种条件下量的变化。\n图例：对于每种分类变量而言，不同颜色表示不同种类；对于连续性变量而言，数值越高颜色越浅，反之，越深。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Treeheatr"
    ]
  },
  {
    "objectID": "Hiplot/041-deviation-plot.html",
    "href": "Hiplot/041-deviation-plot.html",
    "title": "偏差图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Deviation Plot 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/deviation-plot?lang=zh_cn\n偏差图可以直观地展示出数据之间的差异。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Deviation Plot"
    ]
  },
  {
    "objectID": "Hiplot/041-deviation-plot.html#环境配置",
    "href": "Hiplot/041-deviation-plot.html#环境配置",
    "title": "偏差图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggpubr\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggpubr\", quietly = TRUE)) {\n  install.packages(\"ggpubr\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggpubr)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n ggpubr     * 0.6.2   2025-10-17 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Deviation Plot"
    ]
  },
  {
    "objectID": "Hiplot/041-deviation-plot.html#数据准备",
    "href": "Hiplot/041-deviation-plot.html#数据准备",
    "title": "偏差图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/deviation-plot/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndata[[\"z_score\"]] &lt;- (data[[\"mpg\"]] - mean(data[[\"mpg\"]])) / sd(data[[\"mpg\"]])\ndata[[\"Group\"]] &lt;- factor(ifelse(data[[\"z_score\"]] &lt; 0, \"low\", \"high\"),\n                          levels = c(\"low\", \"high\")\n                          )\n\n# 查看数据\nhead(data)\n\n   mpg cyl disp  hp drat    wt  qsec vs am gear carb              name\n1 21.0   6  160 110 3.90 2.620 16.46  0  1    4    4         Mazda RX4\n2 21.0   6  160 110 3.90 2.875 17.02  0  1    4    4     Mazda RX4 Wag\n3 22.8   4  108  93 3.85 2.320 18.61  1  1    4    1        Datsun 710\n4 21.4   6  258 110 3.08 3.215 19.44  1  0    3    1    Hornet 4 Drive\n5 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2 Hornet Sportabout\n6 18.1   6  225 105 2.76 3.460 20.22  1  0    3    1           Valiant\n     z_score Group\n1  0.1508848  high\n2  0.1508848  high\n3  0.4495434  high\n4  0.2172534  high\n5 -0.2307345   low\n6 -0.3302874   low",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Deviation Plot"
    ]
  },
  {
    "objectID": "Hiplot/041-deviation-plot.html#可视化",
    "href": "Hiplot/041-deviation-plot.html#可视化",
    "title": "偏差图",
    "section": "可视化",
    "text": "可视化\n\n# 偏差图\np &lt;- ggbarplot(data,\n    x = \"name\",\n    y = \"z_score\",\n    fill = \"Group\",\n    color = \"white\",\n    sort.val = \"desc\",\n    sort.by.groups = FALSE,\n    x.text.angle = 90,\n    xlab = \"name\",\n    ylab = \"mpg\",\n    rotate = TRUE\n  ) +\n  scale_fill_manual(values = c(\"#e04d39\",\"#5bbad6\")) +\n  theme_bw() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 1: 偏差图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Deviation Plot"
    ]
  },
  {
    "objectID": "Hiplot/140-pie-matrix.html",
    "href": "Hiplot/140-pie-matrix.html",
    "title": "饼图矩阵",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Pie Matrix 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/pie-matrix?lang=zh_cn",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pie Matrix"
    ]
  },
  {
    "objectID": "Hiplot/140-pie-matrix.html#环境配置",
    "href": "Hiplot/140-pie-matrix.html#环境配置",
    "title": "饼图矩阵",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2; dplyr; tidyr; stringr\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"tidyr\", quietly = TRUE)) {\n  install.packages(\"tidyr\")\n}\nif (!requireNamespace(\"stringr\", quietly = TRUE)) {\n  install.packages(\"stringr\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(stringr)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n dplyr      * 1.1.4   2023-11-17 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n stringr    * 1.6.0   2025-11-04 [1] RSPM\n tidyr      * 1.3.2   2025-12-19 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pie Matrix"
    ]
  },
  {
    "objectID": "Hiplot/140-pie-matrix.html#数据准备",
    "href": "Hiplot/140-pie-matrix.html#数据准备",
    "title": "饼图矩阵",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/pie-matrix/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndata[,\"genre\"] &lt;- factor(data[,\"genre\"], levels = unique(data[,\"genre\"]))\ndata[,\"mpaa\"] &lt;- factor(data[,\"mpaa\"], levels = unique(data[,\"mpaa\"]))\ndata[,\"status\"] &lt;- factor(data[,\"status\"], levels = unique(data[,\"status\"]))\ncol &lt;- c(\"#E64B35FF\",\"#4DBBD5FF\")\ndf &lt;- matrix(NA, nrow = length(unique(data[,\"mpaa\"])),\n             ncol = length(unique(data[,\"genre\"])))\nrow.names(df) &lt;- unique(data[,\"mpaa\"])\ncolnames(df) &lt;- unique(data[,\"genre\"])\nfor (i in 1:nrow(df)) {\n    for (j in 1:ncol(df)) {\n      for (k in unique(data[,\"status\"])) {\n        if (is.na(df[i, j])) {\n          df[i, j] &lt;- sum(data[,\"genre\"] == unique(data[,\"genre\"])[j] &\n            data[,\"mpaa\"] == unique(data[,\"mpaa\"])[i] &\n            data[,\"status\"] == k)\n        } else {\n          df[i, j] &lt;- paste0(df[i, j], \",\", \n            sum(data[,\"genre\"] == unique(data[,\"genre\"])[j] &\n              data[,\"mpaa\"] == unique(data[,\"mpaa\"])[i] &\n              data[,\"status\"] == k))\n        }\n      }\n    }\n}\ndf &lt;- as.matrix(df)\n\n# 查看数据\nhead(data[,1:5])\n\n                                               title year length budget rating\n1                          Shawshank Redemption, The 1994    142     25    9.1\n2     Lord of the Rings: The Return of the King, The 2003    251     94    9.0\n3 Lord of the Rings: The Fellowship of the Ring, The 2001    208     93    8.8\n4             Lord of the Rings: The Two Towers, The 2002    223     94    8.8\n5                                       Pulp Fiction 1994    168      8    8.8\n6                                   Schindler's List 1993    195     25    8.8",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pie Matrix"
    ]
  },
  {
    "objectID": "Hiplot/140-pie-matrix.html#可视化",
    "href": "Hiplot/140-pie-matrix.html#可视化",
    "title": "饼图矩阵",
    "section": "可视化",
    "text": "可视化\n\n# 饼图矩阵\np &lt;- df %&gt;% as.table() %&gt;%\n  as.data.frame() %&gt;%\n  mutate(Freq = str_split(Freq,\",\")) %&gt;%\n  unnest(Freq) %&gt;%\n  mutate(Freq = as.integer(Freq)) %&gt;%\n  # 将值转换为百分比（每个图表加起来为 1）\n  group_by(Var1, Var2) %&gt;%\n  mutate(Freq = ifelse(is.na(Freq), NA, Freq / sum(Freq)),\n         color = row_number()) %&gt;%\n  ungroup() %&gt;%\n  # Plot\n  ggplot(aes(\"\", Freq, fill=factor(color, labels = unique(data[,\"status\"])))) + \n  geom_bar(width = 2, stat = \"identity\") +\n  coord_polar(\"y\") +\n  facet_wrap(~Var1+Var2, ncol = ncol(df)) +\n  scale_fill_manual(values = col) +\n  theme_void() +\n  theme(axis.text = element_blank(), axis.ticks = element_blank(),\n        panel.grid = element_blank(), axis.title = element_blank(),\n        legend.position = \"bottom\", legend.direction = \"horizontal\") +\n  guides(fill = guide_legend(nrow = 1, title = \"status\"))\n  \np\n\n\n\n\n\n\n\n图 1: 饼图矩阵",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pie Matrix"
    ]
  },
  {
    "objectID": "Hiplot/036-d3-wordcloud.html",
    "href": "Hiplot/036-d3-wordcloud.html",
    "title": "D3 词云",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot D3 Wordcloud 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/d3-wordcloud?lang=zh_cn\n词云图展示。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "D3 Wordcloud"
    ]
  },
  {
    "objectID": "Hiplot/036-d3-wordcloud.html#环境配置",
    "href": "Hiplot/036-d3-wordcloud.html#环境配置",
    "title": "D3 词云",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; d3wordcloud\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"d3wordcloud\", quietly = TRUE)) {\n  remotes::install_github(\"jbkunst/d3wordcloud\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(d3wordcloud)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package     * version date (UTC) lib source\n d3wordcloud * 0.1     2025-11-02 [1] Github (jbkunst/d3wordcloud@1eb4fe9)\n data.table  * 1.17.8  2025-07-10 [1] RSPM\n jsonlite    * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "D3 Wordcloud"
    ]
  },
  {
    "objectID": "Hiplot/036-d3-wordcloud.html#数据准备",
    "href": "Hiplot/036-d3-wordcloud.html#数据准备",
    "title": "D3 词云",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/d3-wordcloud/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\nrow.names(data) &lt;- data[, 1]\n\n# 查看数据\nhead(data)\n\n         word freq\noil       oil   85\nsaid     said   73\nprices prices   48\nopec     opec   42\nmln       mln   31\nthe       the   26",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "D3 Wordcloud"
    ]
  },
  {
    "objectID": "Hiplot/036-d3-wordcloud.html#可视化",
    "href": "Hiplot/036-d3-wordcloud.html#可视化",
    "title": "D3 词云",
    "section": "可视化",
    "text": "可视化\n\n# D3 词云\np &lt;- d3wordcloud(\n  words = data[, 1], \n  freqs = data[, 2],\n  padding = 0,\n  rotate.min = 0,\n  rotate.max = 0,\n  size.scale = \"linear\",\n  color.scale = \"linear\",\n  spiral = \"archimedean\",\n  font = \"Arial\",\n  rangesizefont = c(10, 90)\n)\n\np\n\n\n\n\n\n\n\n图 1: D3 词云",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "D3 Wordcloud"
    ]
  },
  {
    "objectID": "Hiplot/051-eulerr.html",
    "href": "Hiplot/051-eulerr.html",
    "title": "比例韦恩图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Eulerr Plot 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/eulerr?lang=zh_cn",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Eulerr Plot"
    ]
  },
  {
    "objectID": "Hiplot/051-eulerr.html#环境配置",
    "href": "Hiplot/051-eulerr.html#环境配置",
    "title": "比例韦恩图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; eulerr; ggplotify\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"eulerr\", quietly = TRUE)) {\n  install.packages(\"eulerr\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(eulerr)\nlibrary(ggplotify)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n eulerr     * 7.0.4   2025-09-24 [1] RSPM\n ggplotify  * 0.1.3   2025-09-20 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Eulerr Plot"
    ]
  },
  {
    "objectID": "Hiplot/051-eulerr.html#数据准备",
    "href": "Hiplot/051-eulerr.html#数据准备",
    "title": "比例韦恩图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/eulerr/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ngenes &lt;- as.numeric(data[, 2])\nnames(genes) &lt;- as.character(data[, 1])\neuler_set &lt;- euler(genes)\n  \n# 查看数据\nhead(data)\n\n      Term Value\n1       SE    13\n2    Treat    28\n3 Anti-CCP   101\n4    DAS28    91\n5 SE&Treat     1\n6 SE&DAS28    14",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Eulerr Plot"
    ]
  },
  {
    "objectID": "Hiplot/051-eulerr.html#可视化",
    "href": "Hiplot/051-eulerr.html#可视化",
    "title": "比例韦恩图",
    "section": "可视化",
    "text": "可视化\n\n# 比例韦恩图\nfill &lt;- c(\"#3B4992FF\",\"#EE0000FF\",\"#008B45FF\",\"#631879FF\",\"#008280FF\",\"#BB0021FF\",\n          \"#5F559BFF\",\"#A20056FF\")\np &lt;- as.ggplot(\n  plot(euler_set,\n    labels = list(col = rep(\"white\", length(genes))),\n    fills = list(fill = fill),\n    quantities = list(type = c(\"percent\", \"counts\"),\n    col = rep(\"white\", length(genes))),\n    main = \"Eulerr\")\n)\n\np\n\n\n\n\n\n\n\n图 1: 比例韦恩图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Eulerr Plot"
    ]
  },
  {
    "objectID": "Hiplot/005-barplot-errorbar.html",
    "href": "Hiplot/005-barplot-errorbar.html",
    "title": "误差线柱状图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Barplot (errorbar) 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/barplot-errorbar?lang=zh_cn\n带误差线和误差组的条形图。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Barplot (errorbar)"
    ]
  },
  {
    "objectID": "Hiplot/005-barplot-errorbar.html#环境配置",
    "href": "Hiplot/005-barplot-errorbar.html#环境配置",
    "title": "误差线柱状图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2; Rmisc; ggpubr\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"Rmisc\", quietly = TRUE)) {\n  install.packages(\"Rmisc\")\n}\nif (!requireNamespace(\"ggpubr\", quietly = TRUE)) {\n  install.packages(\"ggpubr\")\n}\n\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(Rmisc)\nlibrary(ggpubr)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n ggpubr     * 0.6.2   2025-10-17 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n lattice    * 0.22-7  2025-04-02 [3] CRAN (R 4.5.2)\n plyr       * 1.8.9   2023-10-02 [1] RSPM\n Rmisc      * 1.5.1   2022-05-02 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Barplot (errorbar)"
    ]
  },
  {
    "objectID": "Hiplot/005-barplot-errorbar.html#数据准备",
    "href": "Hiplot/005-barplot-errorbar.html#数据准备",
    "title": "误差线柱状图",
    "section": "数据准备",
    "text": "数据准备\n数据表:\n第一列: (数值) Y 轴值。\n第二列: (数值或字符串) X 轴类别。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/barplot-errorbar/data.json\")$exampleData[[1]]$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndata[, 2] &lt;- factor(data[, 2], levels = unique(data[, 2]))\ndata_sd &lt;- summarySE(data, measurevar = colnames(data)[1], groupvars = colnames(data)[2])\n\n# 查看数据\nhead(data_sd)\n\n    class N score       sd       se       ci\n1    math 4 63.50 3.109126 1.554563 4.947314\n2 chinese 4 73.75 2.986079 1.493039 4.751518\n3 english 4 83.25 2.362908 1.181454 3.759914",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Barplot (errorbar)"
    ]
  },
  {
    "objectID": "Hiplot/005-barplot-errorbar.html#可视化",
    "href": "Hiplot/005-barplot-errorbar.html#可视化",
    "title": "误差线柱状图",
    "section": "可视化",
    "text": "可视化\n\n# 误差线柱状图\np &lt;- ggplot(data_sd, aes(x = data_sd[, 1], y = data_sd[, 3], fill = data_sd[, 1])) +\n  geom_bar(stat = \"identity\", color = \"black\", \n           position = position_dodge(), alpha = 1) +\n  geom_errorbar(aes(ymin = data_sd[, 3] - sd, ymax = data_sd[, 3] + sd),\n                width = 0.2,\n                position = position_dodge(0.9)) +\n  labs(title = \"Barplot (errorbar)\", x = colnames(data_sd)[1], \n       y = colnames(data_sd)[3], fill = colnames(data_sd)[1]) +\n  geom_jitter(data = data, aes(data[, 2], data[, 1], fill = data[, 2]), size = 2, fill = \"black\", pch = 19, width = 0.2) +\n  stat_compare_means(data = data, aes(data[, 2], data[, 1], fill = data[, 2]),\n                     label = \"p.format\", ref.group = \".all.\", vjust = 1, \n                     method = \"t.test\") +\n  scale_fill_manual(values = c(\"#E64B35FF\",\"#4DBBD5FF\",\"#00A087FF\",\"#3C5488FF\")) +\n  theme_bw() +\n  ylim(0,100) +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 1: 误差线柱状图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Barplot (errorbar)"
    ]
  },
  {
    "objectID": "Hiplot/067-gghistostats.html",
    "href": "Hiplot/067-gghistostats.html",
    "title": "条形图（Histostats）",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Histostats 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/gghistostats?lang=zh_cn\n展示数据分布及统计推断。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Histostats"
    ]
  },
  {
    "objectID": "Hiplot/067-gghistostats.html#环境配置",
    "href": "Hiplot/067-gghistostats.html#环境配置",
    "title": "条形图（Histostats）",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggstatsplot\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggstatsplot\", quietly = TRUE)) {\n  install.packages(\"ggstatsplot\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggstatsplot)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package     * version date (UTC) lib source\n data.table  * 1.17.8  2025-07-10 [1] RSPM\n ggstatsplot * 0.13.4  2025-12-09 [1] RSPM\n jsonlite    * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Histostats"
    ]
  },
  {
    "objectID": "Hiplot/067-gghistostats.html#数据准备",
    "href": "Hiplot/067-gghistostats.html#数据准备",
    "title": "条形图（Histostats）",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/gghistostats/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\naxis &lt;- c(\"budget\", \"genre\")\ndata[, axis[2]] &lt;- factor(data[, axis[2]], levels = unique(data[, axis[2]]))\n\n# 查看数据\nhead(data)\n\n                                                                 title year\n1                       Lord of the Rings: The Return of the King, The 2003\n2                   Lord of the Rings: The Fellowship of the Ring, The 2001\n3                               Lord of the Rings: The Two Towers, The 2002\n4                                                            Star Wars 1977\n5                       Star Wars: Episode V - The Empire Strikes Back 1980\n6 Dr. Strangelove or: How I Learned to Stop Worrying and Love the Bomb 1964\n  length budget rating  votes  mpaa  genre\n1    251   94.0    9.0 103631 PG-13 Action\n2    208   93.0    8.8 157608 PG-13 Action\n3    223   94.0    8.8 114797 PG-13 Action\n4    125   11.0    8.8 134640    PG Action\n5    129   18.0    8.8 103706    PG Action\n6     93    1.8    8.7  63471    PG Comedy",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Histostats"
    ]
  },
  {
    "objectID": "Hiplot/067-gghistostats.html#可视化",
    "href": "Hiplot/067-gghistostats.html#可视化",
    "title": "条形图（Histostats）",
    "section": "可视化",
    "text": "可视化\n\n# 条形图\np &lt;- grouped_gghistostats(\n  data = data, x = budget, grouping.var = genre,\n  effsize.type = \"unbiased\",\n  type = \"parametric\",\n  centrality.k = 2,\n  plotgrid.args = list(ncol = 2),\n  centrality.parameter = \"solid\",\n  centrality.line.args = list(size = 1, color = \"black\"),\n  bar.fill = \"#0D47A1\", \n  centrality.label.args = list(color = \"#0D47A1\", size = 3),\n  test.value = as.numeric(0),\n  normal.curve = F,\n  normal.curve.args = list(size = 1)\n)\n\np\n\n\n\n\n\n\n\n图 1: 条形图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Histostats"
    ]
  },
  {
    "objectID": "Hiplot/121-metawho.html",
    "href": "Hiplot/121-metawho.html",
    "title": "元分析亚组比较",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Meta-Subgroup Analysis 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/metawho?lang=zh_cn\nmetawho 的目标是提供“使用元分析方法识别治疗获益最大的人群”的 R 实现。\nmetawho 由 R 包 metafor 提供支持，目前不支持包含个体的数据集。如果您更熟悉 Stata 代码，请使用 Stata 包 ipdmetan。",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Meta-Subgroup Analysis"
    ]
  },
  {
    "objectID": "Hiplot/121-metawho.html#环境配置",
    "href": "Hiplot/121-metawho.html#环境配置",
    "title": "元分析亚组比较",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; meta; cowplot\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"metawho\", quietly = TRUE)) {\n  install.packages(\"metawho\")\n}\nif (!requireNamespace(\"cowplot\", quietly = TRUE)) {\n  install.packages(\"cowplot\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(metawho)\nlibrary(cowplot)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version    date (UTC) lib source\n cowplot    * 1.2.0      2025-07-07 [1] RSPM\n data.table * 1.17.8     2025-07-10 [1] RSPM\n jsonlite   * 2.0.0      2025-03-27 [1] RSPM\n Matrix     * 1.7-4      2025-08-28 [3] CRAN (R 4.5.2)\n metadat    * 1.4-0      2025-02-04 [1] RSPM\n metafor    * 4.8-0      2025-01-28 [1] RSPM\n metawho    * 0.2.0      2019-12-06 [1] RSPM\n numDeriv   * 2016.8-1.1 2019-06-06 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Meta-Subgroup Analysis"
    ]
  },
  {
    "objectID": "Hiplot/121-metawho.html#数据准备",
    "href": "Hiplot/121-metawho.html#数据准备",
    "title": "元分析亚组比较",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/metawho/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndata = deft_prepare(data, conf_level = 1 - 0.95)\nres = deft_do(data, group_level = unique(data$subgroup))\n\n# 查看数据\nhead(data)\n\n                 entry         trial subgroup   hr ci.lb ci.ub  ni   conf_q\n1      Rizvi 2015-Male    Rizvi 2015     Male 0.30  0.09  1.00  16 1.959964\n2    Rizvi 2015-Female    Rizvi 2015   Female 0.11  0.02  0.56  18 1.959964\n3      Rizvi 2018-Male    Rizvi 2018     Male 1.25  0.82  1.90 118 1.959964\n4    Rizvi 2018-Female    Rizvi 2018   Female 0.63  0.42  0.95 122 1.959964\n5   Hellmann 2018-Male Hellmann 2018     Male 0.90  0.41  1.99  37 1.959964\n6 Hellmann 2018-Female Hellmann 2018   Female 0.28  0.12  0.67  38 1.959964\n          yi       sei\n1 -1.2039728 0.6142831\n2 -2.2072749 0.8500678\n3  0.2231436 0.2143674\n4 -0.4620355 0.2082200\n5 -0.1053605 0.4030005\n6 -1.2729657 0.4387290",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Meta-Subgroup Analysis"
    ]
  },
  {
    "objectID": "Hiplot/121-metawho.html#可视化",
    "href": "Hiplot/121-metawho.html#可视化",
    "title": "元分析亚组比较",
    "section": "可视化",
    "text": "可视化\n\n# 元分析亚组比较\np1 &lt;- deft_show(res, element = \"all\")\np2 &lt;- deft_show(res, element = \"subgroup\")\np &lt;- plot_grid(p1, p2, nrow = 2)\n\np\n\n\n\n\n\n\n\n图 1: 元分析亚组比较",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Meta-Subgroup Analysis"
    ]
  },
  {
    "objectID": "Hiplot/095-line.html",
    "href": "Hiplot/095-line.html",
    "title": "线图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Line 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/line?lang=zh_cn\n线图是指使用线性刻度或对数刻度在二维或三维视图中绘制数据，从而显示数据集或跟踪数据随时间变化的变化特征的统计图表。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Line"
    ]
  },
  {
    "objectID": "Hiplot/095-line.html#环境配置",
    "href": "Hiplot/095-line.html#环境配置",
    "title": "线图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2; ggthemes\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"ggthemes\", quietly = TRUE)) {\n  install.packages(\"ggthemes\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(ggthemes)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n ggthemes   * 5.2.0   2025-11-30 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Line"
    ]
  },
  {
    "objectID": "Hiplot/095-line.html#数据准备",
    "href": "Hiplot/095-line.html#数据准备",
    "title": "线图",
    "section": "数据准备",
    "text": "数据准备\n载入数据为横轴数值及其对应的纵轴数值和分组。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/line/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndata[,3] &lt;- factor(data[,3], levels = unique(data[,3]))\n\n# 查看数据\nhead(data)\n\n  Value1 Value2  Group\n1      1      1 treat1\n2      2      4 treat1\n3      3      9 treat1\n4      4     16 treat1\n5      5     25 treat1\n6      6     36 treat1",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Line"
    ]
  },
  {
    "objectID": "Hiplot/095-line.html#可视化",
    "href": "Hiplot/095-line.html#可视化",
    "title": "线图",
    "section": "可视化",
    "text": "可视化\n\n# 线图\np &lt;- ggplot(data, aes(x = Value1, y = Value2)) +\n  geom_line(alpha = 1, aes(color = Group, linetype = Group)) +\n  geom_point(aes(color = Group, shape = Group)) +\n  ggtitle(\"Line Regression Plot\") +\n  scale_fill_manual(values = c(\"#e04d39\",\"#5bbad6\")) +\n  theme_stata() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 1: 线图\n\n\n\n\n\n图示表明治疗方案一中 value1 值与 value2 值呈正相关，而治疗方案二 value1 值与 value2 值呈负相关。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Line"
    ]
  },
  {
    "objectID": "Hiplot/009-barplot-line-multiple.html",
    "href": "Hiplot/009-barplot-line-multiple.html",
    "title": "多柱状图和线图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Multiple Barplot&Line 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/barplot-line-multiple?lang=zh_cn\n在一个图表中显示多个条形图或线形图。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Multiple Barplot&Line"
    ]
  },
  {
    "objectID": "Hiplot/009-barplot-line-multiple.html#环境配置",
    "href": "Hiplot/009-barplot-line-multiple.html#环境配置",
    "title": "多柱状图和线图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2; reshape2; ggthemes\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"reshape2\", quietly = TRUE)) {\n  install.packages(\"reshape2\")\n}\nif (!requireNamespace(\"ggthemes\", quietly = TRUE)) {\n  install.packages(\"ggthemes\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(reshape2)\nlibrary(ggthemes)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n ggthemes   * 5.2.0   2025-11-30 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n reshape2   * 1.4.5   2025-11-12 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Multiple Barplot&Line"
    ]
  },
  {
    "objectID": "Hiplot/009-barplot-line-multiple.html#数据准备",
    "href": "Hiplot/009-barplot-line-multiple.html#数据准备",
    "title": "多柱状图和线图",
    "section": "数据准备",
    "text": "数据准备\n具有多列数据（数字）的数据框。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/barplot-line-multiple/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndata_melt &lt;- melt(data, id.vars = colnames(data)[1])\ndata_melt[, 1] &lt;- factor(data_melt[, 1], level = unique(data_melt[, 1]))\n\n# 查看数据\nhead(data)\n\n  age height weight math biology english chinese\n1  12    158    100  120      90     115     140\n2  15    160    110  145      80     120     120\n3  18    175    120  132      95     118     110\n4  20    176    121  124      99     118     136\n5  21    176    120  135      98     114     150\n6  22    177    124  140      87     110     150",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Multiple Barplot&Line"
    ]
  },
  {
    "objectID": "Hiplot/009-barplot-line-multiple.html#可视化",
    "href": "Hiplot/009-barplot-line-multiple.html#可视化",
    "title": "多柱状图和线图",
    "section": "可视化",
    "text": "可视化\n\n1. 多线图\n\n# 多线图\np &lt;- ggplot(data = data_melt, aes(x = age, y = value, group = variable,\n                                  colour = variable)) +\n  geom_line(alpha = 1, size = 1) +\n  geom_point(aes(shape = variable), alpha = 1, size = 3) +\n  labs(title = \"Line (Multiple)\", x = \"X Lable\", y = \"Value\") +\n  scale_color_manual(values = c(\"#3B4992FF\",\"#EE0000FF\",\"#008B45FF\",\"#631879FF\",\n                               \"#008280FF\",\"#BB0021FF\")) +\n  theme_stata() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 1: 多线图\n\n\n\n\n\n\n\n2. 多柱状图\n\n# 多柱状图\np &lt;- ggplot(data = data_melt, aes(x = age, y = value, fill = variable)) +\n  geom_bar(stat = \"identity\", position = position_dodge(), colour = \"black\",\n           alpha = 1) +\n  labs(title = \"\", x = \"X Lable\", y = \"Value\") +\n  \n  scale_fill_manual(values = c(\"#3B4992FF\",\"#EE0000FF\",\"#008B45FF\",\"#631879FF\",\n                               \"#008280FF\",\"#BB0021FF\")) +\n  theme_stata() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 2: 多柱状图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Multiple Barplot&Line"
    ]
  },
  {
    "objectID": "Hiplot/160-scatter-gradient.html",
    "href": "Hiplot/160-scatter-gradient.html",
    "title": "渐变散点图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Gradient Scatter 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/scatter-gradient?lang=zh_cn\n二维空间散点展示多数值变量关系。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Gradient Scatter"
    ]
  },
  {
    "objectID": "Hiplot/160-scatter-gradient.html#环境配置",
    "href": "Hiplot/160-scatter-gradient.html#环境配置",
    "title": "渐变散点图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; grafify; ggplot2\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"grafify\", quietly = TRUE)) {\n  install.packages(\"grafify\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(grafify)\nlibrary(ggplot2)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n grafify    * 5.1.0   2025-08-25 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Gradient Scatter"
    ]
  },
  {
    "objectID": "Hiplot/160-scatter-gradient.html#数据准备",
    "href": "Hiplot/160-scatter-gradient.html#数据准备",
    "title": "渐变散点图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/scatter-gradient/data.json\")$exampleData[[1]]$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 查看数据\nhead(data[,1:5])\n\n                car  mpg cyl disp  hp\n1         Mazda RX4 21.0   6  160 110\n2     Mazda RX4 Wag 21.0   6  160 110\n3        Datsun 710 22.8   4  108  93\n4    Hornet 4 Drive 21.4   6  258 110\n5 Hornet Sportabout 18.7   8  360 175\n6           Valiant 18.1   6  225 105",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Gradient Scatter"
    ]
  },
  {
    "objectID": "Hiplot/160-scatter-gradient.html#可视化",
    "href": "Hiplot/160-scatter-gradient.html#可视化",
    "title": "渐变散点图",
    "section": "可视化",
    "text": "可视化\n\n# 渐变散点图\np &lt;- ggplot(data, aes(x = mpg, y = disp)) + \n  geom_point(aes(fill = gear), size = 5, alpha = 1, shape = 21, stroke = 0.5) +\n  labs(fill = \"gear\", color = \"gear\") +\n  theme_classic(base_size = 10) +\n  theme(strip.background = element_blank()) +\n  guides(x = guide_axis(angle = 0)) +\n  scale_fill_gradient(low = \"#00438E\", high = \"#E43535\") +\n  scale_color_gradient(low = \"#00438E\", high = \"#E43535\") + \n  guides(fill = guide_legend(title = \"gear\"),\n         size = guide_legend(title = \"gear\")) +\n  ggtitle(\"Scatter-gradient Plot\") +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 1: 渐变散点图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Gradient Scatter"
    ]
  },
  {
    "objectID": "Hiplot/115-map-usa.html",
    "href": "Hiplot/115-map-usa.html",
    "title": "美国地图 (州)",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot USA Map (States) 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/map-usa?lang=zh_cn",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "USA Map (States)"
    ]
  },
  {
    "objectID": "Hiplot/115-map-usa.html#环境配置",
    "href": "Hiplot/115-map-usa.html#环境配置",
    "title": "美国地图 (州)",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2; RColorBrewer\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(RColorBrewer)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package      * version date (UTC) lib source\n data.table   * 1.17.8  2025-07-10 [1] RSPM\n ggplot2      * 4.0.1   2025-11-14 [1] RSPM\n jsonlite     * 2.0.0   2025-03-27 [1] RSPM\n RColorBrewer * 1.1-3   2022-04-03 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "USA Map (States)"
    ]
  },
  {
    "objectID": "Hiplot/115-map-usa.html#数据准备",
    "href": "Hiplot/115-map-usa.html#数据准备",
    "title": "美国地图 (州)",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/map-usa/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\ndt_map &lt;- readRDS(url(\"https://download.hiplot.cn/ui/basic/map-usa/usa.rds\"))\n\n# 整理数据格式\ndt_map$Value &lt;- data$value[match(dt_map$state, data$name)]\n\n# 查看数据\nhead(data)\n\n          name value\n1   Washington   438\n2      Montana   103\n3        Maine   614\n4 North Dakota   256\n5 South Dakota   639\n6      Wyoming   599",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "USA Map (States)"
    ]
  },
  {
    "objectID": "Hiplot/115-map-usa.html#可视化",
    "href": "Hiplot/115-map-usa.html#可视化",
    "title": "美国地图 (州)",
    "section": "可视化",
    "text": "可视化\n\n# 美国地图 (州)\np &lt;- ggplot(dt_map) +\n  geom_polygon(aes(x = long, y = lat, group = group, fill = Value),\n               alpha = 0.9, size = 0.5) +\n  geom_path(aes(x = long, y = lat, group = group), color = \"black\", size = 0.2) +\n  coord_fixed() +\n  scale_fill_gradientn(\n    colours = colorRampPalette(rev(brewer.pal(11,\"RdYlBu\")))(500),\n    breaks = seq(min(data$value), max(data$value), \n                 round((max(data$value)-min(data$value))/7)),\n    name = \"Color Key\",\n    guide = guide_legend(\n      direction = \"vertical\", keyheight = unit(1, units = \"mm\"),\n      keywidth = unit(8, units = \"mm\"),\n      title.position = \"top\", title.hjust = 0.5, label.hjust = 0.5,\n      nrow = 1, byrow = T, reverse = F, label.position = \"bottom\")) +\n  theme(text = element_text(color = \"#3A3F4A\"),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank(),\n        legend.position = \"top\",\n        legend.text = element_text(size = 4 * 1.5, color = \"black\"),\n        legend.title = element_text(size = 5 * 1.5, color = \"black\"),\n        plot.title = element_text(\n          face = \"bold\", size = 5 * 1.5, hjust = 0.5, \n          margin = margin(t = 4, b = 5), color = \"black\"),\n        plot.background = element_rect(fill = \"#FFFFFF\", color = \"#FFFFFF\"),\n        panel.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        legend.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        plot.margin = unit(c(1.5, 1.5, 1.5, 1.5), \"cm\")) +\n  labs(x = NULL, y = NULL, title = \"USA Map\")\n\np\n\n\n\n\n\n\n\n图 1: 美国地图 (州)",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "USA Map (States)"
    ]
  },
  {
    "objectID": "Hiplot/038-density-hist-mirror.html",
    "href": "Hiplot/038-density-hist-mirror.html",
    "title": "镜像密度图和直方图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Mirror Density & Histogram 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/density-hist-mirror?lang=zh_cn\n镜像密度图和直方图是一种使用上下双侧绘制方法用来观察连续型变量分布的图形。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Mirror Density & Histogram"
    ]
  },
  {
    "objectID": "Hiplot/038-density-hist-mirror.html#环境配置",
    "href": "Hiplot/038-density-hist-mirror.html#环境配置",
    "title": "镜像密度图和直方图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2; ggthemes\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"ggthemes\", quietly = TRUE)) {\n  install.packages(\"ggthemes\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(ggthemes)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n ggthemes   * 5.2.0   2025-11-30 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Mirror Density & Histogram"
    ]
  },
  {
    "objectID": "Hiplot/038-density-hist-mirror.html#数据准备",
    "href": "Hiplot/038-density-hist-mirror.html#数据准备",
    "title": "镜像密度图和直方图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/density-hist-mirror/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\nsides &lt;- data[1,]\ndata &lt;- data[-1,]\nfor (i in 1:ncol(data)) {\n  data[,i] &lt;- as.numeric(data[,i])\n}\n\n# 查看数据\nhead(data)\n\n         var1     var2     var3     var4     var5     var6\n2  0.54659146 1.575592 1.508968 2.504824 5.540246 6.198931\n3 -0.64052340 5.275076 1.498841 4.436792 4.987390 5.194154\n4  1.03196438 2.561983 4.018349 3.506171 5.030395 6.570980\n5  0.09518815 1.802874 2.057855 2.789252 4.797252 7.545844\n6  0.89147721 2.627927 2.218567 4.581939 4.791792 5.468657\n7  0.61786781 3.574565 2.051910 4.929031 5.830516 6.105716",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Mirror Density & Histogram"
    ]
  },
  {
    "objectID": "Hiplot/038-density-hist-mirror.html#可视化",
    "href": "Hiplot/038-density-hist-mirror.html#可视化",
    "title": "镜像密度图和直方图",
    "section": "可视化",
    "text": "可视化\n\n1. 镜像密度图\n\n# 镜像密度图\np &lt;- ggplot(data, aes(x=x))\ncolrs &lt;- c(\"#e64b35ff\",\"#4dbbd5ff\",\"#00a087ff\",\"#3c5488ff\",\"#f39b7fff\",\"#8491b4ff\")\ncolrs2 &lt;- colnames(data)\nfor (i in seq_len(length(sides))) {\n  eval(parse(\n    text = sprintf(\"p &lt;- p + geom_density(aes(x = %s, y = %s..density.., color = '%s', fill = '%s'), kernel = '%s')\", \n                   colnames(data)[i], ifelse(sides[i] == \"top\", \"\", \"-\"), colnames(data)[i],\n                   colnames(data)[i], \"gaussian\")\n    ))\n  names(colrs)[i] &lt;- colnames(data)[i]\n  names(colrs2)[i] &lt;- colrs[i]\n}\np &lt;- p + \n  ggtitle(\"\") +\n  scale_fill_manual(values=colrs, name=\"Densities\") +\n  scale_color_manual(values=colrs, name=\"Densities\") +\n  theme_stata() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 1: 镜像密度图\n\n\n\n\n\n\n\n2. 镜像直方图\n\n# 镜像直方图\np &lt;- ggplot(data, aes(x=x))\ncolrs &lt;- c(\"#e64b35ff\",\"#4dbbd5ff\",\"#00a087ff\",\"#3c5488ff\",\"#f39b7fff\",\"#8491b4ff\")\ncolrs2 &lt;- colnames(data)\nfor (i in seq_len(length(sides))) {\n  eval(parse(\n    text = sprintf(\"p &lt;- p + geom_histogram(aes(x = %s, y = %s..density.., color = '%s', fill = '%s'), bins = %s)\", \n                   colnames(data)[i], ifelse(sides[i] == \"top\", \"\", \"-\"),\n                   colnames(data)[i], colnames(data)[i], 35)))\n  names(colrs)[i] &lt;- colnames(data)[i]\n  names(colrs2)[i] &lt;- colrs[i]\n}\np &lt;- p + \n  ggtitle(\"\") +\n  scale_fill_manual(values=colrs, name=\"Densities\") +\n  scale_color_manual(values=colrs, name=\"Densities\") +\n  theme_stata() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 2: 镜像直方图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Mirror Density & Histogram"
    ]
  },
  {
    "objectID": "Hiplot/092-line-color-dot.html",
    "href": "Hiplot/092-line-color-dot.html",
    "title": "线图（颜色点）",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Line (Color Dot) 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/line-color-dot?lang=zh_cn",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Line (Color Dot)"
    ]
  },
  {
    "objectID": "Hiplot/092-line-color-dot.html#环境配置",
    "href": "Hiplot/092-line-color-dot.html#环境配置",
    "title": "线图（颜色点）",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; grafify\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"grafify\", quietly = TRUE)) {\n  install.packages(\"grafify\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(grafify)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n grafify    * 5.1.0   2025-08-25 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Line (Color Dot)"
    ]
  },
  {
    "objectID": "Hiplot/092-line-color-dot.html#数据准备",
    "href": "Hiplot/092-line-color-dot.html#数据准备",
    "title": "线图（颜色点）",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/line-color-dot/data.json\")$exampleData[[1]]$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\nx &lt;- \"Time\"\ny &lt;- \"PI\"\ngroup &lt;- \"Experiment\"\nfacet &lt;- \"Genotype\"\ndata[, x] &lt;- factor(data[, x], levels = unique(data[, x]))\ndata[, group] &lt;- factor(data[, group], levels = unique(data[, group]))\ndata[, facet] &lt;- factor(data[, facet], levels = unique(data[, facet]))\n\n# 查看数据\nhead(data)\n\n  Experiment Time Subject Genotype       PI Time2\n1         e1 t100      s1       WT 20.47120   100\n2         e2 t100      s2       WT 28.88967   100\n3         e3 t100      s3       WT 11.55061   100\n4         e4 t100      s4       WT 23.24516   100\n5         e5 t100      s5       WT 30.20904   100\n6         e6 t100      s6       WT 28.68300   100",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Line (Color Dot)"
    ]
  },
  {
    "objectID": "Hiplot/092-line-color-dot.html#可视化",
    "href": "Hiplot/092-line-color-dot.html#可视化",
    "title": "线图（颜色点）",
    "section": "可视化",
    "text": "可视化\n\n# 线图（颜色点）\np &lt;- plot_befafter_colours(\n  data = data, xcol = get(x), ycol = get(y), match = get(group),\n  symsize = 5, symthick = 1, s_alpha = 1) +\n  facet_wrap(facet) +\n  guides(fill = guide_legend(title = group)) +\n  scale_fill_grafify() +\n  xlab(x) + ylab(y) +\n  ggtitle(\"Two-way repeated measures\") +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12, hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 1: 线图（颜色点）",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Line (Color Dot)"
    ]
  },
  {
    "objectID": "Hiplot/017-bumpchart.html",
    "href": "Hiplot/017-bumpchart.html",
    "title": "凹凸图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Bumpchart 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/bumpchart?lang=zh_cn\n凹凸图可以用于展示多组数值变化情况。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Bumpchart"
    ]
  },
  {
    "objectID": "Hiplot/017-bumpchart.html#环境配置",
    "href": "Hiplot/017-bumpchart.html#环境配置",
    "title": "凹凸图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2; ggbump; dplyr\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"ggbump\", quietly = TRUE)) {\n  install.packages(\"ggbump\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(ggbump)\nlibrary(dplyr)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version   date (UTC) lib source\n data.table * 1.17.8    2025-07-10 [1] RSPM\n dplyr      * 1.1.4     2023-11-17 [1] RSPM\n ggbump     * 0.1.99999 2025-12-23 [1] Github (davidsjoberg/ggbump@fe6d5c7)\n ggplot2    * 4.0.1     2025-11-14 [1] RSPM\n jsonlite   * 2.0.0     2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Bumpchart"
    ]
  },
  {
    "objectID": "Hiplot/017-bumpchart.html#数据准备",
    "href": "Hiplot/017-bumpchart.html#数据准备",
    "title": "凹凸图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/bumpchart/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 查看数据\nhead(data)\n\n     x y group\n1 2019 4     A\n2 2020 2     A\n3 2021 2     A\n4 2019 3     B\n5 2020 1     B\n6 2021 4     B",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Bumpchart"
    ]
  },
  {
    "objectID": "Hiplot/017-bumpchart.html#可视化",
    "href": "Hiplot/017-bumpchart.html#可视化",
    "title": "凹凸图",
    "section": "可视化",
    "text": "可视化\n\n# 凹凸图\np &lt;- ggplot(data, aes(x = x, y = y, color = group)) +\n  geom_bump(size = 1.5) +\n  geom_point(size = 5) +\n  geom_text(data = data %&gt;% filter(x == min(x)),\n            aes(x = x - 0.1, label = group),\n            size = 5, hjust = 1) +\n  geom_text(data = data %&gt;% filter(x == max(x)),\n            aes(x = x + 0.1, label = group),\n            size = 5, hjust = 0) +\n  theme_void() +\n  theme(legend.position = \"none\") +\n  scale_color_manual(values = c(\"#0571B0\",\"#92C5DE\",\"#F4A582\",\"#CA0020\"))\n\np\n\n\n\n\n\n\n\n图 1: 凹凸图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Bumpchart"
    ]
  },
  {
    "objectID": "Hiplot/143-pseudo-enhanced-ma.html",
    "href": "Hiplot/143-pseudo-enhanced-ma.html",
    "title": "MA 图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot EnhancedMA 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/pseudo-enhanced-ma?lang=zh_cn\n差异表达基因可视化。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "EnhancedMA"
    ]
  },
  {
    "objectID": "Hiplot/143-pseudo-enhanced-ma.html#环境配置",
    "href": "Hiplot/143-pseudo-enhanced-ma.html#环境配置",
    "title": "MA 图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; EnhancedVolcano\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"EnhancedVolcano\", quietly = TRUE)) {\n  remotes::install_github('kevinblighe/EnhancedVolcano')\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(EnhancedVolcano)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package         * version date (UTC) lib source\n data.table      * 1.17.8  2025-07-10 [1] RSPM\n EnhancedVolcano * 1.29.1  2025-12-03 [1] Github (kevinblighe/EnhancedVolcano@b1f351b)\n ggplot2         * 4.0.1   2025-11-14 [1] RSPM\n ggrepel         * 0.9.6   2024-09-07 [1] RSPM\n jsonlite        * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "EnhancedMA"
    ]
  },
  {
    "objectID": "Hiplot/143-pseudo-enhanced-ma.html#数据准备",
    "href": "Hiplot/143-pseudo-enhanced-ma.html#数据准备",
    "title": "MA 图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/pseudo-enhanced-ma/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\nrow.names(data) &lt;- data[,1]\ndata &lt;- data[,-1]\ndata$baseMeanNew &lt;- 1 / (10^log(data$baseMean + 1))\n\n# 查看数据\nhead(data)\n\n              baseMean log2FoldChange      lfcSE       stat       pvalue\nCOL6A3    8.494143e+04    -0.34453583 0.07607842 -4.5305972 5.881720e-06\nZNF157    2.456747e+00    -0.42976616 0.33693867 -1.2957785 1.950518e-01\nRPL23P11  0.000000e+00             NA         NA         NA           NA\nSCARNA10  4.406548e-01    -0.05657159 0.15265730 -0.2329492 8.158009e-01\nRNU6-857P 0.000000e+00             NA         NA         NA           NA\nTOPORS    5.331777e+02     0.10709656 0.12572643  0.8549637 3.925712e-01\n                  padj  baseMeanNew\nCOL6A3    6.207728e-05 4.469624e-12\nZNF157              NA 5.750056e-02\nRPL23P11            NA 1.000000e+00\nSCARNA10            NA 4.314220e-01\nRNU6-857P           NA 1.000000e+00\nTOPORS    6.148749e-01 5.239278e-07",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "EnhancedMA"
    ]
  },
  {
    "objectID": "Hiplot/143-pseudo-enhanced-ma.html#可视化",
    "href": "Hiplot/143-pseudo-enhanced-ma.html#可视化",
    "title": "MA 图",
    "section": "可视化",
    "text": "可视化\n\n# MA 图\np &lt;- EnhancedVolcano(\n  data, lab = rownames(data), title = \"MA plot\", subtitle = \"EnhancedMA\",\n  x = 'log2FoldChange', y = 'baseMeanNew', xlab = bquote(~Log[2]~ 'fold change'),\n  ylab = bquote(~Log[e]~ 'base mean + 1'), ylim = c(0,12),\n  pCutoff = as.numeric(1e-05), FCcutoff = 1, pointSize = 3.5,\n  labSize = 4, boxedLabels = T, colAlpha = 1,\n  legendLabels = c('NS', expression(Log[2]~FC),\n                   'Mean expression', \n                   expression(Mean-expression~and~log[2]~FC)),\n  legendPosition = \"bottom\", legendLabSize = 16, legendIconSize = 4.0,\n  encircleCol = 'black', encircleSize = 2.5, encircleFill = 'pink',\n  encircleAlpha = 1/2) + \n  coord_flip() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 1: MA 图",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "EnhancedMA"
    ]
  },
  {
    "objectID": "Hiplot/184-waffle.html",
    "href": "Hiplot/184-waffle.html",
    "title": "华夫饼图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Waffle Plot 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/waffle?lang=zh_cn",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Waffle Plot"
    ]
  },
  {
    "objectID": "Hiplot/184-waffle.html#环境配置",
    "href": "Hiplot/184-waffle.html#环境配置",
    "title": "华夫饼图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; waffle\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"waffle\", quietly = TRUE)) {\n  remotes::install_github(\"hrbrmstr/waffle\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(waffle)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n waffle     * 1.0.2   2025-11-02 [1] Github (hrbrmstr/waffle@767875b)\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Waffle Plot"
    ]
  },
  {
    "objectID": "Hiplot/184-waffle.html#数据准备",
    "href": "Hiplot/184-waffle.html#数据准备",
    "title": "华夫饼图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/waffle/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\nparts &lt;- data[,2]\n\n# 查看数据\nhead(data)\n\n                      label value\n1 Un-breached US Population   230\n2                   Premera    11\n3                    Anthem    79",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Waffle Plot"
    ]
  },
  {
    "objectID": "Hiplot/184-waffle.html#可视化",
    "href": "Hiplot/184-waffle.html#可视化",
    "title": "华夫饼图",
    "section": "可视化",
    "text": "可视化\n\n# 华夫饼图\np &lt;- waffle(parts, rows = 8, size = 1, legend_pos = \"right\") +\n  ggtitle(\"Waffle Plot\") +\n  scale_fill_manual(values = c(\"#e04d39\",\"#5bbad6\",\"#1e9f86\")) +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 1: 华夫饼图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Waffle Plot"
    ]
  },
  {
    "objectID": "Hiplot/182-visdat.html",
    "href": "Hiplot/182-visdat.html",
    "title": "数据概览图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Visdat 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/visdat?lang=zh_cn",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Visdat"
    ]
  },
  {
    "objectID": "Hiplot/182-visdat.html#环境配置",
    "href": "Hiplot/182-visdat.html#环境配置",
    "title": "数据概览图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; visdat; ggplot2; dplyr; patchwork\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"visdat\", quietly = TRUE)) {\n  install.packages(\"visdat\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"patchwork\", quietly = TRUE)) {\n  install.packages(\"patchwork\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(visdat)\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(patchwork)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n dplyr      * 1.1.4   2023-11-17 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n patchwork  * 1.3.2   2025-08-25 [1] RSPM\n visdat     * 0.6.0   2023-02-02 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Visdat"
    ]
  },
  {
    "objectID": "Hiplot/182-visdat.html#数据准备",
    "href": "Hiplot/182-visdat.html#数据准备",
    "title": "数据概览图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/visdat/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 查看数据\nhead(data)\n\n  RowNames Ozone Solar.R Wind Temp Month Day\n1        1    41     190  7.4   67     5   1\n2        2    36     118  8.0   72     5   2\n3        3    12     149 12.6   74     5   3\n4        4    18     313 11.5   62     5   4\n5        5    NA      NA 14.3   56     5   5\n6        6    28      NA 14.9   66     5   6",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Visdat"
    ]
  },
  {
    "objectID": "Hiplot/182-visdat.html#可视化",
    "href": "Hiplot/182-visdat.html#可视化",
    "title": "数据概览图",
    "section": "可视化",
    "text": "可视化\n\n# 数据概览图\nadd_palette &lt;- function (p) {\n  ## 添加配色\n  p &lt;- p + scale_fill_manual(values = c(\"#3B4992FF\", \"#EE0000FF\"))\n}\npobj &lt;- list()\npobj[[\"p1\"]] &lt;- add_palette(vis_dat(data)) + ggtitle(':vis_dat')\npobj[[\"p2\"]] &lt;- add_palette(vis_guess(data)) + ggtitle(':vis_guess')\npobj[[\"p3\"]] &lt;- vis_miss(data, cluster = T, sort_miss = T) + ggtitle(':vis_miss')\npobj[[\"p4\"]] &lt;- add_palette(vis_expect(data, ~.x &gt;= 20 )) + ggtitle(':vis_expect')\npobj[[\"p5\"]] &lt;- vis_cor(data) + \n  scale_fill_gradientn(colours = c(\"#0571B0\", \"#92C5DE\", \"#F4A582\", \"#CA0020\")) +\n  ggtitle(':vis_cor')\npobj[[\"p6\"]] &lt;- data %&gt;%\n      select_if(is.numeric) %&gt;%\n      vis_value() + ggtitle(':vis_value')\npobj[[\"p6\"]] &lt;- pobj[[\"p6\"]] + \n  scale_fill_gradientn(colours = c(\"#0571B0\",\"#92C5DE\",\"#F7F7F7\",\"#F4A582\",\n                                   \"#CA0020\"))\n\npstr &lt;- paste0(sprintf(\"pobj[[%s]]\", 1:length(pobj)), collapse = \" + \")\np &lt;- eval(parse(text = \n  sprintf(\"%s + plot_layout(ncol = 2) +\nplot_annotation(tag_levels = 'A')\", pstr)))\n\np\n\n\n\n\n\n\n\n图 1: 数据概览图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Visdat"
    ]
  },
  {
    "objectID": "Hiplot/185-waterfalls-plot.html",
    "href": "Hiplot/185-waterfalls-plot.html",
    "title": "瀑布图2",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Waterfalls Plot2 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/waterfalls-plot?lang=zh_cn\n用于展示数据的变化情况，区别于1的一点是2可以自定义上升值和下降值颜色。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Waterfalls Plot2"
    ]
  },
  {
    "objectID": "Hiplot/185-waterfalls-plot.html#环境配置",
    "href": "Hiplot/185-waterfalls-plot.html#环境配置",
    "title": "瀑布图2",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; waterfalls; ggplot2\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"waterfalls\", quietly = TRUE)) {\n  install.packages(\"waterfalls\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(waterfalls)\nlibrary(ggplot2)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n waterfalls * 1.0.0   2022-11-20 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Waterfalls Plot2"
    ]
  },
  {
    "objectID": "Hiplot/185-waterfalls-plot.html#数据准备",
    "href": "Hiplot/185-waterfalls-plot.html#数据准备",
    "title": "瀑布图2",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/waterfalls-plot/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndata[[\"name\"]] &lt;- factor(data[[\"name\"]], levels = data[[\"name\"]])\ndata$fill &lt;- ifelse(data$value &gt; 0, \"#B71C1C\", \"#1B5E20\")\n\n# 查看数据\nhead(data)\n\n  name value    fill\n1    A   100 #B71C1C\n2    B   -20 #1B5E20\n3    C   120 #B71C1C\n4    D   -40 #1B5E20\n5    E  -100 #1B5E20\n6    F    80 #B71C1C",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Waterfalls Plot2"
    ]
  },
  {
    "objectID": "Hiplot/185-waterfalls-plot.html#可视化",
    "href": "Hiplot/185-waterfalls-plot.html#可视化",
    "title": "瀑布图2",
    "section": "可视化",
    "text": "可视化\n\n# 瀑布图2\np &lt;- waterfall(data, calc_total = T, rect_width = 0.7, fill_by_sign = F,\n               fill_colours = data$fill, total_rect_color = \"#1E065D\") +\n  theme_bw()\n\np\n\n\n\n\n\n\n\n图 1: 瀑布图2",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Waterfalls Plot2"
    ]
  },
  {
    "objectID": "Hiplot/174-tricolor-histogram.html",
    "href": "Hiplot/174-tricolor-histogram.html",
    "title": "三色直方图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Tricolor Histogram 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/tricolor-histogram?lang=zh_cn\n通过三种颜色将直方图分为低值区，中值区和高值区。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Tricolor Histogram"
    ]
  },
  {
    "objectID": "Hiplot/174-tricolor-histogram.html#环境配置",
    "href": "Hiplot/174-tricolor-histogram.html#环境配置",
    "title": "三色直方图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Tricolor Histogram"
    ]
  },
  {
    "objectID": "Hiplot/174-tricolor-histogram.html#数据准备",
    "href": "Hiplot/174-tricolor-histogram.html#数据准备",
    "title": "三色直方图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/tricolor-histogram/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndata$draw_color &lt;- ifelse(data$value &lt; 5, \"#F44336\",\n                          ifelse(data$value &gt; 7, \"#006064\", \"#3F51B5\")\n)\n\n# 查看数据\nhead(data)\n\n    values draw_color\n1 6.063364    #3F51B5\n2 4.354496    #F44336\n3 5.569931    #3F51B5\n4 5.602465    #3F51B5\n5 6.831472    #3F51B5\n6 6.055604    #3F51B5",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Tricolor Histogram"
    ]
  },
  {
    "objectID": "Hiplot/174-tricolor-histogram.html#可视化",
    "href": "Hiplot/174-tricolor-histogram.html#可视化",
    "title": "三色直方图",
    "section": "可视化",
    "text": "可视化\n\n# 三色直方图\np &lt;- ggplot(data, aes(x = values, fill = draw_color)) +\n  geom_histogram(alpha = 0.5, binwidth = 0.05, position = \"identity\") +\n    scale_fill_manual(values = c(\"#3F51B5\", \"#006064\", \"#F44336\")) +\n  theme_bw()\n\np\n\n\n\n\n\n\n\n图 1: 三色直方图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Tricolor Histogram"
    ]
  },
  {
    "objectID": "Hiplot/003-barplot-3d.html",
    "href": "Hiplot/003-barplot-3d.html",
    "title": "三维柱状图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot 3D Barplot 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/barplot-3d?lang=zh_cn\n三维柱状图用于为数据提供三维外观。第三维通常出于美学原因而使用，但其不能改善数据的读取。仍旨在显示离散类别之间的比较。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "3D Barplot"
    ]
  },
  {
    "objectID": "Hiplot/003-barplot-3d.html#环境配置",
    "href": "Hiplot/003-barplot-3d.html#环境配置",
    "title": "三维柱状图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; plot3D; ggplotify\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"plot3D\", quietly = TRUE)) {\n  install.packages(\"plot3D\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(plot3D)\nlibrary(ggplotify)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplotify  * 0.1.3   2025-09-20 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n plot3D     * 1.4.2   2025-07-25 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "3D Barplot"
    ]
  },
  {
    "objectID": "Hiplot/003-barplot-3d.html#数据准备",
    "href": "Hiplot/003-barplot-3d.html#数据准备",
    "title": "三维柱状图",
    "section": "数据准备",
    "text": "数据准备\n载入数据为不同治疗方案中不同剂量药物作用效果数据。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/barplot-3d/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 将数据向量转换为矩阵\nmat &lt;- matrix(rep(1, nrow(data)), nrow = length(unique(data[, 2])))\nrownames(mat) &lt;- unique(data[, 2])\ncolnames(mat) &lt;- unique(data[, 3])\nfor (i in 1:nrow(mat)) {\n  for (j in seq_len(ncol(mat))) {\n    mat[i, j] &lt;- data[, 1][data[, 2] == rownames(mat)[i] &\n      data[, 3] == colnames(mat)[j]]\n  }\n}\n\n# 查看数据\nmat\n\n       high mid low\nGroup1   13  25   5\nGroup2   34   8  25\nGroup3   21  17  12\nGroup4   43  10  19",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "3D Barplot"
    ]
  },
  {
    "objectID": "Hiplot/003-barplot-3d.html#可视化",
    "href": "Hiplot/003-barplot-3d.html#可视化",
    "title": "三维柱状图",
    "section": "可视化",
    "text": "可视化\n\n# 三维柱状图\np &lt;- as.ggplot(function() {\n  hist3D(\n    x = 1:nrow(mat), y = seq_len(ncol(mat)), z = mat,\n    bty = \"g\", phi = 20,\n    theta = -55,\n    xlab = colnames(data)[2],\n    ylab = colnames(data)[3], zlab = colnames(data)[1],\n    main = \"3D Bar Plot\", colkey = F,\n    border = \"black\", shade = 0.8, axes = T,\n    ticktype = \"detailed\", space = 0.3, d = 2, cex.axis = 0.3,\n    colvar = as.numeric(as.factor(data[, 2])), alpha = 1,\n    col = c(\"#E64B35FF\",\"#4DBBD5FF\",\"#00A087FF\",\"#3C5488FF\")\n  )\n\n  # 使用 text3D 标记 x 轴\n  text3D(\n    x = 1:nrow(mat), y = rep(0.5, nrow(mat)), z = rep(3, nrow(mat)),\n    labels = rownames(mat),\n    add = TRUE, adj = 0, cex = 0.8\n  )\n  # 使用 text3D 标记 y 轴\n  text3D(\n    x = rep(1, ncol(mat)), y = seq_len(ncol(mat)), z = rep(0, ncol(mat)),\n    labels = colnames(mat), bty = \"g\",\n    add = TRUE, adj = 1, cex = 0.8\n  )\n})\n\np\n\n\n\n\n\n\n\n图 1: 三维柱状图\n\n\n\n\n\n该三维柱状图展示了不同治疗组（组 1 ~ 组 4）分别用低、中、高剂量进行治疗时，不同的治疗效果。组 1 使用中剂量治疗时效果最好，组 2 使用高剂量治疗时效果最好，组3使用剂量治疗时无较大差距，组 4 使用高剂量治疗时效果最好。\n\n\n\n\n\n\n提示\n\n\n\n特殊参数: \n\nPhi: 正值越大，表示趋于从三维图形顶端向下观测；负值越大，表示趋于从三维图形底端向上观测。\nTheta: 三维图形水平旋转的角度。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "3D Barplot"
    ]
  },
  {
    "objectID": "Hiplot/014-bivariate.html",
    "href": "Hiplot/014-bivariate.html",
    "title": "双变量图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Bivariate Chart 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/bivariate?lang=zh_cn\n展示双变量关系。",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Bivariate Chart"
    ]
  },
  {
    "objectID": "Hiplot/014-bivariate.html#环境配置",
    "href": "Hiplot/014-bivariate.html#环境配置",
    "title": "双变量图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; GGally\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"GGally\", quietly = TRUE)) {\n  install.packages(\"GGally\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(GGally)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n GGally     * 2.4.0   2025-08-23 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Bivariate Chart"
    ]
  },
  {
    "objectID": "Hiplot/014-bivariate.html#数据准备",
    "href": "Hiplot/014-bivariate.html#数据准备",
    "title": "双变量图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/bivariate/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 查看数据\nhead(data)\n\n  total_bill  tip gender smoker day   time size\n1      16.99 1.01 Female     No Sun Dinner    2\n2      10.34 1.66   Male     No Sun Dinner    3\n3      21.01 3.50   Male     No Sun Dinner    3\n4      23.68 3.31   Male     No Sun Dinner    2\n5      24.59 3.61 Female     No Sun Dinner    4\n6      25.29 4.71   Male     No Sun Dinner    4",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Bivariate Chart"
    ]
  },
  {
    "objectID": "Hiplot/014-bivariate.html#可视化",
    "href": "Hiplot/014-bivariate.html#可视化",
    "title": "双变量图",
    "section": "可视化",
    "text": "可视化\n\n# 双变量图\np &lt;- ggbivariate(data, outcome = \"smoker\", \n                 explanatory = c(\"day\",\"time\",\"gender\",\"tip\")) +\n  ggtitle(\"Bivariate\") +\n  scale_fill_manual(values = c(\"#e04d39\",\"#5bbad6\")) +\n  theme_bw() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 1: 双变量图",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Bivariate Chart"
    ]
  },
  {
    "objectID": "Hiplot/037-dendrogram.html",
    "href": "Hiplot/037-dendrogram.html",
    "title": "系统树图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Dendrogram 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/dendrogram?lang=zh_cn\n系统树图是一种以树的形状表示的图。这种图表在不同情景有不同的含义。如：在层次聚类中，说明了相应分析产生的聚类的排列。在生物信息中，它显示基因或样本的聚集，有时在热图的边缘。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Dendrogram"
    ]
  },
  {
    "objectID": "Hiplot/037-dendrogram.html#环境配置",
    "href": "Hiplot/037-dendrogram.html#环境配置",
    "title": "系统树图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ape; ggplotify\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ape\", quietly = TRUE)) {\n  install.packages(\"ape\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ape)\nlibrary(ggplotify)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n ape        * 5.8-1   2024-12-16 [1] RSPM\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplotify  * 0.1.3   2025-09-20 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Dendrogram"
    ]
  },
  {
    "objectID": "Hiplot/037-dendrogram.html#数据准备",
    "href": "Hiplot/037-dendrogram.html#数据准备",
    "title": "系统树图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/dendrogram/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndata &lt;- data[, -1]\n\n# 查看数据\nhead(data)\n\n        M1       M2        M3       M4       M5       M6       M7       M8\n1 6.599344 5.226266  3.693288 3.938501 4.527193 9.308119 8.987865 7.658312\n2 5.760380 4.892783  5.448924 3.485413 3.855669 8.662081 8.793320 8.765915\n3 9.561905 4.549168  3.998655 5.614384 3.904793 9.790770 7.133188 7.379591\n4 8.396409 8.717055  8.039064 7.643060 9.274649 4.417013 4.725270 3.542217\n5 8.419766 8.268430  8.451181 9.200732 8.598207 4.590033 5.368268 4.136667\n6 7.653074 5.780393 10.633550 5.913684 8.805605 5.890120 5.527945 3.822596\n        M9      M10\n1 8.666038 7.419708\n2 8.097206 8.262942\n3 7.938063 6.154118\n4 4.305187 6.964710\n5 4.910986 4.080363\n6 4.041078 7.956589",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Dendrogram"
    ]
  },
  {
    "objectID": "Hiplot/037-dendrogram.html#可视化",
    "href": "Hiplot/037-dendrogram.html#可视化",
    "title": "系统树图",
    "section": "可视化",
    "text": "可视化\n\n# 系统树图\nd &lt;- dist(t(data), method = \"euclidean\")\nhc &lt;- hclust(d, method = \"complete\")\nclus &lt;- cutree(hc, 4)\n\np &lt;- as.ggplot(function() {\n  par(mar = c(5, 5, 10, 5), mgp = c(2.5, 1, 0))\n  plot(as.phylo(hc),\n       type = \"phylogram\",\n       tip.color = c(\"#00468bff\",\"#ed0000ff\",\"#42b540ff\",\"#0099b4ff\")[clus], \n       label.offset = 1,\n       cex = 1, font = 2, use.edge.length = T\n       )\n  title(\"Dendrogram Plot\", line = 1)\n  })\n\np\n\n\n\n\n\n\n\n图 1: D3 词云",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Dendrogram"
    ]
  },
  {
    "objectID": "Hiplot/122-moon-charts.html",
    "href": "Hiplot/122-moon-charts.html",
    "title": "月亮饼图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Moon charts 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/moon-charts?lang=zh_cn\n月亮图是一种使用月亮的盈缺来反应数据大小的图形。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Moon charts"
    ]
  },
  {
    "objectID": "Hiplot/122-moon-charts.html#环境配置",
    "href": "Hiplot/122-moon-charts.html#环境配置",
    "title": "月亮饼图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; gggibbous; ggplot2\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"gggibbous\", quietly = TRUE)) {\n  install.packages(\"gggibbous\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(gggibbous)\nlibrary(ggplot2)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n gggibbous  * 0.1.1   2021-01-06 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Moon charts"
    ]
  },
  {
    "objectID": "Hiplot/122-moon-charts.html#数据准备",
    "href": "Hiplot/122-moon-charts.html#数据准备",
    "title": "月亮饼图",
    "section": "数据准备",
    "text": "数据准备\n载入数据为餐厅名称及各种餐厅内食物种类数，装饰风格种类数，成套餐具种类数和价格种类数。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/moon-charts/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndata[, 1] &lt;- factor(data[, 1], levels = unique(data[, 1]))\nrest_cols &lt;- colnames(data)[-1]\ntidyrest &lt;- reshape(\n  data,\n  varying = rest_cols,\n  v.names = \"Score\",\n  timevar = \"Category\",\n  times = factor(rest_cols, levels = rest_cols),\n  idvar = colnames(data)[1],\n  direction = \"long\"\n)\n\n# 查看数据\nhead(data)\n\n                     Restaurant Food Decor Service Price\n1       Anscombe\"s Luncheonette    5     2       4     4\n2                  Chai Squared    3     5       2     5\n3 Tukey\"s Honest Southern Diner    4     3       3     2\n4                  Bagels ANOVA    4     1       3     5\n5                 Spearmint Row    1     5       5     2",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Moon charts"
    ]
  },
  {
    "objectID": "Hiplot/122-moon-charts.html#可视化",
    "href": "Hiplot/122-moon-charts.html#可视化",
    "title": "月亮饼图",
    "section": "可视化",
    "text": "可视化\n\n# 月亮饼图\np &lt;- ggplot(tidyrest, aes(0, 0)) +\n  geom_moon(aes(ratio = (Score - 1) / 4), fill = \"black\") +\n  geom_moon(aes(ratio = 1 - (Score - 1) / 4), right = FALSE) +\n  facet_grid(Category ~ Restaurant, switch = \"y\") +\n  theme_minimal() +\n  theme(\n    panel.grid = element_blank(),\n    axis.text = element_blank(),\n    axis.title = element_blank()\n  )\n\np\n\n\n\n\n\n\n\n图 1: 月亮饼图\n\n\n\n\n\n图示第一行表示餐厅名称，第一列表示餐厅内不同变量，空白月亮表示数目为 1（数目最少），黑色月亮表示数目为 5（数目最多）的数据，随着数据的增多月亮黑色区域逐渐变大，即逐渐变为满月。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Moon charts"
    ]
  },
  {
    "objectID": "Hiplot/155-risk-plot.html",
    "href": "Hiplot/155-risk-plot.html",
    "title": "风险因子分析",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Risk Factor Analysis 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/risk-plot?lang=zh_cn",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Risk Factor Analysis"
    ]
  },
  {
    "objectID": "Hiplot/155-risk-plot.html#环境配置",
    "href": "Hiplot/155-risk-plot.html#环境配置",
    "title": "风险因子分析",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; survminer; fastStat; cutoff; ggplot2; cowplot\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"survminer\", quietly = TRUE)) {\n  install.packages(\"survminer\")\n}\nif (!requireNamespace(\"fastStat\", quietly = TRUE)) {\n  remotes::install_github(\"yikeshu0611/fastStat\")\n}\nif (!requireNamespace(\"cutoff\", quietly = TRUE)) {\n  install.packages(\"cutoff\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"cowplot\", quietly = TRUE)) {\n  install.packages(\"cowplot\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(survminer)\nlibrary(fastStat)\nlibrary(cutoff)\nlibrary(ggplot2)\nlibrary(cowplot)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n cowplot    * 1.2.0   2025-07-07 [1] RSPM\n cutoff     * 1.3     2019-12-20 [1] RSPM\n data.table * 1.17.8  2025-07-10 [1] RSPM\n fastStat   * 1.3     2025-11-02 [1] Github (yikeshu0611/fastStat@9c3e263)\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n ggpubr     * 0.6.2   2025-10-17 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n survminer  * 0.5.1   2025-09-02 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Risk Factor Analysis"
    ]
  },
  {
    "objectID": "Hiplot/155-risk-plot.html#数据准备",
    "href": "Hiplot/155-risk-plot.html#数据准备",
    "title": "风险因子分析",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/risk-plot/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndata &lt;- data[order(data[, \"riskscore\"], decreasing = F), ]\ncutoff_point &lt;- median(x = data$riskscore, na.rm = TRUE)\ndata$Group &lt;- ifelse(data$riskscore &gt; cutoff_point, \"High\", \"Low\")\ncut.position &lt;- (1:nrow(data))[data$riskscore == cutoff_point]\nif (length(cut.position) == 0) {\n  cut.position &lt;- which.min(abs(data$riskscore - cutoff_point))\n} else if (length(cut.position) &gt; 1) {\n  cut.position &lt;- cut.position[length(cut.position)]\n}\n## 生成画 A B 图所需data.frame\ndata2 &lt;- data[, c(\"time\", \"event\", \"riskscore\", \"Group\")]\n\n# 查看数据\nhead(data)\n\n  time event riskscore    TAGLN2       PDPN     TIMP1      EMP3 Group\n1 1014     0 0.8206424 1.0612565 0.04879016 0.1484200 0.1906204   Low\n2  246     1 1.0582599 1.2584610 0.20701417 0.3506569 0.2546422   Low\n3 2283     0 1.1693457 1.2697605 0.00000000 0.2231436 0.3364722   Low\n4 1757     0 1.2274565 1.7209793 0.00000000 0.5822156 0.2231436   Low\n5 3107     1 1.2806984 0.5933268 0.37156356 0.1043600 0.5709795   Low\n6  332     1 1.2891095 1.2892326 0.09531018 0.2070142 0.3987761   Low",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Risk Factor Analysis"
    ]
  },
  {
    "objectID": "Hiplot/155-risk-plot.html#可视化",
    "href": "Hiplot/155-risk-plot.html#可视化",
    "title": "风险因子分析",
    "section": "可视化",
    "text": "可视化\n\n# 风险因子分析\n## Figure A\nfA &lt;- ggplot(data = data2, aes(x = 1:nrow(data2), y = data2$riskscore, \n                               color = Group)) +\n  geom_point(size = 2) +\n  scale_color_manual(name = \"Risk Group\", \n                     values = c(\"Low\" = \"#0B45A5\", \"High\" = \"#E20B0B\")) +\n  geom_vline(xintercept = cut.position, linetype = \"dotted\", size = 1) +\n  theme(panel.grid = element_blank(), panel.background = element_blank(),\n        axis.ticks.x = element_blank(), axis.line.x = element_blank(),\n        axis.text.x = element_blank(), axis.title.x = element_blank(),\n        axis.title.y = element_text(size = 14, vjust = 1, angle = 90),\n        axis.text.y = element_text(size = 11),\n        axis.line.y = element_line(size = 0.5, colour = \"black\"),\n        axis.ticks.y = element_line(size = 0.5, colour = \"black\"),\n        legend.title = element_text(size = 13), \n        legend.text = element_text(size = 12)) +\n  coord_trans() +\n  ylab(\"Risk Score\") +\n  scale_x_continuous(expand = c(0, 3))\n## Figure B\nfB &lt;- ggplot(data = data2, aes(x = 1:nrow(data2), y = data2[, \"time\"],\n             color = factor(ifelse(data2[, \"event\"] == 1, \"Dead\", \"Alive\")))) +\n  geom_point(size = 2) +\n  scale_color_manual(name = \"Status\", values = c(\"Alive\" = \"#0B45A5\", \"Dead\" = \"#E20B0B\")) +\n  geom_vline(xintercept = cut.position, linetype = \"dotted\", size = 1) +\n  theme(panel.grid = element_blank(), panel.background = element_blank(),\n        axis.ticks.x = element_blank(), axis.line.x = element_blank(),\n        axis.text.x = element_blank(), axis.title.x = element_blank(),\n        axis.title.y = element_text(size = 14, vjust = 2, angle = 90),\n        axis.text.y = element_text(size = 11),\n        axis.ticks.y = element_line(size = 0.5),\n        axis.line.y = element_line(size = 0.5, colour = \"black\"),\n        legend.title = element_text(size = 13),\n        legend.text = element_text(size = 12)) +\n  ylab(\"Survival Time\") +\n  coord_trans() +\n  scale_x_continuous(expand = c(0, 3))\n## middle\nmiddle &lt;- ggplot(data2, aes(x = 1:nrow(data2), y = 1)) +\n  geom_tile(aes(fill = data2$Group)) +\n  scale_fill_manual(name = \"Risk Group\", values = c(\"Low\" = \"#0B45A5\", \"High\" = \"#E20B0B\")) +\n  theme(panel.grid = element_blank(), panel.background = element_blank(),\n        axis.line = element_blank(), axis.ticks = element_blank(),\n        axis.text = element_blank(), axis.title = element_blank(),\n        plot.margin = unit(c(0.15, 0, -0.3, 0), \"cm\"),\n        legend.title = element_text(size = 13),\n        legend.text = element_text(size = 12)) +\n  scale_x_continuous(expand = c(0, 3)) +\n  xlab(\"\")\n## Figure C\nheatmap_genes &lt;- c(\"TAGLN2\", \"PDPN\", \"TIMP1\", \"EMP3\")\ndata3 &lt;- data[, heatmap_genes]\nif (length(heatmap_genes) == 1) {\n  data3 &lt;- data.frame(data3)\n  colnames(data3) &lt;- heatmap_genes\n}\n# 归一化\nfor (i in 1:ncol(data3)) {\n  data3[, i] &lt;- (data3[, i] - mean(data3[, i], na.rm = TRUE)) /\n  sd(data3[, i], na.rm = TRUE)\n}\ndata4 &lt;- cbind(id = 1:nrow(data3), data3)\ndata5 &lt;- reshape2::melt(data4, id.vars = \"id\")\nfC &lt;- ggplot(data5, aes(x = id, y = variable, fill = value)) +\n  geom_raster() +\n  theme(panel.grid = element_blank(), panel.background = element_blank(),\n        axis.line = element_blank(), axis.ticks = element_blank(),\n        axis.text.x = element_blank(), axis.title = element_blank(),\n        plot.background = element_blank()) +\n  scale_fill_gradient2(name = \"Expression\", low = \"#0B45A5\", mid = \"#FFFFFF\",\n                       high = \"#E20B0B\") +\n  theme(axis.text = element_text(size = 11)) +\n  theme(legend.title = element_text(size = 13), \n        legend.text = element_text(size = 12)) +\n  scale_x_continuous(expand = c(0, 3))\n\np &lt;- plot_grid(fA, fB, middle, fC, ncol = 1, rel_heights = c(0.1, 0.1, 0.01, 0.15))\n\np\n\n\n\n\n\n\n\n图 1: 风险因子分析",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Risk Factor Analysis"
    ]
  },
  {
    "objectID": "Hiplot/139-pie-group.html",
    "href": "Hiplot/139-pie-group.html",
    "title": "分组饼图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Pie Group 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/pie-group?lang=zh_cn",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pie Group"
    ]
  },
  {
    "objectID": "Hiplot/139-pie-group.html#环境配置",
    "href": "Hiplot/139-pie-group.html#环境配置",
    "title": "分组饼图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; patchwork; ggplotify; cowplot\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"patchwork\", quietly = TRUE)) {\n  install.packages(\"patchwork\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\nif (!requireNamespace(\"cowplot\", quietly = TRUE)) {\n  install.packages(\"cowplot\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(patchwork)\nlibrary(ggplotify)\nlibrary(cowplot)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n cowplot    * 1.2.0   2025-07-07 [1] RSPM\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplotify  * 0.1.3   2025-09-20 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n patchwork  * 1.3.2   2025-08-25 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pie Group"
    ]
  },
  {
    "objectID": "Hiplot/139-pie-group.html#数据准备",
    "href": "Hiplot/139-pie-group.html#数据准备",
    "title": "分组饼图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/pie-group/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndata[,\"genre\"] &lt;- factor(data[,\"genre\"], levels = unique(data[,\"genre\"]))\ndata[,\"mpaa\"] &lt;- factor(data[,\"mpaa\"], levels = unique(data[,\"mpaa\"]))\n\n# 查看数据\nhead(data)\n\n                                               title year length budget rating\n1                          Shawshank Redemption, The 1994    142     25    9.1\n2     Lord of the Rings: The Return of the King, The 2003    251     94    9.0\n3 Lord of the Rings: The Fellowship of the Ring, The 2001    208     93    8.8\n4             Lord of the Rings: The Two Towers, The 2002    223     94    8.8\n5                                       Pulp Fiction 1994    168      8    8.8\n6                                   Schindler's List 1993    195     25    8.8\n   votes  mpaa  genre\n1 149494     R  Drama\n2 103631 PG-13 Action\n3 157608 PG-13 Action\n4 114797 PG-13 Action\n5 132745     R  Drama\n6  97667     R  Drama",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pie Group"
    ]
  },
  {
    "objectID": "Hiplot/139-pie-group.html#可视化",
    "href": "Hiplot/139-pie-group.html#可视化",
    "title": "分组饼图",
    "section": "可视化",
    "text": "可视化\n\n# 分组饼图\ncol &lt;- c(\"#E64B35FF\",\"#4DBBD5FF\",\"#00A087FF\",\"#3C5488FF\",\"#F39B7FFF\",\"#8491B4FF\",\n         \"#91D1C2FF\",\"#DC0000FF\",\"#7E6148FF\",\"#B09C85FF\")\nplist &lt;- list()\nfor (i in 1:length(unique(data[,\"mpaa\"]))) {\n  data_tmp &lt;- data[data[,\"mpaa\"] == unique(data[,\"mpaa\"])[i],]\n  x &lt;- table(data_tmp[,\"genre\"])\n  ptmp &lt;- as.ggplot(function(){\n    par(oma=c(0,0,0,0))\n    pie(x,\n      labels = sprintf(\"%s\\n(n=%s, %s%%)\", names(x), x,\n        round(x / sum(x) * 100, 0)),\n      col = col,\n      main = paste0(\"mpaa\", \":\", unique(data[,\"mpaa\"])[i]),\n      edges = 200,\n      radius = 0.8,\n      clockwise = F\n    )\n  })\n  plist[[i]] &lt;- ptmp\n}\n\nplot_grid(plotlist = plist, ncol = 2)\n\n\n\n\n\n\n\n图 1: 分组饼图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pie Group"
    ]
  },
  {
    "objectID": "Hiplot/165-slopegraph.html",
    "href": "Hiplot/165-slopegraph.html",
    "title": "斜面图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Slopegraph 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/slopegraph?lang=zh_cn\n斜面图可以用于展示数值变化情况。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Slopegraph"
    ]
  },
  {
    "objectID": "Hiplot/165-slopegraph.html#环境配置",
    "href": "Hiplot/165-slopegraph.html#环境配置",
    "title": "斜面图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; CGPfunctions; ggplot2\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"CGPfunctions\", quietly = TRUE)) {\n  install.packages(\"CGPfunctions\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(CGPfunctions)\nlibrary(ggplot2)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package      * version date (UTC) lib source\n CGPfunctions * 0.6.3   2025-11-17 [1] Github (ibecav/CGPfunctions@999a2c1)\n data.table   * 1.17.8  2025-07-10 [1] RSPM\n ggplot2      * 4.0.1   2025-11-14 [1] RSPM\n jsonlite     * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Slopegraph"
    ]
  },
  {
    "objectID": "Hiplot/165-slopegraph.html#数据准备",
    "href": "Hiplot/165-slopegraph.html#数据准备",
    "title": "斜面图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/slopegraph/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndata[, \"country\"] &lt;- factor(data[ ,\"country\"], levels = unique(data[ ,\"country\"]))\ndata[, \"year\"] &lt;- factor(data[ ,\"year\"], levels = unique(data[ ,\"year\"]))\n\n# 查看数据\nhead(data)\n\n      country continent year lifeExp     pop gdpPercap\n1  Costa Rica  Americas 1992      76 3173216  6160.416\n2  Costa Rica  Americas 1997      77 3518107  6677.045\n3  Costa Rica  Americas 2002      78 3834934  7723.447\n4  Costa Rica  Americas 2007      79 4133884  9645.061\n5 El Salvador  Americas 1992      67 5274649  4444.232\n6 El Salvador  Americas 1997      70 5783439  5154.825",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Slopegraph"
    ]
  },
  {
    "objectID": "Hiplot/165-slopegraph.html#可视化",
    "href": "Hiplot/165-slopegraph.html#可视化",
    "title": "斜面图",
    "section": "可视化",
    "text": "可视化\n\n# 斜面图\np &lt;- newggslopegraph(data, year, lifeExp, country) +\n  labs(subtitle = \"\", title = \"Slope Graph\", x = \"Life Expectancy (years)\",\n       y = \"country\", caption = \"\") +\n  scale_color_manual(values = c(\"#3B4992FF\", \"#EE0000FF\", \"#008B45FF\",\n                               \"#631879FF\", \"#008280FF\", \"#BB0021FF\")) +\n  theme_minimal() +\n  theme(plot.title = element_text(hjust = 0.5))\n\np\n\n\n\n\n\n\n\n图 1: 斜面图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Slopegraph"
    ]
  },
  {
    "objectID": "Hiplot/149-r-code-flow.html",
    "href": "Hiplot/149-r-code-flow.html",
    "title": "R 脚本逻辑可视化",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot R Script Flow 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/r-code-flow?lang=zh_cn\nR 脚本逻辑可视化能够实现对 if，else 等逻辑函数进行可视化的窗口。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "R Script Flow"
    ]
  },
  {
    "objectID": "Hiplot/149-r-code-flow.html#环境配置",
    "href": "Hiplot/149-r-code-flow.html#环境配置",
    "title": "R 脚本逻辑可视化",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: flow\n\n\n# 安装包\nif (!requireNamespace(\"flow\", quietly = TRUE)) {\n  install.packages(\"flow\")\n}\n\n# 加载包\nlibrary(flow)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package * version date (UTC) lib source\n flow    * 0.2.0   2023-06-06 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "R Script Flow"
    ]
  },
  {
    "objectID": "Hiplot/149-r-code-flow.html#数据准备",
    "href": "Hiplot/149-r-code-flow.html#数据准备",
    "title": "R 脚本逻辑可视化",
    "section": "数据准备",
    "text": "数据准备\n载入数据为 R 语言 if，else 函数代码\n\n# 加载数据\ncode &lt;- function(){\n  if (x &lt; 10) {\n    a &lt;- 1\n  } else {\n    a &lt;- 2\n  }\n  if (a == 2) {\n    c &lt;- d\n  } else {\n    d &lt;- a\n  }\n}",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "R Script Flow"
    ]
  },
  {
    "objectID": "Hiplot/149-r-code-flow.html#可视化",
    "href": "Hiplot/149-r-code-flow.html#可视化",
    "title": "R 脚本逻辑可视化",
    "section": "可视化",
    "text": "可视化\n\n# R 脚本逻辑可视化\np &lt;- flow_view(code)\n\np\n\n\n\n\n\n\n\n图 1: R 脚本逻辑可视化\n\n\n\n图示表示如果变量 x &lt; 10，a = 1,如果变量 x &gt; 10，a = 2；如果 a = 2，则 c = d，如果 a 不等于2，则 d = a。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "R Script Flow"
    ]
  },
  {
    "objectID": "Hiplot/054-fan.html",
    "href": "Hiplot/054-fan.html",
    "title": "扇形图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Fan Plot 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/fan?lang=zh_cn\n扇形图是旨在以所占扇形的大小清楚表示各组数据所占百分比的统计图表。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Fan Plot"
    ]
  },
  {
    "objectID": "Hiplot/054-fan.html#环境配置",
    "href": "Hiplot/054-fan.html#环境配置",
    "title": "扇形图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; plotrix; ggplotify\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"plotrix\", quietly = TRUE)) {\n  install.packages(\"plotrix\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(plotrix)\nlibrary(ggplotify)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplotify  * 0.1.3   2025-09-20 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n plotrix    * 3.8-13  2025-11-15 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Fan Plot"
    ]
  },
  {
    "objectID": "Hiplot/054-fan.html#数据准备",
    "href": "Hiplot/054-fan.html#数据准备",
    "title": "扇形图",
    "section": "数据准备",
    "text": "数据准备\n载入数据为不同分组及其数据。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/fan/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 查看数据\nhead(data)\n\n   group value\n1 Group1    13\n2 Group2    34\n3 Group3    21\n4 Group4    43",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Fan Plot"
    ]
  },
  {
    "objectID": "Hiplot/054-fan.html#可视化",
    "href": "Hiplot/054-fan.html#可视化",
    "title": "扇形图",
    "section": "可视化",
    "text": "可视化\n\n# Cox 模型森林图\np &lt;- as.ggplot(function() {\n  fan.plot(data[, 2], main = \"\", labels = as.character(data[, 1]),\n           col = c(\"#E64B35FF\",\"#4DBBD5FF\",\"#00A087FF\",\"#3C5488FF\"))\n  })\n\np\n\n\n\n\n\n\n\n图 1: Cox 模型森林图\n\n\n\n\n\n不同颜色表示不同组群 ，不同面积表示数据及占比。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Fan Plot"
    ]
  },
  {
    "objectID": "Hiplot/133-pareto-chart.html",
    "href": "Hiplot/133-pareto-chart.html",
    "title": "帕累托图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Pareto Chart 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/pareto-chart?lang=zh_cn",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pareto Chart"
    ]
  },
  {
    "objectID": "Hiplot/133-pareto-chart.html#环境配置",
    "href": "Hiplot/133-pareto-chart.html#环境配置",
    "title": "帕累托图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pareto Chart"
    ]
  },
  {
    "objectID": "Hiplot/133-pareto-chart.html#数据准备",
    "href": "Hiplot/133-pareto-chart.html#数据准备",
    "title": "帕累托图",
    "section": "数据准备",
    "text": "数据准备\n案例数据为某商品在多个平台的销量数据，插件会为销量数据自动降序排列绘制条形图，同时计算累积销量绘制累积折线图。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/pareto-chart/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndata &lt;- data[order(-data[[\"sales\"]]), ]\ndata[[\"channel\"]] &lt;- factor(data[[\"channel\"]], levels = data[[\"channel\"]])\n## 计算百分比\ndata$accumulating &lt;- cumsum(data[[\"sales\"]])\nmax_y &lt;- max(data[[\"sales\"]])\ncal_num &lt;- sum(data[[\"sales\"]]) / max_y\ndata$accumulating &lt;- data$accumulating / cal_num\n\n# 查看数据\nhead(data)\n\n    channel sales accumulating\n2        JD   500     132.9787\n5     Tmall   400     239.3617\n4 Pinduoduo   300     319.1489\n3    Amazon   230     380.3191\n6    Shopee   200     433.5106\n1    TaoBao   100     460.1064",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pareto Chart"
    ]
  },
  {
    "objectID": "Hiplot/133-pareto-chart.html#可视化",
    "href": "Hiplot/133-pareto-chart.html#可视化",
    "title": "帕累托图",
    "section": "可视化",
    "text": "可视化\n\n# 帕累托图\np &lt;- ggplot(data, aes(x = channel, y = sales, fill = channel)) +\n  geom_bar(stat = \"identity\") +\n  geom_line(aes(y = accumulating), group = 1) +\n  geom_point(aes(y = accumulating), show.legend = FALSE) +\n  scale_y_continuous(sec.axis = sec_axis(trans = ~ . / max_y * 100, name = \"Percentage\")) +\n  scale_fill_manual(values = c(\"#E64B35FF\",\"#4DBBD5FF\",\"#00A087FF\",\"#3C5488FF\",\n                               \"#F39B7FFF\",\"#8491B4FF\",\"#91D1C2FF\",\"#DC0000FF\")) +\n  theme_bw()\n\np\n\n\n\n\n\n\n\n图 1: 帕累托图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pareto Chart"
    ]
  },
  {
    "objectID": "Hiplot/016-bubble.html",
    "href": "Hiplot/016-bubble.html",
    "title": "气泡图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Bubble 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/bubble?lang=zh_cn\n气泡图是在散点图的基础上，用气泡的大小来展示第三个变量,从而能够同时对三个变量进行对比分析的统计图表。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Bubble"
    ]
  },
  {
    "objectID": "Hiplot/016-bubble.html#环境配置",
    "href": "Hiplot/016-bubble.html#环境配置",
    "title": "气泡图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2; stringr\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"stringr\", quietly = TRUE)) {\n  install.packages(\"stringr\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(stringr)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n stringr    * 1.6.0   2025-11-04 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Bubble"
    ]
  },
  {
    "objectID": "Hiplot/016-bubble.html#数据准备",
    "href": "Hiplot/016-bubble.html#数据准备",
    "title": "气泡图",
    "section": "数据准备",
    "text": "数据准备\n载入数据为 GO Term, Gene Ridio,基因数和 P 值。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/bubble/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndata[, 1] &lt;- str_to_sentence(str_remove(data[, 1], pattern = \"\\\\w+:\\\\d+\\\\W\"))\ntopnum &lt;- 7\ndata &lt;- data[1:topnum, ]\ndata[, 1] &lt;- factor(data[, 1], level = rev(unique(data[, 1])))\n\n# 查看数据\nhead(data)\n\n                               Term Count     Ratio   PValue\n1                   Immune response    20 10.471204 9.61e-08\n2     Defense response to bacterium    11  5.759162 3.02e-06\n3                   Cell chemotaxis     8  4.188482 5.14e-06\n4                     Cell adhesion    17  8.900524 2.73e-05\n5             Complement activation     8  4.188482 3.56e-05\n6 Extracellular matrix organization    11  5.759162 4.23e-05",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Bubble"
    ]
  },
  {
    "objectID": "Hiplot/016-bubble.html#可视化",
    "href": "Hiplot/016-bubble.html#可视化",
    "title": "气泡图",
    "section": "可视化",
    "text": "可视化\n\n# 气泡图\np &lt;- ggplot(data, aes(Ratio, Term)) +\n  geom_point(aes(size = Count, colour = -log10(PValue))) +\n  scale_colour_gradient(low = \"#00438E\", high = \"#E43535\") +\n  labs(colour = \"-log10 (PValue)\", size = \"Count\", x = \"Ratio\", y = \"Term\", \n       title = \"Bubble Plot\") +\n  scale_x_continuous(limits = c(0, max(data$Ratio) * 1.2)) +\n  guides(color = guide_colorbar(order = 1), size = guide_legend(order = 2)) +\n  scale_y_discrete(labels = function(x) {str_wrap(x, width = 65)}) +\n  theme_bw() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 1: 气泡图\n\n\n\n\n\nx 轴表示 Gene Ridio，y 轴是 GO Term; 点的大小表示基因数，点的颜色代表 P 值的高低。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Bubble"
    ]
  },
  {
    "objectID": "Hiplot/002-barcode-plot.html",
    "href": "Hiplot/002-barcode-plot.html",
    "title": "条码图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Barcode Plot 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/barcode-plot?lang=zh_cn\n条码图适用于展示大量数据的分布情况。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Barcode Plot"
    ]
  },
  {
    "objectID": "Hiplot/002-barcode-plot.html#环境配置",
    "href": "Hiplot/002-barcode-plot.html#环境配置",
    "title": "条码图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Barcode Plot"
    ]
  },
  {
    "objectID": "Hiplot/002-barcode-plot.html#数据准备",
    "href": "Hiplot/002-barcode-plot.html#数据准备",
    "title": "条码图",
    "section": "数据准备",
    "text": "数据准备\n案例数据为某商品在三个地区各500个门店的销售额。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/barcode-plot/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 查看数据\nhead(data)\n\n     region    sales\n1 GuangDong 42.54612\n2 GuangDong 46.26102\n3 GuangDong 46.00448\n4 GuangDong 45.05684\n5 GuangDong 48.67611\n6 GuangDong 56.95071",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Barcode Plot"
    ]
  },
  {
    "objectID": "Hiplot/002-barcode-plot.html#可视化",
    "href": "Hiplot/002-barcode-plot.html#可视化",
    "title": "条码图",
    "section": "可视化",
    "text": "可视化\n\n# 条码图\np &lt;- ggplot(data, aes(x = sales, y = region)) +\n  geom_tile(width = 0.01, height = 0.9, fill = \"#606fcc\") + # 控制条带的宽度和高度\n  theme_bw() +\n  labs(title = \"Sales report\", x = \"Sales\", y = \"Region\") +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 1: 条码图\n\n\n\n\n\n通过条码图可以看到该商品在广东和福建地区销售额分布在50左右的门店数量较多，且在广东各门店之间销售额差异较小，分布较集中。\n\n\n\n\n\n\n提示\n\n\n\n特殊参数: \n\nwidth：条带宽度\nheight：条带高度\ncolor：条带颜色",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Barcode Plot"
    ]
  },
  {
    "objectID": "Template/contribution_0323.html",
    "href": "Template/contribution_0323.html",
    "title": "中文",
    "section": "",
    "text": "先建图表征集issue，进行审核确定：\n\n根据目标任务确定执行的可视化图表类型。\n\n分别按图表建issue让成员列资料\n\n确定创建可视化教程所需的生物医学数据类型；\n根据可视化应用场景优化教程撰写的侧重点（eg. 需要着重介绍的函数/参数、是否要加入常用统计学分析）。\n\n分配成员申领完成\n完成图文撰写需要遵循项目文档规范\n\n参考根据现有可视化教程制作的qmd文档撰写；\n主要模块：可视化图表及其应用场景介绍、环境配置、基础绘图代码、进阶绘图代码、生物医学领域应用（及复现）……\n\n翻译任务的申领和处理"
  },
  {
    "objectID": "ToolLinks.html#网页可视化应用",
    "href": "ToolLinks.html#网页可视化应用",
    "title": "工具链接",
    "section": "网页可视化应用",
    "text": "网页可视化应用",
    "crumbs": [
      "<i class='fa-solid fa-laptop-code'></i> Tool Links"
    ]
  },
  {
    "objectID": "Omics/SankeyBubblePlot.html#环境配置",
    "href": "Omics/SankeyBubblePlot.html#环境配置",
    "title": "组合桑基气泡图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: 跨平台（Linux/MacOS/Windows）\n编程语言: R\n依赖包: tidyverse; readr; ggalluvial; patchwork\n\n\n# 安装包\nif (!requireNamespace(\"tidyverse\", quietly = TRUE)) {\n  install.packages(\"tidyverse\")\n}\nif (!requireNamespace(\"readr\", quietly = TRUE)) {\n  install.packages(\"readr\")\n}\nif (!requireNamespace(\"ggalluvial\", quietly = TRUE)) {\n  install.packages(\"ggalluvial\")\n}\nif (!requireNamespace(\"patchwork\", quietly = TRUE)) {\n  install.packages(\"patchwork\")\n}\n\n# 加载包\nlibrary(tidyverse)\nlibrary(readr)\nlibrary(ggalluvial)\nlibrary(patchwork)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n dplyr      * 1.1.4   2023-11-17 [1] RSPM\n forcats    * 1.0.1   2025-09-25 [1] RSPM\n ggalluvial * 0.12.5  2023-02-22 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n lubridate  * 1.9.4   2024-12-08 [1] RSPM\n patchwork  * 1.3.2   2025-08-25 [1] RSPM\n purrr      * 1.2.0   2025-11-04 [1] RSPM\n readr      * 2.1.6   2025-11-14 [1] RSPM\n stringr    * 1.6.0   2025-11-04 [1] RSPM\n tibble     * 3.3.0   2025-06-08 [1] RSPM\n tidyr      * 1.3.2   2025-12-19 [1] RSPM\n tidyverse  * 2.0.0   2023-02-22 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "SankeyBubblePlot"
    ]
  },
  {
    "objectID": "Omics/SankeyBubblePlot.html#数据准备",
    "href": "Omics/SankeyBubblePlot.html#数据准备",
    "title": "组合桑基气泡图",
    "section": "数据准备",
    "text": "数据准备\n我们导入来自 DAVID 的网络药理学注释分析通路富集数据。\n\n# 读取数据\ndata &lt;- read_tsv(\"files/DAVID.txt\")\n\n# 添加新分类列\nget_category &lt;- function(cat) {\n  if (grepl(\"BP\", cat)) return(\"BP\")\n  if (grepl(\"MF\", cat)) return(\"MF\")\n  if (grepl(\"CC\", cat)) return(\"CC\")\n  if (grepl(\"KEGG\", cat)) return(\"KEGG\")\n  return(NA)\n}\ndata$MainCategory &lt;- sapply(data$Category, get_category)\n\n# 剔除 SMART 和 NA\ndata2 &lt;- data %&gt;%\n  filter(!grepl(\"SMART\", Category)) %&gt;%\n  filter(!is.na(MainCategory))\n\n# 每类排序并取前10\ntopN &lt;- function(data, n=10) {\n  data %&gt;%\n  arrange(desc(Count), PValue) %&gt;%\n  head(n)\n}\nresult &lt;- data2 %&gt;%\n  group_by(MainCategory) %&gt;%\n  group_modify(~topN(.x, 10)) %&gt;%\n  ungroup()\n\n# KEGG 通路注释\nresult &lt;- result %&gt;%\n  mutate(\n    Source = ifelse(MainCategory == \"KEGG\", \"KEGG\", \"GO\"),\n    KEGG_Group = case_when(\n      MainCategory == \"KEGG\" & str_detect(Term,\"Neuro|synapse|neurodegeneration|Alzheimer|Parkinson|Prion\") ~ \"Nervous system\",\n      MainCategory == \"KEGG\" & str_detect(Term, \"Cytokine|inflammatory\") ~ \"Immune system\",\n      MainCategory == \"KEGG\" & str_detect(Term, \"Lipid|atherosclerosis\") ~ \"Lipid metabolism\",\n      MainCategory == \"KEGG\" ~ \"Other KEGG\",\n      TRUE ~ NA_character_\n      ),\n    GO_Group = ifelse(MainCategory != \"KEGG\", MainCategory, NA)\n    )\nalluvial_data &lt;- result %&gt;%\n  mutate(\n    Term = str_replace(Term, \"^GO:\\\\d+~\", \"\"), # 去除 GO 编号\n    Term = str_replace(Term, \"^hsa\\\\d+:?\", \"\") # 去除 KEGG 编号\n    )\n\n# GO 部分\ngo_links &lt;- result %&gt;%\n  filter(Source == \"GO\") %&gt;%\n  transmute(\n    Source = Source,\n    Group = GO_Group,\n    Term = Term,\n    Count = Count\n    )\n\n# KEGG 部分\nkegg_links &lt;- result %&gt;%\n  filter(Source == \"KEGG\") %&gt;%\n  transmute(\n    Source = Source,\n    Group = KEGG_Group,\n    Term = Term,\n    Count = Count\n    )\n\n# 生成桑基图数据\nalluvial_data &lt;- result %&gt;%\n  mutate(Group = ifelse(Source == \"KEGG\", KEGG_Group, GO_Group)) %&gt;%\n  select(Source, Group, Term, Count, FDR, FoldEnrichment, MainCategory)\n\n# 确保字符型\nalluvial_data$Source &lt;- as.character(alluvial_data$Source)\nalluvial_data$Group &lt;- as.character(alluvial_data$Group)\nalluvial_data$Term &lt;- as.character(alluvial_data$Term)\n\n# 合并\nalluvial_data &lt;- bind_rows(go_links, kegg_links)\n\n# 将 term 列按照 count 值从小到大排列，并且保证气泡图和桑基图的顺序一致\nterm_levels &lt;- alluvial_data %&gt;%\n  arrange(Source, Group, desc(Count)) %&gt;%\n  pull(Term) %&gt;%\n  unique()\nalluvial_data$Term &lt;- factor(alluvial_data$Term, levels = term_levels)\n\n# 查看数据结构\nhead(alluvial_data, 5)\n\n# A tibble: 5 × 4\n  Source Group Term                                                        Count\n  &lt;chr&gt;  &lt;chr&gt; &lt;fct&gt;                                                       &lt;dbl&gt;\n1 GO     BP    GO:0010628~positive regulation of gene expression              12\n2 GO     BP    GO:0045944~positive regulation of transcription by RNA pol…    11\n3 GO     BP    GO:0007187~G protein-coupled receptor signaling pathway, c…    10\n4 GO     BP    GO:0007268~chemical synaptic transmission                      10\n5 GO     BP    GO:0006954~inflammatory response                               10",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "SankeyBubblePlot"
    ]
  },
  {
    "objectID": "Omics/SankeyBubblePlot.html#可视化",
    "href": "Omics/SankeyBubblePlot.html#可视化",
    "title": "组合桑基气泡图",
    "section": "可视化",
    "text": "可视化\n\n1. 桑基图\n\n# 桑基图（Term列不显示标签）\n\n# 确保 Group 为字符型且无 NA\nalluvial_data$Group &lt;- as.character(alluvial_data$Group)\nalluvial_data$Group[is.na(alluvial_data$Group)] &lt;- \"Other\"\n# 计算每个 Group 的总 Count\ngroup_order &lt;- alluvial_data %&gt;%\n  group_by(Group) %&gt;%\n  summarise(group_count = sum(Count, na.rm = TRUE)) %&gt;%\n  arrange(desc(group_count)) %&gt;%\n  pull(Group)\n# 设置 group 为有序因子\nalluvial_data$Group &lt;- factor(alluvial_data$Group, levels = group_order)\n# 对 Term 列进行排序，设置 term 为有序因子\nterm_order &lt;- alluvial_data %&gt;%\n  group_by(Term) %&gt;%\n  summarise(total_count = sum(Count, na.rm = TRUE)) %&gt;%\n  arrange(desc(total_count)) %&gt;%\n  pull(Term)\nalluvial_data$Term &lt;- factor(alluvial_data$Term, levels = term_order)\n# 重新获取 group 的有序标签\ngroup_labels &lt;- levels(alluvial_data$Group)\ngroup_labels &lt;- c(\"BP\", \"MF\", \"CC\", \"Nervous system\", \"Immune system\", \"Lipid metabolism\", \"Other KEGG\")\nterm_labels &lt;- levels(alluvial_data$Term)\n\np1 &lt;- ggplot(\n  alluvial_data,\n  aes(axis1 = Source, axis2 = Group, axis3 = Term, y = 1)) +\n  geom_alluvium(aes(fill = Group), width = 1/12, alpha = 0.8) +\n  geom_stratum(width = 1/12, fill = \"grey\", color = \"black\") +\n  scale_fill_manual(values = c(\n    \"BP\" = \"#33ad37\",\"MF\" = \"#f2c867\",\"CC\" = \"#d45327\", \n    \"Nervous system\" = \"#2eb6aa\", \"Immune system\" = \"#3e4999\", \n    \"Lipid metabolism\" = \"#4fc1e4\", \"Other KEGG\" = \"#e0c4ce\")) +\n  geom_text(stat = \"stratum\", aes(label = ifelse(\n    after_stat(stratum) %in% group_labels, after_stat(stratum),\n    ifelse(after_stat(stratum) %in% term_labels, after_stat(stratum), \"\")\n    )), size = 3) +\n  scale_x_discrete(\n    limits = c(\"Source\", \"Group\", \"Term\"),\n    labels = c(\"Source\", \"Group\", \"term\"), expand = c(.05, .05)) +\n  labs(title = NULL, y = NULL, x = NULL) +\n  theme_minimal(base_size = 12) +\n  theme(\n    axis.title.x = element_blank(),\n    axis.text.x = element_text(size = 10),\n    axis.text.y = element_blank(),\n    axis.ticks.y = element_blank(),\n    plot.margin = margin(5, 5, 5, 5), # 这里和 p2 保持一致\n    panel.grid = element_blank()\n    ) +\n  guides(fill = \"none\")\n\np1\n\n\n\n\n\n\n\n图 1: 桑基图\n\n\n\n\n\n\n\n2. 气泡图\n\n# 气泡图（Term标签只在右侧）\n# 先准备 term_levels，确保顺序和 y 轴一致\nterm_levels &lt;- levels(alluvial_data$Term)\n# 生成气泡图数据\nalluvial_data &lt;- result %&gt;%\n  mutate(Group = ifelse(Source == \"KEGG\", KEGG_Group, GO_Group)) %&gt;%\n  select(Source, Group, Term, Count, FDR, FoldEnrichment, MainCategory)\n\np2 &lt;- ggplot(alluvial_data, aes(x = log2(FoldEnrichment), y = Term)) +\n  # 虚线棒：从 x = min_x - offset 到 x = log2(FoldEnrichment)\n  geom_segment(aes(\n    x = min(log2(FoldEnrichment), na.rm = TRUE) - 0.5,\n    xend = log2(FoldEnrichment),\n    y = Term, yend = Term),\n    linetype = \"dashed\", color = \"grey50\") +\n  # 左侧标签\n  geom_text(aes(\n    x = min(log2(FoldEnrichment), na.rm = TRUE) - 0.2,\n    label = Term\n    ), hjust = 1, size = 3) +\n  # 气泡\n  geom_point(aes(size = Count, color = -log10(FDR))) +\n  scale_y_discrete(limits = rev(term_levels), position = \"right\") +\n  scale_color_gradient(low = \"#4659a7\", high = \"#de4f30\") +\n  labs(title = NULL, x = \"log2(FoldEnrichment)\", y = NULL, color = \"-log10(FDR)\") +\n  theme_minimal() +\n  theme(\n    axis.text.y.left = element_blank(),\n    axis.text.y.right = element_blank(), # 右侧不显示标签\n    axis.title.y = element_blank(),\n    plot.margin = margin(5, 5, 5, 0),\n    panel.grid.major.y = element_blank()\n    )\n\np2\n\n\n\n\n\n\n\n图 2: 气泡图\n\n\n\n\n\n\n\n3. 拼接\n\ncombined_plot &lt;- p1 + p2 + plot_layout(widths = c(1.5, 2), guides = \"collect\")\nprint(combined_plot)\n\n\n\n\n\n\n\n图 3: 拼接",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "SankeyBubblePlot"
    ]
  },
  {
    "objectID": "Omics/VolcanoPlot.html",
    "href": "Omics/VolcanoPlot.html",
    "title": "火山图",
    "section": "",
    "text": "火山图用于两组之间的比较，得到两组之间的上调/下调，筛选依据为 p 值和 FC 值，转换为 -logP 值和 log2(FC) 值。导入数据可以是微生物组的 OTU 表格或 ASV 表格，或者转录组基因表达的表格，或者是代谢组学的 features 表格等多组学数据。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "VolcanoPlot"
    ]
  },
  {
    "objectID": "Omics/VolcanoPlot.html#示例",
    "href": "Omics/VolcanoPlot.html#示例",
    "title": "火山图",
    "section": "示例",
    "text": "示例",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "VolcanoPlot"
    ]
  },
  {
    "objectID": "Omics/VolcanoPlot.html#环境配置",
    "href": "Omics/VolcanoPlot.html#环境配置",
    "title": "火山图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：tidyverse; readxl; ggrepel\n\n\n# 安装包\nif (!requireNamespace(\"tidyverse\", quietly = TRUE)) {\n  install.packages(\"tidyverse\")\n}\nif (!requireNamespace(\"readxl\", quietly = TRUE)) {\n  install.packages(\"readxl\")\n}\nif (!requireNamespace(\"ggrepel\", quietly = TRUE)) {\n  install.packages(\"ggrepel\")\n}\n\n# 加载包\nlibrary(tidyverse)\nlibrary(readxl)\nlibrary(ggrepel)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package   * version date (UTC) lib source\n dplyr     * 1.1.4   2023-11-17 [1] RSPM\n forcats   * 1.0.1   2025-09-25 [1] RSPM\n ggplot2   * 4.0.1   2025-11-14 [1] RSPM\n ggrepel   * 0.9.6   2024-09-07 [1] RSPM\n lubridate * 1.9.4   2024-12-08 [1] RSPM\n purrr     * 1.2.0   2025-11-04 [1] RSPM\n readr     * 2.1.6   2025-11-14 [1] RSPM\n readxl    * 1.4.5   2025-03-07 [1] RSPM\n stringr   * 1.6.0   2025-11-04 [1] RSPM\n tibble    * 3.3.0   2025-06-08 [1] RSPM\n tidyr     * 1.3.2   2025-12-19 [1] RSPM\n tidyverse * 2.0.0   2023-02-22 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "VolcanoPlot"
    ]
  },
  {
    "objectID": "Omics/VolcanoPlot.html#数据准备",
    "href": "Omics/VolcanoPlot.html#数据准备",
    "title": "火山图",
    "section": "数据准备",
    "text": "数据准备\n我们导入来自 omicshare 的火山图示例数据。\n\n# 读取Excel数据\ndata &lt;- read_excel(\"files/volcano.eg.xlsx\")\n\n# 重命名列名（处理特殊字符）\ndata &lt;- data %&gt;%\n  rename(log2FC = \"log2 Ratio(WT0/LOG)\", Pvalue = \"Pvalue\")\n# 处理 p-value 为 0 的情况（避免计算-Inf）\ndata &lt;- data %&gt;%\n  mutate(log10P = -log10(Pvalue + 1e-300)) # 确保处理了 P=0 的情况\n# 转为数值型，并处理转换失败的值（如无效字符）\ndata &lt;- data %&gt;%\n  mutate(\n    log2FC = as.numeric(log2FC) # 转换失败的值会变为 NA\n  )\n\n# 查找导致转换失败的原始值\ndata %&gt;%\n  filter(is.na(log2FC)) %&gt;%\n  select(log2FC) # 查看这些行的 log2FC 原始值\n\n# A tibble: 0 × 1\n# ℹ 1 variable: log2FC &lt;dbl&gt;\n\n# 根据实际情况修复数据（例如替换或删除异常值）\n# 示例：将\"Inf\"替换为实际数值或过滤掉\ndata &lt;- data %&gt;%\n  mutate(\n    log2FC = ifelse(log2FC == \"Inf\", 100, log2FC), # 根据需求调整\n    log2FC = as.numeric(log2FC)\n    ) %&gt;%\n  filter(!is.na(log2FC)) # 删除无法修复的行\n\n# 定义显著性（同时满足P值&lt;0.05且|log2FC|&gt;1）\n# 定义显著性分类（上调、下调、无显著）\ndata &lt;- data %&gt;%\n  mutate(\n    significant = case_when(\n      Pvalue &lt; 0.05 & log2FC &gt; 2 ~ \"Upregulated\", # 上调（红色）\n      Pvalue &lt; 0.05 & log2FC &lt; -2 ~ \"Downregulated\", # 下调（绿色）\n      TRUE ~ \"Not significant\" # 无显著（灰色）\n    )\n  )\n\n# 查看数据结构\nhead(data, 5)\n\n# A tibble: 5 × 10\n  GeneID         LOG_count WT0_count LOG_rpkm WT0_rpkm  log2FC    Pvalue     FDR\n  &lt;chr&gt;              &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;\n1 Unigene0000003     17243     17525   932.     942.    0.0168   5.15e-1 6.73e-1\n2 Unigene0000004        65       101     4.12     6.37  0.629    6.64e-3 1.79e-2\n3 Unigene0000005       909       984    36.9     39.7   0.108    1.26e-1 2.25e-1\n4 Unigene0000006      1376      1082    74.7     58.5  -0.353    1.17e-8 6.86e-8\n5 Unigene0000007       121        73    15.7      9.42 -0.736    7.42e-4 2.45e-3\n# ℹ 2 more variables: significant &lt;chr&gt;, log10P &lt;dbl&gt;",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "VolcanoPlot"
    ]
  },
  {
    "objectID": "Omics/VolcanoPlot.html#可视化",
    "href": "Omics/VolcanoPlot.html#可视化",
    "title": "火山图",
    "section": "可视化",
    "text": "可视化\n\n1. 基础火山图\n\n# 基础火山图\np &lt;- \n  ggplot(data, aes(x = log2FC, y = -log10(Pvalue))) + # 初步绘制火山图\n  # 绘制散点，按显著分类着色\n  geom_point(aes(color = significant), alpha = 0.6, size = 1.5) + \n  # 设置颜色映射（上调红，下调绿，无显著灰）\n  scale_color_manual(\n    values = c(\"Upregulated\" = \"red\", \"Downregulated\" = \"green\", \"Not significant\" = \"gray\"),\n    name = \"Significance\" # 图例标题\n    ) +\n  # 添加筛选阈值线\n  geom_vline(xintercept = c(-2, 2), linetype = \"dashed\", color = \"green\", linewidth = 0.5) + # log2FC阈值线\n  geom_hline(yintercept = -log10(0.05), linetype = \"dashed\", color = \"blue\", linewidth = 0.5) + # p值阈值线\n  # 调整坐标轴和标题\n  labs(x = \"log2(Fold Change)\", y = \"-log10(P-value)\",\n       title = \"Volcano Plot with Thresholds\") +\n  theme_minimal() +\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"), # 标题居中加粗\n        legend.position = \"right\") # 图例位置\n\np\n\n\n\n\n\n\n\n图 1: 基础火山图\n\n\n\n\n\n\n\n2. 带标签火山图\n\n# 添加标签\n# 步骤1：筛选需标注的基因\nlabel_data &lt;- data %&gt;%\n  filter(Pvalue &lt; 0.05) %&gt;% # 筛选显著基因\n  group_by(significant) %&gt;% # 按上下调控分组\n  top_n(10, abs(log2FC)) %&gt;% # 取 log2FC 绝对值最大的 10 个\n  ungroup()\n# 步骤2：定义标签颜色（浅红和浅绿）\nlabel_colors &lt;- c(\n  \"Upregulated\" = \"#FF9999\", # 浅红色\n  \"Downregulated\" = \"#99FF99\" # 浅绿色\n  )\n# 步骤3：绘制带标签的火山图\np &lt;- \n  ggplot(data, aes(x = log2FC, y = -log10(Pvalue))) +\n  geom_point(aes(color = significant), alpha = 0.6, size = 1.5) +\n  # 添加基因标签（仅标注目标基因）\n  geom_text_repel(\n    data = label_data,\n    aes(label = GeneID, color = significant), # 假设基因名列名为 OTU ID\n    size = 3,\n    box.padding = 0.5, # 标签间距\n    max.overlaps = 50, # 允许最大重叠\n    segment.color = \"grey50\", # 连接线颜色\n    show.legend = FALSE\n    ) +\n  # 设置颜色映射（原颜色+标签颜色）\n  scale_color_manual(\n    values = c(\"Upregulated\" = \"red\", \"Downregulated\" = \"green\", \"Not significant\" = \"gray\"),\n    guide = guide_legend(override.aes = list(\n      color = c(\"red\", \"green\", \"gray\"), # 图例颜色保持原色\n      label = \"\" # 图例中不显示文字\n      ))) +\n  # 控制标签颜色（浅红和浅绿）\n  scale_color_manual(\n    values = label_colors,\n    guide = \"none\" # 隐藏额外图例\n    ) +\n  # 保留原有阈值线和标题\n  geom_vline(xintercept = c(-2, 2), linetype = \"dashed\", color = \"black\") +\n  geom_hline(yintercept = -log10(0.05), linetype = \"dashed\", color = \"black\") +\n  labs(title = \"Volcano Plot with Top 20 Labels\") +\n  theme_minimal()\n\np\n\n\n\n\n\n\n\n图 2: 带标签火山图",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "VolcanoPlot"
    ]
  },
  {
    "objectID": "Omics/GwasSnpPlot.html",
    "href": "Omics/GwasSnpPlot.html",
    "title": "全基因组关联分析圈图",
    "section": "",
    "text": "全基因组关联分析（GWAS）结果可视化主要包含按染色体位置展示SNP圈图、SNP密度图、显著性筛选的曼哈顿图、比较观测 p 值与期望 p 值的分布的QQ图等，用于筛选到全基因水平的候选变异基因。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "GWAS Circos Plot"
    ]
  },
  {
    "objectID": "Omics/GwasSnpPlot.html#示例",
    "href": "Omics/GwasSnpPlot.html#示例",
    "title": "全基因组关联分析圈图",
    "section": "示例",
    "text": "示例",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "GWAS Circos Plot"
    ]
  },
  {
    "objectID": "Omics/GwasSnpPlot.html#环境配置",
    "href": "Omics/GwasSnpPlot.html#环境配置",
    "title": "全基因组关联分析圈图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：CMplot\n\n\n# 安装包\nif (!requireNamespace(\"CMplot\", quietly = TRUE)) {\n  install.packages(\"CMplot\")\n}\n\n# 加载包\nlibrary(CMplot)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package * version date (UTC) lib source\n CMplot  * 4.5.1   2024-01-19 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "GWAS Circos Plot"
    ]
  },
  {
    "objectID": "Omics/GwasSnpPlot.html#数据准备",
    "href": "Omics/GwasSnpPlot.html#数据准备",
    "title": "全基因组关联分析圈图",
    "section": "数据准备",
    "text": "数据准备\n示例数据包含60K液相芯片Pig的原始变异信息数据。\n\n# 示例数据\ndata(pig60K)\ndata &lt;- pig60K\n\n# 查看数据\nhead(data, 5)\n\n          SNP Chromosome Position    trait1    trait2    trait3\n1 ALGA0000009          1    52297 0.7738187 0.5119432 0.5119432\n2 ALGA0000014          1    79763 0.7738187 0.5119432 0.5119432\n3 ALGA0000021          1   209568 0.7583016 0.9840529 0.9840529\n4 ALGA0000022          1   292758 0.7200305 0.4888714 0.4888714\n5 ALGA0000046          1   747831 0.9736840 0.2209684 0.2209684",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "GWAS Circos Plot"
    ]
  },
  {
    "objectID": "Omics/GwasSnpPlot.html#可视化",
    "href": "Omics/GwasSnpPlot.html#可视化",
    "title": "全基因组关联分析圈图",
    "section": "可视化",
    "text": "可视化\n\n1. SNP筛选基因组圈图\n基因组圈图可以在相同占比下展示更多的染色体和性状，在多个性状比较时占极大优势。\n\n# SNP筛选基因组圈图\np &lt;- CMplot(\n  data,\n  type = \"p\",\n  plot.type = \"c\",\n  chr.labels = paste(\"Chr\", c(1:18, \"X\", \"Y\"), sep = \"\"),\n  r = 8,\n  cir.axis = TRUE,\n  outward = TRUE,\n  cir.axis.col = \"black\",\n  cir.chr.h = 2,\n  chr.den.col = \"black\",\n  file.output = FALSE,\n  verbose = FALSE,\n  mar = c(0,0,0,0)\n)\n\np\n\nNULL\n\n\n\n\n\n\n\n\n图 1: SNP筛选基因组圈图\n\n\n\n\n\n\n\n2. SNP染色体密度图\nSNP染色体密度图展示各个染色体上SNP密度分布。\n\n# SNP染色体密度图\np &lt;- capture.output(\n  CMplot(\n    data,\n    plot.type = \"d\",\n    bin.size = 1e6,\n    chr.den.col = c(\"darkgreen\", \"yellow\", \"red\"),\n    main = \"Density\",\n    file.output = FALSE,\n    verbose = FALSE\n  )\n)\n\nprint(p[1])\n\n[1] NA\n\n\n\n\n\n\n\n\n图 2: SNP染色体密度图\n\n\n\n\n\n\n\n3. SNP筛选曼哈顿图\nSNP筛选曼哈顿图便于展示5%或者1%的SNP显著性，同时也辅助鉴定关键染色体的集中效应。\n\n# SNP筛选曼哈顿图\np &lt;- CMplot(\n  data,\n  type = \"p\",\n  plot.type = \"m\",\n  LOG10 = TRUE,\n  threshold = NULL,\n  file.output = FALSE,\n  verbose = FALSE,\n  chr.labels.angle = 45\n)\n\np\n\nNULL\n\n\n\n\n\n\n\n\n图 3: SNP筛选曼哈顿图\n\n\n\n\n\n\n\n\n\n\n\n图 4: SNP筛选曼哈顿图\n\n\n\n\n\n\n\n\n\n\n\n图 5: SNP筛选曼哈顿图\n\n\n\n\n\n\n\n4. SNP基于的QQ图\nSNP基于的QQ图核心作用是检验 GWAS 分析中 SNP 的 P 值分布是否符合 “无关联假设下的期望分布”，以此判断分析结果的可靠性。\n\n# SNP基于的QQ图\np &lt;- CMplot(\n  data,\n  plot.type = \"q\",\n  box = FALSE,\n  conf.int = TRUE,\n  conf.int.col = NULL,\n  threshold.col = \"red\",\n  threshold.lty = 2,\n  file.output = FALSE,\n  verbose = FALSE\n)\n\np\n\nNULL\n\n\n\n\n\n\n\n\n图 6: SNP基于的QQ图\n\n\n\n\n\n\n\n\n\n\n\n图 7: SNP基于的QQ图\n\n\n\n\n\n\n\n\n\n\n\n图 8: SNP基于的QQ图",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "GWAS Circos Plot"
    ]
  },
  {
    "objectID": "Omics/ManhattanPlot.html",
    "href": "Omics/ManhattanPlot.html",
    "title": "曼哈顿图",
    "section": "",
    "text": "Manhattan plot，即曼哈顿图，是一种用于描述染色体上的突变与性状之间关联强弱的图，由于图形形似美国曼哈顿区的城市景观因此得名曼哈顿图。绘制曼哈顿图一般使用散点图的形式，但是也可以使用柱状图或折线图展示，常用R包qqman或者直接使用ggplot2绘制。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "ManhattanPlot"
    ]
  },
  {
    "objectID": "Omics/ManhattanPlot.html#示例",
    "href": "Omics/ManhattanPlot.html#示例",
    "title": "曼哈顿图",
    "section": "示例",
    "text": "示例\n\n\n\n\n\n曼哈顿图的横坐标为染色体位置，纵坐标为Pvalue或者诸如ΔSNP、ED等一切可以表示突变位点与性状之间关联强弱的值。下面将使用Pvalue作为示例。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "ManhattanPlot"
    ]
  },
  {
    "objectID": "Omics/ManhattanPlot.html#环境配置",
    "href": "Omics/ManhattanPlot.html#环境配置",
    "title": "曼哈顿图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：qqman; tidyverse; aplot\n\n\n# 安装包\nif (!requireNamespace(\"qqman\", quietly = TRUE)) {\n  install.packages(\"qqman\")\n}\nif (!requireNamespace(\"tidyverse\", quietly = TRUE)) {\n  install.packages(\"tidyverse\")\n}\nif (!requireNamespace(\"aplot\", quietly = TRUE)) {\n  install.packages(\"aplot\")\n}\n\n# 加载包\nlibrary(qqman)\nlibrary(tidyverse)\nlibrary(aplot)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package   * version date (UTC) lib source\n aplot     * 0.2.9   2025-09-12 [1] RSPM\n dplyr     * 1.1.4   2023-11-17 [1] RSPM\n forcats   * 1.0.1   2025-09-25 [1] RSPM\n ggplot2   * 4.0.1   2025-11-14 [1] RSPM\n lubridate * 1.9.4   2024-12-08 [1] RSPM\n purrr     * 1.2.0   2025-11-04 [1] RSPM\n qqman     * 0.1.9   2023-08-23 [1] RSPM\n readr     * 2.1.6   2025-11-14 [1] RSPM\n stringr   * 1.6.0   2025-11-04 [1] RSPM\n tibble    * 3.3.0   2025-06-08 [1] RSPM\n tidyr     * 1.3.2   2025-12-19 [1] RSPM\n tidyverse * 2.0.0   2023-02-22 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "ManhattanPlot"
    ]
  },
  {
    "objectID": "Omics/ManhattanPlot.html#数据准备",
    "href": "Omics/ManhattanPlot.html#数据准备",
    "title": "曼哈顿图",
    "section": "数据准备",
    "text": "数据准备\n数据使用qqman中自带的gwasResults数据集。\n\n# 查看数据集\nhead(gwasResults)\n\n  SNP CHR BP         P\n1 rs1   1  1 0.9148060\n2 rs2   1  2 0.9370754\n3 rs3   1  3 0.2861395\n4 rs4   1  4 0.8304476\n5 rs5   1  5 0.6417455\n6 rs6   1  6 0.5190959",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "ManhattanPlot"
    ]
  },
  {
    "objectID": "Omics/ManhattanPlot.html#可视化",
    "href": "Omics/ManhattanPlot.html#可视化",
    "title": "曼哈顿图",
    "section": "可视化",
    "text": "可视化\n\n1. qqman绘制曼哈顿图\nmanhattan和qq是qqman中最重要的两个函数，分别负责绘制曼哈顿图和QQ图：\n\n\n\n\n\n\n提示\n\n\n\nmanhattan 参数:\n\nx：输入数据，要求格式为dataframe数据框\nchr：记录染色体信息的列名，必须是数字\nbp：记录碱基坐标位置信息的列名，必须是数字\np：记录P值或其他值信息的列名，必须是数字\nsnp：记录SNP名称的列名\ncol：交替的颜色设置\nchrlabs：X轴上染色体的名称，默认与数据框中的名称一致\nsuggestiveline：蓝色阈值线，设置为FALSE时不绘制\ngenomewideline：红色阈值线，设置为FALSE时不绘制\nhighlight：高亮的SNP名称\nlogp：设置为TRUE时，纵轴为-log10(P)，设置为FALSE时纵轴为P\nannotatePval：设置阈值，标注图中高于该阈值的SNP\nannotateTop：每条染色体仅标注一个最高的SNP\n\n\n\n\n# 基础曼哈顿图\nmanhattan(gwasResults)\n\n\n\n\n\n\n\n图 1: 基础曼哈顿图\n\n\n\n\n\n此图展示了基因组上所有SNP与性状的关联情况，其中三号染色体上存在一个明显的峰，表明三号染色体上存在一个可能是与性状强相关的区域。\nmanhattan中染色体的颜色可以通过col参数修改：\n\n# 颜色设置\nmanhattan(gwasResults, col = c(\"#3E7B92\",\"#F0E442\",\"#BF242A\"))\n\n\n\n\n\n\n\n图 2: 颜色设置\n\n\n\n\n\n对特定SNP进行高亮显示：\n\n# 高亮设置\nmanhattan(gwasResults, highlight =\"rs3057\")\n\n\n\n\n\n\n\n图 3: 高亮设置\n\n\n\n\n\n标注高于阈值的SNP(每条染色体一个)：\n\n# 注释设置\nmanhattan(gwasResults, highlight =\"rs3057\", annotatePval=1e-5)\n\n\n\n\n\n\n\n图 4: 注释设置\n\n\n\n\n\n\n\n2. ggplot2绘制曼哈顿图\n使用qqman绘制曼哈顿图能满足大部分需求，然而仍有部分需求不能满足，例如设置阈值线的样式和颜色，此时可以用ggplot2绘图。\n\n# ggplot2绘制曼哈顿图\ndf &lt;- gwasResults\ndf$CHR &lt;- factor(as.character(df$CHR),levels=unique(df$CHR))\nlen &lt;- \n    df %&gt;% \n    group_by(CHR) %&gt;%  # CHR为染色体信息的列名\n    summarise(len=max(BP))  # BP为位置信息的列名\nlen &lt;-  # 计算snp在图中的位置\n    len %&gt;% summarise(pos=cumsum(len)-len)\nrownames(len) &lt;- unique(df$CHR)\ndf$BP &lt;- df$BP+len$pos[match(df$CHR,rownames(len))]\nX_axis &lt;-  df %&gt;% group_by(CHR) %&gt;% summarize(center=( max(BP) + min(BP) ) / 2 ) # 计算染色体的位置\n\n# 下面对P值进行多重矫正，qqman中对P取固定的阈值其实是不可取的。\nbf &lt;- max(df$P[p.adjust(df$P, method = \"bonferroni\")&lt;0.05])  # 使用bonferroni法\nfdr&lt;- max(df$P[p.adjust(df$P, method = \"fdr\")&lt;0.05])  # 使用fdr法\n\ncol &lt;- c(\"gray10\", \"gray60\") # 此处设置染色体颜色\ncols &lt;- rep(col ,nrow(X_axis))\nline_col1 &lt;- \"red\" # 此处阈值线颜色\nline_col2 &lt;- \"blue\"\nline_type1 &lt;- \"dashed\" # 此处阈值线类型\nline_type2 &lt;- \"dashed\" \nggplot()+\n    geom_point(df,mapping=aes(x=BP,y=-log10(P),color=CHR),alpha=0.7,size=1,shape=16)+\n    geom_hline(yintercept = -log10(bf),lty=line_type1 ,color= line_col1 )+\n    geom_hline(yintercept = -log10(fdr),lty=line_type2 ,color= line_col2)+\n    scale_color_manual(values = cols ) +\n    theme_bw()+\n    theme(panel.grid.major = element_blank(),panel.grid.minor=element_blank(),\n          legend.position = 'none')+\n    xlab(\"CHR\")+ylab(\"-log10(P)\")+ #横轴纵轴标题\n    scale_x_continuous( limits = c(0, max(df$BP)),label = X_axis$CHR, breaks= X_axis$center ) +\n    scale_y_continuous(expand = c(0,0)) \n\n\n\n\n\n\n\n图 5: ggplot2绘制曼哈顿图\n\n\n\n\n\n使用ggplot2绘制曼哈顿图的好处在于可以高度自定义图像的风格，可以注意到在上面我已经设置好了几个变量，只需要对这些变量进行修改即可自定义颜色以及阈值线样式。\n\ncol &lt;- c(\"#3E7B92\",\"#F0E442\",\"#BF242A\") #此处设置染色体颜色\ncols &lt;- rep(col ,nrow(X_axis))\nline_col1 &lt;- \"#DB5A6A\" #此处阈值线颜色\nline_col2 &lt;- \"#0050B7\"\nline_type1 &lt;- \"solid\" #此处阈值线类型，可以设置的线条类型有：”solid“,“blank”, “solid”, “dashed”, “dotted”, “dotdash”, “longdash”, “twodash”\nline_type2 &lt;- \"dotdash\" \nggplot()+\n    geom_point(df,mapping=aes(x=BP,y=-log10(P),color=CHR),alpha=0.7,size=1,shape=16)+\n    geom_hline(yintercept = -log10(bf),lty=line_type1 ,color= line_col1 )+\n    geom_hline(yintercept = -log10(fdr),lty=line_type2 ,color= line_col2)+\n    scale_color_manual(values = cols ) +\n    theme_bw()+\n    theme(panel.grid.major = element_blank(),panel.grid.minor=element_blank(),\n          legend.position = 'none')+\n    xlab(\"CHR\")+ylab(\"-log10(P)\")+\n    scale_x_continuous( limits = c(0, max(df$BP)),label = X_axis$CHR, breaks= X_axis$center ) +\n    scale_y_continuous(expand = c(0,0)) \n\n\n\n\n\n\n\n图 6: ggplot2修改颜色\n\n\n\n\n\n由于ggplot2绘图是将一张张图叠加起来，因此可以将筛选后的SNP用geom_point叠加到原图上：\n\ndf2 &lt;- df[df$P&lt;bf,]\ndf3 &lt;- df[df$SNP==\"rs3057\",]\ncol &lt;- c(\"gray10\", \"gray60\") #此处设置染色体颜色\ncols &lt;- rep(col ,nrow(X_axis))\nline_col1 &lt;- \"red\" #此处阈值线颜色\nline_col2 &lt;- \"blue\"\nline_type1 &lt;- \"dashed\" #此处阈值线类型\nline_type2 &lt;- \"dashed\" \nggplot()+\n    geom_point(df,mapping=aes(x=BP,y=-log10(P),color=CHR),alpha=0.7,size=1,shape=16)+\n    geom_point(df2,mapping=aes(x=BP,y=-log10(P)),color=\"blue\",size=1,shape=16)+\n    geom_point(df3,mapping=aes(x=BP,y=-log10(P)),color=\"red\",size=3,shape=18)+\n    geom_hline(yintercept = -log10(bf),lty=line_type1 ,color= line_col1 )+\n    geom_hline(yintercept = -log10(fdr),lty=line_type2 ,color= line_col2)+\n    scale_color_manual(values = cols ) +\n    theme_bw()+\n    theme(panel.grid.major = element_blank(),panel.grid.minor=element_blank(),\n          legend.position = 'none')+\n    xlab(\"CHR\")+ylab(\"-log10(P)\")+\n    scale_x_continuous( limits = c(0, max(df$BP)),label = X_axis$CHR, breaks= X_axis$center ) +\n    scale_y_continuous(limits = c(0, max(-log10(df$P))+1),expand = c(0,0)) \n\n\n\n\n\n\n\n图 7: 高亮或标记snp\n\n\n\n\n\n当你有两个性状时可能需要将两个性状的GWAS结果同时展现在结果上，可以使用下列方法绘制双向曼哈顿图。这里只用一组数据作为示例。\n\ncol &lt;- c(\"gray10\", \"gray60\") #此处设置染色体颜色\ncols &lt;- rep(col ,nrow(X_axis))\nline_col1 &lt;- \"red\" #此处阈值线颜色\nline_col2 &lt;- \"blue\"\nline_type1 &lt;- \"dashed\" #此处阈值线类型\nline_type2 &lt;- \"dashed\" \np1 &lt;- \n    ggplot()+\n    geom_point(df,mapping=aes(x=BP,y=-log10(P),color=CHR),alpha=0.7,size=1,shape=16)+\n    geom_hline(yintercept = -log10(bf),lty=line_type1 ,color= line_col1 )+\n    geom_hline(yintercept = -log10(fdr),lty=line_type2 ,color= line_col2)+\n    scale_color_manual(values = cols ) +\n    theme_bw()+\n    theme(panel.grid.major = element_blank(),panel.grid.minor=element_blank(),\n          axis.text.x = element_text(vjust = -2),\n          axis.title.x = element_blank(),\n          legend.position = 'none')+\n    ylab(\"-log10(P)\")+ #横轴纵轴标题\n    scale_x_continuous( limits = c(0, max(df$BP)),label = X_axis$CHR, breaks= X_axis$center ) +\n    scale_y_continuous(expand = c(0,0)) \np2 &lt;- \n    ggplot()+\n    geom_point(df,mapping=aes(x=BP,y=-log10(P),color=CHR),alpha=0.7,size=1,shape=16)+\n    geom_hline(yintercept = -log10(bf),lty=line_type1 ,color= line_col1 )+\n    geom_hline(yintercept = -log10(fdr),lty=line_type2 ,color= line_col2)+\n    scale_color_manual(values = cols ) +\n    theme_bw()+\n    theme(panel.grid.major = element_blank(),panel.grid.minor=element_blank(),\n          axis.text.x = element_blank(),axis.title.x = element_blank(),\n          legend.position = 'none')+\n    ylab(\"-log10(P)\")+\n    scale_x_continuous( limits = c(0, max(df$BP)),label = X_axis$CHR, breaks= X_axis$center ,position = 'top') +\n    scale_y_reverse(expand = c(0,0))\np1/p2\n\n\n\n\n\n\n\n图 8: 双向曼哈顿图",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "ManhattanPlot"
    ]
  },
  {
    "objectID": "Omics/ManhattanPlot.html#应用场景",
    "href": "Omics/ManhattanPlot.html#应用场景",
    "title": "曼哈顿图",
    "section": "应用场景",
    "text": "应用场景\nfig-HistApplications} \n曼哈顿图应用 :::\n此图展示了杨树上的SNP位点与温度（上图）/降雨（下图）之间的关联 [1]。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "ManhattanPlot"
    ]
  },
  {
    "objectID": "Omics/ManhattanPlot.html#参考文献",
    "href": "Omics/ManhattanPlot.html#参考文献",
    "title": "曼哈顿图",
    "section": "参考文献",
    "text": "参考文献\n[1] Sang Y, Long Z, Dan X, Feng J, Shi T, Jia C, Zhang X, Lai Q, Yang G, Zhang H, Xu X, Liu H, Jiang Y, Ingvarsson PK, Liu J, Mao K, Wang J. Genomic insights into local adaptation and future climate-induced vulnerability of a keystone forest tree in East Asia. Nat Commun. 2022 Nov 1;13(1):6541. doi: 10.1038/s41467-022-34206-8. PMID: 36319648; PMCID: PMC9626627.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "ManhattanPlot"
    ]
  },
  {
    "objectID": "Omics/GeneStructurePlot.html",
    "href": "Omics/GeneStructurePlot.html",
    "title": "基因结构图",
    "section": "",
    "text": "在生物学，尤其是分子生物学研究中解析基因的表达调控模式一直以来都是研究的重点内容，而在此过程中难免会有绘制一个基因的结构或者上下游关系的需求，因此本教程将基于R包gggenes对常见的一些基因结构画法进行总结。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "GeneStructurePlot"
    ]
  },
  {
    "objectID": "Omics/GeneStructurePlot.html#示例",
    "href": "Omics/GeneStructurePlot.html#示例",
    "title": "基因结构图",
    "section": "示例",
    "text": "示例",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "GeneStructurePlot"
    ]
  },
  {
    "objectID": "Omics/GeneStructurePlot.html#环境配置",
    "href": "Omics/GeneStructurePlot.html#环境配置",
    "title": "基因结构图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：tidyverse; gggenes; ggtree\n\n\n# 安装包\nif (!requireNamespace(\"tidyverse\", quietly = TRUE)) {\n  install.packages(\"tidyverse\")\n}\nif (!requireNamespace(\"gggenes\", quietly = TRUE)) {\n  install.packages(\"gggenes\")\n}\nif (!requireNamespace(\"ggtree\", quietly = TRUE)) {\n  install.packages(\"ggtree\")\n}\n\n# 加载包\nlibrary(tidyverse)\nlibrary(gggenes)\nlibrary(ggtree)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package   * version date (UTC) lib source\n dplyr     * 1.1.4   2023-11-17 [1] RSPM\n forcats   * 1.0.1   2025-09-25 [1] RSPM\n gggenes   * 0.6.0   2025-12-14 [1] RSPM\n ggplot2   * 4.0.1   2025-11-14 [1] RSPM\n ggtree    * 4.0.3   2025-12-18 [1] Bioconduc~\n lubridate * 1.9.4   2024-12-08 [1] RSPM\n purrr     * 1.2.0   2025-11-04 [1] RSPM\n readr     * 2.1.6   2025-11-14 [1] RSPM\n stringr   * 1.6.0   2025-11-04 [1] RSPM\n tibble    * 3.3.0   2025-06-08 [1] RSPM\n tidyr     * 1.3.2   2025-12-19 [1] RSPM\n tidyverse * 2.0.0   2023-02-22 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "GeneStructurePlot"
    ]
  },
  {
    "objectID": "Omics/GeneStructurePlot.html#数据准备",
    "href": "Omics/GeneStructurePlot.html#数据准备",
    "title": "基因结构图",
    "section": "数据准备",
    "text": "数据准备\n数据使用gggenes中自带的example_genes数据集、example_subgenes数据集以及example_features数据集，分别记录了基因的位置信息、基因子结构的位置信息、基因上标记点的位置信息。\nexample_genes为一个数据框（dataframe），包含一个记录染色体或链信息的列作为纵坐标，一个记录基因或序列ID的列作为染色的映射索引，两个记录基因起始和终止位置的列，一个记录基因方向的列，每一行为一个基因，下表为example_genes的数据示例：\n\nhead(example_genes)\n\n  molecule gene start   end  strand orientation\n1  Genome1 genA 15389 17299 reverse           1\n2  Genome1 genB 17301 18161 forward           0\n3  Genome1 genC 18176 18640 reverse           1\n4  Genome1 genD 18641 18985 forward           0\n5  Genome1 genE 18999 20078 reverse           1\n6  Genome1 genF 20086 20451 forward           1\n\n\nexample_subgenes需要包含example_genes的所有列，并且需要额外包含一个记录基因子结构ID的列，两个记录基因子结构起始和终止位置的列，每一行为一个基因子结构，下表为example_subgenes的数据示例：\n\nhead(example_subgenes)\n\n  molecule gene  start    end  strand subgene   from     to orientation\n1  Genome5 genA 405113 407035 forward  genA-1 405774 406538           0\n2  Genome5 genB 407035 407916 forward  genB-1 407458 407897           0\n3  Genome5 genC 407927 408394 forward  genC-1 407942 408158           0\n4  Genome5 genC 407927 408394 forward  genC-2 408186 408209           0\n5  Genome5 genC 407927 408394 forward  genC-3 408233 408257           0\n6  Genome5 genF 409836 410315 forward  genF-1 409938 410016           0\n\n\nexample_features需要包含一个记录染色体或链信息的列，一个记录标记点名称的列，一个记录标记点类型的列，一个记录标记点位置的列，一个记录标记点方向的列，每一行为一个标记，下表为example_features的数据示例：\n\nhead(example_features)\n\n  molecule name             type position forward\n1  Genome1 tss9              tss    22988      NA\n2  Genome1  rs4 restriction site    18641      NA\n3  Genome1 ori5              ori    18174      NA\n4  Genome2  rs0 restriction site    12256      NA\n5  Genome2  rs1 restriction site    14076      NA\n6  Genome2 ori1              ori    13355   FALSE",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "GeneStructurePlot"
    ]
  },
  {
    "objectID": "Omics/GeneStructurePlot.html#可视化",
    "href": "Omics/GeneStructurePlot.html#可视化",
    "title": "基因结构图",
    "section": "可视化",
    "text": "可视化\n\n1. 基因结构图基础\ngggenes作为ggplot2的扩展，其功能由一个主要函数geom_gene_arrow以及若干次要函数完成，首先介绍gggenes的基础用法：\n\n1.1 绘制一连串的基因相对位置\n\n# 绘制一连串的基因相对位置\nggplot(example_genes, aes(xmin = start, xmax = end, y = molecule)) +\n    geom_gene_arrow() +\n    facet_wrap(~ molecule, scales = \"free\", ncol = 1)  # gggenes通常配合facet_wrap函数进行分面使用。需要注意的是，画图界面过小的话会提示报错：“Viewport has zero dimension(s)”，只需将画图窗口拉大或者设置更大的界面即可。\n\n\n\n\n\n\n\n图 1: 绘制一连串的基因相对位置\n\n\n\n\n\n\n\n1.2 绘制一组基因\n如果关注的是基因本身的结构而不是基因的位置可以将基因ID作为纵轴：\n\n# 绘制一组基因\ndf &lt;- subset(example_genes, molecule == \"Genome4\")\ndf$end &lt;- df$end-df$start\ndf$start &lt;- 1\nggplot(df, aes(xmin = start, xmax = end, y = gene)) +\n    geom_gene_arrow()\n\n\n\n\n\n\n\n图 2: 绘制一组基因\n\n\n\n\n\n\n\n1.3 绘制基因子结构\n有时我们会关注于基因上更精细的结构，比如CDS位置或者特殊的motif位置等，此时则需要gggenes中提供的另一个扩展函数geom_subgene_arrow来完成，需要注意的是虽然example_subgenes也可以作为geom_gene_arrow的输入但是由于数据中的每一行都会创建一个基因的轮廓图像，因此在一个基因含有多个子结构的时候不建议这么做，建议的使用方法还是将基因信息以及子结构信息单独分为俩个数据框处理。使用方法如下：\n\n# 绘制基因子结构\nggplot(example_genes, aes(xmin = start, xmax = end, y = molecule)) +\n    facet_wrap(~ molecule, scales = \"free\", ncol = 1) +\n    geom_gene_arrow(fill = \"white\") +\n    geom_subgene_arrow(data = example_subgenes,\n                       aes(fill = gene, xsubmin = from, xsubmax = to),\n                       color=\"black\", alpha=.7)\n\n\n\n\n\n\n\n图 3: 绘制基因子结构\n\n\n\n\n\n\n\n1.4 绘制基因标记点\n有时我们会关注基因或序列上的某个特殊点位，例如酶切位点或者启动子位点等，与基因或者其子结构不同的是标记常常为一个或有限的几个碱基，此时不适合使用箭头的画图方法，而geom_feature和geom_feature_label拓展函数则可以很好的完成这种标记任务：\n\n# 绘制基因标记点\nggplot(example_genes, aes(xmin = start, xmax = end, y = molecule)) +\n    facet_wrap(~ molecule, scales = \"free\", ncol = 1) +\n    geom_gene_arrow(fill = \"white\")+\n    geom_feature(\n        data = example_features,\n        aes(x = position, y = molecule, forward = forward)\n    ) +\n    geom_feature_label(\n        data = example_features,\n        aes(x = position, y = molecule, label = name, forward = forward),\n        feature_height = unit(4, \"mm\"), #当标记点无法正常显示时，可以设置该参数调整标记的标签高度\n        label_height = unit(3, \"mm\") #当标记点标签大小不合适时，可以设置该参数调整标记的标签大小\n    ) +\n    theme_genes() #这个主题下面会提到\n\n\n\n\n\n\n\n图 4: 绘制基因标记点\n\n\n\n\n\n\n\n1.5 与进化树和作图\n我们可能会关注不同物种或品种在某个染色体区域的基因差异，此时我们可以将进化树与基因结构图联用，除了使用拼图的方法以外，R包ggtree也提供了一个接口用于二者联用： 首先我们需要获取一个树结构，这里直接用gggenes的数据集构造一个tree，实际使用时读取一个树文件即可。 根据基因结构生成一个进化树，实际使用不需要生成：\n\nget_genes &lt;- function(data, genome) {\n    filter(data, molecule == genome) %&gt;% pull(gene)\n}\n\ng &lt;- unique(example_genes[,1])\nn &lt;- length(g)\nd &lt;- matrix(nrow = n, ncol = n)\nrownames(d) &lt;- colnames(d) &lt;- g\ngenes &lt;- lapply(g, get_genes, data = example_genes)\n\nfor (i in 1:n) {\n    for (j in 1:i) {\n        jaccard_sim &lt;- length(intersect(genes[[i]], genes[[j]])) / \n            length(union(genes[[i]], genes[[j]]))\n        d[j, i] &lt;- d[i, j] &lt;- 1 - jaccard_sim\n    }\n}\ntree &lt;- ape::bionj(d) \n\n画图时使用ggtree函数，并在geom_facet中指定基因结构数据，并指定geom = geom_motif panel = 'Alignment'，on 参数用于指定需要对齐的基因名称（必须是所有物种共有的，如果没有的话暂时不知道怎么设置）。坐标映射参数为xmin和xmax。需要注意的是在上方被作为纵轴的染色体ID（这里可以是不同物种的名称）必须位于数据框的第一列，ggtree会通过比较树的枝标签以及基因结构的第一列来决定基因结构的纵轴位置。 画图代码如下：\n\n# 与进化树和作图\nggtree(tree, branch.length='none') + \n    geom_tiplab() + xlim_tree(5.5) + \n    geom_facet(data = example_genes,\n               geom = geom_motif,\n               mapping = aes(xmin = start, xmax = end, fill = gene), \n               panel = 'Alignment',on = 'genE', \n               label = 'gene', align = 'left') +\n    scale_fill_brewer(palette = \"Set3\") +  #修改配色的方法下面会提到\n    scale_x_continuous(expand=c(0,0)) +\n    theme(strip.text=element_blank())\n\n\n\n\n\n\n\n图 5: 与进化树和作图\n\n\n\n\n\n\n\n\n2. 图像美化\n\n2.1 theme_genes 主题\n在gggenes中，有一个名为theme_genes的图像主题，非常适合用于绘制基因结构：\n\n# theme_genes主题\nggplot(example_genes, aes(xmin = start, xmax = end, y = molecule)) +\n    geom_gene_arrow() +\n    facet_wrap(~ molecule, scales = \"free\", ncol = 1) +\n    theme_genes() \n\n\n\n\n\n\n\n图 6: theme_genes主题\n\n\n\n\n\n\n\n2.2 修改颜色\n对不同的基因添加颜色(子结构同理，不再赘述)：\n\n# 修改颜色\nggplot(example_genes, aes(xmin = start, xmax = end, y = molecule, fill=gene)) +\n    geom_gene_arrow() +\n    facet_wrap(~ molecule, scales = \"free\", ncol = 1) +\n    theme_genes()\n\n\n\n\n\n\n\n图 7: 修改颜色\n\n\n\n\n\n更换配色方案可以使用调色板或者手动设置：\n\n# 修改颜色\nggplot(example_genes, aes(xmin = start, xmax = end, y = molecule, fill = gene)) +\n    geom_gene_arrow() +\n    facet_wrap(~ molecule, scales = \"free\", ncol = 1) +\n    scale_fill_brewer(palette = \"Set3\") +\n    theme_genes()\n\n\n\n\n\n\n\n图 8: 修改颜色\n\n\n\n\n\n自定义配色：\n\n# 修改颜色\nggplot(example_genes, aes(xmin = start, xmax = end, y = molecule, fill = gene)) +\n    geom_gene_arrow() +\n    facet_wrap(~ molecule, scales = \"free\", ncol = 1) +\n    scale_fill_manual(values=c(\"genA\"=\"#266CAF\",\n                               \"genB\"=\"#BF3237\",\n                               \"genC\"=\"#54AC78\",\n                               \"genD\"=\"#FBD75F\")) +\n    theme_genes()\n\n\n\n\n\n\n\n图 9: 修改颜色\n\n\n\n\n\n\n\n2.3 为基因添加标签\n添加基因标签需要使用geom_gene_label扩展函数，该函数只需要额外定义一个label映射即可\n\n# 为基因添加标签\nggplot(example_genes, aes(xmin = start, xmax = end, y = molecule, fill = gene)) +\n    geom_gene_arrow() +\n    geom_gene_label(aes(label = gene),align = \"left\") +\n    facet_wrap(~ molecule, scales = \"free\", ncol = 1) +\n    scale_fill_brewer(palette = \"Set3\") +\n    theme_genes()\n\n\n\n\n\n\n\n图 10: 为基因添加标签\n\n\n\n\n\n\n\n2.4 修改基因箭头形状\n想要修改箭头性状需要用到geom_gene_arrow中的两个参数：arrowhead_height arrowhead_width，分别定义箭头的高度与宽度\n\n# 修改基因箭头形状\nggplot(example_genes, aes(xmin = start, xmax = end, y = molecule, fill = gene)) +\n    geom_gene_arrow(arrowhead_height = unit(3, \"mm\"), arrowhead_width = unit(1, \"mm\")) +\n    facet_wrap(~ molecule, scales = \"free\", ncol = 1) +\n    scale_fill_brewer(palette = \"Set3\") +\n    theme_genes()\n\n\n\n\n\n\n\n图 11: 修改基因箭头形状\n\n\n\n\n\n\n\n2.5 修改基因的方向\n修改基因方向一般需要设置forward映射，映射列的内容必须是可以转化为布尔值的值，例如：0/1，T/F，TRUE/FALSE，”True“/“False”等，可以使用as.logical函数自行判断。 在没有设置的情况下，基因的箭头默认指向xmax的方向，当设置forward的映射后，布尔值为TRUE的基因指向xmax的方向，布尔值为FALSE的基因指向xmin的方向。因此如果在你的数据中xmin和xmax本身就带有方向性，也可以不进行forward映射。\n\n# 修改基因的方向\nggplot(example_genes, aes(xmin = start, xmax = end, y = molecule, fill = gene, forward = orientation)) +\n    geom_gene_arrow() +\n    facet_wrap(~ molecule, scales = \"free\", ncol = 1) +\n    scale_fill_brewer(palette = \"Set3\") +\n    theme_genes()\n\n\n\n\n\n\n\n图 12: 修改基因的方向",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "GeneStructurePlot"
    ]
  },
  {
    "objectID": "Omics/GeneStructurePlot.html#应用场景",
    "href": "Omics/GeneStructurePlot.html#应用场景",
    "title": "基因结构图",
    "section": "应用场景",
    "text": "应用场景\n\n\n\n\n\n\n图 13: 基因结构图应用\n\n\n\n图中展示了植物在进化过程中，NLR基因的丢失分化模型 [1]。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "GeneStructurePlot"
    ]
  },
  {
    "objectID": "Omics/GeneStructurePlot.html#参考文献",
    "href": "Omics/GeneStructurePlot.html#参考文献",
    "title": "基因结构图",
    "section": "参考文献",
    "text": "参考文献\n[1] Guo BC, Zhang YR, Liu ZG, Li XC, Yu Z, Ping BY, Sun YQ, van den Burg H, Ma FW, Zhao T. Deciphering Plant NLR Genomic Evolution: Synteny-Informed Classification Unveils Insights into TNL Gene Loss. Mol Biol Evol. 2025 Feb 3;42(2):msaf015. doi: 10.1093/molbev/msaf015. PMID: 39835721; PMCID: PMC11789945.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "GeneStructurePlot"
    ]
  },
  {
    "objectID": "Omics/MultiSeqsAlignment.html",
    "href": "Omics/MultiSeqsAlignment.html",
    "title": "多序列比对可视化",
    "section": "",
    "text": "多序列比对（Multiple Sequence Alignment, MSA）是生物信息学中一项基础且关键的技术，用于将三个或更多生物序列（DNA、RNA 或蛋白质）按照其进化或结构上的相似性进行排列，使得同源位点（即来自共同祖先的位点）尽可能对齐。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "MultiSeqsAlignment"
    ]
  },
  {
    "objectID": "Omics/MultiSeqsAlignment.html#示例",
    "href": "Omics/MultiSeqsAlignment.html#示例",
    "title": "多序列比对可视化",
    "section": "示例",
    "text": "示例",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "MultiSeqsAlignment"
    ]
  },
  {
    "objectID": "Omics/MultiSeqsAlignment.html#环境配置",
    "href": "Omics/MultiSeqsAlignment.html#环境配置",
    "title": "多序列比对可视化",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：ggmsa\n\n\n# 安装包\nif (!requireNamespace(\"ggmsa\", quietly = TRUE)) {\n  install.packages(\"ggmsa\")\n}\n\n# 加载包\nlibrary(ggmsa)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package * version date (UTC) lib source\n ggmsa   * 1.16.0  2025-10-29 [1] Bioconduc~\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "MultiSeqsAlignment"
    ]
  },
  {
    "objectID": "Omics/MultiSeqsAlignment.html#数据准备",
    "href": "Omics/MultiSeqsAlignment.html#数据准备",
    "title": "多序列比对可视化",
    "section": "数据准备",
    "text": "数据准备\nDNA/RNA/氨基酸序列数据通常以FASTA格式存储，每个序列由一个描述行（以“&gt;”开头）和随后的序列行组成。\n\n# 示例数据\nprotein_fasta &lt;- system.file(\"extdata\", \"sample.fasta\", package = \"ggmsa\")\n\n# 查看数据\nseqs &lt;- readLines(protein_fasta)\nhead(seqs)\n\n[1] \"&gt;PH4H_Rattus_norvegicus\"                                                         \n[2] \"MAAVVLENGVLSRKLSDFGQETSYIEDNSNQNGAISLIFSLKEEVGALAKVLRLFEENDINLTHIESRPSRLNKDEYEFF\"\n[3] \"TYLDKRTKPVLGSIIKSLRNDIGATVHELSRDKEKNTVPWFPRTIQELDRFANQILSYGAELDADHPGFKDPVYRARRKQ\"\n[4] \"FADIAYNYRHGQPIPRVEYTEEEKQTWGTVFRTLKALYKTHACYEHNHIFPLLEKYCGFREDNIPQLEDVSQFLQTCTGF\"\n[5] \"RLRPVAGLLSSRDFLGGLAFRVFHCTQYIRHGSKPMYTPEPDICHELLGHVPLFSDRSFAQFSQEIG-LASLGAPDEYIE\"\n[6] \"KLATIYWFTVEFGLCKEG-DSIKAYGAGLLSSFGELQYCLSD-KPKLLPLELEKTACQEYSVTEFQPLYYVAESFSDAKE\"",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "MultiSeqsAlignment"
    ]
  },
  {
    "objectID": "Omics/MultiSeqsAlignment.html#可视化",
    "href": "Omics/MultiSeqsAlignment.html#可视化",
    "title": "多序列比对可视化",
    "section": "可视化",
    "text": "可视化\n\n1. 蛋白质多序列比对\n蛋白质多序列比对可视化展示了多个蛋白质序列在特定区域的比对情况，帮助识别保守区域和变异位点，提供专业的氨基酸序列颜色方案。\n\n# 蛋白质多序列比对\np &lt;- ggmsa(\n  protein_fasta,\n  start = 300,\n  end = 330,\n  font = \"DroidSansMono\",\n  color = \"Chemistry_AA\",\n  char_width = 0.5,\n  seq_name = TRUE,\n  consensus_views = FALSE\n)\n\np\n\n\n\n\n\n\n\n图 1: 蛋白质多序列比对\n\n\n\n\n\n\n\n2. 多序列比对及统计\n多序列比对结果统计图展示了多个序列在比对区域内的保守性和变异情况，帮助识别关键位点和区域。\n\n# 多序列比对及统计\np &lt;- ggmsa(\n  protein_fasta,\n  start = 300,\n  end = 320,\n  font = \"DroidSansMono\",\n  color = \"Chemistry_AA\",\n  char_width = 0.5,\n  seq_name = TRUE,\n  consensus_views = FALSE\n) +\n  geom_msaBar()\n\np\n\n\n\n\n\n\n\n图 2: 多序列比对及统计\n\n\n\n\n\n\n\n3. 多序列比对及Logo\n多序列比对及Logo展示比对一致性结果的同时，对多个序列的碱基或氨基酸进行排序以Logo形式显示。\n\n# 多序列比对及Logo\np &lt;- ggmsa(\n  protein_fasta,\n  start = 300,\n  end = 330,\n  font = \"DroidSansMono\",\n  color = \"Chemistry_AA\",\n  char_width = 0.5,\n  seq_name = TRUE,\n  consensus_views = FALSE\n) +\n  geom_seqlogo()\n\np\n\n\n\n\n\n\n\n图 3: 多序列比对及Logo",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "MultiSeqsAlignment"
    ]
  },
  {
    "objectID": "Tutorial.html",
    "href": "Tutorial.html",
    "title": "使用教程",
    "section": "",
    "text": "Bizard 作为一个社区协作的全面可视化代码存储库，基于 GitHub 实现了集问题讨论、图表征集、协作开发、自动化部署于一体的平台。社区成员可以通过 GitHub Discussions 讨论遇到的困难、通过 GitHub Issues 发起新的图表、通过 GitHub Pull Requests 参与贡献、通过 GitHub Action 自动化部署网站。下面将详细介绍每一步的操作流程：",
    "crumbs": [
      "<i class='fa-solid fa-signs-post'></i> Tutorial"
    ]
  },
  {
    "objectID": "Tutorial.html#问题讨论",
    "href": "Tutorial.html#问题讨论",
    "title": "使用教程",
    "section": "问题讨论",
    "text": "问题讨论\nGitHub Discussions 是一个类似于论坛的板块，它为项目提供了一个宽松、开放的交流空间。在 Bizard 中，我们基于 giscus 搭建了网站评论系统，位于网站页面的底部：\n\n\n\n\n\n\n图 1: 使用Bizard评论系统讨论问题\n\n\n\n如果您在任何图文教程中遇到了问题，可以通过该教程页面底部的评论框发起问题讨论。您需要在评论框先登录您的 GitHub 账号，然后通过 Markdown 语法编辑您的问题。\n一旦您提交问题评论，会自动在 Bizard 项目仓库的 GitHub Discussions 板块发布您的问题，并标记了图文教程链接。任何社区成员看到您的问题后对可以针对问题进行讨论，Bizard 运营团队也会定期回复 GitHub Discussions 中的问题。\n\n\n\n\n\n\n图 2: 创建 GitHub Discussions",
    "crumbs": [
      "<i class='fa-solid fa-signs-post'></i> Tutorial"
    ]
  },
  {
    "objectID": "Tutorial.html#图表征集",
    "href": "Tutorial.html#图表征集",
    "title": "使用教程",
    "section": "图表征集",
    "text": "图表征集\nBizard 长期向社区成员征集新的图表，您可以通过 GitHub Issues 进行提交。提交时需要提供以下信息：\n\n拟推荐图表名\n图表分类：Basics / Clinical / Omics\n图表示例\n相关资料：图表相关链接\n\n参考示例：新增图表征集（第一期）\n\n\n\n\n\n\n图 3: GitHub Issues 征集新的图表\n\n\n\n提交 GitHub Issues 后，Bizard 运营团队会对图表进行审核，审核结果包括以下三类：\n\n暂不考虑立项\n补充到已有的图文教程\n新增图文教程\n\n一旦审核通过，您可以通过 GitHub Issues 或 Pull Requests 提供图文教程。如果您无法提供图文教程，Bizard 运营团队会安排其他人员处理。",
    "crumbs": [
      "<i class='fa-solid fa-signs-post'></i> Tutorial"
    ]
  },
  {
    "objectID": "Tutorial.html#协作开发",
    "href": "Tutorial.html#协作开发",
    "title": "使用教程",
    "section": "协作开发",
    "text": "协作开发\n所有社区成员都可以通过 GitHub Pull Requests 参与 Bizard 项目的开发，如：贡献新的图文教程、优化网站布局等。\n在通过 Pull Requests 贡献新的图文教程之前，建议您先提交 GitHub Issue。Bizard 运营团队会对图文教程进行审核，并提出一些修改意见。如果您无法提交 Pull Request，Bizard 运营团队会安排其他人员提交。\n图文教程应按照 Bizard 的格式规范编写，需包含以下内容：\n\n图表描述\n图表示例\n环境配置\n数据准备\n可视化\n应用场景\n参考文献\n\n参考示例： - 【新增图文教程】Omics-多组火山图 - 【第一期】Omics/MultiVolcanoPlot\n\n\n\n\n\n\n图 4: GitHub Issues 提交图文教程\n\n\n\n\n\n\n\n\n\n图 5: GitHub Pull Requests 提交图文教程",
    "crumbs": [
      "<i class='fa-solid fa-signs-post'></i> Tutorial"
    ]
  },
  {
    "objectID": "Tutorial.html#自动化部署",
    "href": "Tutorial.html#自动化部署",
    "title": "使用教程",
    "section": "自动化部署",
    "text": "自动化部署\n为了保证网站开发的效率与可靠性，彻底消除手动更新网站所带来的繁琐、延迟及人为错误的风险。Bizard 通过 GitHub Actions 构建了一套完备的自动化工作流，实现了从代码提交到线上部署的全程自动化，极大地提升了网站迭代的敏捷性与稳定性。其工作流程为：当开发者将新的网站内容或代码更新推送 （Push）到指定的主分支（如 main 或 master），或发起一个合并请求（Pull Request）时，GitHub Actions 将被自动激活。它会立即在 GitHub 提供的纯净虚拟环境中，严格按照预设的配置文件（Workflow File ）执行一系列关键任务，构建网站并自动化部署到 GitHub Pages 网页。\n\n\n\n\n\n\n图 6: GitHub Actions 自动化部署",
    "crumbs": [
      "<i class='fa-solid fa-signs-post'></i> Tutorial"
    ]
  },
  {
    "objectID": "Tutorial.html#图库",
    "href": "Tutorial.html#图库",
    "title": "使用教程",
    "section": "图库",
    "text": "图库\n为了解决绘图数量快速增长带来的查找困难、管理混乱、效率低下等问题，Bizard 引入了图库（Graph Gallery）页面。Bizard 利用先进的表格管理工具 reactable 集成了所有绘图信息，并使用 JavaScript 和 CSS 前端代码渲染表格。在这个表格中，每行代表一个图形，包含关键属性：图形ID、名称、描述和类型。用户可以通过筛选、排序和关键词搜索，从庞大的图库中准确找到所需内容，从而显著提高信息检索效率。\n我们使用位于 Bizard/files/ 路径下的中英文两个版本的表格来管理图库，如下所示：\n\n\n\n\n\n\n图 7: 图库表格\n\n\n\n开发者在更新图库时需要将图形的信息填写到这两个表格中，内容包括：\n\nId: 图形编号\nName: 图形名称\nImage_url: 图形链接，可以复制渲染好的教程中的图形链接\nTutorial_url: 教程链接\nDescription: 一句话简单描述图形\nType: 图形三级类型\nLevel1: 图形一级类型，包括：BASICS、OMICS、CLINICS、HIPLOT\nLevel2: 图形二级类型，如：Distribution、Correlation、Ranking 等\n\n为了保证表格文字能正常渲染，填写完成后需要将表格保存为 CSV UTF-8 格式。",
    "crumbs": [
      "<i class='fa-solid fa-signs-post'></i> Tutorial"
    ]
  },
  {
    "objectID": "Clinics/RegressionTable.html",
    "href": "Clinics/RegressionTable.html",
    "title": "回归分析表格",
    "section": "",
    "text": "回归分析表格是用于展示回归模型结果的表格，它提供了模型中变量的统计信息，帮助解释变量之间的关系。",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> 𝐂𝐋𝐈𝐍𝐈𝐂𝐒",
      "RegressionTable"
    ]
  },
  {
    "objectID": "Clinics/RegressionTable.html#示例",
    "href": "Clinics/RegressionTable.html#示例",
    "title": "回归分析表格",
    "section": "示例",
    "text": "示例\n\n\n\n\n\n如图是基于survival包的内置pbc数据集绘制的回归分析表格。图中分别使用了Cox风险比例模型和广义线性回归模型探索血清蛋白、性别、年龄对生存状况的影响。",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> 𝐂𝐋𝐈𝐍𝐈𝐂𝐒",
      "RegressionTable"
    ]
  },
  {
    "objectID": "Clinics/RegressionTable.html#环境配置",
    "href": "Clinics/RegressionTable.html#环境配置",
    "title": "回归分析表格",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：survival, gtsummary, dplyr, datawizard\n\n\n# 安装包\nif (!requireNamespace(\"survival\", quietly = TRUE)) {\n  install.packages(\"survival\")\n}\nif (!requireNamespace(\"gtsummary\", quietly = TRUE)) {\n  install.packages(\"gtsummary\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"datawizard\", quietly = TRUE)) {\n  install.packages(\"datawizard\")\n}\nif (!requireNamespace(\"broom.helpers\", quietly = TRUE)) {\n  remotes::install_github(\"larmarange/broom.helpers\")\n}\n\n# 加载包\nlibrary(survival)\nlibrary(gtsummary)\nlibrary(dplyr)\nlibrary(datawizard)\nlibrary(broom.helpers)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package       * version     date (UTC) lib source\n broom.helpers * 1.22.0.9000 2025-11-02 [1] Github (larmarange/broom.helpers@02687ca)\n datawizard    * 1.3.0       2025-10-11 [1] RSPM\n dplyr         * 1.1.4       2023-11-17 [1] RSPM\n gtsummary     * 2.5.0       2025-12-05 [1] RSPM\n survival      * 3.8-3       2024-12-17 [3] CRAN (R 4.5.2)\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> 𝐂𝐋𝐈𝐍𝐈𝐂𝐒",
      "RegressionTable"
    ]
  },
  {
    "objectID": "Clinics/RegressionTable.html#数据准备",
    "href": "Clinics/RegressionTable.html#数据准备",
    "title": "回归分析表格",
    "section": "数据准备",
    "text": "数据准备\n使用R包survival内置的pbc数据集，包含了418名原发性胆汁性肝硬化（PBC）患者的信息，这些患者在研究开始时或之前已经接受了熊去氧胆酸（UDCA）治疗。pbc数据集记录了pbc患者的生存时间、生存状态、治疗方式、年龄、性别、白蛋白水平、肝肿大情况等临床信息。\n\ndf &lt;- pbc %&gt;%\n  filter(status != 1) %&gt;%\n  mutate(status = ifelse(status == 2, 1, 0)) %&gt;%\n  select(2:13) %&gt;%\n  na.omit() %&gt;% \n  # 将`albumin`分为3组\n  mutate(albumin3cat = categorize(albumin, split = \"quantile\", n_groups = 3))\n\nhead(df[,1:6])\n\n  time status trt      age sex ascites\n1  400      1   1 58.76523   f       1\n2 4500      0   1 56.44627   f       0\n3 1012      1   1 70.07255   m       0\n4 1925      1   1 54.74059   f       0\n5 2503      1   2 66.25873   f       0\n6 1832      0   2 55.53457   f       0",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> 𝐂𝐋𝐈𝐍𝐈𝐂𝐒",
      "RegressionTable"
    ]
  },
  {
    "objectID": "Clinics/RegressionTable.html#可视化",
    "href": "Clinics/RegressionTable.html#可视化",
    "title": "回归分析表格",
    "section": "可视化",
    "text": "可视化\n\n1. 基础回归分析表格\n\n# 基本绘图\nt1 &lt;- coxph(Surv(time, status) ~ albumin + sex + age,\n  data = df\n) %&gt;%\n  tbl_regression()\n\nt1\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\nlog(HR)\n95% CI\np-value\n\n\n\n\nalbumin\n-1.7\n-2.1, -1.2\n&lt;0.001\n\n\nsex\n\n\n\n\n\n\n\n\n    m\n—\n—\n\n\n\n\n    f\n-0.56\n-1.1, -0.06\n0.027\n\n\nage\n0.03\n0.01, 0.05\n0.004\n\n\n\nAbbreviations: CI = Confidence Interval, HR = Hazard Ratio\n\n\n\n\n\n\n\n\n图 1: 基础回归分析表格\n\n\n\n\n该表是基础回归分析表格，通过coxph()调用Cox比例风险模型和使用tbl_regression()将回归分析的结果表格化。\n\n\n2. tbl_regression()参数设置\n\n# tbl_regression()参数设置\nt1 &lt;- coxph(Surv(time, status) ~ albumin + sex + age,\n  data = df\n) %&gt;%\n  # 参数设置\n  tbl_regression(\n    conf.level = 0.90,\n    exponentiate = TRUE,\n    include = c(\"sex\", \"albumin\"),\n    show_single_row = sex,\n    label = list(sex ~ \"sex as categorical\")\n  )\n\nt1\n\n\n\n\n\n\n\n\n\nCharacteristic\nHR\n90% CI\np-value\n\n\n\n\nsex as categorical\n0.57\n0.37, 0.87\n0.027\n\n\nalbumin\n0.19\n0.13, 0.28\n&lt;0.001\n\n\n\nAbbreviations: CI = Confidence Interval, HR = Hazard Ratio\n\n\n\n\n\n\n\n\n图 2: tbl_regression()参数设置\n\n\n\n\n表中tbl_regression()有很多参数设置，可以更改表格的置信区间，行名等信息。\n\n\n\n\n\n\n提示\n\n\n\n重要参数：tbl_regression\n\nconf.level: 确定回归分析的置信水平，默认的0.95表示95%置信区间。\nexponentiate: 是否对HR值取指数，默认列是log(HR)值。\ninclude: 统计表格中包含哪些自变量因素（行）\nshow_single_row: 适用于二分类变量，不显示对照组。\nlabel: 更改自变量因素的名称（行名）。\n\n\n\n\n\n3. 添加global-p\n\n# 添加global-p\ndf$albumin3cat=as.factor(df$albumin3cat)\n\nt1 &lt;- coxph(Surv(time, status) ~ albumin3cat + sex + age,\n            data = df) %&gt;%\n  tbl_regression()  %&gt;%\n  add_global_p()\n\nt1\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\nlog(HR)\n95% CI\np-value\n\n\n\n\nalbumin3cat\n\n\n\n\n&lt;0.001\n\n\n    1\n—\n—\n\n\n\n\n    2\n-0.72\n-1.2, -0.27\n\n\n\n\n    3\n-1.3\n-1.7, -0.77\n\n\n\n\nsex\n\n\n\n\n0.073\n\n\n    m\n—\n—\n\n\n\n\n    f\n-0.48\n-0.98, 0.02\n\n\n\n\nage\n0.03\n0.01, 0.05\n&lt;0.001\n\n\n\nAbbreviations: CI = Confidence Interval, HR = Hazard Ratio\n\n\n\n\n\n\n\n\n图 3: 添加global-p\n\n\n\n\n该表通过add_global_p()添加全局P值。\n\n\n4. 添加q-value\n\n# 添加q-value\nt1 &lt;- coxph(Surv(time, status) ~ albumin + sex + age,\n  data = df\n) %&gt;%\n  tbl_regression() %&gt;%\n  # 添加q-value列\n  add_q()\n\nt1\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\nlog(HR)\n95% CI\np-value\nq-value1\n\n\n\n\nalbumin\n-1.7\n-2.1, -1.2\n&lt;0.001\n&lt;0.001\n\n\nsex\n\n\n\n\n\n\n\n\n\n\n    m\n—\n—\n\n\n\n\n\n\n    f\n-0.56\n-1.1, -0.06\n0.027\n0.027\n\n\nage\n0.03\n0.01, 0.05\n0.004\n0.006\n\n\n\n1 False discovery rate correction for multiple testing\n\n\nAbbreviations: CI = Confidence Interval, HR = Hazard Ratio\n\n\n\n\n\n\n\n\n图 4: 添加q-value\n\n\n\n\n该表通过add_q()添加q-value列。\n\n\n5. 合并列\n\n# 合并列\nt1 &lt;- coxph(Surv(time, status) ~ albumin3cat + sex + age,\n            data = df) %&gt;%\n  tbl_regression()  %&gt;%\n  # 修改表头名称\n  modify_header(p.value = \"**P**\",estimate=\"**log(HR) (CI)**\") %&gt;%\n  # 将评分列和CI列合并并应用于评分不为NA的行\n  modify_column_merge(\n    pattern = \"{estimate} ({conf.low}, {conf.high})\",\n    rows = !is.na(estimate)\n  )\n\nt1\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\nlog(HR) (CI)\nP\n\n\n\n\nalbumin3cat\n\n\n\n\n\n\n    1\n—\n\n\n\n\n    2\n-0.72 (-1.2, -0.27)\n0.002\n\n\n    3\n-1.3 (-1.7, -0.77)\n&lt;0.001\n\n\nsex\n\n\n\n\n\n\n    m\n—\n\n\n\n\n    f\n-0.48 (-0.98, 0.02)\n0.062\n\n\nage\n0.03 (0.01, 0.05)\n&lt;0.001\n\n\n\nAbbreviations: CI = Confidence Interval, HR = Hazard Ratio\n\n\n\n\n\n\n\n\n图 5: 合并列\n\n\n\n\n该表将评分列和CI列合并，是一种常见的形式，合并后恰当修改了表头。\n\n\n\n\n\n\n提示\n\n\n\n重要函数 modify_header / modify_column_merge:\nmodify_header:modify_header()可用于修改标题名称。其中label表示变量列，p.value表示P值列，ci表示置信区间列，estimate表示评分列，conf.low表示置信区间下区间，conf.high表示置信区间上区间。\nmodify_column_merge:参数pattern是要合并列的模式，参数rows是要应用到的行。\n\n\n\n\n6. 模型整合\n模型横向整合\n\n# 模型横向整合\nt1 &lt;- coxph(Surv(time, status) ~ albumin + sex + age,\n  data = df\n) %&gt;%\n  tbl_regression()\nt2 &lt;- glm(time ~ albumin + sex + age,\n  data = df\n) %&gt;%\n  tbl_regression()\n# t1, t2模型整合\nt3 &lt;- tbl_merge(\n  tbls = list(t1, t2),\n  tab_spanner = c(\"**Cox Model**\", \"**GLM Model**\")\n)\n\nt3\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\n\nCox Model\n\n\nGLM Model\n\n\n\nlog(HR)\n95% CI\np-value\nBeta\n95% CI\np-value\n\n\n\n\nalbumin\n-1.7\n-2.1, -1.2\n&lt;0.001\n1,128\n813, 1,442\n&lt;0.001\n\n\nsex\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n    m\n—\n—\n\n\n—\n—\n\n\n\n\n    f\n-0.56\n-1.1, -0.06\n0.027\n34\n-360, 428\n0.9\n\n\nage\n0.03\n0.01, 0.05\n0.004\n-7.7\n-20, 4.9\n0.2\n\n\n\nAbbreviations: CI = Confidence Interval, HR = Hazard Ratio\n\n\n\n\n\n\n\n\n图 6: 模型横向整合\n\n\n\n\n该表使用tbl_merge横向整合了pdb患者的Cox比例风险模型和广义线性回归模型的结果。\n模型纵向整合\n\n# 模型纵向整合\nt1 &lt;- coxph(Surv(time, status) ~ albumin + sex + age,\n  data = df[df$hepato==0,]\n) %&gt;%\n  tbl_regression()\n\nt2 &lt;- coxph(Surv(time, status) ~ albumin + sex + age,\n  data = df[df$hepato==1,]\n) %&gt;%\n  tbl_regression()\n\ntbl_stack(list(t1, t2), group_header = c(\"Patients without hepato\", \"Patients with hepato\"))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\nlog(HR)\n95% CI\np-value\n\n\n\n\nPatients without hepato\n\n\nalbumin\n-1.4\n-2.3, -0.47\n0.003\n\n\nsex\n\n\n\n\n\n\n\n\n    m\n—\n—\n\n\n\n\n    f\n-1.1\n-1.9, -0.36\n0.004\n\n\nage\n0.06\n0.03, 0.09\n&lt;0.001\n\n\nPatients with hepato\n\n\nalbumin\n-1.4\n-2.0, -0.87\n&lt;0.001\n\n\nsex\n\n\n\n\n\n\n\n\n    m\n—\n—\n\n\n\n\n    f\n-0.29\n-0.97, 0.38\n0.4\n\n\nage\n0.01\n-0.01, 0.04\n0.3\n\n\n\nAbbreviations: CI = Confidence Interval, HR = Hazard Ratio\n\n\n\n\n\n\n\n\n图 7: 模型纵向整合\n\n\n\n\n该表使用tbl_stack纵向整合了有无hepato的两组pdb患者的Cox比例风险模型的结果。",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> 𝐂𝐋𝐈𝐍𝐈𝐂𝐒",
      "RegressionTable"
    ]
  },
  {
    "objectID": "Clinics/RegressionTable.html#应用场景",
    "href": "Clinics/RegressionTable.html#应用场景",
    "title": "回归分析表格",
    "section": "应用场景",
    "text": "应用场景\n\n\n\n\n\n\n图 8: 回归分析表格\n\n\n\n单变量和多变量Cox回归分析表格用于中危NMIBC患者3年肿瘤复发情况。[1]\n\n\n\n\n\n\n图 9: 回归分析表格\n\n\n\n该回归分析表格显示了多变量Cox回归分析中晚期总死亡率的独立预测因素。[2]",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> 𝐂𝐋𝐈𝐍𝐈𝐂𝐒",
      "RegressionTable"
    ]
  },
  {
    "objectID": "Clinics/RegressionTable.html#参考文献",
    "href": "Clinics/RegressionTable.html#参考文献",
    "title": "回归分析表格",
    "section": "参考文献",
    "text": "参考文献\n[1] CHEN J X, HUANG W T, ZHANG Q Y, et al. The optimal intravesical maintenance chemotherapy scheme for the intermediate-risk group non-muscle-invasive bladder cancer[J]. BMC Cancer, 2023,23(1): 1018.\n[2] BENKE K, ÁGG B, SZABÓ L, et al. Bentall procedure: quarter century of clinical experiences of a single surgeon[J]. J Cardiothorac Surg, 2016,11: 19.",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> 𝐂𝐋𝐈𝐍𝐈𝐂𝐒",
      "RegressionTable"
    ]
  },
  {
    "objectID": "Clinics/KaplanMeierPlot.html",
    "href": "Clinics/KaplanMeierPlot.html",
    "title": "KM 曲线",
    "section": "",
    "text": "生存分析研究的是某个事件发生之前过去的时间，在临床研究中最常见的应用就是死亡率的估计(预测患者的生存时间)，不过生存分析也可以应用于其他领域如机械故障时间等。",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> 𝐂𝐋𝐈𝐍𝐈𝐂𝐒",
      "KaplanMeierPlot"
    ]
  },
  {
    "objectID": "Clinics/KaplanMeierPlot.html#示例",
    "href": "Clinics/KaplanMeierPlot.html#示例",
    "title": "KM 曲线",
    "section": "",
    "text": "生存分析研究的是某个事件发生之前过去的时间，在临床研究中最常见的应用就是死亡率的估计(预测患者的生存时间)，不过生存分析也可以应用于其他领域如机械故障时间等。",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> 𝐂𝐋𝐈𝐍𝐈𝐂𝐒",
      "KaplanMeierPlot"
    ]
  },
  {
    "objectID": "Clinics/KaplanMeierPlot.html#环境配置",
    "href": "Clinics/KaplanMeierPlot.html#环境配置",
    "title": "KM 曲线",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求: ## 跨平台（Linux/MacOS/Windows）\n编程语言: R\n依赖包: survival, survminer, ggplot2, dplyr, tidyr, zoo, and patchwork\n\n\n# install packages\nif (!requireNamespace(\"survival\", quietly = TRUE)) {\n  install.packages(\"survival\")\n}\n\nif (!requireNamespace(\"survminer\", quietly = TRUE)) {\n  install.packages(\"survminer\")\n}\n\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\n\nif (!requireNamespace(\"tidyr\", quietly = TRUE)) {\n  install.packages(\"tidyr\")\n}\n\nif (!requireNamespace(\"zoo\", quietly = TRUE)) {\n  install.packages(\"zoo\")\n}\n\nif (!requireNamespace(\"patchwork\", quietly = TRUE)) {\n  install.packages(\"patchwork\")\n}\n\n# load packages\nlibrary(\"survival\")\nlibrary(\"survminer\")\n## Loading required package: ggplot2\n## Loading required package: ggpubr\n## \n## Attaching package: 'survminer'\n## The following object is masked from 'package:survival':\n## \n##     myeloma\nlibrary(\"ggplot2\")\nlibrary(\"dplyr\")\n## \n## Attaching package: 'dplyr'\n## The following objects are masked from 'package:stats':\n## \n##     filter, lag\n## The following objects are masked from 'package:base':\n## \n##     intersect, setdiff, setequal, union\nlibrary(\"tidyr\")\nlibrary(\"zoo\")\n## \n## Attaching package: 'zoo'\n## The following objects are masked from 'package:base':\n## \n##     as.Date, as.Date.numeric\nlibrary(\"patchwork\")\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package   * version date (UTC) lib source\n dplyr     * 1.1.4   2023-11-17 [1] RSPM\n ggplot2   * 4.0.1   2025-11-14 [1] RSPM\n ggpubr    * 0.6.2   2025-10-17 [1] RSPM\n patchwork * 1.3.2   2025-08-25 [1] RSPM\n survival  * 3.8-3   2024-12-17 [3] CRAN (R 4.5.2)\n survminer * 0.5.1   2025-09-02 [1] RSPM\n tidyr     * 1.3.2   2025-12-19 [1] RSPM\n zoo       * 1.8-15  2025-12-15 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> 𝐂𝐋𝐈𝐍𝐈𝐂𝐒",
      "KaplanMeierPlot"
    ]
  },
  {
    "objectID": "Clinics/KaplanMeierPlot.html#数据准备",
    "href": "Clinics/KaplanMeierPlot.html#数据准备",
    "title": "KM 曲线",
    "section": "数据准备",
    "text": "数据准备\n\n# 使用内置lung数据集（来自survival包）\ndata(\"lung\", package = \"survival\")\n# 数据预处理\nsurv_data &lt;- lung %&gt;%\n  mutate(\n    status = ifelse(status == 2, 1, 0),  # 转换状态编码（1=事件）\n    sex = factor(sex, labels = c(\"Male\", \"Female\")),\n    group = sample(c(\"Treatment\", \"Placebo\"), n(), replace = TRUE)\n  )\n\n# 查看数据结构\nglimpse(surv_data)\n\nRows: 228\nColumns: 11\n$ inst      &lt;dbl&gt; 3, 3, 3, 5, 1, 12, 7, 11, 1, 7, 6, 16, 11, 21, 12, 1, 22, 16…\n$ time      &lt;dbl&gt; 306, 455, 1010, 210, 883, 1022, 310, 361, 218, 166, 170, 654…\n$ status    &lt;dbl&gt; 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …\n$ age       &lt;dbl&gt; 74, 68, 56, 57, 60, 74, 68, 71, 53, 61, 57, 68, 68, 60, 57, …\n$ sex       &lt;fct&gt; Male, Male, Male, Male, Male, Male, Female, Female, Male, Ma…\n$ ph.ecog   &lt;dbl&gt; 1, 0, 0, 1, 0, 1, 2, 2, 1, 2, 1, 2, 1, NA, 1, 1, 1, 2, 2, 1,…\n$ ph.karno  &lt;dbl&gt; 90, 90, 90, 90, 100, 50, 70, 60, 70, 70, 80, 70, 90, 60, 80,…\n$ pat.karno &lt;dbl&gt; 100, 90, 90, 60, 90, 80, 60, 80, 80, 70, 80, 70, 90, 70, 70,…\n$ meal.cal  &lt;dbl&gt; 1175, 1225, NA, 1150, NA, 513, 384, 538, 825, 271, 1025, NA,…\n$ wt.loss   &lt;dbl&gt; NA, 15, 15, 11, 0, 0, 10, 1, 16, 34, 27, 23, 5, 32, 60, 15, …\n$ group     &lt;chr&gt; \"Placebo\", \"Treatment\", \"Placebo\", \"Placebo\", \"Placebo\", \"Tr…\n\n# 生存时间分布\nsummary(surv_data$time)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n    5.0   166.8   255.5   305.2   396.5  1022.0 \n\n# 拟合生存曲线\nfit &lt;- survfit(Surv(time, status) ~ group, data = surv_data)\n\n# 提取曲线数据\nsurv_curve &lt;- surv_summary(fit) \n\n\n# 计算log-rank检验P值\ndiff &lt;- survdiff(Surv(time, status) ~ group, data = surv_data)\np_value &lt;- signif(1 - pchisq(diff$chisq, length(diff$n)-1), 3)",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> 𝐂𝐋𝐈𝐍𝐈𝐂𝐒",
      "KaplanMeierPlot"
    ]
  },
  {
    "objectID": "Clinics/KaplanMeierPlot.html#可视化",
    "href": "Clinics/KaplanMeierPlot.html#可视化",
    "title": "KM 曲线",
    "section": "可视化",
    "text": "可视化\n\n1. 基础绘图\n使用基础函数绘制图片的图注和简介。\n\n# 基础生存曲线\np1 &lt;- ggplot(surv_curve, aes(x = time, y = surv, color = strata)) +\n  geom_step(linewidth = 1) +\n  labs(x = \"Time (Months)\", y = \"Survival Probability\") +\n  scale_y_continuous(labels = scales::percent)\np1\n\n\n\n\n\n\n\n图 1: 基础生存曲线\n\n\n\n\n\n\n# 代码示例（以补充参数bins为例）-----\n## 自定义美学映射\ngroup_colors &lt;- c(\"Treatment\" = \"#E64B35\", \"Placebo\" = \"#3182BD\")\nline_types &lt;- c(\"Treatment\" = \"solid\", \"Placebo\" = \"dashed\")\n\n# 完整绘图代码\np_km &lt;- ggplot(surv_curve, aes(x = time, color = group, fill = group)) +\n      # 先绘制置信区间\n      geom_ribbon(aes(ymin = lower, ymax = upper), \n                  alpha = 0.15, \n                  colour = NA) +\n      # 再绘制生存曲线\n      geom_step(aes(y = surv, linetype = group), \n                linewidth = 1.2) +\n      # 颜色映射\n      scale_color_manual(\n        values = group_colors,\n        name = \"Treatment Group\",\n        labels = c(\"Placebo\", \"Treatment\")\n      ) +\n      # 填充色映射\n      scale_fill_manual(\n        values = group_colors,\n        guide = \"none\"\n      ) +\n      # 线型映射\n      scale_linetype_manual(\n        values = line_types,\n        guide = \"none\"  # 与颜色共用图例\n      ) +\n      # 坐标轴优化\n      scale_x_continuous(\n        name = \"Time (Months)\",\n        expand = c(0, 0),\n        breaks = seq(0, 1000, by = 100)\n      ) +\n      scale_y_continuous(\n        name = \"Survival Probability\",\n        labels = scales::percent,\n        limits = c(0, 1)\n      ) +\n      # 主题设置\n      theme_classic(base_size = 12) +\n      theme(\n        legend.position = c(0.85, 0.85),\n        legend.background = element_rect(fill = \"white\", colour = \"grey50\"),\n        panel.grid.major.y = element_line(colour = \"grey90\")\n      )\np_km\n\n\n\n\n\n\n\n图 2: 基础生存曲线\n\n\n\n\n\n\n\n2. 更多进阶图表\n\n# ----------------------------\n# 风险表数据生成\n# ----------------------------\n# 生成分位数断点（自动适应数据分布）\ncustom_breaks &lt;- quantile(surv_curve$time, \n                          probs = seq(0, 1, 0.25), \n                          na.rm = TRUE) %&gt;%\n  unique()  # 确保断点唯一\n\n# 正确生成区间标签的方法\ntime_labels &lt;- paste0(\n  round(custom_breaks[-length(custom_breaks)]),  # 起始点（排除最后一个）\n  \"-\",\n  round(custom_breaks[-1])  # 结束点（排除第一个）\n)\n\n# 生成分段式风险表数据 --------------------------------------------------------\nrisk_table_segmented &lt;- surv_curve %&gt;%\n  mutate(\n    time_interval = cut(time,\n                        breaks = custom_breaks,\n                        include.lowest = TRUE,\n                        right = FALSE,\n                        labels = time_labels)\n  ) %&gt;%\n  group_by(group, time_interval) %&gt;%\n  summarise(\n    n_risk = ifelse(all(is.na(n.risk)), 0, max(n.risk, na.rm = TRUE)),  # 取区间内最大风险人数\n    .groups = \"drop\"\n  ) %&gt;%\n  complete(group, time_interval, fill = list(n_risk = 0)) %&gt;%\n  # 4. 添加总计行（修复语法）\n  bind_rows(\n    group_by(., group) %&gt;%\n      summarise(\n        time_interval = \"Total\",\n        n_risk = sum(n_risk, na.rm = TRUE),\n        .groups = \"drop\"\n      )\n  ) %&gt;%\n  mutate(\n    group = factor(group, levels = c(\"Treatment\", \"Placebo\")),\n    time_interval = factor(time_interval, levels = c(time_labels, \"Total\") )\n  )\n\n# 带边框的分段式风险表绘图 ----------------------------------------------------\nrisk_table_plot &lt;- ggplot(risk_table_segmented, \n                          aes(x = time_interval, y = group)) +\n  # # 单元格背景（带边框）\n  # geom_tile(color = \"gray50\", fill = \"white\", linewidth = 0.5, \n  #           width = 0.95, height = 0.95) +\n  # 数值标签\n  geom_text(aes(label = n_risk), size = 4.5, fontface = \"bold\", color = \"black\") +\n  # 列标题样式\n  scale_x_discrete(\n    name = \"Time Interval (Months)\",\n    position = \"top\",\n    expand = expansion(add = 0.5)\n  ) +\n  scale_y_discrete(\n    name = NULL, \n    limits = rev,\n    labels = c(\"Treatment\\nGroup\", \"Placebo\\nGroup\")  # 添加分组标签\n  ) +\n  # 颜色系统\n  scale_fill_manual(values = group_colors, guide = \"none\") +\n  # 主题系统\n  theme_minimal(base_size = 12) +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 0, color = \"black\"),\n    axis.text.y = element_text(\n      color = group_colors,\n      face = \"bold\",\n      margin = margin(r = 15)\n    ),\n    panel.grid = element_blank(),\n    plot.margin = margin(t = 30, b = 5, unit = \"pt\"),\n    axis.title.x = element_text(margin = margin(t = 15))\n  ) +\n  # 添加外边框\n  annotate(\"rect\",\n           xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf,\n           color = \"gray30\", fill = NA, linewidth = 0.8)\nrisk_table_plot\n\n# ----------------------------\n# 绘图参数设置\n# ----------------------------\ngroup_colors &lt;- c(\"Treatment\" = \"#E64B35\", \"Placebo\" = \"#3182BD\")\ntheme_set(theme_minimal(base_size = 12))\n\n# ----------------------------\n# KM生存曲线绘制\n# ----------------------------\np_km &lt;- ggplot(surv_curve, aes(x = time, color = group, fill = group)) +\n  # 先绘制置信区间\n  geom_ribbon(aes(ymin = lower, ymax = upper), \n              alpha = 0.15, \n              colour = NA) +\n  # 再绘制生存曲线\n  geom_step(aes(y = surv, linetype = group), \n            linewidth = 1.2) +\n  # 颜色映射\n  scale_color_manual(\n    values = group_colors,\n    name = \"Treatment Group\",\n    labels = c(\"Placebo\", \"Treatment\")\n  ) +\n  # 填充色映射\n  scale_fill_manual(\n    values = group_colors,\n    guide = \"none\"\n  ) +\n  # 线型映射\n  scale_linetype_manual(\n    values = line_types,\n    guide = \"none\"  # 与颜色共用图例\n  ) +\n  # 坐标轴优化\n  scale_x_continuous(\n    name = \"Time (Months)\",\n    expand = c(0, 0),\n    breaks = seq(0, 1000, by = 100)\n  ) +\n  scale_y_continuous(\n    name = \"Survival Probability\",\n    labels = scales::percent,\n    limits = c(0, 1)\n  ) +\n  # 主题设置\n  theme_classic(base_size = 12) +\n  theme(\n    legend.position = c(0.85, 0.85),\n    legend.background = element_rect(fill = \"white\", colour = \"grey50\"),\n    panel.grid.major.y = element_line(colour = \"grey90\")\n  )\np_km\n\n# ----------------------------\n# 图形组合\n# ----------------------------\nfinal_plot &lt;- p_km / risk_table_plot + \n  plot_layout(heights = c(3, 0.4))\n\nfinal_plot\n\n\n\n\n\n\n\n图 3: 美化版生存曲线",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> 𝐂𝐋𝐈𝐍𝐈𝐂𝐒",
      "KaplanMeierPlot"
    ]
  },
  {
    "objectID": "Clinics/KaplanMeierPlot.html#应用场景",
    "href": "Clinics/KaplanMeierPlot.html#应用场景",
    "title": "KM 曲线",
    "section": "应用场景",
    "text": "应用场景\n\n1. 疾病分布\n\n\n\n\n\n\n图 4: 三组KM曲线\n\n\n\n该图展示了 Standard、New Drug、Combination 三组数据之间的生成生存时间比较。",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> 𝐂𝐋𝐈𝐍𝐈𝐂𝐒",
      "KaplanMeierPlot"
    ]
  },
  {
    "objectID": "Clinics/KaplanMeierPlot.html#参考文献",
    "href": "Clinics/KaplanMeierPlot.html#参考文献",
    "title": "KM 曲线",
    "section": "参考文献",
    "text": "参考文献\n[1] Kassambara A, et al. Survminer: Drawing Survival Curves using ggplot2. JOSS 2017\n[2] Wickham H. ggplot2: Elegant Graphics for Data Analysis. Springer 2016",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> 𝐂𝐋𝐈𝐍𝐈𝐂𝐒",
      "KaplanMeierPlot"
    ]
  },
  {
    "objectID": "Clinics/MosaicPlot.html",
    "href": "Clinics/MosaicPlot.html",
    "title": "马赛克图",
    "section": "",
    "text": "马赛克图（mosaic plot），显示分类数据中一对变量之间的关系，原理类似双向的100%堆叠式条形图，但其中所有条形在数值/标尺轴上具有相等长度，并会被划分成段。可以通过这两个变量来检测类别与其子类别之间的关系。",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> 𝐂𝐋𝐈𝐍𝐈𝐂𝐒",
      "MosaicPlot"
    ]
  },
  {
    "objectID": "Clinics/MosaicPlot.html#示例",
    "href": "Clinics/MosaicPlot.html#示例",
    "title": "马赛克图",
    "section": "",
    "text": "马赛克图（mosaic plot），显示分类数据中一对变量之间的关系，原理类似双向的100%堆叠式条形图，但其中所有条形在数值/标尺轴上具有相等长度，并会被划分成段。可以通过这两个变量来检测类别与其子类别之间的关系。",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> 𝐂𝐋𝐈𝐍𝐈𝐂𝐒",
      "MosaicPlot"
    ]
  },
  {
    "objectID": "Clinics/MosaicPlot.html#环境配置",
    "href": "Clinics/MosaicPlot.html#环境配置",
    "title": "马赛克图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：ggplot2, reshape2, plyr, dplyr, vcd, graphics, wesanderson\n\n\n# 安装包\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"reshape2\", quietly = TRUE)) {\n  install.packages(\"reshape2\")\n}\nif (!requireNamespace(\"plyr\", quietly = TRUE)) {\n  install.packages(\"plyr\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"tidyr\", quietly = TRUE)) {\n  install.packages(\"tidyr\")\n}\nif (!requireNamespace(\"vcd\", quietly = TRUE)) {\n  install.packages(\"vcd\")\n}\nif (!requireNamespace(\"graphics\", quietly = TRUE)) {\n  install.packages(\"graphics\")\n}\nif (!requireNamespace(\"wesanderson\", quietly = TRUE)) {\n  install.packages(\"wesanderson\")\n}\n\n# 加载包\nlibrary(ggplot2)\nlibrary(reshape2)\nlibrary(plyr)\nlibrary(dplyr)\nlibrary(vcd)\nlibrary(graphics)\nlibrary(wesanderson)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package     * version date (UTC) lib source\n dplyr       * 1.1.4   2023-11-17 [1] RSPM\n ggplot2     * 4.0.1   2025-11-14 [1] RSPM\n plyr        * 1.8.9   2023-10-02 [1] RSPM\n reshape2    * 1.4.5   2025-11-12 [1] RSPM\n vcd         * 1.4-13  2024-09-16 [1] RSPM\n wesanderson * 0.3.7   2023-10-31 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> 𝐂𝐋𝐈𝐍𝐈𝐂𝐒",
      "MosaicPlot"
    ]
  },
  {
    "objectID": "Clinics/MosaicPlot.html#数据准备",
    "href": "Clinics/MosaicPlot.html#数据准备",
    "title": "马赛克图",
    "section": "数据准备",
    "text": "数据准备\n\n# 生成模拟数据\ndf &lt;- data.frame(segment = c(\"Patient1\", \"Patient2\", \"Patient3\",\"Patient4\"),\n                 \"Macrophage\" = c(2400  ,1200,  600 ,250),\n                 \"Epithelial\" = c(1000  ,900,   600,    250),\n                 \"T cells\" = c(400, 600 ,400,   250),\n                 \"B cells\" = c(200, 300 ,400,   250))\n\nmelt_df&lt;-melt(df,id=\"segment\")\n#将数字转换成百分比\nsegpct&lt;-rowSums(df[,2:ncol(df)])\nfor (i in 1:nrow(df)){\n  for (j in 2:ncol(df)){\n    df[i,j]&lt;-df[i,j]/segpct[i]*100  \n  }\n}\n\nsegpct&lt;-segpct/sum(segpct)*100\ndf$xmax &lt;- cumsum(segpct)\ndf$xmin &lt;- (df$xmax - segpct)\n\ndfm &lt;- melt(df, id = c(\"segment\", \"xmin\", \"xmax\"),value.name=\"percentage\")\ncolnames(dfm)[ncol(dfm)]&lt;-\"percentage\"\n\n#ddply()函数使用自定义统计函数，对data.frame分组计算\ndfm1 &lt;- ddply(dfm, .(segment), transform, ymax = cumsum(percentage))\ndfm1 &lt;- ddply(dfm1, .(segment), transform,ymin = ymax - percentage)\ndfm1$xtext &lt;- with(dfm1, xmin + (xmax - xmin)/2)\ndfm1$ytext &lt;- with(dfm1, ymin + (ymax - ymin)/2)\n\n#join()函数，连接两个表格data.frame\ndfm2&lt;-join(melt_df, dfm1, by = c(\"segment\", \"variable\"), type = \"left\", match = \"all\")\n\n# 查看最终的合并数据集\nhead(dfm2)\n\n   segment   variable value xmin xmax percentage ymax ymin xtext ytext\n1 Patient1 Macrophage  2400    0   40         60   60    0    20  30.0\n2 Patient2 Macrophage  1200   40   70         40   40    0    55  20.0\n3 Patient3 Macrophage   600   70   90         30   30    0    80  15.0\n4 Patient4 Macrophage   250   90  100         25   25    0    95  12.5\n5 Patient1 Epithelial  1000    0   40         25   85   60    20  72.5\n6 Patient2 Epithelial   900   40   70         30   70   40    55  55.0",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> 𝐂𝐋𝐈𝐍𝐈𝐂𝐒",
      "MosaicPlot"
    ]
  },
  {
    "objectID": "Clinics/MosaicPlot.html#可视化",
    "href": "Clinics/MosaicPlot.html#可视化",
    "title": "马赛克图",
    "section": "可视化",
    "text": "可视化\n\n1. 基础绘图\n使用基础函数绘制图片的图注和简介。\n\n# 基础绘图\np &lt;- ggplot() +\n  geom_rect(aes(ymin = ymin, ymax = ymax, xmin = xmin, xmax = xmax, fill = variable),dfm2,colour = \"black\") +\n  geom_text(aes(x = xtext, y = ytext,  label = value),dfm2 ,size = 4)+\n  geom_text(aes(x = xtext, y = 103, label = paste(segment)),dfm2 ,size = 4)+\n  geom_text(aes(x = 102, y = seq(12.5,100,25), label = c(\"Macrophage\",\"Epithelial\",\"T cells\",\"B cells\")), size = 4,hjust = 0)+\n  scale_x_continuous(breaks=seq(0,100,25),limits=c(0,110))+\n  theme(panel.background=element_rect(fill=\"white\",colour=NA),\n        panel.grid.major = element_line(colour = \"grey60\",size=.25,linetype =\"dotted\" ),\n        panel.grid.minor = element_line(colour = \"grey60\",size=.25,linetype =\"dotted\" ),\n        text=element_text(size=15),\n        legend.position=\"none\")\n\np\n\n\n\n\n\n\n\n图 1: 基础绘图\n\n\n\n\n\n\n# 进一步美化\n# 数据再处理\ndfm1 &lt;- ddply(dfm, .(segment), transform, ymax = cumsum(percentage))\ndfm1 &lt;- ddply(dfm1, .(segment), transform, ymin = ymax - percentage)\n\n# 创建间隔\nspacing &lt;- 1\ndfm1$ymin &lt;- dfm1$ymin + spacing * (as.numeric(factor(dfm1$variable)) - 1)  # 纵向间隔\ndfm1$ymax &lt;- dfm1$ymax + spacing * (as.numeric(factor(dfm1$variable)) - 1)  # 纵向间隔\n\n# 计算文本显示位置\ndfm1$xtext &lt;- with(dfm1, xmin + (xmax - xmin) / 2)\ndfm1$ytext &lt;- with(dfm1, ymin + (ymax - ymin) / 2)\n\n# 连接数据框\ndfm2 &lt;- join(melt_df, dfm1, by = c(\"segment\", \"variable\"), type = \"left\", match = \"all\")\n\np2 &lt;- ggplot() +\n  geom_rect(aes(ymin = ymin, ymax = ymax, \n                xmin = xmin + 5 * (as.numeric(factor(segment)) - 1),  # 横向间隔\n                xmax = xmax + 5 * (as.numeric(factor(segment)) - 1), \n                fill = variable),\n            dfm2, colour = \"black\") +\n  geom_text(aes(x = xtext + 5 * (as.numeric(factor(segment)) - 1),\n                y = ytext, label = value),\n            dfm2, size = 4) +\n  geom_text(aes(x = xtext + 5 * (as.numeric(factor(segment)) - 1),\n                y = max(dfm1$ymax) + spacing * 2,\n                label = paste(segment)),\n            dfm2, size = 4) +\n  geom_text(aes(x = 116, y = seq(12.5, 100, 25) + spacing * 0.5, \n                label = c(\"Macrophage\", \"Epithelial\", \"T cells\", \"B cells\")), \n            size = 4, hjust = 0) +\n  scale_x_continuous(breaks = NULL, limits = c(0, 110 + 5 * 3), expand = c(0, 0)) +  # 去掉横坐标\n  scale_y_continuous(breaks = NULL, limits = c(0, max(dfm1$ymax) + spacing * 3), expand = c(0, 0)) +  # 去掉纵坐标\n  theme(panel.background = element_rect(fill = \"white\", colour = NA),\n        panel.grid.major = element_blank(),  # 去掉网格\n        panel.grid.minor = element_blank(),  # 去掉网格\n        text = element_text(size = 15),\n        legend.position = \"none\",\n        axis.title.x = element_blank(),  # 去掉 x 轴标题\n        axis.title.y = element_blank(),  # 去掉 y 轴标题\n        axis.ticks = element_blank())  # 去掉坐标轴刻度\n\np2\n\n\n\n\n\n\n\n图 2: 进一步美化\n\n\n\n\n\n\n\n2. 高阶作图\n\n2.1 vcd 包\n\n# 创建表格\ntable &lt;- xtabs(value ~variable+segment, melt_df)\n\n# 绘制\np3 &lt;- mosaic(~segment+variable,table,shade=TRUE,legend=TRUE,color=TRUE)\n\n\n\n\n\n\n\n图 3: vcd 包\n\n\n\n\n\n\n\n2.2 graphics 包\n\np4 &lt;- mosaicplot( ~segment+variable,table, color = wes_palette(\"FrenchDispatch\"),main = '')\n\n\n\n\n\n\n\n图 4: graphics 包",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> 𝐂𝐋𝐈𝐍𝐈𝐂𝐒",
      "MosaicPlot"
    ]
  },
  {
    "objectID": "Clinics/MosaicPlot.html#应用场景",
    "href": "Clinics/MosaicPlot.html#应用场景",
    "title": "马赛克图",
    "section": "应用场景",
    "text": "应用场景\n\n\n\n\n\n\n图 5: 马赛克图应用\n\n\n\n该马赛克图显示了特定类群与特定肿瘤转移位点的关联。[1]",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> 𝐂𝐋𝐈𝐍𝐈𝐂𝐒",
      "MosaicPlot"
    ]
  },
  {
    "objectID": "Clinics/MosaicPlot.html#参考文献",
    "href": "Clinics/MosaicPlot.html#参考文献",
    "title": "马赛克图",
    "section": "参考文献",
    "text": "参考文献\n[1] Lee H, Na KJ, Choi H. Differences in Tumor Immune Microenvironment in Metastatic Sites of Breast Cancer. Front Oncol. 2021;11:649004. Published 2021 Mar 18. doi:10.3389/fonc.2021.649004.\n[2] Friendly, M. (2002). “A Brief History of the Mosaic Display.” Journal of Computational and Graphical Statistics, 11(1), 89-107.\n[3] Meyer, D., et al. (2006). “The Strucplot Framework: Visualizing Multi-Way Contingency Tables with vcd.” Journal of Statistical Software, 17(3), 1-48.\n[4] Gehlenborg, N. (2014). “UpSetR: An Alternative to Mosaic Plots for Visualizing Intersecting Sets.” Nature Methods, 11(8), 769-770.\n[5] Nowicka, M., et al. (2017). “CyTOF Workflow: Differential Discovery in High-Throughput High-Dimensional Cytometry Datasets.” F1000Research, 6, 748.\n[6] Wilke, C.O. (2020). “Fundamentals of Data Visualization in Biomedicine.” Springer.\n[7] R Core Team (2023). “R: A Language and Environment for Statistical Computing.”\n[8] Slowikowski, K. (2021). “ggrepel: Automatically Position Non-Overlapping Text Labels in ggplot2.” Bioinformatics, 37(9), 1333-1334.",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> 𝐂𝐋𝐈𝐍𝐈𝐂𝐒",
      "MosaicPlot"
    ]
  },
  {
    "objectID": "Distribution/RadialColumnChart.html",
    "href": "Distribution/RadialColumnChart.html",
    "title": "径向柱状图",
    "section": "",
    "text": "通过环形布局展示四足动物各分类群受威胁物种比例，蓝色基准线表示最佳估计比例，灰色网格线辅助百分比读数。",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "RadialColumnChart"
    ]
  },
  {
    "objectID": "Distribution/RadialColumnChart.html#示例",
    "href": "Distribution/RadialColumnChart.html#示例",
    "title": "径向柱状图",
    "section": "",
    "text": "通过环形布局展示四足动物各分类群受威胁物种比例，蓝色基准线表示最佳估计比例，灰色网格线辅助百分比读数。",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "RadialColumnChart"
    ]
  },
  {
    "objectID": "Distribution/RadialColumnChart.html#环境配置",
    "href": "Distribution/RadialColumnChart.html#环境配置",
    "title": "径向柱状图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：ggplot2, dplyr, scales, ggforce\n\n\n# 安装包\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"scales\", quietly = TRUE)) {\n  install.packages(\"scales\")\n}\nif (!requireNamespace(\"ggforce\", quietly = TRUE)) {\n  install.packages(\"ggforce\")\n}\n\n# 加载包\nlibrary(ggplot2)    \nlibrary(dplyr)      \nlibrary(scales)    \nlibrary(ggforce)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package * version date (UTC) lib source\n dplyr   * 1.1.4   2023-11-17 [1] RSPM\n ggforce * 0.5.0   2025-06-18 [1] RSPM\n ggplot2 * 4.0.1   2025-11-14 [1] RSPM\n scales  * 1.4.0   2025-04-24 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "RadialColumnChart"
    ]
  },
  {
    "objectID": "Distribution/RadialColumnChart.html#数据准备",
    "href": "Distribution/RadialColumnChart.html#数据准备",
    "title": "径向柱状图",
    "section": "数据准备",
    "text": "数据准备\n\n需包含R内置的数据集（如iris、penguins）和生物医学相关数据集（如组学数据、生存信息、临床指标等）。\n生物医学相关数据集需上传至Bizard腾讯云以便获取插入教程的链接，来自于公共数据集的数据最佳，若由个人/组织提供需确保数据能够被公开。数据集大小需小于1MB。\n\n\n# 数据读入和处理代码可以自由选择是否展示------\n# 生成模拟临床数据\nset.seed(123)\nn &lt;- 12  # 样本量\n\ndf &lt;- data.frame(\n  id = 1:n,\n  patient = paste0(\"P-\", sprintf(\"%02d\", 1:n)),\n  value = c(rnorm(6, 80, 15), rnorm(6, 120, 20)),  # 对照组与治疗组\n  group = rep(c(\"Control\", \"Treatment\"), each = 6)\n) %&gt;%\n  mutate(\n    angle = 90 - 360 * (id - 0.5)/n,\n    hjust = ifelse(angle &lt; -90, 1, 0),\n    angle = ifelse(angle &lt; -90, angle + 180, angle)\n  )\n\n# 添加内置数据集\ndata(\"iris\")",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "RadialColumnChart"
    ]
  },
  {
    "objectID": "Distribution/RadialColumnChart.html#可视化",
    "href": "Distribution/RadialColumnChart.html#可视化",
    "title": "径向柱状图",
    "section": "可视化",
    "text": "可视化\n\n1. 简单环形布局\n\n# 基础柱状图\np1 &lt;- ggplot(df, aes(x = factor(id), y = value)) +\n  geom_col(aes(fill = group), width = 0.8, alpha = 0.8) +\n  coord_radial(inner.radius = 0.3) +\n  scale_fill_manual(values = c(\"#1E88E5\", \"#D81B60\")) +\n  theme_void() +\n  labs(title = \"治疗组与对照组指标对比\")\np1\n\n\n\n\n\n\n\n图 1: 基因表达范围径向图\n\n\n\n\n\n补充基础代码可以扩展的重要参数，并提供对应的绘图代码，例如：\n\n\n\n\n\n\n提示\n\n\n\n关键参数: \n\ncoord_radial(inner.radius=0.3): 控制中心空白区域比例\nwidth=0.8: 柱宽建议值范围0.5-1.0\nalpha=0.8: 设置颜色透明度\n\n\n\n\np2 &lt;- ggplot(df, aes(x = factor(id))) +\n  geom_col(aes(y = value, fill = group), width = 0.85) +\n  geom_text(aes(y = value + 15, label = patient, angle = angle), \n            size = 3, hjust = 0.3) +\n  coord_radial(start = -0.05 * pi) +\n  scale_fill_manual(values = c(\"#004D40\", \"#FFA000\")) +\n  theme_void() +\n  labs(fill = \"实验分组\")\n\np2\n\n\n\n\n\n\n\n图 2: 带患者标签的径向图\n\n\n\n\n\n\n\n2. 更多进阶图表\n\np1 &lt;- ggplot(df) +\n  geom_col(aes(x = id, y = value, fill = group), width = 0.85) +\n  geom_hline(yintercept = c(50, 100, 150), \n             color = \"grey80\", linetype = \"dashed\") +\n  geom_segment(aes(x = 0.5, xend = n+0.5, y = 100, yend = 100),\n               color = \"#283593\", linewidth = 0.8) +\n  geom_text(aes(x = id, y = value + 20, label = patient, angle = angle),\n            size = 3, hjust = 0.3) +\n  coord_radial(inner.radius = 0.25) +\n  scale_fill_brewer(palette = \"Set2\") +\n  theme_void() +\n  labs(caption = \"虚线表示临床指标参考区间\") +\n  theme(legend.position = \"bottom\")\n\np1\n\n\n\n\n\n\n\n图 3: 科研级径向柱状图\n\n\n\n\n\n\n# 生成主绘图对象\np1 &lt;-  ggplot(df) +\n  geom_col(aes(x = id, y = value, fill = group), \n           width = 0.85, alpha = 0.8) +\n  \n  # ========== 核心坐标轴系统 ==========\n# 主Y轴线（沿0度方向）\ngeom_segment(aes(x = 0.5, xend = 0.5, y = 0, yend = max(df$value) * 1.1),\n             color = \"grey40\", linewidth = 0.6, \n             arrow = arrow(length = unit(0.2, \"cm\"))) +\n  \n  # Y轴刻度线（放射状）\n  do.call(c, lapply(c(50, 100, 150), function(yval) {\n    geom_segment(aes(x = 0.5 - 0.05, xend = 0.5 + 0.05,\n                     y = yval, yend = yval),\n                 color = \"grey50\", linewidth = 0.4)\n  })) +  # 合并列表中的元素\n  \n  # Y轴刻度标签（沿轴线方向）\n  do.call(c, lapply(c(50, 100, 150), function(yval) {\n    geom_text(aes(x = 0.5 + 0.1, y = yval,\n                  label = yval, angle = -90),\n              color = \"grey30\", size = 3.5, hjust = 0)\n  })) +  # 合并列表中的元素\n  \n  # 其他横线和数据标签\n  geom_hline(yintercept = c(50, 100, 150), \n             color = \"grey80\", linetype = \"dashed\") +\n  geom_segment(aes(x = 0.5, xend = 0.5, y = 100, yend = 100), \n               color = \"#283593\", linewidth = 0.8) + # 修改 end 坐标，以适应极坐标\n  geom_text(aes(x = id, y = value + 20, label = patient, angle = angle),\n            size = 3, hjust = 0.3) +\n  \n  # ========== 坐标系设置 ==========\ncoord_radial(inner.radius = 0.35,\n             start = -0.1 * pi) +\n  \n  # ========== 视觉映射 ==========\nscale_fill_viridis_d(option = \"C\", begin = 0.2) +\n  theme_void() +\n  labs(caption = \"虚线表示临床指标参考区间\") +\n  theme(plot.margin = margin(2, 2, 2, 2, \"cm\"),\n        legend.position = \"bottom\")\n\np1\n\n\n\n\n\n\n\n图 4: 科研级径向柱状图",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "RadialColumnChart"
    ]
  },
  {
    "objectID": "Distribution/RadialColumnChart.html#应用场景",
    "href": "Distribution/RadialColumnChart.html#应用场景",
    "title": "径向柱状图",
    "section": "应用场景",
    "text": "应用场景\n展示可视化图表在生物医学文献中的实际应用，如果基础图表/进阶图表被广泛应用在各类生物医学文献，则可以选择分别展示。\n\n\n\n\n\n\n图 5: 径向柱状图应用\n\n\n\n该径向柱状图通过环形布局直观展示四足动物保护现状",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "RadialColumnChart"
    ]
  },
  {
    "objectID": "Distribution/RadialColumnChart.html#参考文献",
    "href": "Distribution/RadialColumnChart.html#参考文献",
    "title": "径向柱状图",
    "section": "参考文献",
    "text": "参考文献\n[1] Cox N, Young BE, & Xie Y. A global reptile assessment highlights shared conservation needs of tetrapods. Nature. 2022 May;605(7909):285-290. https://doi.org/10.1038/s41586-022-04664-7\n[2] Costa, A. M., Machado, J. T., & Quelhas, M. D. (2011). Histogram-based DNA analysis for the visualization of chromosome, genome, and species information. Bioinformatics, 27(9), 1207–1214. https://doi.org/10.1093/bioinformatics/btr131",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "RadialColumnChart"
    ]
  },
  {
    "objectID": "Distribution/Ridgeline.html",
    "href": "Distribution/Ridgeline.html",
    "title": "山脊线图",
    "section": "",
    "text": "山脊线图，也称为喜悦图，可视化了多个数值变量在不同类别中的分布。此方法可用于比较密度分布，同时保留趋势和变化的整体视图。",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Ridgeline Plot"
    ]
  },
  {
    "objectID": "Distribution/Ridgeline.html#示例",
    "href": "Distribution/Ridgeline.html#示例",
    "title": "山脊线图",
    "section": "示例",
    "text": "示例\n\n\n\n\n\n一个山脊线图表示数值变量在多个组中的分布。在本例中，该图显示了不同品质类别的钻石价格分布。x 轴表示价格值，而密度曲线则表示每个价格在每个品质组中出现的频率。",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Ridgeline Plot"
    ]
  },
  {
    "objectID": "Distribution/Ridgeline.html#环境配置",
    "href": "Distribution/Ridgeline.html#环境配置",
    "title": "山脊线图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：readr, ggplot2, ggridges, viridis, hrbrthemes\n\n\n# 安装包\nif (!requireNamespace(\"readr\", quietly = TRUE)) {\n  install.packages(\"readr\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"ggridges\", quietly = TRUE)) {\n  install.packages(\"ggridges\")\n}\nif (!requireNamespace(\"hrbrthemes\", quietly = TRUE)) {\n  install.packages(\"hrbrthemes\")\n}\nif (!requireNamespace(\"viridis\", quietly = TRUE)) {\n  install.packages(\"viridis\")\n}\n\n# 加载包\nlibrary(readr)      # 用于读取 TSV 文件\nlibrary(dplyr)      # 用于数据操作\nlibrary(ggplot2)    # 用于创建图\nlibrary(ggridges)   # 用于绘制山脊线图\nlibrary(hrbrthemes) # 用于增强的 ggplot2 主题\nlibrary(viridis)    # 用于颜色映射\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package     * version date (UTC) lib source\n dplyr       * 1.1.4   2023-11-17 [1] RSPM\n ggplot2     * 4.0.1   2025-11-14 [1] RSPM\n ggridges    * 0.5.7   2025-08-27 [1] RSPM\n hrbrthemes  * 0.9.2   2025-11-02 [1] Github (hrbrmstr/hrbrthemes@d3fd029)\n readr       * 2.1.6   2025-11-14 [1] RSPM\n viridis     * 0.6.5   2024-01-29 [1] RSPM\n viridisLite * 0.4.2   2023-05-02 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Ridgeline Plot"
    ]
  },
  {
    "objectID": "Distribution/Ridgeline.html#数据准备",
    "href": "Distribution/Ridgeline.html#数据准备",
    "title": "山脊线图",
    "section": "数据准备",
    "text": "数据准备\n以下是使用内置 R 数据集（iris）和来自 UCSC Xena DATASETS 的Lung Cancer (Raponi 2006)数据集的简短教程。\n\n# 加载 iris 数据集\ndata(\"iris\")\n\n# 加载 Lung Cancer (Raponi 2006) 临床数据集\nTCGA_clinic &lt;- readr::read_tsv(\"https://ucsc-public-main-xena-hub.s3.us-east-1.amazonaws.com/download/raponi2006_public%2Fraponi2006_public_clinicalMatrix.gz\") %&gt;%\n  mutate(T = as.factor(T))\nhead(TCGA_clinic)\n\n# A tibble: 6 × 16\n  sampleID   Age Differentiation Gender Histology     M     N Race \n  &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt;           &lt;chr&gt;  &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;\n1 LS-1        75 mod_poor        M      SCC           0     0 w    \n2 LS-10       61 poor            F      SCC           0     0 w    \n3 LS-100      72 mod             M      SCC           0     0 w    \n4 LS-101      75 mod             M      SCC           0     1 w    \n5 LS-102      76 mod             F      SCC           0     0 w    \n6 LS-103      58 well_mod        M      SCC           0     1 w    \n# ℹ 8 more variables: Smoking_History_Packyears &lt;dbl&gt;, Stage &lt;chr&gt;,\n#   OS.time &lt;dbl&gt;, T &lt;fct&gt;, OS &lt;chr&gt;, `_INTEGRATION` &lt;chr&gt;, `_PATIENT` &lt;chr&gt;,\n#   `_GENOMIC_ID_raponi2006` &lt;chr&gt;",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Ridgeline Plot"
    ]
  },
  {
    "objectID": "Distribution/Ridgeline.html#可视化",
    "href": "Distribution/Ridgeline.html#可视化",
    "title": "山脊线图",
    "section": "可视化",
    "text": "可视化\n\n1. 基础山脊线图\n图 1 描述了Sepal.Length变量在不同Species上的分布。\n\n# 基础山脊线图\np1_1 &lt;- ggplot(iris, aes(x = Sepal.Length, y = Species, fill = Species)) +\n  geom_density_ridges(alpha = 0.5) +\n  theme_ridges(font_size = 16, grid = TRUE) +\n  theme(legend.position = \"right\")\n\np1_1\n\n\n\n\n\n\n\n图 1: 基础山脊线图使用 iris 数据集\n\n\n\n\n\n图 2 描述了OS.time变量在原发肿瘤情况以及存活状态的分布\n\n# 基础山脊线图\np1_2 &lt;- ggplot(TCGA_clinic, aes(x = OS.time, y = T, fill = T)) +\n  geom_density_ridges(alpha = 0.5, scale = 2) +\n  theme_ridges(font_size = 16, grid = TRUE) +\n  theme(legend.position = \"right\")\n\np1_2\n\n\n\n\n\n\n\n图 2: 基础山脊线图使用 Lung Cancer (Raponi 2006) 数据集\n\n\n\n\n\n\n\n\n\n\n\n提示\n\n\n\n关键函数: geom_density_ridges() / theme_ridges()\ngeom_density_ridges()\ngeom_density_ridges 是一个非常灵活的函数，可用于创建多种样式的山脊线图。\n以下是 geom_density_ridges 的一些常用参数和选项：\n\nalpha: geom_density_ridges\ncolour: 设置线条颜色。\nfill: 根据分类变量填充颜色。\nscale: 控制脊线之间的重叠程度。\n\ntheme_ridges()\ntheme_ridges 是 ggridges 包提供的主题函数，专门用于美化脊图。\n该函数的参数包括：\n\n**font_size**: 整体字体大小，默认为 14。\nline_size: 默认线条大小。\ngrid: 如果设置为TRUE（默认值），则会绘制背景网格；如果设置为FALSE，则背景保持空白。\n\n\n\n\n\n2. 直方山脊线图\n直方图山脊图更适合于展示具体的数据分布和计数，而传统山脊图更适合于展示和比较不同类别的分布形状可以用不同的方式来表示密度。例如，使用stat=\"binline\"可以使每个分布呈现出类似直方图的形状。\n图 3 描述了Sepal.Length变量在不同Species上的分布\n\np2_1 &lt;- ggplot(iris, aes(x = Sepal.Length, y = Species, fill = Species)) +\n  geom_density_ridges(alpha = 0.5, stat = \"binline\", bins = 10) +\n  theme_ridges(font_size = 16, grid = TRUE) +\n  theme(legend.position = \"none\")\n\np2_1\n\n\n\n\n\n\n\n图 3: 直方山脊线图使用 iris 数据集\n\n\n\n\n\n图 4 描述了OS.time变量在原发肿瘤情况以及存活状态的分布。\n\np2_2 &lt;- ggplot(TCGA_clinic, aes(x = OS.time, y = T, fill = T)) +\n  geom_density_ridges(alpha = 0.5, stat = \"binline\", bins = 10) +\n  theme_ridges(font_size = 16, grid = TRUE) +\n  theme(legend.position = \"none\")\n\np2_2\n\n\n\n\n\n\n\n图 4: 直方山脊线图使用 Lung Cancer (Raponi 2006) 数据集\n\n\n\n\n\n\n\n3. 具有可变颜色的山脊线图\n可以设置颜色取决于数字变量而不是分类变量。在实际可视化应用中便于更加直观观测到数据的大小变化。\n图 5 描述了Sepal.Length变量在不同Species上的分布\n\np3_1 &lt;- ggplot(iris, aes(x = Sepal.Length, y = Species, fill = ..x..)) +  # 创建山脊图\n  geom_density_ridges_gradient(scale = 3, rel_min_height = 0.01) +  # 调整参数\n  scale_fill_viridis(name = \"Sepal.Length\", option = \"C\") +  # 调整颜色映射\n  labs(title = 'Sepal.Length in iris') + \n  theme_ipsum() +   # 设置图像主题\n  theme(legend.position = \"bottom\",  \n        panel.spacing = unit(0.1, \"lines\"),\n        strip.text.x = element_text(size = 8))\n\np3_1\n\n\n\n\n\n\n\n图 5: 使用iris数据集绘制可变颜色的山脊线图\n\n\n\n\n\n图 6 描述了OS.time变量在原发肿瘤情况以及存活状态的分布。\n\np3_2 &lt;- ggplot(TCGA_clinic, aes(x = OS.time, y = T, fill = ..x..)) +  # 创建山脊图\n  geom_density_ridges_gradient(scale = 1, rel_min_height = 0.01) +  # 调整参数\n  scale_fill_viridis(name = \"OS.time\", option = \"C\") +  # 调整颜色映射\n  labs(title = 'Distribution of OS.time in different tumor staging') + \n  theme_ipsum() +   # 设置图像主题\n  theme(legend.position = \"bottom\", panel.spacing = unit(0.1, \"lines\"),\n        strip.text.x = element_text(size = 8))\n\np3_2\n\n\n\n\n\n\n\n图 6: 使用Lung Cancer (Raponi 2006)数据集绘制可变颜色的脊线图\n\n\n\n\n\n\n\n\n\n\n\n提示\n\n\n\n关键函数: scale_fill_viridis() / theme_ipsum()\nscale_fill_viridis()\nscale_fill_viridis()是viridis包中的一个函数，它为连续数据提供了色彩映射方案。\n常用参数包括：\n\nbegin and end: 控制颜色映射的起始和结束位置，值在 0 到 1 之间。\ndirection: 控制颜色的方向。\n\n1 表示从低值到高值颜色逐渐变深。\n-1 则相反。\n\noption: 选择viridis包中预设的颜色方案，如 “magma”、“inferno”、“plasma” 等。\naesthetics: 指定是用于填充 (fill) 还是用于轮廓 (colour)。\n\ntheme_ipsum()\ntheme_ipsum()是hrbrthemes包中的一个函数，它提供了一个预定义的 ggplot2 主题\n以下是一些 hrbrthemes 包中的主题：\n\ntheme_ipsum(): 这是hrbrthemes包的核心主题，使用 Arial Narrow 字体，强调了良好的排版和易读性。\ntheme_ft_rc(): 这个主题提供了一种精确且纯净的外观，同样注重排版。\ntheme_ipsum_rc(): 这是theme_ipsum()的变体，可能包含一些不同的排版或颜色选择。\ntheme_ipsum_tw(): 这个主题是为 Twitter 的品牌设计的，使用 Twitter 的颜色和字体风格。\ntheme_ipsum_ps(): 这个主题可能包含了为印刷设计优化的特定排版和颜色。\ntheme_modern_rc(): 这个主题提供了一个现代且简洁的外观，适合当代的数据可视化需求。",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Ridgeline Plot"
    ]
  },
  {
    "objectID": "Distribution/Ridgeline.html#应用场景",
    "href": "Distribution/Ridgeline.html#应用场景",
    "title": "山脊线图",
    "section": "应用场景",
    "text": "应用场景\n\n1. 山脊图分组比较\n\n\n\n\n\n\n图 7: 山脊图分组比较应用\n\n\n\n山脊图被用来展示不同实验条件下的细胞因子表达情况，以及不同细胞群的基因表达分布。 [1]\n\n\n2. 用山脊图展示基因集富集分析的结果\n\n\n\n\n\n\n图 8: 用山脊图展示基因集富集分析的结果应用\n\n\n\n使用山脊图来展示基因集富集分析的结果，揭示了与Moyamoya疾病相关的生物标志物，这是其中一幅山脊图。 [2]",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Ridgeline Plot"
    ]
  },
  {
    "objectID": "Distribution/Ridgeline.html#参考文献",
    "href": "Distribution/Ridgeline.html#参考文献",
    "title": "山脊线图",
    "section": "参考文献",
    "text": "参考文献\n\nKrämer B, Nalin AP, Ma F, Eickhoff S, Lutz P, Leonardelli S, Goeser F, Finnemann C, Hack G, Raabe J, ToVinh M, Ahmad S, Hoffmeister C, Kaiser KM, Manekeller S, Branchi V, Bald T, Hölzel M, Hüneburg R, Nischalke HD, Semaan A, Langhans B, Kaczmarek DJ, Benner B, Lordo MR, Kowalski J, Gerhardt A, Timm J, Toma M, Mohr R, Türler A, Charpentier A, van Bremen T, Feldmann G, Sattler A, Kotsch K, Abdallah AT, Strassburg CP, Spengler U, Carson WE 3rd, Mundy-Bosse BL, Pellegrini M, O’Sullivan TE, Freud AG, Nattermann J. Single-cell RNA sequencing identifies a population of human liver-type ILC1s. Cell Rep. 2023 Jan 31;42(1):111937. doi: 10.1016/j.celrep.2022.111937. Epub 2023 Jan 1. PMID: 36640314; PMCID: PMC9950534.\nXu Y, Chen B, Guo Z, Chen C, Wang C, Zhou H, Zhang C, Feng Y. Identification of diagnostic markers for moyamoya disease by combining bulk RNA-sequencing analysis and machine learning. Sci Rep. 2024 Mar 11;14(1):5931. doi: 10.1038/s41598-024-56367-w. PMID: 38467737; PMCID: PMC10928210.\nWickham, H. (2009). ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York. ISBN 978-0-387-98140-6 (Print) 978-0-387-98141-3 (E-Book). [DOI: 10.1007/978-0-387-98141-3] (https://doi.org/10.1007/978-0-387-98141-3)\nScherer, C. (2019). ggridges: Ridgeline plots in ‘ggplot2’. Journal of Statistical Software, 88(1), 1-19. [DOI: 10.18637/jss.v088.i01] (https://doi.org/10.18637/jss.v088.i01)\nGarnier, S., Team, R. C., & Team, R. S. (2018). viridis: Default color maps for R. R package version 0.5.1. https://CRAN.R-project.org/package=viridis\nFournet, H. (2016). hrbrthemes: Additional themes, scales, and geoms for ‘ggplot2’. R package version 1.7.6. https://CRAN.R-project.org/package=hrbrthemes",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Ridgeline Plot"
    ]
  },
  {
    "objectID": "Distribution/Density.html",
    "href": "Distribution/Density.html",
    "title": "密度图",
    "section": "",
    "text": "密度图表示数值变量的分布，是使用核密度估计来显示变量的概率密度函数。密度图是直方图的平滑版本，使用相同的概念，比直方图更好地展示数据的总体趋势和形状。",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Density Plot"
    ]
  },
  {
    "objectID": "Distribution/Density.html#示例",
    "href": "Distribution/Density.html#示例",
    "title": "密度图",
    "section": "示例",
    "text": "示例\n\n\n\n\n\n这个密度图展示了TSPAN6基因在多个样本中的表达水平分布情况。密度图X轴表示数据的具体值，也就是数据点的取值范围。在此图中，X轴表示基因的表达水平（如8到15）。密度图Y轴表示密度（Density），不是绝对的样本数量。密度图的Y轴可以理解为某个区间内数据值的“相对频率”。其计算方式是将直方图中每个条形的频率进行平滑处理，以形成一条连续的曲线。密度图的总面积为1，这表示数据在整个X轴范围内的相对概率分布。简单来说，它衡量了某个取值区间内的样本数量相对于总样本量的比例。\n密度图与直方图不同的是，密度图在Y轴上使用密度值而不是绝对频数，从而更平滑地展示数据的分布情况。这种方式可以更清晰地看出数据的集中趋势和整体分布特征。\n该图基因的表达量主要集中在10到13之间，且峰值在大约12附近，表示TSPAN6基因在大多数样本中表达量都相对一致，表达量在12附近的样本数量最多。密度图呈现单峰分布，说明大多数样本中TSPAN6基因的表达模式较为稳定。",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Density Plot"
    ]
  },
  {
    "objectID": "Distribution/Density.html#环境配置",
    "href": "Distribution/Density.html#环境配置",
    "title": "密度图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：readr; ggplot2, ggExtra, hrbrthemes, dplyr, tidyr, viridis, ggpmisc, ggpubr, geomtextpath, cowplot\n\n\n# 安装包\nif (!requireNamespace(\"readr\", quietly = TRUE)) {   \n  install.packages(\"readr\") \n} \nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {   \n  install.packages(\"ggplot2\") \n} \nif (!requireNamespace(\"ggExtra\", quietly = TRUE)) {   \n  install.packages(\"ggExtra\") \n} \nif (!requireNamespace(\"hrbrthemes\", quietly = TRUE)) {\n  install.packages(\"hrbrthemes\") \n} \nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\") \n} \nif (!requireNamespace(\"tidyr\", quietly = TRUE)) {\n  install.packages(\"tidyr\") \n} \nif (!requireNamespace(\"viridis\", quietly = TRUE)) {\n  install.packages(\"viridis\") \n} \nif (!requireNamespace(\"ggpmisc\", quietly = TRUE)) {\n  install.packages(\"ggpmisc\") \n} \nif (!requireNamespace(\"ggpubr\", quietly = TRUE)) {\n  install.packages(\"ggpubr\") \n} \nif (!requireNamespace(\"geomtextpath\", quietly = TRUE)) {\n  install.packages(\"geomtextpath\") \n}  \nif (!requireNamespace(\"cowplot\", quietly = TRUE)) {\n  install.packages(\"cowplot\")\n}\n\n# 加载包\nlibrary(readr)         # 对于读取文件\nlibrary(ggplot2)       # 用于创建图\nlibrary(ggExtra)       # 用于增强 ggplot2 图形\nlibrary(hrbrthemes)    # 对于专业主题 \nlibrary(dplyr)         # 用于数据操作\nlibrary(tidyr)         # 用于重塑数据\nlibrary(viridis)       # 对于颜色映射\nlibrary(ggpmisc)       # 用于统计注释\nlibrary(ggpubr)        # 适用于可发布主题\nlibrary(geomtextpath)  # 用于向密度曲线添加文本\nlibrary(cowplot)       # 绘图对齐和注释包\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package      * version date (UTC) lib source\n cowplot      * 1.2.0   2025-07-07 [1] RSPM\n dplyr        * 1.1.4   2023-11-17 [1] RSPM\n geomtextpath * 0.2.0   2025-07-21 [1] RSPM\n ggExtra      * 0.11.0  2025-09-01 [1] RSPM\n ggplot2      * 4.0.1   2025-11-14 [1] RSPM\n ggpmisc      * 0.6.3   2025-11-29 [1] RSPM\n ggpp         * 0.5.9   2025-06-28 [1] RSPM\n ggpubr       * 0.6.2   2025-10-17 [1] RSPM\n hrbrthemes   * 0.9.2   2025-11-02 [1] Github (hrbrmstr/hrbrthemes@d3fd029)\n readr        * 2.1.6   2025-11-14 [1] RSPM\n tidyr        * 1.3.2   2025-12-19 [1] RSPM\n viridis      * 0.6.5   2024-01-29 [1] RSPM\n viridisLite  * 0.4.2   2023-05-02 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Density Plot"
    ]
  },
  {
    "objectID": "Distribution/Density.html#数据准备",
    "href": "Distribution/Density.html#数据准备",
    "title": "密度图",
    "section": "数据准备",
    "text": "数据准备\n以下是使用R内置数据集（iris, mtcars, diamonds）以及来自 UCSC Xena DATASETS 的TCGA-LIHC.htseq_counts.tsv数据集的简短教程。此示例演示了如何在R中加载和使用这些数据集。\n\n# 读取TSV数据\ndata &lt;- readr::read_csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/TCGA-LIHC.htseq_counts.csv.gz\")\n\n# 过滤并重塑第一个基因 TSPAN6 的数据（Ensembl ID：ENSG00000000003.13）\ndata1 &lt;- data %&gt;%   \n  filter(Ensembl_ID == \"ENSG00000000003.13\") %&gt;%   \n  pivot_longer(     \n    cols = -Ensembl_ID,      \n    names_to = \"sample\",      \n    values_to = \"expression\"   \n    ) %&gt;%   \n  mutate(var = \"var1\")  # 添加一列来区分变量\n\n# 过滤并重塑第二个基因 SCYL3 的数据（Ensembl ID：ENSG00000000457.12）\ndata2 &lt;- data %&gt;%   \n  filter(Ensembl_ID == \"ENSG00000000457.12\") %&gt;%   \n  pivot_longer(     \n    cols = -Ensembl_ID,      \n    names_to = \"sample\",      \n    values_to = \"expression\"   \n    ) %&gt;%   \n  mutate(var = \"var2\")  # 添加一列来区分变量\n\n# 合并两个数据集\ndata12 &lt;- bind_rows(data1, data2)  \n\n# 查看最终的组合数据集\nhead(data12)\n\n# A tibble: 6 × 4\n  Ensembl_ID         sample           expression var  \n  &lt;chr&gt;              &lt;chr&gt;                 &lt;dbl&gt; &lt;chr&gt;\n1 ENSG00000000003.13 TCGA-DD-A4NG-01A      12.8  var1 \n2 ENSG00000000003.13 TCGA-G3-AAV4-01A       9.72 var1 \n3 ENSG00000000003.13 TCGA-2Y-A9H1-01A      11.3  var1 \n4 ENSG00000000003.13 TCGA-CC-A3M9-01A      11.6  var1 \n5 ENSG00000000003.13 TCGA-K7-AAU7-01A      11.5  var1 \n6 ENSG00000000003.13 TCGA-BC-A10W-01A      12.0  var1",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Density Plot"
    ]
  },
  {
    "objectID": "Distribution/Density.html#可视化",
    "href": "Distribution/Density.html#可视化",
    "title": "密度图",
    "section": "可视化",
    "text": "可视化\n\n1. 基础密度图\nggplot2包中可以借助geom_density构建密度图，只需要一个数值变量作为输入。\n\n# 基础密度图\np1 &lt;- ggplot(data1, aes(x = expression)) +   \n  geom_density(fill = \"#69b3a2\", color = \"#e9ecef\", alpha = 0.8) +   \n  labs(title = \"Density Plot of TSPAN6 Expression Levels\",        \n       x = \"Expression\",        \n       y = \"Density\") +   \n  theme_minimal()  \np1\n\n\n\n\n\n\n\n图 1: 基础密度图\n\n\n\n\n\n图 1 展示了TCGA来源的LIHC患者中TSPAN6基因在多个样本中的表达水平分布情况。\n\n\n\n\n\n\n提示\n\n\n\ntheme_ipsum 您可以使用hrbrthemes软件包中的theme_ipsum：它易于使用，并能让您的图表看起来更专业。如您所见，theme_ipsum()附带一组预配置设置，例如字体大小、颜色和网格线，这些设置遵循良好的可视化实践，设计精良，可直接发布。\n\nggplot(data1, aes(x = expression)) +\n  geom_density(fill = \"#69b3a2\", color = \"#e9ecef\", alpha = 0.8) +\n  labs(title = \"Density Plot of TSPAN6 Expression Levels\",\n       x = \"Expression\",\n       y = \"Density\") +\n  theme_ipsum()\n\n\n\n\n\n\n\n图 2: Themed Density Plot\n\n\n\n\n\n\n\n\n\n2. 镜像密度图\n镜像密度图帮助我们非常直观地对比两个数据集的分布。通过镜像结构，可以快速判断两个数据集是否存在对称性或差异。镜像密度图将两个密度图整合在一张图上，减少了所需的可视化空间，同时保持了对数据分布的清晰描述。\n\n# 绘制镜像密度图\nggplot(data12, aes(x = expression, fill = var)) +\n\n  # 绘制上半部分的密度曲线\n  geom_density(data = filter(data12, var == \"var1\"), aes(y = ..density..), fill = \"#69b3a2\", alpha = 0.8) +\n  geom_label(data = filter(data12, var == \"var1\"), aes(x = median(expression), y = 0.25, label = \"TSPAN6\"), color = \"white\", fill = \"#1b9e77\") +\n  \n  # 绘制下半部分的密度曲线\n  geom_density(data = filter(data12, var == \"var2\"), aes(y = -..density..), fill = \"#404080\", alpha = 0.8) +\n  geom_label(data = filter(data12, var == \"var2\"), aes(x = median(expression), y = -0.25, label = \"C1QA\"), color = \"white\", fill = \"#7570b3\") +  \n\n  # 图形美化\n  xlab(\"Expression\") +\n  ylab(\"Density\") +\n  ggtitle(\"Mirror Density Plot of TSPAN6 and C1QA\") +\n  theme(legend.position = \"none\") +\n  theme_minimal()\n\n\n\n\n\n\n\n图 3: 镜像密度图\n\n\n\n\n\n图 3 展示了TCGA来源的LIHC患者中TSPAN6和C1QA基因的表达量分布。也可以用同样的方法获得镜像直方图。\n\n\n3. 多个组的密度图\n多个组密度图的能够直观地比较不同组的分布差异，帮助识别趋势、模式和异常值，同时在同一图表中呈现多个组的数据，有助于快速对比组间特征。但是当组别较多或分布曲线重叠时，图形容易显得混乱，难以辨识各组的差异，导致图表的可读性下降。可以通过调整透明度来减少重叠区域的视觉干扰。不过，这种方法只能在一定程度上改善可视化效果，并非万能的解决方案，可以采用此文档后续的其他绘图方法来解决（例如分面密度图）。\n\n# 不设置透明度（左）\np1 &lt;- ggplot(data=diamonds, aes(x=price, group=cut, fill=cut)) +\n  geom_density(adjust=1.5) +\n  theme_minimal() +\n  ggtitle(\"p1\")\n\n# 设置透明度（右）\np2 &lt;- ggplot(data=diamonds, aes(x=price, group=cut, fill=cut)) +\n  geom_density(adjust=1.5, alpha=.4) +\n  theme_minimal() +\n  ggtitle(\"p2\")\n\nplot_grid(p1, p2, ncol = 2)\n\n\n\n\n\n\n\n图 4: 多个组的密度图使用 Diamonds 数据集\n\n\n\n\n\n图 4 对比了不同透明度设置下的diamonds数据集价格分布的密度图。左侧图（p1）未设置透明度，所有分组的填充颜色不透明，图形整体较为拥挤，且分组间重叠较多，难以辨认信息；右侧图（p2）设置了透明度，使得不同分组的颜色层叠效果更为明显，从而能够更清楚地观察每个组别的密度分布特征。\n\n# 创建注释框架\nannot &lt;- data.frame(\n  Species = c(\"setosa\", \"versicolor\", \"virginica\"),\n  x = c(1.8, 4, 5.1),  # 每个物种的注释位置\n  y = c(0.5, 0.9, .8)\n)\n\n# 生成密度图\nggplot(filter(iris, Species %in% c(\"setosa\", \"versicolor\", \"virginica\")), aes(x = Petal.Length, color = Species, fill = Species)) +\n  geom_density(alpha = 0.6) +\n  scale_fill_viridis(discrete = TRUE) +\n  scale_color_viridis(discrete = TRUE) +\n  geom_text(data = annot, aes(x = x, y = y, label = Species, color = Species), hjust = 0, size = 4.5) +\n  theme_minimal() +\n  theme(\n    legend.position = \"none\"\n  ) +\n  ylab(\"\") +\n  xlab(\"Petal Length (cm)\")\n\n\n\n\n\n\n\n图 5: 多个组的密度图使用 Iris 数据集\n\n\n\n\n\n图 5 展示了Iris数据集中不同物种的花瓣长度（Petal.Length）分布密度，可以直观地看出每个物种在花瓣长度上的分布差异。\n\n\n4. 分面密度图\n多个变量的分面密度图通过在不同的面板中展示不同组的数据，可以更直观地比较各组之间的分布差异，减少了视觉上的杂乱。如果所有面板都共享相同的X轴，则仍可以比较各组的分布特征，例如中心位置、散布程度和形状。多个变量的分面密度图使用facet_wrap()实现。\n\nggplot(data=diamonds, aes(x=price, group=cut, fill=cut)) +\n  geom_density(adjust=1.5) +\n  theme_ipsum() +\n  facet_wrap(~cut) + \n  theme(\n    legend.position=\"none\",\n    panel.spacing = unit(0.1, \"lines\"),\n    axis.ticks.x=element_blank()\n  )\n\n\n\n\n\n\n\n图 6: 分面密度图\n\n\n\n\n\n图 6 展示了diamonds数据集中不同切工等级的价格分布情况。每个切工组别的密度曲线单独分面显示，便于在相同坐标系下观察不同切工等级的价格分布形态。\n\n\n5. 堆积密度图\n堆积密度图中各组的密度分布被堆积起来，不会出现曲线重叠导致的混乱。但各组被堆叠在一起，很难理解不在图表底部的组的分布。（更推荐使用分面密度图）。\n\np &lt;- ggplot(data=diamonds, aes(x=price, group=cut, fill=cut)) +\n  geom_density(adjust=1.5, position=\"fill\") +\n  theme_ipsum()\np\n\n\n\n\n\n\n\n图 7: 堆积密度图\n\n\n\n\n\n图 7 展示了diamonds数据中不同切工等级的价格相对分布。使用堆积密度图（position=\"fill\"）使得所有组别在每个价格位置的累积密度总和为1，便于对比不同切工组别的相对密度分布。\n\n\n6. 边际分布（密度图）\n边际分布提供了关于数据的额外信息，不仅展示了变量之间的关系，还揭示了每个变量的独立分布特征。将边际密度图与散点图（或其他主图）结合的综合视角使得发现数据中的模式、异常值和趋势更加容易。使用ggExtra包中的ggMarginal()绘制边际分布（密度图）。\n\np &lt;- ggplot(mtcars, aes(x = wt, y = mpg, color = factor(cyl), size = factor(cyl))) +\n  geom_point(aes(color = factor(cyl)), show.legend = TRUE) +  # 散点图根据 cyl 变化大小\n  geom_smooth(method = 'lm', formula = y ~ x, se = TRUE, linewidth = 1, aes(color = factor(cyl))) +  # 回归曲线颜色和宽度\n  scale_color_manual(values = c(\"#2e3b97\", \"#faad61\", \"#b76252\")) +  # 指定回归曲线颜色\n  stat_poly_eq(aes(label = paste(after_stat(eq.label), after_stat(rr.label), after_stat(p.value.label), sep = \"~~~~\")), \n               formula = y ~ x, size = 4,\n               hjust = -1,   # 调整水平对齐\n               vjust = 1.1,   # 调整垂直对齐\n               position = position_nudge(x = 2.7, y = 1)) + \n  theme(legend.position = \"none\")  # 不显示图例\n\n# 边际密度图\np1 &lt;- ggMarginal(p, type=\"density\")  \n\np1\n\n\n\n\n\n\n\n图 8: 边际分布密度图\n\n\n\n\n\n散点图展示了 mtcars数据集中不同气缸数量（cyl）的汽车在重量（wt）和每加仑里程数（mpg）之间的关系。该边际密度图显示了不同气缸数量（cyl）的汽车在wt（重量）和mpg（每加仑里程数）上的分布模式，从而揭示了wt或mpg在不同气缸组之间的差异性。\n\n\n\n\n\n\n提示\n\n\n\n边际分布密度图可修改的参数\n\n使用size参数来更改边际图的大小。\n使用常用参数自定义边际图的外观。\n使用 margins = 'x' 或 margins = 'y' 仅显示一个边际图（x 轴或 y 轴）。\n\n\np &lt;- ggplot(mtcars, aes(x = wt, y = mpg, color = factor(cyl), size = factor(cyl))) +\n  geom_point(aes(color = factor(cyl)), show.legend = TRUE) +  # 散点图根据 cyl 变化大小\n  geom_smooth(method = 'lm', formula = y ~ x, se = TRUE, linewidth = 1, aes(color = factor(cyl))) +  # 回归曲线颜色和宽度\n  scale_color_manual(values = c(\"#2e3b97\", \"#faad61\", \"#b76252\")) +  # 指定回归曲线颜色\n  stat_poly_eq(aes(label = paste(after_stat(eq.label), after_stat(rr.label), after_stat(p.value.label), sep = \"~~~~\")),\n               formula = y ~ x, size = 4,\n               hjust = -1.45,   # 调整水平对齐，修改了水平对齐的值\n               vjust = 1.1,   # 调整垂直对齐\n               position = position_nudge(x = 2.7, y = 1)) + \n  theme(legend.position = \"none\")  # 不显示图例\n\n# 边际密度图\np2 &lt;- ggMarginal(p, type=\"density\", margins = 'x', color=\"purple\", size = 4)  # 仅显示 x 轴边际密度图\n\np2\n\n\n\n\n\n\n\n图 9: 自定义参数用于绘制边际分布密度图\n\n\n\n\n\n与前图类似，此图同样展示了mtcars数据集中不同气缸数量（cyl）的汽车在重量（wt）和每加仑里程数（mpg）之间的关系。该边际密度图显示了不同气缸数量（cyl）的汽车在mpg（每加仑里程数）上的分布模式。\n\n\n\n\n7. 带标注的密度图\n带标注的密度图能够在图中直接显示关键信息或组名，便于快速理解各组数据的分布和差异，无需借助图例，从而提升图表的可读性和信息传达效率。使用ggplot2和geomtextpath包在密度图的线上添加文本或标签。\n\nggplot(iris, aes(x = Sepal.Length, colour = Species, label = Species)) +\n  geom_textdensity() +\n  theme_bw() + guides(color = 'none')\n\n\n\n\n\n\n\n图 10: 带标注的密度图\n\n\n\n\n\n图 10 使用文本密度曲线表示iris数据集中不同物种的Sepal.Length分布。文本布局会根据分布密度动态调整，从而更容易直观地观察不同物种Sepal.Length的分布。\n\n\n\n\n\n\n提示\n\n\n\n可以更改geom_textdensity()的参数来改变标签的属性\n\nsize：文本的大小。\nfontface：字体样式。\nvjust：垂直调整。\nhjust：水平调整。 最后两个参数可以是浮点数（通常在-1和1之间），也可以是字符串，例如xmid(或ymid)、xmax(或ymax)和auto(默认)。\n\n\n\n\nmtcars$labels = ifelse(mtcars$vs==0, \"Type 0\", \"Type 1\")\nggplot(mtcars, aes(x = qsec, colour = as.factor(labels), label = as.factor(labels))) +\n  geom_textdensity(size = 6, fontface = 4, # 加粗斜体\n                   vjust = -0.4, hjust = \"ymid\") +\n  theme_bw() + guides(color = 'none')  # 移除颜色图例\n\n\n\n\n\n\n\n图 11: 自定义参数用于带标注的密度图\n\n\n\n\n\n图 11 展示了mtcars数据集中qsec（1/4英里加速时间）与vs（发动机类型）的文本密度分布。通过更改文本密度属性使得标签更加醒目易读。",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Density Plot"
    ]
  },
  {
    "objectID": "Distribution/Density.html#应用场景",
    "href": "Distribution/Density.html#应用场景",
    "title": "密度图",
    "section": "应用场景",
    "text": "应用场景\n\n1. 基础密度图\n\n\n\n\n\n\nMende, D. R. et al.(2016)\n\n\n\n\n图 12: 基础密度图应用\n\n\n\n图 12: 本文使用的宏基因组学和单细胞数据集中组装的iSAGs的覆盖率总结。（A）宏基因组读数的片段募集图映射到本研究中构建的iSAG上。每个图底部的橙色和绿色交替条形显示重叠群边界，这些边界按从最长到最短的顺序排序。（B）密度图显示了映射到此处构建的iSAG上的原始SAG读数的相对覆盖率。[1]\n\n\n2. 多个组的密度图\n\n\n\n\n\n\nGrimmer, M. R. et al.(2014)\n\n\n\n\n图 13: 多个组的密度图应用\n\n\n\n图 13: 激活与抑制启动子的分析。（A）在结合启动子处主要598-SKD结合基序（如上图所示，代表部分设计靶标基序）频率的标签密度图。彩色曲线对应于活性不变、下调或上调的基因上的 598-SKD 结合启动子。（B）跨表达组598-SKD靶启动子处598-SKD和598个ChIP-seq标签的标签密度图;绘图颜色对应于（A）中的颜色。（C）598-SKD跨启动子和基因体的标签密度图;绘图颜色对应于（A）中的颜色。[2]\n\n\n3. 分面密度图\n\n\n\n\n\n\nReck, M. et al.(2015)\n\n\n\n\n图 14: 分面密度图应用\n\n\n\n图 14 在LytFsm报告基因菌株背景中对comE、comR、comS和comRS进行过表达分析。[3]",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Density Plot"
    ]
  },
  {
    "objectID": "Distribution/Density.html#参考文献",
    "href": "Distribution/Density.html#参考文献",
    "title": "密度图",
    "section": "参考文献",
    "text": "参考文献\n\nMende, D. R., Aylward, F. O., Eppley, J. M., Nielsen, T. N., & DeLong, E. F. (2016). Improved Environmental Genomes via Integration of Metagenomic and Single-Cell Assemblies. Frontiers in Microbiology, 7, 143. https://doi.org/10.3389/fmicb.2016.00143. PMID: 26904016; PMCID: PMC4749706.\n\nGrimmer, M. R., Stolzenburg, S., Ford, E., Lister, R., Blancafort, P., & Farnham, P. J. (2014). Analysis of an artificial zinc finger epigenetic modulator: widespread binding but limited regulation. Nucleic Acids Research, 42(16), 10856–10868. https://doi.org/10.1093/nar/gku708. PMID: 25122745; PMCID: PMC4176344.\nReck, M., Tomasch, J., & Wagner-Döbler, I. (2015). The Alternative Sigma Factor SigX Controls Bacteriocin Synthesis and Competence, the Two Quorum Sensing Regulated Traits in Streptococcus mutans. PLoS Genetics, 11(7), e1005353. https://doi.org/10.1371/journal.pgen.1005353. PMID: 26158727; PMCID: PMC4497675.\n\nWickham, H. (2016). ggplot2: Elegant graphics for data analysis. Springer. https://ggplot2.tidyverse.org\n\nGao, Y. (2021). ggExtra: Add marginal plots to ggplot2. https://cran.r-project.org/package/ggExtra\n\nRudis, B. (2020). hrbrthemes: Additional Themes and Theme Components for ‘ggplot2’. https://cran.r-project.org/package/hrbrthemes\n\nWickham, H., François, R., Henry, L., & Müller, K. (2021). dplyr: A Grammar of Data Manipulation. https://cran.r-project.org/package/dplyr\nWickham, H., & Henry, L. (2021). tidyr: Tidy Messy Data. https://cran.r-project.org/package/tidyr\n\nGarnier, S. (2018). viridis: Default Color Maps from ‘matplotlib’. https://cran.r-project.org/package/viridis\n\nAubry, R., & Bouchard, C. (2020). ggpmisc: Miscellaneous Extensions to ‘ggplot2’. https://cran.r-project.org/package/ggpmisc\n\nKassambara, A. (2021). ggpubr: ‘ggplot2’ Based Publication Ready Plots. https://cran.r-project.org/package/ggpubr\n\nBrown, C. (2022). geomtextpath: Curved Text on Geoms in ‘ggplot2’. https://cran.r-project.org/package/geomtextpath\nWilke, C. O. (2020). cowplot: Streamlined Plot Theme and Plot Annotations for “ggplot2”. https://cran.r-project.org/package=cowplot",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Density Plot"
    ]
  },
  {
    "objectID": "Distribution/Beeswarm.html",
    "href": "Distribution/Beeswarm.html",
    "title": "蜂群图",
    "section": "",
    "text": "蜂群图是一种数据可视化图表，它通过轻微地分散数据点来避免重叠，从而更清晰地展示数据的分布密度和趋势。这种图表特别适合用于展示较小数据集的分类数据分布。在本节中，我们将介绍使用R以及beeswarm和ggbeeswarm包实现的各种示例。",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Beeswarm Plot"
    ]
  },
  {
    "objectID": "Distribution/Beeswarm.html#示例",
    "href": "Distribution/Beeswarm.html#示例",
    "title": "蜂群图",
    "section": "示例",
    "text": "示例",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Beeswarm Plot"
    ]
  },
  {
    "objectID": "Distribution/Beeswarm.html#环境配置",
    "href": "Distribution/Beeswarm.html#环境配置",
    "title": "蜂群图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：readr, beeswarm, ggbeeswarm, ggsignif, plyr ,tidyverse\n\n\n# 安装包\nif (!requireNamespace(\"readr\", quietly = TRUE)) {\n  install.packages(\"readr\")\n}\nif (!requireNamespace(\"beeswarm\", quietly = TRUE)) {\n  install.packages(\"beeswarm\")\n}\nif (!requireNamespace(\"ggbeeswarm\", quietly = TRUE)) {\n  install.packages(\"ggbeeswarm\")\n}\nif (!requireNamespace(\"ggsignif\", quietly = TRUE)) {\n  install.packages(\"ggsignif\")\n}\nif (!requireNamespace(\"plyr\", quietly = TRUE)) {\n  install.packages(\"plyr\")\n}\nif (!requireNamespace(\"tidyverse\", quietly = TRUE)) {\n  install.packages(\"tidyverse\")\n}\n\n\n# 加载包\nlibrary(readr)\nlibrary(beeswarm) # 这个简单易用的包只需一两行代码就可以在 R 中构建蜂群图。\nlibrary(ggbeeswarm) # 该包是ggplot2的扩展，允许直接从ggplot2包构建蜜蜂群图，具有更多可调选项和更大的灵活性，便于进行统计差异分析。\nlibrary(ggsignif)\nlibrary(plyr)\nlibrary(tidyverse)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n beeswarm   * 0.4.0   2021-06-01 [1] RSPM\n dplyr      * 1.1.4   2023-11-17 [1] RSPM\n forcats    * 1.0.1   2025-09-25 [1] RSPM\n ggbeeswarm * 0.7.3   2025-11-29 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n ggsignif   * 0.6.4   2022-10-13 [1] RSPM\n lubridate  * 1.9.4   2024-12-08 [1] RSPM\n plyr       * 1.8.9   2023-10-02 [1] RSPM\n purrr      * 1.2.0   2025-11-04 [1] RSPM\n readr      * 2.1.6   2025-11-14 [1] RSPM\n stringr    * 1.6.0   2025-11-04 [1] RSPM\n tibble     * 3.3.0   2025-06-08 [1] RSPM\n tidyr      * 1.3.2   2025-12-19 [1] RSPM\n tidyverse  * 2.0.0   2023-02-22 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Beeswarm Plot"
    ]
  },
  {
    "objectID": "Distribution/Beeswarm.html#数据准备",
    "href": "Distribution/Beeswarm.html#数据准备",
    "title": "蜂群图",
    "section": "数据准备",
    "text": "数据准备\n我们使用了内置的 R 数据集（iris），以及来自 UCSC Xena DATASETS 的TCGA.LIHC.clinicalMatrix和TCGA-LIHC.star_fpkm数据集。部分基因仅供演示之用。\n\n# 加载 iris 数据集\ndata(\"iris\")\n\n# 从处理过的 CSV 文件加载 TCGA-LIHC 基因表达数据集\nTCGA_gene_expression &lt;- read.csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/TCGA-LIHC.star_fpkm_processed.csv\")\n\n# 加载 TCGA-LIHC 临床信息数据集\nTCGA_clinic &lt;- read.csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/TCGA.LIHC.clinicalMatrix.csv\") %&gt;%\n  mutate(T = as.factor(T))\n\n# 准备统计数据\ndata_summary &lt;- function(data, varname, groupnames) {\n  summary_func &lt;- function(x, col) {\n    c(mean = mean(x[[col]], na.rm = TRUE),\n      sd = sd(x[[col]], na.rm = TRUE))\n  }\n  data_sum &lt;- ddply(data, groupnames, .fun = summary_func, varname)\n  \n  data_sum &lt;- rename_with(data_sum, ~ varname, \"mean\")\n  \n  return(data_sum)\n}\niris_sum &lt;- data_summary(iris, varname=\"Sepal.Length\", groupnames=\"Species\")\nTCGA_gene_sum &lt;- data_summary(TCGA_gene_expression, varname=\"gene_expression\", groupnames=\"sample\")",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Beeswarm Plot"
    ]
  },
  {
    "objectID": "Distribution/Beeswarm.html#可视化",
    "href": "Distribution/Beeswarm.html#可视化",
    "title": "蜂群图",
    "section": "可视化",
    "text": "可视化\n\n1. 基础蜂群图（beeswarm包）\n图 1 描述了Sepal.Length变量在iris上的分布。\n\np1 &lt;- beeswarm(iris$Sepal.Length)\n\n\n\n\n\n\n\n图 1: 基础蜂群图\n\n\n\n\n\n图 2 描述了 LIHC 数据集里面 RAB4B 基因的表达量。\n\nTCGA_gene_expression_RAB4B &lt;- subset(TCGA_gene_expression, sample == \"RAB4B\")\np1_2 &lt;- beeswarm(TCGA_gene_expression_RAB4B$gene_expression)\n\n\n\n\n\n\n\n图 2: 基础蜂群图2\n\n\n\n\n\n\n\n2. 蜂群图翻转（beeswarm包）\n图 3 描述了 TCGA 数据集中 OS.time 变量的数量分布。\n\np2 &lt;- beeswarm(TCGA_clinic$OS.time, horizontal=TRUE)\n\n\n\n\n\n\n\n图 3: 蜂群图翻转\n\n\n\n\n\n\n\n3. 蜂群图基本特征改变（beeswarm包）\n\n\n\n\n\n\n提示\n\n\n\n关键参数:\n(1) 改变颜色\n通过改变col参数，我们可以改变点的颜色\n(2) 改变点的符号\npch参数允许更改点的符号。\n(3) 改变点的大小\ncex参数允许更改点的尺寸。\n(4) 改变点的位置\nmethod参数允许更改点的位置。以下是可用的选项：\n\nswarm (default): 点随机放置，但不会重叠。\ncenter: 点对称地分布在图表的中心周围。\nhex: 点被放置在六角形网格上。\nsquare: 点位于一个正方形网格上。\n\n\n\n图 4 描述了iris数据集中Sepal.Length变量的分布。\n\np3_1 &lt;- beeswarm(iris$Sepal.Length,col= \"blue\",pch=16,\n         cex=1.5,method=\"center\" )\n\n\n\n\n\n\n\n图 4: 基本特征\n\n\n\n\n\n图 5 描述了 TCGA 数据集中 OS.time 变量的数量分布。\n\np3_2 &lt;- beeswarm(TCGA_clinic$OS.time,col= \"blue\",pch=16,\n         cex=1.5,method=\"center\" )\n\n\n\n\n\n\n\n图 5: 基本特征\n\n\n\n\n\n\n\n4. 蜂群图分组（beeswarm包）\n运用 ~ 运算符，我们可以轻松创建一个分组蜜蜂图。\n图 6 描述了Sepal.Length变量在不同Species上的分布\n\np4_1 &lt;- beeswarm( Sepal.Length ~ Species, data=iris, \n         col=c(\"orange\", \"lightblue\", \"magenta\"), pch =19)\n\n\n\n\n\n\n\n图 6: 蜂群图分组\n\n\n\n\n\n图 7 描述了OS.time变量的不同肿瘤分期中的分布。\n\np4_2 &lt;- beeswarm(OS.time ~ T, data=TCGA_clinic, \n         col=c(\"orange\", \"lightblue\", \"magenta\"), pch =19)\n\n\n\n\n\n\n\n图 7: 蜂群图分组\n\n\n\n\n\n\n\n5. 自定义位置行为（beeswarm包）\n\n\n\n\n\n\n提示\n\n\n\n当有很多数据点时，改变点的位置行为可以避免组间重叠。\n可用的选项是：\n\nnone (default): 不进行校正。\ngutter: 为每个组设定一个更高和更低的限制。\nwrap: 与gutter类似，但在点的位置添加随机噪声。\nrandom: 随机定位点。\nomit: 省略重叠的点。\n\n\n\n图 8 描述了Sepal.Length变量在不同Species上的分布。\n\np5_1 &lt;- beeswarm( Sepal.Length ~ Species, data=iris,\n         col=c(\"orange\", \"lightblue\", \"magenta\"), pch =19,corral =\"gutter\")\n\n\n\n\n\n\n\n图 8: 自定义位置行为\n\n\n\n\n\n图 9 描述了OS.time变量的不同肿瘤分期中的分布。\n\np5_2 &lt;- beeswarm( OS.time ~ T, data=TCGA_clinic, \n         col=c(\"orange\", \"lightblue\", \"magenta\"), pch =15,corral = \"gutter\")\n\n\n\n\n\n\n\n图 9: 自定义位置行为\n\n\n\n\n\n\n\n6. 基础蜂群图（ggbeeswarm包）\n图 10 描述了 iris 数据集中 Sepal.Length 变量的分布。\n\np6_1 &lt;- ggplot(iris,aes(y=Sepal.Length,x='')) + \n  geom_beeswarm()\np6_1\n\n\n\n\n\n\n\n图 10: 基础蜂群图\n\n\n\n\n\n图 11 描述了 TCGA 数据集中 OS.time 变量的数量分布\n\np6_2 &lt;- ggplot(TCGA_clinic,aes(y=OS.time,x='')) + \n  geom_beeswarm()\np6_2\n\n\n\n\n\n\n\n图 11: 基础蜂群图\n\n\n\n\n\n\n\n7. 蜂群图翻转（ggbeeswarm包）\n图 12 描述了 iris 数据集中 Sepal.Length 变量的分布。\n\np7_1 &lt;- ggplot(iris,aes(x=Sepal.Length,y='')) +\n  geom_beeswarm()\np7_1\n\n\n\n\n\n\n\n图 12: 蜂群图翻转\n\n\n\n\n\n图 13 描述了 TCGA 数据集中 OS.time 变量的数量分布。\n\np7_2 &lt;- ggplot(TCGA_clinic,aes(x=OS.time,y='')) + \n  geom_beeswarm()\np7_2\n\n\n\n\n\n\n\n图 13: 蜂群图翻转\n\n\n\n\n\n\n\n8. 自定义蜂群图（ggbeeswarm包）\n\n\n\n\n\n\n提示\n\n\n\n关键参数:\n我们可以使用theme()函数改变点的颜色和整个图形的主题。\n\n\n图 14 描述了 iris 数据集中 Sepal.Length 变量的分布。\n\np8_1 &lt;- ggplot(iris,aes(y=Sepal.Length,x='')) +  \n  geom_beeswarm(color='blue') +    \n  theme_minimal()\np8_1\n\n\n\n\n\n\n\n图 14: 改变基础特征\n\n\n\n\n\n图 15 描述了 TCGA 数据集中 OS.time 变量的数量分布。\n\np8_2 &lt;- ggplot(TCGA_clinic,aes(y=OS.time,x='')) + \n  geom_beeswarm(color='blue') +    \n  theme_minimal()\np8_2\n\n\n\n\n\n\n\n图 15: 改变基础特征\n\n\n\n\n\n\n\n9. 改变蜂群图点的位置（ggbeeswarm包）\n默认情况下，geom_beeswarm()函数将使用swarm方法来定位点。我们可以通过使用method参数来改变这种行为。以下是可用的选项：\n\nswarm: 默认方法。\ncompactswarm: 类似于群集，但点更加紧凑。\ncenter: 点在x轴上居中。\nhex: 点位于六边形中。\nsquare: 点位于正方形中。\n\n图 16 描述了 iris 数据集中 Sepal.Length 变量的分布。\n\np9_1 &lt;- ggplot(iris,aes(y=Sepal.Length,x='')) +\n   geom_beeswarm(method='center')\np9_1\n\n\n\n\n\n\n\n图 16: 改变蜂群图点的位置\n\n\n\n\n\n\n\n10. 自定义蜂群图点的颜色（ggbeeswarm包）\n我们还可以使用scale_color_manual()函数自定义颜色。并且由于theme_minimal()函数，我们可以让图表看起来更加优雅。\n图 17 描述了 Sepal.Length 变量在不同 Species 上的分布。\n\np10_1 &lt;- ggplot(TCGA_clinic,aes(x=T, y=OS.time, colour=T)) +\n  geom_beeswarm() + \n  scale_color_manual(values=c(\"#999999\", \"#E69F00\", \"#56B4E9\",\"blue\")) +  \n  theme_minimal()\np10_1\n\n\n\n\n\n\n\n图 17: 自定义蜂群图点的颜色\n\n\n\n\n\n\n\n11. 分组和添加统计分析（ggbeeswarm包）\n图 18 描述了 iris 数据集中 Sepal.Length 变量的分布。\n\np11_1 &lt;- ggplot()+\n  geom_bar(iris_sum,\n           mapping=aes(x=Species,y=Sepal.Length,fill=Species),\n           stat=\"identity\",width=.6,\n           alpha=0.5,position=position_dodge())+\n  geom_errorbar(iris_sum,\n                mapping=aes(x=Species,y=Sepal.Length,\n                            ymin=Sepal.Length-sd,\n                            ymax=Sepal.Length+sd),\n                width=.4,position=position_dodge(.8))+\n  geom_beeswarm(iris,\n                mapping=aes(x=Species,y=Sepal.Length,fill=Species),\n                shape=21,color='black',size=3.5,cex=1.2,stroke=0.6)+\n  geom_signif(iris,\n              mapping=aes(x=Species,y=Sepal.Length),\n              comparisons=list(c(\"setosa\",\"versicolor\"),c(\"setosa\",\"virginica\")),\n              test=\"t.test\",step_increase=0.2,tip_length=0,textsize=6,size=1,\n              map_signif_level=T)\np11_1\n\n\n\n\n\n\n\n图 18: 分组\n\n\n\n\n\n图 19 描述了肝癌中三个基因的基因表达数据。\n\np11_2 &lt;- ggplot()+\n  geom_bar(TCGA_gene_sum,\n           mapping=aes(x=sample,y=gene_expression,fill=sample),\n           stat=\"identity\",width=.6,alpha=0.5,position=position_dodge())+\n geom_errorbar(TCGA_gene_sum,\n               mapping=aes(x=sample,y=gene_expression,\n                           ymin=gene_expression-sd,ymax=gene_expression+sd),\n                          width=.4,position=position_dodge(.8))+\n geom_beeswarm(TCGA_gene_expression,\n               mapping=aes(x=sample,y=gene_expression,fill=sample),\n               shape=21,color='black',size=3.5,cex=1.2,stroke=0.6)+\n  geom_signif(TCGA_gene_expression,\n              mapping=aes(x=sample,y=gene_expression),\n              comparisons=list(c(\"RAB4B\",\"TIGAR\"),c(\"RAB4B\",\"RNF44\"),c(\"TIGAR\",\"RNF44\")),\n              test=\"t.test\",step_increase=0.2, tip_length=0,textsize=6,\n              size=1,map_signif_level=T)\np11_2\n\n\n\n\n\n\n\n图 19: 分组",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Beeswarm Plot"
    ]
  },
  {
    "objectID": "Distribution/Beeswarm.html#应用场景",
    "href": "Distribution/Beeswarm.html#应用场景",
    "title": "蜂群图",
    "section": "应用场景",
    "text": "应用场景\n\n1. 展示细胞密度\n\n\n\n\n\n\n图 20: 蜂群图应用\n\n\n\n蜂群图显示了高或低FOLR2+细胞密度的肿瘤中CD8+ T细胞的密度。[1]\n\n\n2.用蜂群图展示不同样本间基因表达数据的分布情况\n\n\n\n\n\n\n图 21: 蜂群图应用\n\n\n\n蜂群图展示了不同结构变异（SV）位点的基因表达水平的分布情况。[2]",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Beeswarm Plot"
    ]
  },
  {
    "objectID": "Distribution/Beeswarm.html#参考文献",
    "href": "Distribution/Beeswarm.html#参考文献",
    "title": "蜂群图",
    "section": "参考文献",
    "text": "参考文献\n1.Nalio Ramos R,Missolo-Koussou Y,Gerber-Ferder Y, et al. Tissue-resident FOLR2 + macrophages associate with CD8 + T cell infiltration in human breast cancer. Cell. 2022;185 (7):1189-1207.e25. doi:10.1016/j.cell.2022.02.021\n2.Zhou Y,Zhang Z,Bao Z, et al. Graph pangenome captures missing heritability and empowers tomato breeding. Nature. 2022;606 (7914):527-534. doi:10.1038/s41586-022-04808-9\n3.Wickham, H. (2009). ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York. ISBN 978-0-387-98140-6 (Print) 978-0-387-98141-3 (E-Book). [DOI: 10.1007/978-0-387-98141-3] (https://doi.org/10.1007/978-0-387-98141-3)\n4.Erik Clarke, Scott Sherrill-Mix, Charlotte Dawson (2023). ggbeeswarm: Categorical Scatter (Violin Point) Plots. R package version 0.7.2. https://CRAN.R-project.org/package=ggbeeswarm\n5.Aron Eklund, James Trimble (2021). beeswarm: The Bee Swarm Plot, an Alternative to Stripchart. R package version 0.4.0. https://CRAN.R-project.org/package=beeswarm\n6.Wickham, H. (2017). dplyr: A Grammar of Data Manipulation (Version 0.7.4). Retrieved from https://CRAN.R-project.org/package=dplyr\n7.Huber, W., Carey, V. J., Gentleman, R., Anders, S., & Carlson, M. (2015). Bioconductor: Support for the analysis and comprehension of high-throughput genomic data. R package version 3.2. F1000Research, 4, 1-22. Retrieved from https://www.bioconductor.org/ 54^\n8.The R Graph Gallery – Help and inspiration for R charts (r-graph-gallery.com)",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Beeswarm Plot"
    ]
  },
  {
    "objectID": "Proportion/ChordDiagram.html",
    "href": "Proportion/ChordDiagram.html",
    "title": "和弦图",
    "section": "",
    "text": "和弦图可以用连接线或条带的方式展示不同对象之间的关系。和弦图的连接，可以直接显示不同对象之间存在关系，连接的宽度与关系的强度成正比，连接的颜色可以代表关系的另一种映射，如关系的类型。图中扇形的大小，代表对象的度量。",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Chord Diagram"
    ]
  },
  {
    "objectID": "Proportion/ChordDiagram.html#示例",
    "href": "Proportion/ChordDiagram.html#示例",
    "title": "和弦图",
    "section": "示例",
    "text": "示例\n\n\n\n\n\n此和弦图展示某药服用前后血糖等级的转变。每个弧表示一个血糖等级。弦的宽度表示转变的数量或频率。设置透明度，和弦的颜色半透明，以便更清晰地观察数据流向。",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Chord Diagram"
    ]
  },
  {
    "objectID": "Proportion/ChordDiagram.html#环境配置",
    "href": "Proportion/ChordDiagram.html#环境配置",
    "title": "和弦图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：tidyverse; readr; circlize; readxl; dplyr; igraph; ggraph; tidygraph; chorddiag; viridis\n\n\n# 安装包\n\nif (!requireNamespace(\"tidyverse\", quietly = TRUE)) {\n  install.packages(\"tidyverse\")\n}\nif (!requireNamespace(\"readr\", quietly = TRUE)) {\n  install.packages(\"readr\")\n}\nif (!requireNamespace(\"circlize\", quietly = TRUE)) {\n  install.packages(\"circlize\")\n}\nif (!requireNamespace(\"readxl\", quietly = TRUE)) {\n  install.packages(\"readxl\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"igraph\", quietly = TRUE)) {\n  install.packages(\"igraph\")\n}\nif (!requireNamespace(\"ggraph\", quietly = TRUE)) {\n  install.packages(\"ggraph\")\n}\nif (!requireNamespace(\"tidygraph\", quietly = TRUE)) {\n  install.packages(\"tidygraph\")\n}\nif (!requireNamespace(\"tidygraph\", quietly = TRUE)) {\n  remotes::install_github(\"mattflor/chorddiag\")\n}\nif (!requireNamespace(\"viridis\", quietly = TRUE)) {\n  install.packages(\"viridis\")\n}\n\n# 加载包\nlibrary(tidyverse)\nlibrary(readr)\nlibrary(circlize)\nlibrary(readxl)\nlibrary(dplyr)\nlibrary(igraph)\nlibrary(ggraph)\nlibrary(tidygraph)\nlibrary(chorddiag)\nlibrary(viridis)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package     * version date (UTC) lib source\n chorddiag   * 0.1.3   2025-11-02 [1] Github (mattflor/chorddiag@1688d72)\n circlize    * 0.4.17  2025-12-08 [1] RSPM\n dplyr       * 1.1.4   2023-11-17 [1] RSPM\n forcats     * 1.0.1   2025-09-25 [1] RSPM\n ggplot2     * 4.0.1   2025-11-14 [1] RSPM\n ggraph      * 2.2.2   2025-08-24 [1] RSPM\n igraph      * 2.2.1   2025-10-27 [1] RSPM\n lubridate   * 1.9.4   2024-12-08 [1] RSPM\n purrr       * 1.2.0   2025-11-04 [1] RSPM\n readr       * 2.1.6   2025-11-14 [1] RSPM\n readxl      * 1.4.5   2025-03-07 [1] RSPM\n stringr     * 1.6.0   2025-11-04 [1] RSPM\n tibble      * 3.3.0   2025-06-08 [1] RSPM\n tidygraph   * 1.3.1   2024-01-30 [1] RSPM\n tidyr       * 1.3.2   2025-12-19 [1] RSPM\n tidyverse   * 2.0.0   2023-02-22 [1] RSPM\n viridis     * 0.6.5   2024-01-29 [1] RSPM\n viridisLite * 0.4.2   2023-05-02 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Chord Diagram"
    ]
  },
  {
    "objectID": "Proportion/ChordDiagram.html#数据准备",
    "href": "Proportion/ChordDiagram.html#数据准备",
    "title": "和弦图",
    "section": "数据准备",
    "text": "数据准备\n使用UCSC Xena网站(UCSC Xena (xenabrowser.net))的TCGA-BRCA.star_counts.tsv和某医院中患者使用某药物后血糖的变化情况Berberine_new.xlsx。\n\n# TCGA-BRCA.star_counts.tsv\ntcga_brca_star_counts &lt;- readr::read_tsv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/TCGA-BRCA.star_counts.tsv\")\ntarget_ensembl_ids &lt;- c(\"ENSG00000012048.23\",  # BRCA1\n                        \"ENSG00000139618.16\",  # BRCA2\n                        \"ENSG00000141736.14\",  # ERBB2\n                        \"ENSG00000121879.6\",  # PIK3CA\n                        \"ENSG00000171862.11\",  # PTEN\n                        \"ENSG00000111537.5\")  # AKT1\ngene_data &lt;- tcga_brca_star_counts[tcga_brca_star_counts$Ensembl_ID %in% target_ensembl_ids, ]\ngene_data &lt;- gene_data[,2:101]\ngene_data_t &lt;- t(gene_data)\n\nx &lt;- c(gene_data_t[, 1], gene_data_t[, 3], gene_data_t[, 5])\ny &lt;- c(gene_data_t[, 2], gene_data_t[, 4], gene_data_t[, 6])\nfactor &lt;- rep(c(\"a\", \"b\", \"c\"), each = 100)\nplot_data &lt;- data.frame(x = x, y = y, factor = factor)\n\n# Berberine_new\nberberine_blood_glucose &lt;- readr::read_csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/Berberine_new.csv\")\nberberine_blood_glucose &lt;- berberine_blood_glucose %&gt;% na.omit()\n\nblood_glucose_category &lt;- function(value) {\n  if (value &lt; 4.5) {\n    return(\"Low\")\n  } else if (value &gt;= 4.5 & value &lt; 6.5) {\n    return(\"Normal\")\n  } else if (value &gt;= 6.5 & value &lt;= 11.0) {\n    return(\"Slightly High\")\n  } else {\n    return(\"High\")\n  }\n}\n\nberberine_blood_glucose$before_category &lt;- sapply(berberine_blood_glucose$before, blood_glucose_category)\nberberine_blood_glucose$after_category &lt;- sapply(berberine_blood_glucose$after, blood_glucose_category)\n\nadj_matrix &lt;- table(berberine_blood_glucose$before_category, berberine_blood_glucose$after_category) # 生成邻接矩阵\nadj_matrix_df &lt;- as.data.frame(as.table(adj_matrix))\n\nadj_matrix_wide &lt;- adj_matrix_df %&gt;%\n  pivot_wider(names_from = Var2, values_from = Freq, values_fill = list(Freq = 0))\nadj_matrix_wide_df &lt;- as.data.frame(adj_matrix_wide)\nrownames(adj_matrix_wide_df) &lt;- adj_matrix_wide_df$Var1\nm &lt;- as.matrix(adj_matrix_wide_df[, -1])",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Chord Diagram"
    ]
  },
  {
    "objectID": "Proportion/ChordDiagram.html#可视化",
    "href": "Proportion/ChordDiagram.html#可视化",
    "title": "和弦图",
    "section": "可视化",
    "text": "可视化\n\n1. 环形图\n在 R 中，使用circlize包可以创建环形图（Circular Plots）。环形图由多个区域组成（这里为3个区域），每个区域代表一个因子的水平。制作环形图需要以下三个步骤：\n步骤 1：用 circos.initialize() 初始化图表\n需要提供一个因子向量（factor vector）和用于 X 轴的数值。圆形图将根据因子的水平数划分成相应的区域。每个区域的长度将与对应的 X 轴数值成比例。\n步骤 2：用 circos.trackPlotRegion() 构建区域\n需要再次指定因子，同时可以根据需要指定 Y 轴的数值范围。\n步骤 3：在每个区域中添加图表\n可以在每个区域中绘制图表。这里使用 circos.trackPoints() 绘制散点图。circlize 包支持多种类型的环形图，你可以根据需求选择不同的可视化方法。\n\n1.1 基本绘图\n\n# 初始化环形图\ncircos.clear()\ncircos.initialize(factors = plot_data$factor, x = plot_data$x)\n\n# 绘制环形散点图\ncircos.trackPlotRegion(factors = plot_data$factor, y = plot_data$y, track.height = 0.5, panel.fun = function(x, y) {\n  circos.axis()\n})\ncircos.trackPoints(plot_data$factor, plot_data$x, plot_data$y, col = \"blue\", pch = 16, cex = 0.5)\n\n# 添加基因对名称标注\ncircos.text(x = 9, y = 20, labels = \"BRCA1 & BRCA2\", \n            sector.index = \"a\", facing = \"outside\", niceFacing = TRUE, \n            adj = c(0, 0.5), cex = 0.7, col = \"blue\")\n\ncircos.text(x = 11, y = 20, labels = \"ERBB2 & PIK3CA\", \n            sector.index = \"b\", facing = \"outside\", niceFacing = TRUE, \n            adj = c(0, 0.5), cex = 0.7, col = \"blue\")\n\ncircos.text(x = 17, y = 20, labels = \"PTEN & AKT1\", \n            sector.index = \"c\", facing = \"outside\", niceFacing = TRUE, \n            adj = c(0, 0.5), cex = 0.7, col = \"blue\")\n\n\n\n\n基本绘图\n\n\n\n# 清理环形图\ncircos.clear()\n\n环形散点图直观地展示了三对乳腺癌相关基因（BRCA1 & BRCA2、ERBB2 & PIK3CA、PTEN & AKT1）的基因表达水平及其分布特征。每个点表示一个样本中的基因表达值，通过观察不同扇形区域中点的分布，可以识别出基因对在表达水平上的差异。\n\n\n1.2 自定义\n自定义可以在三个不同的层面进行：\n\n初始化阶段：\n\n使用常规的 par() 函数和专门的 circos.par() 函数进行整体设置。\n\ncircos.axis()：\n\n用于自定义轴线的外观和布局。\n\ncircos.trackPoints()：\n\n用于自定义图形中的点或图表的形状。\n大多数参数与基础 R 的使用方式一致。\n\n# 设置图形的背景和边距\npar(\n  mar = c(1, 1, 1, 1),           # 设置图形的边距\n  bg = rgb(0.9, 0.9, 0.9)        # 设置图形的背景色\n)\n# 初始化\ncircos.clear()\ncircos.initialize(factors = plot_data$factor, x = plot_data$x)\n\n# 绘制环形散点图\ncircos.trackPlotRegion(factors = plot_data$factor, y = plot_data$y, track.height = 0.5, panel.fun = function(x, y) {\n  circos.axis(\n    h = \"top\",                 # 将坐标轴放在环形图的内侧或外侧\n    labels = TRUE,             # 显示坐标轴标签\n    major.tick = TRUE,         # 显示主刻度\n    labels.cex = 0.5,          # 设置标签的大小\n    labels.font = 1,           # 设置标签的字体\n    direction = \"outside\",     # 坐标轴的刻度指向外部\n    minor.ticks = 4,           # 设置次刻度数量\n    major.tick.length = 0.08,  # 设置主刻度的大小\n    lwd = 2                    # 设置坐标轴和刻度线的宽度\n  )\n})\n\ncircos.trackPoints(plot_data$factor, plot_data$x, plot_data$y, col = \"#69b3a2\", pch = 16, cex = 0.5)\n\n\n\n\n自定义\n\n\n\ncircos.clear()\n\n环形散点图展示了三对乳腺癌相关基因之间的相关性，自定义根据特定的需求和问题调整图形布局、颜色、标签等，提高图形的清晰度和可解释性，帮助更好地突出数据的关键特征和趋势。\n\n\n1.3 环形图表类型\ncirclize 包提供多种图表类型：条形图、散点图、折线图、垂线图等。\n环形折线图\n可以使用circos.trackLines()绘制折线图。\n\n# 初始化环形图\ncircos.clear()\ncircos.initialize(factors = plot_data$factor, x = plot_data$x)\n\n# 绘制环形散点图\ncircos.trackPlotRegion(factors = plot_data$factor, y = plot_data$y, track.height = 0.5, panel.fun = function(x, y) {\n  circos.axis()\n})\ncircos.trackLines(plot_data$factor, plot_data$x[order(plot_data$x)], plot_data$y[order(plot_data$x)], col = rgb(0.1,0.5,0.8,0.3), lwd=2)\n\n\n\n\n环形折线图\n\n\n\n# 清理环形图\ncircos.clear()\n\n环形垂线图\n同样使用circos.trackLines()绘制垂线图。\n\n# 初始化环形图\ncircos.clear()\ncircos.initialize(factors = plot_data$factor, x = plot_data$x)\n\n# 绘制环形散点图\ncircos.trackPlotRegion(factors = plot_data$factor, y = plot_data$y, track.height = 0.5, panel.fun = function(x, y) {\n  circos.axis()\n})\ncircos.trackLines(plot_data$factor, plot_data$x[order(plot_data$x)], plot_data$y[order(plot_data$x)], col = rgb(0.1,0.5,0.8,0.3), lwd=2, type=\"h\")\n\n\n\n\n环形垂线图\n\n\n\n# 清理环形图\ncircos.clear()\n\n环形直方图\n每种图表类型必须与在 circos.trackPlotRegion 函数中指定的内容一致。\n例如，对于散点图，需要指定 Y 轴，如之前所示。但对于通过 circos.trackHist() 构建的直方图，则不需要指定 Y 轴。\n\n# 初始化环形图\ncircos.clear()\ncircos.initialize(factors = plot_data$factor, x = plot_data$x)\n\n# 绘制直方图\ncircos.trackHist(\n  plot_data$factor,      \n  plot_data$x,           \n  col = \"#69b3a2\",       \n  bg.col = \"white\",      \n  track.height = 0.4    \n)\n\n\n\n\n环形直方图\n\n\n\n# 清理环形图\ncircos.clear()\n\n多轨环形图\ncirclize包可以构建具有多条轨道的环形图。\n\n# 初始化参数\npar(mar = c(1, 1, 1, 1))\ncircos.clear()\n\n# 初始化环形图\ncircos.initialize(factors = plot_data$factor, x = plot_data$x)\n\n# 添加第一条轨道，绘制折线图\ncircos.trackPlotRegion(factors = plot_data$factor, y = plot_data$y, panel.fun = function(x, y) {\n  circos.axis(labels.cex = 0.5, labels.font = 1, lwd = 0.8)\n})\ncircos.trackLines(plot_data$factor, plot_data$x[order(plot_data$x)], plot_data$y[order(plot_data$x)],\n                  col = rgb(0.1, 0.5, 0.8, 0.3), pch = 20, lwd = 2)\n\n# 第二条轨道，绘制散点图\ncircos.trackPlotRegion(factors = plot_data$factor, y = plot_data$y, panel.fun = function(x, y) {\n  circos.axis(labels = FALSE, major.tick = FALSE)\n})\ncircos.trackPoints(plot_data$factor, plot_data$x, plot_data$y,\n                   col = rgb(0.9, 0.5, 0.8, 0.3), pch = 20, cex = 2)\n\n# 第三条轨道，绘制条形图\ncircos.par(\"track.height\" = 0.4)\ncircos.trackPlotRegion(factors = plot_data$factor, y = plot_data$y, panel.fun = function(x, y) {\n  circos.axis(labels = FALSE, major.tick = FALSE)\n})\ncircos.trackLines(plot_data$factor, plot_data$x, plot_data$y,\n                  col = rgb(0.9, 0.5, 0.1, 0.3), type = \"h\", lwd = 1.5) # 仍可继续叠加\n\n# 添加基因对名称标注\ncircos.text(x = 9, y = 40, labels = \"BRCA1 & BRCA2\", \n            sector.index = \"a\", facing = \"outside\", niceFacing = TRUE, \n            adj = c(0, 0.5), cex = 0.7, col = \"blue\")\n\ncircos.text(x = 11, y = 40, labels = \"ERBB2 & PIK3CA\", \n            sector.index = \"b\", facing = \"outside\", niceFacing = TRUE, \n            adj = c(0, 0.5), cex = 0.7, col = \"blue\")\n\ncircos.text(x = 17, y = 40, labels = \"PTEN & AKT1\", \n            sector.index = \"c\", facing = \"outside\", niceFacing = TRUE, \n            adj = c(0, 0.5), cex = 0.7, col = \"blue\")\n\n\n\n\n多轨环形图\n\n\n\ncircos.clear()\n\n多轨环形图展示了三对乳腺癌相关基因（BRCA1 & BRCA2、ERBB2 & PIK3CA、PTEN & AKT1）的基因表达数据。不同轨道分别采用折线图、散点图和条形图，展现了基因表达的整体趋势、数据点分布以及变化幅度。圆环外圈的数字表示基因表达水平的数值范围，帮助理解不同基因的表达特性和相互关系。\n\n\n1.4 仅绘制一部分\ncirclize包可以使用circos.par()函数仅显示圆形图表的一部分。\n\ncircos.clear()\n# 设置圆形图参数，缩小视图范围\npar(mar = c(1, 2, 0.1, 0.1))  # 调整边距\ncircos.par(\"track.height\" = 0.7,       # 每个轨道高度\n           \"canvas.xlim\" = c(0, 1),    # 横向限制范围（缩小视图）\n           \"canvas.ylim\" = c(0, 1),    # 纵向限制范围（缩小视图）\n           \"gap.degree\" = 0,           # 扇区之间的间隙角度\n           \"clock.wise\" = FALSE) \n\ncircos.initialize(factors = plot_data$factor, xlim = c(0, 20)) \ncircos.trackPlotRegion(factors = plot_data$factor, ylim = c(0, 20), bg.border = NA ) \n\n# 只画factor=a的部分\ncircos.updatePlotRegion(sector.index = \"a\", bg.border = \"grey\" , bg.lwd=0.2)\ncircos.lines(plot_data$x, plot_data$y, pch = 16, cex = 0.5, type=\"h\" , col=\"#69b3a2\" , lwd=3)\n\n# 添加轴\ncircos.axis(h=\"bottom\" , labels.cex=0.4, direction = \"inside\" )\n\n\n\n\n仅绘制一部分\n\n\n\ncircos.clear()\n\n\n\n\n2. 和弦图\ncirclize 包还提供了构建和弦图的功能。它允许在节点之间添加弧线来显示流动。circos.links() 函数逐个建立连接，而 chordDiagram() 函数则一次性绘制整个数据集。\n\n2.1 添加连线\n\ncircos.clear()\npar(mar = c(1, 1, 1, 1) ) \ncircos.initialize(factors = plot_data$factor, x = plot_data$x)\n\ncircos.trackPlotRegion(factors = plot_data$factor, y = plot_data$y , bg.col = rgb(0.1,0.1,seq(0,1,0.1),0.4) , bg.border = NA)\n\n# 在两点之间添加连线\ncircos.link(\"a\", 3, \"b\", 3, h = 0.4)\n\n# 在点和区域之间添加连线\ncircos.link(\"b\", 5, \"c\", c(6,8), col = \"green\", lwd = 2, lty = 2, border=\"black\" )\n\n# 在两区域之间添加连线\ncircos.link(\"c\", c(8.5, 9.5), \"a\", c(-1,0), col = \"red\", border = \"blue\", h = 0.2)\n\n\n\n\n添加连线\n\n\n\n\n\n\n2.2 基础和弦图\n以Berberine_new为例\n\nchordDiagram(m, transparency = 0.5)\n\n\n\n\n基础和弦图\n\n\n\n\n此和弦图展示某药服用前后血糖等级的转变。\n定义颜色\n\ncolor &lt;- c(\n  \"Low\" = \"#1f77b4\",    \n  \"Normal\" = \"#2ca02c\",    \n  \"Slightly High\" = \"#ff7f0e\", \n  \"High\" = \"#d62728\"\n)\n\nchordDiagram(m, grid.col = color, transparency = 0.5)\n\n\n\n\n定义颜色\n\n\n\n\n此和弦图展示某药服用前后血糖等级的转变，定义颜色使颜色更符合用户阅读习惯。\n\n\n2.3 分面和弦图\n使用layout函数定义布局。\n\nlayout(matrix(c(1, 2), nrow = 1, byrow = TRUE)) \n\nchordDiagram(m, transparency = 0.5)\nchordDiagram(m, transparency = 0.5) # chordDiagram()自动分配颜色，生成两张不同的和弦图\n\n\n\n\n分面和弦图\n\n\n\n\n\n\n2.4 方向性分层和弦图\n方向性分层和弦图中，箭头清楚地指示了流动的方向，通过不同的高度来突出显示流动的方向性，同时也增加了图形的视觉层次感。\n\n# 将矩阵转换为长格式\ndata_long &lt;- as.data.frame(as.table(m)) %&gt;%\n  rename(from = Var1, to = Var2, value = Freq)\n\n# 设置颜色\ncategory_colors &lt;- viridis(4)\ngrid_col &lt;- category_colors[unique(c(data_long$from, data_long$to))]\n\n# 设置环形图的参数\ncircos.clear()\ncircos.par(start.degree = 90, gap.degree = 4, track.margin = c(-0.1, 0.1), points.overflow.warning = FALSE)\npar(mar = rep(0, 4))\n\n# 绘制环形图\nchordDiagram(\n  x = data_long, \n  grid.col = grid_col,\n  transparency = 0.25,\n  directional = 1,\n  direction.type = c(\"arrows\", \"diffHeight\"), \n  diffHeight  = -0.04,\n  annotationTrack = \"grid\", \n  annotationTrackHeight = c(0.05, 0.1),\n  link.arr.type = \"big.arrow\", \n  link.sort = TRUE, \n  link.largest.ontop = TRUE\n)\n\n# 添加文本和坐标轴\ncircos.trackPlotRegion(\n  track.index = 1, \n  bg.border = NA, \n  panel.fun = function(x, y) {\n\n    xlim = get.cell.meta.data(\"xlim\")\n    sector.index = get.cell.meta.data(\"sector.index\")\n\n    # 为每个扇区添加名称\n    circos.text(\n      x = mean(xlim), \n      y = 3.2, \n      labels = sector.index, \n      facing = \"bending\", \n      cex = 0.8\n    )\n  }\n)\n\n\n\n\n方向性分层和弦图\n\n\n\n\n此和弦图展示某药服用前后血糖等级的转变。方向性分层和弦图通过添加箭头和层次结构，能够更清晰地展示数据流动的方向和强度，有助于识别不同类别之间的相互关系和信息传递路径，增强数据的可视化效果和理解。\n\n\n2.5 高度定制和弦图\n通过circos.link()函数手动添加链接，构建一个高度定制化的和弦图。\ncirclize包提供了chordDiagram()函数，它可以自动构建整个和弦图，但定制化程度较低。\n\n# 定义分类和颜色\ncategories &lt;- rownames(m)\ncategory_colors &lt;- data.frame(\n  category = categories,\n  r = c(255, 200, 150, 100),  \n  g = c(100, 150, 200, 255), \n  b = c(150, 100, 50, 200)  \n)\n\ndf1 &lt;- category_colors\ndf1$xmin &lt;- 0  # 起点为0\ndf1$xmax &lt;- rowSums(m) + colSums(m)  # 每个分类的总流量（流入+流出）\ndf1$rcol &lt;- rgb(df1$r, df1$g, df1$b, max = 255)  # 区段颜色\ndf1$lcol &lt;- rgb(df1$r, df1$g, df1$b, alpha = 200, max = 255)  # 链接颜色（透明）\n\nlibrary(circlize)\n\n# 环形图初始化\npar(mar = rep(0, 4))\ncircos.clear()\ncircos.par(cell.padding = c(0, 0, 0, 0), track.margin = c(0, 0.1), start.degree = 90, gap.degree = 4)\n\ncircos.initialize(factors = df1$category, xlim = cbind(df1$xmin, df1$xmax))\ncircos.trackPlotRegion(ylim = c(0, 1), factors = df1$category, track.height = 0.1,\n                       panel.fun = function(x, y) {\n                         name = get.cell.meta.data(\"sector.index\")\n                         i = get.cell.meta.data(\"sector.numeric.index\")\n                         xlim = get.cell.meta.data(\"xlim\")\n                         ylim = get.cell.meta.data(\"ylim\")\n\n                         # 绘制标签和区段\n                         circos.text(x = mean(xlim), y = 1.2, labels = name, facing = \"bending.inside\", cex = 0.6, adj = c(0.5, 0.5))\n                         circos.rect(xleft = xlim[1], ybottom = ylim[1], xright = xlim[2], ytop = ylim[2],\n                                     col = df1$rcol[i], border = df1$rcol[i])\n                       })\n\ndf1$sum1 &lt;- colSums(m)  # 累计流出\ndf1$sum2 &lt;- numeric(nrow(df1))  # 累计流入\n\n# 遍历邻接矩阵绘制链接\nfor (i in 1:nrow(m)) {\n  for (j in 1:ncol(m)) {\n    if (m[i, j] &gt; 0) {  # 仅绘制有值的链接\n      circos.link(sector.index1 = df1$category[i], point1 = c(df1$sum1[i], df1$sum1[i] + m[i, j]),\n                  sector.index2 = df1$category[j], point2 = c(df1$sum2[j], df1$sum2[j] + m[i, j]),\n                  col = df1$lcol[i])\n\n      # 更新累计值\n      df1$sum1[i] &lt;- df1$sum1[i] + m[i, j]\n      df1$sum2[j] &lt;- df1$sum2[j] + m[i, j]\n    }\n  }\n}\n\n\n\n\n高度定制和弦图\n\n\n\n\n\n\n2.6 交互式和弦图\n互动性使和弦图更容易被理解。在交互式和弦图中，可以将特定的组悬停以突出显示其所有连接。\n\n# 分配颜色\ncategory &lt;- c(\"Low\", \"Normal\", \"Slightly High\", \"High\")\ndimnames(m) &lt;- list(\n  have = category,\n  prefer = category\n)\ngroupColors &lt;- c(\"#ADD9EE\", \"#7B92C7\", \"#F7C1CF\", \"#FFD47F\")\n\np &lt;- chorddiag(m, groupColors = groupColors, groupnamePadding = 20)\np\n\n\n\n交互式和弦图\n\n# 保存\n# library(htmlwidgets)\n# saveWidget(p, file=paste0( getwd(), \"/HtmlWidget/chord_interactive.html\"))\n\n此和弦图展示某药服用前后血糖等级的转变。交互式和弦图允许用户动态地探索数据，用户可以通过鼠标查看更详细的信息，从而更灵活地分析复杂的关系和数据流动，提升数据的可操作性和理解度。",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Chord Diagram"
    ]
  },
  {
    "objectID": "Proportion/ChordDiagram.html#应用场景",
    "href": "Proportion/ChordDiagram.html#应用场景",
    "title": "和弦图",
    "section": "应用场景",
    "text": "应用场景\n\n1. 基础和弦图\n\n\n\n\n\n\n图 1: 基础和弦图应用\n\n\n\nCK1tau和 CK1 过表达时磷酸化位点差异之间的重叠。弦图显示了在此处描述的磷酸化蛋白质组学分析中，其丰度与母线显著不同的已鉴定磷酸化位点的数量（&gt;1.5 或 &lt;0.67 倍变化，p &lt; 0.05，n = 5）。共享弦表示两个数据集之间的重叠。上调的肽以深蓝色表示，下调的肽以浅蓝色表示。 [1]\n\n\n2. 分面和弦图\n\n\n\n\n\n\n图 2: 分面和弦图应用\n\n\n\n按子区域划分的整个皮质-丘脑-基底神经节回路的网络交互概述。[2]\n\n\n3. 方向性分层和弦图\n\n\n\n\n\n\n图 3: 方向性分层和弦图应用\n\n\n\n弦图展示了在未受污染的永久冻土样本中共存的12种特定物种的网络关系。[3]\n\n\n4. 高度定制和弦图\n\n\n\n\n\n\n图 4: 高度定制和弦图应用\n\n\n\n潜在海马连接组的模块化结构。A，所有 122 种类型之间潜在连接的和弦图。带有箭头的粗和弦强调三突触环（深绿色，穿孔通路线;浅绿色，颞氨通路;红色，苔藓纤维;蓝色，Schaffer 侧支;橙色，从 CA1 到 EC 层 V 的投影）;其他连接将随机着色以优化可见性。类型可通过括号中的数字和其胞体位置子区域内的轴突-树突图案（彩色框约定和层顺序；CA1 的层：SLM、SR、SP、SO；子层：分子层、SP、多态层；EC：I-VI）。最内侧环中的阴影条显示该类型建立的（带符号的）连接的总数；兴奋型具有朝外的黑条，抑制型具有朝内的灰色条。B，整个网络和检测到的四个模块的模块化分数 （Q）。C， 社区与 DG （组件连接密度 75.9%）、CA3 （59.3%）、CA1 （64.6%） 和 EC （70.1%;未显示） 密切相关。[4]",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Chord Diagram"
    ]
  },
  {
    "objectID": "Proportion/ChordDiagram.html#参考文献",
    "href": "Proportion/ChordDiagram.html#参考文献",
    "title": "和弦图",
    "section": "参考文献",
    "text": "参考文献\n[1] van Ooijen G, Martin SF, Barrios-Llerena ME, Hindle M, Le Bihan T, O’Neill JS, Millar AJ. Functional analysis of the rodent CK1tau mutation in the circadian clock of a marine unicellular alga. BMC Cell Biol. 2013 Oct 15;14:46. doi: 10.1186/1471-2121-14-46. PMID: 24127907; PMCID: PMC3852742.\n[2] Hunnicutt BJ, Jongbloets BC, Birdsong WT, Gertz KJ, Zhong H, Mao T. A comprehensive excitatory input map of the striatum reveals novel functional organization. Elife. 2016 Nov 28;5:e19103. doi: 10.7554/eLife.19103. PMID: 27892854; PMCID: PMC5207773.\n[3] Yang S, Wen X, Shi Y, Liebner S, Jin H, Perfumo A. Hydrocarbon degraders establish at the costs of microbial richness, abundance and keystone taxa after crude oil contamination in permafrost environments. Sci Rep. 2016 Nov 25;6:37473. doi: 10.1038/srep37473. PMID: 27886221; PMCID: PMC5122841.\n[4] Rees CL, Wheeler DW, Hamilton DJ, White CM, Komendantov AO, Ascoli GA. Graph Theoretic and Motif Analyses of the Hippocampal Neuron Type Potential Connectome. eNeuro. 2016 Nov 18;3(6):ENEURO.0205-16.2016. doi: 10.1523/ENEURO.0205-16.2016. PMID: 27896314; PMCID: PMC5114701.\n[5] Gu, Z. (2020). circlize: Circular visualization in R. https://cran.r-project.org/package=circlize\n[6] Wickham, H. (2021). readxl: Read Excel Files. https://cran.r-project.org/package=readxl\n[7] Wickham, H. (2021). dplyr: A Grammar of Data Manipulation. https://cran.r-project.org/package=dplyr\n[8] Csardi, G., & Nepusz, T. (2006). igraph: Complex network analysis. https://cran.r-project.org/package=igraph\n[9] Wickham, H. (2016). ggraph: An implementation of grammar of graphics for graphs and networks. https://cran.r-project.org/package=ggraph\n[10] Wickham, H., & François, R. (2021). tidygraph: A tidy API for graph manipulation. https://cran.r-project.org/package=tidygraph",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Chord Diagram"
    ]
  },
  {
    "objectID": "Proportion/Network.html",
    "href": "Proportion/Network.html",
    "title": "网络图",
    "section": "",
    "text": "网络图是一种图解模型，形状如同网络，由节点和链接组成，其中链接可为有向或无向。",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Network Graph"
    ]
  },
  {
    "objectID": "Proportion/Network.html#示例",
    "href": "Proportion/Network.html#示例",
    "title": "网络图",
    "section": "示例",
    "text": "示例",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Network Graph"
    ]
  },
  {
    "objectID": "Proportion/Network.html#环境配置",
    "href": "Proportion/Network.html#环境配置",
    "title": "网络图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：igraph; cowplot; RColorBrewer; networkD3\n\n\n# 安装包\nif (!requireNamespace(\"igraph\", quietly = TRUE)) {\n  install.packages(\"igraph\")\n}\nif (!requireNamespace(\"cowplot\", quietly = TRUE)) {\n  install.packages(\"cowplot\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\nif (!requireNamespace(\"networkD3\", quietly = TRUE)) {\n  install.packages(\"networkD3\")\n}\n\n# 加载包\nlibrary(igraph)\nlibrary(cowplot)\nlibrary(RColorBrewer)\nlibrary(networkD3)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package      * version date (UTC) lib source\n cowplot      * 1.2.0   2025-07-07 [1] RSPM\n igraph       * 2.2.1   2025-10-27 [1] RSPM\n networkD3    * 0.4.1   2025-04-14 [1] RSPM\n RColorBrewer * 1.1-3   2022-04-03 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Network Graph"
    ]
  },
  {
    "objectID": "Proportion/Network.html#数据准备",
    "href": "Proportion/Network.html#数据准备",
    "title": "网络图",
    "section": "数据准备",
    "text": "数据准备\n主要利用R自带数据集进行绘制\n\n# network_pmat\n## matcars数据集各指标相关性分析结果\ndata_pmat_links&lt;- readr::read_csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/data_mat.csv\")\ndata_pmat_links &lt;- na.omit(data_pmat_links)\ncolnames(data_pmat_links) &lt;- c(\"from\", \"to\", \"p.log\")\n\ndata_pmat_node &lt;- colnames(mtcars)\nnetwork_pmat &lt;- graph_from_data_frame(d=data_pmat_links, vertices=data_pmat_node, directed=F) \n\n# data_mat\n## mtcars聚类分析\n## 计算相关系数矩阵\ndata_mat &lt;- cor(t(mtcars[,c(1,3:6)]))\n## 筛选高相关数据\ndata_mat[data_mat&lt;0.995] &lt;- 0\n\n\n网络图的输入数据类型\n网络图的数据输入主要有四种：领接矩阵、入射矩阵、边缘矩阵和连接的文本列表。\n这里我们用随机数据进行演示\n\n##邻接矩阵（方阵）-----\nset.seed(10)\ndata1 &lt;- matrix(sample(0:2, 25, replace=TRUE), nrow=5)\ncolnames(data1) = rownames(data1) = LETTERS[1:5]\n#创建graph图\nnetwork1 &lt;- graph_from_adjacency_matrix(data1)\n\ndata1\n\n  A B C D E\nA 2 2 1 2 2\nB 0 2 2 1 1\nC 1 2 1 2 1\nD 2 2 1 1 0\nE 1 2 0 2 0\n\n##入射矩阵（行列不一定相等，默认情况由行定向到列）-----\nset.seed(1)\ndata2 &lt;- matrix(sample(0:2, 15, replace=TRUE), nrow=3)\ncolnames(data2) &lt;- letters[1:5] #小写字母\nrownames(data2) &lt;- LETTERS[1:3] #大写字母\n#创建graph图\nnetwork2 &lt;- graph_from_incidence_matrix(data2)\n\nWarning: `graph_from_incidence_matrix()` was deprecated in igraph 1.6.0.\nℹ Please use `graph_from_biadjacency_matrix()` instead.\n\ndata2\n\n  a b c d e\nA 0 1 2 2 0\nB 2 0 1 2 0\nC 0 2 1 0 1\n\n##边缘列表（两列分别表示源和目标）-----\nlinks &lt;- data.frame(\nsource=c(\"A\",\"A\", \"A\", \"A\", \"A\",\"F\", \"B\"),\n  target=c(\"B\",\"B\", \"C\", \"D\", \"F\",\"A\",\"E\")\n)\n#创建graph图\nnetwork3 &lt;- graph_from_data_frame(d=links, directed=F) \n\nlinks\n\n  source target\n1      A      B\n2      A      B\n3      A      C\n4      A      D\n5      A      F\n6      F      A\n7      B      E\n\n##连接的文本列表----\nnetwork4 &lt;- graph_from_literal( A-B-C-D, E-A-E-A, D-C-A, D-A-D-C )\n\n四种数据类型绘图实例\n\n#绘制----\npar(mfrow=c(2,2), mar=c(1,1,1,1))\nplot(network1, main=\"邻接矩阵（方阵）\")\nplot(network2, main=\"入射矩阵\")\nplot(network3, main=\"边缘列表\")\nplot(network4, main=\"连接的文本列表\")\n\n\n\n\n四种数据类型绘图实例",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Network Graph"
    ]
  },
  {
    "objectID": "Proportion/Network.html#可视化",
    "href": "Proportion/Network.html#可视化",
    "title": "网络图",
    "section": "可视化",
    "text": "可视化\n\n1. 节点、链接、标签自定义\n\n#自定义----\n#生成随机数据\nset.seed(1)\ndata3 &lt;- matrix(sample(0:1, 100, replace=TRUE, prob=c(0.8,0.2)), nc=10)\nnetwork5 &lt;- graph_from_adjacency_matrix(data3 , mode='undirected', diag=F )\n\npar(mfrow=c(2,2), mar=c(1,1,1,1))\n\n#默认网络图\nplot(network5, main = \"默认网络图\")\n#自定义节点\nplot(network5,\n     vertex.color = rgb(0.8,0.2,0.2,0.9),           # 颜色\n     vertex.frame.color = \"Forestgreen\",            # 边框颜色\n     vertex.shape=c(\"circle\",\"square\"),             # 节点形状，可选：“none”, “circle”, “square”, “csquare”, “rectangle” “crectangle”, “vrectangle”, “pie”, “raster”,  “sphere”\n     vertex.size=c(15:24),\n     main = \"自定义节点\"\n)\n#自定义标签\nplot(network5, \n     vertex.label=LETTERS[1:10],                    # 标签内容\n     vertex.label.color=c(\"red\",\"blue\"),\n     vertex.label.family=\"Times\",                   # 字体\n     vertex.label.font=c(1,2,3,4),                  # 字体\n     vertex.label.cex=c(0.5,1,1.5),                 # 字体大小\n     vertex.label.dist=0,                           # 标签与节点的距离\n     vertex.label.degree=0,                         # 标签位置\n     main = \"自定义标签\"\n)\n#自定义链接\nplot(network5,\n     edge.color=rep(c(\"red\",\"pink\"),5),           # 链接颜色\n     edge.width=seq(1,10),                        # 链接宽度\n     edge.arrow.size=1,                           # 箭头大小\n     edge.arrow.width=1,                          # 箭头宽度\n     edge.lty=c(\"solid\"),                         # 链接线条类型\n     main = \"自定义链接\"\n)\n\n\n\n\n节点、链接、标签自定义\n\n\n\n\n\n\n2. 布局\n可以根据需要使用不同的网络图布局，比如sphere、circle、random、fruchterman.reingold等。\n\n#布局（layout）----\n#生成随机数据\ndata4 &lt;- matrix(sample(0:1, 400, replace=TRUE, prob=c(0.8,0.2)), nrow=20)\nnetwork6 &lt;- graph_from_adjacency_matrix(data4 , mode='undirected', diag=F )\n\n#不同的layout布局\npar(mfrow=c(2,2), mar=c(1,1,1,1))\nplot(network6, layout=layout.sphere, main=\"sphere\")\nplot(network6, layout=layout.circle, main=\"circle\")\nplot(network6, layout=layout.random, main=\"random\")\nplot(network6, layout=layout.fruchterman.reingold, main=\"fruchterman.reingold\")\n\n\n\n\n布局\n\n\n\n\n\n\n3. 变量映射到节点和连接\n\n3.1 变量分类映射到节点\n\n##映射到节点\n#生成随机数据\nlinks &lt;- data.frame(\nsource=c(\"A\",\"A\", \"A\", \"A\", \"A\",\"J\", \"B\", \"B\", \"C\", \"C\", \"D\",\"I\"),\n  target=c(\"B\",\"B\", \"C\", \"D\", \"J\",\"A\",\"E\", \"F\", \"G\", \"H\", \"I\",\"I\"),\n  importance=(sample(1:4, 12, replace=T))\n)\nnodes &lt;- data.frame(\n  name=LETTERS[1:10],\n  carac=c( rep(\"group1\",3),rep(\"group2\",2), rep(\"group3\",5))\n)\n\n#igraph图\nnetwork &lt;- graph_from_data_frame(d=links, vertices=nodes, directed=F) \n\n#颜色\ncoul  &lt;- brewer.pal(3, \"Set1\") \n\n#颜色向量\nmy_color &lt;- coul[as.numeric(as.factor(V(network)$carac))]\n\n#绘图\nplot(network, vertex.color=my_color)\n\n#添加标签\nlegend(\"bottomleft\", \n       legend=levels(as.factor(V(network)$carac))  , \n       col = coul , bty = \"n\", pch=20 , pt.cex = 3, cex = 1.5, text.col=coul , \n       horiz = FALSE, inset = c(0.1, 0.1))\n\n\n\n\n变量分类映射到节点\n\n\n\n\n上图中节点颜色代表分类\n\n\n3.2 变量映射到链接\n\n## 映射到链接\nplot(network, vertex.color=my_color, edge.width=E(network)$importance*2 )\n\nlegend(\"bottomleft\", \n       legend=levels(as.factor(V(network)$carac))  , \n       col = coul , \n       bty = \"n\", \n       pch=20 , \n       pt.cex = 3, \n       cex = 1.5, \n       text.col=coul, \n       horiz = FALSE, \n       inset = c(0.1, 0.1))\n\n\n\n\n变量映射到链接\n\n\n\n\n上图展示了mtcars数据集各指标的相关性分析结果（α=0.01），使用边缘列表的数据输入类型。链接表示两个指标具有相关性，链接的粗细代表p值的-log10，链接越粗表示结果越可靠。\n\n\n\n4. 节点大小映射连接数\n这里可以使用degree函数计算连接数\n\n##节点大小对应链接数（degree函数）----\n#计算链接数\ndeg &lt;- degree(network_pmat, mode=\"all\")\n\n#绘图\nplot(network_pmat, \n     vertex.size=deg*6,\n     layout=layout.circle, \n     vertex.color=rgb(0.1,0.7,0.8,0.5),\n     edge.width=E(network_pmat)$value*0.5)\n\n\n\n\n节点大小映射连接数\n\n\n\n\n上图中节点大小代表该节点的链接数（与之相关的指标数）。\n\n\n5. 聚类结果可视化\n这里以mtcars数据集为例进行聚类分析\n\n# 聚类结果可视化----\n# 建立igraph图\nnetwork &lt;- graph_from_adjacency_matrix( data_mat, weighted=T, mode=\"undirected\", diag=F)\n\n\n# 颜色，建立映射，不同颜色表示不同cyl\ncoul &lt;- brewer.pal(nlevels(as.factor(mtcars$cyl)), \"Set2\")\nmy_color &lt;- coul[as.numeric(as.factor(mtcars$cyl))]\n\n# 绘制\npar(bg=\"grey13\", mar=c(0,0,0,0))\nset.seed(4)\nplot(network, \n     vertex.size=12,\n     vertex.color=my_color, \n     vertex.label.cex=0.7,\n     vertex.label.color=\"white\",\n     vertex.frame.color=\"transparent\",\n     edge.color=rep(c(\"red\",\"pink\"),5),           \n     edge.width=seq(1,10),                      \n     edge.arrow.size=1,                           \n     edge.arrow.width=1,                         \n     edge.lty=c(\"solid\"),\n     edge.curved=0.3\n)\n\n# 添加标题与标签\ntext(0,0,\"mtcars network\",col=\"white\", cex=1.5)\nlegend(x=-0.2, y=-0.12, \n       legend=paste( levels(as.factor(mtcars$cyl)), \" cylinders\", sep=\"\"), \n       col = coul , \n       bty = \"n\", pch=20 , pt.cex = 2, cex = 1,\n       text.col=\"white\" , horiz = F)\n\n\n\n\n聚类结果可视化\n\n\n\n\n上图展示了以mpg、disp、gp、drat为依据对mtcars数据集进行聚类分析的结果。不同颜色表示不同的cyl。\n\n\n6. 3D交互网络图\n使用networkD3包可以实现网络图的3D交互。\n\n##交互（networkD3）----\np &lt;- simpleNetwork(data_pmat_links, height=\"100px\", width=\"100px\")\np\n\n\n\n3D交互网络图\n\n\n可以利用交互实现高亮显示、拖拽等功能（上图为拖拽carb节点）",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Network Graph"
    ]
  },
  {
    "objectID": "Proportion/Network.html#应用场景",
    "href": "Proportion/Network.html#应用场景",
    "title": "网络图",
    "section": "应用场景",
    "text": "应用场景\n\n\n\n\n\n\n图 1: 网络图应用\n\n\n\n上图为实验对照组受试者的运动网络。（A）在每个半球的双侧识别出与 PMC、SMA、PMA 和 SPL 对应的区域的质心的单个体素。（B）计算每个区域之间的成对 Pearson 互相关系数，构建邻接矩阵。（C）从互相关的邻接矩阵构建加权无向网络图。（D）使用 0.08–0.15 Hz 频段的一致性构建邻接矩阵，构建加权无向网络图，与互相关得出的图相似。 [1]",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Network Graph"
    ]
  },
  {
    "objectID": "Proportion/Network.html#参考文献",
    "href": "Proportion/Network.html#参考文献",
    "title": "网络图",
    "section": "参考文献",
    "text": "参考文献\n[1] Otten ML, Mikell CB, Youngerman BE, Liston C, Sisti MB, Bruce JN, Small SA, McKhann GM 2nd. Motor deficits correlate with resting state motor network connectivity in patients with brain tumours. Brain. 2012 Apr;135(Pt 4):1017-26. doi: 10.1093/brain/aws041. Epub 2012 Mar 8. PMID: 22408270; PMCID: PMC3326259.\n[2] Csardi G, Nepusz T (2006). “The igraph software package for complex network research.” InterJournal, Complex Systems, 1695. https://igraph.org.\n[3] Wilke C (2024). cowplot: Streamlined Plot Theme and Plot Annotations for ‘ggplot2’. R package version 1.1.3, https://CRAN.R-project.org/package=cowplot.\n[4] Neuwirth E (2022). RColorBrewer: ColorBrewer Palettes. R package version 1.1-3, https://CRAN.R-project.org/package=RColorBrewer.\n[5] Allaire J, Gandrud C, Russell K, Yetman C (2017). networkD3: D3 JavaScript Network Graphs from R. R package version 0.4, https://CRAN.R-project.org/package=networkD3.",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Network Graph"
    ]
  },
  {
    "objectID": "GraphGallery.html",
    "href": "GraphGallery.html",
    "title": "Graph Gallery",
    "section": "",
    "text": "👋 Bizard 是一个为生物医学研究量身定制的高级可视化代码综合存储库。目前包含约 750 张图表，涵盖超过 65 种图表类型。以下是所有图表的图库。\n表格中的每一行对应一个图表。您可以点击图表进行放大预览。点击图表的蓝色标题，可以跳转到对应的图文教程页面。表格的搜索框提供了图表搜索功能。",
    "crumbs": [
      "<i class='fa-solid fa-panorama'></i> Graph Gallery"
    ]
  },
  {
    "objectID": "GraphGallery.html#基础",
    "href": "GraphGallery.html#基础",
    "title": "Graph Gallery",
    "section": "基础",
    "text": "基础\n\n分布图\n\n\n\n\n\n\n\n\n\n\n\n\n\n相关性图\n\n\n\n\n\n\n\n\n\n\n\n\n\n排序图\n\n\n\n\n\n\n\n\n\n\n\n\n\n整体与部分图\n\n\n\n\n\n\n\n\n\n\n\n\n\n时间演化图\n\n\n\n\n\n\n\n\n\n\n\n\n\n流动图\n\n\n\n\n\n\n\n\n\n\n\n\n\n动画图",
    "crumbs": [
      "<i class='fa-solid fa-panorama'></i> Graph Gallery"
    ]
  },
  {
    "objectID": "GraphGallery.html#组学",
    "href": "GraphGallery.html#组学",
    "title": "Graph Gallery",
    "section": "组学",
    "text": "组学",
    "crumbs": [
      "<i class='fa-solid fa-panorama'></i> Graph Gallery"
    ]
  },
  {
    "objectID": "GraphGallery.html#临床",
    "href": "GraphGallery.html#临床",
    "title": "Graph Gallery",
    "section": "临床",
    "text": "临床",
    "crumbs": [
      "<i class='fa-solid fa-panorama'></i> Graph Gallery"
    ]
  },
  {
    "objectID": "GraphGallery.html#𝐇𝐈𝐏𝐋𝐎𝐓",
    "href": "GraphGallery.html#𝐇𝐈𝐏𝐋𝐎𝐓",
    "title": "Graph Gallery",
    "section": "𝐇𝐈𝐏𝐋𝐎𝐓",
    "text": "𝐇𝐈𝐏𝐋𝐎𝐓\n\n基础\n\n\n\n\n\n\n\n\n\n\n\n\n\n组学\n\n\n\n\n\n\n\n\n\n\n\n\n\n临床\n\n\n\n\n\n\n\n\n\n\n\n\n\n地图",
    "crumbs": [
      "<i class='fa-solid fa-panorama'></i> Graph Gallery"
    ]
  },
  {
    "objectID": "DataOverTime/LineChart.html",
    "href": "DataOverTime/LineChart.html",
    "title": "线性图",
    "section": "",
    "text": "在各类图表中绘制线段是常见的，该模块将绘制各种可能用到的线段。",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Line Chart"
    ]
  },
  {
    "objectID": "DataOverTime/LineChart.html#示例",
    "href": "DataOverTime/LineChart.html#示例",
    "title": "线性图",
    "section": "示例",
    "text": "示例\n\n\n\n\n\n如图是一个基础的线性图，能直观得表示因变量随自变量的走向。",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Line Chart"
    ]
  },
  {
    "objectID": "DataOverTime/LineChart.html#环境配置",
    "href": "DataOverTime/LineChart.html#环境配置",
    "title": "线性图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：ggplot2, viridis, patchwork, gghighlight, ggpmisc\n\n\n# 安装包\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"viridis\", quietly = TRUE)) {\n  install.packages(\"viridis\")\n}\nif (!requireNamespace(\"patchwork\", quietly = TRUE)) {\n  install.packages(\"patchwork\")\n}\nif (!requireNamespace(\"gghighlight\", quietly = TRUE)) {\n  install.packages(\"gghighlight\")\n}\nif (!requireNamespace(\"ggpmisc\", quietly = TRUE)) {\n  install.packages(\"ggpmisc\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\n\n# 加载包\nlibrary(ggplot2)\nlibrary(viridis)     \nlibrary(patchwork)   \nlibrary(gghighlight) \nlibrary(ggpmisc)     \nlibrary(dplyr)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package     * version date (UTC) lib source\n dplyr       * 1.1.4   2023-11-17 [1] RSPM\n gghighlight * 0.5.0   2025-06-14 [1] RSPM\n ggplot2     * 4.0.1   2025-11-14 [1] RSPM\n ggpmisc     * 0.6.3   2025-11-29 [1] RSPM\n ggpp        * 0.5.9   2025-06-28 [1] RSPM\n patchwork   * 1.3.2   2025-08-25 [1] RSPM\n viridis     * 0.6.5   2024-01-29 [1] RSPM\n viridisLite * 0.4.2   2023-05-02 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Line Chart"
    ]
  },
  {
    "objectID": "DataOverTime/LineChart.html#数据准备",
    "href": "DataOverTime/LineChart.html#数据准备",
    "title": "线性图",
    "section": "数据准备",
    "text": "数据准备\n使用R语言内置的iris数据集和economics数据集，和自定义的数据集，以及PhysioNet数据库中的葡萄糖值实时测量数据 [1]。\n\n# 1.iris数据\ndata &lt;- iris\n\nhead(data)\n\n  Sepal.Length Sepal.Width Petal.Length Petal.Width Species\n1          5.1         3.5          1.4         0.2  setosa\n2          4.9         3.0          1.4         0.2  setosa\n3          4.7         3.2          1.3         0.2  setosa\n4          4.6         3.1          1.5         0.2  setosa\n5          5.0         3.6          1.4         0.2  setosa\n6          5.4         3.9          1.7         0.4  setosa\n\n# 2.economics数据\n# （1）直接使用economics数据绘制图形\n# （2）economics数据处理后用于绘制时序图\ndata_economics &lt;- economics[,c(1, 4, 5)] %&gt;%\n  filter(grepl(\"-12-01\", date)) %&gt;%           # 只选择12月数据进行绘图\n  mutate(date = gsub(\"-.*\", \"\", date)) %&gt;%    # 只保留年份\n  slice(1:25) %&gt;%                             # 选择前25年\n  arrange(date)                               # 排序\n\nhead(data_economics)\n\n# A tibble: 6 × 3\n  date  psavert uempmed\n  &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt;\n1 1967     11.8     4.8\n2 1968     11.1     4.4\n3 1969     11.8     4.6\n4 1970     13.2     5.9\n5 1971     13       6.2\n6 1972     13.7     6.1\n\n# 3.自动生成数据(用于y轴的log转换)\ndata_create &lt;- data.frame(\n  x = seq(11, 100),\n  y = seq(11, 100) / 2 + rnorm(90)\n)\n\nhead(data_create)\n\n   x        y\n1 11 4.907642\n2 12 6.516262\n3 13 6.226208\n4 14 6.352635\n5 15 8.159632\n6 16 7.664933\n\n# 4.葡萄糖值(用于强调特定线段部分)\ndata_glucose &lt;- read.csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/Dexcom_001.csv\", header = T)\n\n# 葡萄糖值的数据处理\ndata_glucose &lt;- data_glucose[,c(2, 8)] %&gt;%\n  slice(1:102) %&gt;%\n  setNames(c(\"V1\", \"V2\")) %&gt;%\n  filter(!is.na(V2) & V1 != \"\") %&gt;%     # 去除na\n  mutate(V3 = rep(1:30, times = 3),     # 分为3个阶段\n         group = rep(c(\"stage one\", \"stage two\", \"stage three\"), each = 30))\n\nhead(data_glucose)\n\n               V1 V2 V3     group\n1 2020/2/13 17:23 61  1 stage one\n2 2020/2/13 17:28 59  2 stage one\n3 2020/2/13 17:33 58  3 stage one\n4 2020/2/13 17:38 59  4 stage one\n5 2020/2/13 17:43 63  5 stage one\n6 2020/2/13 17:48 67  6 stage one",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Line Chart"
    ]
  },
  {
    "objectID": "DataOverTime/LineChart.html#可视化",
    "href": "DataOverTime/LineChart.html#可视化",
    "title": "线性图",
    "section": "可视化",
    "text": "可视化\n\n1. 基本绘图\n\n# 基本绘图\np &lt;- ggplot(data, aes(x = Sepal.Length, y = Sepal.Width)) +\n  geom_line()\n\np\n\n\n\n\n\n\n\n图 1: 基本绘图\n\n\n\n\n\n这个图是线性图的基本形式，在ggplot中调用geom_line()即可绘制。\n\n\n2. 更改线样式\n\n# 更改线样式\np &lt;- ggplot(data, aes(x = Sepal.Length, y = Sepal.Width)) +\n  geom_line(orientation = \"x\", linewidth = 1, color = \"blue\", linetype = 2)\n\np\n\n\n\n\n更改线样式\n\n\n\n\n这个图可通过设置linewidth、color、linetype更改线样式。\n\n\n\n\n\n\n提示\n\n\n\n关键参数: geom_line\n\nlinetype: 表示线的类型，可选项范围0-6(其中0 = blank, 1 = solid, 2 = dashed, 3 = dotted, 4 = dotdash, 5 = longdash, 6 = twodash)，具体形状如下图：\n\n\n\n\n\n\n\norientation: 线段的朝向，可选项有”x”，“y”，orientation=“x”是以x为自变量，y为因变量绘制。\nlinewidth: 线段的粗细。\n\n\n\n\n\n3. y轴刻度log化\n\n# y轴log化\np &lt;- ggplot(data_create, aes(x = x, y = y)) +\n  geom_line() +\n  scale_y_log10(breaks = c(1, 5, 10, 15, 20, 50, 100), limits = c(1, 100))\n\np\n\n\n\n\ny轴刻度log化\n\n\n\n\n这个图可以看到y轴的刻度并不是等间距分布，而是log化了，它放大了曲线的下部。\n\n\n\n\n\n\n提示\n\n\n\n关键参数: scale_y_log10\n\nbreaks：可以用一组数值向量表示y轴刻度的位置。\nlimits：可以用长度为2的数值向量表示y轴刻度的范围。\n\n\n\n\n# y轴log化前(做对照)\np &lt;- ggplot(data_create, aes(x = x, y = y)) +\n  geom_line()\n\np\n\n\n\n\ny轴log化前(做对照)\n\n\n\n\n这个图是没有进行y轴log化的图（为了对比），可以看到刻度是均匀分布的。\n\n\n4. 多类数据绘图\n\n# 多类数据绘图\np &lt;- ggplot(data[data$Species != \"versicolor\", ], aes(x = Sepal.Length, y = Sepal.Width)) +\n  geom_line(aes(color = Species)) # 将物种变量映射到颜色特征上\n\np\n\n\n\n\n多类数据绘图\n\n\n\n\n这个图使用了iris数据集的两个物种进行绘图。\n\n\n5. 颜色选择\n\n5.1 使用viridis包\n\n# 多类数据绘图\n# 多类数据绘图+使用`viridis`包\np &lt;- ggplot(data[data$Species != \"versicolor\", ], aes(x = Sepal.Length, y = Sepal.Width)) +\n  geom_line(aes(color = Species)) +\n  scale_color_viridis(discrete = TRUE)\n\np\n\n\n\n\n使用viridis包\n\n\n\n\n这个图使用viridis包的scale_color_viridis函数选择合适的颜色。\n\n\n5.2 自定义颜色\n\n# 使用`scale_color_manual()`自定义颜色\np &lt;- ggplot(data[data$Species != \"versicolor\", ], aes(x = Sepal.Length, y = Sepal.Width)) +\n  geom_line(aes(color = Species)) +\n  scale_color_manual(values = c(\"red\",\"blue\"))\n\np\n\n\n\n\n自定义颜色\n\n\n\n\n这个图使用scale_color_manual()自定义折线为红蓝双色。\n\n\n\n6. 连接散点图中的线段\n连接散点图中也包含线段。\n\n6.1 基本绘图+线样式\n\n# 基本绘图+线样式\np &lt;- ggplot(data[data$Species == \"setosa\", ], aes(x = Sepal.Width, y = Sepal.Length)) +\n  geom_point(shape = 17, size = 1.5, color = \"blue\") +\n  geom_line(size = 1, color = \"black\", linetype = 2)\n\np\n\n\n\n\n基本绘图+线样式\n\n\n\n\n这个图是基本的连接散点图，使用geom_point()绘制点，geom_line()绘制线段。\n\n\n6.2 按时序连线\n\n# 按照时序连线\np &lt;- ggplot(data_economics, aes(x = psavert, y = uempmed)) +\n  geom_point(shape = 17, size = 1.5, color = \"blue\") +\n  geom_text(\n    label = data_economics$date, nudge_x = 0,\n    nudge_y = -0.1, size = 5\n  ) +\n# 使用`geom_segment()`绘制线段\n  geom_segment(\n    aes(\n      xend = c(tail(psavert, n = 24), NA),\n      yend = c(tail(uempmed, n = 24), NA)\n    ),\n    linewidth = 1\n  )\n\np\n\n\n\n\n按时序连线\n\n\n\n\n这个图使用geom_segment()实现按照时序进行点的连线，和geom_line()绘制的图差别较大。\n\n\n\n\n\n\n提示\n\n\n\n关键参数: geom_segment\nxend/yend：与x,y相对应，也就是(x,y)指向(xend,yend)绘制线段。代码中c(tail(psavert, n=24),NA)是取psavert列的后面24个值，并加上了一个NA。这样就使前面的点指向后面一个点绘制线段，最后的点指向NA，不绘制线段。\n\n\n\n\n6.3 时序连线+箭头\n\n# 时序连线+箭头\np &lt;- ggplot(data_economics, aes(x = psavert, y = uempmed)) +\n  geom_point(shape = 17, size = 1.5, color = \"blue\") +\n  geom_text(\n    label = data_economics$date, nudge_x = 0,\n    nudge_y = -0.1, size = 5\n  ) +\n# 使用`geom_segment()`绘制线段\n  geom_segment(\n    aes(\n      xend = c(tail(psavert, n = 24), NA),\n      yend = c(tail(uempmed, n = 24), NA)\n    ),\n    linewidth = 1, arrow = arrow(length = unit(0.5, \"cm\"))\n  )\n\np\n\n\n\n\n时序连线+箭头\n\n\n\n\n这个图为每个连线添加了箭头，使连接散点图中的时序特征更加明显。\n\n\n\n7. 绘制回归曲线\n\n7.1 回归曲线\n\n## 回归曲线\np &lt;- ggplot(data, aes(x = Sepal.Width, y = Sepal.Length)) +\n  geom_point(shape = 16, size = 1.5, color = \"blue\") +\n  labs(x = \"Width\", y = \"Length\") +\n  geom_smooth(method = \"lm\", formula = y ~ x, se = F, color = \"red\") # 绘制线性回归曲线\n\np\n\n\n\n\n回归曲线\n\n\n\n\n这个图在散点图的基础上绘制了回归曲线。\n\n\n7.2 回归曲线+置信区间\n\n# 回归曲线+置信区间\np &lt;- ggplot(data, aes(x = Sepal.Width, y = Sepal.Length)) +\n  geom_point(shape = 16, size = 1.5, color = \"blue\") +\n  labs(x = \"Width\", y = \"Length\") +\n  geom_smooth(method = \"lm\", formula = y ~ x, se = T, color = \"red\") # 绘制线性回归曲线\n\np\n\n\n\n\n回归曲线+置信区间\n\n\n\n\n这个图在回归曲线上添加置信区间(即参数se=TRUE)。\n\n\n7.3 添加回归曲线标签\n\n#通过`stat_poly_eq()`添加回归曲线标签\np &lt;- ggplot(data, aes(x = Sepal.Width, y = Sepal.Length)) +\n  geom_point(shape = 16, size = 1.5, color = \"blue\") +\n  labs(x = \"Width\", y = \"Length\") +\n  geom_smooth(method = \"lm\", formula = y ~ x, se = T, color = \"red\") + # 绘制线性回归曲线\n  stat_poly_eq(use_label(\"eq\",\"R2\",\"P\"),formula = y~x,size = 4,method = \"lm\")\n\np\n\n\n\n\n添加回归曲线标签\n\n\n\n\n这个图使用ggpmisc包的stat_poly_eq()添加了回归曲线方程、R方和P值。\n\n\n\n8. 注释和分割线\n\n# 注释和分割线\np &lt;- ggplot(data = economics[1:60, c(1, 4)], aes(x = date, y = psavert)) +\n  geom_line() +\n  xlab(\"\") +\n  scale_x_date(date_breaks = \"3 months\", date_labels = \"%Y-%m\") +\n# 文本注释\n  annotate(\n    geom = \"text\", x = as.Date(\"1969-01-01\"), y = 14.5,\n    label = \"the enconomics of USA\"\n  ) +\n# 调整x坐标轴文本角度\n  theme(axis.text.x = element_text(angle = 60, hjust = 1)) +\n# 点注释\n  annotate(geom = \"point\", x = as.Date(\"1971-06-01\"), y = 14.7, size = 5, shape = 21, fill = \"transparent\") +\n# 绘制水平分割线\n  geom_hline(yintercept = 14, color = \"orange\")\n\np\n\n\n\n\n注释和分割线\n\n\n\n\n这个图使用了annotate做了点和文本的注释，并用geom_hline绘制了水平分割线。\n\n\n9. 多子图排列\n多子图排列，要用到patchwork包。\n\n# 多子图排列（需要`patchwork`包）\ndata_double &lt;- economics[1:60, c(1, 4, 5)]\n\np &lt;- ggplot(data_double, aes(x = date, y = psavert)) +\n  geom_line() +\n  xlab(\"\")\n\np1 &lt;- ggplot(data_double, aes(x = date, y = uempmed)) +\n  geom_line() +\n  xlab(\"\")\n\np + p1\n\n\n\n\n多子图排列\n\n\n\n\n这个图在一张图中显示了两张子图，图片的排列要用到patchwork包。\n\n\n10. 双y轴\n\n# 双y轴 \ndata_double &lt;- economics[1:60, c(1, 4, 5)]\n\np &lt;- ggplot(data_double, aes(x = date)) +\n  geom_line(aes(y = psavert), color = \"red\") +\n  geom_line(aes(y = uempmed * 3), color = \"blue\") + # 为适应左y轴的范围，右y轴的值要扩大相应倍数\n  xlab(\"\") +\n  scale_y_continuous(\n    name = \"psavert\",\n    sec.axis = sec_axis(transform = ~ . / 3, name = \"uempmed\") # 坐标轴的刻度要减少相应倍数\n  ) +\n  theme(\n    axis.title.y = element_text(color = \"red\", size = 13),\n    axis.title.y.right = element_text(color = \"blue\", size = 13),\n    legend.position = \"none\"\n  )\n\np\n\n\n\n\n双y轴\n\n\n\n\n这个图有着两个不同的y轴，上面的刻度可以不同。\n\n\n11. 线形图+直方图\n\n# 线形图+直方图\ndata_double &lt;- economics[1:60, c(1, 4, 5)]\n\np &lt;- ggplot(data_double, aes(x = date)) +\n  geom_bar(aes(y = psavert), stat = \"identity\", fill = \"#69b3a2\") + # 绘制条形图\n  geom_line(aes(y = uempmed * 3), color = \"blue\") + # 绘制线形图\n  xlab(\"\") +\n  scale_y_continuous(\n    name = \"psavert\",\n    sec.axis = sec_axis(transform = ~ . / 3, name = \"uempmed\")\n  ) +\n  theme(\n    axis.title.y = element_text(color = \"#69b3a2\", size = 13),\n    axis.title.y.right = element_text(color = \"blue\", size = 13),\n    legend.position = \"none\"\n  )\n\np\n\n\n\n\n线形图+直方图\n\n\n\n\n这个图的左y轴是直方图坐标轴，右y轴是线形图的坐标轴。\n\n\n12. 强调特定线段\n选取了部分葡萄糖的观测数据，并分成3个阶段进行绘图，用作强调线段这一部分的原始数据。\n\n# 强调特定线段(需要使用到gghighlight包)\np &lt;- ggplot(data_glucose) +\n  geom_line(aes(V3, V2, color = group)) +\n  gghighlight(max(V2) &gt; 125, label_key = group) +\n  xlab(\"Observation time\") +\n  ylab(\"Value of glucose\")\n\np\n\n\n\n\n强调特定线段\n\n\n\n\n这个图通过筛选条件强调了第一阶段的折线。\n淡化特定线段\n\n# 通过unhighlighted_params参数淡化特定线段\np &lt;- ggplot(data_glucose) +\n  geom_line(aes(V3, V2, color = group), linewidth = 1) +\n  gghighlight(max(V2) &gt; 125, label_key = group, \n    unhighlighted_params = list(\n      linewidth = 0.3,\n      colour = alpha(\"blue\", 0.7),\n      linetype = \"dashed\"\n    )\n  ) +\n  xlab(\"Observation time\") +\n  ylab(\"Value of glucose\")\n\np\n\n\n\n\n淡化特定线段\n\n\n\n\n这个图通过unhighlighted_params参数修改淡化折线格式。",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Line Chart"
    ]
  },
  {
    "objectID": "DataOverTime/LineChart.html#应用场景",
    "href": "DataOverTime/LineChart.html#应用场景",
    "title": "线性图",
    "section": "应用场景",
    "text": "应用场景\n\n\n\n\n\n\n图 2: 线性图应用1\n\n\n\n图中显示了2005年至2022年出生队列中不同剂量含腮腺炎疫苗的覆盖率。[1]\n\n\n\n\n\n\n图 3: 线性图应用2\n\n\n\n图中显示了基于未使用、原始和改进方法的模型方法相应的相对误差曲线， 其中基于改进方法的成分含量模型的平均相对误差优于基于未使用和原始方法的模型。[2]\n\n\n\n\n\n\n图 4: 线性图应用3\n\n\n\n图中（A） HCC患者合并症数量的分布。（B） 不同年龄和性别的HCC患者的平均合并症数量。（C）各年龄组男性HCC患者合并症数量的分布。（D） 各年龄组女性HCC患者合并症数量的分布。[3]",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Line Chart"
    ]
  },
  {
    "objectID": "DataOverTime/LineChart.html#参考文献",
    "href": "DataOverTime/LineChart.html#参考文献",
    "title": "线性图",
    "section": "参考文献",
    "text": "参考文献\n[1] FU C, XU W, ZHENG W, et al. Epidemiological characteristics and interrupted time series analysis of mumps in Quzhou City, 2005-2023[J]. Hum Vaccin Immunother, 2024,20(1): 2411828.\n[2] LU R, LIU H, YANG H, et al. Multi-Delay Identification of Rare Earth Extraction Process Based on Improved Time-Correlation Analysis[J]. Sensors (Basel), 2023,23(3).\n[3] MU X M, WANG W, JIANG Y Y, et al. Patterns of Comorbidity in Hepatocellular Carcinoma: A Network Perspective[J]. Int J Environ Res Public Health, 2020,17(9).",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Line Chart"
    ]
  },
  {
    "objectID": "DataOverTime/CalendHighlight.html",
    "href": "DataOverTime/CalendHighlight.html",
    "title": "日期高亮标记",
    "section": "",
    "text": "日期高亮标记主要用于展示时间序列数据中某些特定日期范围内的数据变化情况，可用于活动频率概览和特殊日期标注。",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Calend Highlight"
    ]
  },
  {
    "objectID": "DataOverTime/CalendHighlight.html#示例",
    "href": "DataOverTime/CalendHighlight.html#示例",
    "title": "日期高亮标记",
    "section": "示例",
    "text": "示例",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Calend Highlight"
    ]
  },
  {
    "objectID": "DataOverTime/CalendHighlight.html#环境配置",
    "href": "DataOverTime/CalendHighlight.html#环境配置",
    "title": "日期高亮标记",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：calendR\n\n\n# 安装包\nif (!requireNamespace(\"calendR\", quietly = TRUE)) {\n  install.packages(\"calendR\")\n}\n\n# 加载包\nlibrary(calendR)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package * version date (UTC) lib source\n calendR * 1.2     2023-10-05 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Calend Highlight"
    ]
  },
  {
    "objectID": "DataOverTime/CalendHighlight.html#数据准备",
    "href": "DataOverTime/CalendHighlight.html#数据准备",
    "title": "日期高亮标记",
    "section": "数据准备",
    "text": "数据准备\n数据为指定年的日历数据，可选择高亮显示某些日期范围。\n\n# 构造数据\nset.seed(1)\ndata &lt;- rnorm(365)\n\n# 查看数据\nhead(data)\n\n[1] -0.6264538  0.1836433 -0.8356286  1.5952808  0.3295078 -0.8204684",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Calend Highlight"
    ]
  },
  {
    "objectID": "DataOverTime/CalendHighlight.html#可视化",
    "href": "DataOverTime/CalendHighlight.html#可视化",
    "title": "日期高亮标记",
    "section": "可视化",
    "text": "可视化\n\n1. 中国日期\n需要注意如果在China，默认weeknames和monthnames为中文，如果在其他国家/地区，默认weeknames和monthnames为英文。\n\n# 中国日期\np &lt;- calendR(\n    year = 2025,\n    month = NULL,\n    from = NULL,\n    to = NULL,\n    start = \"M\",\n    mbg.col = 2,\n    # orientation = \"portrait\",\n    months.col = \"white\",\n    months.pos = 0.5,\n    monthnames = c(\n        \"一月\",\n        \"二月\",\n        \"三月\",\n        \"四月\",\n        \"五月\",\n        \"六月\",\n        \"七月\",\n        \"八月\",\n        \"九月\",\n        \"十月\",\n        \"十一月\",\n        \"十二月\"\n    ),\n    weeknames = c(\"一\", \"二\", \"三\", \"四\", \"五\", \"六\", \"日\"),\n    special.days = data,\n    special.col = \"#00338888\",\n    gradient = TRUE,\n    low.col = \"#FFFFFF88\",\n    font.family = \"sans\",\n    font.style = \"plain\",\n    day.size = 2,\n    # ncol = 2,\n    lunar = FALSE,\n    pdf = FALSE\n)\n\np\n\n\n\n\n中国日期\n\n\n\n\n\n\n2. 常规日期\n\n# 常规日期\np &lt;- calendR(\n    year = 2025,\n    month = NULL,\n    from = NULL,\n    to = NULL,\n    start = \"S\",\n    mbg.col = 2,\n    # orientation = \"portrait\",\n    months.col = \"white\",\n    months.pos = 0.5,\n    monthnames = c(\n    \"January\",\n    \"February\",\n    \"March\",\n    \"April\",\n    \"May\",\n    \"June\",\n    \"July\",\n    \"August\",\n    \"September\",\n    \"October\",\n    \"November\",\n    \"December\"\n  ),\n    weeknames = c(\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"),\n    special.days = data,\n    special.col = \"#00888888\",\n    gradient = TRUE,\n    low.col = \"#FFFFFF88\",\n    font.family = \"sans\",\n    font.style = \"plain\",\n    day.size = 2,\n    # ncol = 2,\n    lunar = FALSE,\n    pdf = FALSE\n)\n\np\n\n\n\n\n常规日期\n\n\n\n\n\n\n3. 日期期间\n\n# 日期期间\ndata &lt;- rnorm(30, 15, 10)\ndays &lt;- rep(min(data) - 0.05, 365)\ndays[30:180] &lt;- data\n\np &lt;- calendR(\n    year = 2025,\n    month = NULL,\n    from = NULL,\n    to = NULL,\n    start = \"S\",\n    mbg.col = 2,\n    # orientation = \"portrait\",\n    months.col = \"white\",\n    months.pos = 0.5,\n    monthnames = c(\n    \"January\",\n    \"February\",\n    \"March\",\n    \"April\",\n    \"May\",\n    \"June\",\n    \"July\",\n    \"August\",\n    \"September\",\n    \"October\",\n    \"November\",\n    \"December\"\n  ),\n    weeknames = c(\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"),\n    special.days = days,\n    special.col = \"#FF000088\",\n    gradient = TRUE,\n    low.col = \"#FFFFFF88\",\n    font.family = \"sans\",\n    font.style = \"plain\",\n    day.size = 2,\n    # ncol = 2,\n    lunar = FALSE,\n    pdf = FALSE\n)\n\np\n\n\n\n\n日期期间",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Calend Highlight"
    ]
  },
  {
    "objectID": "DataOverTime/AreaChart.html",
    "href": "DataOverTime/AreaChart.html",
    "title": "面积图",
    "section": "",
    "text": "面积图（Area Chart）是在折线图的基础上，对折线以下区域进行颜色填充，主要是用于在连续间隔或时间跨度上展示数值。",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Area Chart"
    ]
  },
  {
    "objectID": "DataOverTime/AreaChart.html#示例",
    "href": "DataOverTime/AreaChart.html#示例",
    "title": "面积图",
    "section": "示例",
    "text": "示例\n\n\n\n\n\n此面积图展示了在 TCGA-BRCA.survival.tsv 数据集中，每个月份内的累计死亡人数。每个月份的死亡人数通过堆叠的面积来表示，面积的大小与该月的死亡人数成正比。x轴显示的是时间，以月份为单位，从事件发生的时间开始计算。y轴显示的是在对应月份发生的死亡事件的数量。每个区域的面积表示该月的死亡人数，区域越大，表示死亡人数越多。通过面积图，能够直观地看到随着时间的推移，死亡人数的变化趋势。可以观察到某些月份死亡人数的急剧上升，或是某些时间段内死亡人数较少或平稳，这有助于分析特定时段内的死亡风险和其他相关因素。",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Area Chart"
    ]
  },
  {
    "objectID": "DataOverTime/AreaChart.html#环境配置",
    "href": "DataOverTime/AreaChart.html#环境配置",
    "title": "面积图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：tidyverse; viridis; dygraphs; xts; hrbrthemes; ggpattern\n\n\n# 安装包\nif (!requireNamespace(\"tidyverse\", quietly = TRUE)) {\n  install.packages(\"tidyverse\")\n}\nif (!requireNamespace(\"viridis\", quietly = TRUE)) {\n  install.packages(\"viridis\")\n}\nif (!requireNamespace(\"dygraphs\", quietly = TRUE)) {\n  install.packages(\"dygraphs\")\n}\nif (!requireNamespace(\"xts\", quietly = TRUE)) {\n  install.packages(\"xts\")\n}\nif (!requireNamespace(\"hrbrthemes\", quietly = TRUE)) {\n  install.packages(\"hrbrthemes\")\n}\nif (!requireNamespace(\"ggpattern\", quietly = TRUE)) {\n  install.packages(\"ggpattern\")\n}\n\n# 加载包\nlibrary(tidyverse)\nlibrary(viridis)\nlibrary(dygraphs)\nlibrary(xts)\nlibrary(hrbrthemes)\nlibrary(ggpattern)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package     * version date (UTC) lib source\n dplyr       * 1.1.4   2023-11-17 [1] RSPM\n dygraphs    * 1.1.1.6 2018-07-11 [1] RSPM\n forcats     * 1.0.1   2025-09-25 [1] RSPM\n ggpattern   * 1.2.1   2025-08-27 [1] RSPM\n ggplot2     * 4.0.1   2025-11-14 [1] RSPM\n hrbrthemes  * 0.9.2   2025-11-02 [1] Github (hrbrmstr/hrbrthemes@d3fd029)\n lubridate   * 1.9.4   2024-12-08 [1] RSPM\n purrr       * 1.2.0   2025-11-04 [1] RSPM\n readr       * 2.1.6   2025-11-14 [1] RSPM\n stringr     * 1.6.0   2025-11-04 [1] RSPM\n tibble      * 3.3.0   2025-06-08 [1] RSPM\n tidyr       * 1.3.2   2025-12-19 [1] RSPM\n tidyverse   * 2.0.0   2023-02-22 [1] RSPM\n viridis     * 0.6.5   2024-01-29 [1] RSPM\n viridisLite * 0.4.2   2023-05-02 [1] RSPM\n xts         * 0.14.1  2024-10-15 [1] RSPM\n zoo         * 1.8-15  2025-12-15 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Area Chart"
    ]
  },
  {
    "objectID": "DataOverTime/AreaChart.html#数据准备",
    "href": "DataOverTime/AreaChart.html#数据准备",
    "title": "面积图",
    "section": "数据准备",
    "text": "数据准备\n使用R自带数据集AirPassengers和UCSC Xena网站(UCSC Xena (xenabrowser.net))的TCGA-BRCA.survival.tsv。\n\n# TCGA-BRCA.survival.tsv\ntcga_brca_survival &lt;- readr::read_tsv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/TCGA-BRCA.survival.tsv\")\n\ntcga_brca_filtered &lt;- tcga_brca_survival %&gt;%\n  filter(OS.time &lt;= 2000) %&gt;%\n  mutate(month = floor(OS.time / 30))\n\nmonthly_death_counts &lt;- tcga_brca_filtered %&gt;%\n  filter(OS == 1) %&gt;%\n  group_by(month) %&gt;%\n  summarise(deaths = n())\n\n# AirPassengers\ndata(\"AirPassengers\")\nair_passenger_data &lt;- as.data.frame(AirPassengers)\n\nair_passenger_data$Month &lt;- rep(month.name, 12)\nair_passenger_data$Year &lt;- rep(1949:1960, each=12)\nair_passenger_data$x &lt;- as.numeric(air_passenger_data$x)\n\nair_passenger_long &lt;- air_passenger_data %&gt;%\n  gather(key = \"Variable\", value = \"Value\", -Year, -Month)\n\nair_passenger_percentage &lt;- air_passenger_long %&gt;%\n  group_by(Year) %&gt;%\n  mutate(Percentage = Value / sum(Value) * 100) # 计算每月的百分比\n\nair_passenger_time_series &lt;- data.frame(datetime = time(AirPassengers), count = as.vector(AirPassengers))\n\nair_passenger_time_series$datetime &lt;- as.Date(air_passenger_time_series$datetime)\nair_passenger_xts &lt;- xts(x = air_passenger_time_series$count, order.by = air_passenger_time_series$datetime) # 创建 xts 对象",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Area Chart"
    ]
  },
  {
    "objectID": "DataOverTime/AreaChart.html#可视化",
    "href": "DataOverTime/AreaChart.html#可视化",
    "title": "面积图",
    "section": "可视化",
    "text": "可视化\n\n1. 基本绘图\n\n1.1 基础面积图\n使用ggplot2包绘制面积图。\n\n# 基础面积图\np &lt;- ggplot(monthly_death_counts, aes(x = month, y = deaths)) +\n  geom_area() +\n  labs(title = \"Cumulative Deaths Over Time\",\n       x = \"Months\",\n       y = \"Number of Deaths\")\n\np\n\n\n\n\n基础面积图\n\n\n\n\n此面积图展示了在 TCGA-BRCA.survival.tsv 数据集中，每个月份内的累计死亡人数。\n\n\n1.2 自定义面积图\n有多种选项可用于自定义面积图外观：\n\n使用ggtitle()添加标题。\n使用shape, size, color等参数更改线条样式。\n使用opacity为填充区域添加透明度。\n使用hrbrthemes包的theme_ipsum()函数自定义一般主题。\n使用geom_line()突出显示顶线。\n如果观察结果不太多，则使用geom_point()显示单个数据点\n\n\n# 自定义面积图\np &lt;- ggplot(monthly_death_counts, aes(x = month, y = deaths)) +\n  geom_area(fill=\"#69b3a2\", alpha=0.4) +\n  geom_line(color=\"#69b3a2\", size=1.2) +\n  geom_point(size=3, color=\"#69b3a2\") +\n  theme_ipsum() +\n  labs(title = \"Cumulative Deaths Over Time\",\n       x = \"Months\",\n       y = \"Number of Deaths\")\n\np\n\n\n\n\n自定义面积图\n\n\n\n\n此面积图展示了在 TCGA-BRCA.survival.tsv 数据集中，每个月份内的累计死亡人数。通过自定义面积图的外观，可以使图表更加符合数据的呈现需求，同时增强可读性和视觉效果。\n\n\n1.3 添加渐变颜色\n要添加颜色渐变来代替浅蓝色，我们需要使用ggpattern包并定义图形将使用的颜色。底部颜色为white，顶部颜色为 red。\n\n# 添加渐变颜色\np &lt;- ggplot(monthly_death_counts, aes(x = month, y = deaths)) +  \n  geom_area() +  \n  labs(title = \"Cumulative Deaths Over Time\",       \n      x = \"Months\",       \n      y = \"Number of Deaths\") +  \n  geom_area_pattern(data = monthly_death_counts, \n                    pattern = \"gradient\", \n                    pattern_fill = \"white\",\n                    pattern_fill2 = \"red\")\n\np\n\n\n\n\n添加渐变颜色\n\n\n\n\n\n\n1.4 带透明度的渐变色\n要为图形添加透明度，只需使用自然透明的颜色即可。例如，这里我们将白色改为透明灰色。底部颜色是透明的light grey，顶部颜色是blue。\n\n# 带透明度的渐变色\np &lt;- ggplot(monthly_death_counts, aes(x = month, y = deaths)) +\n  geom_area_pattern(data = monthly_death_counts, \n                  pattern = \"gradient\",\n                  fill = \"#00000010\",\n                  pattern_fill  = \"#00000010\",\n                  pattern_fill2 = \"blue\")\n\np\n\n\n\n\n带透明度的渐变色\n\n\n\n\n\n\n1.5 完全定制的带渐变的面积图\n同时采用上面看到的内容并添加其他功能（如更改theme、删除轴线等），您将得到更加漂亮的图形。\n下面代码示例为面积图的上部添加一条黑线，使用hrbrthemes包更改主题并删除轴线。\n\n# 完全定制的带渐变的面积图\np &lt;- ggplot(monthly_death_counts, aes(x = month, y = deaths)) +\n  geom_area_pattern(data = monthly_death_counts,\n                    pattern = \"gradient\", \n                    fill = \"#00000000\",\n                    pattern_fill  = \"#00000000\",\n                    pattern_fill2 = \"magenta\") + \n  geom_line(data = monthly_death_counts, colour = \"black\", linewidth = 0.8) +\n  geom_point(shape = 16, size = 4.5, colour = \"purple\") +\n  geom_point(shape = 16, size = 2.5, colour = \"white\") +\n  ggtitle(\"Cumulative Deaths Over Time\") + \n  theme_bw() +\n  theme(plot.title = element_text(size = 14),\n        panel.border       = element_blank(),\n        axis.line.x        = element_line(),\n        text               = element_text(size = 12),\n        axis.ticks         = element_blank(),\n        axis.text.y        = element_text(margin = margin(0,15,0,0, unit = \"pt\"))) +\n  scale_alpha_identity() + labs(x=\"\",y=\"\")\n\np\n\n\n\n\n完全定制的带渐变的面积图\n\n\n\n\n\n\n1.6 基础R绘制面积图\n使用基础R的polygon()函数，不使用其他包构建面积图。\n\nplot(monthly_death_counts$month, monthly_death_counts$deaths, col=rgb(0.2,0.1,0.5,0.9), type=\"o\", lwd=3,\n     xlab=\"Months\", ylab=\"Number of Deaths\", pch=20, main=\"Cumulative Deaths Over Time\")\n\npolygon(\n  x = c(min(monthly_death_counts$month), monthly_death_counts$month,\n        max(monthly_death_counts$month)), # 闭合x边界\n  y = c(0, monthly_death_counts$deaths, 0), # 闭合y边界\n  col = rgb(0.2, 0.1, 0.5, 0.2),\n  border = FALSE) # 使用 polygon() 填充面积\n\n\n\n\n基础R绘制面积图\n\n\n\n\n此面积图展示了在 TCGA-BRCA.survival.tsv 数据集中，每个月份内的累计死亡人数。通过使用基础R的polygon()函数来构建面积图，不依赖任何额外的包，直观地呈现了随着时间推移的死亡人数变化。图中的面积代表了每个月份内累计的死亡人数，随着时间的推进，面积逐渐增大，反映了死亡人数的累积趋势。\n\n\n\n2. 堆叠面积图\n\n2.1 基础堆叠面积图\n堆叠面积图（Stacked Area Chart）是一种特殊的面积图，可以用来比较在一个区间内的多个变量。堆叠面积图每个数据系列的起点都是基于前一个数据系列绘制的，也就是每度量一行就要填满行与行之间的区域。堆叠面积图将不同的变量按照一定的顺序堆叠在一起，使得不同变量所占的面积更加清晰，可以更直观地比较变量之间的大小关系和趋势。\n可以使用ggplot2包制作堆叠面积图。\n\np &lt;- ggplot(air_passenger_long, aes(x = Year, y = Value, fill = Month)) +\n  geom_area() +\n  labs(title = \"Monthly Air Passengers (Stacked Area Chart)\", \n       x = \"Year\", y = \"Number of Passengers\") +\n  theme_minimal()\n\np\n\n\n\n\n堆叠面积图\n\n\n\n\n\n\n2.2 控制 ggplot2 中的堆叠顺序\n\n使用 factor() 函数给变量设置特定的顺序。\n使用 sort() 进行字母顺序排序。\n根据特定的数据值进行排序。\n\n\n# 按月份排序\nair_passenger_data$Month &lt;- factor(air_passenger_data$Month, levels = month.name) # 将Month列转换为有顺序的因子\n\nair_passenger_long &lt;- air_passenger_data %&gt;%\n  gather(key = \"Variable\", value = \"Value\", -Year, -Month)\n\np &lt;- ggplot(air_passenger_long, aes(x = Year, y = Value, fill = Month)) +\n  geom_area() +\n  labs(title = \"Monthly Air Passengers\", \n       x = \"Year\", y = \"Number of Passengers\") +\n  theme_minimal()\n\np\n\n\n\n\n控制 ggplot2 中的堆叠顺序\n\n\n\n\n这个堆叠面积图展示了从1949年到1960年期间每月的航空乘客数量，每个月份的乘客数量通过不同颜色的区域进行堆叠展示。堆叠区域的顺序是按照月份的顺序排列（从一月到十二月），通过堆叠的方式，可以清晰地看到每个月的乘客数量变化以及各个年度之间的趋势对比，同时也能观察到每年乘客数量的季节性波动。面积图通过颜色的堆叠展示了不同月份对整体乘客数的贡献，便于直观地分析不同月份在不同年份的乘客量。\n\n# 按字母顺序排序\nmyLevels &lt;- levels(factor(air_passenger_long$Month)) \nair_passenger_long$Month &lt;- factor(air_passenger_long$Month, levels = sort(myLevels))\n\np &lt;- ggplot(air_passenger_long, aes(x = Year, y = Value, fill = Month)) +\n  geom_area() +\n  labs(title = \"Monthly Air Passengers\",\n       x = \"Year\", y = \"Number of Passengers\") +\n  theme_minimal()\n\np\n\n\n\n\n按字母顺序排序\n\n\n\n\n这个堆叠面积图展示了从1949年到1960年期间每月的航空乘客数量，每个月份的乘客数量通过不同颜色的区域进行堆叠展示。与之前的图不同的是，这里将月份的堆叠顺序按照字母顺序进行排序，而不是按照自然的月份顺序（1月到12月）。这种方式有助于查看每个年份中，按字母排序的月份对乘客总数的贡献。通过这样的排序方式，分析者可以观察到每个月份在总体乘客数中的占比，但失去了原本的时间序列的季节性趋势。\n\n# 按特定年份的值排序（例如1949年）\nmyLevels_value &lt;- air_passenger_long %&gt;%\n  filter(Year == 1949) %&gt;%  \n  arrange(Value) \n\nair_passenger_long$Month &lt;- factor(air_passenger_long$Month, levels = myLevels_value$Month)\n\np &lt;- ggplot(air_passenger_long, aes(x = Year, y = Value, fill = Month)) +\n  geom_area() +\n  labs(title = \"Monthly Air Passengers (Sorted by 1949 Values)\",\n       x = \"Year\", y = \"Number of Passengers\") +\n  theme_minimal()\n\np\n\n\n\n\n按特定年份的值排序（例如1949年）\n\n\n\n\n这个堆叠面积图展示了从1949年到1960年期间每月的航空乘客数量，每个月份的乘客数量通过不同颜色的区域进行堆叠展示。图中的月份顺序并不是按自然月份（1月到12月）排序，而是按照1949年每个月的乘客数量从低到高排序。这样可以直观地观察到1949年各个月份乘客数的相对比例，并展示这些月份在不同年份中的变化。\n\n\n2.3 自定义样式\n可以用以下方式改善图表的整体外观：\n\n使用viridis颜色标度\nhrbrthemes包的theme_ipsum\n使用ggtitle添加标题\n\n\np &lt;- ggplot(air_passenger_long, aes(x = Year, y = Value, fill = Month)) +\n  geom_area(alpha=0.6 , size=.5, colour=\"white\") +\n  scale_fill_viridis(discrete = T) +\n  theme_ipsum() + \n  ggtitle(\"Monthly Air Passengers\")\n\np\n\n\n\n\n自定义样式\n\n\n\n\n这个堆叠面积图展示了从1949年到1960年期间每月的航空乘客数量，每个月份的乘客数量通过不同颜色的区域进行堆叠展示。通过自定义面积图的外观，可以使图表更加符合数据的呈现需求，同时增强可读性和视觉效果。\n\n\n\n3. 比例堆叠面积图\n在比例堆叠面积图中，每年的总和始终等于百，并且每个组的值通过百分比表示。绘制比例堆叠面积图，需要先计算百分比，可以使用dplyr包来完成。\n\np &lt;- ggplot(air_passenger_percentage, aes(x = Year, y = Percentage, fill = Month)) +\n  geom_area(alpha = 0.6, size = 1, colour = \"black\") +\n  labs(title = \"Monthly Air Passengers\",\n       x = \"Year\", y = \"Percentage of Passengers\") +\n  theme_minimal()\n\np\n\n\n\n\n比例堆叠面积图\n\n\n\n\n这个比例堆叠面积图展示了 AirPassengers 数据集中，每月航空乘客数量在不同年份的百分比变化趋势。图中的每一层（由不同的月份填充颜色）代表了每个月在每年内所占的乘客数量的比例，堆积在一起形成面积图。通过比例堆叠面积图，我们可以直观地看到每个月份的航空乘客数量如何随时间变化，并且可以清晰地识别出每个月份在全年总乘客数量中所占的相对比例，并能够观察到不同年份之间的趋势变化。\n\n\n4. 交互式面积图\n使用dygraph包进行时间序列可视化。它提供缩放、悬停、小地图等功能。\n\np &lt;- dygraph(air_passenger_xts) %&gt;%\n  dyOptions(labelsUTC = TRUE, fillGraph = TRUE, fillAlpha = 0.1, drawGrid = FALSE, colors = \"#D8AE5A\") %&gt;%\n  dyRangeSelector() %&gt;%\n  dyCrosshair(direction = \"vertical\") %&gt;%\n  dyHighlight(highlightCircleSize = 5, highlightSeriesBackgroundAlpha = 0.2, hideOnMouseOut = FALSE) %&gt;%\n  dyRoller(rollPeriod = 1)\n\np\n\n\n\n交互式面积图\n\n\n这个图使用 dygraph 创建了一个动态的时间序列图，展示了 AirPassengers 数据集中每个月的航空乘客数量随时间的变化趋势。图中的每个点代表一个月的乘客数量，使用了不同的交互功能（动态交互，高亮功能，垂直交叉线，填充图形）来增强图表的可读性和可操作性。",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Area Chart"
    ]
  },
  {
    "objectID": "DataOverTime/AreaChart.html#应用场景",
    "href": "DataOverTime/AreaChart.html#应用场景",
    "title": "面积图",
    "section": "应用场景",
    "text": "应用场景\n\n1. 基础面积图\n\n\n\n\n\n\n图 1: 基础面积图应用\n\n\n\n在 JIS 和 AIS—GO 分子功能中区分肌肉转录组的上调基因的过代表测试。重叠的差异面积图显示了 JIS 和 AIS 组中区分凹凸椎旁肌肉转录组的上调基因的 GO 分子功能的过代表测试的结果。∗高于过度代表检验峰值标记的统计学显著性结果，使用 Bonferroni 多重校正计算的 P &lt; 0.05。 [1]\n\n\n2. 堆叠面积图\n\n\n\n\n\n\n图 2: 堆叠面积图应用\n\n\n\n显示序列数据的 PICRUSt 分析的面积图。 [2]\n\n\n\n\n\n\n图 3: 堆叠面积图应用\n\n\n\n第 14 天和第 28 天的分类学和基因组丰度趋势比较。分类群的相对丰度和功能基因群的预测丰度证明了基因群丰度相对于分类群变化的稳定性。组装分类群和基因组的相对丰度表，并用于在第 14 天和第 28 天生成所有样品的面积图。显示了每个样品的每个已鉴定的分类或功能基因组的相对丰度;（A） 第 14 天预测的基因组，（B） 第 14 天的分类组，（C） 第 28 天的预测基因组，（D） 第 28 天的分类组。在第 14 天，处理之间存在明显的分类学差异 （A），并且少数基因组的丰度变化较小 （B）。在第 28 天，分类学变化 （D） 伴随着基因组丰度 （C） 的少量可见变化。 [3]",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Area Chart"
    ]
  },
  {
    "objectID": "DataOverTime/AreaChart.html#参考文献",
    "href": "DataOverTime/AreaChart.html#参考文献",
    "title": "面积图",
    "section": "参考文献",
    "text": "参考文献\n[1] Nowak R, Kwiecien M, Tkacz M, Mazurek U. Transforming growth factor-beta (TGF- β) signaling in paravertebral muscles in juvenile and adolescent idiopathic scoliosis. Biomed Res Int. 2014;2014:594287. doi: 10.1155/2014/594287. Epub 2014 Sep 15. PMID: 25313366; PMCID: PMC4181945.\n[2] Stewart CJ, Skeath T, Nelson A, Fernstad SJ, Marrs EC, Perry JD, Cummings SP, Berrington JE, Embleton ND. Preterm gut microbiota and metabolome following discharge from intensive care. Sci Rep. 2015 Nov 24;5:17141. doi: 10.1038/srep17141. PMID: 26598071; PMCID: PMC4657104.\n[3] Ballou AL, Ali RA, Mendoza MA, Ellis JC, Hassan HM, Croom WJ, Koci MD. Development of the Chick Microbiome: How Early Exposure Influences Future Microbial Diversity. Front Vet Sci. 2016 Jan 20;3:2. doi: 10.3389/fvets.2016.00002. PMID: 26835461; PMCID: PMC4718982.\n[4] Csardi, G., & Nepusz, T. (2006). igraph: Network analysis and visualization. https://cran.r-project.org/package=igraph\n[5] Wickham, H. (2016). ggraph: An implementation of grammar of graphics for graphs and networks. https://cran.r-project.org/package=ggraph\n[6] Wickham, H., & François, R. (2021). tidyverse: The grammar of data manipulation. https://cran.r-project.org/package=tidyverse\n[7] Geyer, F., & Kolesnyk, I. (2020). CollapsibleTree: Interactive tree diagrams. https://cran.r-project.org/package=CollapsibleTree\n[8] Galili, T. (2015). dendextend: An R package for visualizing, adjusting, and comparing trees. https://cran.r-project.org/package=dendextend\n[9] Garnier, S. (2018). viridis: Default Color Maps from ‘matplotlib’. https://cran.r-project.org/package=viridis\n[10] Aubry, R., & Bouchard, C. (2020). dygraphs: Interactive time series plotting. https://cran.r-project.org/package=dygraphs\n[11] Hornik, K. (2021). xts: Extensible time series. https://cran.r-project.org/package=xts\n[12] Grolemund, G., & Wickham, H. (2011). lubridate: Make dates and times easier to work with. https://cran.r-project.org/package=lubridate\n[13] Wickham, H. (2016). ggplot2: Elegant graphics for data analysis. Springer. https://ggplot2.tidyverse.org\n[14] Wickham, H., & François, R. (2021). dplyr: A Grammar of Data Manipulation. https://cran.r-project.org/package=dplyr\n[15] Wickham, H., & Henry, L. (2021). tidyr: Tidy Messy Data. https://cran.r-project.org/package=tidyr",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Area Chart"
    ]
  },
  {
    "objectID": "Animation/Animation.html",
    "href": "Animation/Animation.html",
    "title": "动画图",
    "section": "",
    "text": "系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：gapminder; ggplot2; gganimate; gifski; Cairo; babynames; hrbrthemes; dplyr; viridis; tidyr;\n\n\n# 安装包\nif (!requireNamespace(\"gapminder\", quietly = TRUE)) {\n  install.packages(\"gapminder\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"gganimate\", quietly = TRUE)) {\n  install.packages(\"gganimate\")\n}\nif (!requireNamespace(\"gifski\", quietly = TRUE)) {\n  install.packages(\"gifski\")\n}\nif (!requireNamespace(\"Cairo\", quietly = TRUE)) {\n  install.packages(\"Cairo\")\n}\nif (!requireNamespace(\"babynames\", quietly = TRUE)) {\n  install.packages(\"babynames\")\n}\nif (!requireNamespace(\"hrbrthemes\", quietly = TRUE)) {\n  install.packages(\"hrbrthemes\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"viridis\", quietly = TRUE)) {\n  install.packages(\"viridis\")\n}\nif (!requireNamespace(\"tidyr\", quietly = TRUE)) {\n  install.packages(\"tidyr\")\n}\n\n# 加载包\nlibrary(gapminder)\nlibrary(ggplot2)\nlibrary(gganimate)\nlibrary(gifski)\nlibrary(Cairo)\nlibrary(babynames)\nlibrary(hrbrthemes)\nlibrary(dplyr)\nlibrary(viridis)\nlibrary(tidyr)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package     * version  date (UTC) lib source\n babynames   * 1.0.1    2021-04-12 [1] RSPM\n Cairo       * 1.7-0    2025-10-29 [1] RSPM\n dplyr       * 1.1.4    2023-11-17 [1] RSPM\n gapminder   * 1.0.1    2025-06-12 [1] RSPM\n gganimate   * 1.0.11   2025-09-04 [1] RSPM\n ggplot2     * 4.0.1    2025-11-14 [1] RSPM\n gifski      * 1.32.0-2 2025-03-18 [1] RSPM\n hrbrthemes  * 0.9.2    2025-11-02 [1] Github (hrbrmstr/hrbrthemes@d3fd029)\n tidyr       * 1.3.2    2025-12-19 [1] RSPM\n viridis     * 0.6.5    2024-01-29 [1] RSPM\n viridisLite * 0.4.2    2023-05-02 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-seedling'></i> Animation",
      "Animation"
    ]
  },
  {
    "objectID": "Animation/Animation.html#环境配置",
    "href": "Animation/Animation.html#环境配置",
    "title": "动画图",
    "section": "",
    "text": "系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：gapminder; ggplot2; gganimate; gifski; Cairo; babynames; hrbrthemes; dplyr; viridis; tidyr;\n\n\n# 安装包\nif (!requireNamespace(\"gapminder\", quietly = TRUE)) {\n  install.packages(\"gapminder\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"gganimate\", quietly = TRUE)) {\n  install.packages(\"gganimate\")\n}\nif (!requireNamespace(\"gifski\", quietly = TRUE)) {\n  install.packages(\"gifski\")\n}\nif (!requireNamespace(\"Cairo\", quietly = TRUE)) {\n  install.packages(\"Cairo\")\n}\nif (!requireNamespace(\"babynames\", quietly = TRUE)) {\n  install.packages(\"babynames\")\n}\nif (!requireNamespace(\"hrbrthemes\", quietly = TRUE)) {\n  install.packages(\"hrbrthemes\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"viridis\", quietly = TRUE)) {\n  install.packages(\"viridis\")\n}\nif (!requireNamespace(\"tidyr\", quietly = TRUE)) {\n  install.packages(\"tidyr\")\n}\n\n# 加载包\nlibrary(gapminder)\nlibrary(ggplot2)\nlibrary(gganimate)\nlibrary(gifski)\nlibrary(Cairo)\nlibrary(babynames)\nlibrary(hrbrthemes)\nlibrary(dplyr)\nlibrary(viridis)\nlibrary(tidyr)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package     * version  date (UTC) lib source\n babynames   * 1.0.1    2021-04-12 [1] RSPM\n Cairo       * 1.7-0    2025-10-29 [1] RSPM\n dplyr       * 1.1.4    2023-11-17 [1] RSPM\n gapminder   * 1.0.1    2025-06-12 [1] RSPM\n gganimate   * 1.0.11   2025-09-04 [1] RSPM\n ggplot2     * 4.0.1    2025-11-14 [1] RSPM\n gifski      * 1.32.0-2 2025-03-18 [1] RSPM\n hrbrthemes  * 0.9.2    2025-11-02 [1] Github (hrbrmstr/hrbrthemes@d3fd029)\n tidyr       * 1.3.2    2025-12-19 [1] RSPM\n viridis     * 0.6.5    2024-01-29 [1] RSPM\n viridisLite * 0.4.2    2023-05-02 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-seedling'></i> Animation",
      "Animation"
    ]
  },
  {
    "objectID": "Animation/Animation.html#数据准备",
    "href": "Animation/Animation.html#数据准备",
    "title": "动画图",
    "section": "数据准备",
    "text": "数据准备\n主要利用R自带数据集和新冠感染数据进行绘图\n\n# data_gapminder\ndata_gapminder &lt;- gapminder\n\n# data_babynames\ndata_babynames &lt;- babynames\n\n# data_covi19\ndata_covi19 &lt;- readr::read_csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/data_covi19.csv\")\ndata_covi19$date &lt;- c(6:12)\ndata_covi19 &lt;- gather(data_covi19, key = \"area\", value = \"cases\", 2:7)\n\n# data_covi19_bar\ndata_covi19_bar_10 &lt;- filter(data_covi19, date == 10)\ndata_covi19_bar_10$frame &lt;- rep(\"a\",6)\n\ndata_covi19_bar_12 &lt;- filter(data_covi19, date == 12)\ndata_covi19_bar_12$frame &lt;- rep(\"b\",6)\n\ndata_covi19_bar &lt;- rbind(data_covi19_bar_10,data_covi19_bar_12)",
    "crumbs": [
      "<i class='fa-solid fa-seedling'></i> Animation",
      "Animation"
    ]
  },
  {
    "objectID": "Animation/Animation.html#可视化",
    "href": "Animation/Animation.html#可视化",
    "title": "动画图",
    "section": "可视化",
    "text": "可视化\n\n1. 散点气泡动画图\n\n1.1 以gapminder数据集为例\n\n#散点气泡动画图----\np &lt;- ggplot(data_gapminder, aes(gdpPercap, lifeExp, size = pop, color = continent)) +\n  geom_point() +\n  scale_x_log10() +\n  theme_bw() +\n  #绘制动画\n  labs(title = 'Year: {frame_time}', x = 'GDP per capita', y = 'life expectancy') +\n  transition_time(year) +\n  ease_aes('linear')\n\nanimate(p, renderer = gifski_renderer())\n\n\n\n\n\n\n\n图 1: 散点气泡动画图\n\n\n\n上图为随着时间变化各地区首都寿命与GDP的散点动画图，其中散点大小表示人口，颜色表示地区。\n\n\n1.2 分组散点气泡动画图\n除了将分组展示在一张图上，还可以分开绘制\n\n# 分组散点气泡图\np &lt;- ggplot(data_gapminder, aes(gdpPercap, lifeExp, size = pop, colour = country)) +\n  geom_point(alpha = 0.7, show.legend = FALSE) +\n  scale_colour_manual(values = country_colors) +\n  scale_size(range = c(2, 12)) +\n  scale_x_log10() +\n  facet_wrap(~continent) +  #按地区填色分组\n  # 绘制动画图\n  labs(title = 'Year: {frame_time}', x = 'GDP per capita', y = 'life expectancy') +\n  transition_time(year) +\n  ease_aes('linear')\n\nanimate(p, renderer = gifski_renderer())\n\n\n\n\n\n\n\n图 2: 分组散点气泡动画图\n\n\n\n上图将不同地区分开绘制。\n\n\n\n2. 区间过渡条形图\n区间过渡条形图可以在两组数据间实现过渡动画。\n\n# 区间过渡条形图----\na &lt;- data.frame(group=c(\"A\",\"B\",\"C\"), values=c(3,2,4), frame=rep('a',3))\nb &lt;- data.frame(group=c(\"A\",\"B\",\"C\"), values=c(5,3,7), frame=rep('b',3))\ndata &lt;- rbind(a,b)  \n\n\n# 区间过渡动画\np &lt;- ggplot(data, aes(x=group, y=values, fill=group)) + \n  geom_bar(stat='identity') +\n  theme_bw() +\n# 绘制动画\n  transition_states(\n    frame,  #frame作为区间依据\n    transition_length = 2,\n    state_length = 1\n  ) +\n  ease_aes('sine-in-out')\n\nanimate(p, renderer = gifski_renderer())\n\n\n\n\n\n\n\n图 3: 区间过渡条形图\n\n\n\n实现两组数据的过渡动画。\n以新冠感染数据为例\n\n#以新冠数据为例\n##筛选数据\ndata_covi19_bar &lt;- subset(data_covi19_bar, cases &gt; 50000)\n\np &lt;- ggplot(data_covi19_bar, aes(x=area, y=cases, fill=area)) + \n  geom_bar(stat='identity') +\n  theme_bw() +\n# 绘制动画\n  transition_states(\n    frame,\n    transition_length = 2,\n    state_length = 1\n  ) +\n  ease_aes('sine-in-out')\n\nanimate(p, renderer = gifski_renderer())\n\n\n\n\n\n\n\n图 4: 以新冠感染数据为例\n\n\n\n上图展示了2020年10月与12月各地区新增感染人数的过渡动画图。\n\n\n3. 动态折线图\n以babynames数据集为例\n\n#动态折线图----\ndon &lt;- data_babynames %&gt;% \n  filter(name %in% c(\"Ashley\", \"Patricia\", \"Helen\")) %&gt;%\n  filter(sex==\"F\")\n\n\n#绘图\ndon %&gt;%\n  ggplot( aes(x=year, y=n, group=name, color=name)) +\n  geom_line() +\n  geom_point() +\n  scale_color_viridis(discrete = TRUE) +\n  ggtitle(\"使用三种名字各年新生儿数的动态折线图\") +\n  theme_ipsum() +\n  ylab(\"Number of babies born\") +\n  transition_reveal(year) #以时间作为动画依据\n\n\n\n\n\n\n\n图 5: 动态折线图\n\n\n\n上图展示了各年使用以上三种名字的新生儿的数量变化动画图。\n以新冠感染数据为例\n\n##新冠数据为例\ndata_covi19 %&gt;%\n  ggplot( aes(x=date, y=cases, group=area, color=area)) +\n  geom_line() +\n  geom_point() +\n  scale_color_viridis(discrete = TRUE) +\n  ggtitle(\"2020年下半年各地区新冠新增感染例数\") +\n  theme_ipsum() +\n  ylab(\"cases\") +\n  xlab(\"month\") +\n  transition_reveal(date) #以时间作为动画依据\n\n\n\n\n\n\n\n图 6: 以新冠感染数据为例\n\n\n\n上图为2020年下半年各地区新冠新增感染例数的折线动画图，横坐标表示月份。",
    "crumbs": [
      "<i class='fa-solid fa-seedling'></i> Animation",
      "Animation"
    ]
  },
  {
    "objectID": "Animation/Animation.html#应用场景",
    "href": "Animation/Animation.html#应用场景",
    "title": "动画图",
    "section": "应用场景",
    "text": "应用场景\n动画图可应用于各种shiny网页，实现数据的动态更新与实况展示。\n\n\n\n\n\n\n图 7: 动画图应用场景\n\n\n\n上图为疫情期间实时展现日本疫情动态的shiny网页工具GitHub - swsoyee/2019-ncov-japan: 🦠 Interactive dashboard for real-time recording of COVID-19 outbreak in Japan\n\n\n\n\n\n\n图 8: 动画图应用场景\n\n\n\n北京大学可视化与可视分析实验室研发的疫情轨迹图。\n上图的疫情轨迹线从病死率和感染人数两个维度出发，以红色方块代表新冠肺炎，将其置于其他传染病的数据中间，为疫情发展给出一个直观的侧写，明确地反映新冠肺炎和其他大规模的流行病之间的差异。",
    "crumbs": [
      "<i class='fa-solid fa-seedling'></i> Animation",
      "Animation"
    ]
  },
  {
    "objectID": "Animation/Animation.html#参考文献",
    "href": "Animation/Animation.html#参考文献",
    "title": "动画图",
    "section": "参考文献",
    "text": "参考文献\n[1] Bryan J (2023). gapminder: Data from Gapminder. R package version 1.0.0, https://CRAN.R-project.org/package=gapminder.\n[2] Bryan J (2023). gapminder: Data from Gapminder. R package version 1.0.0, https://CRAN.R-project.org/package=gapminder.\n[3] H. Wickham. ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York, 2016. Pedersen T, Robinson D (2024). gganimate: A Grammar of Animated Graphics. R package version 1.0.9, https://CRAN.R-project.org/package=gganimate.\n[4] Ooms J, Kornel Lesiński, Authors of the dependency Rust crates (2024). gifski: Highest Quality GIF Encoder. R package version 1.32.0-1, https://CRAN.R-project.org/package=gifski.\n[5] Urbanek S, Horner J (2023). Cairo: R Graphics Device using Cairo Graphics Library for Creating High-Quality Bitmap (PNG, JPEG, TIFF), Vector (PDF, SVG, PostScript) and Display (X11 and Win32) Output. R package version 1.6-2, https://CRAN.R-project.org/package=Cairo.\n[6] Wickham H (2021). babynames: US Baby Names 1880-2017. R package version 1.0.1, https://CRAN.R-project.org/package=babynames.\n[7] Rudis B (2024). hrbrthemes: Additional Themes, Theme Components and Utilities for ‘ggplot2’. R package version 0.8.7, https://CRAN.R-project.org/package=hrbrthemes.\n[8] Wickham H, François R, Henry L, Müller K, Vaughan D (2023). dplyr: A Grammar of Data Manipulation. R package version 1.1.4, https://CRAN.R-project.org/package=dplyr.\n[9] Simon Garnier, Noam Ross, Robert Rudis, Antônio P. Camargo, Marco Sciaini, and Cédric Scherer (2024). viridis(Lite) - Colorblind-Friendly Color Maps for R. viridis package version 0.6.5. Wickham H, Vaughan D, Girlich M (2024). tidyr: Tidy Messy Data. R package version 1.3.1, https://CRAN.R-project.org/package=tidyr.",
    "crumbs": [
      "<i class='fa-solid fa-seedling'></i> Animation",
      "Animation"
    ]
  },
  {
    "objectID": "Composition/PieChart.html",
    "href": "Composition/PieChart.html",
    "title": "饼图",
    "section": "",
    "text": "饼图是统计学的基础图表，用大小不同的扇形区域来表示各项的大小。从饼图中可以直观得了解各项数据在总体数据的比重。",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Pie Chart"
    ]
  },
  {
    "objectID": "Composition/PieChart.html#示例",
    "href": "Composition/PieChart.html#示例",
    "title": "饼图",
    "section": "示例",
    "text": "示例\n\n\n\n\n\n图中是一个非常基础的饼图，不同颜色和大小的扇形区域代表不同项的数据，可以直观看出各组数据在整体数据中的比重。",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Pie Chart"
    ]
  },
  {
    "objectID": "Composition/PieChart.html#环境配置",
    "href": "Composition/PieChart.html#环境配置",
    "title": "饼图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：ggplot2\n\n\n# 安装包\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# 加载包\nlibrary(ggplot2)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package * version date (UTC) lib source\n ggplot2 * 4.0.1   2025-11-14 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Pie Chart"
    ]
  },
  {
    "objectID": "Composition/PieChart.html#数据准备",
    "href": "Composition/PieChart.html#数据准备",
    "title": "饼图",
    "section": "数据准备",
    "text": "数据准备\n数据来自PubMed的论文”The epidemiology of lung cancer in Hungary based on the characteristics of patients diagnosed in 2018”[1]，其中的肺癌分期统计。\n\n# 数据写入，一列分组，一列值\ndata &lt;- data.frame(\n  group = c(\"I\", \"II\", \"III\", \"IV\", \"NA\"),\n  value = c(402, 955, 1252, 3343, 3567)\n)\n\nhead(data)\n\n  group value\n1     I   402\n2    II   955\n3   III  1252\n4    IV  3343\n5    NA  3567",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Pie Chart"
    ]
  },
  {
    "objectID": "Composition/PieChart.html#可视化",
    "href": "Composition/PieChart.html#可视化",
    "title": "饼图",
    "section": "可视化",
    "text": "可视化\n\n1. 基础饼图\n\n# 基本绘图—条形图\np &lt;- ggplot(data, aes(x = \"\", y = value, fill = group)) +\n  geom_col() # 先绘制条形图，再经过coord_polar()变换成饼图\n\np\n\n\n\n\n基本绘图—条形图\n\n\n\n\n绘制条形图是ggplot2绘制饼图的中间步骤，再经过coord_polar()进行坐标极点化就能得到饼图。\n\n# 基础饼图\np &lt;- ggplot(data, aes(x = \"\", y = value, fill = group)) +\n  geom_col() + # 先绘制条形图，再经过coord_polar()变换成饼图\n  coord_polar(theta = \"y\") # 用于绘制饼图\n\np\n\n\n\n\n基础饼图\n\n\n\n\n如图是使用ggplot2绘制的饼图，但是坐标标签和刻度并不必要。\n\n\n2. 简洁饼图\n\n# 使用theme_void()去除grid、backgroundcolor、axis.label等要素\np &lt;- ggplot(data, aes(x = \"\", y = value, fill = group)) +\n  geom_col() +\n  coord_polar(theta = \"y\") +\n  theme_void()\np\n\n\n\n\n简洁饼图\n\n\n\n\n这个饼图去除了grid、backgroundcolor、axis.label等要素，看着更简洁。\n\n\n3. 自定义颜色\n\n# 使用scale_fill_manual()自定义颜色\np &lt;- ggplot(data, aes(x = \"\", y = value, fill = group)) +\n  geom_col() +\n  coord_polar(theta = \"y\") +\n  theme_void() +\n  scale_fill_manual(values = c(\"red\",\"blue\",\"purple\",\"pink\",\"grey\")) # 自定义颜色\np\n\n\n\n\n自定义颜色\n\n\n\n\n这个饼图使用scale_fill_manual()自定义了颜色。注意不要使用scale_color_manual()，图中的扇形区域的颜色是填充颜色。\n\n\n4. 添加标签\n添加标签前，需要计算标签所在位置，因为绘制饼图中只用了y轴值，所以只用计算y轴坐标。饼图是条形图变换而来的，所以只用计算条形图上每个条形的中心y值即可。比如，group=\"I\",依据条形图I组位置，label_loc就等于下面4组高度+I组高度的一半。\n\n# 计算标签位置\ndata$label_loc &lt;- NA # 原始数据框加一列标签位置，初始NA\nfor (i in 1:length(data$group)) { # 循环，计算分组的标签位置\n  locate &lt;- data$value[i] / 2 # 标签位置是该组中心+下面组的高度，下面组高度用循环计算\n  if (i &lt; length(data$group)) {\n    for (j in (i + 1):length(data$group)) {\n      locate &lt;- locate + data$value[j]\n    }\n  }\n  data$label_loc[i] &lt;- locate # 最终获得该组标签位置\n}\n\n# 绘制带标签的饼图\np &lt;- ggplot(data, aes(x = \"\", y = value, fill = group)) +\n  geom_col() +\n  coord_polar(theta = \"y\") +\n  theme_void() +\n  geom_text(aes(y = label_loc, label = group)) + # y是标签的y轴位置，label是标签名称\n  theme(legend.position = \"None\") # 由于将分组作为标签，这里去掉图例\np\n\n\n\n\n添加标签\n\n\n\n\n这个饼图成功加上了标签，但是代码有些麻烦。如果使用python或者R的pie()函数绘制会简单很多。\n\n\n5. 添加百分比标签\n\n# 1.计算标签位置(和上面一致)\ndata$label_loc &lt;- NA # 原始数据框加一列标签位置，初始NA\nfor (i in 1:length(data$group)) { # 循环，计算分组的标签位置\n  locate &lt;- data$value[i] / 2 # 标签位置是该组中心+下面组的高度，下面组高度用循环计算\nif (i &lt; length(data$group)) {\n    for (j in (i + 1):length(data$group)) {\n      locate &lt;- locate + data$value[j]\n    }\n  }\n  data$label_loc[i] &lt;- locate # 最终获得该组标签位置\n}\n# 2.计算百分比\ndata$label &lt;- NA # 原始数据框加一列标签，初始NA\nsum &lt;- sum(data$value) # 总和\nfor (i in 1:length(data$group)) {\n  data$label[i] &lt;- paste0(round(data$value[i] / sum * 100, 1), \"%\") # round()保留1位小数，paste0加上百分号\n}\n\n# 绘制百分比标签饼图\np &lt;- ggplot(data, aes(x = \"\", y = value, fill = group)) +\n  geom_col() +\n  coord_polar(theta = \"y\") +\n  theme_void() +\n  geom_text(aes(y = label_loc, label = label)) # y是标签的y轴位置，label是百分比标签名称\np\n\n\n\n\n添加百分比标签\n\n\n\n\n该饼图图例显示分组，标签显示百分比，显得更加美观和直观。\n\n\n6. 将标签置于饼图外\n有时候分组非常多，这个时候将标签放到饼图内，就会显得很拥挤。\n\n# 以下计算百分比标签和标签位置代码没变\n# 1.计算标签位置(和上面一致)\ndata$label_loc &lt;- NA # 原始数据框加一列标签位置，初始NA\nfor (i in 1:length(data$group)) { # 循环，计算分组的标签位置\n  locate &lt;- data$value[i] / 2 # 标签位置是该组中心+下面组的高度，下面组高度用循环计算\nif (i &lt; length(data$group)) {\n    for (j in (i + 1):length(data$group)) {\n      locate &lt;- locate + data$value[j]\n    }\n  }\n  data$label_loc[i] &lt;- locate # 最终获得该组标签位置\n}\n# 2.计算百分比\ndata$label &lt;- NA # 原始数据框加一列标签，初始NA\nsum &lt;- sum(data$value) # 总和\nfor (i in 1:length(data$group)) {\n  data$label[i] &lt;- paste0(round(data$value[i] / sum * 100, 1), \"%\") # round()保留1位小数，paste0加上百分号\n}\n\n# 在geom_text()调节x值的大小即可实现标签的向内(减小x值)向外(增大x值)移动\np &lt;- ggplot(data, aes(x = \"\", y = value, fill = group)) +\n  geom_col() +\n  coord_polar(theta = \"y\") +\n  theme_void() +\n  geom_text(aes(x = rep_len(1.6, length(group)), y = label_loc, label = label)) # y是标签的y轴位置，label是百分比标签名称\np\n\n\n\n\n将标签置于饼图外\n\n\n\n\n该饼图的标签在饼图外，特别是在分组较多的情况下，饼图会更加美观。\n\n\n7. 添加标签指向饼图的线段\n\n# 以下计算百分比标签和标签位置代码没变\n# 1.计算标签位置(和上面一致)\ndata$label_loc &lt;- NA # 原始数据框加一列标签位置，初始NA\nfor (i in 1:length(data$group)) { # 循环，计算分组的标签位置\n  locate &lt;- data$value[i] / 2 # 标签位置是该组中心+下面组的高度，下面组高度用循环计算\nif (i &lt; length(data$group)) {\n    for (j in (i + 1):length(data$group)) {\n      locate &lt;- locate + data$value[j]\n    }\n  }\n  data$label_loc[i] &lt;- locate # 最终获得该组标签位置\n}\n# 2.计算百分比\ndata$label &lt;- NA # 原始数据框加一列标签，初始NA\nsum &lt;- sum(data$value) # 总和\nfor (i in 1:length(data$group)) {\n  data$label[i] &lt;- paste0(round(data$value[i] / sum * 100, 1), \"%\") # round()保留1位小数，paste0加上百分号\n}\n\n# 在geom_segment()调节x、xend值的大小即可定义线段，其中x值大于饼图半径，xend值略小于标签的坐标，y,yend仍未为标签位置的向量。\np &lt;- ggplot(data, aes(x = \"\", y = value, fill = group)) +\n  geom_col() +\n  coord_polar(theta = \"y\") +\n  theme_void() +\n  geom_text(aes(x = rep_len(1.6, length(group)), y = label_loc, label = label)) + # y是标签的y轴位置，label是百分比标签名称\n  geom_segment(aes(\n    x = rep_len(1.45, length(group)),\n    xend = rep_len(1.58, length(group)),\n    y = label_loc, yend = label_loc\n  ))\np\n\n\n\n\n添加标签指向饼图的线段\n\n\n\n\n该饼图的标签有相应线段指向饼图特定区域，在分组多的情况下不会弄混。",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Pie Chart"
    ]
  },
  {
    "objectID": "Composition/PieChart.html#应用场景",
    "href": "Composition/PieChart.html#应用场景",
    "title": "饼图",
    "section": "应用场景",
    "text": "应用场景\n\n\n\n\n\n\n图 1: 饼图应用1\n\n\n\n图中显示了小细胞肺癌一线治疗失败后的复发模式主要是原发性病变复发（31%），其次是脑转移（17%）、肺或胸膜转移（7%）、骨转移（7%）、肝转移（7%）、纵隔或颈部淋巴结转移（6%）、肾上腺转移（4%）、腹腔淋巴结转移（1%）、胰腺和肠转移（2%）和未知（18%）。[1]\n\n\n\n\n\n\n图 2: 饼图应用2\n\n\n\n图中显示叶酸补充剂的使用和叶酸强化食品的摄入量相当低，75%的参与者报告从未服用过叶酸补充剂。[2]\n\n\n\n\n\n\n图 3: 饼图应用3\n\n\n\n图中表示各国关于TAO的出版物数量，日本发表的相关文章最多（91篇，16.46%），其次是中国（74篇，13.38%）、美国（71篇，12.84%）、土耳其（54篇，9.76%）、伊朗（45篇，8.14%）等。[3]",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Pie Chart"
    ]
  },
  {
    "objectID": "Composition/PieChart.html#参考文献",
    "href": "Composition/PieChart.html#参考文献",
    "title": "饼图",
    "section": "参考文献",
    "text": "参考文献\n[1] ZHOU Y, WU Z, WANG H, et al. Evaluation of the prognosis in patients with small-cell lung cancer treated by chemotherapy using tumor shrinkage rate-based radiomics[J]. Eur J Med Res, 2024,29(1): 401.\n[2] AKWAA H O, IFIE I, NKWONTA C, et al. Knowledge, awareness, and use of folic acid among women of childbearing age living in a peri-urban community in Ghana: a cross-sectional survey[J]. BMC Pregnancy Childbirth, 2024,24(1): 241.\n[3] LIU Z, ZHOU C, GUO H, et al. Knowledge Mapping of Global Status and Trends for Thromboangiitis Obliterans: A Bibliometrics and Visual Analysis[J]. J Pain Res, 2023,16: 4071-4087.",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Pie Chart"
    ]
  },
  {
    "objectID": "Composition/GroupedBarplot.html",
    "href": "Composition/GroupedBarplot.html",
    "title": "分组和堆叠条形图",
    "section": "",
    "text": "分组条形图或聚类条形图用于将单变量或单类别条形图的功能扩展到多变量条形图。在这些图中，条形图根据其类别被分组，颜色是代表其他分类变量的区别因素。条形图被定位为迎合一个组或主要组，颜色代表次要类别。分组条形图特别适合用于显示多组分类数据在不同变量上的分布情况，有助于观察和比较不同分类变量在不同测量项目上的差异。",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Grouped and Stacked Barplot"
    ]
  },
  {
    "objectID": "Composition/GroupedBarplot.html#示例",
    "href": "Composition/GroupedBarplot.html#示例",
    "title": "分组和堆叠条形图",
    "section": "示例",
    "text": "示例\n分组条形图\n\n\n\n\n\n这个图是一个分组柱形图（grouped bar chart），用于展示 iris 数据集中的三种鸢尾花（setosa、versicolor、virginica）在四个不同测量指标上的平均值（即花萼长度、花萼宽度、花瓣长度和花瓣宽度）。x 轴表示测量的四个项目，y 轴（Mean Value）表示这些测量项目的平均值。不同颜色的柱子（Species）：代表三种鸢尾花的种类，分别是 setosa（红色）、versicolor（绿色）和 virginica（蓝色）。每个测量项目下，三种花的平均值以并排柱状图的形式显示。\n堆叠条形图\n\n\n\n\n\n这个图是一个堆叠柱形图（stacked bar chart），展示了 iris 数据集中三种鸢尾花（setosa、versicolor、virginica）在四个不同测量指标上的平均值。柱子堆叠在一起，因此看到的总高度是三个物种的平均值之和。x 轴（Measurement）：和上个图一样，表示四个测量项目（花萼长度、花萼宽度、花瓣长度和花瓣宽度）。y 轴（Mean Value）：表示这些测量项目的总平均值（所有物种的均值堆叠起来）。不同颜色代表三种鸢尾花的不同种类，分别是 setosa（红色）、versicolor（绿色）和 virginica（蓝色）。每个测量项目的总柱高表示三个物种的总均值，而柱子内的不同颜色代表每个物种在该测量项目中的贡献值。",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Grouped and Stacked Barplot"
    ]
  },
  {
    "objectID": "Composition/GroupedBarplot.html#环境配置",
    "href": "Composition/GroupedBarplot.html#环境配置",
    "title": "分组和堆叠条形图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：ggplot2; hrbrthemes; viridis; dplyr; tidyr; tibble; RColorBrewer; streamgraph\n\n\n# 安装包\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"hrbrthemes\", quietly = TRUE)) {\n  install.packages(\"hrbrthemes\")\n}\nif (!requireNamespace(\"viridis\", quietly = TRUE)) {\n  install.packages(\"viridis\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"tidyr\", quietly = TRUE)) {\n  install.packages(\"tidyr\")\n}\nif (!requireNamespace(\"tibble\", quietly = TRUE)) {\n  install.packages(\"tibble\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\nif (!requireNamespace(\"streamgraph\", quietly = TRUE)) {\n  install.packages(\"streamgraph\")\n}\n\n# 加载包\nlibrary(ggplot2)\nlibrary(hrbrthemes)\nlibrary(viridis)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(tibble)\nlibrary(RColorBrewer)\nlibrary(streamgraph)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package      * version date (UTC) lib source\n dplyr        * 1.1.4   2023-11-17 [1] RSPM\n ggplot2      * 4.0.1   2025-11-14 [1] RSPM\n hrbrthemes   * 0.9.2   2025-11-02 [1] Github (hrbrmstr/hrbrthemes@d3fd029)\n RColorBrewer * 1.1-3   2022-04-03 [1] RSPM\n streamgraph  * 0.9.0   2025-11-02 [1] Github (hrbrmstr/streamgraph@76f7173)\n tibble       * 3.3.0   2025-06-08 [1] RSPM\n tidyr        * 1.3.2   2025-12-19 [1] RSPM\n viridis      * 0.6.5   2024-01-29 [1] RSPM\n viridisLite  * 0.4.2   2023-05-02 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Grouped and Stacked Barplot"
    ]
  },
  {
    "objectID": "Composition/GroupedBarplot.html#数据准备",
    "href": "Composition/GroupedBarplot.html#数据准备",
    "title": "分组和堆叠条形图",
    "section": "数据准备",
    "text": "数据准备\n使用R自带数据集iris和UCSC Xena网站(UCSC Xena (xenabrowser.net))的TCGA-CHOL.methylation450.tsv。\n\n# iris\niris_means &lt;- iris %&gt;%\n  group_by(Species) %&gt;%\n  summarise(\n    mean_sepal_length = mean(Sepal.Length),\n    mean_sepal_width = mean(Sepal.Width),\n    mean_petal_length = mean(Petal.Length),\n    mean_petal_width = mean(Petal.Width)\n  ) # 计算每个物种四列的均值\n\niris_means_long &lt;- iris_means %&gt;%\n  pivot_longer(\n    cols = starts_with(\"mean\"),\n    names_to = \"Measurement\",\n    values_to = \"Value\"\n  )\n\niris_means_df &lt;- as.data.frame(iris_means) %&gt;%\n  column_to_rownames(var = \"Species\")\niris_matrix &lt;- as.matrix(iris_means_df)\niris_percentage &lt;- apply(iris_matrix, 2, function(x) { x * 100 / sum(x, na.rm = TRUE) })\n\n# TCGA-CHOL.methylation450\nTCGA_methylation &lt;- readr::read_tsv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/TCGA-CHOL.methylation450_.tsv\")\n\nmethylation_subset &lt;- TCGA_methylation[c(5:9),c(4:13)]\nmethylation_subset &lt;- as.data.frame(methylation_subset)\nrownames(methylation_subset) &lt;- c(\"cg236\", \"cg289\", \"cg292\", \"cg321\", \"cg363\")\ncolnames(methylation_subset) &lt;- substr(colnames(methylation_subset), 9, 12)\n\nmethylation_long &lt;- methylation_subset %&gt;%\n  rownames_to_column(var = \"Composite\") %&gt;%\n  pivot_longer(cols = -Composite, names_to = \"sample\", values_to = \"value\")\n\nmethylation_long$sample &lt;- as.numeric(factor(methylation_long$sample, levels = unique(methylation_long$sample))) # 将sample列转换为有序数值\n\n# TCGA-STAD.star_counts\nTCGA_star &lt;- readr::read_tsv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/TCGA-STAD.star_counts.tsv\")\n\nselected_rows &lt;- TCGA_star[TCGA_star$Ensembl_ID %in% c(\"ENSG00000141510.18\", \n                                                 \"ENSG00000141736.14\", \n                                                 \"ENSG00000121879.6\",\n                                                 \"ENSG00000133703.13\"), ]\nselected_rows &lt;- as.data.frame(selected_rows)\nrownames(selected_rows) &lt;- c(\"PIK3CA\", \"KRAS\", \"TP53\", \"HER2\")\nselected_counts &lt;- selected_rows[,-1]\n\ntumor_counts &lt;- selected_counts %&gt;% select(ends_with(\"01A\"))\nnormal_counts &lt;- selected_counts %&gt;% select(ends_with(\"11A\"))\n\nmean_tumor &lt;- rowMeans(tumor_counts, na.rm = TRUE)\nmean_normal &lt;- rowMeans(normal_counts, na.rm = TRUE)\nmean_values &lt;- data.frame(mean_tumor, mean_normal)\n\nmean_expression_long &lt;- mean_values %&gt;%\n  rownames_to_column(\"Gene\") %&gt;%\n  pivot_longer(cols = -Gene, \n               names_to = \"Measurement\", \n               values_to = \"Mean_Value\")",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Grouped and Stacked Barplot"
    ]
  },
  {
    "objectID": "Composition/GroupedBarplot.html#可视化",
    "href": "Composition/GroupedBarplot.html#可视化",
    "title": "分组和堆叠条形图",
    "section": "可视化",
    "text": "可视化\n\n1. ggplot2（使用iris数据）\nggplot2包可能是构建分组和堆叠条形图的最佳选择。输入数据框需要有 2 个分类变量，这些变量将传递给aes()函数的 x 和 fill 参数。由于 position 参数，从分组切换到堆叠非常容易。\n\n1.1 分组条形图\n\n# 分组条形图\np &lt;- ggplot(iris_means_long, aes(fill = Species, y = Value, x = Measurement)) + \n  geom_bar(position = \"dodge\", stat = \"identity\") +\n  scale_fill_manual(values = c(\"#4A8CC3\", \"#E37939\", \"#8FBC89\")) + \n  labs(x = \"Measurement\", \n       y = \"Mean Value\") + \n  theme_minimal()\n\np\n\n\n\n\n分组条形图\n\n\n\n\n此分组柱形图（grouped bar chart），用于展示 iris 数据集中的三种鸢尾花（setosa、versicolor、virginica）在四个不同测量指标上的平均值（即花萼长度、花萼宽度、花瓣长度和花瓣宽度）。每个测量项目下，三种花的平均值以并排柱状图的形式显示。\n\n\n1.2 堆叠条形图\n堆叠条形图与分组条形图非常相似。但是堆叠条形图的子组彼此叠在一起显示，而不是并排显示。将分组条形图的position参数改为stack即可获得堆叠条形图。\n\n# 堆叠条形图\np &lt;- ggplot(iris_means_long, aes(fill = Species, y = Value, x = Measurement)) + \n  geom_bar(position = \"stack\", stat = \"identity\") +\n  scale_fill_manual(values = c(\"#4A8CC3\", \"#E37939\", \"#8FBC89\")) + \n  labs(x = \"Measurement\", \n       y = \"Mean Value\") + \n  theme_minimal()\n\np\n\n\n\n\n堆叠条形图\n\n\n\n\n此图是一个堆叠条形图，显示了三种鸢尾花（setosa、versicolor、virginica）在四个不同测量指标（花萼长度、花萼宽度、花瓣长度、花瓣宽度）上的平均值。每个柱子代表一个测量指标，柱子内不同颜色的部分代表各物种的平均值贡献。在此堆叠条形图中可以比较不同测量指标的总均值大小，以及每个物种在各测量项目中的相对贡献。\n\n\n1.3 百分比堆叠条形图\n只需将参数切换到position=\"fill\"就可以绘制百分比堆叠条形图。在百分比堆叠条形图中，每个子组的百分比都已表示出来，可以研究它们在整体中的比例演变。\n\n# 百分比堆叠条形图\np &lt;- ggplot(iris_means_long, aes(fill = Species, y = Value, x = Measurement)) + \n  geom_bar(position = \"fill\", stat = \"identity\") +\n  scale_fill_manual(values = c(\"#4A8CC3\", \"#E37939\", \"#8FBC89\")) + \n  labs(x = \"Measurement\", \n       y = \"Mean Value\") + \n  theme_minimal()\n\np\n\n\n\n\n百分比堆叠条形图\n\n\n\n\n此百分比堆叠条形图展示了不同鸢尾花物种（setosa、versicolor 和 virginica）在各个测量指标（如花萼长度、花萼宽度、花瓣长度和花瓣宽度）上的相对平均值。通过使用堆叠填充的方式，图表直观地显示了每个物种在各个测量中的相对贡献，帮助我们理解不同物种之间的特征差异。这种可视化方式便于识别各物种的主要特征，有助于进一步的分类和比较分析。\n\n\n1.4 分组条形图自定义\n可以对图片进行一些自定义，以使图形看起来更更个性化。在下面的示例中，进行了下列自定义：\n\n添加标题\n使用主题\n更改调色板\n自定义轴标题\n改变字体大小\n\n\n# 分组条形图自定义\np &lt;- ggplot(iris_means_long, aes(fill=Species, y=Value, x=Measurement)) + \n  geom_bar(position=\"stack\", stat=\"identity\") +\n  scale_fill_viridis(discrete = TRUE) + # 调色板\n  labs(title = \"Grouped Barchart of Iris Means\",  # 标题\n       x = \"Measurement\", \n       y = \"Mean Value\") + # 轴标题\n  theme_ipsum() + # 主题\n  theme(axis.text.x = element_text(size = 10)) + # 字体大小\n  xlab(\"\")\n\np\n\n\n\n\n分组条形图自定义\n\n\n\n\n此分组柱形图展示了 iris 数据集中的三种鸢尾花（setosa、versicolor、virginica）在四个不同测量指标上的平均值（即花萼长度、花萼宽度、花瓣长度和花瓣宽度）。每个测量项目下，三种花的平均值以并排柱状图的形式显示。自定义图片使图形更美观，提升了数据的可读性、对比性。\n\n添加数值标注\n\n使用 geom_text() 添加数值标注\n\n# 分组条形图自定义\np &lt;- ggplot(iris_means_long, aes(fill = Species, y = Value, x = Measurement)) + \n  geom_bar(position = \"stack\", stat = \"identity\") +\n  scale_fill_viridis(discrete = TRUE) + # 调色板\n  labs(title = \"Grouped Barchart of Iris Means\",  # 标题\n       x = \"Measurement\", \n       y = \"Mean Value\") + # 轴标题\n  theme_ipsum() + # 主题\n  theme(axis.text.x = element_text(size = 10)) + \n  xlab(\"\") +\n  geom_text(aes(label = round(Value, 2)), \n            position = position_stack(vjust = 0.5), \n            color = \"white\", \n            size = 4) # 添加数值标注\n\np\n\n\n\n\n添加数值标注\n\n\n\n\n此分组柱形图展示了 iris 数据集中的三种鸢尾花（setosa、versicolor、virginica）在四个不同测量指标上的平均值（即花萼长度、花萼宽度、花瓣长度和花瓣宽度）。每个测量项目下，三种花的平均值以并排柱状图的形式显示。添加数值标注提升了数据的直观性和可读性。\n\n\n1.5 分面直方图\n可以使用分面直方图来代替堆叠或分组直方图。借助facet_wrap()函数可以很简单地绘制分面直方图 。\n\n# 分面直方图\np &lt;- ggplot(iris_means_long, aes(fill = Species, y = Value, x = Measurement)) + \n  geom_bar(position = \"dodge\", stat = \"identity\") +\n  labs(x = \"Measurement\", \n       y = \"Mean Value\") + \n  facet_wrap(~Species) +\n  theme_minimal() +\n  scale_fill_manual(values = c(\"#F1C89A\", \"#E79397\", \"#A797DA\")) + \n  theme(axis.text.x = element_text(size = 6),\n        strip.text = element_blank()) +  \n  xlab(\"\")\n\np\n\n\n\n\n分面直方图\n\n\n\n\n这个分面柱形图 将三个不同花种 (setosa、versicolor、virginica) 的数据分成三个独立的子图，每个子图分别展示该物种在四个测量指标上的平均值。每个子图中，四个测量指标（花萼长度、花萼宽度、花瓣长度和花瓣宽度）以并排柱状图的形式呈现，让我们能够在物种内部更清楚地分析各个测量指标的差异。\n\n\n\n2. ggplot2（使用TCGA数据）\nggplot2包可能是构建分组和堆叠条形图的最佳选择。输入数据框需要有 2 个分类变量，这些变量将传递给aes()函数的 x 和 fill 参数。由于 position 参数，从分组切换到堆叠非常容易。\n\n2.1 分组条形图\n\n# 分组条形图\np &lt;- ggplot(mean_expression_long, aes(fill = Measurement, y = Mean_Value, x = Gene)) + \n  geom_bar(position = \"dodge\", stat = \"identity\") +\n  labs(x = \"Gene\", \n       y = \"Mean Value\") + \n  theme_minimal()\n\np\n\n\n\n\n分组条形图\n\n\n\n\n此分组条形图展示了不同基因（PIK3CA、KRAS、TP53 和 HER2）在TCGA-STAD.star_counts数据集的肿瘤和正常样本中的平均表达水平。图中通过不同的填充颜色区分了肿瘤样本和正常样本，便于比较这些基因在两种状态下的表达差异。这种可视化有助于揭示肿瘤生物学中基因的潜在作用，为后续研究提供重要的信息。\n\n\n2.2 堆叠条形图\n\n# 堆叠条形图\np &lt;- ggplot(mean_expression_long, aes(fill = Measurement, y = Mean_Value, x = Gene)) + \n  geom_bar(position = \"stack\", stat = \"identity\") +\n  labs(x = \"Gene\", \n       y = \"Mean Value\") + \n  theme_minimal()\n\np\n\n\n\n\n堆叠条形图\n\n\n\n\n此堆叠条形图，显示了不同基因（PIK3CA、KRAS、TP53 和 HER2）在TCGA-STAD.star_counts数据集的肿瘤和正常样本中的平均表达水平。图中通过不同的填充颜色区分了肿瘤样本和正常样本，便于比较这些基因在两种状态下的表达差异。在此堆叠条形图中可以比较不同测量指标的总均值大小，以及每个物种在各测量项目中的相对贡献。\n\n\n\n3. 基础 R\n借助R自带的函数绘制分组和堆叠条形图。\n\n3.1 分组条形图\n输入数据集必须是数字矩阵。每个组都是一列。每个子组都是一行。barplot()函数将识别此格式，并自动分组。beside参数允许在分组条形图和堆叠条形图之间切换。\n\n# 分组条形图\nbarplot(iris_matrix, \n        col = colors()[c(23, 89, 12)], \n        border = \"white\", \n        font.axis = 2, \n        beside = TRUE, \n        legend.text = rownames(iris_matrix), \n        ylab = \"Mean Value\",\n        font.lab = 2)\n\n\n\n\n分组条形图\n\n\n\n\n此分组条形图展示了 iris 中三种鸢尾花 (setosa、versicolor、virginica) 在四个不同测量指标上的平均值（花萼长度、花萼宽度、花瓣长度和花瓣宽度）。每个测量指标由并排的三根柱子表示，分别对应三种不同物种的平均值。通过颜色区分三种物种，图表直观地展示了它们在各个测量指标上的差异。可以清晰地看到不同物种在某些特征上的显著差异。\n\n\n3.2 堆叠条形图\n堆叠条形图与分组条形图非常相似。子组只是彼此叠放，而不是并排显示。堆叠条形图是 barplot()基础 R 中函数的默认选项，因此您无需使用beside参数。\n\n# 堆叠条形图\nbarplot(iris_matrix, \n        col = colors()[c(23, 89, 12)], \n        border = \"white\", \n        font.axis = 2, \n        legend.text = rownames(iris_matrix), \n        ylab = \"Mean Value\",\n        font.lab = 2)\n\n\n\n\n堆叠条形图\n\n\n\n\n此图是一个堆叠条形图，显示了三种鸢尾花（setosa、versicolor、virginica）在四个不同测量指标（花萼长度、花萼宽度、花瓣长度、花瓣宽度）上的平均值。每个柱子代表一个测量指标，柱子内不同颜色的部分代表各物种的平均值贡献。在此堆叠条形图中可以比较不同测量指标的总均值大小，以及每个物种在各测量项目中的相对贡献。\n\n\n3.3 百分比堆叠条形图\n百分比堆积条形图显示每个子组比例的演变，总和始终等于 100%。在基础 R 中，需要使用apply()函数手动计算百分比。使用ggplot2绘制百分比堆叠条形图更简单。\n\n# 百分比堆叠条形图\ncoul &lt;- brewer.pal(3, \"Pastel2\") \nbarplot(iris_percentage, \n        col = coul,  \n        border = \"white\", \n        ylab = \"Mean Value\", \n        legend.text = rownames(iris_percentage)) \n\n\n\n\n百分比堆叠条形图\n\n\n\n\n这个堆叠柱状图展示了 iris 数据集中三种鸢尾花（setosa、versicolor 和 virginica）在四个特征（花萼长度、花萼宽度、花瓣长度和花瓣宽度）上的百分比分布。每个柱子表示一个特定的特征，颜色代表不同的物种。通过将物种的数据堆叠在一起，图表反映了每个物种在各个特征上的比例关系。图中可以看出，virginica 在花瓣相关特征上占据较大比例，而 setosa 则在花萼宽度上的比例更大。这个图表清晰地展示了各物种在各项特征上的相对表现。",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Grouped and Stacked Barplot"
    ]
  },
  {
    "objectID": "Composition/GroupedBarplot.html#应用场景",
    "href": "Composition/GroupedBarplot.html#应用场景",
    "title": "分组和堆叠条形图",
    "section": "应用场景",
    "text": "应用场景\n\n1. 分组条形图\n\n\n\n\n\n\n图 1: 分组条形图应用\n\n\n\n与文献中已知特征的性能比较。 [1]\n\n\n2. 堆积条形图\n\n\n\n\n\n\n图 2: 堆积条形图应用\n\n\n\nMamI-GFP 在几种突变体中的定位和突变 MamL-GFP 的互补/定位测定。 [2]\n\n\n3. 圆形堆积条形图\n\n\n\n\n\n\n图 3: 圆形堆积条形图应用\n\n\n\n健康血浆中的组织特异性蛋白。 [3]\n\n\n4. 流图\n\n\n\n\n\n\n图 4: 流图应用\n\n\n\n2 名受试者的肠道和唾液微生物群动态超过 1 年。（A） 显示 OTU 分数丰度随时间变化的流图。每个流代表一个 OTU，流按门分组：厚壁菌门（紫色）、拟杆菌门（蓝色）、变形菌门（绿色）、放线菌门（黄色）和 Tenericutes（红色）。流宽度反映了给定时间点的相对 OTU 丰度。采样的时间点在每个流图上用灰点表示。（B） 大多数常见 OTU 丰度随时间变化的水平图。水平图可以在众多时间序列之间进行快速的视觉比较。首先将每个 OTU 时间序列以中位数居中，然后将曲线划分为宽度为中位数绝对偏差的彩色条带，从而制作图表。接下来，叠加彩色条带并向上镜像负值。因此，较暖的区域表示分类单元超过其中位数丰度的日期范围，而较冷的区域表示分类单元低于其中位数丰度的范围。纵轴上的彩色方块对应于 （A） 中的流颜色。 [4]",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Grouped and Stacked Barplot"
    ]
  },
  {
    "objectID": "Composition/GroupedBarplot.html#参考文献",
    "href": "Composition/GroupedBarplot.html#参考文献",
    "title": "分组和堆叠条形图",
    "section": "参考文献",
    "text": "参考文献\n[1] Eichner J, Kossler N, Wrzodek C, Kalkuhl A, Bach Toft D, Ostenfeldt N, Richard V, Zell A. A toxicogenomic approach for the prediction of murine hepatocarcinogenesis using ensemble feature selection. PLoS One. 2013 Sep 10;8(9):e73938. doi: 10.1371/journal.pone.0073938. PMID: 24040119; PMCID: PMC3769381.\n[2] Raschdorf O, Forstner Y, Kolinko I, Uebe R, Plitzko JM, Schüler D. Genetic and Ultrastructural Analysis Reveals the Key Players and Initial Steps of Bacterial Magnetosome Membrane Biogenesis. PLoS Genet. 2016 Jun 10;12(6):e1006101. doi: 10.1371/journal.pgen.1006101. PMID: 27286560; PMCID: PMC4902198.\n[3] Malmström E, Kilsgård O, Hauri S, Smeds E, Herwald H, Malmström L, Malmström J. Large-scale inference of protein tissue origin in gram-positive sepsis plasma using quantitative targeted proteomics. Nat Commun. 2016 Jan 6;7:10261. doi: 10.1038/ncomms10261. PMID: 26732734; PMCID: PMC4729823.\n[4] David LA, Materna AC, Friedman J, Campos-Baptista MI, Blackburn MC, Perrotta A, Erdman SE, Alm EJ. Host lifestyle affects human microbiota on daily timescales. Genome Biol. 2014;15(7):R89. doi: 10.1186/gb-2014-15-7-r89. Erratum in: Genome Biol. 2016 May 31;17(1):117. doi: 10.1186/s13059-016-0988-y. PMID: 25146375; PMCID: PMC4405912.\n[5] Wickham, H. (2016). ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York. https://ggplot2.tidyverse.org\n[6] Garnier, S. (2018). viridis: Colorblind-Friendly Color Maps for R. https://cran.r-project.org/package=viridis\n[7] Wickham, H., François, R., Henry, L., Müller, K. (2023). dplyr: A Grammar of Data Manipulation. https://cran.r-project.org/package=dplyr\n[8] Wickham, H., Henry, L. (2023). tidyr: Tidy Messy Data. https://cran.r-project.org/package=tidyr\n[9] Müller, K. (2023). tibble: Simple Data Frames. https://cran.r-project.org/package=tibble\n[10] Neuwirth, E. (2023). RColorBrewer: ColorBrewer Palettes. https://cran.r-project.org/package=RColorBrewer\n[11] Rudis, B. (2022). streamgraph: Create Streamgraphs and Streamgraph htmlwidgets. https://cran.r-project.org/package=streamgraph",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Grouped and Stacked Barplot"
    ]
  },
  {
    "objectID": "Composition/Treemap.html",
    "href": "Composition/Treemap.html",
    "title": "矩形树图",
    "section": "",
    "text": "矩形树图(Treemap)也叫矩形式树状结构图，它采用多组面积不等的矩形嵌套而成。所有矩形的面积之和代表了总体数据。各个小矩形的面积表示每个子项的占比，矩形面积越大，表示子数据在整体中的占比越大。",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Treemap"
    ]
  },
  {
    "objectID": "Composition/Treemap.html#示例",
    "href": "Composition/Treemap.html#示例",
    "title": "矩形树图",
    "section": "示例",
    "text": "示例\n\n\n\n\n\n矩形树图适合展现具有层级关系的数据，能够直观体现同级之间的比较(矩形树图使用不同颜色和大小的长方形来显示数据的层次结构。",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Treemap"
    ]
  },
  {
    "objectID": "Composition/Treemap.html#环境配置",
    "href": "Composition/Treemap.html#环境配置",
    "title": "矩形树图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：treemap; tidyverse; stats; DOSE\n\n\n# 安装包\nif (!requireNamespace(\"treemap\", quietly = TRUE)) {\n  install.packages(\"treemap\")\n}\nif (!requireNamespace(\"tidyverse\", quietly = TRUE)) {\n  install.packages(\"tidyverse\")\n}\nif (!requireNamespace(\"stats\", quietly = TRUE)) {\n  install.packages(\"stats\")\n}\nif (!requireNamespace(\"DOSE\", quietly = TRUE)) {\n  install.packages(\"DOSE\")\n}\n\n# 加载包\nlibrary(treemap)\nlibrary(tidyverse)\nlibrary(stats)\nlibrary(DOSE)\nlibrary(palmerpenguins)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package        * version date (UTC) lib source\n DOSE           * 4.4.0   2025-10-29 [1] Bioconduc~\n dplyr          * 1.1.4   2023-11-17 [1] RSPM\n forcats        * 1.0.1   2025-09-25 [1] RSPM\n ggplot2        * 4.0.1   2025-11-14 [1] RSPM\n lubridate      * 1.9.4   2024-12-08 [1] RSPM\n palmerpenguins * 0.1.1   2022-08-15 [1] RSPM\n purrr          * 1.2.0   2025-11-04 [1] RSPM\n readr          * 2.1.6   2025-11-14 [1] RSPM\n stringr        * 1.6.0   2025-11-04 [1] RSPM\n tibble         * 3.3.0   2025-06-08 [1] RSPM\n tidyr          * 1.3.2   2025-12-19 [1] RSPM\n tidyverse      * 2.0.0   2023-02-22 [1] RSPM\n treemap        * 2.4-4   2023-05-25 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Treemap"
    ]
  },
  {
    "objectID": "Composition/Treemap.html#数据准备",
    "href": "Composition/Treemap.html#数据准备",
    "title": "矩形树图",
    "section": "数据准备",
    "text": "数据准备\n\ndata_USArrests &lt;- rownames_to_column(USArrests[1:8,], \"State\")\n\ndata_swiss &lt;- swiss\n\ndata_countsub &lt;- aggregate(penguins, by=list(penguins$species, penguins$sex),length)\ndata_countsub &lt;- data_countsub[ ,1:3]\ncolnames(data_countsub) &lt;- c(\"species\", \"sex\", \"count\")\n\ndata_BP &lt;- readr::read_csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/data_BP.csv\")\ndata_BP &lt;- data_BP[order(abs(data_BP$NES), decreasing = T),]\ndata_BP &lt;- data_BP[1:13,]\n\ndata_KEGG_type &lt;- readr::read_csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/data_KEGG.csv\")\ndata_KEGG_type$pvalue_log &lt;- -log10(data_KEGG_type$pvalue)",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Treemap"
    ]
  },
  {
    "objectID": "Composition/Treemap.html#可视化",
    "href": "Composition/Treemap.html#可视化",
    "title": "矩形树图",
    "section": "可视化",
    "text": "可视化\n\n1. 单一变量分类\n\n1.1 依据标签填色\n以USArrests数据集为例\n\ntreemap(data_USArrests, # 数据\n        index = \"State\", # 分类变量\n        vSize = \"Murder\", # 分类变量对应数据值\n        vColor=\"State\", # 颜色深浅的对应列，这里以数据大小作为对应\n        type = \"index\", # \"颜色映射方式,\"index\"、\"value\"、\"comp\"、\"dens\"、\"depth\"、\"categorical\"、\"color\"、\"manual\"\n        title = 'Murder', # 标题\n        border.col = \"grey\", # 边框颜色\n        border.lwds = 4, # 边框线宽度\n        fontsize.labels = 12, # 标签大小\n        fontcolor.labels = 'red', # 标签颜色\n        align.labels = list(c(\"center\", \"center\")), # 标签位置\n        fontface.labels = 2) # 标签字体：1,2,3,4 表示正常、粗体、斜体、粗斜体\n\n\n\n\n\n\n\n图 1: 依据标签填色\n\n\n\n\n\n上图展示了美国不同州犯罪被捕人数比例的矩形树图，以州作为填色依据。\n\n\n1.2 依据数据大小填色\n以USArrests数据集为例\n\ntreemap(data_USArrests, \n        index = \"State\",\n        vSize = \"Murder\",\n        vColor=\"Murder\",\n        type = \"value\",\n        title = 'Murder',\n        border.col = \"grey\",\n        border.lwds = 4,\n        fontsize.labels = 12,\n        fontcolor.labels = 'red',\n        align.labels = list(c(\"center\", \"center\")),\n        fontface.labels = 2)\n\n\n\n\n\n\n\n图 2: 依据数据大小填色\n\n\n\n\n\n上图展示了美国不同州犯罪被捕人数比例的矩形树图，以各组数据大小作为填色依据。\n以小鼠肺组织使用顺铂前后的差异基因对应的HALLMARK分析结果数据为例：\n\ntreemap(data_BP[1:13,], \n        index = \"BP\",\n        vSize = \"pvalue_log\",\n        vColor=\"NES\",\n        type = \"value\",\n        title = 'Biological Process',\n        border.col = \"grey\",\n        border.lwds = 4,\n        fontsize.labels = 10,\n        fontcolor.labels = 'white',\n        align.labels = list(c(\"center\", \"center\")),\n        fontface.labels = 2)\n\n\n\n\n\n\n\n图 3: HALLMARK分析结果数据\n\n\n\n\n\n上图展示了小鼠肺组织使用顺铂前后的差异基因HALLMARK分析的结果，矩形大小表示log10（P）的负值，矩形越大表示结果越可靠。矩形颜色表示NES值。\n\n\n\n2. 多变量分类\n利用index = c(\"Group1”,\"Group2\", ...)实现多层级分组\n\n2.1 依据数据标签填色\n以penguins数据集为例\n\ntreemap(data_countsub, \n        index = c(\"sex\",\"species\"),\n        vSize = \"count\",\n        vColor=\"species\",\n        type = \"index\",\n        title = 'Count',\n        border.col = c(\"black\",\"white\"),\n        border.lwds = c(4,1),\n        fontsize.labels = c(18,10),\n        bg.labels=c(\"transparent\"),\n        fontcolor.labels = c('white',\"orange\"),\n        align.labels = list(c(\"left\", \"top\"),\n                            c(\"center\", \"center\")),\n        fontface.labels = c(2,3))\n\n\n\n\n\n\n\n图 4: 依据数据标签填色\n\n\n\n\n\n上图展示了penguins数据集中企鹅以性别与种类为依据分组的计数，上图以分类作为填色依据。\n\n\n2.2 依据数据大小填色\n以penguins数据集为例\n\ntreemap(data_countsub, \n        index = c(\"sex\",\"species\"),\n        vSize = \"count\",\n        vColor=\"count\",\n        type = \"value\",\n        title = 'Count',\n        border.col = c(\"black\",\"white\"),\n        border.lwds = c(4,1),\n        fontsize.labels = c(18,10),\n        bg.labels=c(\"transparent\"),\n        fontcolor.labels = c('white',\"orange\"),\n        align.labels = list(c(\"left\", \"top\"),\n                            c(\"center\", \"center\")),\n        fontface.labels = c(2,3))\n\n\n\n\n\n\n\n图 5: 依据数据大小填色\n\n\n\n\n\n上图展示了penguins数据集中企鹅以性别与种类为依据分组的计数，上图以计数的多少作为填色依据。\n以小鼠肺组织使用顺铂前后的差异基因对应的通路分析结果数据为例\n\ntreemap(data_KEGG_type, \n        index = c(\"type\",\"subtype\",\"PW\"),\n        vSize = \"pvalue_log\",\n        vColor=\"NES\",\n        type = \"value\",\n        title = 'KEGG通路分析结果',\n        border.col = c(\"black\",\"white\",\"orange\"),\n        border.lwds = c(4,1),\n        fontsize.labels = c(18,15,10),\n        bg.labels=c(\"transparent\"),\n        fontcolor.labels = c('black',\"white\",\"orange\"),\n        align.labels = list(c(\"left\", \"top\"),\n                            c(\"center\", \"center\"),\n                            c(\"left\",\"bottom\")),\n        fontface.labels = c(2,3))\n\n\n\n\n\n\n\n图 6: KEGG通路分析结果数据\n\n\n\n\n\n上图展示了小鼠肺组织使用顺铂前后的差异基因对应的KEGG通路分析结果。上图展示了通路的多级分类，矩形大小表示log10（P）的负值，矩形越大表示结果越可靠。矩形颜色表示NES值。",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Treemap"
    ]
  },
  {
    "objectID": "Composition/Treemap.html#应用场景",
    "href": "Composition/Treemap.html#应用场景",
    "title": "矩形树图",
    "section": "应用场景",
    "text": "应用场景\n\n\n\n\n\n\n图 7: 矩形树图应用1\n\n\n\n上图为β-连环蛋白网络的GO生物过程项的功能富集。前十个集群中最丰富的项显示在树图中，以不同的颜色块表示。对于每个项，方框大小反映了项浓缩的p值。[1]\n\n\n\n\n\n\n图 8: 矩形树图应用2\n\n\n\n上图为上调和下调基因的基因分析。使用BiNGO对上调和下调基因进行基因分析，将存在论项和相关的更正p值传递给REVIGO，REVIGO通过删除多余的GO项来执行总结。\n生成与（a）上调和（b）下调基因相关的功能注释的树图。[2]",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Treemap"
    ]
  },
  {
    "objectID": "Composition/Treemap.html#参考文献",
    "href": "Composition/Treemap.html#参考文献",
    "title": "矩形树图",
    "section": "参考文献",
    "text": "参考文献\n[1] Çelen İ, Ross KE, Arighi CN, Wu CH. Bioinformatics Knowledge Map for Analysis of Beta-Catenin Function in Cancer. PLoS One. 2015 Oct 28;10(10):e0141773. doi: 10.1371/journal.pone.0141773. PMID: 26509276; PMCID: PMC4624812.\n[2] Corley SM, Canales CP, Carmona-Mora P, Mendoza-Reinosa V, Beverdam A, Hardeman EC, Wilkins MR, Palmer SJ. RNA-Seq analysis of Gtf2ird1 knockout epidermal tissue provides potential insights into molecular mechanisms underpinning Williams-Beuren syndrome. BMC Genomics. 2016 Jun 13;17:450. doi: 10.1186/s12864-016-2801-4. PMID: 27295951; PMCID: PMC4907016.\n[3] Tennekes M (2023). treemap: Treemap Visualization. R package version 2.4-4, https://CRAN.R-project.org/package=treemap.\n[4] Wickham H, Averick M, Bryan J, Chang W, McGowan LD, François R, Grolemund G, Hayes A, Henry L, Hester J, Kuhn M, Pedersen TL, Miller E, Bache SM, Müller K, Ooms J, Robinson D, Seidel DP, Spinu V, Takahashi K, Vaughan D, Wilke C, Woo K, Yutani H (2019). “Welcome to the tidyverse.” Journal of Open Source Software, 4(43), 1686. doi:10.21105/joss.01686 https://doi.org/10.21105/joss.01686.\n[5] R Core Team (2024). R: A Language and Environment for Statistical Computing. R Foundation for Statistical Computing, Vienna, Austria. https://www.R-project.org/.",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Treemap"
    ]
  },
  {
    "objectID": "Composition/CircularPacking.html",
    "href": "Composition/CircularPacking.html",
    "title": "包珠图",
    "section": "",
    "text": "包珠图（Circular Packing），可视为一种特殊的分类树状图，特别适合展示具有层级关系的分类数据。",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Circular Packing Chart"
    ]
  },
  {
    "objectID": "Composition/CircularPacking.html#示例",
    "href": "Composition/CircularPacking.html#示例",
    "title": "包珠图",
    "section": "示例",
    "text": "示例",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Circular Packing Chart"
    ]
  },
  {
    "objectID": "Composition/CircularPacking.html#环境配置",
    "href": "Composition/CircularPacking.html#环境配置",
    "title": "包珠图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：packcircles; ggplot2; dplyr; tidyr; viridis; ggiraph; ggiraph; htmlwidgets; ggraph; igraph; tidyverse; flare; cowplot; circlepackeR; data.tree\n\n\n# 安装包\nif (!requireNamespace(\"packcircles\", quietly = TRUE)) {\n  install.packages(\"packcircles\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"viridis\", quietly = TRUE)) {\n  install.packages(\"viridis\")\n}\nif (!requireNamespace(\"ggiraph\", quietly = TRUE)) {\n  install.packages(\"ggiraph\")\n}\nif (!requireNamespace(\"htmlwidgets\", quietly = TRUE)) {\n  install.packages(\"htmlwidgets\")\n}\nif (!requireNamespace(\"ggraph\", quietly = TRUE)) {\n  install.packages(\"ggraph\")\n}\nif (!requireNamespace(\"igraph\", quietly = TRUE)) {\n  install.packages(\"igraph\")\n}\nif (!requireNamespace(\"tidyverse\", quietly = TRUE)) {\n  install.packages(\"tidyverse\")\n}\nif (!requireNamespace(\"flare\", quietly = TRUE)) {\n  install.packages(\"flare\")\n}\nif (!requireNamespace(\"cowplot\", quietly = TRUE)) {\n  install.packages(\"cowplot\")\n}\nif (!requireNamespace(\"circlepackeR\", quietly = TRUE)) {\n  remotes::install_github(\"jeromefroe/circlepackeR\")\n}\nif (!requireNamespace(\"data.tree\", quietly = TRUE)) {\n  install.packages(\"data.tree\")\n}\n\n# 加载包\nlibrary(packcircles)\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(viridis)\nlibrary(ggiraph)\nlibrary(htmlwidgets)\nlibrary(ggraph)\nlibrary(igraph)\nlibrary(tidyverse)\nlibrary(flare)\nlibrary(cowplot)\nlibrary(circlepackeR) \nlibrary(data.tree)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package      * version    date (UTC) lib source\n circlepackeR * 0.0.0.9000 2025-11-02 [1] Github (jeromefroe/circlepackeR@f0a84d5)\n cowplot      * 1.2.0      2025-07-07 [1] RSPM\n data.tree    * 1.2.0      2025-08-25 [1] RSPM\n dplyr        * 1.1.4      2023-11-17 [1] RSPM\n flare        * 1.7.0.2    2024-11-04 [1] RSPM\n forcats      * 1.0.1      2025-09-25 [1] RSPM\n ggiraph      * 0.9.2      2025-10-07 [1] RSPM\n ggplot2      * 4.0.1      2025-11-14 [1] RSPM\n ggraph       * 2.2.2      2025-08-24 [1] RSPM\n htmlwidgets  * 1.6.4      2023-12-06 [1] RSPM\n igraph       * 2.2.1      2025-10-27 [1] RSPM\n lattice      * 0.22-7     2025-04-02 [3] CRAN (R 4.5.2)\n lubridate    * 1.9.4      2024-12-08 [1] RSPM\n MASS         * 7.3-65     2025-02-28 [3] CRAN (R 4.5.2)\n Matrix       * 1.7-4      2025-08-28 [3] CRAN (R 4.5.2)\n packcircles  * 0.3.7      2024-11-21 [1] RSPM\n purrr        * 1.2.0      2025-11-04 [1] RSPM\n readr        * 2.1.6      2025-11-14 [1] RSPM\n stringr      * 1.6.0      2025-11-04 [1] RSPM\n tibble       * 3.3.0      2025-06-08 [1] RSPM\n tidyr        * 1.3.2      2025-12-19 [1] RSPM\n tidyverse    * 2.0.0      2023-02-22 [1] RSPM\n viridis      * 0.6.5      2024-01-29 [1] RSPM\n viridisLite  * 0.4.2      2023-05-02 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Circular Packing Chart"
    ]
  },
  {
    "objectID": "Composition/CircularPacking.html#数据准备",
    "href": "Composition/CircularPacking.html#数据准备",
    "title": "包珠图",
    "section": "数据准备",
    "text": "数据准备\n\n#GO BP\ndata_BP &lt;- readr::read_csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/data_BP.csv\")\n\n#flare\ndata_edges &lt;- flare$edges\ndata_vertices &lt;- flare$vertices\n\n#KEGG\ndata_KEGG &lt;- readr::read_csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/data_KEGG.csv\")\n\n#KEGG_type\ndata_KEGG_type &lt;- readr::read_csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/data_KEGG_type.csv\")\ndata_KEGG_type$pvalue_log &lt;- -log10(data_KEGG_type$pvalue)\nsummary(data_KEGG_type)\n\n      PW                 ID                pvalue               NES         \n Length:33          Length:33          Min.   :3.490e-06   Min.   :-1.7497  \n Class :character   Class :character   1st Qu.:4.930e-05   1st Qu.:-1.5834  \n Mode  :character   Mode  :character   Median :6.342e-04   Median :-1.5103  \n                                       Mean   :2.093e-03   Mean   :-0.7439  \n                                       3rd Qu.:2.889e-03   3rd Qu.:-1.3939  \n                                       Max.   :8.710e-03   Max.   : 2.0829  \n     type             subtype            pvalue_log   \n Length:33          Length:33          Min.   :2.060  \n Class :character   Class :character   1st Qu.:2.539  \n Mode  :character   Mode  :character   Median :3.198  \n                                       Mean   :3.442  \n                                       3rd Qu.:4.307  \n                                       Max.   :5.457  \n\ndata_KEGG_type1 &lt;- data_KEGG_type %&gt;%\n  dplyr::select(type, subtype, PW, pvalue_log, NES) %&gt;%\n  arrange(type, subtype)",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Circular Packing Chart"
    ]
  },
  {
    "objectID": "Composition/CircularPacking.html#可视化",
    "href": "Composition/CircularPacking.html#可视化",
    "title": "包珠图",
    "section": "可视化",
    "text": "可视化\n\n1. 单级包珠图\n\n1.1 基础包珠图\n以小鼠肺组织使用顺铂前后的差异基因对应的GO分析结果数据为例。\n\n##颜色\ndata_BP1 &lt;- data_BP\ndata_BP1$pvalue_log &lt;- -log10(data_BP1$pvalue)\npacking_BP &lt;- circleProgressiveLayout(data_BP1$pvalue_log, sizetype='area' )\n\n\n#合并绘图数据\ndata_BUBBLE_BP &lt;- cbind(data_BP1, packing_BP)\n\n#生成圆的各个顶点坐标，npoint为顶点数\ndat.gg_BP &lt;- circleLayoutVertices(packing_BP, npoints=50)\n\n#绘图\np &lt;- ggplot() + \n  geom_polygon(data = dat.gg_BP, \n               aes(x, y, group = id, fill=as.factor(id)), \n               colour = \"black\", alpha = 0.6) +\n  scale_fill_manual(values = magma(nrow(data_BUBBLE_BP))) + #修改颜色\n  geom_text(data = data_BUBBLE_BP,\n            aes(x, y, size=pvalue_log, label = str_wrap(BP,width = 10)),\n            show.legend = FALSE) +\n  scale_size_continuous(range = c(0.5,1.5)) +\n  theme_void() + \n  theme(legend.position=\"none\",\n        plot.title = element_text(hjust=0.5,size = 20)) +\n  coord_equal() +\n  ggtitle(\"基础包珠图+颜色自定义\")\n\np\n\n\n\n\n基础包珠图\n\n\n\n\n上图展示了小鼠肺组织使用顺铂前后的差异基因GO分析的Biological Process部分，颜色表示不同的生物过程。\n\n\n1.2 颜色映射数据大小\n以小鼠肺组织使用顺铂前后的差异基因对应的GO分析结果数据为例。\n\n#基础包珠图（ggplot2）----\n#绘图----\n#返回每个泡泡位置和大小\ndata_BP1 &lt;- data_BP\ndata_BP1$pvalue_log &lt;- -log10(data_BP1$pvalue)\npacking_BP &lt;- circleProgressiveLayout(data_BP1$pvalue_log, sizetype='area' )\n\n\n#合并绘图数据\ndata_BUBBLE_BP &lt;- cbind(data_BP1, packing_BP)\n\n#生成圆的各个顶点坐标，npoint为顶点数\ndat.gg_BP &lt;- circleLayoutVertices(packing_BP, npoints=50)\n\n#value映射NES值\ndat.gg_BP$NES &lt;- rep(data_BP1$NES, each=51) \n\n#绘图\nggplot() + \n  geom_polygon(data = dat.gg_BP, aes(x, y, group = id, fill=NES), #颜色表示NES值\n               colour = \"black\", alpha = 0.6) +\n  scale_fill_continuous(type = \"viridis\")+\n\n#添加标签+控制大小\n  geom_text(data = data_BUBBLE_BP,\n            aes(x, y, size=pvalue_log, label = str_wrap(BP,width = 10)),\n            show.legend = FALSE) +\n  scale_size_continuous(range = c(0.5,1.5)) +\n\n#主题\n  theme_void()  + \n  theme(plot.title = element_text(hjust=0.5,size = 20)) + \n  coord_equal()+\n  ggtitle(\"Biological Process\")\n\n\n\n\n颜色映射数据大小\n\n\n\n\n上图展示了小鼠肺组织使用顺铂前后的差异基因GO分析的Biological Process部分，圆圈大小表示log10（P）的负值，圆圈越大表示结果越可靠。圆圈颜色表示NES值。\n\n\n1.3 背景自定义\n以小鼠肺组织使用顺铂前后的差异基因对应的KNGG通路分析结果数据为例。\n\n##背景自定义\n#颜色映射数据值\ndata_KEGG1 &lt;- data_KEGG\ndata_KEGG1$pvalue_log &lt;- -log10(data_KEGG1$pvalue)\npacking_KEGG &lt;- circleProgressiveLayout(data_KEGG1$pvalue_log, sizetype='area' )\n\n\n#合并绘图数据\ndata_BUBBLE_KEGG &lt;- cbind(data_KEGG1, packing_KEGG)\n\n#生成圆的各个顶点坐标，npoint为顶点数\ndat.gg_KEGG &lt;- circleLayoutVertices(packing_KEGG, npoints=50)\n\n#value映射NES值\ndat.gg_KEGG$NES &lt;- rep(data_KEGG1$NES, each=51) \n\n\np3 &lt;- ggplot() + \n  geom_polygon(data = dat.gg_KEGG, aes(x, y, group = id, fill=NES),\n               colour = \"grey\", alpha = 0.6, size=.5) +\n  scale_fill_distiller(palette = \"Spectral\", direction = 1 ) +\n\n#添加标签+控制大小\n  geom_label(data = data_BUBBLE_KEGG, \n             aes(x, y, size=pvalue_log, label = str_wrap(PW,width = 15)),\n             show.legend = FALSE) +\n  scale_size_continuous(range = c(1.5,2)) +\n\n#主题，自定义\n  theme_void()  + \n  theme(\n    legend.text = element_text(colour=\"white\", size = 10),\n    plot.background = element_rect(fill=\"black\"),\n    plot.title = element_text(color=\"grey\", hjust=0.5,size = 20)\n  ) + \n  coord_equal() +\n  ggtitle(\"自定义背景\")\n\np3\n\n\n\n\n背景自定义\n\n\n\n\n\n\n\n2. 交互单级包珠图\nggiraph包允许我们绘制交互包珠图。\n\n#交互----\n#颜色映射数据值\ndata_KEGG1 &lt;- data_KEGG\ndata_KEGG1$pvalue_log &lt;- -log10(data_KEGG1$pvalue)\npacking_KEGG &lt;- circleProgressiveLayout(data_KEGG1$pvalue_log, sizetype='area' )\n\n\n#合并绘图数据\ndata_BUBBLE_KEGG &lt;- cbind(data_KEGG1, packing_KEGG)\n\n#生成圆的各个顶点坐标，npoint为顶点数\ndat.gg_KEGG &lt;- circleLayoutVertices(packing_KEGG, npoints=50)\n\n#value映射NES值\ndat.gg_KEGG$NES &lt;- rep(data_KEGG1$NES, each=51) \n\ndata_BUBBLE_KEGG$text &lt;- paste(\"Pathway:\",data_BUBBLE_KEGG$PW, \n                               \"\\n\", \"-log10(P):\", data_BUBBLE_KEGG$pvalue_log, \n                               \"\\n\",\"NES:\", data_BUBBLE_KEGG$NES)\n\np5 &lt;- ggplot() + \n  geom_polygon_interactive(data = dat.gg_KEGG, \n                           aes(x, y, group = id, fill=NES, tooltip = data_BUBBLE_KEGG$text[id], data_id = id), \n                           colour = \"black\", alpha = 0.6) +\n  scale_fill_distiller(palette = \"BuPu\", direction = 1 ) +\n\n#添加标签+控制大小\n  geom_text(data = data_BUBBLE_KEGG,\n            aes(x, y, size=pvalue_log, label = str_wrap(PW,width = 15)),\n            show.legend = FALSE) +\n  scale_size_continuous(range = c(1.5,2)) +\n\n#主题\n  theme_void()  + \n  theme(plot.title = element_text(hjust=0.5,size = 20)) + \n  coord_equal()+\n  ggtitle(\"交互图形\")\n\n\nP_inter &lt;- girafe(ggobj = p5, width_svg = 7, height_svg = 7)\n\nP_inter\n\n\n\n交互单级包珠图\n\n\n上图为交互单级包珠图，鼠标悬停处圆圈为橙色，可交互查看通路名称，P值的-log10值以及NES值，同时提供下载功能。\n\n\n3. 多级别包珠图\n这里以补充了通路分类的KNGG通路分析结果数据为例。\n绘制多级别包珠图需要将数据整理为顶点（vertices）数据集以及边（edges）数据集，igraph包的graph_from_data_frame()函数可以很好的将包含边列表和边/顶点属性的一个或两个数据帧创建为igraph图，用于绘图。\n\n#点数据集\nrstat_nodes_KEGG &lt;- data.frame(name = c(\"KEGG Pathways\",\n                                        unique(data_KEGG_type1$type), \n                                        unique(data_KEGG_type1$subtype),\n                                        unique(data_KEGG_type1$PW)), \n                               pvalue_log = c(rep(0,22),data_KEGG_type1$pvalue_log),\n                               NES = c(rep(0,22),data_KEGG_type1$NES),\n                               label = c(\"KEGG Pathways\",\n                                         unique(data_KEGG_type1$type), \n                                         unique(data_KEGG_type1$subtype),\n                                         unique(data_KEGG_type1$PW)))\n\n\n#开始创建边数据集\nedges1 &lt;- rep(\"KEGG Pathways\", length(unique(data_KEGG_type1$type)))\n\n#创建函数用于批量处理\nfcount1 &lt;- function(n){\n  data1 &lt;- filter(data_KEGG_type1, data_KEGG_type1$type == unique(data_KEGG_type1$type)[n])\n  count &lt;- length(unique(data1$subtype)) \n  result &lt;- rep(unique(data_KEGG_type1$type)[n], count)\nreturn(result)\n}\n\nedges2&lt;- NULL\nfor(i in seq(1, 6)){\n  edges2 &lt;- c(edges2,fcount1(i))\n  #print(edges2)\n}\n\n\n#创建函数用于批量处理\nfcount2 &lt;- function(n){\n  data1 &lt;- filter(data_KEGG_type1, data_KEGG_type1$subtype == unique(data_KEGG_type1$subtype)[n])\n  count &lt;- length(unique(data1$PW)) \n  result &lt;- rep(unique(data_KEGG_type1$subtype)[n], count)\nreturn(result)\n}\n\nedges3&lt;- NULL\nfor(i in seq(1,15)){\n  edges3 &lt;- c(edges3,fcount2(i))\n  #print(edges3)\n}\n\n\nedgesa &lt;- unique(data_KEGG_type1$type)\n\n\n#创建函数用于批量处理\nfcounta &lt;- function(n){\n  data1 &lt;- filter(data_KEGG_type1, data_KEGG_type1$type == unique(data_KEGG_type1$type)[n])\n  result &lt;- unique(data1$subtype)\nreturn(result)\n}\n\nedgesb&lt;- NULL\nfor(i in seq(1, 6)){\n  edgesb &lt;- c(edgesb,fcounta(i))\n  #print(edgesb)\n}\n\n\n#创建函数用于批量处理\nfcountb &lt;- function(n){\n  data1 &lt;- filter(data_KEGG_type1, data_KEGG_type1$subtype == unique(data_KEGG_type1$subtype)[n])\n  result &lt;- unique(data1$PW)\nreturn(result)\n}\n\nedgesc&lt;- NULL\nfor(i in seq(1, 15)){\n  edgesc &lt;- c(edgesc,fcountb(i))\n  #print(edgesc)\n}\n\n#边数据集\nrstat_edges_KEGG &lt;- data.frame(from = c(edges1, edges2, edges3),\n                               to = c(edgesa, edgesb, edgesc))\n\n#创建igraph图\nmygraph_KEGG &lt;- graph_from_data_frame( rstat_edges_KEGG, vertices=rstat_nodes_KEGG )\n\n# 绘图\nggraph(mygraph_KEGG, layout = 'circlepack', weight = pvalue_log ) + #泡泡大小对应值的大小\n  geom_node_circle(aes(fill = NES)) +\n  theme_void()+\n  geom_node_text( aes(filter=leaf, size=pvalue_log, \n                      label = str_wrap(label,width = 10)), \n                  show.legend = FALSE) +\n  scale_size_continuous(range = c(1.5,2)) + \n  scale_fill_viridis(alpha = 0.5) +\n  ggtitle(\"KEGG通路多级别分类\") +\n  theme(plot.title = element_text(color=\"black\", hjust=0.5,size = 20))\n\n\n\n\n多级别包珠图\n\n\n\n\n上图为KEGG通路多级别分类的包珠图，最小级别圆圈的大小表示log10（P）的负值，圆圈越大表示相关程度越大。圆圈颜色表示NES值。\n分类依据KEGG官网的通路分类：\n一级分类：Metabolism（代谢）、Genetic Information Processing（遗传信息处理）、Environmental Information Processing（环境信息处理）、Cellular Processes（细胞过程）、Organismal Systems（有机系统）、Human Diseases（人类疾病）、Drug Development（药物开发）\n二级分类：例如Cellular Processes下的5个二级分类——Transport and catabolism、Cell growth and death、Cellular community – eukaryotes、Cellular community – eukaryotes和Cell motility\n\n\n4. 交互多级别包珠图\n通过circlepackeR包可以实现交互多级别包珠图的绘制。\n\n#分组边框显示\n#多层级数据\ndata &lt;- data.frame(\n  root=rep(\"root\", 15),\n  group=c(rep(\"group A\",5), rep(\"group B\",5), rep(\"group C\",5)), \n  subgroup= rep(letters[1:5], each=3),\n  subsubgroup=rep(letters[1:3], 5),\n  value=sample(seq(1:15), 15)\n)\n\n#更改数据形式\ndata$pathString &lt;- paste(\"world\", data$group, data$subgroup, data$subsubgroup, sep = \"/\")\npopulation &lt;- as.Node(data)\n\np_inter1 &lt;- circlepackeR(population,\n                         size = \"value\", \n                         color_min = \"hsl(56,80%,80%)\", \n                         color_max = \"hsl(341,30%,40%)\")\n\np_inter1\n\n\n\n交互多级别包珠图\n\n\n上图为可交互多级别包珠图，可实现组别边框显示以及不同级别组别的放大缩小。\n以flare数据集为例\n\n#所有级别边框显示\ndata_edge &lt;- flare$edges\ndata_edge$from &lt;- gsub(\".*\\\\.\",\"\",data_edge$from)\ndata_edge$to &lt;- gsub(\".*\\\\.\",\"\",data_edge$to)\n#head(data_edge)   # This is an edge list\n\ndata_tree &lt;- FromDataFrameNetwork(data_edge)\ndata_nested &lt;- ToDataFrameTree(data_tree, \n                               level1 = function(x) x$path[2],\n                               level2 = function(x) x$path[3],\n                               level3 = function(x) x$path[4],\n                               level4 = function(x) x$path[5])[-1,-1]\ndata_nested &lt;- na.omit(data_nested)\n\n#绘图\ndata_nested$pathString &lt;- paste(\"roots\", data_nested$level1, data_nested$level2, data_nested$level3, data_nested$level4, sep = \"/\")\ndata_nested$value=1\ndata_Node &lt;- as.Node(data_nested)\np_inter2 &lt;- circlepackeR(data_Node, size = \"value\")\np_inter2\n\n\n\n以flare数据集为例\n\n\n上图为可交互多级别包珠图，可实现所有的边框显示以及不同级别组别的放大缩小。",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Circular Packing Chart"
    ]
  },
  {
    "objectID": "Composition/CircularPacking.html#应用场景",
    "href": "Composition/CircularPacking.html#应用场景",
    "title": "包珠图",
    "section": "应用场景",
    "text": "应用场景\n\n\n\n\n\n\n图 1: 包珠图应用\n\n\n\n有色圆圈代表药物化学空间骨架并标记其骨架的频率。圆圈的面积和颜色与骨架频率有关。在同一群集中的骨架被分组为灰圈。 [1]",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Circular Packing Chart"
    ]
  },
  {
    "objectID": "Composition/CircularPacking.html#参考文献",
    "href": "Composition/CircularPacking.html#参考文献",
    "title": "包珠图",
    "section": "参考文献",
    "text": "参考文献\n[1] Langdon SR, Brown N, Blagg J. Scaffold diversity of exemplified medicinal chemistry space. J Chem Inf Model. 2011 Sep 26;51(9):2174-85. doi: 10.1021/ci2001428. Epub 2011 Aug 31. PMID: 21877753; PMCID: PMC3180201.\n[2] Bedward M, Eppstein D, Menzel P (2023). packcircles: Circle Packing. R package version 0.3.6, https://CRAN.R-project.org/package=packcircles.\n[3] H. Wickham. ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York, 2016.\n[4] Wickham H, François R, Henry L, Müller K, Vaughan D (2023). dplyr: A Grammar of Data Manipulation. R package version 1.1.4, https://CRAN.R-project.org/package=dplyr.\n[5] Wickham H, Vaughan D, Girlich M (2024). tidyr: Tidy Messy Data. R package version 1.3.1, https://CRAN.R-project.org/package=tidyr.\n[6] Simon Garnier, Noam Ross, Robert Rudis, Antônio P. Camargo, Marco Sciaini, and Cédric Scherer (2024). viridis(Lite) - Colorblind-Friendly Color Maps for R. viridis package version 0.6.5.\n[7] Gohel D, Skintzos P (2024). ggiraph: Make ‘ggplot2’ Graphics Interactive. R package version 0.8.10, https://CRAN.R-project.org/package=ggiraph.\n[8] Vaidyanathan R, Xie Y, Allaire J, Cheng J, Sievert C, Russell K (2023). htmlwidgets: HTML Widgets for R. R package version 1.6.4, https://CRAN.R-project.org/package=htmlwidgets.\n[9] Pedersen T (2024). ggraph: An Implementation of Grammar of Graphics for Graphs and Networks. R package version 2.2.1, https://CRAN.R-project.org/package=ggraph.\n[10] Wickham H, Averick M, Bryan J, Chang W, McGowan LD, François R, Grolemund G, Hayes A, Henry L, Hester J, Kuhn M, Pedersen TL, Miller E, Bache SM, Müller K, Ooms J, Robinson D, Seidel DP, Spinu V, Takahashi K, Vaughan D, Wilke C, Woo K, Yutani H (2019). “Welcome to the tidyverse.” Journal of Open Source Software, 4(43), 1686. doi:10.21105/joss.01686 https://doi.org/10.21105/joss.01686.\n[11] Li X, Zhao T, Wang L, Yuan X, Liu H (2022). flare: Family of Lasso Regression. R package version 1.7.0.1, https://CRAN.R-project.org/package=flare.\n[12] Wilke C (2024). cowplot: Streamlined Plot Theme and Plot Annotations for ‘ggplot2’. package version 1.1.3, https://CRAN.R-project.org/package=cowplot.\n[13] Bostock M, Froelich J (2015). circlepackeR: htmlwidget for Mike Bostock d3.js circle packing visualization. R package version 0.0.0.9000.\n[14] Glur C (2023). data.tree: General Purpose Hierarchical Data Structure. R package version 1.1.0, https://CRAN.R-project.org/package=data.tree.",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Circular Packing Chart"
    ]
  },
  {
    "objectID": "Composition/Donut.html",
    "href": "Composition/Donut.html",
    "title": "环状图",
    "section": "",
    "text": "环状图是一个被分成若干扇区的圆环，每个扇区代表整体的一部分。它与饼图非常相似，可以在ggplot2和基础R中构建这种图形。",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Donut Chart"
    ]
  },
  {
    "objectID": "Composition/Donut.html#示例",
    "href": "Composition/Donut.html#示例",
    "title": "环状图",
    "section": "示例",
    "text": "示例",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Donut Chart"
    ]
  },
  {
    "objectID": "Composition/Donut.html#环境配置",
    "href": "Composition/Donut.html#环境配置",
    "title": "环状图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：ggplot2\n\n\n# 安装包\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# 加载包\nlibrary(ggplot2)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package * version date (UTC) lib source\n ggplot2 * 4.0.1   2025-11-14 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Donut Chart"
    ]
  },
  {
    "objectID": "Composition/Donut.html#数据准备",
    "href": "Composition/Donut.html#数据准备",
    "title": "环状图",
    "section": "数据准备",
    "text": "数据准备\n主要运用TCGA数据库和R内置数据集mtcars。\n\n# 1.TCGA数据库（2020年肺癌的临床数据）\nTCGA_cli_df &lt;- readr::read_tsv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/raponi2006_public_raponi2006_public_clinicalMatrix.gz\")\n\n# 2.R内置的data——mtcars\nhead(mtcars)\n\n                   mpg cyl disp  hp drat    wt  qsec vs am gear carb\nMazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4\nMazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4\nDatsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1\nHornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1\nHornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2\nValiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Donut Chart"
    ]
  },
  {
    "objectID": "Composition/Donut.html#可视化",
    "href": "Composition/Donut.html#可视化",
    "title": "环状图",
    "section": "可视化",
    "text": "可视化\n\n1. 基本绘图\n\n1.1 以TCGA数据为例\n\n# 数据准备\ncounts &lt;- table(TCGA_cli_df$T)\ncounts &lt;- as.data.frame(counts)\nnames(counts)[names(counts) == \"Var1\"] &lt;- \"T\"\n# 计算百分比\ncounts$fraction = counts$Freq / sum(counts$Freq)\n# 计算累积百分比（每个矩形顶部的数值）\ncounts$ymax = cumsum(counts$fraction)\n# 计算每个矩形的底部，确定起始位置\ncounts$ymin = c(0, head(counts$ymax, n=-1))\n# 画图\np &lt;- ggplot(counts, aes(ymax=ymax, ymin=ymin, xmax=4, xmin=3, fill=T)) +\n  geom_rect() +\n  coord_polar(theta=\"y\") + \n  xlim(c(2, 4)) \n\np\n\n\n\n\n\n\n\n图 1: 以TCGA数据为例\n\n\n\n\n\n这个环状图描述了不同肿瘤分期在总样本中所占的比例。\n\n\n1.2 美化图形\n\n使用 theme_void() 来消除不必要的背景、坐标轴、标签等。\n改变颜色。\n不要使用图例，直接给分组添加标签。\n\n\n# 计算百分比\ncounts$fraction = counts$Freq / sum(counts$Freq)\n# 计算累积百分比（每个矩形顶部的数值）\ncounts$ymax = cumsum(counts$fraction)\n# 计算每个矩形的底部，确定起始位置\ncounts$ymin = c(0, head(counts$ymax, n=-1))\n# 计算标签位置\ncounts$labelPosition &lt;- (counts$ymax + counts$ymin) / 2\n# 标签名字\ncounts$label &lt;- paste0(counts$T, \"\\n value: \", counts$Freq)\n# 画图\np &lt;- ggplot(counts, aes(ymax=ymax, ymin=ymin, xmax=4, xmin=3, fill=T)) +\n  geom_rect() +\n  geom_label( x=3.5, aes(y=labelPosition, label=label), size=6) + #这一行代码可以控制标签在图表中的添加，去除可以删除标签\n  scale_fill_brewer(palette=4) +\n  coord_polar(theta=\"y\") +\n  xlim(c(2, 4)) +\n  theme_void() +\n  theme(legend.position = \"none\")\n\np\n\n\n\n\n\n\n\n图 2: 美化图形\n\n\n\n\n\n这个环状图描述了不同肿瘤分期在总样本中所占的比例。\n\n\n1.3 以mtcars数据为例\n\n# 数据准备\ncounts1 &lt;- table(mtcars$cyl)\ncounts1 &lt;- as.data.frame(counts1)\nnames(counts1)[names(counts1) == \"Var1\"] &lt;- \"cyl\"\n# 计算百分比\ncounts1$fraction = counts1$Freq / sum(counts1$Freq)\n# 计算累积百分比（每个矩形顶部的数值）\ncounts1$ymax = cumsum(counts1$fraction)\n# 计算每个矩形的底部，确定起始位置\ncounts1$ymin = c(0, head(counts1$ymax, n=-1))\n# 计算标签位置\ncounts1$labelPosition &lt;- (counts1$ymax + counts1$ymin) / 2\n# 标签名字\ncounts1$label &lt;- paste0(counts1$T, \"\\n value: \", counts1$Freq)\n# 画图\np &lt;- ggplot(counts1, aes(ymax=ymax, ymin=ymin, xmax=4, xmin=3, fill=cyl)) +\n  geom_rect() +\n  coord_polar(theta=\"y\") + \n  xlim(c(2, 4)) \n\np\n\n\n\n\n\n\n\n图 3: 以mtcars数据为例\n\n\n\n\n\n这个环状图描述了不同气缸数在总样本中所占的比例。\n\n\n\n2. 改变环的厚度\n\n如果 xlim 的左边界很大，就不会出现空圈。你会得到一个饼图。\n如果 xlim 较低，环会变得更薄。\n\n\n2.1 以TCGA数据为例\n\np &lt;- ggplot(counts, aes(ymax=ymax, ymin=ymin, xmax=4, xmin=3, fill=T)) +\n  geom_rect() +\n  geom_text( x=2, aes(y=labelPosition, label=label, color=T), size=6) + # X在这是控制标签位置\n  scale_fill_brewer(palette=\"Set1\") +\n  scale_color_brewer(palette=\"Set1\") +\n  coord_polar(theta=\"y\") +\n  xlim(c(-1, 4)) +\n  theme_void() +\n  theme(legend.position = \"none\")\n\np\n\n\n\n\n\n\n\n图 4: 以TCGA数据为例\n\n\n\n\n\n这个环状图描述了不同肿瘤分期在总样本中所占的比例。\n\n\n2.2 以mtcars数据为例\n\np &lt;- ggplot(counts1, aes(ymax=ymax, ymin=ymin, xmax=4, xmin=3, fill=cyl)) +\n  geom_rect() +\n  geom_text( x=1.5, aes(y=labelPosition, label=label, color=cyl), size=6) + # X在这是控制标签位置在环里面还是外面\n  scale_fill_brewer(palette=\"Set2\") +\n  scale_color_brewer(palette=\"Set2\") +\n  coord_polar(theta=\"y\") +\n  xlim(c(-1, 4)) +\n  theme_void() +\n  theme(legend.position = \"none\")\n\np\n\n\n\n\n\n\n\n图 5: 以mtcars数据为例\n\n\n\n\n\n这个环状图描述了不同气缸数在总样本中所占的比例。",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Donut Chart"
    ]
  },
  {
    "objectID": "Composition/Donut.html#应用场景",
    "href": "Composition/Donut.html#应用场景",
    "title": "环状图",
    "section": "应用场景",
    "text": "应用场景\n\n\n\n\n\n\n图 6: 环状图应用场景1\n\n\n\n这个环状图显示了人海马 scRNA-seq 数据集群之间的分布。 [1]\n\n\n\n\n\n\n图 7: 环状图应用场景2\n\n\n\n这个环状图展示了已激活 AP 在两种神经元中所占的比例。 [1]",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Donut Chart"
    ]
  },
  {
    "objectID": "Composition/Donut.html#参考文献",
    "href": "Composition/Donut.html#参考文献",
    "title": "环状图",
    "section": "参考文献",
    "text": "参考文献\n[1] de Ceglia R, Ledonne A, Litvin DG, Lind BL, Carriero G, Latagliata EC, Bindocci E, Di Castro MA, Savtchouk I, Vitali I, Ranjak A, Congiu M, Canonica T, Wisden W, Harris K, Mameli M, Mercuri N, Telley L, Volterra A. Specialized astrocytes mediate glutamatergic gliotransmission in the CNS. Nature. 2023 Oct;622(7981):120-129. doi: 10.1038/s41586-023-06502-w. Epub 2023 Sep 6. PMID: 37674083; PMCID: PMC10550825.\n[2] Huang KP, Acosta AA, Ghidewon MY, McKnight AD, Almeida MS, Nyema NT, Hanchak ND, Patel N, Gbenou YSK, Adriaenssens AE, Bolding KA, Alhadeff AL. Dissociable hindbrain GLP1R circuits for satiety and aversion. Nature. 2024 Aug;632(8025):585-593. doi: 10.1038/s41586-024-07685-6. Epub 2024 Jul 10. PMID: 38987598.\n[3] Wickham, H. (2016). ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York. https://ggplot2.tidyverse.org",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Donut Chart"
    ]
  },
  {
    "objectID": "Composition/Dendrogram.html",
    "href": "Composition/Dendrogram.html",
    "title": "树状图",
    "section": "",
    "text": "树状图（Dendrogram）是展示对象之间层次关系的一种图形。它广泛应用于聚类分析，尤其是层次聚类（Hierarchical Clustering）中，用于可视化数据点之间的相似性或距离。\n树状图是一个分层结构，由一系列的节点和连接它们的分支（branches）组成。每个节点代表一个数据点（或聚类），而分支的长度则表示对象之间的相似度或距离。通常，树状图从底部的单个数据点开始，逐渐合并形成大的聚类，直到所有对象合并为一个大类。分支表示两个聚类或对象的相似性，通常通过距离度量（如欧氏距离）来衡量。分支越短，表示两个对象越相似，分支越长则表示相似性较低。非叶节点是从不同数据点或聚类中生成的“合并”节点，表示它们被合并成一个更大的类。叶节点是树状图的底部节点，通常代表原始数据点（如样本、基因等）。",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Dendrogram"
    ]
  },
  {
    "objectID": "Composition/Dendrogram.html#示例",
    "href": "Composition/Dendrogram.html#示例",
    "title": "树状图",
    "section": "示例",
    "text": "示例\n\n\n\n\n\n此树状图是层次聚类结果的可视化，展示了TCGA-BRCA样本之间基因表达水平的相似性和聚类结构。x轴表示不同的TCGA-BRCA样本，底部的叶节点标识了每个单独的样本。y轴表示不同样本之间的合并距离或相似度。在层次聚类中，当两个样本的相似性足够高时，它们会被合并成一个聚类。y轴的数值越大，表示这两个聚类或样本之间的相似度越低；反之，数值越小，表示它们之间的相似度越高。树状图通过分支显示样本的合并过程。每个分支代表一次合并，分支越短，表示这两个样本的相似性越高。树状图从底部开始，每个单独的样本逐步被合并，直到形成一个大聚类。在树的顶部，所有样本都被合并成一个单一的聚类。",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Dendrogram"
    ]
  },
  {
    "objectID": "Composition/Dendrogram.html#环境配置",
    "href": "Composition/Dendrogram.html#环境配置",
    "title": "树状图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：ggraph; igraph; tidyverse; collapsibleTree; dendextend\n\n\n# 安装包\nif (!requireNamespace(\"ggraph\", quietly = TRUE)) {\n  install.packages(\"ggraph\")\n}\nif (!requireNamespace(\"igraph\", quietly = TRUE)) {\n  install.packages(\"igraph\")\n}\nif (!requireNamespace(\"tidyverse\", quietly = TRUE)) {\n  install.packages(\"tidyverse\")\n}\nif (!requireNamespace(\"collapsibleTree\", quietly = TRUE)) {\n  install.packages(\"collapsibleTree\")\n}\nif (!requireNamespace(\"dendextend\", quietly = TRUE)) {\n  install.packages(\"dendextend\")\n}\n\n# 加载包\nlibrary(ggraph)\nlibrary(igraph)\nlibrary(tidyverse)\nlibrary(collapsibleTree)\nlibrary(dendextend)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package         * version date (UTC) lib source\n collapsibleTree * 0.1.8   2023-11-13 [1] RSPM\n dendextend      * 1.19.1  2025-07-15 [1] RSPM\n dplyr           * 1.1.4   2023-11-17 [1] RSPM\n forcats         * 1.0.1   2025-09-25 [1] RSPM\n ggplot2         * 4.0.1   2025-11-14 [1] RSPM\n ggraph          * 2.2.2   2025-08-24 [1] RSPM\n igraph          * 2.2.1   2025-10-27 [1] RSPM\n lubridate       * 1.9.4   2024-12-08 [1] RSPM\n purrr           * 1.2.0   2025-11-04 [1] RSPM\n readr           * 2.1.6   2025-11-14 [1] RSPM\n stringr         * 1.6.0   2025-11-04 [1] RSPM\n tibble          * 3.3.0   2025-06-08 [1] RSPM\n tidyr           * 1.3.2   2025-12-19 [1] RSPM\n tidyverse       * 2.0.0   2023-02-22 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Dendrogram"
    ]
  },
  {
    "objectID": "Composition/Dendrogram.html#数据准备",
    "href": "Composition/Dendrogram.html#数据准备",
    "title": "树状图",
    "section": "数据准备",
    "text": "数据准备\n使用R自带数据集warpbreaks，mtcars，USArrests和UCSC Xena网站(UCSC Xena (xenabrowser.net))的TCGA-BRCA.star_counts.tsv。\n\n# warpbreaks\ndata(\"warpbreaks\")\nwarpbreaks &lt;- warpbreaks %&gt;%\n  mutate(breaks = as.character(breaks))\n\n# 嵌套数据框数据转为边列表数据再绘制树状图\nedges_level1_2 &lt;- warpbreaks %&gt;%\n  select(wool, tension) %&gt;%\n  distinct() %&gt;%\n  rename(from = wool, to = tension)\n\nedges_level2_3 &lt;- warpbreaks %&gt;%\n  select(tension, breaks) %&gt;%\n  distinct() %&gt;%\n  rename(from = tension, to = breaks)\n\nedge_list &lt;- bind_rows(edges_level1_2, edges_level2_3) # 合并\nedge_list_unique &lt;- edge_list[edge_list$from != \"B\",]\nedge_list_unique$to &lt;- make.unique(edge_list_unique$to)\n\n\n# 创建graph对象\nmygraph_unique &lt;- graph_from_data_frame(edge_list_unique)\n\n# 分层分组\nV(mygraph_unique)$group &lt;- case_when(\n  V(mygraph_unique)$name %in% unique(warpbreaks$wool) ~ \"Group 1\", # 根节点 wool\n  str_detect(V(mygraph_unique)$name, \"^[LMH]\") ~ \"Group 2\", # 第一层 tension\n  str_detect(V(mygraph_unique)$name, \"^[0-9]\") ~ \"Group 3\", # 第二层 breaks\n  TRUE ~ \"Group 4\" # 额外修正层\n)\nV(mygraph_unique)$color &lt;- case_when(\n  V(mygraph_unique)$group == \"Group 1\" ~ \"red\",\n  V(mygraph_unique)$group == \"Group 2\" ~ \"yellow\",\n  V(mygraph_unique)$group == \"Group 3\" ~ \"green\",\n  V(mygraph_unique)$group == \"Group 4\" ~ \"blue\"\n)\n\n# mtcars\nmtcars %&gt;% \n  select(mpg, cyl, disp) %&gt;% \n  dist() %&gt;% \n  hclust() %&gt;% \n  as.dendrogram() -&gt; mtcars_dend # 使用3个变量进行聚类\n\n# TCGA-BRCA.star_counts.tsv\ndata &lt;- read.csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/TCGA-BRCA.star_counts.tsv\", header = TRUE, sep = \"\")\nexpression_subset &lt;- data[1:20,2:21]\ncolnames(expression_subset) &lt;- substr(colnames(data)[2:21], 6, nchar(colnames(data)[2:21]))\n\ndistance_matrix &lt;- dist(t(expression_subset), method = \"euclidean\") # 计算欧几里得距离\ncluster_result &lt;- hclust(distance_matrix, method = \"complete\") # 使用 hclust 进行层次聚类\n\nsample_type &lt;- substr(colnames(expression_subset), nchar(colnames(expression_subset)), nchar(colnames(expression_subset)))\ncolors &lt;- ifelse(sample_type == \"A\", \"red\", \"blue\")\nbrca_dend &lt;- as.dendrogram(cluster_result)\nbrca_dend &lt;- brca_dend %&gt;%\n  color_labels(col = colors)",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Dendrogram"
    ]
  },
  {
    "objectID": "Composition/Dendrogram.html#可视化",
    "href": "Composition/Dendrogram.html#可视化",
    "title": "树状图",
    "section": "可视化",
    "text": "可视化\n\n1. 分层数据的树状图\n\n1.1 基本绘图\n分层数据集树状图是基于已知的分类结构构建的，它展示了不同层级之间的关系。例如，在一个企业组织结构中，CEO管理团队位于树的顶端，而下层员工根据不同职能或部门分布在树的不同分支上。这种树状图通过层级展示了各个群体之间的所属关系，帮助理解整体的层次结构。\n\nggraph(mygraph_unique, layout = 'dendrogram', circular = FALSE) + \n  geom_edge_diagonal() +\n  geom_node_point() +\n  theme_void()\n\n\n\n\n分层数据的树状图\n\n\n\n\n上图通过warpbreaks数据集的多个变量（wool、tension、breaks）构建的图形展示了它们之间的逐级层次关系，根节点为wool的A类别，第一层为每个wool类别下的tension（L、M、H）水平，第二层为每个tension类别下的breaks。通过树状结构，图形清晰地展示了如何从wool（织物类型）出发，逐步细化到张力（tension）的不同水平，再到断裂次数（breaks）的具体情况。\n\n\n1.2 自定义树状图\n使用circular = TRUE参数绘制圆形树状图。\n\nggraph(mygraph_unique, layout = 'dendrogram', circular = TRUE) + \n  geom_edge_diagonal() +\n  theme_void() \n\n\n\n\n自定义树状图\n\n\n\n\n选择不同的边缘样式。ggraph包包含 2 个主要函数：geom_edge_link()和geom_edge_diagonal()。边缘样式为直线时不可见树状图最常见的“肘形”。\n\nggraph(mygraph_unique, layout = 'dendrogram', circular = FALSE) + \n  geom_edge_link() + \n  theme_void() \n\n\n\n\n选择不同的边缘样式\n\n\n\n\n用geom_node_text和geom_node_point添加标签和节点。\n\nggraph(mygraph_unique, layout = 'dendrogram') + \n  geom_edge_diagonal() + \n  geom_node_text(aes(label = name, filter = leaf), angle = 90, hjust = 1, nudge_y = -0.04) + \n  geom_node_point(aes(filter = leaf), alpha = 0.6) + \n  ylim(-0.5, NA) + \n  theme_void()\n\n\n\n\n添加标签和节点\n\n\n\n\n向树状图添加颜色或形状，更清楚地显示数据集的组织。ggraph的工作方式与ggplot2相同，可以使用初始数据框的一列来映射到形状、颜色、大小或其他。\n\nggraph(mygraph_unique, layout = 'dendrogram') + \n  geom_edge_diagonal() +\n  geom_node_text(aes(label = name, color = color, filter = leaf), angle = 90, hjust = 1, nudge_y = -0.1) +\n  geom_node_point(aes(color = color), alpha = 0.6) + \n  ylim(-0.6, NA) + \n  theme_void() +\n  theme(legend.position = \"none\")\n\n\n\n\n向树状图添加颜色或形状\n\n\n\n\n\n\n\n2. 交互式树状图\n使用CollapsibleTree包绘制交互式树状图。\n\np &lt;- collapsibleTree(warpbreaks, c(\"wool\", \"tension\", \"breaks\"))\np\n\n\n\n交互式树状图\n\n\n此图通过将 warpbreaks 数据集按 “wool”（羊毛类型）、“tension”（张力）和 “breaks”（断裂次数）这三个变量的层级结构可视化，形成一个可交互的树状图。图中的每个节点代表一个层次，用户可以点击展开或折叠不同的节点，从而查看该层次下的数据汇总。此图形可以帮助用户理解层级数据的分布和各层之间的关系，适用于展示具有多层次结构的数据。\n\n\n3. 聚类树状图\n使用R自带的hclust()函数绘图。\n\n输入数据集通常是一个矩阵，其中每一行代表一个样本，每一列代表一个变量。如果需要，可以使用 t() 函数对矩阵进行转置，以便让行和列交换。\n层次聚类是在一个方阵（样本 x 样本矩阵）上进行的，这个方阵描述了样本之间的相似性或距离。计算这些距离可以使用 dist() 函数（用于欧几里得距离）或 cor() 函数（用于相关性）等，具体选择哪个函数取决于你的问题和数据的特点。\n然后，使用 hclust() 函数来执行层次聚类，得到一个聚类结果。最后，你可以使用 plot() 函数将聚类结果可视化，以便查看树状图，并根据需要进行一些自定义设置。\n\n层次聚类的原理如下：首先，计算样本之间的距离（或相似性）。接着，找到两个样本之间的最小距离。将这两个样本合并成一个簇。使用这两个物体的“重心”来代表新形成的簇。然后，继续重复这一过程，直到所有物体都被合并成一个最终的簇。在计算两个簇之间的距离时，可以采用不同的方法：比如使用簇中两个点之间的最大距离、最小距离、平均距离，或者使用 Ward 方法（默认）。不同的距离计算方式会影响聚类结果。\n\n3.1 基本树状图\n\nplot(cluster_result, main = \"Hierarchical Clustering of TCGA-BRCA Samples\", \n     xlab = \"Samples\", ylab = \"Height\", sub = \"\", cex = 0.8)\n\n\n\n\n基本树状图\n\n\n\n\n此图展示了TCGA-BRCA样本基因表达水平之间的相似性和聚类结构。\n\n\n3.2 放大群组\n可以放大树的特定部分。使用[[..]]运算符选择感兴趣的组。\n\ndhc &lt;- as.dendrogram(cluster_result)\npar(mar = c(8, 4, 4, 2))\nplot(dhc[[2]], main = \"Zoom on a Part of the Dendrogram\")\n\n\n\n\n放大群组\n\n\n\n\n这个图展示了TCGA-BRCA样本基因表达水平层次聚类结果的一个局部视图。通过将聚类树状图的第二部分提取出来，图中显示了某一层级的聚类结构。该部分有助于深入观察样本之间的相似性和聚类过程，特别是对于某些特定簇的细节。\n\n\n3.3 颜色与图例\n\npar(mar = c(8, 4, 4, 2))\nplot(brca_dend, main = \"Hierarchical Clustering of TCGA-BRCA Samples\", xlab = \"\", ylab = \"\", sub = \"\", cex = 0.8)\nlegend(\"topright\", \n       legend = c(\"Tumor (A)\", \"Normal (B)\"), \n       col = c(\"red\", \"blue\"), \n       pch = 20, \n       bty = \"n\",  \n       pt.cex = 1.5, \n       cex = 0.8, \n       text.col = \"black\", \n       horiz = FALSE, \n       inset = c(0, 0.1)) # 添加图例\n\n\n\n\n颜色与图例\n\n\n\n\n这个图展示了TCGA-BRCA样本基因表达水平的层次聚类结果。通过树状图，可以直观地观察到不同样本之间的相似性，并且根据颜色标记（红色代表肿瘤样本，蓝色代表正常样本），我们可以看到肿瘤和正常样本在聚类中的分布情况。图例提供了颜色与样本类型之间的对应关系，有助于理解聚类过程中样本的分类。\n\n\n\n4. dendextend包\n使用dendextend包绘制聚类树状图。\n首先，我们回顾一下如何在基础R中构建树状图：\n\n输入的数据集通常是一个数据框，其中每一行代表一个样本，每一列代表一个特征。\n使用dist()函数计算样本之间的距离，通常使用欧几里得距离或其他适合的数据类型的距离度量。\nhclust()函数用于执行层次聚类，将样本按相似性进行分组。\n\n最后，使用plot()函数将聚类结果可视化，直接绘制出层次树状图，帮助我们直观地查看样本之间的聚类关系。\n\n4.1 基本树状图\n\npar(mar=c(7,3,1,1)) \nplot(mtcars_dend)\n\n\n\n\n基本树状图\n\n\n\n\n这个图展示了mtcars数据集中三个变量（mpg、cyl、disp）的层次聚类结果。通过聚类分析，图中树状图清晰地展示了不同汽车样本之间的相似性。\n\n\n4.2 自定义树状图\n\n# 左图\nmtcars_dend %&gt;% \n  # 自定义枝干\n  set(\"branches_col\", \"grey\") %&gt;% set(\"branches_lwd\", 3) %&gt;%\n  # 自定义叶\n  set(\"labels_col\", \"orange\") %&gt;% set(\"labels_cex\", 0.8) %&gt;%\n  plot()\n\n\n\n\n自定义树状图\n\n\n\n# 中图\nmtcars_dend %&gt;% \n  set(\"nodes_pch\", 19)  %&gt;% \n  set(\"nodes_cex\", 0.7) %&gt;% \n  set(\"nodes_col\", \"orange\") %&gt;% \n  plot()\n\n\n\n\n自定义树状图\n\n\n\n# 右图\nmtcars_dend %&gt;% \n  set(\"leaves_pch\", 19)  %&gt;% \n  set(\"leaves_cex\", 0.7) %&gt;% \n  set(\"leaves_col\", \"skyblue\") %&gt;% \n  plot()\n\n\n\n\n自定义树状图\n\n\n\n\n这三个图展示了不同的树状图定制方式，通过修改树枝、节点和叶子的颜色、大小和形状来增强图形的视觉效果。\n\n\n4.3 突出显示群集\ndendextend具有一些很好的功能来突出显示树簇。可以根据其集群属性对分支进行着色和标记，指定所需的集群数量。rect.dendrogram()函数甚至允许使用矩形突出显示一个或多个特定集群。\n\npar(mar=c(1,1,1,8))\nmtcars_dend %&gt;%\n  set(\"labels_col\", value = c(\"skyblue\", \"orange\", \"grey\"), k=3) %&gt;%\n  set(\"branches_k_color\", value = c(\"skyblue\", \"orange\", \"grey\"), k = 3) %&gt;%\n  plot(horiz=TRUE, axes=FALSE)\nabline(v = 350, lty = 2)\n\n\n\n\n突出显示群集\n\n\n\n\n这个图水平展示了mtcars数据集中三个变量（mpg、cyl、disp）的层次聚类结果，通过不同的颜色区分了不同的聚类簇，并通过虚线标记了一个特定的聚类位置。\n\n# 用矩形突出显示\npar(mar=c(9,1,1,1))\nmtcars_dend %&gt;%\n  set(\"labels_col\", value = c(\"skyblue\", \"orange\", \"grey\"), k=3) %&gt;%\n  set(\"branches_k_color\", value = c(\"skyblue\", \"orange\", \"grey\"), k = 3) %&gt;%\n  plot(axes=FALSE)\nrect.dendrogram( mtcars_dend, k=3, lty = 5, lwd = 0, x=1, col=rgb(0.1, 0.2, 0.4, 0.1) ) \n\n\n\n\n用矩形突出显示\n\n\n\n\n这个图水平展示了mtcars数据集中三个变量（mpg、cyl、disp）的层次聚类结果，通过用矩形突出显示特定的类别。\n\n\n4.4 与预期聚类进行比较\n将获得的聚类与预期分布进行比较是一项常见任务。在mtcars中，am列是二进制变量。我们可以使用colored_bars()函数检查此变量是否与我们获得的聚类一致。\n\nmy_colors &lt;- ifelse(mtcars$am==0, \"forestgreen\", \"green\")\n\npar(mar=c(10,1,1,1))\nmtcars_dend %&gt;%\n  set(\"labels_col\", value = c(\"skyblue\", \"orange\", \"grey\"), k=3) %&gt;%\n  set(\"branches_k_color\", value = c(\"skyblue\", \"orange\", \"grey\"), k = 3) %&gt;%\n  set(\"leaves_pch\", 19)  %&gt;% \n  set(\"nodes_cex\", 0.7) %&gt;% \n  plot(axes=FALSE)\n\ncolored_bars(colors = my_colors, dend = mtcars_dend, rowLabels = \"am\")\n\n\n\n\n与预期聚类进行比较\n\n\n\n\n这个图展示了基于层次聚类的树状图，样本（数据点）被分为不同的簇，并通过不同的颜色和样式进行标记。树状图的叶节点使用了不同的颜色，分别表示mtcars数据集中的am变量的不同值（0或1），并且对每个节点的标记、分支颜色等进行了定制。图中通过彩色条形图进一步强调了每个样本的类别（am）。\n\n\n4.5 比较2个树状图\n可以使用 tanglegram() 函数比较两个树状图。当计算距离矩阵并运行层次聚类时，不能仅仅依赖默认选项，需要根据具体的需求进行选择。不同的聚类方法会产生不同的结果，因此了解并比较各种方法之间的差异是非常重要的。\n\n# 使用两种聚类方法\nd1 &lt;- USArrests %&gt;% dist() %&gt;% hclust( method=\"average\" ) %&gt;% as.dendrogram()\nd2 &lt;- USArrests %&gt;% dist() %&gt;% hclust( method=\"complete\" ) %&gt;% as.dendrogram()\n\ndl &lt;- dendlist(\n  d1 %&gt;% \n    set(\"labels_col\", value = c(\"skyblue\", \"orange\", \"grey\"), k=3) %&gt;%\n    set(\"branches_lty\", 1) %&gt;%\n    set(\"branches_k_color\", value = c(\"skyblue\", \"orange\", \"grey\"), k = 3),\n  d2 %&gt;% \n    set(\"labels_col\", value = c(\"skyblue\", \"orange\", \"grey\"), k=3) %&gt;%\n    set(\"branches_lty\", 1) %&gt;%\n    set(\"branches_k_color\", value = c(\"skyblue\", \"orange\", \"grey\"), k = 3)\n)\n\n# 合并绘图\ntanglegram(dl, \n           common_subtrees_color_lines = FALSE, highlight_distinct_edges  = TRUE, highlight_branches_lwd=FALSE, \n           margin_inner=7,\n           lwd=2\n)\n\n\n\n\n比较2个树状图\n\n\n\n\n这个图展示了两种不同的聚类方法对同一数据集（USArrests）的聚类结果进行比较。通过使用dendlist()将两个层次聚类树（d1 和 d2）合并为一个图，并通过tanglegram()函数展示这两个聚类树之间的差异。图中突出了不同的聚类分支，并通过颜色区分了两个方法在聚类过程中的不同划分。这样，可以直观地看到两种方法在聚类结果上的不同，并帮助用户理解它们的区别。",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Dendrogram"
    ]
  },
  {
    "objectID": "Composition/Dendrogram.html#应用场景",
    "href": "Composition/Dendrogram.html#应用场景",
    "title": "树状图",
    "section": "应用场景",
    "text": "应用场景\n\n1. 基础树状图\n\n\n\n\n\n\n图 1: 基础树状图应用\n\n\n\n基因共表达模块和元模块。A） 树状图显示了 VSP 中分层聚类基因的结果。沿枝干的叶子代表基因探针。y 轴表示由 1 – 拓扑重叠 （TO） 确定的网络距离，其中接近 0 的值表示样本之间探针表达谱的相似性更高。下面的色块表示 VSP（顶部）和区域 X（底部）中探针在每个区域中分配到的模块。区域 X 模块颜色设置为尽可能与 VSP 颜色匹配，因此在 2 个波段中匹配的色块表示 VSP 模块保留在区域 X 中（例如粉色、红色、绿松石色、紫色）。未保存的模块：蓝色、绿黄色、黄色和鲑鱼色。（B） 树状图显示了分层聚类 VSP 模块特征基因 （MEs） 的结果，以检查模块之间的高阶关系。沿枝干的叶子代表 ME。y 轴表示由 1 – 相关性确定的网络距离，其中接近 0 的值表示模块中表达扰动的主要来源之间的相似性更高。（C） 表示 VSP ME 之间相关性的热图。每行/列代表一个 ME，由 x 轴和 y 轴上的模块色块表示。深红色表示强正相关，深绿色表示强负相关，白色表示无相关性，如色标尺所示。对角线上的单元格是深红色的，因为每个 ME 都与自身完美相关。（D） 所有 VSP 模块的颜色键。在后续图中使用相同的颜色。 [1]\n\n\n2. 与预期聚类进行比较\n\n\n\n\n\n\n图 2: 与预期聚类进行比较应用\n\n\n\n应用于表达矩阵（左）和标准化相关性矩阵（图 3B）（右）的树状图算法的无监督结果。属于同一操纵子的基因用相同颜色标记。请注意，四个错配仅发生在标准化相关性矩阵（左）中。 [2]\n\n\n3. 圆形树状图\n\n\n\n\n\n\n图 3: 圆形树状图应用\n\n\n\n3,905 个 RefSeq 病毒基因组的最佳树状图 （k = 9）。支系由巴尔的摩分类着色。圆圈从内到外按不同的顺序、宿主和基因组大小着色，如下所示：按巴尔的摩分类的牧场：dsDNA（无 RNA 阶段），红色;dsRNA，绿色;RT 病毒，粉红色;ssDNA，蓝色;ssRNA 负链，亮蓝色;ssRNA 正链，黄色。第一个圆圈，从内到外，按顺序排列：Caudovirales，红色;疱疹病毒属，绿色;Ligamenvirales，蓝色;Mononegavirales，橙色;Nidovirales，青色：Picornavirales，粉红色;Tymovirales，深绿色;未分类，银色。第二个圆圈，由内到外，按宿主排列：原生生物，橙色;古细菌，红色;细菌，深绿色;真菌，蓝色;动物，青色;动植物，淡紫红色;植物，粉红色;环境或 NA、银。第三个圆圈，从内到外，按基因组大小排列：Q1，绿色;Q2，黄色;Q3，橙色;Q4，红色。 [3]",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Dendrogram"
    ]
  },
  {
    "objectID": "Composition/Dendrogram.html#参考文献",
    "href": "Composition/Dendrogram.html#参考文献",
    "title": "树状图",
    "section": "参考文献",
    "text": "参考文献\n[1] Hilliard AT, Miller JE, Horvath S, White SA. Distinct neurogenomic states in basal ganglia subregions relate differently to singing behavior in songbirds. PLoS Comput Biol. 2012;8(11):e1002773. doi: 10.1371/journal.pcbi.1002773. Epub 2012 Nov 8. PMID: 23144607; PMCID: PMC3493463.\n[2] Madi A, Friedman Y, Roth D, Regev T, Bransburg-Zabary S, Ben Jacob E. Genome holography: deciphering function-form motifs from gene expression data. PLoS One. 2008 Jul 16;3(7):e2708. doi: 10.1371/journal.pone.0002708. PMID: 18628959; PMCID: PMC2444029.\n[3] Zhang Q, Jun SR, Leuze M, Ussery D, Nookaew I. Viral Phylogenomics Using an Alignment-Free Method: A Three-Step Approach to Determine Optimal Length of k-mer. Sci Rep. 2017 Jan 19;7:40712. doi: 10.1038/srep40712. PMID: 28102365; PMCID: PMC5244389.\n[4] ggraph: Grammar of Graphs for ggplot2. https://cran.r-project.org/web/packages/ggraph/index.html\n[5] igraph: Network Analysis and Visualization. https://cran.r-project.org/web/packages/igraph/index.html\n[6] tidyverse: Easily Install and Load the ‘Tidyverse’. https://cran.r-project.org/web/packages/tidyverse/index.html\n[7] CollapsibleTree: Interactive Hierarchical Tree Plots. https://cran.r-project.org/web/packages/CollapsibleTree/index.html\n[8] dendextend: Extensions to Dendrogram Class. https://cran.r-project.org/web/packages/dendextend/index.html",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Dendrogram"
    ]
  },
  {
    "objectID": "Composition/Waffle.html",
    "href": "Composition/Waffle.html",
    "title": "华夫饼图",
    "section": "",
    "text": "华夫饼图通过一个由小方块组成的网格来直观表示分类数据，这些方块看起来像华夫饼。每个类别被分配一个独特的颜色，分配给每个类别的方块数量对应其在总数据计数中的比例份额。",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Waffle Chart"
    ]
  },
  {
    "objectID": "Composition/Waffle.html#示例",
    "href": "Composition/Waffle.html#示例",
    "title": "华夫饼图",
    "section": "示例",
    "text": "示例",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Waffle Chart"
    ]
  },
  {
    "objectID": "Composition/Waffle.html#环境配置",
    "href": "Composition/Waffle.html#环境配置",
    "title": "华夫饼图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：ggplot2, waffle, dplyr\n\n\n# 安装包\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"waffle\", quietly = TRUE)) {\n  install.packages(\"waffle\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\n\n# 加载包\nlibrary(ggplot2)\nlibrary(waffle)\nlibrary(dplyr)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package * version date (UTC) lib source\n dplyr   * 1.1.4   2023-11-17 [1] RSPM\n ggplot2 * 4.0.1   2025-11-14 [1] RSPM\n waffle  * 1.0.2   2025-11-02 [1] Github (hrbrmstr/waffle@767875b)\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Waffle Chart"
    ]
  },
  {
    "objectID": "Composition/Waffle.html#数据准备",
    "href": "Composition/Waffle.html#数据准备",
    "title": "华夫饼图",
    "section": "数据准备",
    "text": "数据准备\n主要运用TCGA数据库和R内置数据集mtcars。\n\n# 1.TCGA数据库（2020年肺癌的临床数据）\nTCGA_cli_df &lt;- readr::read_tsv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/raponi2006_public_raponi2006_public_clinicalMatrix.gz\")\n#数据准备\ncounts &lt;- table(TCGA_cli_df$T)\ncounts &lt;- as.data.frame(counts)\nnames(counts)[names(counts) == \"Var1\"] &lt;- \"T\"\n\n# 2.R内置的data——mtcars\ncounts1 &lt;- table(mtcars$cyl)\ncounts1 &lt;- as.data.frame(counts1)\nnames(counts1)[names(counts1) == \"Var1\"] &lt;- \"cyl\"\n\n# 3.自创数据集\ndata &lt;- data.frame(\n  group = c(\"First group\", \"First group\", \"First group\", \"First group\",\n            \"First group\", \"First group\", \"Second group\", \"Second group\",\n            \"Second group\", \"Second group\", \"Third group\", \"Third group\"),\n  subgroup = c(\"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"A\", \"B\", \"C\", \"D\", \"A\", \"B\"),\n  value = c(10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120)\n)",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Waffle Chart"
    ]
  },
  {
    "objectID": "Composition/Waffle.html#可视化",
    "href": "Composition/Waffle.html#可视化",
    "title": "华夫饼图",
    "section": "可视化",
    "text": "可视化\n\n1. 基本绘图（waffle包）\n\n1.1 基本代码\n以TCGA数据为例\n\nwaffle(counts)\n\n\n\n\n基本绘图\n\n\n\n\n这个华夫饼图描述了不同肿瘤分期在总样本中所占的比例。\n\n\n1.2 美化图形\n\nrows：块的行数，默认为10。\nxlab：图表下方的文本，建议用来描述每个方块代表的含义，例如“1 sq == 1000”。\ntitle：图表标题。\ncolors：与parts中的值数量相等的颜色数组。如果省略，使用Color Brewer “Set2”颜色。\nsize：块之间分隔符的宽度，默认为2。\nflip：翻转x和y轴。\npad：要用多少个块来填充网格。\nglyph_size：字形的大小。\nlegend_pos：图例位置。\n\n\nwaffle(counts,rows = 5,\n       colors = c(\"#fb5607\", \"#8338ec\",\"yellow\", \"blue\"),\n       size = 4,flip = F,glyph_size=3,legend_pos=\"bottom\")\n\n\n\n\n美化图形\n\n\n\n\n这个图描述了不同肿瘤分期在总样本中所占的比例。\n\n\n1.3 以mtcars数据库为例\n\nwaffle(counts1)\n\n\n\n\n以mtcars数据库为例\n\n\n\n\n这个图描述了mtcars数据集中不同气缸数在总样本中所占的比例。\n\n\n\n2. 基本绘图（ggplot2包）\n\n2.1 基本代码\n以TCGA数据为例\n\nggplot(counts, aes(fill=T, values=Freq)) +\n  geom_waffle() +\n  theme_void()\n\n\n\n\n以TCGA数据为例\n\n\n\n\n这个华夫饼图描述了不同肿瘤分期在总样本中所占的比例。\n\n\n2.2 美化图形\n\nn_rows：这个参数用于设置华夫饼图中方块的行数，默认为10。\nxlab：图表下方的文本，建议用来描述每个方块代表的含义，例如“1 sq == 1000”。\ntitle：图表标题。\nscale_fill_manual()：改变颜色。\nlabels：改变标签。\nsize：这个参数用于设置方块之间分隔符的宽度，默认为2。\nradius：这个参数用于设置方块的圆角半径，可以通过指定grid::unit()值来控制。例如，radius = unit(4, \"pt\")可以为方块添加圆角，从而改变方块的形状。\nflip：如果设置为TRUE，则翻转x和y坐标，n_rows则变为n_cols，这有助于实现华夫柱状图效果。默认为FALSE。\n\n\nggplot(counts, aes(fill=T, values=Freq)) +\n  geom_waffle(color = \"white\",radius = unit(4, \"pt\")) +\n  scale_fill_manual(values = c(\"#999999\", \"#E69F00\", \"#56B4E9\",\"red\")) +\n  theme_void()\n\n\n\n\n美化图形\n\n\n\n\n这个图描述了不同肿瘤分期在总样本中所占的比例。\n\n\n2.3 以mtcars数据库为例\n\nggplot(counts1, aes(fill=cyl, values=Freq)) +\n  geom_waffle(color = \"white\",row=8) +\n  scale_fill_manual(values = c(\"#999999\", \"#E69F00\", \"#56B4E9\")) +\n  theme_void()+\n  geom_waffle(size = 0.1)\n\n\n\n\n以mtcars数据库为例\n\n\n\n\n这个图描述了mtcars数据中不同气缸数在总样本中所占的比例。\n\n\n2.4 分组\ngeom_waffle()可用于构建带有组和子组的华夫饼图。\nfill参数用于按组给图表上色。\n\nggplot(data = data, aes(fill=subgroup, values=value)) +\n  geom_waffle(color = \"white\", size = 1.125, n_rows = 6) +\n  facet_wrap(~group, ncol=1) +\ntheme_void()\n\n\n\n\n分组\n\n\n\n\n这个华夫饼图展示了data数据集中三个不同小组内各元素的分布情况\n美化图形\n通过使用scale_fill_manual()函数，可以自定义华夫饼图的颜色。\n\nggplot(data = data, aes(fill=subgroup, values=value)) +\n  geom_waffle(color = \"white\", size = 1.125, n_rows = 6) +\n  facet_wrap(~group, ncol=1) +\ntheme_void() +\n  scale_fill_manual(values = c(\"#69b3a2\", \"#404080\", \"#FFA07A\", \"#FFD700\", \"#FF6347\", \"#4682B4\"))\n\n\n\n\n美化图形\n\n\n\n\n这个华夫饼图展示了data数据集中三个不同小组内各元素的分布情况。",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Waffle Chart"
    ]
  },
  {
    "objectID": "Composition/Waffle.html#应用场景",
    "href": "Composition/Waffle.html#应用场景",
    "title": "华夫饼图",
    "section": "应用场景",
    "text": "应用场景\n\n\n\n\n\n\n图 1: 华夫饼图应用\n\n\n\n华夫饼图被用来展示不同因素对患者舒适度的影响程度。 [1]",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Waffle Chart"
    ]
  },
  {
    "objectID": "Composition/Waffle.html#参考文献",
    "href": "Composition/Waffle.html#参考文献",
    "title": "华夫饼图",
    "section": "参考文献",
    "text": "参考文献\n[1] Niehoff JH, Heuser A, Michael AE, Lennartz S, Borggrefe J, Kroeger JR. Patient Comfort in Modern Computed Tomography: What Really Counts. Tomography. 2022 May 23;8(3):1401-1412. doi: 10.3390/tomography8030113. PMID: 35645399; PMCID: PMC9149918.\n[2] Wickham, H. (2016). ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York. https://ggplot2.tidyverse.org\n[3] Rudis B, Gandy D (2023). waffle: Create Waffle Chart Visualizations. R package version 1.0.2,https://CRAN.R-project.org/package=waffle.\n[4] Wickham H, François R, Henry L, Müller K, Vaughan D (2023).dplyr: A Grammar of Data Manipulation. R package version 1.1.4, https://CRAN.R-project.org/package=dplyr.",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Waffle Chart"
    ]
  },
  {
    "objectID": "Composition/PartPieChart.html",
    "href": "Composition/PartPieChart.html",
    "title": "部分高亮饼图",
    "section": "",
    "text": "（图片来源于Unsplash的Amy Shamblen）\n饼图是数据可视化中常用的一种图表类型，能够直观地展示数据各部分所占的比例。通过将饼图的某些部分突起，可以更好地突出展示某些数据。",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Part Pie Chart"
    ]
  },
  {
    "objectID": "Composition/PartPieChart.html#示例",
    "href": "Composition/PartPieChart.html#示例",
    "title": "部分高亮饼图",
    "section": "",
    "text": "（图片来源于Unsplash的Amy Shamblen）\n饼图是数据可视化中常用的一种图表类型，能够直观地展示数据各部分所占的比例。通过将饼图的某些部分突起，可以更好地突出展示某些数据。",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Part Pie Chart"
    ]
  },
  {
    "objectID": "Composition/PartPieChart.html#环境配置",
    "href": "Composition/PartPieChart.html#环境配置",
    "title": "部分高亮饼图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：ggplot2, ggpubr, patchwork, dplyr\n\n\n# 安装包\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"plotrix\", quietly = TRUE)) {\n  install.packages(\"plotrix\")\n}\nif (!requireNamespace(\"ggforce\", quietly = TRUE)) {\n  install.packages(\"ggforce\")\n}\nif (!requireNamespace(\"ggpubr\", quietly = TRUE)) {\n  install.packages(\"ggpubr\")\n}\nif (!requireNamespace(\"patchwork\", quietly = TRUE)) {\n  install.packages(\"patchwork\")\n}\n\n# 加载包\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(plotrix)\nlibrary(ggforce)\nlibrary(ggpubr)\nlibrary(patchwork)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package   * version date (UTC) lib source\n dplyr     * 1.1.4   2023-11-17 [1] RSPM\n ggforce   * 0.5.0   2025-06-18 [1] RSPM\n ggplot2   * 4.0.1   2025-11-14 [1] RSPM\n ggpubr    * 0.6.2   2025-10-17 [1] RSPM\n patchwork * 1.3.2   2025-08-25 [1] RSPM\n plotrix   * 3.8-13  2025-11-15 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Part Pie Chart"
    ]
  },
  {
    "objectID": "Composition/PartPieChart.html#数据准备",
    "href": "Composition/PartPieChart.html#数据准备",
    "title": "部分高亮饼图",
    "section": "数据准备",
    "text": "数据准备\n\n# 生成模拟数据\ncount.data &lt;- data.frame(\n  class = c(\"1st\", \"2nd\", \"3rd\", \"Crew\"),\n  n = c(325, 285, 706, 885),\n  prop = c(14.8, 12.9, 32.1, 40.2)\n)\n# 添加标签位置\ncount.data &lt;- count.data %&gt;%\n  arrange(desc(class)) %&gt;%\n  mutate(lab.ypos = cumsum(prop) - 0.5*prop)\n# 查看最终的合并数据集\nhead(count.data)\n\n  class   n prop lab.ypos\n1  Crew 885 40.2    20.10\n2   3rd 706 32.1    56.25\n3   2nd 285 12.9    78.75\n4   1st 325 14.8    92.60",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Part Pie Chart"
    ]
  },
  {
    "objectID": "Composition/PartPieChart.html#可视化",
    "href": "Composition/PartPieChart.html#可视化",
    "title": "部分高亮饼图",
    "section": "可视化",
    "text": "可视化\n\n1. 基础绘图\n\n1.1 基础饼图\n\n# 基础饼图\nmycols &lt;- c(\"#0073C2FF\", \"#EFC000FF\", \"#868686FF\", \"#CD534CFF\")\np &lt;- \n  ggplot(count.data, aes(x = \"\", y = prop, fill = class)) +\n  geom_bar(width = 1, stat = \"identity\", color = \"white\") +\n  coord_polar(\"y\", start = 0)+\n  geom_text(aes(y = lab.ypos, label = prop), color = \"white\")+\n  scale_fill_manual(values = mycols) +\n  theme_void()\n\np\n\n\n\n\n\n\n\n图 1: 基础饼图\n\n\n\n\n\n\n\n1.2 中间空洞型饼图\n\n# 中间空洞型饼图\np2 &lt;- \n  ggplot(count.data, aes(x = 2, y = prop, fill = class)) +\n  geom_bar(stat = \"identity\", color = \"white\") +\n  coord_polar(theta = \"y\", start = 0) +\n  geom_text(aes(y = lab.ypos, label = prop), color = \"white\") +\n  scale_fill_manual(values = mycols) +\n  theme_void() +\n  xlim(0.5, 2.5)\n\np2\n\n\n\n\n\n\n\n图 2: 中间空洞型饼图\n\n\n\n\n\n\n\n\n2. 高阶作图\n\n2.1 3D 饼图\n\n# 创建数据框\n# 生成标签（组合类别和百分比）\nlabels &lt;- paste(count.data$class, \"\\n\", count.data$prop, \"%\", sep=\"\")\n\n# 绘制3D饼图\np3 &lt;- pie3D(\n  count.data$n,                # 使用数量作为数值\n  labels = labels,             # 自定义标签\n  explode = 0.1,               # 设置扇区间隔\n  main = \"3D Pie\",\n  col = rainbow(nrow(count.data)), # 使用彩虹色\n  labelcex = 1.2,              # 标签字体大小\n  theta = 1                    # 控制3D效果的角度\n)\n\n\n\n\n\n\n\n图 3: 3D 饼图\n\n\n\n\n\n\n\n2.2 部分高亮饼图\n\n# 创建数据框\ndata &lt;- data.frame(\n  gene = c(\"HRAS\", \"NRAS\", \"RET fusion\", \"MAP2K1\", \"ROS1 fusion\", \"ERBB2\", \n           \"ALK fusion\", \"MET ex14\",  \"BRAF\", \"EGFR\", \"KRAS\", \"None\", \"RIT1\",\n           \"ERBB2 amp\", \"MET amp\", \"NF1\"),\n  percentage = c(0.4, 0.4, 0.9, 0.9, 1.7, 1.7, 1.3, 4.3,  7.0, 11.3, 32.2, 24.4,\n                 2.2, 0.9, 2.2, 8.3)\n)\ndata$gene &lt;- factor(data$gene,levels = data$gene)\ndata$focus = c(rep(0, 12), rep(0.2, 4))\ndata$anno &lt;- ifelse(data$gene == \"KRAS\", \"KRAS\\n(32.2%)\",\n                    ifelse(data$gene == \"EGFR\", \"EGFR\\n(11.3%)\",\n                           ifelse(data$gene == \"BRAF\", \"BRAF\\n(7.0%)\",\n                                  ifelse(data$gene == \"None\", \"None\\n(24.4%)\",\n                                         ifelse(data$gene == \"NF1\", \"NF1\\n(8.3%)\", NA)))))\ndata &lt;- \n  data %&gt;%\n  mutate(end_angle = 2*pi*cumsum(percentage)/100,\n         start_angle = lag(end_angle, default = 0),\n         mid_angle = 0.5*(start_angle + end_angle)) %&gt;%\n  mutate(legend = paste0(gene,\" (\",percentage,\"%)\"))\n\ndata$legend &lt;- factor(data$legend,levels = data$legend)\n\ncol &lt;- c(\"#891619\",\"#040503\",\"#AF353D\",\"#CF5057\",\"#EE2129\",\"#E7604D\",\"#F58667\",\"#F7A387\",\"#FBC4AE\",\"#FDE2D6\",\"#FDF1EA\",\"#AAD9C0\",\"#0073AE\",\"#069BDA\",\"#68B0E1\",\"#B8CBE8\")\n\n# 使用ggplot绘制饼图\npie &lt;- \n  ggplot() +\n  geom_arc_bar(data=data, stat = \"pie\", # 在正常的笛卡尔坐标系中绘制饼图，不必使用极坐标\n               aes(x0=0,y0=0,r0=0,r=2, #需要甜甜圈图只需要将r0改为1即可\n                   amount=percentage,\n                   fill=gene,color=gene,\n                   explode=focus)) +\n  geom_arc(data=data[1:8,], size=1,color=\"black\",\n           aes(x0=0, y0=0, r=2.1, start = start_angle, end = end_angle)) +\n  geom_arc(data=data[11,], size=1,color=\"grey60\",\n           aes(x0=0, y0=0, r=2, start = start_angle-0.3, end = end_angle+0.3)) +\n  geom_arc(data=data[13:15,], size = 1,color=\"black\",\n           aes(x0=0,y0=0,r=2.3,size = index,start = start_angle, end = end_angle))+\n  annotate(\"text\", x=1.3, y=0.9, label=expression(atop(italic(\"BRAF\"),\"(7.0%)\")), \n           size=6, angle=0, hjust=0.5) +\n  annotate(\"text\", x=1.4, y=0.08, label=expression(atop(italic(\"EGFR\"),\"(11.3%)\")),\n           size=6, angle=0, hjust=0.5) +\n  annotate(\"text\", x=0.2, y=-1.1, label=expression(atop(italic(\"KRAS\"),\"(32.2%)\")),\n           size=6, angle=0, hjust=0.5) +\n  annotate(\"text\", x=-1.2, y=0.1, label=\"None\\n(24.4%)\", size=6, angle=0, \n           hjust=0.5) +\n  annotate(\"text\", x=-0.5, y=1.75, label=expression(atop(italic(\"NF1\"),\"(8.3%)\")),\n           size=6, angle=0, hjust=0.5) +\n  coord_fixed() +\n  theme_no_axes() +\n  scale_fill_discrete(breaks=data$gene[c(1:8, 13:15)],\n                      labels=data$legend[c(1:8, 13:15)], type=col) +\n  scale_color_discrete(breaks=data$gene[c(1:8, 13:15)],\n                       labels=data$legend[c(1:8, 13:15)], type=col) +\n  theme(panel.border = element_blank(),\n        legend.margin = margin(t = 1,r = 0,b = 0,l = 0,unit = \"cm\"),\n        legend.title = element_blank(),\n        legend.text = element_text(size=14),\n        legend.key.spacing.y = unit(0.3,\"cm\"),\n        legend.key.width = unit(0.4,\"cm\"),\n        legend.key.height = unit(0.4,\"cm\"))\n\npie\n\n\n\n\n\n\n\n图 4: 部分高亮饼图\n\n\n\n在癌症基因组研究中，饼图可以用来展示不同类型的基因突变（如点突变、插入、缺失等）在特定样本中的分布。",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Part Pie Chart"
    ]
  },
  {
    "objectID": "Composition/PartPieChart.html#应用场景",
    "href": "Composition/PartPieChart.html#应用场景",
    "title": "部分高亮饼图",
    "section": "应用场景",
    "text": "应用场景\n\n1. 疾病分布\n\n\n\n\n\n\n图 5: 疾病分布\n\n\n\n在流行病学研究中，饼图可以用来表示不同疾病在患者群体中所占的比例，比如不同癌症类型的分布。\n\n\n2. 细胞比例图\n\n\n\n\n\n\n图 6: 细胞比例图\n\n\n\n饼图可用于展示组织切片中不同细胞类型或组织成分的比例。",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Part Pie Chart"
    ]
  },
  {
    "objectID": "Composition/PartPieChart.html#参考文献",
    "href": "Composition/PartPieChart.html#参考文献",
    "title": "部分高亮饼图",
    "section": "参考文献",
    "text": "参考文献\n[1] Wickham, H. (2016). “ggplot2: Elegant Graphics for Data Analysis.” Springer.\n[2] Wickham, H. (2020). “ggplot2: Create Elegant Data Visualizations Using the Grammar of Graphics.” R package version 3.3.3.\n[3] Pedersen, T. L. (2020). “ggforce: Accelerating ggplot2.” R package version 0.3.2.\n[4] Kassambara, A. (2020). “ggpubr: ‘ggplot2’ Based Publication Ready Plots.” R package version 0.4.0.\n[5] Harris, R. (2019). “export: Export ‘ggplot2’ and ‘base’ Graphics in Various Formats.” R package version 0.5.1.\n[6] Rizzo, M. L. (2021). “ggplot2 for Beginners.” R Journal, 13(1), 84-91.\n[7] Ma, F., & Zhang, J. (2020). “Exploring the use of R for visualizing complex data types.” Journal of Open Source Software, 5(51), 2008.",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Part Pie Chart"
    ]
  },
  {
    "objectID": "TRANSLATION_GUIDE.html",
    "href": "TRANSLATION_GUIDE.html",
    "title": "自动翻译系统设置指南 / Auto-Translation Setup Guide",
    "section": "",
    "text": "English | 中文\n\n ## English\n\n\nThis repository includes an automatic translation system that translates QMD files between English and Chinese when you create or update pull requests.\n\n\n\n\nWhen you add/modify a .qmd file in a PR:\n\nIf you add Tutorial.qmd (English), the system automatically creates Tutorial.zh.qmd (Chinese)\nIf you add Tutorial.zh.qmd (Chinese), the system automatically creates Tutorial.qmd (English)\n\nWhen you add both language versions:\n\nThe system validates both files for spelling and grammar\nIt checks for consistency between the two versions\n\nThe translation is added to your PR automatically\n\nA bot will commit the translated file\nYou can review and edit the translation if needed\n\n\n\n\n\n\nEnglish files: filename.qmd\nChinese files: filename.zh.qmd\n\nExamples: - BarPlot.qmd ↔︎ BarPlot.zh.qmd - About.qmd ↔︎ About.zh.qmd\n\n\n\n✅ Translated: - Text content (paragraphs, headings, lists) - Image captions and alt text - YAML frontmatter (title, description, etc.)\n❌ NOT Translated: - Code blocks (R, Python, etc.) - URLs and links - File paths - Package names\n\n\n\nTo prevent certain files from being automatically translated, add them to .github/translation-blacklist.txt:\n# Add one pattern per line\nREADME.md\nTemplate/**\n**/test-*.qmd\n\n\n\nThe AI translation is good but not perfect. Please review: - Technical terms: Ensure biomedical terminology is correct - Code comments: Verify they make sense in context - Cultural adaptation: Some phrases may need adjustment - Formatting: Check that markdown is preserved correctly\nTo edit a translation: 1. Open the translated file in your PR 2. Click “Edit file” 3. Make your corrections 4. Commit the changes\n\n\n\nThe workflow supports multiple AI providers:\nOption 1: OpenAI (Default) 1. Obtain an API key from OpenAI Platform 2. Go to repository Settings → Secrets and variables → Actions 3. Create a secret named OPENAI_API_KEY 4. Paste your API key\nOption 2: Alternative Providers (e.g., Xiaomi MiMo) 1. Create three secrets in repository settings: - AI_Model_API_KEY: Your API key - AI_Model_BASE_URL: API endpoint (e.g., https://api.xiaomimomo.com/v1) - AI_Model_Name: Model name (e.g., mimo-v2-flash)\nNote: GitHub Copilot models are not directly accessible in GitHub Actions. Use OpenAI or alternative providers.\n\n\n\n\nDefault model: gpt-4o-mini (optimized for cost)\nAverage cost per translation: ~$0.01-0.05 USD (OpenAI pricing)\nMonthly cost (estimated): $5-20 USD depending on PR volume\nAlternative providers may have different pricing\n\n\n ## 中文\n\n\n\n本仓库包含自动翻译系统，在您创建或更新拉取请求时，自动在英文和中文之间翻译 QMD 文件。\n\n\n\n\n当您在 PR 中添加/修改 .qmd 文件时：\n\n如果您添加 Tutorial.qmd（英文），系统自动创建 Tutorial.zh.qmd（中文）\n如果您添加 Tutorial.zh.qmd（中文），系统自动创建 Tutorial.qmd（英文）\n\n当您同时添加两种语言版本时：\n\n系统验证两个文件的拼写和语法\n检查两个版本之间的一致性\n\n翻译会自动添加到您的 PR 中\n\n机器人会提交翻译后的文件\n您可以审查并在需要时编辑翻译\n\n\n\n\n\n\n英文文件：filename.qmd\n中文文件：filename.zh.qmd\n\n示例： - BarPlot.qmd ↔︎ BarPlot.zh.qmd - About.qmd ↔︎ About.zh.qmd\n\n\n\n✅ 会被翻译： - 文本内容（段落、标题、列表） - 图片说明和替代文本 - YAML 前置内容（标题、描述等）\n❌ 不会被翻译： - 代码块（R、Python 等） - URL 和链接 - 文件路径 - 包名称\n\n\n\n要防止某些文件被自动翻译，请将它们添加到 .github/translation-blacklist.txt：\n# 每行一个模式\nREADME.md\nTemplate/**\n**/test-*.qmd\n\n\n\nAI 翻译质量不错，但并非完美。请审查： - 专业术语：确保生物医学术语正确 - 代码注释：验证在上下文中是否合理 - 文化适配：某些短语可能需要调整 - 格式：检查 markdown 是否正确保留\n编辑翻译： 1. 在 PR 中打开翻译后的文件 2. 点击”编辑文件” 3. 进行修正 4. 提交更改\n\n\n\n工作流支持多种 AI 提供商：\n选项 1：OpenAI（默认） 1. 从 OpenAI Platform 获取 API 密钥 2. 转到仓库设置 → Secrets and variables → Actions 3. 创建名为 OPENAI_API_KEY 的密钥 4. 粘贴您的 API 密钥\n选项 2：替代提供商（如小米 MiMo） 1. 在仓库设置中创建三个密钥： - AI_Model_API_KEY：您的 API 密钥 - AI_Model_BASE_URL：API 端点（如 https://api.xiaomimomo.com/v1） - AI_Model_Name：模型名称（如 mimo-v2-flash）\n注意： GitHub Copilot 模型无法直接在 GitHub Actions 中访问。请使用 OpenAI 或其他替代提供商。\n\n\n\n\n默认模型：gpt-4o-mini（成本优化）\n每次翻译平均成本：约 0.01-0.05 美元（OpenAI 定价）\n月度成本（估算）：5-20 美元，取决于 PR 数量\n替代提供商可能有不同的定价\n\n\n\n\n\nFor issues or questions / 如有问题： - Open an issue in the repository / 在仓库中开启 issue - Tag maintainers: @ShixiangWang - See documentation: .github/scripts/README.md"
  },
  {
    "objectID": "TRANSLATION_GUIDE.html#support-支持",
    "href": "TRANSLATION_GUIDE.html#support-支持",
    "title": "自动翻译系统设置指南 / Auto-Translation Setup Guide",
    "section": "",
    "text": "For issues or questions / 如有问题： - Open an issue in the repository / 在仓库中开启 issue - Tag maintainers: @ShixiangWang - See documentation: .github/scripts/README.md"
  },
  {
    "objectID": "Animation/Interactivity.html",
    "href": "Animation/Interactivity.html",
    "title": "交互式图表",
    "section": "",
    "text": "交互式图表允许用户执行操作：缩放、将鼠标悬停在标记上以获得工具提示、选择要显示的变量等等。R提供了一组称为 的软件包html widgets：它们允许直接从 构建交互式数据可视化R。",
    "crumbs": [
      "<i class='fa-solid fa-seedling'></i> Animation",
      "Interactivity"
    ]
  },
  {
    "objectID": "Animation/Interactivity.html#示例",
    "href": "Animation/Interactivity.html#示例",
    "title": "交互式图表",
    "section": "示例",
    "text": "示例\n\n\n\n\n\n以上基础散点图可以直观地表示因变量y随着自变量x变化的一个大致趋势，可以看出，y大致随着x的增加而增大。",
    "crumbs": [
      "<i class='fa-solid fa-seedling'></i> Animation",
      "Interactivity"
    ]
  },
  {
    "objectID": "Animation/Interactivity.html#环境配置",
    "href": "Animation/Interactivity.html#环境配置",
    "title": "交互式图表",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：plotly, gapminder, ggiraph, webshot, tidyverse, chorddiag, streamgraph, htmlwidgets, dygraphs, xts, d3heatmap, patchwork\n\n\n# 安装包\nif (!requireNamespace(\"plotly\", quietly = TRUE)) {\n  install.packages(\"plotly\")\n}\nif (!requireNamespace(\"gapminder\", quietly = TRUE)) {\n  install.packages(\"gapminder\")\n}\nif (!requireNamespace(\"ggiraph\", quietly = TRUE)) {\n  install.packages(\"ggiraph\")\n}\nif (!requireNamespace(\"webshot\", quietly = TRUE)) {\n  install.packages(\"webshot\")\n}\nif (!requireNamespace(\"tidyverse\", quietly = TRUE)) {\n  install.packages(\"tidyverse\")\n}\nif (!requireNamespace(\"chorddiag\", quietly = TRUE)) {\n  remotes::install_github(\"mattflor/chorddiag\")\n}\nif (!requireNamespace(\"streamgraph\", quietly = TRUE)) {\n  remotes::install_github(\"hrbrmstr/streamgraph\")\n}\nif (!requireNamespace(\"htmlwidgets\", quietly = TRUE)) {\n  install.packages(\"htmlwidgets\")\n}\nif (!requireNamespace(\"dygraphs\", quietly = TRUE)) {\n  install.packages(\"dygraphs\")\n}\nif (!requireNamespace(\"xts\", quietly = TRUE)) {\n  install.packages(\"xts\")\n}\nif (!requireNamespace(\"d3heatmap\", quietly = TRUE)) {\n  install.packages(\"d3heatmap\")\n}\nif (!requireNamespace(\"patchwork\", quietly = TRUE)) {\n  install.packages(\"patchwork\")\n}\n\n# 加载包\nlibrary(plotly)\nlibrary(gapminder)\nlibrary(ggiraph)\nlibrary(webshot)\nlibrary(tidyverse)\nlibrary(chorddiag)\nlibrary(streamgraph)\nlibrary(htmlwidgets)\nlibrary(dygraphs)\nlibrary(xts)     \nlibrary(d3heatmap)\nlibrary(patchwork)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package     * version date (UTC) lib source\n chorddiag   * 0.1.3   2025-11-02 [1] Github (mattflor/chorddiag@1688d72)\n d3heatmap   * 0.9.0   2025-11-02 [1] Github (talgalili/d3heatmap@0ff4b83)\n dplyr       * 1.1.4   2023-11-17 [1] RSPM\n dygraphs    * 1.1.1.6 2018-07-11 [1] RSPM\n forcats     * 1.0.1   2025-09-25 [1] RSPM\n gapminder   * 1.0.1   2025-06-12 [1] RSPM\n ggiraph     * 0.9.2   2025-10-07 [1] RSPM\n ggplot2     * 4.0.1   2025-11-14 [1] RSPM\n htmlwidgets * 1.6.4   2023-12-06 [1] RSPM\n lubridate   * 1.9.4   2024-12-08 [1] RSPM\n patchwork   * 1.3.2   2025-08-25 [1] RSPM\n plotly      * 4.11.0  2025-06-19 [1] RSPM\n purrr       * 1.2.0   2025-11-04 [1] RSPM\n readr       * 2.1.6   2025-11-14 [1] RSPM\n streamgraph * 0.9.0   2025-11-02 [1] Github (hrbrmstr/streamgraph@76f7173)\n stringr     * 1.6.0   2025-11-04 [1] RSPM\n tibble      * 3.3.0   2025-06-08 [1] RSPM\n tidyr       * 1.3.2   2025-12-19 [1] RSPM\n tidyverse   * 2.0.0   2023-02-22 [1] RSPM\n webshot     * 0.5.5   2023-06-26 [1] RSPM\n xts         * 0.14.1  2024-10-15 [1] RSPM\n zoo         * 1.8-15  2025-12-15 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-seedling'></i> Animation",
      "Interactivity"
    ]
  },
  {
    "objectID": "Animation/Interactivity.html#数据准备",
    "href": "Animation/Interactivity.html#数据准备",
    "title": "交互式图表",
    "section": "数据准备",
    "text": "数据准备\n主要运用gapminder、TCGA数据集、GISAID数据库、R内置数据集。\n1. gapminder数据集\ngapminder包是一个R语言的数据包，它提供了来自Gapminder.org网站的一个数据集的摘录。这个数据集包含了142个国家从1952年到2007年每五年一次的人口、寿命和GDP等数据。\n\nhead(gapminder)\n\n# A tibble: 6 × 6\n  country     continent  year lifeExp      pop gdpPercap\n  &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;\n1 Afghanistan Asia       1952    28.8  8425333      779.\n2 Afghanistan Asia       1957    30.3  9240934      821.\n3 Afghanistan Asia       1962    32.0 10267083      853.\n4 Afghanistan Asia       1967    34.0 11537966      836.\n5 Afghanistan Asia       1972    36.1 13079460      740.\n6 Afghanistan Asia       1977    38.4 14880372      786.\n\n\n2. TCGA数据集\n选用TCGA Bile Duct Cancer (CHOL)这个数据集里面的DNA methylation数据。\n\ndata &lt;- readr::read_csv(\n\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/data.csv\")\nhead(data)\n\n# A tibble: 6 × 5\n   ...1 Composite Sample Methylation_Level Standardized_Level\n  &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;              &lt;dbl&gt;              &lt;dbl&gt;\n1     1         1 AA30              0.0276             -0.450\n2     2         1 AA0S              0.654               2.32 \n3     3         1 AAV9              0.0356             -0.415\n4     4         1 AA2X              0.0198             -0.485\n5     5         1 AA2U              0.0182             -0.492\n6     6         1 A8Y8              0.0323             -0.429\n\n\n3. 2020年新冠病毒感染的数据（数据来源于GISAID数据库）\n\ncovid_all &lt;- readr::read_csv(\n\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/covid_all.csv\")\ncovid_China &lt;- readr::read_csv(\n\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/covid_China.csv\")\nhead(covid_all)\n\n# A tibble: 6 × 6\n   ...1   X.1     X location      time       count\n  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;         &lt;date&gt;     &lt;dbl&gt;\n1     1     1     1 Africa        2020-01-01    17\n2     2     2     2 Asia          2020-01-01   787\n3     3     3     3 Europe        2020-01-01   119\n4     4     4     4 North America 2020-01-01    78\n5     5     5     5 South America 2020-01-01     2\n6     6     6     6 Africa        2020-02-01    14\n\nhead(covid_China)\n\n# A tibble: 6 × 3\n   ...1 time       count\n  &lt;dbl&gt; &lt;date&gt;     &lt;dbl&gt;\n1     1 2020-01-01    34\n2     2 2020-01-02     2\n3     3 2020-01-03     1\n4     4 2020-01-05     1\n5     5 2020-01-08     2\n6     6 2020-01-10     2\n\n\n4. R内置数据集——mtcars\n\nmtcars_db &lt;- rownames_to_column(mtcars, var = \"carname\")\nhead(mtcars_db)\n\n            carname  mpg cyl disp  hp drat    wt  qsec vs am gear carb\n1         Mazda RX4 21.0   6  160 110 3.90 2.620 16.46  0  1    4    4\n2     Mazda RX4 Wag 21.0   6  160 110 3.90 2.875 17.02  0  1    4    4\n3        Datsun 710 22.8   4  108  93 3.85 2.320 18.61  1  1    4    1\n4    Hornet 4 Drive 21.4   6  258 110 3.08 3.215 19.44  1  0    3    1\n5 Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2\n6           Valiant 18.1   6  225 105 2.76 3.460 20.22  1  0    3    1",
    "crumbs": [
      "<i class='fa-solid fa-seedling'></i> Animation",
      "Interactivity"
    ]
  },
  {
    "objectID": "Animation/Interactivity.html#可视化",
    "href": "Animation/Interactivity.html#可视化",
    "title": "交互式图表",
    "section": "可视化",
    "text": "可视化\n\n1. 气泡图（使用 plotly）\n以gapminder数据集\n\nplot1 &lt;- gapminder %&gt;%\n  filter(year==1977) %&gt;%\n  ggplot(aes(gdpPercap, lifeExp, size = pop, color=continent))+\n  geom_point() +\n  theme_bw()\nggplotly(plot1)\n\n\n\n气泡图（使用 plotly）\n\n\n这个气泡图描述了不同地区人均GDP和出生时预期寿命之间的关系，圆圈的大小表示人口数量。\n\n\n2. 热图（使用 plotly 和 d3heatmap）\n从 R 构建交互式热图有两种选项：\n\nPlotly：如上所述，Plotly允许将使用ggplot2制作的任何热力图转换为交互式。\nD3heatmap：一个使用与R基础热图函数heatmap()相同语法的包，用于制作交互式版本。\n\n\n2.1 plotly\n以TCGA数据库为例\n\nplot2 &lt;- ggplot(data, aes(x = Sample, y = Composite, fill= Standardized_Level)) +\n  geom_tile()\n\nggplotly(plot2)\n\n\n\nplotly\n\n\n这个热图描述了在 TCGA-CHOL 数据集中不同样本（Sample）和复合体（Composite）之间标准化甲基化水平（Standardized_Level）的分布，反映了不同样本在甲基化状态上的差异。\n\n\n2.2 d3heatmap\n以mtcars数据库为例\n\nd3heatmap(mtcars, scale=\"column\")\n\n\n\nd3heatmap\n\n\n这个热图描述了mtcars这个数据库里面不同款式汽车的不同属性。\n\n\n\n3. 流线图（使用streamgraph）\n以GISAID数据库为例\nstreamgraph包允许构建交互式流图，悬停在组上可以获取其名称及其确切值，这也是从R构建流图的唯一方法。\n\nstreamgraph(covid_all,key = \"location\",\n            value = \"count\",date = \"time\",\n            height=\"300px\", width=\"1000px\")\n\n\n\n\n\n\n\n图 1: streamgraph\n\n\n\n这个折线图描述了2020年新冠肺炎感染人数在全球不同地区的变化趋势。\n\n\n4. 和弦图（使用chorddiag包）\nchorddiag包允许使用 R 构建交互式和弦图。它需要一个方阵作为输入，提供将在圆周围显示的每对节点之间的流动强度。 一旦数据格式正确，该 chorddiag() 函数将自动为您构建图表。\n\n# 创建数据集\nm &lt;- matrix(\n  c(\n    11975, 5871, 8916, 2868,\n    1951, 10048, 2060, 6171,\n    8010, 16145, 8090, 8045,\n    1013, 990, 940, 6907\n  ),\n  byrow = TRUE,\n  nrow = 4, ncol = 4\n)\nhaircolors &lt;- c(\"black\", \"blonde\", \"brown\", \"red\")\ndimnames(m) &lt;- list(\n  have = haircolors,\n  prefer = haircolors\n)\ngroupColors &lt;- c(\"#000000\", \"#FFDD89\", \"#957244\", \"#F26223\")\n\n# 画图\np &lt;- chorddiag(m, groupColors = groupColors, groupnamePadding = 60)\np\n\n#将图像保存为html\n#saveWidget(p, file=paste0( getwd(), \"./chord_interactive.html\")) \n\n\n\n\n\n\n\n图 2: chorddiag\n\n\n\n\n\n5. 时间序列图（使用dygraphs包）\n\n# 数据整理，要注意把时间转换为 xts 的时间序列数据\ncovid_China$time &lt;- as.Date(covid_China$time, format = \"%Y-%m-%d\")\ndon &lt;- xts(x = covid_China$count, order.by = covid_China$time)\n\n# 画图\np &lt;- dygraph(don) %&gt;%\n  dyOptions(labelsUTC = TRUE, fillGraph=TRUE, \n            fillAlpha=0.1, drawGrid = FALSE, colors=\"#D8AE5A\") %&gt;%\n  dyRangeSelector() %&gt;%\n  dyCrosshair(direction = \"vertical\") %&gt;%\n  dyHighlight(highlightCircleSize = 5, \n              highlightSeriesBackgroundAlpha = 0.2, \n              hideOnMouseOut = FALSE)  %&gt;%\n  dyRoller(rollPeriod = 1)\n\np\n\n\n\n\n\n\n\n图 3: dygraphs\n\n\n\n这个时间序列图描述了2020年中国新冠肺炎人数的增长情况。\n\n\n6. ggiraph包\nR中的ggiraph包是ggplot2包的扩展，旨在简化创建交互式和动态图的过程。它是一个htmlwidget，这意味着它与RMarkdown/Quarto文档和Shiny应用程序高度兼容。\n\n6.1 基本用法\n这是一个使用 geom_point_interactive() 函数的示例，该函数“替代”了 ggplot2 中的原始 geom_point() 函数。它也会在图表上绘制圆圈，但这些圆圈将是交互式的。这个几何图形有一些新的参数，比如 hover_nearest = TRUE，这确保我们总是考虑最近的点 被悬停。\n以mtcars数据为例\n\n# 绘图\nmyplot &lt;- ggplot(\n  data = mtcars_db,\n  mapping = aes(\n    x = disp, y = qsec,\n    tooltip = carname, data_id = carname\n  )\n) +\n  geom_point_interactive(\n    size = 3, hover_nearest = TRUE\n  )\n\n# 把图像转换为交互式\ninteractive_plot &lt;- girafe(ggobj = myplot)\ninteractive_plot\n\n\n\n\n\n\n\n图 4: 以mtcars数据为例\n\n\n\n这个散点图展示了mtcars数据集里面不同汽车之间1/4英里用时与发动机排量之间的关系，鼠标接触原点可以显示每种汽车的名字。\n\n\n6.2 合并图表\n\n# 图一\nscatter &lt;- ggplot(\n  data = mtcars_db,\n  mapping = aes(\n    x = disp, y = qsec,\n    tooltip = carname, data_id = carname\n  )\n) +\n  geom_point_interactive(\n    size = 3, hover_nearest = TRUE\n  ) +\n  labs(\n    title = \"Displacement vs Quarter Mile\",\n    x = \"Displacement\", y = \"Quarter Mile\"\n  ) +\n  theme_bw()\n\n# 图二\nbar &lt;- ggplot(\n  data = mtcars_db,\n  mapping = aes(\n    x = reorder(carname, mpg), y = mpg,\n    tooltip = paste(\"Car:\", carname, \"&lt;br&gt;MPG:\", mpg),\n    data_id = carname\n  )\n) +\n  geom_col_interactive(fill = \"skyblue\") +\n  coord_flip() +\n  labs(\n    title = \"Miles per Gallon by Car\",\n    x = \"Car\", y = \"Miles per Gallon\"\n  ) +\n  theme_bw()\n\n# 合并两个图表\ncombined_plot &lt;- scatter + bar +\n  plot_layout(ncol = 2)\n\n# 把图像转换为交互式\ninteractive_plot_match &lt;- girafe(ggobj = combined_plot)\n\n# 设置交互式图表的选项\ninteractive_plot_match &lt;- girafe_options(\n  interactive_plot_match,\n  opts_hover(css = \"fill:cyan;stroke:black;cursor:pointer;\"),\n  opts_selection(type = \"single\", css = \"fill:red;stroke:black;\")\n)\n\ninteractive_plot_match\n\n\n\n\n\n\n\n图 5: 合并图表\n\n\n\n左图展示了mtcars数据集里面不同汽车之间1/4英里用时与发动机排量之间的关系，右图展示了不同汽车之间每加仑英里数的大小关系。通过两幅图交互式合并，可以直观快速获取每种汽车的性能。\n\n\n6.3 使用CSS自定义交互式图表\n虽然CSS主要用于设计网页，但它也可以在R中自定义视觉效果，在处理基于 Web 的输出（如交互式图表或 Shiny 应用程序）时较为方便。\n基础图形部分（以折线图为例）\n\n# 画图\nplot &lt;- covid_all %&gt;%\n  ggplot(mapping = aes(\n    x = time,\n    y = count,\n    color = location,\n    tooltip = location,\n    data_id = location\n  )) +\n  geom_line_interactive(hover_nearest = TRUE) +\n  theme_classic()\n\n#把图像转换为交互式\ninteractive_plot_line &lt;- girafe(ggobj = plot)\n\ninteractive_plot_line\n\n\n\n\n\n\n\n图 6: 使用CSS自定义交互式图表\n\n\n\n这个折线图描述了2020年新冠肺炎感染人数在全球不同地区的变化趋势，每条曲线代表不同大洲。\n\n\n6.4 添加CSS\n1. 添加填充效果\n在ggiraph中添加CSS最简单的方法是使用 girafe_options() 函数。\n\ninteractive_plot_line &lt;- girafe_options(\n  interactive_plot_line,\n  opts_hover(css = \"fill:#ffe7a6;stroke:black;cursor:pointer;\"),\n  opts_selection(type = \"single\", css = \"fill:red;stroke:black;\"),\n  opts_toolbar(saveaspng = FALSE)\n)\ninteractive_plot_line\n\n\n\n\n\n\n\n图 7: 添加填充效果\n\n\n\n这个折线图描述了2020年新冠肺炎感染人数在全球不同地区的变化趋势，每条曲线代表不同大洲。\n2. 突出显示某条曲线\n某条折线被选中的时候，其他折线自动淡化颜色\n以下是调整曲线的一些参数：\n\nstroke：更改悬停线的颜色（例如，stroke: #69B3A2;）\nstroke-width：增加悬停线的宽度以进行强调\ntransition：添加平滑过渡效果（例如，transition: all 0.3s ease;）\nopacity：降低非悬停线的不透明度（例如，opacity: 0.5;）\nfilter：对非悬停线应用灰度效果（例如，filter: grayscale(90%);）\n\n\ninteractive_plot_line2 &lt;- girafe_options(\n  interactive_plot_line,\n  opts_hover(css = \"stroke:#69B3A2; stroke-width: 3px; transition: all 0.3s ease;\"),\n  opts_hover_inv(\"opacity:0.5;filter:saturate(10%);\"),\n  opts_toolbar(saveaspng = FALSE)\n)\ninteractive_plot_line2\n\n\n\n\n\n\n\n图 8: 突出显示某条曲线\n\n\n\n这个折线图描述了2020年新冠肺炎感染人数在全球不同地区的变化趋势，每条曲线代表不同大洲。\n\n\n\n7. 将交互式图表保存到.PNG和.HTML\n可以将交互式图表保存为.html和两种.png格式。为此，您必须分别依赖htmlwidget和webshot包。然后可以使用标签在任何网页中嵌入您的可视iframe化img。\n\n#保存为html\nsaveWidget(p, file=\"myFile.html\")\n\n#保存为png\nwebshot::install_phantomjs()\nwebshot(\"paste_your_html_here\" , \"output.png\", delay = 0.2 , cliprect = c(440, 0, 1000, 10))",
    "crumbs": [
      "<i class='fa-solid fa-seedling'></i> Animation",
      "Interactivity"
    ]
  },
  {
    "objectID": "Animation/Interactivity.html#应用场景",
    "href": "Animation/Interactivity.html#应用场景",
    "title": "交互式图表",
    "section": "应用场景",
    "text": "应用场景\n交互式图表可以使研究数据更加直观\n\n\n\n\n\n\n图 9: 交互式图表应用\n\n\n\nKepler.gl 是由 Uber 开发并开源的一款强大的地理空间数据可视化工具，它旨在帮助用户快速、直观地探索和展示大规模地理空间数据集。[1]\n导入基础数据后可以自动生成交互式的散点图、柱状图、热力图，有助于更好呈现立足于不同地理位置上的研究数据。",
    "crumbs": [
      "<i class='fa-solid fa-seedling'></i> Animation",
      "Interactivity"
    ]
  },
  {
    "objectID": "Animation/Interactivity.html#参考文献",
    "href": "Animation/Interactivity.html#参考文献",
    "title": "交互式图表",
    "section": "参考文献",
    "text": "参考文献\n[1] https://zhuanlan.zhihu.com/p/365767977\n[2] Wickham, H., & François, R. (2019). dplyr: A Grammar of Data Manipulation (Version 1.0.0). https://CRAN.R-project.org/package=dplyr\n[3] Gohel, D., & Skintzos, P. (2024). ggiraph: Make ‘ggplot2’ Graphics Interactive. https://CRAN.R-project.org/package=ggiraph\n[4] Wickham, H., Hester, J., Chang, W., & Bryan, J. (2024). devtools: Tools to Make Developing R Packages Easier. R package version 2.4.5.9000. https://github.com/r-lib/devtools.\n[5] Allaire, J. J., & Xie, Y. (2018). webshot: Save Web Content as an Image File [Computer software]. Retrieved from https://CRAN.R-project.org/package=webshot\n[6] Wickham, H., Averick, M., Bryan, J., Chang, W., McGowan, L. D., François, R., … Yutani, H. (2019). tidyverse: Easily Install and Load the ‘Tidyverse’ (Version 1.2.1) [Computer software]. Retrieved from https://CRAN.R-project.org/package=tidyverse\n[7] Wickham, H., & Chang, W. (2016). ggplot2: Elegant Graphics for Data Visualization. Springer-Verlag New York.\n[8] Sievert, C. (2020). Interactive Web-Based Data Visualization with R, plotly, and shiny. Chapman and Hall/CRC. https://plotly-r.com\n[9] Bryan J (2023). gapminder: Data from Gapminder. https://github.com/jennybc/gapminder, https://www.gapminder.org/data/, https://doi.org/10.5281/zenodo.594018, https://jennybc.github.io/gapminder/.\n[11] Flor, M. (2018). chorddiag: Create a D3 Chord Diagram. https://rdrr.io/github/mattflor/chorddiag/\n[12] Hart, E., & Wickham, H. (2017). streamgraph: Create Streamgraph in R. https://CRAN.R-project.org/package=streamgraph\n[13] Vaidyanathan, R., Cheng, J., Allaire, J. J., Xie, Y., & Russell, K. (2018). htmlwidgets: HTML Widgets for R. https://github.com/ramnathv/htmlwidgets\n[14] anderkam, D., Shevtsov, P., Allaire, J. J., Owen, J., Gromer, D., & Thieurmel, B. (2011). dygraphs: Interface to ‘Dygraphs’ Interactive Time Series Charting Library. R package version 1.1.1.7. https://CRAN.R-project.org/package=dygraphs\n[15] Ryan, J. A., & Ulrich, J. M. (2024). xts: eXtensible Time Series. R package version 0.14.1. https://CRAN.R-project.org/package=xts\n[16] Grolemund, G., & Wickham, H. (2011). Dates and Times Made Easy with lubridate. Journal of Statistical Software, 40(3), 1–25. https://www.jstatsoft.org/v40/i03/\n[17] Cheng, J., Galili, T., RStudio, Inc., Bostock, M., & Palmer, J. (2019). d3heatmap: Interactive Heat Maps Using ‘htmlwidgets’ and ‘D3.js’. https://rdrr.io/cran/d3heatmap/",
    "crumbs": [
      "<i class='fa-solid fa-seedling'></i> Animation",
      "Interactivity"
    ]
  },
  {
    "objectID": "DataOverTime/StackedArea.html",
    "href": "DataOverTime/StackedArea.html",
    "title": "堆叠面积图",
    "section": "",
    "text": "堆叠面积图和基本面积图一样，唯一区别就是图上每一个数据集的起点是基于前一个数据集的，用于显示每个数值所占大小随时间或类别变化的趋势线，展示的是部分与整体的关系。",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Stacked Area Chart"
    ]
  },
  {
    "objectID": "DataOverTime/StackedArea.html#示例",
    "href": "DataOverTime/StackedArea.html#示例",
    "title": "堆叠面积图",
    "section": "示例",
    "text": "示例",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Stacked Area Chart"
    ]
  },
  {
    "objectID": "DataOverTime/StackedArea.html#环境配置",
    "href": "DataOverTime/StackedArea.html#环境配置",
    "title": "堆叠面积图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：ggplot2; dplyr; tidyverse; viridis; hrbrthemes; babynames; plotly\n\n\n# 安装包\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"tidyverse\", quietly = TRUE)) {\n  install.packages(\"tidyverse\")\n}\nif (!requireNamespace(\"viridis\", quietly = TRUE)) {\n  install.packages(\"viridis\")\n}\nif (!requireNamespace(\"hrbrthemes\", quietly = TRUE)) {\n  install.packages(\"hrbrthemes\")\n}\nif (!requireNamespace(\"babynames\", quietly = TRUE)) {\n  install.packages(\"babynames\")\n}\nif (!requireNamespace(\"plotly\", quietly = TRUE)) {\n  install.packages(\"plotly\")\n}\n\n# 加载包\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(tidyverse) \nlibrary(viridis)\nlibrary(hrbrthemes)\nlibrary(babynames)\nlibrary(plotly)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package     * version date (UTC) lib source\n babynames   * 1.0.1   2021-04-12 [1] RSPM\n dplyr       * 1.1.4   2023-11-17 [1] RSPM\n forcats     * 1.0.1   2025-09-25 [1] RSPM\n ggplot2     * 4.0.1   2025-11-14 [1] RSPM\n hrbrthemes  * 0.9.2   2025-11-02 [1] Github (hrbrmstr/hrbrthemes@d3fd029)\n lubridate   * 1.9.4   2024-12-08 [1] RSPM\n plotly      * 4.11.0  2025-06-19 [1] RSPM\n purrr       * 1.2.0   2025-11-04 [1] RSPM\n readr       * 2.1.6   2025-11-14 [1] RSPM\n stringr     * 1.6.0   2025-11-04 [1] RSPM\n tibble      * 3.3.0   2025-06-08 [1] RSPM\n tidyr       * 1.3.2   2025-12-19 [1] RSPM\n tidyverse   * 2.0.0   2023-02-22 [1] RSPM\n viridis     * 0.6.5   2024-01-29 [1] RSPM\n viridisLite * 0.4.2   2023-05-02 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Stacked Area Chart"
    ]
  },
  {
    "objectID": "DataOverTime/StackedArea.html#数据准备",
    "href": "DataOverTime/StackedArea.html#数据准备",
    "title": "堆叠面积图",
    "section": "数据准备",
    "text": "数据准备\n主要利用R包自带数据集和新冠感染数据进行绘图，data_covi19新冠感染数据来自GISAID数据库。\n\n# data_WorldPhones\ndata_WorldPhones &lt;- as.data.frame(WorldPhones)\ndata_WorldPhones &lt;- rownames_to_column(data_WorldPhones,\"year\")\ndata_WorldPhones &lt;- data_WorldPhones %&gt;%\n  gather(key = \"area\",value = \"Phones\",-\"year\" )\ndata_WorldPhones$year &lt;- as.numeric(data_WorldPhones$year)\n\n# data_USPersonalExpenditure\ndata_USPersonalExpenditure &lt;- USPersonalExpenditure\ndata_USPersonalExpenditure &lt;- as.data.frame(data_USPersonalExpenditure)\ndata_USPersonalExpenditure &lt;- rownames_to_column(data_USPersonalExpenditure,\"type\")\ndata_USPersonalExpenditure &lt;- data_USPersonalExpenditure %&gt;%\n  gather(key = \"year\",value = \"expense\",-\"type\" )\ndata_USPersonalExpenditure$year &lt;- as.numeric(data_USPersonalExpenditure$year)\n\n# data_baby\ndata_baby &lt;- babynames %&gt;% \n  filter(name %in% c(\"Ashley\", \"Amanda\", \"Jessica\", \"Patricia\", \"Linda\", \"Deborah\",   \"Dorothy\", \"Betty\", \"Helen\")) %&gt;%\n  filter(sex==\"F\")\n\n# data_covi19\ndata_covi19 &lt;- readr::read_csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/data_covi19.csv\")\ndata_covi19$date &lt;- c(6:12)\ndata_covi19 &lt;- gather(data_covi19, key = \"area\", value = \"cases\", 2:7)",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Stacked Area Chart"
    ]
  },
  {
    "objectID": "DataOverTime/StackedArea.html#可视化",
    "href": "DataOverTime/StackedArea.html#可视化",
    "title": "堆叠面积图",
    "section": "可视化",
    "text": "可视化\n\n1. 基础堆叠面积图\n以WorldPhones数据集为例\n\n#基础堆叠面积图----\noptions(scipen = 20)#不使用科学计数法\np &lt;- ggplot(data_WorldPhones, aes(x=year, y=Phones, fill=area)) + \n  geom_area()+\n  scale_y_continuous(limits = c(0, 150000),\n                     breaks = seq(0, 150000,50000))\n\np\n\n\n\n\n基础堆叠面积图\n\n\n\n\n上图展示了各区域随年份变化电话总数的堆积面积图。\n以2020年下半年全球各地区新冠新增感染例数数据为例。\n\np &lt;- ggplot(data_covi19, aes(x=date , y=cases, fill=area)) + \n  geom_area() +\n  scale_y_continuous() +\n  theme(plot.title = element_text(hjust = 0.5)) +\n  labs(x=\"month\") +\n  ggtitle(\"2020年下半年各地区新冠新增感染例数\")\n\np\n\n\n\n\n新冠新增感染例数数据\n\n\n\n\n上图横坐标表示月份，纵坐标为新冠感染新增例数。\n\n\n2. 比例堆叠面积图\n以 USPersonalExpenditure 数据集为例。\n\n# 计算数据百分比\ndata_USPersonalExpenditure1 &lt;- data_USPersonalExpenditure  %&gt;%\n  group_by(year, type) %&gt;%\n  summarise(n = sum(expense)) %&gt;%\n  mutate(percentage = n / sum(n))\n\n# 绘图\np &lt;- ggplot(data_USPersonalExpenditure1, aes(x=year, y=percentage, fill=type)) + \n  geom_area(alpha=0.8 , size=0.1, colour=\"black\")\n\np\n\n\n\n\n以 USPersonalExpenditure 数据集为例据\n\n\n\n\n上图展示了美国个人支出在不同消费类别占比随年份变化的堆叠面积图。\n以2020年下半年全球各地区新冠新增感染例数数据为例。\n\n# 计算数据百分比\ndata_covi19_percent &lt;- data_covi19  %&gt;%\n  group_by(date, area) %&gt;%\n  summarise(n = sum(cases)) %&gt;%\n  mutate(percentage = n / sum(n))\n\n# 绘图\np &lt;- ggplot(data_covi19_percent, aes(x=date, y=percentage, fill=area)) + \n  geom_area(alpha=0.8 , size=0.1, colour=\"black\") +\n  theme(plot.title = element_text(hjust = 0.5)) +\n  labs(x=\"month\") +\n  ggtitle(\"2020年下半年各地区新冠新增感染例数百分比堆积图\")\n\np\n\n\n\n\n新冠新增感染例数数据\n\n\n\n\n上图横坐标表示月份，纵坐标为各地区新冠感染新增例数百分比。\n\n\n3. 自定义美化\n\n#自定义----\np &lt;- ggplot(data_USPersonalExpenditure, aes(x=year, y=expense, fill=type)) + \n  geom_area(alpha=0.6 , size=.5, colour=\"white\") +\n  scale_fill_viridis(discrete = T) + #使用色阶\n  theme_ipsum() + #使用主体\n  ggtitle(\"美国个人支出（以十亿美元为单位）的类别\") #设置标题\n\np\n\n\n\n\n自定义美化\n\n\n\n\n\n\n4. 交互堆叠面积图\n利用plotly包，我们可以实现交互堆叠面积图的绘制。\n以babynames数据集为例\n\n#交互堆叠面积图（plotly）----\n#绘图\np1 &lt;- data_baby %&gt;% \n  ggplot( aes(x=year, y=n, fill=name, text=name)) +\n  geom_area( ) +\n  scale_fill_viridis(discrete = TRUE) +\n  theme(legend.position=\"none\") +\n  ggtitle(\"过去三十年美国各名字热度\") +\n  theme_ipsum() +\n  theme(legend.position=\"none\")\n\n#转化为可交互图形\np_inter1 &lt;- ggplotly(p1, tooltip=\"text\")\np_inter1\n\n\n\n交互堆叠面积图\n\n\n上图为可交互式堆叠条图，可以实现查看组别、放大缩小等功能。",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Stacked Area Chart"
    ]
  },
  {
    "objectID": "DataOverTime/StackedArea.html#应用场景",
    "href": "DataOverTime/StackedArea.html#应用场景",
    "title": "堆叠面积图",
    "section": "应用场景",
    "text": "应用场景\n\n\n\n\n\n\n图 1: 堆叠面积图应用\n\n\n\n肝脏中CS12至CS23（6个生物学独立胚胎样本和259个细胞）和血液中CS13至CS20（5个生物学独立胚胎样本和131个细胞）的不同骨髓祖细胞群的比例变化。 [1]",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Stacked Area Chart"
    ]
  },
  {
    "objectID": "DataOverTime/StackedArea.html#参考文献",
    "href": "DataOverTime/StackedArea.html#参考文献",
    "title": "堆叠面积图",
    "section": "参考文献",
    "text": "参考文献\n[1] Bian, Z., Gong, Y., Huang, T. et al. Deciphering human macrophage development at single-cell resolution. Nature 582, 571–576 (2020). https://doi.org/10.1038/s41586-020-2316-7\n[2] H. Wickham. ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York, 2016.\n[3] Wickham H, François R, Henry L, Müller K, Vaughan D (2023). dplyr: A Grammar of Data Manipulation. R package version 1.1.4, https://CRAN.R-project.org/package=dplyr.\n[4] Wickham H, Averick M, Bryan J, Chang W, McGowan LD, François R, Grolemund G, Hayes A, Henry L, Hester J, Kuhn M, Pedersen TL, Miller E, Bache SM, Müller K, Ooms J, Robinson D, Seidel DP, Spinu V, Takahashi K, Vaughan D, Wilke C, Woo K, Yutani H (2019). “Welcome to the tidyverse.” Journal of Open Source Software, 4(43), 1686. doi:10.21105/joss.01686 https://doi.org/10.21105/joss.01686.\n[5] Simon Garnier, Noam Ross, Robert Rudis, Antônio P. Camargo, Marco Sciaini, and Cédric Scherer (2024). viridis(Lite) - Colorblind-Friendly Color Maps for R. viridis package version 0.6.5.\n[6] C. Sievert. Interactive Web-Based Data Visualization with R, plotly, and shiny. Chapman and Hall/CRC Florida, 2020.\n[7] Wickham H (2021). babynames: US Baby Names 1880-2017. R package version 1.0.1, https://CRAN.R-project.org/package=babynames.\n[8] Rudis B (2024). hrbrthemes: Additional Themes, Theme Components and Utilities for ‘ggplot2’. R package version 0.8.7, https://CRAN.R-project.org/package=hrbrthemes.",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Stacked Area Chart"
    ]
  },
  {
    "objectID": "DataOverTime/Streamgraph.html",
    "href": "DataOverTime/Streamgraph.html",
    "title": "流线图",
    "section": "",
    "text": "流线图是一种堆叠区域图。它表示多个群体的数字变量的演变。通常在中心轴周围显示区域，边缘呈圆弧状以形成流动的形状。",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Streamgraph"
    ]
  },
  {
    "objectID": "DataOverTime/Streamgraph.html#示例",
    "href": "DataOverTime/Streamgraph.html#示例",
    "title": "流线图",
    "section": "示例",
    "text": "示例",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Streamgraph"
    ]
  },
  {
    "objectID": "DataOverTime/Streamgraph.html#环境配置",
    "href": "DataOverTime/Streamgraph.html#环境配置",
    "title": "流线图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：streamgraph, dplyr, htmlwidgets, ggplot2, ggstream\n\n\n# 安装包\nif (!requireNamespace(\"streamgraph\", quietly = TRUE)) {\n  remotes::install_github(\"hrbrmstr/streamgraph\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"htmlwidgets\", quietly = TRUE)) {\n  install.packages(\"htmlwidgets\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"ggstream\", quietly = TRUE)) {\n  install.packages(\"ggstream\")\n}\n\n# 加载包\nlibrary(streamgraph)\nlibrary(dplyr)\nlibrary(htmlwidgets)\nlibrary(ggplot2)\nlibrary(ggstream)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package     * version date (UTC) lib source\n dplyr       * 1.1.4   2023-11-17 [1] RSPM\n ggplot2     * 4.0.1   2025-11-14 [1] RSPM\n ggstream    * 0.1.0   2025-11-17 [1] Github (davidsjoberg/ggstream@a64b8d0)\n htmlwidgets * 1.6.4   2023-12-06 [1] RSPM\n streamgraph * 0.9.0   2025-11-02 [1] Github (hrbrmstr/streamgraph@76f7173)\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Streamgraph"
    ]
  },
  {
    "objectID": "DataOverTime/Streamgraph.html#数据准备",
    "href": "DataOverTime/Streamgraph.html#数据准备",
    "title": "流线图",
    "section": "数据准备",
    "text": "数据准备\n主要运用R内置数据集ChickWeight和一批2020年新冠感染的数据。\n\n# 1.R内置的data——ChickWeight\n## 此样本一共有50个样本，下面的数据集chick_new_2 选择了Diet为1的5个代表性样本\nchick_new_1 &lt;- subset(ChickWeight,Diet==\"1\")\nchick_new_2 &lt;- chick_new_1[c(1:12,144:155,73:95,156:167),]\n\n# 2.2020年新冠病毒感染的数据（数据来源于GISAID数据库）\n## 通过数据整理得到以下数据，covid_all表示每个月内不同地区感染新冠肺炎病毒的总人数\ncovid_all &lt;- readr::read_csv(\n\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/covid_all.csv\")\nhead(covid_all)\n\n# A tibble: 6 × 6\n   ...1   X.1     X location      time       count\n  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;         &lt;date&gt;     &lt;dbl&gt;\n1     1     1     1 Africa        2020-01-01    17\n2     2     2     2 Asia          2020-01-01   787\n3     3     3     3 Europe        2020-01-01   119\n4     4     4     4 North America 2020-01-01    78\n5     5     5     5 South America 2020-01-01     2\n6     6     6     6 Africa        2020-02-01    14\n\ncovid_month &lt;- readr::read_csv(\n\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/covid_month.csv\")\nhead(covid_month)\n\n# A tibble: 6 × 7\n   ...1   X.2   X.1     X location      month count\n  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt; &lt;dbl&gt;\n1     1     1     1     1 Africa            1    17\n2     2     2     2     2 Asia              1   787\n3     3     3     3     3 Europe            1   119\n4     4     4     4     4 North America     1    78\n5     5     5     5     5 South America     1     2\n6     6     6     6     6 Africa            2    14",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Streamgraph"
    ]
  },
  {
    "objectID": "DataOverTime/Streamgraph.html#可视化",
    "href": "DataOverTime/Streamgraph.html#可视化",
    "title": "流线图",
    "section": "可视化",
    "text": "可视化\n\n1. 基本绘图（运用streamgraph包）\n可以用简单的几行代码构建流线图。\n\n1.1 基本代码\n以2020年新冠病毒感染的数据为例\n\nstreamgraph(covid_all, key = \"location\",\n            value = \"count\",date = \"time\",\n            height=\"300px\", width=\"1000px\")\n\n\n\n\n基本绘图\n\n\n这个流线图描述了不同地区在2020年不同时间段感染新冠病毒的人数。\n运用streamgraph包创作的流线图，可直接将鼠标放在不同颜色上，图形会直接显示具体信息；也可以通过下拉按钮知道每个样本的具体情况。\n\n\n1.2 添加下拉按钮\n通过sg_legend()函数，添加下拉按钮。与其他streamgraph()选项不同，sg_legend()是在管道命令（%&gt;%）之后使用的。\n\nstreamgraph(covid_all, key = \"location\",\n            value = \"count\",date = \"time\",\n            height=\"300px\", width=\"1000px\") %&gt;%\n  sg_legend(show=TRUE, label=\"location: \")\n\n\n\n\n添加下拉按钮\n\n\n\n\n1.3 改变形状\n可通过调整interpolate参数改变流线图形状\n\nstreamgraph(covid_all, key = \"location\",\n            value = \"count\",date = \"time\",\n            interpolate=\"step\",\n            height=\"300px\", width=\"1000px\") %&gt;%\nsg_legend(show=TRUE, label=\"location: \")\n\n\n\n\n改变形状\n\n\n这个流线图描述了不同地区在2020年不同时间段感染新冠病毒的人数。\n\n\n1.4 改变颜色\n\nscale_fill_brewer()：使用一个 R ColorBrewer调色板，包括连续和分类的。\nscale_fill_manual()：构建自定义颜色调色板：只需提供一个包含所选颜色的向量即可。\n\n\nstreamgraph(covid_all,key = \"location\",\n            value = \"count\",date = \"time\",\n            interpolate=\"linear\",\n            height=\"300px\", width=\"1000px\") %&gt;%\n  sg_fill_brewer(\"Reds\")\n\n\n\n\n改变颜色\n\n\n这个流线图描述了不同地区在2020年不同时间段感染新冠病毒的人数。\n\n\n\n2. 流线图的偏移\n有以下三种情况：\n\nsilhouette: 形状显示在水平轴的两侧\nzero: 显示在0线之上。\nexpand: 相当于百分比堆积面积图，完整高度用于可视化百分比。\n\n\n2.1 silhouette\n\nstreamgraph(covid_all,key = \"location\",\n            value = \"count\",date = \"time\",\n            offset=\"silhouette\",\n            height=\"300px\", width=\"1000px\")\n\n\n\n\nsilhouette\n\n\n这个流线图描述了不同地区在2020年不同时间段感染新冠病毒的人数。\n\n\n2.2 zero\n\nstreamgraph(covid_all,key = \"location\",\n            value = \"count\",date = \"time\",\n            offset=\"zero\",\n            height=\"300px\", width=\"1000px\")\n\n\n\n\nzero\n\n\n这个流线图描述了不同地区在2020年不同时间段感染新冠病毒的人数。\n\n\n2.3 expand\n\nstreamgraph(covid_all,key = \"location\",\n            value = \"count\",date = \"time\",\n            offset=\"expand\",\n            height=\"300px\", width=\"1000px\")\n\n\n\n\nexpand\n\n\n这个流线图描述了不同地区在2020年不同时间段感染新冠病毒的人数。\n\n\n\n3. 将图表保存为html文件\n使用htmlwidgets包的saveWidget()函数\n\npp &lt;- streamgraph(chick_new,key = \"Chick\",\n                  value = \"weight\",date = \"Time\",\n                  height=\"300px\", width=\"1000px\")\nsaveWidget(pp, file=paste0( getwd(), \"/HtmlWidget/streamgraphDropdown.html\"))\n\n\n\n4. 基本绘图（运用ggplot2包）\n与streamgraph包相比，ggplot2包可以自定义更加详细的内容。\n\n4.1 基本代码\n以2020年新冠病毒感染的数据为例。\n\ncovid_all %&gt;% \n  ggplot(aes(time, count, fill = location, label = location, color = location)) +\n  geom_area()\n\n\n\n\n基本代码\n\n\n\n\n这个流线图描述了不同地区在2020年不同时间段感染新冠病毒的人数。\n\n\n4.2 美化图形\n\n调整曲线形状：geom_stream()\n调整颜色：scale_fill_manual()和scale_color_manual()\n\n\ncovid_all %&gt;% \n  ggplot(aes(time, count, fill = location, label = location, color = location))  +\n  geom_stream(type = \"ridge\", bw=1) \n\n\n\n\n美化图形\n\n\n\n\n这个流线图描述了不同地区在2020年不同时间段感染新冠病毒的人数。\n\n\n4.3 以ChickWeight数据为例\n\nchick_new_2 %&gt;% \n  ggplot(aes(Time, weight, fill = Chick, label = Chick, color = Chick)) +\n  geom_area()\n\n\n\n\n以ChickWeight数据为例\n\n\n\n\n这个流线图描述了不同小鸡体重随时间的变化情况。",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Streamgraph"
    ]
  },
  {
    "objectID": "DataOverTime/Streamgraph.html#应用场景",
    "href": "DataOverTime/Streamgraph.html#应用场景",
    "title": "流线图",
    "section": "应用场景",
    "text": "应用场景\n\n\n\n\n\n\n图 1: 流线图应用\n\n\n\n这个流线图显示了流感谱系循环的时间变化。 [1]",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Streamgraph"
    ]
  },
  {
    "objectID": "DataOverTime/Streamgraph.html#参考文献",
    "href": "DataOverTime/Streamgraph.html#参考文献",
    "title": "流线图",
    "section": "参考文献",
    "text": "参考文献\n[1] Dhanasekaran V, Sullivan S, Edwards KM, Xie R, Khvorov A, Valkenburg SA, Cowling BJ, Barr IG. Human seasonal influenza under COVID-19 and the potential consequences of influenza lineage elimination. Nat Commun. 2022 Mar 31;13(1):1721. doi: 10.1038/s41467-022-29402-5. PMID: 35361789; PMCID: PMC8971476.\n[2] Wickham, H., & François, R. (2019). dplyr: A Grammar of Data Manipulation (Version x.y.z). Retrieved from https://CRAN.R-project.org/package=dplyr\n[3] Rudis, B. (2015). streamgraph: An htmlwidget for building streamgraph visualizations. Retrieved from https://github.com/hrbrmstr/streamgraph\n[4] Wickham, H., & Romain François. (2024). devtools: Tools to Make Developing R Packages Easier (Version 2.4.5). Retrieved from [https://CRAN.R-project.org/package=devtools](https://cran.r-project.org/package=devtools\n[5] Vaidyanathan R, Cheng J, Allaire JJ, Xie Y. htmlwidgets: HTML Widgets for R. R package version 1.6.4. 2023. Available from: https://CRAN.R-project.org/package=htmlwidgets.\n[6] David Sjoberg (2021). ggstream: Create Streamplots in ‘ggplot2’. R package version 0.1.0. https://CRAN.R-project.org/package=ggstream",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Streamgraph"
    ]
  },
  {
    "objectID": "DataOverTime/Timeseries.html",
    "href": "DataOverTime/Timeseries.html",
    "title": "时间序列图",
    "section": "",
    "text": "时间序列图是以时间为横轴，观察变量为纵轴的统计图，反映观察变量随着时间的变化趋势。",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Timeseries"
    ]
  },
  {
    "objectID": "DataOverTime/Timeseries.html#示例",
    "href": "DataOverTime/Timeseries.html#示例",
    "title": "时间序列图",
    "section": "示例",
    "text": "示例\n\n\n\n\n\n如图是一个时间序列图，图中的横坐标是日期，纵坐标的psavert是观测变量，可以看出psavert随着时间总体上有着下降的趋势。",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Timeseries"
    ]
  },
  {
    "objectID": "DataOverTime/Timeseries.html#环境配置",
    "href": "DataOverTime/Timeseries.html#环境配置",
    "title": "时间序列图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：ggplot2, patchwork, dplyr\n\n\n# 安装包\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"patchwork\", quietly = TRUE)) {\n  install.packages(\"patchwork\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n} \n\n# 加载包\nlibrary(ggplot2)\nlibrary(patchwork)\nlibrary(dplyr)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package   * version date (UTC) lib source\n dplyr     * 1.1.4   2023-11-17 [1] RSPM\n ggplot2   * 4.0.1   2025-11-14 [1] RSPM\n patchwork * 1.3.2   2025-08-25 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Timeseries"
    ]
  },
  {
    "objectID": "DataOverTime/Timeseries.html#数据准备",
    "href": "DataOverTime/Timeseries.html#数据准备",
    "title": "时间序列图",
    "section": "数据准备",
    "text": "数据准备\n使用R自带的economics数据集和PhysioNet数据库中的受试者定量脱水估计数据 [1]。\n\n# 1.economics数据集\ndata &lt;- economics[1:60, c(1, 4)]\n\nhead(data)\n\n# A tibble: 6 × 2\n  date       psavert\n  &lt;date&gt;       &lt;dbl&gt;\n1 1967-07-01    12.6\n2 1967-08-01    12.6\n3 1967-09-01    11.9\n4 1967-10-01    12.9\n5 1967-11-01    12.8\n6 1967-12-01    11.8\n\ndata_double &lt;- economics[1:60, c(1, 4, 5)]   #此数据用于子图合并和双y轴\n\nhead(data_double)\n\n# A tibble: 6 × 3\n  date       psavert uempmed\n  &lt;date&gt;       &lt;dbl&gt;   &lt;dbl&gt;\n1 1967-07-01    12.6     4.5\n2 1967-08-01    12.6     4.7\n3 1967-09-01    11.9     4.6\n4 1967-10-01    12.9     4.9\n5 1967-11-01    12.8     4.7\n6 1967-12-01    11.8     4.8\n\n# 2.定量脱水估计数据\ndata_water &lt;- read.csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/dehydration_estimation.csv\", header = T)\n\naxis_name &lt;- colnames(data_water)[c(5, 8)]        # 记录列名\ndata_water &lt;- data_water %&gt;%                      # 选取2组数据\n  slice(c(19:27, 46:54)) %&gt;%\n  select(c(1, 5, 8)) %&gt;%        \n  setNames(c(\"V1\", \"V2\", \"V3\")) %&gt;%               # 更改列名\n  mutate(V4 = case_when(V1 == 3 ~ \"people1\",      # V4列作为分类标签\n                        V1 == 6 ~ \"people2\"))\n\nhead(data_water)\n\n  V1 V2   V3      V4\n1  3  0 53.0 people1\n2  3  1 53.2 people1\n3  3  2 53.6 people1\n4  3  3 53.2 people1\n5  3  4 53.3 people1\n6  3  5 53.1 people1",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Timeseries"
    ]
  },
  {
    "objectID": "DataOverTime/Timeseries.html#可视化",
    "href": "DataOverTime/Timeseries.html#可视化",
    "title": "时间序列图",
    "section": "可视化",
    "text": "可视化\n\n1. 基本绘图\n\n# 基本绘图\np &lt;- ggplot(data, aes(x = date, y = psavert)) +\n  geom_line() +\n  xlab(\"\")\n\np\n\n\n\n\n基本绘图\n\n\n\n\n上图以日期为x轴，观测变量为y轴，geom_line()绘制线段就可以得到基本的时间序列图。\n\n\n2. 显示观测点\n\n# geom_point()显示观测点\np &lt;- ggplot(data, aes(x = date, y = psavert)) +\n  geom_line() +\n  xlab(\"\") +\n  geom_point()\n\np\n\n\n\n\n显示观测点\n\n\n\n\n图中使用geom_point()显示观测点。\n\n\n3. 多类数据绘图\n\n# 多类数据绘图\np &lt;- ggplot(data_water, aes(x = V2, y = V3, group = V4)) +     #V4分类标签映射到分组和颜色特征\n  geom_line(aes(color = V4)) +\n  geom_point(aes(color = V4)) +\n  ylab(axis_name[2]) +                      #添加坐标轴标签\n  xlab(axis_name[1]) +\n  #更改图例位置\n  theme(legend.position = \"inside\", legend.position.inside = c(0.85, 0.85))\n\np\n\n\n\n\n多类数据绘图\n\n\n\n\n图中绘制了两个受试者跑步期间的体内水分变化。\n\n\n4. 更改x轴日期标签\n\n4.1 设置日期标签的格式\n\n# 使用scale_x_date()设置日期\np &lt;- ggplot(data, aes(x = date, y = psavert)) +\n  geom_line() +\n  xlab(\"\") + \n  geom_point() + \n  scale_x_date(date_labels = \"%Y-%m\")  \n\np\n\n\n\n\n设置日期标签的格式\n\n\n\n\n图中的x轴标签被更改成了年-月的形式。\n\n\n\n\n\n\n提示\n\n\n\n关键参数: date_labels\nscale_x_date中的参数date_labels决定x轴日期文本的格式，其中\n\n“%Y”：带有世纪的年（如2024）\n“%y”：不带世纪的年（如24）\n“%m”：月份（范围00-12）\n“%d”：某月的第几天（范围01-31）\n\n这些可以单独和随意组合，更多的详细内容在R语言的help栏的strftime中了解。\n\n\n\n\n4.2 设置日期标签的显示间隔\n\n# 使用scale_x_date()设置日期标签的显示间隔\np &lt;- ggplot(data, aes(x = date, y = psavert)) +\n  geom_line() +\n  xlab(\"\") + \n  geom_point() + \n  scale_x_date(date_labels = \"%Y/%m\",date_breaks = \"9 month\")\n\np\n\n\n\n\n设置日期标签的显示间隔\n\n\n\n\n图中使用scale_x_date中的参数date_breaks更改日期标签的显示间隔。\n\n\n\n\n\n\n提示\n\n\n\n关键参数: date_breaks\nshape 为点的形状，可选值为0-25，具体形状见下图:\nscale_x_date中的参数date_breaks决定日期的标签间隔，形如\n“2 year”、“1 month”、“2 weeks”，单位有’sec’(秒), ‘min’(分), ‘hour’(时), ‘day’(天), ‘week’(周), ‘month’ (月)或 ‘year’(年)。’s’复数形式可加可不加。\n\n\n\n\n\n5. 调整标签角度\n\n# 通过theme()调整标签角度\np &lt;- ggplot(data, aes(x = date, y = psavert)) +\n  geom_line() +\n  xlab(\"\") + \n  geom_point() + \n  scale_x_date(date_labels = \"%Y/%m\",date_breaks = \"3 month\")+\n  theme(axis.text.x = element_text(angle = 60, hjust = 1))     # angle参数调整标签角度，hjust=1是标签名称水平最右端与标签刻度对齐\n\np\n\n\n\n\n调整标签角度\n\n\n\n\n图中调整标签角度有效避免了标签重叠。\n\n\n6. 限制时间范围\n\n# 通过scale_x_date()的limit参数截取时间段图像\np &lt;- ggplot(data, aes(x = date, y = psavert)) +\n  geom_line() +\n  xlab(\"\") + \n  geom_point() + \n  scale_x_date(date_labels = \"%Y/%m\",date_breaks = \"3 month\",\n               limit = c(as.Date(\"1968-01-01\"), as.Date(\"1969-12-01\")))+\n  theme(axis.text.x = element_text(angle = 60, hjust = 1))\n\np\n\n\n\n\n限制时间范围\n\n\n\n\n图中使用了scale_x_date中的limit参数只截取了1968-01-01到1969-12-01的数据。\n\n\n7. 注释和分割线\n\n# 注释和分割线\np &lt;- ggplot(data, aes(x = date, y = psavert)) +\n  geom_line() +\n  xlab(\"\") + \n  geom_point() + \n  scale_x_date(date_labels = \"%Y/%m\",date_breaks = \"3 month\")+\n  theme(axis.text.x = element_text(angle = 60, hjust = 1))+\n# 注释文本\n  annotate(geom=\"text\",x=as.Date(\"1971-06-01\"),y=14.7,label=\"MAX of pasavert\")+\n# 注释点  \n  annotate(geom=\"point\",x=as.Date(\"1971-06-01\"),y=14.7,color=\"red\")+\n# 添加水平线\n  geom_hline(yintercept=13.5,color=\"blue\")\n\np\n\n\n\n\n注释和分割线\n\n\n\n\n图中使用annotate()标记了最高点并注明标签，又使用geom_hline()绘制水平分割线。\n\n\n8. 子图合并\n\n# 子图显示在一张图上，需要载入patchwork\np &lt;- ggplot(data_double, aes(x = date, y = psavert)) +\n  geom_line() +\n  xlab(\"\")\n\np1 &lt;- ggplot(data_double, aes(x = date, y = uempmed)) +\n  geom_line() +\n  xlab(\"\")\n\np + p1          #子图合并\n\n\n\n\n子图合并\n\n\n\n\n图中使用patchwork包可以将子图放在一个图上。\n\n\n9. 双y轴\n\n#双y轴，使用sec.axis设置第二个y轴\np &lt;- ggplot(data_double, aes(x = date)) +\n  geom_line(aes(y = psavert),color = \"red\") +\n  geom_line(aes(y = uempmed * 3),color = \"blue\") +      #刻度不一致因此要乘倍数\n  xlab(\"\")+\n  scale_y_continuous(\n    name = \"psavert\",\n# transform将左边y轴坐标除以上面倍数，name设置名称\n    sec.axis = sec_axis(transform = ~ . / 3, name = \"uempmed\")   \n  ) +\n# 设置双y轴的标题，与相应线段同色，便于区分\n  theme(\n    axis.title.y = element_text(color = \"red\", size = 13),\n    axis.title.y.right = element_text(color = \"blue\", size = 13),\n    legend.position = \"none\"\n  )\n\np\n\n\n\n\n双y轴\n\n\n\n\n图中的双y轴有着不同的刻度，线颜色对应y标签颜色。",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Timeseries"
    ]
  },
  {
    "objectID": "DataOverTime/Timeseries.html#应用场景",
    "href": "DataOverTime/Timeseries.html#应用场景",
    "title": "时间序列图",
    "section": "应用场景",
    "text": "应用场景\n\n\n\n\n\n\n图 1: 时间序列图应用1\n\n\n\n图中显示了2005年至2022年出生队列中不同剂量含腮腺炎疫苗的覆盖率。 [1]\n\n\n\n\n\n\n图 2: 时间序列图应用2\n\n\n\n任何方式和低剂量计算机断层扫描（LDCT）的肺癌癌症筛查医疗差距的总体受益水平（图A）和患者受益水平（图B）。 [2]\n\n\n\n\n\n\n图 3: 时间序列图应用3\n\n\n\n8名健康志愿者口服阿哌沙班25µg单独给药后（基线；红色符号和线）和利托那韦治疗第5天（蓝色标记和线）的几何平均血浆浓度-时间曲线（±95%置信区间）。 [3]",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Timeseries"
    ]
  },
  {
    "objectID": "DataOverTime/Timeseries.html#参考文献",
    "href": "DataOverTime/Timeseries.html#参考文献",
    "title": "时间序列图",
    "section": "参考文献",
    "text": "参考文献\n[1] FU C, XU W, ZHENG W, et al. Epidemiological characteristics and interrupted time series analysis of mumps in Quzhou City, 2005-2023[J]. Hum Vaccin Immunother, 2024,20(1): 2411828.\n[2] KUKHAREVA P V, LI H, CAVERLY T J, et al. Lung Cancer Screening Before and After a Multifaceted Electronic Health Record Intervention: A Nonrandomized Controlled Trial[J]. JAMA Netw Open, 2024,7(6): e2415383.\n[3] ROHR B S, KROHMER E, FOERSTER K I, et al. Time Course of the Interaction Between Oral Short-Term Ritonavir Therapy with Three Factor Xa Inhibitors and the Activity of CYP2D6, CYP2C19, and CYP3A4 in Healthy Volunteers[J]. Clin Pharmacokinet, 2024,63(4): 469-481.",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Timeseries"
    ]
  },
  {
    "objectID": "Proportion/Sankey.html",
    "href": "Proportion/Sankey.html",
    "title": "桑基图",
    "section": "",
    "text": "桑基图允许研究流量。实体（节点）由矩形或文本表示，箭头或弧线用于显示它们之间的流量，宽度与流量的重要性成正比。在 R 中，networkD3 包是构建它们的最佳方式。",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Sankey Diagram"
    ]
  },
  {
    "objectID": "Proportion/Sankey.html#示例",
    "href": "Proportion/Sankey.html#示例",
    "title": "桑基图",
    "section": "示例",
    "text": "示例\n\n\n\n\n\n这张图表使用桑基曲线图可视化了过去几十年夏季档电影的类型分布情况。它重点展示了三种最常见的类型（剧情片、喜剧片和爱情片），并显示了它们的比例随时间的变化。",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Sankey Diagram"
    ]
  },
  {
    "objectID": "Proportion/Sankey.html#环境配置",
    "href": "Proportion/Sankey.html#环境配置",
    "title": "桑基图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：ggplot2, networkD3, dplyr, readxl, webshot, tidyverse, openxlsx, ggalluvial\n\n\n# 安装包\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"networkD3\", quietly = TRUE)) {\n  install.packages(\"networkD3\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"readxl\", quietly = TRUE)) {\n  install.packages(\"readxl\")\n}\nif (!requireNamespace(\"webshot\", quietly = TRUE)) {\n  install.packages(\"webshot\")\n}\nif (!requireNamespace(\"tidyverse\", quietly = TRUE)) {\n  install.packages(\"tidyverse\")\n}\nif (!requireNamespace(\"openxlsx\", quietly = TRUE)) {\n  install.packages(\"openxlsx\")\n}\nif (!requireNamespace(\"ggalluvial\", quietly = TRUE)) {\n  install.packages(\"ggalluvial\")\n}\n\n# 加载包\nlibrary(ggplot2)   \nlibrary(networkD3)   \nlibrary(dplyr)  \nlibrary(readxl) \nlibrary(webshot)   \nlibrary(tidyverse)   \nlibrary(openxlsx)\nlibrary(ggalluvial)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n dplyr      * 1.1.4   2023-11-17 [1] RSPM\n forcats    * 1.0.1   2025-09-25 [1] RSPM\n ggalluvial * 0.12.5  2023-02-22 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n lubridate  * 1.9.4   2024-12-08 [1] RSPM\n networkD3  * 0.4.1   2025-04-14 [1] RSPM\n openxlsx   * 4.2.8.1 2025-10-31 [1] RSPM\n purrr      * 1.2.0   2025-11-04 [1] RSPM\n readr      * 2.1.6   2025-11-14 [1] RSPM\n readxl     * 1.4.5   2025-03-07 [1] RSPM\n stringr    * 1.6.0   2025-11-04 [1] RSPM\n tibble     * 3.3.0   2025-06-08 [1] RSPM\n tidyr      * 1.3.2   2025-12-19 [1] RSPM\n tidyverse  * 2.0.0   2023-02-22 [1] RSPM\n webshot    * 0.5.5   2023-06-26 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Sankey Diagram"
    ]
  },
  {
    "objectID": "Proportion/Sankey.html#数据准备",
    "href": "Proportion/Sankey.html#数据准备",
    "title": "桑基图",
    "section": "数据准备",
    "text": "数据准备\n以下是一个使用临床数据库中某种药物临床数据的简要教程。该数据集研究了药物对患者血糖水平的影响，血糖水平分为三个等级：低血糖（&lt;3.9 mmol/L）、正常血糖（3.9-6.1 mmol/L）和高血糖（&gt;6.1 mmol/L）。药物给药前后血糖水平变化的绝对值用“value”表示。本示例演示了如何加载和处理这些数据集。\n\n# 读取药物临床数据集\ndrugs &lt;- read.csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/drugs.csv\", stringsAsFactors = FALSE)\n# 创建一个节点数据框\nnodes &lt;- data.frame(\n  name=c(as.character(drugs$source), \n         as.character(drugs$target)) %&gt;% unique())\n# 重新格式化\ndrugs$IDsource &lt;- match(drugs$source, nodes$name)-1 \ndrugs$IDtarget &lt;- match(drugs$target, nodes$name)-1\n\n\n# 读取药物临床数据集\ndrug &lt;- read.csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/drug.csv\", stringsAsFactors = FALSE)\nlevels(drug$`glucose（mmol/L）`) &lt;- rev(levels(drug$`glucose（mmol/L）`))",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Sankey Diagram"
    ]
  },
  {
    "objectID": "Proportion/Sankey.html#可视化",
    "href": "Proportion/Sankey.html#可视化",
    "title": "桑基图",
    "section": "可视化",
    "text": "可视化\n\n1. 可视化\n\n1.1 基础桑基图\n图 1 桑基图描述了患者在使用某种药物前后血糖水平的变化。\n\n# 基础桑基图\np1 &lt;- sankeyNetwork(Links = drugs, Nodes = nodes,\n              Source = \"IDsource\", Target = \"IDtarget\",\n              Value = \"value\", NodeID = \"name\") \n              \np1\n\n\n\n\n\n\n\n图 1: 基础桑基图\n\n\n\n\n\n\n1.2 自定义颜色\n使用 JavaScript 调用\n图 2 桑基图描述了患者在使用某种药物前后血糖水平的变化。\n第一步是创建一个用于颜色映射的 JavaScript 对象。然后，为每个节点分配一个颜色。最后，在 networkD3 的 colourScale 参数中调用此对象。\n\n# 准备颜色标度：为每个节点分配一种特定的颜色。\nmy_color &lt;- 'd3.scaleOrdinal() .domain([\"before-normal\", \"before-high\",\"before-low\", \"after-high\", \"after-low\", \"after-normal\"]) .range([\"steelblue\", \"red\" , \"#69b3a2\", \"red\", \"#69b3a2\", \"steelblue\"])'\n\np2_1 &lt;- sankeyNetwork(Links = drugs, Nodes = nodes,\n              Source = \"IDsource\", Target = \"IDtarget\",\n              Value = \"value\", NodeID = \"name\", \n              colourScale=my_color,fontSize=15,nodePadding=20,nodeWidth=25)\np2_1\n\n\n\n\n\n\n\n图 2: 设置单个节点颜色\n\n\n\n\n图 3 这张桑基图显示了患者在使用某种药物前后血糖水平的变化。蓝色组表示血糖水平变化大于 1 mmol/L，绿色组表示变化小于 1 mmol/L。\n\n# 在每个链接中添加一个“组”列\ndrugs$group &lt;- as.factor( c(\"type_a\",\"type_a\",\"type_b\",\"type_b\",\"type_b\",\"type_b\",\"type_a\",\"type_b\",\"type_b\",\"type_b\",\"type_a\",\"type_a\",\"type_a\",\"type_b\",\"type_a\",\"type_a\",\"type_a\",\"type_a\"))\n\n# 为每个节点添加一个“分组”列。这里，所有节点都被放在同一个组中，使它们显示为灰色。\nnodes$group &lt;- as.factor(c(\"my_unique_group\"))\n\n# 给每个组分配颜色\nmy_color &lt;- 'd3.scaleOrdinal() .domain([\"type_a\", \"type_b\", \"my_unique_group\"]) .range([\"#69b3a2\", \"steelblue\", \"grey\"])'\n\np2_3 &lt;- sankeyNetwork(Links = drugs, Nodes = nodes,\n              Source = \"IDsource\", Target = \"IDtarget\",\n              Value = \"value\", NodeID = \"name\", \n              colourScale=my_color,LinkGroup=\"group\", NodeGroup=\"group\")\np2_3\n\n\n\n\n\n\n\n图 3: 设置链接颜色\n\n\n\n\n\n\n\n2. 使用ggalluvial包\nggalluvial是ggplot2的扩展包，它遵循ggplot2的图层化语法，用于创建冲积图，与桑基图有相似之处，但是它是根据数据和一组参数唯一确定的。\n\n2.1 基础桑基图\n图 4 这张桑基图显示了患者在使用某种药物前后血糖水平的变化。\n\n# 基础桑基图\np4_1 &lt;- ggplot(drug,\n       aes(x = time, stratum = level, alluvium = id,\n           y = value,\n           fill = level, label = level)) +\n  scale_x_discrete(expand = c(.1, .1)) +\n  geom_flow() +\n  geom_stratum(alpha = .5) +\n  geom_text(stat = \"stratum\", size = 3) +\n  theme(legend.position = \"none\") \n\np4_1\n\n\n\n\n\n\n\n图 4: 基础桑基图\n\n\n\n\n\n\n\n2.2 改变线条类型\n通过改变curve_type参数，有”linear”,“cubic”, “quintic”, “sine”,“arctangent”, “sigmoid”. “xspline”7种选项。\n图 5 该桑基图显示了患者在使用某种药物前后血糖水平的变化。\n\n# Linear\np5_1 &lt;- ggplot(drug,\n       aes(x = time, stratum = level, alluvium = id,\n           y = value,\n           fill = level, label = level)) +\n  scale_x_discrete(expand = c(.1, .1)) +\n  geom_alluvium(curve_type = \"linear\")+\n  geom_stratum(alpha = 1) +\n  geom_text(stat = \"stratum\", aes(label = after_stat(stratum))) +\n  theme(legend.position = \"none\") \n\np5_1\n\n\n\n\n\n\n\n图 5: 改变线条类型\n\n\n\n\n\n图 6 该桑基图显示了患者在使用某种药物前后血糖水平的变化。\n\n# Sigmoid\np5_2 &lt;- ggplot(drug,\n       aes(x = time, stratum = level, alluvium = id,\n           y = value,\n           fill = level, label = level)) +\n  scale_x_discrete(expand = c(.1, .1)) +\n  geom_alluvium(curve_type = \"sigmoid\")+\n  geom_stratum(alpha = 1) +\n  geom_text(stat = \"stratum\", aes(label = after_stat(stratum))) +\n  theme(legend.position = \"none\") \n\np5_2\n\n\n\n\n\n\n\n图 6: 改变线条类型",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Sankey Diagram"
    ]
  },
  {
    "objectID": "Proportion/Sankey.html#应用场景",
    "href": "Proportion/Sankey.html#应用场景",
    "title": "桑基图",
    "section": "应用场景",
    "text": "应用场景\n\n\n\n\n\n\n图 7: 桑基图应用场景\n\n\n\n在ceRNA相关的研究中，例如circRNA-miRNA-mRNA，或者lncRNA-miRNA-mRNA的靶向关系图谱，一般通过网络图呈现。 [1]",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Sankey Diagram"
    ]
  },
  {
    "objectID": "Proportion/Sankey.html#参考文献",
    "href": "Proportion/Sankey.html#参考文献",
    "title": "桑基图",
    "section": "参考文献",
    "text": "参考文献\n[1] Long J, Bai Y, Yang X, Lin J, Yang X, Wang D, He L, Zheng Y, Zhao H. Construction and comprehensive analysis of a ceRNA network to reveal potential prognostic biomarkers for hepatocellular carcinoma. Cancer Cell Int. 2019 Apr 11;19:90. doi: 10.1186/s12935-019-0817-y. PMID: 31007608; PMCID: PMC6458652.\n[2] The R Graph Gallery – Help and inspiration for R charts (r-graph-gallery.com)\n[3] Gandrud, Christopher, et al. networkD3: D3 JavaScript Network Graphs from R. Version 0.4, 2017. https://CRAN.R-project.org/package=networkD3.\n[4] Wickham, H., & François, R. (2016). dplyr: A Grammar of Data Manipulation [Computer software]. Retrieved from https://CRAN.R-project.org/package=dplyr\n[5] Wickham, H. (2009). ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York. https://ggplot2.tidyverse.org\n[6] Allaire, J. J., & Xie, Y. (2018). webshot: Save Web Content as an Image File [Computer software]. Retrieved from https://CRAN.R-project.org/package=webshot\n[7] Wickham, H., Averick, M., Bryan, J., Chang, W., McGowan, L. D., François, R., … Yutani, H. (2019). tidyverse: Easily Install and Load the ‘Tidyverse’ (Version 1.2.1) [Computer software]. Retrieved from https://CRAN.R-project.org/package=tidyverse\n[8] Wickham, H., Averick, M., Bryan, J., Chang, W., McGowan, L. D., François, R., … Yutani, H. (2019). tidyverse: Easily Install and Load the ‘Tidyverse’ (Version 1.2.1) [Computer software]. Retrieved from https://CRAN.R-project.org/package=tidyverse\n[9] Kassambara, W. (2020). ggsankey: Create Sankey Diagrams with ‘ggplot2’ [Computer software]. Retrieved from https://CRAN.R-project.org/package=ggsankey\n[10] Brunson JC, Read QD. ggalluvial: Alluvial Plots in ‘ggplot2’. R package version 0.12.5. 2023. https://CRAN.R-project.org/package=ggalluvial",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Sankey Diagram"
    ]
  },
  {
    "objectID": "Proportion/DicePlot.html",
    "href": "Proportion/DicePlot.html",
    "title": "骰子图",
    "section": "",
    "text": "骰子图是一种用于表示高维分类数据的可视化技术。ggdiceplot 包提供了 ggplot2 扩展，用于创建基于骰子的可视化，其中骰子上的每个点位置代表一个特定的分类变量。这允许使用传统的骰子模式同时直观地可视化多达 6 个分类变量。每个骰子位置（1-6）代表不同的类别，仅当该类别存在时才显示点。",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Dice Plot"
    ]
  },
  {
    "objectID": "Proportion/DicePlot.html#示例",
    "href": "Proportion/DicePlot.html#示例",
    "title": "骰子图",
    "section": "示例",
    "text": "示例\n\n\n\n\n\n该骰子图显示了不同化合物和器官中 miRNA 表达变化。每个骰子表示 miRNA 在不同器官（肺、肝脏、大脑）中的存在和调控方向。点代表不同的器官，颜色表示 miRNA 是上调（红色）、下调（蓝色）还是不变（灰色）。",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Dice Plot"
    ]
  },
  {
    "objectID": "Proportion/DicePlot.html#环境配置",
    "href": "Proportion/DicePlot.html#环境配置",
    "title": "骰子图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求：跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：ggplot2; ggdiceplot; dplyr\n\n\n# 安装包\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"ggdiceplot\", quietly = TRUE)) {\n  install.packages(\"ggdiceplot\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\n\n# 加载包\nlibrary(ggplot2)\nlibrary(ggdiceplot)\nlibrary(dplyr)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n dplyr      * 1.1.4   2023-11-17 [1] RSPM\n ggdiceplot * 1.0.1   2025-12-08 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Dice Plot"
    ]
  },
  {
    "objectID": "Proportion/DicePlot.html#数据准备",
    "href": "Proportion/DicePlot.html#数据准备",
    "title": "骰子图",
    "section": "数据准备",
    "text": "数据准备\n该包包含用于演示骰子图功能的示例数据。我们将使用 miRNA 失调数据集，其中包含有关不同化合物和器官中 microRNA 表达变化的信息。\n\n# 从包中加载示例数据\ndata(\"sample_dice_miRNA\", package = \"ggdiceplot\")\ndf_dice &lt;- sample_dice_miRNA\n\n# 查看数据结构\nhead(df_dice)\n\n  miRNA   Compound Organ     log2FC direction\n1 miR-1    Control  Lung -1.4483805      Down\n2 miR-2    Control  Lung -1.1841420      Down\n3 miR-3    Control  Lung  0.2469667 Unchanged\n4 miR-4    Control  Lung -0.9435933      Down\n5 miR-5    Control  Lung -0.8965698      Down\n6 miR-1 Compound_1  Lung  0.8720520        Up\n\n# 检查数据维度\nstr(df_dice)\n\n'data.frame':   90 obs. of  5 variables:\n $ miRNA    : Factor w/ 5 levels \"miR-1\",\"miR-2\",..: 1 2 3 4 5 1 2 3 4 5 ...\n $ Compound : Factor w/ 5 levels \"Control\",\"Compound_1\",..: 1 1 1 1 1 2 2 2 2 2 ...\n $ Organ    : Factor w/ 4 levels \"Lung\",\"Liver\",..: 1 1 1 1 1 1 1 1 1 1 ...\n $ log2FC   : num  -1.448 -1.184 0.247 -0.944 -0.897 ...\n $ direction: Factor w/ 3 levels \"Down\",\"Unchanged\",..: 1 1 2 1 1 3 2 1 1 1 ...\n - attr(*, \"out.attrs\")=List of 2\n  ..$ dim     : Named int [1:3] 5 5 4\n  .. ..- attr(*, \"names\")= chr [1:3] \"miRNA\" \"Compound\" \"Organ\"\n  ..$ dimnames:List of 3\n  .. ..$ miRNA   : chr [1:5] \"miRNA=miR-1\" \"miRNA=miR-2\" \"miRNA=miR-3\" \"miRNA=miR-4\" ...\n  .. ..$ Compound: chr [1:5] \"Compound=Control\" \"Compound=Compound_1\" \"Compound=Compound_2\" \"Compound=Compound_3\" ...\n  .. ..$ Organ   : chr [1:4] \"Organ=Lung\" \"Organ=Liver\" \"Organ=Brain\" \"Organ=Kidney\"\n\n\n该数据集包含以下列： - miRNA：microRNA 标识符 - Compound：治疗化合物 - Organ：组织/器官类型 - log2FC：表达的 log2 倍数变化 - direction：调控方向（上调/下调/不变）",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Dice Plot"
    ]
  },
  {
    "objectID": "Proportion/DicePlot.html#可视化",
    "href": "Proportion/DicePlot.html#可视化",
    "title": "骰子图",
    "section": "可视化",
    "text": "可视化\n\n1. 基础骰子图\n基础骰子图使用 geom_dice() 来表示多个分类变量。每个骰子方块可以使用传统的骰子点模式显示多达 6 个类别。\n\n\n\n\n\n\n提示\n\n\n\n关键参数：\n\ndots：映射到骰子位置的变量（1-6 个点）\nfill：骰子背景的颜色映射\nwidth 和 height：控制每个骰子方块的大小\nndots：要显示的唯一类别数\n\n\n\n\n# 定义调控方向的颜色\ndirection_colors &lt;- c(\n  Down      = \"#2166ac\",\n  Unchanged = \"grey80\",\n  Up        = \"#b2182b\"\n)\n\n# 创建基础骰子图\np1 &lt;- ggplot(df_dice, aes(x = miRNA, y = Compound)) +\n  geom_dice(\n    aes(\n      dots   = Organ,\n      fill   = direction,\n      width  = 0.8,\n      height = 0.8\n    ),\n    show.legend = TRUE,\n    ndots       = length(levels(df_dice$Organ)),\n    x_length    = length(levels(df_dice$miRNA)),\n    y_length    = length(levels(df_dice$Compound))\n  ) +\n  scale_fill_manual(values = direction_colors, name = \"调控\") +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(angle = 0, hjust = 0.5),\n    axis.text.y = element_text(hjust = 1),\n    panel.grid  = element_blank()\n  ) +\n  labs(\n    x = \"miRNA\",\n    y = \"化合物\"\n  )\n\np1\n\n\n\n\n\n\n\n图 1: 显示不同化合物和器官中 miRNA 调控的基础骰子图\n\n\n\n\n\n每个骰子显示 miRNA 在不同器官中的存在和调控方向。点代表不同的器官（肺、肝脏、大脑），颜色表示 miRNA 是上调（红色）、下调（蓝色）还是不变（灰色）。\n\n\n2. 具有连续变量的高级骰子图\n骰子图还可以使用大小和颜色渐变来合并连续变量。这对于显示效应大小和统计显著性特别有用。\n\n# 加载分类学示例数据\ndata(\"sample_dice_data1\", package = \"ggdiceplot\")\ntoy_data &lt;- sample_dice_data1\n\n# 查看数据\nhead(toy_data)\n\n                     taxon disease specimen   lfc    q\n1     Campylobacter_showae  Caries   Saliva  2.74 0.17\n2 Porphyromonas_gingivalis  Caries   Saliva -1.13 0.26\n3      Rothia_mucilaginosa  Caries   Saliva  0.73 0.37\n4  Fusobacterium_nucleatum  Caries   Saliva  1.27 0.31\n5     Streptococcus_mutans  Caries   Saliva  0.81 0.31\n6    Prevotella_intermedia  Caries   Saliva -0.21 0.11\n\n\n\n\n\n\n\n\n提示\n\n\n\n高级参数：\n\nsize：映射到连续变量（例如，-log10(q-value)）\nfill：可以使用渐变尺度表示连续效应大小\nscale_fill_gradient2()：为正/负效应创建发散颜色尺度\n\n\n\n\n# 计算尺度参数\nlo &lt;- floor(min(toy_data$lfc, na.rm = TRUE))\nup &lt;- ceiling(max(toy_data$lfc, na.rm = TRUE))\nmid &lt;- (lo + up) / 2\n\nminsize &lt;- floor(min(-log10(toy_data$q), na.rm = TRUE))\nmaxsize &lt;- ceiling(max(-log10(toy_data$q), na.rm = TRUE))\nmidsize &lt;- ceiling(quantile(-log10(toy_data$q), c(0.5), na.rm = TRUE))\n\n# 创建高级骰子图\np2 &lt;- ggplot(toy_data, aes(x = specimen, y = taxon)) +\n  geom_dice(\n    aes(\n      dots   = disease,\n      fill   = lfc,\n      size   = -log10(q),\n      width  = 0.5,\n      height = 0.5\n    ),\n    show.legend = TRUE,\n    ndots       = length(unique(toy_data$disease)),\n    x_length    = length(unique(toy_data$specimen)),\n    y_length    = length(unique(toy_data$taxon))\n  ) +\n  scale_fill_gradient2(\n    low      = \"#40004B\",\n    high     = \"#00441B\",\n    mid      = \"white\",\n    na.value = \"white\",\n    limit    = c(lo, up),\n    midpoint = mid,\n    name     = \"Log2FC\"\n  ) +\n  scale_size_continuous(\n    limits = c(minsize, maxsize),\n    breaks = c(minsize, midsize, maxsize),\n    labels = c(10^minsize, 10^-midsize, 10^-maxsize),\n    name   = \"q-value\"\n  ) +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    axis.text.y = element_text(size = 10),\n    legend.text = element_text(size = 10)\n  ) +\n  labs(\n    x = \"样本\",\n    y = \"分类群\"\n  )\n\np2\n\n\n\n\n\n\n\n图 2: 具有连续颜色和大小映射的高级骰子图\n\n\n\n\n\n该高级图显示分类学数据，其中： - 点：不同疾病 - 颜色：Log2 倍数变化（紫色 = 下调，绿色 = 上调） - 大小：统计显著性（-log10 q-value）\n\n\n3. 自定义主题\n该包包含 theme_dice() 以实现更清晰的可视化：\n\n# 使用 theme_dice() 创建骰子图\np3 &lt;- ggplot(df_dice, aes(x = miRNA, y = Compound)) +\n  geom_dice(\n    aes(\n      dots   = Organ,\n      fill   = direction,\n      width  = 0.8,\n      height = 0.8\n    ),\n    show.legend = TRUE,\n    ndots       = length(levels(df_dice$Organ)),\n    x_length    = length(levels(df_dice$miRNA)),\n    y_length    = length(levels(df_dice$Compound))\n  ) +\n  scale_fill_manual(values = direction_colors, name = \"调控\") +\n  theme_dice() +\n  labs(\n    title = \"不同化合物和器官中的 miRNA 失调\",\n    x = \"miRNA\",\n    y = \"化合物\"\n  )\n\np3\n\n\n\n\n\n\n\n图 3: 具有自定义主题的骰子图\n\n\n\n\n\ntheme_dice() 提供了一个针对骰子图优化的简洁主题，具有清晰的背景和适当的间距。",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Dice Plot"
    ]
  },
  {
    "objectID": "Proportion/DicePlot.html#应用",
    "href": "Proportion/DicePlot.html#应用",
    "title": "骰子图",
    "section": "应用",
    "text": "应用\n骰子图在生物医学研究中特别有用，用于可视化复杂的分类关系。它们已应用于各个领域，包括基因组学、转录组学和临床研究。\n\n1. 基因表达分析\n\n\n\n\n\n\n图 4: ZEBRA 基因表达多米诺图\n\n\n\n该图显示了多种疾病（MS、AD、ASD、FTD、HD）和细胞类型中差异表达基因的多米诺图。每个骰子表示： - 点：不同疾病条件 - 颜色：Log 倍数变化（蓝色 = 下调，红色 = 上调） - 大小：统计显著性（FDR）\n多米诺图允许同时可视化多个维度的基因表达模式，使识别疾病特异性和细胞类型特异性失调模式变得容易。\n\n\n2. 分类学分析\n\n\n\n\n\n\n图 5: 分类学骰子图应用\n\n\n\n该应用演示了骰子图如何可视化样本和疾病中的分类学丰度数据，每个点代表不同的疾病状态，颜色/大小表示效应大小和显著性水平。\n\n\n3. miRNA 失调研究\n\n\n\n\n\n\n图 6: miRNA 失调骰子图\n\n\n\n该示例显示了不同化合物和器官中 miRNA 表达变化，骰子点代表器官，颜色表示调控方向。这种可视化模式对于检查组织特异性药物效应的药理学研究特别有用。",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Dice Plot"
    ]
  },
  {
    "objectID": "Proportion/DicePlot.html#参考文献",
    "href": "Proportion/DicePlot.html#参考文献",
    "title": "骰子图",
    "section": "参考文献",
    "text": "参考文献\n\nM. Flotho, P. Flotho, A. Keller, “Diceplot: A package for high dimensional categorical data visualization,” arXiv preprint, 2024. https://doi.org/10.48550/arXiv.2410.23897\nggdiceplot GitHub 仓库：https://github.com/maflot/ggdiceplot\nggdiceplot CRAN 包：https://CRAN.R-project.org/package=ggdiceplot",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Dice Plot"
    ]
  },
  {
    "objectID": "Proportion/DicePlot.html#贡献者",
    "href": "Proportion/DicePlot.html#贡献者",
    "title": "骰子图",
    "section": "贡献者",
    "text": "贡献者\n\n编辑：GitHub Copilot。",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Dice Plot"
    ]
  },
  {
    "objectID": "Proportion/ArcDiagram.html",
    "href": "Proportion/ArcDiagram.html",
    "title": "弧形图",
    "section": "",
    "text": "弧形图是按弧形连接的图，显示了节点之间的相互关系。",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Arc Diagram"
    ]
  },
  {
    "objectID": "Proportion/ArcDiagram.html#示例",
    "href": "Proportion/ArcDiagram.html#示例",
    "title": "弧形图",
    "section": "示例",
    "text": "示例\n\n\n\n\n\n如图就是一个简单的弧形图，节点在图下方整齐排布，节点间通过弧形连接，构成了弧形图的主体。",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Arc Diagram"
    ]
  },
  {
    "objectID": "Proportion/ArcDiagram.html#环境配置",
    "href": "Proportion/ArcDiagram.html#环境配置",
    "title": "弧形图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：ggraph, tidyverse, viridis, patchwork, igraph, colormap\n\n\n# 安装包\nif (!requireNamespace(\"tidyverse\", quietly = TRUE)) {\n  install.packages(\"tidyverse\")\n}\nif (!requireNamespace(\"viridis\", quietly = TRUE)) {\n  install.packages(\"viridis\")\n}\nif (!requireNamespace(\"patchwork\", quietly = TRUE)) {\n  install.packages(\"patchwork\")\n}\nif (!requireNamespace(\"igraph\", quietly = TRUE)) {\n  install.packages(\"igraph\")\n}\nif (!requireNamespace(\"ggraph\", quietly = TRUE)) {\n  install.packages(\"ggraph\")\n}\nif (!requireNamespace(\"colormap\", quietly = TRUE)) {\n  install.packages(\"colormap\")\n}\n\n# 加载包\nlibrary(tidyverse) \nlibrary(viridis)   \nlibrary(patchwork) \nlibrary(igraph)    \nlibrary(ggraph)    \nlibrary(colormap)  \n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package     * version date (UTC) lib source\n colormap    * 0.1.4   2016-11-15 [1] RSPM\n dplyr       * 1.1.4   2023-11-17 [1] RSPM\n forcats     * 1.0.1   2025-09-25 [1] RSPM\n ggplot2     * 4.0.1   2025-11-14 [1] RSPM\n ggraph      * 2.2.2   2025-08-24 [1] RSPM\n igraph      * 2.2.1   2025-10-27 [1] RSPM\n lubridate   * 1.9.4   2024-12-08 [1] RSPM\n patchwork   * 1.3.2   2025-08-25 [1] RSPM\n purrr       * 1.2.0   2025-11-04 [1] RSPM\n readr       * 2.1.6   2025-11-14 [1] RSPM\n stringr     * 1.6.0   2025-11-04 [1] RSPM\n tibble      * 3.3.0   2025-06-08 [1] RSPM\n tidyr       * 1.3.2   2025-12-19 [1] RSPM\n tidyverse   * 2.0.0   2023-02-22 [1] RSPM\n viridis     * 0.6.5   2024-01-29 [1] RSPM\n viridisLite * 0.4.2   2023-05-02 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Arc Diagram"
    ]
  },
  {
    "objectID": "Proportion/ArcDiagram.html#数据准备",
    "href": "Proportion/ArcDiagram.html#数据准备",
    "title": "弧形图",
    "section": "数据准备",
    "text": "数据准备\n数据包括自定义的数据、研究人员的合著网络、Cytoscape软件导出的PPI网络数据。\n\n# 1.自定义数据\n# links存储边信息，nodes存储点和点的分组信息\nlinks &lt;- data.frame(\nsource = c(\"A\", \"A\", \"A\", \"A\", \"B\", \"G\", \"G\", \"G\", \"G\"),\n  target = c(\"B\", \"C\", \"D\", \"F\", \"E\", \"H\", \"I\", \"J\", \"F\")\n)\nnodes &lt;- data.frame(\n  point = c(\"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\", \"I\", \"J\"),\n  groups = c(\n    \"group-one\", \"group-one\", \"group-one\", \"group-one\", \"group-one\",\n    \"group-one\", \"group-two\", \"group-two\", \"group-two\", \"group-two\"\n  )\n)\n\nhead(links)\n\n  source target\n1      A      B\n2      A      C\n3      A      D\n4      A      F\n5      B      E\n6      G      H\n\nhead(nodes)\n\n  point    groups\n1     A group-one\n2     B group-one\n3     C group-one\n4     D group-one\n5     E group-one\n6     F group-one\n\n# 2.研究人员合著网络\n# 将链接信息复制到txt文件，读取进行绘图\ndata_dif &lt;- read.csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/Arc.txt\", header = T, sep = \" \")\n\nhead(data_dif[,1:5])\n\n          from A.Bateman A.Besnard A.Breil A.Cenci\n1     A Armero        NA        NA       1      NA\n2    A Bateman        NA        NA      NA      NA\n3    A Besnard        NA        NA      NA      NA\n4      A Breil        NA        NA      NA      NA\n5      A Cenci        NA        NA      NA      NA\n6 A Chifolleau        NA        NA      NA      NA\n\n# 3.PPI网络的节点和边数据\n# 读取从github下载的PPI网络信息\ndata_ppi &lt;- read.csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/string_interactions_short.tsv_1%20default%20edge.csv\", header = TRUE)\n\nhead(data_ppi[,c(9,3)])\n\n                           name combined_score\n1   ABCB4 (interacts with) CFTR          0.458\n2 ABCB4 (interacts with) CREBBP          0.440\n3  ABCB4 (interacts with) ABCC8          0.410\n4   ABCB5 (interacts with) CFTR          0.415\n5  ABCB5 (interacts with) ABCC8          0.436\n6  ABCB5 (interacts with) PROM1          0.786",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Arc Diagram"
    ]
  },
  {
    "objectID": "Proportion/ArcDiagram.html#可视化",
    "href": "Proportion/ArcDiagram.html#可视化",
    "title": "弧形图",
    "section": "可视化",
    "text": "可视化\n\n1. 基本弧形图\n\n# 基本弧形图\nmygraph &lt;- graph_from_data_frame(links, vertices = nodes) # 生成图结构\n\np &lt;- ggraph(mygraph, layout = \"linear\") +\n  geom_edge_arc(edge_colour = \"black\", edge_alpha = 0.3, edge_width = 0.4) +\n  geom_node_point(color = \"grey\", size = 5) +\n  geom_node_text(aes(label = name), repel = FALSE, size = 6, nudge_y = -0.15) +\n  theme_void() +\n  theme(\n    legend.position = \"none\",\n    plot.margin = unit(rep(2, 4), \"cm\")\n  )\n\np\n\n\n\n\n基本弧形图\n\n\n\n\n如图是基本弧形图的绘制，节点和边少，所以弧形图结构简单。\n\n\n2. 将分组信息映射到节点颜色上\n\n# 分组映射到节点颜色上\nmygraph &lt;- graph_from_data_frame(links, vertices = nodes) # 生成图\np &lt;- ggraph(mygraph, layout = \"linear\") +\n  geom_edge_arc(edge_colour = \"black\", edge_alpha = 0.3, edge_width = 0.4) +\n  geom_node_point(aes(color = groups), size = 5) +\n  geom_node_text(aes(label = name), repel = FALSE, size = 6, nudge_y = -0.15) +\n  theme_void() +\n  theme(\n    legend.position = \"none\",\n    plot.margin = unit(rep(2, 4), \"cm\")\n  )\np\n\n\n\n\n将分组信息映射到节点颜色上\n\n\n\n\n如图中color = groups将分组信息映射到节点的颜色上，可以在弧形图中直观得看出节点的分组情况。\n\n\n3. 复杂图结构绘图\n一般的原始数据的节点和边很多，图结构复杂，在绘图时要对节点进行分类和排序，对节点和边的大小进行度量，以显示排列美观的弧形图。这里使用研究人员的合著网络数据。\n\n# 合著网络数据处理和绘图\n# 1.数据排布转换\nconnect &lt;- data_dif %&gt;% # connect保存节点的边信息\n  gather(key = \"to\", value = \"value\", -1) %&gt;% # 使用将除第一列的数据转化成两列（1列列名变量，1列值）\n  mutate(to = gsub(\"\\\\.\", \" \", to)) %&gt;% # 更改列\"to\"名称形式与\"from\"保持一致\n  na.omit() # 去除NA值\n\n# 2.节点统计\ncoauth &lt;- # coauth保存节点名和出入度信息，后面会加上分组信息\n  c(as.character(connect$from), as.character(connect$to)) %&gt;%\n  as.tibble() %&gt;% # 类似数据框类型，列名默认为\"value\"————\n  group_by(value) %&gt;% # 按\"value\"分组\n  summarize(n = n()) # 统计节点名的出入度\ncolnames(coauth) &lt;- c(\"name\", \"n\") # 更改列名\n\n# 3.进行节点分组\nmygraph &lt;- graph_from_data_frame(connect, vertices = coauth, directed = FALSE) # 生成一个图\ncom &lt;- walktrap.community(mygraph) # 根据节点的路径大小进行分组————\n# coauth添加分组信息\ncoauth &lt;- coauth %&gt;%\n  mutate(grp = com$membership) %&gt;% # 添加分组\n  arrange(grp) %&gt;% # 按照分组进行排序\n  mutate(name = factor(name, name))\n\n# 4.筛选前15个组\ncoauth &lt;- coauth[coauth$grp &lt; 16, ]\n# 过滤只在前15组点出现的连接\nconnect &lt;- connect %&gt;%\n  filter(from %in% coauth$name) %&gt;%\n  filter(to %in% coauth$name)\n\n# 5.生成一个图\nmygraph &lt;- graph_from_data_frame(connect, vertices = coauth, directed = FALSE)\n# 按分组生成颜色\nmycolor &lt;- colormap(colormap = colormaps$viridis, nshades = max(coauth$grp))\nmycolor &lt;- sample(mycolor, length(mycolor))\n# ggraph画图\nggraph(mygraph, layout = \"linear\") +\n  geom_edge_arc(edge_colour = \"black\", edge_alpha = 0.2, edge_width = 0.3, fold = TRUE) +\n  geom_node_point(aes(size = n, color = as.factor(grp), fill = grp), alpha = 0.5) + # 将n和分组变量映射到大小、颜色上\n  scale_size_continuous(range = c(0.5, 8)) + # 设置size范围\n  scale_color_manual(values = mycolor) + # 设置分组的颜色\n  geom_node_text(aes(label = name), angle = 65, hjust = 1, nudge_y = -1.1, size = 2.3) + # 设置节点标签，并倾斜避免重叠\n  theme_void() + # 去除背景表格，坐标轴主题\n  theme(\n    legend.position = \"none\", # 去除图例\n    plot.margin = unit(c(0, 0, 0.4, 0), \"null\"),\n    panel.spacing = unit(c(0, 0, 3.4, 0), \"null\")\n  ) +\n  expand_limits(x = c(-1.2, 1.2), y = c(-5.6, 1.2))\n\n\n\n\n复杂图结构绘图\n\n\n\n\n如图是根据复杂图结构绘制的弧形图。绘制弧形图（或者图）需要将数据预处理成两个分别包含节点信息和边信息的数据框。在这次数据处理中，有一下步骤：\n\n改变数据排布生成边信息（connect存储）；\n依据边信息提取所有节点信息（coauth存储）；\n根据walktrap.community()进行分组，分组特征可以映射到节点颜色上，从而显示不同分组，同时，为了美观，对分组节点进行排序；\n只选择前面的分组，同时要筛选connect前面分组的点；\n生成图，选择颜色进行ggraph()进行绘图。\n\n复杂数据绘图不进行分组和排序时（做对比）\n\n# 不进行分组和排序（对比）\n# 1.数据排布转换\nconnect &lt;- data_dif %&gt;% # connect保存节点的边信息\n  gather(key = \"to\", value = \"value\", -1) %&gt;% # 使用将除第一列的数据转化成两列（1列列名变量，1列值）\n  mutate(to = gsub(\"\\\\.\", \" \", to)) %&gt;% # 更改列\"to\"名称形式与\"from\"保持一致\n  na.omit() # 去除NA值\n\n# 2.节点统计\ncoauth &lt;- # coauth保存节点名和出入度信息，后面会加上分组信息\n  c(as.character(connect$from), as.character(connect$to)) %&gt;%\n  as.tibble() %&gt;% # 类似数据框类型，列名默认为\"value\"————\n  group_by(value) %&gt;% # 按\"value\"分组\n  summarize(n = n()) # 统计节点名的出入度\ncolnames(coauth) &lt;- c(\"name\", \"n\") # 更改列名\n\n# 5.生成一个图\nmygraph &lt;- graph_from_data_frame(connect, vertices = coauth, directed = FALSE)\n# ggraph画图\nggraph(mygraph, layout = \"linear\") +\n  geom_edge_arc(edge_colour = \"black\", edge_alpha = 0.2, edge_width = 0.3, fold = TRUE) +\n  geom_node_point(aes(size = n), alpha = 0.5) + # 将n和分组变量映射到大小、颜色上\n  scale_size_continuous(range = c(0.5, 8)) + # 设置size范围\n  geom_node_text(aes(label = name), angle = 65, hjust = 1, nudge_y = -1.1, size = 2.3) + # 设置节点标签，并倾斜避免重叠\n  theme_void() + # 去除背景表格，坐标轴主题\n  theme(\n    legend.position = \"none\", # 去除图例\n    plot.margin = unit(c(0, 0, 0.4, 0), \"null\"),\n    panel.spacing = unit(c(0, 0, 3.4, 0), \"null\")\n  ) +\n  expand_limits(x = c(-1.2, 1.2), y = c(-5.6, 1.2))\n\n\n\n\n复杂数据绘图不进行分组和排序时（做对比）\n\n\n\n\n如图是对复杂图数据未经过分组和排序时绘制的弧形图，可以看到图中的节点以及弧非常混乱，而且无法对弧形图的内容进行解读。因此，在复杂图数据绘制弧形图时，一定要对节点进行分组以及排序，使用颜色映射将不同的点进行分类。\n\n\n4. 按照边权重定义弧形粗细\n图的边有时候设置有权重，可以映射到弧形粗细来表示。\n\n# 1.从PPI数据表中提取边信息，使用结合分数的值作为权重\ndata_ppi &lt;- data_ppi[, c(9, 3)] # 提取第3、9列\ndata_ppi$from &lt;- gsub(\" \\\\(.*\", \"\", data_ppi[, 1]) # 截取name的左边节点名\ndata_ppi$to &lt;- gsub(\".*\\\\) \", \"\", data_ppi[, 1]) # 截取name的右边节点名\nconnect &lt;- data_ppi[, -1] # 去除第一列\nconnect &lt;- connect[, c(2, 3, 1)] # 将两列边信息放在前面（from和to列）\n\n# 2.节点统计\ncoauth &lt;- # coauth保存节点名和出入度信息，后面会加上分组信息\n  c(as.character(connect$from), as.character(connect$to)) %&gt;%\n  as.tibble() %&gt;% # 类似数据框类型，列名默认为\"value\"————\n  group_by(value) %&gt;% # 按\"value\"分组\n  summarize(n = n()) # 统计节点名的出入度\ncolnames(coauth) &lt;- c(\"name\", \"n\") # 更改列名\n\n# 3.进行节点分组\nmygraph &lt;- graph_from_data_frame(connect, vertices = coauth, directed = FALSE) # 生成一个图\ncom &lt;- walktrap.community(mygraph) # 根据节点的路径大小进行分组————\n## coauth添加分组信息\ncoauth &lt;- coauth %&gt;%\n  mutate(grp = com$membership) %&gt;% # 添加分组\n  arrange(grp) %&gt;% # 按照分组进行排序\n  mutate(name = factor(name, name))\n\n# 4.筛选前15个组\ncoauth &lt;- coauth[coauth$grp &lt; 16, ]\n# 过滤只在前15组点出现的连接\nconnect &lt;- connect %&gt;%\n  filter(from %in% coauth$name) %&gt;%\n  filter(to %in% coauth$name)\n\n# 5.生成一个图\nmygraph &lt;- graph_from_data_frame(connect, vertices = coauth, directed = FALSE)\n# 按分组生成颜色\nmycolor &lt;- colormap(colormap = colormaps$viridis, nshades = max(coauth$grp))\nmycolor &lt;- sample(mycolor, length(mycolor))\n# ggraph画图\nggraph(mygraph, layout = \"linear\") +\n  geom_edge_arc(aes(edge_width = connect$combined_score), edge_colour = \"black\", edge_alpha = 0.2, fold = TRUE) +\n  geom_node_point(aes(size = n, color = as.factor(grp), fill = grp), alpha = 0.5) + # 将n和分组变量映射到大小、颜色上\n  scale_size_continuous(range = c(0.5, 8)) + # 设置size范围\n  scale_color_manual(values = mycolor) + # 设置分组的颜色\n  geom_node_text(aes(label = name), angle = 65, hjust = 1, nudge_y = -1.1, size = 2.3) + # 设置节点标签，并倾斜避免重叠\n  theme_void() + # 去除背景表格，坐标轴主题\n  theme(\n    legend.position = \"none\", # 去除图例\n    plot.margin = unit(c(0, 0, 0.4, 0), \"null\"),\n    panel.spacing = unit(c(0, 0, 3.4, 0), \"null\")\n  ) +\n  expand_limits(x = c(-1.2, 1.2), y = c(-5.6, 1.2))\n\n\n\n\n按照边权重定义弧形粗细\n\n\n\n\n如图使用了PPI的边数据绘制的弧形图，节点表示基因，弧线表示基因间关系，弧形粗细表示基因间关系的权重（强弱）。与上一张图不同的是，提取边信息部分，和绘图中使用edge_width = connect\\$combined_score，将权重映射到了弧线的粗细上。",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Arc Diagram"
    ]
  },
  {
    "objectID": "Proportion/ArcDiagram.html#应用场景",
    "href": "Proportion/ArcDiagram.html#应用场景",
    "title": "弧形图",
    "section": "应用场景",
    "text": "应用场景\n\n\n\n\n\n\n图 1: 弧形图应用\n\n\n\nHi-C 在分辨率为 500Kb 和 1 Mb的整个 Dixon 染色体上的 相互作用弧图，由 GOTHiC 建模。a 弧形图，用于显示至少 50 次读数（500Kb 分辨率）和 100 次读数（1 Mb 分辨率）的交互。b 显著交互作用的弧图。 [1]",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Arc Diagram"
    ]
  },
  {
    "objectID": "Proportion/ArcDiagram.html#参考文献",
    "href": "Proportion/ArcDiagram.html#参考文献",
    "title": "弧形图",
    "section": "参考文献",
    "text": "参考文献\n[1] KHAKMARDAN S, REZVANI M, POUYAN A A, et al. MHiC, an integrated user-friendly tool for the identification and visualization of significant interactions in Hi-C data[J]. BMC Genomics, 2020,21(1): 225.",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Arc Diagram"
    ]
  },
  {
    "objectID": "Distribution/ViolinPlot.html",
    "href": "Distribution/ViolinPlot.html",
    "title": "小提琴图",
    "section": "",
    "text": "小提琴图是一种基于密度图和箱线图的可视化方式，它能够展示数据的分布情况，包括中位数、四分位数、最大值、最小值等信息。常用于比较不同组之间的数据分布情况，它的可视化效果比箱线图更加直观，能够更好地展示数据的特点。",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Violin Plot"
    ]
  },
  {
    "objectID": "Distribution/ViolinPlot.html#示例",
    "href": "Distribution/ViolinPlot.html#示例",
    "title": "小提琴图",
    "section": "示例",
    "text": "示例",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Violin Plot"
    ]
  },
  {
    "objectID": "Distribution/ViolinPlot.html#环境配置",
    "href": "Distribution/ViolinPlot.html#环境配置",
    "title": "小提琴图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：readr; tidyr; ggplot2; dplyr; gghalves; forcats; hrbrthemes; viridis; ggstatsplot; palmerpenguins\n\n\n# 安装包\nif (!requireNamespace(\"readr\", quietly = TRUE)) {\n  install.packages(\"readr\")\n}\nif (!requireNamespace(\"tidyr\", quietly = TRUE)) {\n  install.packages(\"tidyr\")\n}\nif (!requireNamespace(\"gghalves\", quietly = TRUE)) {\n  install.packages(\"gghalves\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"ggpubr\", quietly = TRUE)) {\n  install.packages(\"ggpubr\")\n}\nif (!requireNamespace(\"forcats\", quietly = TRUE)) {\n  install.packages(\"forcats\")\n}\nif (!requireNamespace(\"hrbrthemes\", quietly = TRUE)) {\n  install.packages(\"hrbrthemes\")\n}\nif (!requireNamespace(\"viridis\", quietly = TRUE)) {\n  install.packages(\"viridis\")\n}\nif (!requireNamespace(\"ggstatsplot\", quietly = TRUE)) {\n  install.packages(\"ggstatsplot\")\n}\nif (!requireNamespace(\"palmerpenguins\", quietly = TRUE)) {\n  install.packages(\"palmerpenguins\")\n}\n\n# 加载包\nlibrary(readr)\nlibrary(tidyr)\nlibrary(ggplot2)\nlibrary(ggpubr)\nlibrary(dplyr)\nlibrary(gghalves)\nlibrary(forcats)\nlibrary(hrbrthemes)\nlibrary(viridis)\nlibrary(ggstatsplot)\nlibrary(palmerpenguins)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package        * version date (UTC) lib source\n dplyr          * 1.1.4   2023-11-17 [1] RSPM\n forcats        * 1.0.1   2025-09-25 [1] RSPM\n gghalves       * 0.1.4   2025-12-23 [1] Github (erocoar/gghalves@e5c3c79)\n ggplot2        * 4.0.1   2025-11-14 [1] RSPM\n ggpubr         * 0.6.2   2025-10-17 [1] RSPM\n ggstatsplot    * 0.13.4  2025-12-09 [1] RSPM\n hrbrthemes     * 0.9.2   2025-11-02 [1] Github (hrbrmstr/hrbrthemes@d3fd029)\n palmerpenguins * 0.1.1   2022-08-15 [1] RSPM\n readr          * 2.1.6   2025-11-14 [1] RSPM\n tidyr          * 1.3.2   2025-12-19 [1] RSPM\n viridis        * 0.6.5   2024-01-29 [1] RSPM\n viridisLite    * 0.4.2   2023-05-02 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Violin Plot"
    ]
  },
  {
    "objectID": "Distribution/ViolinPlot.html#数据准备",
    "href": "Distribution/ViolinPlot.html#数据准备",
    "title": "小提琴图",
    "section": "数据准备",
    "text": "数据准备\n我们使用内置的 R 数据集（iris、penguins）以及来自UCSC Xena DATASETS的TCGA-BRCA.htseq_counts.tsv数据集。所选基因仅用于演示目的。\n\n# 从处理过的CSV文件加载TCGA-BRCA基因表达数据集\ndata_counts &lt;- readr::read_csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/TCGA-BRCA.htseq_counts_processed.csv\")\n\n# 加载内置R数据集iris\ndata_wide &lt;- iris[ , 1:4] # 以iris数据前四列数据为例\n\n# 加载内置R数据集penguins\ndata(\"penguins\", package = \"palmerpenguins\")\ndata_penguins &lt;- drop_na(penguins) # 去除缺失值\n\n# 手动创建含分组值的演示数据集\ndata &lt;- data.frame(\n  name=c( rep(\"A\",500), rep(\"B\",500), rep(\"B\",500), rep(\"C\",20), rep('D', 100)  ),\n  value=c( rnorm(500, 10, 5), rnorm(500, 13, 1), rnorm(500, 18, 1), rnorm(20, 25, 4), rnorm(100, 12, 1) )\n  )\nsample_size &lt;- data %&gt;% \n  group_by(name) %&gt;% \n  summarize(num=n()) # 计算每组的样本量",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Violin Plot"
    ]
  },
  {
    "objectID": "Distribution/ViolinPlot.html#可视化",
    "href": "Distribution/ViolinPlot.html#可视化",
    "title": "小提琴图",
    "section": "可视化",
    "text": "可视化\n\n1. 基础小提琴图\n示例 1: 基础小提琴图使用手动创建的数据集\n\n# 基础小提琴图\np &lt;- ggplot(data, aes(x=name, y=value, fill=name)) + \n  geom_violin()\n\np\n\n\n\n\n\n\n\n图 1: 基础小提琴图\n\n\n\n\n\n示例 2: 基础小提琴图使用 iris 数据集\n\n# 将 `iris` 数据集从宽格式转换为长格式。使用 gather 函数将每列中的数据收集到名为\"MesureType\"和\"Val\"的两个新列中，以便一行代表一个观测值。\ndata_long_iris &lt;- data_wide %&gt;%  \n  gather(key = \"MeasureType\", value = \"Value\")  \n\nggplot(data_long_iris, aes(x = MeasureType, y = Value, fill = MeasureType)) +  \n  geom_violin()  \n\n\n\n\n\n\n\n图 2: 基础小提琴图使用 iris 数据集\n\n\n\n\n\n示例 3: 基础小提琴图使用 TCGA-BRCA 基因表达数据集\n\nexample_counts1 &lt;- data_counts[1:5,] %&gt;%\n  gather(key = \"sample\",value = \"gene_expression\",3:1219) # 选择五个示例基因进行可视化：A1BG、A1BG-AS1、A1CF、A2M 和 A2M-AS1。\n\nggplot(example_counts1, aes(x=gene_name, y=gene_expression, fill=gene_name)) +\n  geom_violin()\n\n\n\n\n\n\n\n图 3: 基础小提琴图使用 TCGA-BRCA 基因表达数据集\n\n\n\n\n\n示例 4： 基础小提琴图组间差异显著性并标注\n\n# 将数据进行整理和分组\ndata_long_iris &lt;- data_wide %&gt;%\n  gather(key = \"MeasureType\",\n         value = \"Value\")\n\n# 绘制基础小提琴图\np &lt;- ggplot(data_long_iris,\n       aes(x = MeasureType,\n           y = Value,\n           fill = MeasureType)) +\n  geom_violin()\n\n# 将分组提取和去重\ngroups &lt;- length(unique(data_long_iris$MeasureType))\nif (groups == 2) {\n    p &lt;- p +\n        stat_compare_means(\n            method = \"wilcox.test\", # c(\"t.test\", \"wilcox.test\")\n            paired = FALSE,\n            method.args = list(),\n            ref.group = NULL,\n            comparisons = NULL,\n            hide.ns = FALSE,\n            label.sep = \", \",\n            label = \"p.format\", # c(\"p.signif\", \"p.format\")\n            label.x.npc = \"left\",\n            label.y.npc = \"top\",\n            label.x = NULL,\n            label.y = NULL,\n            vjust = 0,\n            tip.length = 0.03,\n            bracket.size = 0.3,\n            step.increase = 0.1,\n            symnum.args = list(),\n            geom = \"text\",\n            position = \"identity\",\n            na.rm = FALSE,\n            show.legend = NA,\n            inherit.aes = TRUE\n        )\n} else if (groups &gt; 2) {\n    p &lt;- p +\n        stat_compare_means(\n            method = \"wilcox.test\", # c(\"t.test\", \"wilcox.test\")\n            paired = FALSE,\n            method.args = list(),\n            ref.group = NULL,\n            # 对于多个分组比较进行两两比较\n            comparisons = combn(unique(as.character(data_long_iris$MeasureType)), 2, simplify = FALSE),\n            hide.ns = FALSE,\n            label.sep = \", \",\n            label = \"p.format\", # c(\"p.signif\", \"p.format\")\n            label.x.npc = \"left\",\n            label.y.npc = \"top\",\n            label.x = NULL,\n            label.y = NULL,\n            vjust = 0,\n            tip.length = 0.03,\n            bracket.size = 0.3,\n            step.increase = 0.1,\n            symnum.args = list(),\n            geom = \"text\",\n            position = \"identity\",\n            na.rm = FALSE,\n            show.legend = NA,\n            inherit.aes = TRUE\n        )\n}\n\np\n\n\n\n\n\n\n\n图 4: 基础小提琴图组间差异显著性并标注\n\n\n\n\n\n\n\n2. 反转小提琴图\n我们可以通过 coord_flip() 实现x、y轴的翻转。\n\nexample_counts2 &lt;- data_counts[1:6,] %&gt;% \n  gather(key = \"sample\",value = \"gene_expression\",3:1219) %&gt;% \n  mutate(gene_name= fct_reorder(gene_name,gene_expression ))\n\nggplot(example_counts2, aes(x=gene_name, y=gene_expression, fill=gene_name, color=gene_name)) +\n  geom_violin() +\n  scale_fill_viridis(discrete=TRUE) +\n  scale_color_viridis(discrete=TRUE) +\n  theme_ipsum() + # 改善主题外观\n  theme(legend.position=\"none\" ) +\n  coord_flip() + # 翻转 x 轴和 y 轴\n  xlab(\"\") +\n  ylab(\"Assigned Probability (%)\")\n\n\n\n\n\n\n\n图 5: 反转小提琴图使用 TCGA-BRCA 数据集\n\n\n\n\n\n\n\n3. 箱线小提琴图\n在实际可视化应用中，我们可以通过geom_boxplot()在小提琴图中添加箱线图，便于更加直观的比较数据。\n\nexample_data &lt;- data %&gt;% \n  left_join(sample_size) %&gt;%\n  mutate(myaxis = paste0(name, \"\\n\", \"n=\", num)) # 创建`myaxis`变量以在 x 轴上显示样本大小。\n\nggplot(example_data, aes(x=myaxis, y=value, fill=name)) +\n  geom_violin(width=1.4) +\ngeom_boxplot( width=0.1,color=\"grey\", alpha=0.2) + # 绘制箱线图。较小的宽度值会使箱线图位于小提琴图内。\nscale_fill_viridis(discrete = TRUE) +\n  theme_ipsum() + # 美化绘图\n  theme(\n   legend.position=\"none\",\n   plot.title = element_text(size=11)\n  ) +\n  ggtitle(\"A Violin plot wrapping a boxplot\") +  # 设置标题\n  xlab(\"\")\n\n\n\n\n\n\n\n图 6: 箱线小提琴图\n\n\n\n\n\n使用 TCGA-BRCA 基因表达数据绘制的带有箱线图的小提琴图\n\nexample_counts3 &lt;- data_counts[1:5,] %&gt;%\n  gather(key = \"sample\", value = \"gene_expression\",3:1219) %&gt;%\n  mutate(gene_name= fct_reorder(gene_name,gene_expression ))\n\nggplot(example_counts3, aes(x=gene_name, y=gene_expression, fill=gene_name, color=gene_name)) +\n  geom_violin() +\n  geom_boxplot( width=0.1,color=\"grey\", alpha=0.2)+\n  scale_fill_viridis(discrete=TRUE) +\n  scale_color_viridis(discrete=TRUE) +\n  theme_ipsum() + # 美化绘图\n  theme(legend.position=\"none\" ) \n\n\n\n\n\n\n\n图 7: 使用 TCGA-BRCA 基因表达数据绘制的带有箱线图的小提琴图\n\n\n\n\n\n\n\n4. 分组小提琴图\n在基础小提琴图的基础上，我们可以通过设置fill值来实现组内比较。\n下面的示例演示了如何使用fill属性进行组内比较。本例中使用了penguins数据集。x 变量代表物种，fill=sex创建了组内分类，以可视化每个物种内按性别分组的鳍状肢长度比较。\n\nggplot(data_penguins, aes(fill=sex, y=flipper_length_mm, x=species)) + # 使用X作为主分类，fill为组内分类\n  geom_violin(position=\"dodge\", alpha=0.5, outlier.colour=\"transparent\") +\n  scale_fill_viridis(discrete=T, name=\"\") +\n  theme_ipsum()  \n\n\n\n\n\n\n\n图 8: 分组小提琴图使用 penguins 数据集\n\n\n\n\n\n\n\n5. 半分小提琴图\n半分小提琴图可以用简便的方式展现大量信息，我们可以用geom_half_violin函数分别绘制两个group.\n在下面的例子中，我们通过在图的两侧绘制雌性和雄性企鹅来可视化不同物种和性别的企鹅的鳍状肢长度。\n\n# 分离雌性企鹅和雄性企鹅的数据\ndata_female &lt;- data_penguins %&gt;% filter(sex == \"female\")\ndata_male &lt;- data_penguins %&gt;% filter(sex == \"male\")\n\n# 绘制半分小提琴图（右侧为雌性，左侧为雄性）\nggplot() +\n  geom_half_violin(\n    data = data_female,\n    aes(y = flipper_length_mm, x = species),\n    position = position_dodge(width = 1),\n    scale = 'width',\n    colour = NA,\n    fill = \"#9370DB\",\n    alpha = 0.8,  ## 设置透明度\n    side = \"r\"\n  ) +\n  geom_half_violin(\n    data = data_male,\n    aes(y = flipper_length_mm, x = species),\n    position = position_dodge(width = 1),\n    scale = 'width',\n    colour = NA,\n    fill = \"#FFFF00\",\n    alpha = 0.6,\n    side = \"l\"\n  )\n\n\n\n\n\n\n\n图 9: 半分小提琴图使用 penguins 数据集\n\n\n\n\n\n\n\n6. 使用ggstatsplot包绘制小提琴图\nggstatsplot包扩展了ggplot2，添加了强大的统计可视化功能。ggbetweenstats()函数允许创建组合小提琴图、箱线图和散点图。\n在以下示例中，我们使用penguins数据集可视化了不同企鹅物种喙长的分布。我们使用theme()函数进一步增强了绘图的美观性。\n\nplt &lt;- ggbetweenstats(\n  data = data_penguins,\n  x = species,\n  y = bill_length_mm\n) +\n# 美化\n  labs(  ## 添加标签和标题\n    x = \"Penguins Species\",\n    y = \"Bill Length\",\n    title = \"Distribution of bill length across penguins species\"\n  ) +\n  theme(\n    axis.ticks = element_blank(),\n    axis.line = element_line(colour = \"grey50\"),\n    panel.grid = element_line(color = \"#b4aea9\"),\n    panel.grid.minor = element_blank(),\n    panel.grid.major.x = element_blank(),\n    panel.grid.major.y = element_line(linetype = \"dashed\"),\n    panel.background = element_rect(fill = \"#fbf9f4\", color = \"#fbf9f4\"),\n    plot.background = element_rect(fill = \"#fbf9f4\", color = \"#fbf9f4\")\n  )\n\nplt\n\n\n\n\n\n\n\n图 10: 使用ggstatsplot包绘制小提琴图",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Violin Plot"
    ]
  },
  {
    "objectID": "Distribution/ViolinPlot.html#应用场景",
    "href": "Distribution/ViolinPlot.html#应用场景",
    "title": "小提琴图",
    "section": "应用场景",
    "text": "应用场景\n\n1. 基础小提琴图\n\n\n\n\n\n\n图 11: 基础小提琴图应用\n\n\n\n图 11 e 图为七种癌症组织与对应正常组织中 circRNA 相对丰度的小提琴图 [1]。\n\n\n2. 分组小提琴图\n\n\n\n\n\n\n图 12: 分组小提琴图应用\n\n\n\n上示小提琴图分析比较了 A549 单细胞中 31 种蛋白质和 mRNA 的水平和分布 [2]。\n\n\n3. 半分小提琴图\n\n\n\n\n\n\n图 13: 半分小提琴图应用\n\n\n\n图 13 E 图利用半分小提琴图分析 WT 克隆在 WT 肠道（左）或 M−/+ 肠道（中图和右图）中的克隆大小分布 [3]。\n\n\n4. 箱线小提琴图\n\n\n\n\n\n\n图 14: 箱线小提琴图应用\n\n\n\n图 14 D 图展示附着在基质上 (noise) 和水中 (stimulation ) 的液滴的预期中值 MSD 和分布，以及纳米级的 RMS 位移 [4].",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Violin Plot"
    ]
  },
  {
    "objectID": "Distribution/ViolinPlot.html#参考文献",
    "href": "Distribution/ViolinPlot.html#参考文献",
    "title": "小提琴图",
    "section": "参考文献",
    "text": "参考文献\n[1] Zheng Q, Bao C, Guo W, Li S, Chen J, Chen B, Luo Y, Lyu D, Li Y, Shi G, Liang L, Gu J, He X, Huang S. Circular RNA profiling reveals an abundant circHIPK3 that regulates cell growth by sponging multiple miRNAs. Nat Commun. 2016 Apr 6;7:11215. doi: 10.1038/ncomms11215. PMID: 27050392; PMCID: PMC4823868.\n[2] Gong H, Wang X, Liu B, Boutet S, Holcomb I, Dakshinamoorthy G, Ooi A, Sanada C, Sun G, Ramakrishnan R. Single-cell protein-mRNA correlation analysis enabled by multiplexed dual-analyte co-detection. Sci Rep. 2017 Jun 5;7(1):2776. doi: 10.1038/s41598-017-03057-5. PMID: 28584233; PMCID: PMC5459813.\n[3] Kolahgar G, Suijkerbuijk SJ, Kucinski I, Poirier EZ, Mansour S, Simons BD, Piddini E. Cell Competition Modifies Adult Stem Cell and Tissue Population Dynamics in a JAK-STAT-Dependent Manner. Dev Cell. 2015 Aug 10;34(3):297-309. doi: 10.1016/j.devcel.2015.06.010. Epub 2015 Jul 23. PMID: 26212135; PMCID: PMC4537514.\n[4] Cribb JA, Osborne LD, Beicker K, Psioda M, Chen J, O’Brien ET, Taylor Ii RM, Vicci L, Hsiao JP, Shao C, Falvo M, Ibrahim JG, Wood KC, Blobe GC, Superfine R. An Automated High-throughput Array Microscope for Cancer Cell Mechanics. Sci Rep. 2016 Jun 6;6:27371. doi: 10.1038/srep27371. PMID: 27265611; PMCID: PMC4893602.\n[5] Wickham H, Vaughan D, Girlich M (2024). tidyr: Tidy Messy Data. R package version 1.3.1, https://CRAN.R-project.org/package=tidyr.\n[6] H. Wickham. ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York, 2016.\n[7] Wickham H, François R, Henry L, Müller K, Vaughan D (2023). dplyr: A Grammar of Data Manipulation. R package version 1.1.4, https://CRAN.R-project.org/package=dplyr.\n[8] Tiedemann F (2022). gghalves: Compose Half-Half Plots Using Your Favourite Geoms. R package version 0.1.4, https://CRAN.R-project.org/package=gghalves.\n[9] Wickham H (2023). forcats: Tools for Working with Categorical Variables (Factors). R package version 1.0.0, https://CRAN.R-project.org/package=forcats.\n[10] Rudis B (2024). hrbrthemes: Additional Themes, Theme Components and Utilities for ‘ggplot2’. R package version 0.8.7, https://CRAN.R-project.org/package=hrbrthemes.\n[11] Simon Garnier, Noam Ross, Robert Rudis, Antônio P. Camargo, Marco Sciaini, and Cédric Scherer (2024). viridis(Lite) - Colorblind-Friendly Color Maps for R. viridis package version 0.6.5.\n[12] Patil, I. (2021). Visualizations with statistical details: The ‘ggstatsplot’ approach. Journal of Open Source Software, 6(61), 3167, doi:10.21105/joss.03167\n[13] Horst AM, Hill AP, Gorman KB (2020). palmerpenguins: Palmer Archipelago (Antarctica) penguin data. R package version 0.1.0. https://allisonhorst.github.io/palmerpenguins/. doi: 10.5281/zenodo.3960218.",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Violin Plot"
    ]
  },
  {
    "objectID": "Distribution/Histogram.html",
    "href": "Distribution/Histogram.html",
    "title": "直方图",
    "section": "",
    "text": "直方图(histogram)用直条矩形面积代表各组频数，各矩形面积总和代表频数的总和。它主要用于表示连续变量频数分布情况。",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Histogram"
    ]
  },
  {
    "objectID": "Distribution/Histogram.html#示例",
    "href": "Distribution/Histogram.html#示例",
    "title": "直方图",
    "section": "示例",
    "text": "示例\n\n\n\n\n\n这个基础直方图展示了不同样本中TSPAN6基因的表达水平。x轴表示数据值，每个条形代表一个特定的值范围；y轴表示该范围内的数据点数量。在这个直方图中，条形表示每个指定范围内的值的数量。\n直方图显示数据以值12为中心，值的范围大致为8到16。直方图的形状近似于钟形，表明数据可能遵循正态分布。",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Histogram"
    ]
  },
  {
    "objectID": "Distribution/Histogram.html#环境配置",
    "href": "Distribution/Histogram.html#环境配置",
    "title": "直方图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：readr, ggplot2, ggExtra, tidyverse, cowplot, viridis, ggpmisc, ggpubr\n\n\n# 安装包\nif (!requireNamespace(\"readr\", quietly = TRUE)) {\n  install.packages(\"readr\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"ggExtra\", quietly = TRUE)) {\n  install.packages(\"ggExtra\")\n}\nif (!requireNamespace(\"tidyverse\", quietly = TRUE)) {\n  install.packages(\"tidyverse\")\n}\nif (!requireNamespace(\"cowplot\", quietly = TRUE)) {\n  install.packages(\"cowplot\")\n}\nif (!requireNamespace(\"viridis\", quietly = TRUE)) {\n  install.packages(\"viridis\")\n}\nif (!requireNamespace(\"ggpmisc\", quietly = TRUE)) {\n  install.packages(\"ggpmisc\")\n}\nif (!requireNamespace(\"ggpubr\", quietly = TRUE)) {\n  install.packages(\"ggpubr\")\n}\n\n# 加载包\nlibrary(readr)      # 读取 tsv 文件\nlibrary(ggplot2)    # 用于创建图\nlibrary(ggExtra)    # 用于增强 ggplot2 图形\nlibrary(tidyverse)  # 用于获取数据操作功能\nlibrary(cowplot)    # 用于将单独的 ggplot 合并到同一张图形中\nlibrary(viridis)    # 用于颜色映射\nlibrary(ggpmisc)    # ggplot2 的扩展，包含用于统计注释的附加函数\nlibrary(ggpubr)     # ggplot2 的扩展，添加了可发布的主题、排列多个图表和统计测试\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package     * version date (UTC) lib source\n cowplot     * 1.2.0   2025-07-07 [1] RSPM\n dplyr       * 1.1.4   2023-11-17 [1] RSPM\n forcats     * 1.0.1   2025-09-25 [1] RSPM\n ggExtra     * 0.11.0  2025-09-01 [1] RSPM\n ggplot2     * 4.0.1   2025-11-14 [1] RSPM\n ggpmisc     * 0.6.3   2025-11-29 [1] RSPM\n ggpp        * 0.5.9   2025-06-28 [1] RSPM\n ggpubr      * 0.6.2   2025-10-17 [1] RSPM\n lubridate   * 1.9.4   2024-12-08 [1] RSPM\n purrr       * 1.2.0   2025-11-04 [1] RSPM\n readr       * 2.1.6   2025-11-14 [1] RSPM\n stringr     * 1.6.0   2025-11-04 [1] RSPM\n tibble      * 3.3.0   2025-06-08 [1] RSPM\n tidyr       * 1.3.2   2025-12-19 [1] RSPM\n tidyverse   * 2.0.0   2023-02-22 [1] RSPM\n viridis     * 0.6.5   2024-01-29 [1] RSPM\n viridisLite * 0.4.2   2023-05-02 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Histogram"
    ]
  },
  {
    "objectID": "Distribution/Histogram.html#数据准备",
    "href": "Distribution/Histogram.html#数据准备",
    "title": "直方图",
    "section": "数据准备",
    "text": "数据准备\n我们使用内置的 R 数据集（iris、mtcars）以及来自UCSC Xena DATASETS的TCGA-BRCA.htseq_counts.tsv数据集。所选基因仅用于演示目的。\n\n# 读取 TSV 数据\ndata &lt;- readr::read_csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/TCGA-LIHC.htseq_counts.csv.gz\")\n\n# 过滤并重塑第一个基因 TSPAN6 的数据（Ensembl ID：ENSG00000000003.13）\ndata1 &lt;- data %&gt;%\n  filter(Ensembl_ID == \"ENSG00000000003.13\") %&gt;%\n  pivot_longer(\n    cols = -Ensembl_ID, \n    names_to = \"sample\", \n    values_to = \"expression\"\n  ) %&gt;%\n  mutate(var = \"var1\")  # 添加一列来区分变量\n\n# 过滤并重塑第二个基因 SCYL3 的数据（Ensembl ID：ENSG00000000457.12）\ndata2 &lt;- data %&gt;%\n  filter(Ensembl_ID == \"ENSG00000000457.12\") %&gt;%\n  pivot_longer(\n    cols = -Ensembl_ID, \n    names_to = \"sample\", \n    values_to = \"expression\"\n  ) %&gt;%\n  mutate(var = \"var2\")  # 添加一列来区分变量\n\n# 合并两个数据集\ndata12 &lt;- bind_rows(data1, data2)\n\n# 查看最终合并的数据集\nhead(data12)\n\n# A tibble: 6 × 4\n  Ensembl_ID         sample           expression var  \n  &lt;chr&gt;              &lt;chr&gt;                 &lt;dbl&gt; &lt;chr&gt;\n1 ENSG00000000003.13 TCGA-DD-A4NG-01A      12.8  var1 \n2 ENSG00000000003.13 TCGA-G3-AAV4-01A       9.72 var1 \n3 ENSG00000000003.13 TCGA-2Y-A9H1-01A      11.3  var1 \n4 ENSG00000000003.13 TCGA-CC-A3M9-01A      11.6  var1 \n5 ENSG00000000003.13 TCGA-K7-AAU7-01A      11.5  var1 \n6 ENSG00000000003.13 TCGA-BC-A10W-01A      12.0  var1",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Histogram"
    ]
  },
  {
    "objectID": "Distribution/Histogram.html#可视化",
    "href": "Distribution/Histogram.html#可视化",
    "title": "直方图",
    "section": "可视化",
    "text": "可视化\n\n1. 基础直方图\n图 1 展示了 TSPAN6 基因在不同样本中的表达量分布情况。\n\n# 基础直方图\np1 &lt;- ggplot(data1, aes(x = expression)) +\n  geom_histogram() + \n  labs(x = \"Gene Expression\", y = \"Count\")\n\np1\n\n\n\n\n\n\n\n图 1: 基础直方图\n\n\n\n\n\n\n\n\n\n\n\n提示\n\n\n\n关键参数: binwidth / bins\nbinwidth/bins参数决定每一个箱体包含数据的多少，改变binwidth/bins会对图形造成很大的影响，也会影响到想要表达的信息。\n\n\n\np2_1 &lt;- ggplot(data1, aes(x = expression)) +\n  geom_histogram(bins = 30, fill = \"skyblue\", color = \"white\") +\n  ggtitle(\"Bins = 30\") + \n  labs(x = \"Gene Expression\", y = \"Count\")\n\np2_2 &lt;- ggplot(data1, aes(x = expression)) +\n  geom_histogram(bins = 50, fill = \"skyblue\", color = \"white\") +\n  ggtitle(\"Bins = 50\") + \n  labs(x = \"Gene Expression\", y = \"Count\")\n\ncowplot::plot_grid(p2_1, p2_2)\n\n\n\n\n\n\n\n图 2: 关键参数: binwidth / bins\n\n\n\n\n\n\n\n2. 添加密度曲线的直方图\n密度曲线则提供了数据分布的平滑表示，它不依赖于具体的分箱数，而是使用核密度估计（kernel density estimation）来平滑分布曲线。这样可以更好地展示数据的总体趋势和形状。\n\np1 &lt;- ggplot(data1, aes(x = expression)) +\n  geom_histogram(aes(y = after_stat(density)), bins = 30, fill = \"skyblue\", color = \"white\") +\n  geom_density(alpha = 0.2, fill = \"#FF6666\") + \n  labs(x = \"Gene Expression\", y = \"Density\")\n\np1\n\n\n\n\n\n\n\n图 3: 添加密度曲线的直方图\n\n\n\n\n\n\n\n3. 镜像直方图\n镜像直方图帮助我们非常直观地对比两个数据集的分布。通过镜像结构，可以快速判断两个数据集是否存在对称性或差异。镜像直方图将两个直方图整合在一张图上，减少了所需的可视化空间，同时保持了对数据分布的清晰描述。\n\np &lt;- ggplot(data12, aes(x = expression, fill = var)) +\n  geom_histogram(data = subset(data12, var == \"var1\"), \n                 aes(y = after_stat(density)), \n                 binwidth = 0.5, \n                 alpha = 0.7, \n                 fill = \"#69b3a2\") +\n  geom_histogram(data = subset(data12, var == \"var2\"), \n                 aes(y = -after_stat(density)), \n                 binwidth = 0.5, \n                 alpha = 0.7, \n                 fill = \"#404080\") +\n  scale_fill_manual(values = c(\"var1\" = \"#69b3a2\", \"var2\" = \"#404080\")) +\n  labs(x = \"Gene Expression\", y = \"Density\")\n\np\n\n\n\n\n\n\n\n图 4: 镜像直方图\n\n\n\n\n\n\n\n4.同一轴上的多个直方图\n同一轴上叠加或并排的直方图允许我们在同一个坐标系内，直接对比两个或多个数据集的分布。通过颜色或透明度的设置，可以在同一图中清楚地看到数据的重叠区域以及不同数据的分布差异。用于2~3组数据，过多会导致图片混乱难以阅读。\n\np &lt;- data12 %&gt;%\n  ggplot(aes(x = expression, fill = var)) +\n  geom_histogram(color = \"#e9ecef\", alpha = 0.6, position = 'identity') +\n  scale_fill_manual(values = c(\"#69b3a2\", \"#404080\")) +\n  labs(x = \"Expression Value\", y = \"Count\", fill = \"Type\") +\n  theme_minimal()\n\np\n\n\n\n\n\n\n\n图 5: 同一轴上的多个直方图\n\n\n\n\n\n为了更加清晰地比较多个分布的距离，可以统计mean或者median，并绘制密度和垂直线。\n\np &lt;- data12 %&gt;%\n  gghistogram(x = \"expression\",\n   color = \"var\",\n   fill = \"var\",\n   add = \"median\", # 可以是 mean 或 median\n   rug = TRUE,\n   palette = c(\"#00AFBB\", \"#E7B800\")) +\n  theme_minimal()\n\np\n\n\n\n\n\n\n\n图 6: 直方图均值或中位数分布距离\n\n\n\n\n\n\n\n5. 多个变量的分面直方图\n分面直方图通过将多个变量或分类变量按面板布局展示，可以实现多维数据的对比、分层和详细分析。相比基础直方图，它不仅在处理复杂数据上更高效，还能避免图形重叠，并提供了更直观的变量对比，尤其在分类变量、分组数据和多变量分析中更具优势。\n\n# 使用内置 iris 数据集\ndata &lt;- iris\n\n# 将数据从宽格式重塑为长格式\ndata &lt;- data %&gt;%\n  gather(key = \"variable\", value = \"value\", -Species)  # 排除Species列\n\n# 绘制分面直方图\np &lt;- data %&gt;%\n  ggplot(aes(x = value, color = Species, fill = Species)) +\n  geom_histogram(alpha = 0.6, binwidth = 0.3, position = \"identity\") +\n  scale_fill_viridis(discrete = TRUE, option = \"D\") +\n  scale_color_viridis(discrete = TRUE, option = \"D\") +\n  theme(\n    legend.position = \"bottom\",\n    panel.spacing = unit(0.5, \"lines\"),\n    strip.text.x = element_text(size = 10)\n  ) +\n  xlab(\"Value\") +\n  ylab(\"Frequency\") +\n  facet_grid(Species ~ variable, scales = \"free_x\")  # 创建分面网格\n\np\n\n\n\n\n\n\n\n图 7: 多个变量的分面直方图\n\n\n\n\n\n\n\n6. 使用 ggMarginal() 添加边际分布\n\n# 使用边际直方图创建散点图\np &lt;- ggplot(mtcars, aes(x = wt, y = mpg, color = factor(cyl), size = factor(cyl))) +\n  geom_point(aes(color = factor(cyl)), show.legend = TRUE) +  # 散点图根据 cyl 变化大小\n  geom_smooth(method = 'lm', formula = y ~ x, se = TRUE, linewidth = 1, aes(color = factor(cyl))) +  # 回归曲线\n  scale_color_manual(values = c(\"#2e3b97\", \"#faad61\", \"#b76252\")) +  # 指定回归曲线颜色\n  stat_regline_equation(\n    aes(label = paste(after_stat(eq.label), after_stat(rr.label), sep = \"~~~~\")),\n    formula = y ~ x, size = 3,\n    position = position_nudge(x = 2.7, y = 1)\n  ) +  # 添加回归方程和 R² 值\n  theme(legend.position = \"none\")  # 隐藏图例，实现更清晰的可视化\n\n# 向散点图添加边际直方图\np1 &lt;- ggMarginal(p, type = \"histogram\")\n\n# 显示图表\np1\n\n\n\n\n\n\n\n图 8: 使用 ggMarginal() 添加边际分布\n\n\n\n\n\n\n\n\n\n\n\n提示\n\n\n\n自定义参数用于绘制边际分布图\n\nsize：改变边际图大小。\n用常用参数自定义边际图外观。\nmargins = 'x'或margins = 'y'：仅显示一个边际图。\n\n\n\n\n# 使用边际直方图创建散点图\np &lt;- ggplot(mtcars, aes(x = wt, y = mpg, color = factor(cyl), size = factor(cyl))) +\n  geom_point(aes(color = factor(cyl)), show.legend = TRUE) +  # 散点颜色映射\n  geom_smooth(method = 'lm', formula = y ~ x, se = TRUE, linewidth = 1, aes(color = factor(cyl))) +  # 回归曲线\n  scale_color_manual(values = c(\"#2e3b97\", \"#faad61\", \"#b76252\")) +  # 回归线的自定义颜色\n  stat_regline_equation(\n    aes(label = paste(after_stat(eq.label), after_stat(rr.label), sep = \"~~~~\")),\n    formula = y ~ x, size = 1.5,\n    position = position_nudge(x = 2.2, y = 1)\n  ) +  # 添加回归方程和 R² 值\n  theme(legend.position = \"none\")  # 隐藏图例，实现更清晰的可视化\n\n# 更改边际图的大小\np1 &lt;- ggMarginal(p, type = \"histogram\", size = 10)\n\n# 自定义边际图的外观\np2 &lt;- ggMarginal(p, type = \"histogram\", fill = \"slateblue\", xparams = list(bins = 10))\n\n# 仅显示一个边际图（x 轴边际图）\np3 &lt;- ggMarginal(p, type = \"histogram\", margins = 'x')\n\ncowplot::plot_grid(p1, p2, p3)\n\n\n\n\n\n\n\n图 9: 自定义参数用于绘制边际分布图",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Histogram"
    ]
  },
  {
    "objectID": "Distribution/Histogram.html#应用场景",
    "href": "Distribution/Histogram.html#应用场景",
    "title": "直方图",
    "section": "应用场景",
    "text": "应用场景\n\n1. 基础直方图\n\n\n\n\n\n\n图 10: 基础直方图应用\n\n\n\nFigure 9 显示了n=6时人类 X 染色体和人类 Y 染色体直方图的相对频率之间的差异。[1]\n\n\n2. 分面直方图\n\n\n\n\n\n\n\n\n\n\n\n(a) Xiang, L. et al.(2023)\n\n\n\n\n\n\n\n\n\n\n\n(b) Gihr, G.A. et al.(2020)\n\n\n\n\n\n\n\n图 11: 分面直方图应用\n\n\n\nFig. 10a 显示了典型SPL的影像学表现及病变整体直方图分析如图2所示。[2]\nFig. 10b 展示了 WHO I 级（上排）和 WHO II 级星形细胞瘤（下排）患者的头颅 MRI 示例，包括相应的整个肿瘤 ADC 直方图、H&E 染色和 Ki-67 免疫组织化学结果。 [3]",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Histogram"
    ]
  },
  {
    "objectID": "Distribution/Histogram.html#参考文献",
    "href": "Distribution/Histogram.html#参考文献",
    "title": "直方图",
    "section": "参考文献",
    "text": "参考文献\n\nCosta, A. M., Machado, J. T., & Quelhas, M. D. (2011). Histogram-based DNA analysis for the visualization of chromosome, genome, and species information. Bioinformatics, 27(9), 1207–1214. https://doi.org/10.1093/bioinformatics/btr131\nXiang, L., Yang, H., Qin, Y., Wen, Y., Liu, X., & Zeng, W.-B. (2023). Differential value of diffusion kurtosis imaging and intravoxel incoherent motion in benign and malignant solitary pulmonary lesions. Frontiers in Oncology, 12, Article 1075072. https://doi.org/10.3389/fonc.2022.1075072\nGihr, G. A., Horvath-Rizea, D., Hekeler, E., Ganslandt, O., Henkes, H., Hoffmann, K.-T., Scherlach, C., & Schob, S. (2020). Histogram analysis of diffusion weighted imaging in low-grade gliomas: in vivo characterization of tumor architecture and corresponding neuropathology. Frontiers in Oncology, 10, 206. https://doi.org/10.3389/fonc.2020.00206\nWickham, H., Hester J, & Bryan J. (2024). readr: Read Rectangular Text Data. https://CRAN.R-project.org/package=readr\nWickham, H. (2016). ggplot2: Elegant graphics for data analysis. Springer. https://ggplot2.tidyverse.org\nGao, Y. (2021). ggExtra: Add marginal plots to ggplot2. https://cran.r-project.org/package=ggExtra\nWickham, H., & RStudio Team. (2019). tidyverse: Easily install and load the ‘tidyverse’. https://cran.r-project.org/package=tidyverse\nClaus O. Wilke. (2024). cowplot: Streamlined Plot Theme and Plot Annotations for ‘ggplot2’. https://CRAN.R-project.org/package=cowplot\nGarcía, M. (2018). viridis: Default color maps from ‘matplotlib’. https://cran.r-project.org/package=viridis\nAubry, R., & Bouchard, C. (2020). ggpmisc: Miscellaneous extensions to ‘ggplot2’. https://cran.r-project.org/package=ggpmisc\nKassambara, A. (2021). ggpubr: ‘ggplot2’ based publication-ready plots. https://cran.r-project.org/package=ggpubr",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Histogram"
    ]
  },
  {
    "objectID": "Distribution/BreakPlot.html",
    "href": "Distribution/BreakPlot.html",
    "title": "断点图",
    "section": "",
    "text": "带断点的组合图表示例。",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "BreakPlot"
    ]
  },
  {
    "objectID": "Distribution/BreakPlot.html#示例",
    "href": "Distribution/BreakPlot.html#示例",
    "title": "断点图",
    "section": "",
    "text": "带断点的组合图表示例。",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "BreakPlot"
    ]
  },
  {
    "objectID": "Distribution/BreakPlot.html#环境配置",
    "href": "Distribution/BreakPlot.html#环境配置",
    "title": "断点图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：ggplot2; ggbreak; dplyr; ggpubr; RColorBrewer; rstatix\n\n\n# 安装包\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"ggbreak\", quietly = TRUE)) {\n  install.packages(\"ggbreak\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"ggpubr\", quietly = TRUE)) {\n  install.packages(\"ggpubr\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\nif (!requireNamespace(\"rstatix\", quietly = TRUE)) {\n  install.packages(\"rstatix\")\n}\n\n# 加载包\nlibrary(ggplot2)\nlibrary(ggbreak)\nlibrary(dplyr)\nlibrary(ggpubr)\nlibrary(RColorBrewer)\nlibrary(rstatix)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package      * version date (UTC) lib source\n dplyr        * 1.1.4   2023-11-17 [1] RSPM\n ggbreak      * 0.1.6   2025-08-24 [1] RSPM\n ggplot2      * 4.0.1   2025-11-14 [1] RSPM\n ggpubr       * 0.6.2   2025-10-17 [1] RSPM\n RColorBrewer * 1.1-3   2022-04-03 [1] RSPM\n rstatix      * 0.7.3   2025-10-18 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "BreakPlot"
    ]
  },
  {
    "objectID": "Distribution/BreakPlot.html#数据准备",
    "href": "Distribution/BreakPlot.html#数据准备",
    "title": "断点图",
    "section": "数据准备",
    "text": "数据准备\n\n# 数据准备\ndf &lt;- ToothGrowth %&gt;%\n  group_by(supp, dose) %&gt;%\n  summarise(\n    mean_len = mean(len),\n    sd_len = sd(len),\n    n = n(),\n    se_len = sd_len/sqrt(n),\n    .groups = 'drop')\n\n\n# 统计检验（关键修复点）\nstat.test &lt;- ToothGrowth %&gt;%\n  group_by(dose) %&gt;%\n  t_test(len ~ supp) %&gt;%\n  add_xy_position(x = \"dose\", dodge = 0.8)\n\nhead(df)\n\n# A tibble: 6 × 6\n  supp   dose mean_len sd_len     n se_len\n  &lt;fct&gt; &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;  &lt;dbl&gt;\n1 OJ      0.5    13.2    4.46    10  1.41 \n2 OJ      1      22.7    3.91    10  1.24 \n3 OJ      2      26.1    2.66    10  0.840\n4 VC      0.5     7.98   2.75    10  0.869\n5 VC      1      16.8    2.52    10  0.795\n6 VC      2      26.1    4.80    10  1.52",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "BreakPlot"
    ]
  },
  {
    "objectID": "Distribution/BreakPlot.html#可视化",
    "href": "Distribution/BreakPlot.html#可视化",
    "title": "断点图",
    "section": "可视化",
    "text": "可视化\n\n1. 基础柱状图\n使用基础函数绘制图片的图注和简介。\n\n# 基础柱状图\np1 &lt;- ggplot(df, aes(x=dose, y=mean_len, fill=supp)) +\n  geom_col(position=position_dodge(0.4), width=0.2) +\n  geom_errorbar(aes(ymin=mean_len-sd_len, ymax=mean_len+sd_len),\n                width=0.1, position=position_dodge(0.4)) +\n  scale_y_continuous(breaks = seq(0, 30, 5)) +\n  scale_y_cut(breaks=c(15), which=1, scales=1.5) +\n  labs(x=\"Dose (mg/day)\", y=\"Tooth Length (mm)\") +\n  theme_classic()\n\np1\n\n\n\n\n\n\n\n图 1: 基础柱状图\n\n\n\n\n\n2. 分组散点图\n\n# 分组散点图\np2 &lt;- ggplot(ToothGrowth, aes(x=dose, y=len, color=supp)) +\n  geom_point(position=position_jitterdodge(jitter.width=0.2)) +\n  scale_y_continuous(breaks = seq(0, 40, 5)) +\n  scale_y_cut(breaks=c(15, 25), which=c(1,2), scales=c(1.5, 1)) +\n  labs(x=\"Dose (mg/day)\", y=\"Tooth Length (mm)\") +\n  theme_bw()\n\np2\n\n\n\n\n\n\n\n图 2: 分组散点图\n\n\n\n\n\n3. 折线图\n\n# 折线图\np3 &lt;- ggplot(df, aes(x=dose, y=mean_len, color=supp)) +\n  geom_line(linewidth=1) +\n  geom_point(size=3) +\n  scale_y_continuous(breaks = seq(0, 30, 5)) +\n  scale_y_cut(breaks=c(15), which=1, scales=1.5) +\n  labs(x=\"Dose (mg/day)\", y=\"Mean Tooth Length (mm)\") +\n  theme_minimal()\n\np3\n\n\n\n\n\n\n\n图 3: 折线图\n\n\n\n\n\n\n\n\n\n提示\n\n\n\n关键参数解析：\nbreaks: 设置断点位置\nwhich: 指定断点区间（从下往上计数）\nscales: 设置各区间比例尺缩放系数\nspace: 断点间距（默认0.1）\nposition_dodge(): 控制分组条形的位置间隔\nwidth 参数建议与 geom_col 的 width 参数保持一致\n\n\n\n\n4. 更多进阶图表\n\n# 更多进阶图表\nmy_colors &lt;- c(\"#1B9E77\", \"#D95F02\")  # 来自RColorBrewer的Set2调色板\np4 &lt;- ggplot(df, aes(x = factor(dose), y = mean_len, fill = supp)) +\n  geom_col(position = position_dodge(0.8), width = 0.7, alpha = 0.9) +\n  geom_errorbar(\n    aes(ymin = mean_len - se_len, ymax = mean_len + se_len),\n    width = 0.2, position = position_dodge(0.8)\n  ) +\n  geom_text(\n    aes(group = supp, label = sprintf(\"%.1f±%.1f\", mean_len, se_len)),\n    position = position_dodge(0.8), vjust = -1, size = 4\n  ) +\n  scale_y_continuous(\n    breaks = seq(0, 35, 5) # 增加上方扩展空间\n  ) +\n  scale_y_break(c(8,12)\n  ) +\n  scale_fill_manual(values = my_colors) +\n  labs(x = \"Dose (mg/day)\", y = \"Tooth Length (mm)\", fill = \"Supplement\") +\n  theme_minimal(base_size = 12) +\n  theme(\n    legend.position = \"top\",\n    panel.grid.major.x = element_blank()\n  )\n\np4\n\n\n\n\n\n\n\n图 4: 更多进阶图表",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "BreakPlot"
    ]
  },
  {
    "objectID": "Distribution/BreakPlot.html#应用场景",
    "href": "Distribution/BreakPlot.html#应用场景",
    "title": "断点图",
    "section": "应用场景",
    "text": "应用场景\n展示可视化图表在生物医学文献中的实际应用，如果基础图表/进阶图表被广泛应用在各类生物医学文献，则可以选择分别展示。\n\n1. 基因表达量可视化（处理极端离群值）\n\n\n\n\n\n\n图 5: 断轴图的应用\n\n\n\n显示了基因表达的变化。 [1]\n\n\n2. 临床指标分布展示（处理不同量纲数据）\n\n\n\n\n\n\n图 6: 断轴图的应用\n\n\n\n图显示了不同妊娠时期母体子宫胎盘、肝脏、肾脏、心脏、胰腺和胸腺的 （A） [器官重量]和（B） 器官体重比的变化 。 [2]",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "BreakPlot"
    ]
  },
  {
    "objectID": "Distribution/BreakPlot.html#参考文献",
    "href": "Distribution/BreakPlot.html#参考文献",
    "title": "断点图",
    "section": "参考文献",
    "text": "参考文献\n[1] Xu S, et al. (2022) ggbreak: Effective Axis Break Creation in ggplot2. Journal of Open Source Software 7(74), 4301\n[2] Yu D, Wang H, Shyh-Chang N. A multi-tissue metabolome atlas of primate pregnancy. Cell. 2024 Feb 1;187(3):764-781.e14. doi: 10.1016/j.cell.2023.11.043.\n[3] Chen LQ, Hou BH, Mudgett MB, Frommer WB. Sugar transporters for intercellular exchange and nutrition of pathogens. Nature. 2010 Nov 25;468(7323):527-32. doi: 10.1038/nature09606.",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "BreakPlot"
    ]
  },
  {
    "objectID": "Distribution/BoxPlot.html",
    "href": "Distribution/BoxPlot.html",
    "title": "箱线图",
    "section": "",
    "text": "箱线图可以用来反映一组或多组连续型定量数据分布的中心位置和散布范围。箱形图包含数学统计量，不仅能够分析不同类别数据各层次水平差异，还能揭示数据间离散程度、异常值、分布差异等等。\n箱线图主要需要关注5条线，即上图中的上界线、上四分位线、中位数线、下四分位线、下界线，其中高于上界或低于下界的点为离群点。",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Box Plot"
    ]
  },
  {
    "objectID": "Distribution/BoxPlot.html#示例",
    "href": "Distribution/BoxPlot.html#示例",
    "title": "箱线图",
    "section": "示例",
    "text": "示例",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Box Plot"
    ]
  },
  {
    "objectID": "Distribution/BoxPlot.html#环境配置",
    "href": "Distribution/BoxPlot.html#环境配置",
    "title": "箱线图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：ggplot2, dplyr, hrbrthemes, viridis, ggExtra, ggpubr, rstatix, ggtext, ggpmisc\n\n\n# 安装包\nif (!requireNamespace(\"readr\", quietly = TRUE)) {\n  install.packages(\"readr\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"hrbrthemes\", quietly = TRUE)) {\n  install.packages(\"hrbrthemes\")\n}\nif (!requireNamespace(\"viridis\", quietly = TRUE)) {\n  install.packages(\"viridis\")\n}\nif (!requireNamespace(\"ggExtra\", quietly = TRUE)) {\n  install.packages(\"ggExtra\")\n}\nif (!requireNamespace(\"ggpubr\", quietly = TRUE)) {\n  install.packages(\"ggpubr\")\n}\nif (!requireNamespace(\"rstatix\", quietly = TRUE)) {\n  install.packages(\"rstatix\")\n}\nif (!requireNamespace(\"ggtext\", quietly = TRUE)) {\n  install.packages(\"ggtext\")\n}\nif (!requireNamespace(\"ggpmisc\", quietly = TRUE)) {\n  install.packages(\"ggpmisc\")\n}\n\n# 加载包\nlibrary(readr)\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(hrbrthemes)\nlibrary(viridis)\nlibrary(ggpubr)\nlibrary(rstatix)\nlibrary(ggtext)\nlibrary(ggpmisc)\nlibrary(ggExtra)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package     * version date (UTC) lib source\n dplyr       * 1.1.4   2023-11-17 [1] RSPM\n ggExtra     * 0.11.0  2025-09-01 [1] RSPM\n ggplot2     * 4.0.1   2025-11-14 [1] RSPM\n ggpmisc     * 0.6.3   2025-11-29 [1] RSPM\n ggpp        * 0.5.9   2025-06-28 [1] RSPM\n ggpubr      * 0.6.2   2025-10-17 [1] RSPM\n ggtext      * 0.1.2   2022-09-16 [1] RSPM\n hrbrthemes  * 0.9.2   2025-11-02 [1] Github (hrbrmstr/hrbrthemes@d3fd029)\n readr       * 2.1.6   2025-11-14 [1] RSPM\n rstatix     * 0.7.3   2025-10-18 [1] RSPM\n viridis     * 0.6.5   2024-01-29 [1] RSPM\n viridisLite * 0.4.2   2023-05-02 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Box Plot"
    ]
  },
  {
    "objectID": "Distribution/BoxPlot.html#数据准备",
    "href": "Distribution/BoxPlot.html#数据准备",
    "title": "箱线图",
    "section": "数据准备",
    "text": "数据准备\n我们使用内置的 R 数据集（mtcars）、ggplot2 包中的数据（mpg、diamonds）以及来自UCSC Xena DATASETS的TCGA-BRCA.htseq_counts.tsv数据集。所选基因仅用于演示目的。\n\n# 加载 mtcars 数据集\ndata(\"mtcars\")\ndata_mtcars &lt;- mtcars\n\n# 加载 ggplot2 包中的 mpg 数据集\ndata_mpg &lt;- ggplot2::mpg\n\n# 加载 ggplot2 包中的 diamonds 数据集\ndata_diamonds &lt;- ggplot2::diamonds\n\n# 从处理过的 CSV 文件加载 TCGA-BRCA 基因表达数据集\ndata_TCGA &lt;- readr::read_csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/TCGA-BRCA.htseq_counts_processed.csv\")\ndata_TCGA1 &lt;- data_TCGA[1:5,] %&gt;%\n  gather(key = \"sample\",value = \"gene_expression\",3:1219)",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Box Plot"
    ]
  },
  {
    "objectID": "Distribution/BoxPlot.html#可视化",
    "href": "Distribution/BoxPlot.html#可视化",
    "title": "箱线图",
    "section": "可视化",
    "text": "可视化\n\n1. 基础箱线图\n\n基础绘图\nggplot2 包允许运用 geom_boxplot() 进行基础箱线图的绘制。\n以 TCGA-BRCA.htseq_counts.tsv 数据集为例：\n\nggplot(data_TCGA1, aes(x=as.factor(gene_name), y=gene_expression)) + \n  geom_boxplot(fill=\"slateblue\", alpha=0.2) + # 颜色填充及字体大小\n  xlab(\"gene_name\") # x轴标签\n\n\n\n\n\n\n\n\n\n\n参数调整\n以 mtcars 数据集为例:\n\nggplot(data_mtcars, aes(x=as.factor(cyl), y=mpg)) + \n  geom_boxplot(\n    # 箱体\n    color=\"blue\",\n    fill=\"blue\",\n    alpha=0.2,\n    # 缺口\n    notch=TRUE,\n    notchwidth = 0.8,\n    # 离群点\n    outlier.colour=\"red\",\n    outlier.fill=\"red\",\n    outlier.size=3\n  ) + \n  xlab(\"cyl\")\n\n\n\n\n\n\n\n\n\n\n颜色设置\n以 mpg 数据集为例，展示几种箱线图常用的色标:\n\nggplot(data_mpg, aes(x=class, y=hwy)) + \n  geom_boxplot(color=\"red\", fill=\"orange\", alpha=0.2)\n\n\n\n\n\n\n\n\n\n\nggplot(data_mpg, aes(x=class, y=hwy, fill=class)) + \n  geom_boxplot(alpha=0.3) +\n  theme(legend.position=\"none\")\n\n\n\n\n\n\n\n\n\n\nggplot(data_mpg, aes(x=class, y=hwy, fill=class)) + \n  geom_boxplot(alpha=0.3) +\n  theme(legend.position=\"none\") +\n  scale_fill_brewer(palette=\"Dark2\")\n\n\n\n\n\n\n\n\n\n\n组间高亮\n以 mpg 数据集为例，为需要突出显示的组设置不同的颜色:\n\ndata_mpg %&gt;% \n  # 添加高亮组，创建颜色向量\n  mutate(type=ifelse(class==\"subcompact\",\"Highlighted\",\"Normal\")) %&gt;%\n  # fill=type，将颜色向量对应到箱图\n  ggplot(aes(x=class, y=hwy, fill=type, alpha=type)) + \n  geom_boxplot() +\n  scale_fill_manual(values=c(\"#69b3a2\", \"grey\")) +\n  scale_alpha_manual(values=c(1,0.1)) +\n  theme_ipsum() +\n  theme(legend.position = \"none\") +\n  xlab(\"\")\n\n\n\n\n\n\n\n\n\n\n\n2. 可变宽度箱线图\n基础箱线图无法展示类别样本的数量信息，我们可以通过varwidth参数绘制箱体宽度与样本数量成正比的可变宽度箱线图\n\nnames &lt;- c(rep(\"A\", 20) , rep(\"B\", 5) , rep(\"C\", 30), rep(\"D\", 100))\nvalue &lt;- c(sample(2:5, 20 , replace=T) , sample(4:10, 5 , replace=T), sample(1:7, 30 , replace=T), sample(3:8, 100 , replace=T))\ndata &lt;- data.frame(names,value)\n# 创建对应的横坐标标签\nmy_xlab &lt;- paste(levels(data$names),\"\\n(N=\",table(data$names),\")\",sep=\"\")\n\n# 绘图\nggplot(data, aes(x=names, y=value, fill=names)) +\n  geom_boxplot(varwidth = TRUE, alpha=0.2) + # varwidth = TRUE达成宽度与样本数量成正比\n  theme(legend.position=\"none\") +\n  scale_x_discrete(labels=my_xlab)\n\n\n\n\n\n\n\n\n再以上述 mpg 数据集为例:\n\nggplot(data_mpg, aes(x=class, y=hwy, fill=class)) + \n  geom_boxplot(varwidth = TRUE,alpha=0.3) +\n  theme(legend.position=\"none\") +\n  scale_fill_brewer(palette=\"Dark2\")\n\n\n\n\n\n\n\n\n\n\n3. 连续变量的箱线图\n对于连续变量，我们可以利用cut_width( )函数将连续变量进行区间分割再进行箱线图的绘制。\n以 diamonds 数据集为例:\n\ndata_diamonds %&gt;%\n  # 创建新变量，分割连续变量区间（0.5为一个区间）\n  mutate(bin=cut_width(carat, width=0.5, boundary=0)) %&gt;%\n  # 绘图，以分割的区间作为x\n  ggplot(aes(x=bin, y=price)) +\n  geom_boxplot(fill=\"#69b3a2\") +\n  theme_ipsum() +\n  xlab(\"Carat\")\n\n\n\n\n\n\n\n\n\n\n4. 添加平均值的箱线图\n基础的箱线图显示每组都中位数，同时我们可以利用stat_summary()函数为箱线图添加每组的平均值\n\nnames=c(rep(\"A\", 20) , rep(\"B\", 8) , rep(\"C\", 30), rep(\"D\", 80))\nvalue=c( sample(2:5, 20 , replace=T) , sample(4:10, 8 , replace=T), sample(1:7, 30 , replace=T), sample(3:8, 80 , replace=T) )\ndata=data.frame(names,value)\n# 绘图\np &lt;- ggplot(data, aes(x=names, y=value, fill=names)) +\n  geom_boxplot(alpha=0.7) +\n  stat_summary(fun.y=mean, geom=\"point\", shape=20, size=14, color=\"white\", fill=\"white\") +\n  theme(legend.position=\"none\") +\n  scale_fill_brewer(palette=\"Set1\")\np\n\n\n\n\n\n\n\n\n再以上述mpg数据集为例：\n\nggplot(data_mpg, aes(x=class, y=hwy, fill=class)) + \n  geom_boxplot(varwidth = TRUE,alpha=0.3) +\n  stat_summary(fun.y=mean, geom=\"point\", shape=10, size=5, color=\"black\", fill=\"black\") +\n  # fun.y为添加参数的类型，geom为显示的类型，shape为点类型，size为大小\n\n  theme(legend.position=\"none\") +\n  scale_fill_brewer(palette=\"Dark2\")\n\n\n\n\n\n\n\n\n\n\n5. 散点箱线图/小提琴图\n\n散点箱线图\n箱线图常用来比较多个组的分布，但具体数据的分布则无法表示（例如正态分布与双峰分布无法通过箱线图判断）。我们可以通过geom_jitter()函数添加独立观察，看到各组具体分布情况。\n\ndata &lt;- data.frame(\n  name=c( rep(\"A\",500), rep(\"B\",500), rep(\"B\",500), rep(\"C\",20), rep('D', 100)  ),\n  value=c( rnorm(500, 10, 5), rnorm(500, 13, 1), rnorm(500, 18, 1), rnorm(20, 25, 4), rnorm(100, 12, 1) )\n)\n\n\ndata %&gt;%\n  ggplot( aes(x=name, y=value, fill=name)) +\n  geom_boxplot() +\n  scale_fill_viridis(discrete = TRUE, alpha=0.6) +\n  geom_jitter(color=\"black\", size=0.4, alpha=0.9) + # Plotting scatter points\n  theme_ipsum() +\n  theme(\n    legend.position=\"none\",\n    plot.title = element_text(size=11)\n  ) +\n  ggtitle(\"A boxplot with jitter\") +\n  xlab(\"\")\n\n\n\n\n\n\n\n\n\n\n\n小提琴图\n小提琴图结合了和箱线图和密度分布图，也能体现组内观察到具体分布。\n\ndata &lt;- data.frame(\n  name=c( rep(\"A\",500), rep(\"B\",500), rep(\"B\",500), rep(\"C\",20), rep('D', 100)  ),\n  value=c( rnorm(500, 10, 5), rnorm(500, 13, 1), rnorm(500, 18, 1), rnorm(20, 25, 4), rnorm(100, 12, 1) )\n)\n\ndata %&gt;%\n  ggplot( aes(x=name, y=value, fill=name)) +\n  geom_violin() +\n  scale_fill_viridis(discrete = TRUE, alpha=0.6, option=\"A\") +\n  theme_ipsum() +\n  theme(\n    legend.position=\"none\",\n    plot.title = element_text(size=11)\n  ) +\n  ggtitle(\"Violin chart\") +\n  xlab(\"\")\n\n\n\n\n\n\n\n\n\n\n\n6. 分组箱线图\n在单组比较的基础上，我们可以通过fill参数来绘制分组箱线图，便于组间与组内的比较\n\nvariety=rep(LETTERS[1:4], each=40)\ntreatment=rep(c(\"high\",\"low\"),each=20)\nnote=seq(1:160)+sample(1:150, 160, replace=T)\ndata=data.frame(variety, treatment ,  note)\n\n# 绘图\nggplot(data, aes(x=variety, y=note, fill=treatment)) + # fill参数添加分组\n  geom_boxplot()\n\n\n\n\n\n\n\n\n添加差异分析:\n\nvariety=rep(LETTERS[1:4], each=40)\ntreatment=rep(c(\"high\",\"low\"),each=20)\nnote=seq(1:160)+sample(1:150, 160, replace=T)\ndata=data.frame(variety, treatment ,  note)\n\n# 差异检验\n# 组内\ndf &lt;- data\ndf$variety &lt;- factor(df$variety)\ndf_p_val1 &lt;- df %&gt;% \n  group_by(variety) %&gt;% \n  wilcox_test(formula = note~treatment) %&gt;% \n  add_significance(p.col = 'p',cutpoints = c(0,0.001,0.01,0.05,1),symbols = c('***','**','*','ns')) %&gt;% \n  add_xy_position(x='variety')\n# 组间\ndf_p_val2 &lt;- df %&gt;% \n  wilcox_test(formula = note~variety) %&gt;% \n  add_significance(p.col = 'p',cutpoints = c(0,0.001,0.01,0.05,1),symbols = c('***','**','*','ns')) %&gt;% \n  add_xy_position()\n\n\n# 绘图\nggplot()+\n  geom_boxplot(data = df,mapping = aes(x=variety, y=note, fill=treatment),width=0.5)+\n  stat_pvalue_manual(df_p_val1,label = '{p.signif}',\n                     tip.length = 0)+\n  stat_pvalue_manual(df_p_val2,label = '{p.signif}',\n                     tip.length = 0.01,\n                     y.position = df_p_val2$y.position+0.5)+\n  labs(x='variety',y='note')+\n  guides(fill=guide_legend(title = 'treatment'))+\n  theme_test()+\n  theme(axis.text = element_text(color = 'black'),\n        plot.caption = element_markdown(face = 'bold'),\n        legend.position = c(0.7,0.1),\n        legend.direction = 'horizontal')\n\n\n\n\n\n\n\n\n\n除了分组箱线图，我们还可以单独绘制各个子组的箱线图进行比较。\n\nvariety=rep(LETTERS[1:7], each=40)\ntreatment=rep(c(\"high\",\"low\"),each=20)\nnote=seq(1:280)+sample(1:150, 280, replace=T)\ndata1=data.frame(variety, treatment ,  note)\n# treatment 为依据\np1 &lt;- ggplot(data1, aes(x=variety, y=note, fill=treatment)) + \n  geom_boxplot() +\n    facet_wrap(~treatment, scale=\"free\")+\n  labs(x='variety',y='note')+\n  guides(fill=guide_legend(title = 'treatment'))+\n  theme_test()+\n  theme(axis.text = element_text(color = 'black'),\n        plot.caption = element_markdown(face = 'bold'),\n        legend.position = c(0.9,0.1),\n        legend.direction = 'horizontal')\np1\n\n\n\n\n\n\n\n\n\n# variety 为依据\np2 &lt;- ggplot(data1, aes(x=variety, y=note, fill=treatment)) + \n  geom_boxplot() +\n  facet_wrap(~variety, scale=\"free\")+\n  labs(x='variety',y='note')+\n  guides(fill=guide_legend(title = 'treatment'))+\n  theme_test()+\n  theme(axis.text = element_text(color = 'black'),\n        plot.caption = element_markdown(face = 'bold'),\n        legend.position = c(0.9,-0.05),\n        legend.direction = 'horizontal')\np2\n\n\n\n\n\n\n\n\n\n\n7. 添加箱线图边际分布\n在 X 轴和 Y 轴上添加的边际分布是常用的可视化方法，我们可以利用ggExtra包做到。这里我们主要介绍箱线图边际分布的添加\n以 mtcars 数据集为例:\n\n# 原始散点图\np1&lt;-ggplot(data_mtcars, aes(x=wt, y=mpg, color=cyl, size=cyl))+\n  geom_point()+\n  theme_bw()+ \n  geom_smooth(method = 'lm', formula = y~x, se = TRUE, show.legend = FALSE) + \n  stat_poly_eq(aes(label = paste(..eq.label.., ..rr.label.., stat(p.value.label), sep = '~`,`~')),\n               formula = y~x, parse = TRUE, npcx= 'left', npcy= 'bottom', size = 4)\n\np1\n\n\n\n\n\n\n\n\n\n# 添加箱线图边际分布\np1 &lt;- ggMarginal(p1, type=\"boxplot\")\np1\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n提示\n\n\n\nggMarginal() 主要自定义参数:\n\nsize: 更改边际图大小\n所有自定义外观的常用参数\nmargins = 'x' 或 margins = 'y': 仅显示一个边际图",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Box Plot"
    ]
  },
  {
    "objectID": "Distribution/BoxPlot.html#应用场景",
    "href": "Distribution/BoxPlot.html#应用场景",
    "title": "箱线图",
    "section": "应用场景",
    "text": "应用场景\n\n1. 基础箱线图\n\n\n\n\n\n\n图 1: 基础箱线图应用\n\n\n\nFigure E: Fab-PLA 结果通过 BlobFinder 软件进行量化并以箱线图的形式呈现。中值以粗线突出显示，晶须代表最小值和最大值。展现了各组细胞PLA信号量化数据的分布。[1]\n\n\n2. 高亮箱线图\n\n\n\n\n\n\n图 2: 高亮箱线图应用\n\n\n\nFigure B: 探针间距离分布的箱线图。\nFigure D & Figure F: MDA-MB-453 （D）或 HEK293（F） 中所示 H2A 过表达细胞的最大核横截面积分布的箱线图。其中高亮了有显著差异的组别。[2]\n\n\n3. 分组箱线图\n\n\n\n\n\n\n图 3: 分组箱线图应用\n\n\n\nFigure C: 具有不含有（左）或含有（右）所示残基的 H2A 的生物体的基因组大小的箱线图。[2]",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Box Plot"
    ]
  },
  {
    "objectID": "Distribution/BoxPlot.html#参考文献",
    "href": "Distribution/BoxPlot.html#参考文献",
    "title": "箱线图",
    "section": "参考文献",
    "text": "参考文献\n[1] Volkmann C, Brings N, Becker M, Hobeika E, Yang J, Reth M. Molecular requirements of the B-cell antigen receptor for sensing monovalent antigens. EMBO J. 2016 Nov 2;35(21):2371-2381. doi: 10.15252/embj.201694177. Epub 2016 Sep 15. PMID: 27634959; PMCID: PMC5090217.\n[2] Macadangdang BR, Oberai A, Spektor T, Campos OA, Sheng F, Carey MF, Vogelauer M, Kurdistani SK. Evolution of histone 2A for chromatin compaction in eukaryotes. Elife. 2014 Jun 17;3:e02792. doi: 10.7554/eLife.02792. PMID: 24939988; PMCID: PMC4098067.\n[3] H. Wickham. ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York, 2016.\n[4] Wickham H, François R, Henry L, Müller K, Vaughan D (2023). dplyr: A Grammar of Data Manipulation. R package version 1.1.4, https://CRAN.R-project.org/package=dplyr.\n[5] Rudis B (2024). hrbrthemes: Additional Themes, Theme Components and Utilities for ‘ggplot2’. R package version 0.8.7, https://CRAN.R-project.org/package=hrbrthemes.\n[6] Wickham H, Averick M, Bryan J, Chang W, McGowan LD, François R, Grolemund G, Hayes A, Henry L, Hester J, Kuhn M, Pedersen TL, Miller E, Bache SM, Müller K, Ooms J, Robinson D, Seidel DP, Spinu V, Takahashi K, Vaughan D, Wilke C, Woo K, Yutani H (2019). “Welcome to the tidyverse.” Journal of Open Source Software, 4(43), 1686. doi:10.21105/joss.01686 https://doi.org/10.21105/joss.01686.\n[7] Simon Garnier, Noam Ross, Robert Rudis, Antônio P. Camargo, Marco Sciaini, and Cédric Scherer (2024). viridis(Lite) - Colorblind-Friendly Color Maps for R. viridis package version 0.6.5.\n[8] Attali D, Baker C (2023). ggExtra: Add Marginal Histograms to ‘ggplot2’, and More ‘ggplot2’ Enhancements. R package version 0.10.1, https://CRAN.R-project.org/package=ggExtra.",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Box Plot"
    ]
  },
  {
    "objectID": "Clinics/Nomogram.html",
    "href": "Clinics/Nomogram.html",
    "title": "诺莫图",
    "section": "",
    "text": "诺莫图（Nomogram），简单来说，就是将Logistic回归或Cox回归的结果通过图形化方式展示出来。它根据每个自变量的回归系数来制定评分标准，给每个自变量的取值分配一个分数。然后，针对每个患者，计算出一个总分，并通过转换函数，将得分转化为该患者发生特定结局的概率。\n常见的列线图的名称主要包括三个部分： 1. 预测模型中的变量名称：例如图中的“stage”（阶段）、“gender”（性别）、“age”（年龄）等，每个变量对应的线段上标有刻度，表示该变量的取值范围，线段的长度反映该因素对结局事件的影响程度。 2. 得分：包括单项得分（图中的“β(X-m) terms”）和总得分（“Total score”）。单项得分表示每个变量在不同取值下的分数，总得分则是所有变量分数的加和。 3. 预测概率：例如“mean status”（平均状态），表示死亡的概率。",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> 𝐂𝐋𝐈𝐍𝐈𝐂𝐒",
      "Nomogram"
    ]
  },
  {
    "objectID": "Clinics/Nomogram.html#示例",
    "href": "Clinics/Nomogram.html#示例",
    "title": "诺莫图",
    "section": "示例",
    "text": "示例\n\n\n\n\n\n如红色箭头所示，找出该患者每个变量对应的单项得分。最后将所有变量的单项得分相加，得到患者的总得分，并以总得分为基础，再向下画一条垂直线，就可以知道该患者侵袭性肺腺癌的患病风险。",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> 𝐂𝐋𝐈𝐍𝐈𝐂𝐒",
      "Nomogram"
    ]
  },
  {
    "objectID": "Clinics/Nomogram.html#环境配置",
    "href": "Clinics/Nomogram.html#环境配置",
    "title": "诺莫图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包： readr, rms, survival, regplot\n\n\n# 安装包\nif (!requireNamespace(\"readr\", quietly = TRUE)) {\n  install.packages(\"readr\")\n}\nif (!requireNamespace(\"rms\", quietly = TRUE)) {\n  install.packages(\"rms\")\n}\nif (!requireNamespace(\"survival\", quietly = TRUE)) {\n  install.packages(\"survival\")\n}\nif (!requireNamespace(\"regplot\", quietly = TRUE)) {\n  install.packages(\"regplot\")\n}\n\n# 加载包\nlibrary(readr)\nlibrary(rms)\nlibrary(survival)\nlibrary(regplot)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package  * version date (UTC) lib source\n Hmisc    * 5.2-4   2025-10-05 [1] RSPM\n readr    * 2.1.6   2025-11-14 [1] RSPM\n regplot  * 1.1     2020-06-26 [1] RSPM\n rms      * 8.1-0   2025-10-14 [1] RSPM\n survival * 3.8-3   2024-12-17 [3] CRAN (R 4.5.2)\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> 𝐂𝐋𝐈𝐍𝐈𝐂𝐒",
      "Nomogram"
    ]
  },
  {
    "objectID": "Clinics/Nomogram.html#数据准备",
    "href": "Clinics/Nomogram.html#数据准备",
    "title": "诺莫图",
    "section": "数据准备",
    "text": "数据准备\n数据下载于Xena浏览器 [2] 中GDC TCGA Liver Cancer (LIHC)数据库的Phenotype文件。\n\n## 载入数据\nclinical &lt;- readr::read_tsv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/TCGA-LIHC.clinical.tsv\")\nLIHC &lt;- cbind(clinical$sample,clinical[,c('gender.demographic',\n                                             'vital_status.demographic',\n                                             'days_to_death.demographic',\n                                             'age_at_index.demographic',\n                                             'ajcc_pathologic_stage.diagnoses')])\ncolnames(LIHC) &lt;- c('bcr_patient_barcode','gender','status','time','age','stage')\ntable(LIHC$status)\n\n\n       Alive         Dead Not Reported \n         265          172            2 \n\nLIHC &lt;- LIHC[LIHC$status != 'Not Reported',]\nLIHC$status &lt;- as.numeric(ifelse(LIHC$status=='Dead','2','1') ) # 在nomogram中死亡为2",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> 𝐂𝐋𝐈𝐍𝐈𝐂𝐒",
      "Nomogram"
    ]
  },
  {
    "objectID": "Clinics/Nomogram.html#可视化",
    "href": "Clinics/Nomogram.html#可视化",
    "title": "诺莫图",
    "section": "可视化",
    "text": "可视化\n\n1. 基础诺莫图\n基础诺莫图显示了使用广义线性模型对生存状态（status）与年龄（age）、性别（gender）、疾病阶段（stage）建模的结果。\n\n# 基础诺莫图\ndd=datadist(LIHC)\noptions(datadist=\"dd\")\n## 构建logist模型,绘制诺莫图\nf1 &lt;- lrm(status ~ age + gender + stage , data =  LIHC)\nnom &lt;- nomogram(f1, fun=plogis, lp=F, funlabel=\"Risk\")\nplot(nom)\n\n\n\n\n\n\n\n图 1: 基础诺莫图\n\n\n\n\n\n我们也可以使用诺莫图展示cox回归模型对生存时间（time）、生存状态（status）与年龄（age）、性别（gender）、疾病阶段（stage）建模的结果。\n\n## 构建COX比例风险模型\nf2 &lt;- psm(Surv(time,status) ~ age+gender+stage,data =  LIHC, dist='lognormal')\nmed &lt;- Quantile(f2) # 计算中位生存时间\nsurv &lt;- Survival(f2) # 构建生存概率函数\n## 绘制COX回归中位生存时间的Nomogram图\nnom &lt;- nomogram(f2, fun=function(x) med(lp=x),funlabel=\"Median Survival Time\")\nplot(nom)\n\n\n\n\n\n\n\n图 2: 构建COX比例风险模型\n\n\n\n\n\n我们还可以使用诺莫图对预测的3年-5年-生存概率进行绘制。\n\n## LIHC数据的time是以”天“为单位,此处绘制3年，5年的生存概率\nnom &lt;- nomogram(f2, fun=list(function(x) surv(1095, x),\n                             function(x) surv(1825, x),\n                             function(x) med(lp=x)),\n                funlabel=c(\"3-year Survival Probability\", \"5-year Survival Probability\",\"Median Survival Time\"))\nplot(nom, xfrac=.2)\n\n\n\n\n\n\n\n图 3: 预测3年-5年-生存概率\n\n\n\n\n\n\n\n2. 美化诺莫图\n除了使用nomogram进行建模绘图外，我们还可以使用survival包和regplot包配合进行建模与绘图，下图是使用广义线性模型进行模型的构建与绘制。\n\n# 展示逻辑回归，支持\"lm\", \"glm\", \"coxph\", \"survreg\" \"negbin\"\n## 绘制逻辑回归图，显示优势尺度和置信区间\nlihcglm &lt;- glm(status ~ age + gender + stage, data=LIHC )\nregplot(lihcglm, \n        observation=LIHC[1,], \n        odds=TRUE, \n        interval=\"confidence\")\n\n\n\n\n\n\n\n图 4: 美化诺莫图1\n\n\n\n下图是使用广义线性模型进行模型的构建与绘制。\n\nlihccox &lt;- coxph(formula = Surv(time,status) ~ age+gender+stage , data = LIHC)\nregplot(lihccox,\n        observation=LIHC[2,], #对观测2的指标在列线图上进行计分展示\n        failtime = c(1095,1825),#预测3年和5年的死亡风险，此处单位是day\n        prfail = TRUE, #cox回归中需要TRUE\n        showP = T, #是否展示统计学差异\n        droplines = F,#观测2示例计分是否画线\n        interval=\"confidence\") #展示观测的可信区间\n\n\n\n\n\n\n\n图 5: 美化诺莫图2",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> 𝐂𝐋𝐈𝐍𝐈𝐂𝐒",
      "Nomogram"
    ]
  },
  {
    "objectID": "Clinics/Nomogram.html#应用场景",
    "href": "Clinics/Nomogram.html#应用场景",
    "title": "诺莫图",
    "section": "应用场景",
    "text": "应用场景\n\n\n\n\n\n\n图 6: 诺莫图应用\n\n\n\n该图为两个用于临床应用的示意图，整合了基于 6miRNA 的分类器和四个临床病理风险因素，以预测哪些患者可能从 II 期结肠癌手术后的辅助化疗中受益。[2]",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> 𝐂𝐋𝐈𝐍𝐈𝐂𝐒",
      "Nomogram"
    ]
  },
  {
    "objectID": "Clinics/Nomogram.html#参考文献",
    "href": "Clinics/Nomogram.html#参考文献",
    "title": "诺莫图",
    "section": "参考文献",
    "text": "参考文献\n[1] Goldman MJ, Craft B, Hastie M, et al. Visualizing and interpreting cancer genomics data via the Xena platform. Nat Biotechnol. 2020;38(6):675-678. doi:10.1038/s41587-020-0546-8\n[2] Zhang JX, Song W, Chen ZH, et al. Prognostic and predictive value of a microRNA signature in stage II colon cancer: a microRNA expression analysis [published correction appears in Lancet Oncol. 2014 Jan;15(1):e4]. Lancet Oncol. 2013;14(13):1295-1306. doi:10.1016/S1470-2045(13)70491-1",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> 𝐂𝐋𝐈𝐍𝐈𝐂𝐒",
      "Nomogram"
    ]
  },
  {
    "objectID": "Clinics/LollipopPlot.html",
    "href": "Clinics/LollipopPlot.html",
    "title": "棒棒糖图",
    "section": "",
    "text": "（图片来源于Unsplash的Amy Shamblen）\n是否对千篇一律的柱状图感到厌倦呢？如果没有蛀牙的话，不如让我们一边吃一根棒棒糖，一边将柱状图变为棒棒图吧",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> 𝐂𝐋𝐈𝐍𝐈𝐂𝐒",
      "LollipopPlot"
    ]
  },
  {
    "objectID": "Clinics/LollipopPlot.html#示例",
    "href": "Clinics/LollipopPlot.html#示例",
    "title": "棒棒糖图",
    "section": "",
    "text": "（图片来源于Unsplash的Amy Shamblen）\n是否对千篇一律的柱状图感到厌倦呢？如果没有蛀牙的话，不如让我们一边吃一根棒棒糖，一边将柱状图变为棒棒图吧",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> 𝐂𝐋𝐈𝐍𝐈𝐂𝐒",
      "LollipopPlot"
    ]
  },
  {
    "objectID": "Clinics/LollipopPlot.html#环境配置",
    "href": "Clinics/LollipopPlot.html#环境配置",
    "title": "棒棒糖图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：ggplot2, ggpubr, patchwork, dplyr\n\n\n# 安装包\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"ggpubr\", quietly = TRUE)) {\n  install.packages(\"ggpubr\")\n}\nif (!requireNamespace(\"patchwork\", quietly = TRUE)) {\n  install.packages(\"patchwork\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\n\n# 加载包\nlibrary(ggplot2)\nlibrary(ggpubr)\nlibrary(patchwork)\nlibrary(dplyr)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package   * version date (UTC) lib source\n dplyr     * 1.1.4   2023-11-17 [1] RSPM\n ggplot2   * 4.0.1   2025-11-14 [1] RSPM\n ggpubr    * 0.6.2   2025-10-17 [1] RSPM\n patchwork * 1.3.2   2025-08-25 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> 𝐂𝐋𝐈𝐍𝐈𝐂𝐒",
      "LollipopPlot"
    ]
  },
  {
    "objectID": "Clinics/LollipopPlot.html#数据准备",
    "href": "Clinics/LollipopPlot.html#数据准备",
    "title": "棒棒糖图",
    "section": "数据准备",
    "text": "数据准备\n数据来源于Yang等人的文章。[1-2]\n\n# 读取数据\ndata &lt;- read.csv('https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/lollipop_1.csv', row.names = 1) #相关性分析数据读取\n# 查看数据集\nhead(data)\n\n                cell  pvalue  cor\n1       Plasma cells 3.6e-08 0.43\n2        Eosinophils 1.1e-06 0.38\n3      B cells naive 5.8e-05 0.32\n4     Macrophages M0 9.4e-04 0.26\n5 NK cells activated 2.2e-03 0.24\n6        T cells CD8 1.3e-02 0.20\n\n\n\n# 读取数据\ndata_2 &lt;- read.csv('https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/lollipop_2.csv') # 基因富集分析数据读取\n# 查看数据集\nhead(data_2)\n\n  GO.category                  GO.Process.description..term. GO.Term.ID\n1       GO:MF                                 enzyme binding GO:0019899\n2       GO:MF                                protein binding GO:0005515\n3       GO:MF     guanyl-nucleotide exchange factor activity GO:0005085\n4       GO:MF Ras guanyl-nucleotide exchange factor activity GO:0005088\n5       GO:MF                                 GTPase binding GO:0051020\n6       GO:MF Rho guanyl-nucleotide exchange factor activity GO:0005089\n     p.value Number.of.all.known.genes.enriched.to.the.GO.term\n1 2.2252e-09                                             1,518\n2 1.7950e-08                                             6,853\n3 4.1462e-07                                               187\n4 6.2395e-07                                               118\n5 1.2078e-05                                               424\n6 1.2377e-05                                                76\n  DEGs.with.GO.annotation Number.of.DEGs.enriched.to.the.particular.GO.term\n1                     313                                                71\n2                     313                                               194\n3                     313                                                20\n4                     313                                                16\n5                     313                                                28\n6                     313                                                12\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Gene.names.engaged.in.particular.GO.term\n1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ADCY6,ALS2,ARHGAP33,ARHGAP44,ARHGEF11,ARHGEF17,ARHGEF19,ARHGEF39,ARRDC1,AXIN2,BRD4,CAVIN3,CCNF,CLEC16A,COL1A1,CUL9,DBF4B,DENND6B,DIAPH1,DIO2,DLG4,DOCK6,DPP4,EGFR,FARP2,FURIN,GAS8,GBF1,HDAC6,HDAC7,HERC2,HTT,ISG15,KANSL1,KNDC1,KSR1,MAST2,MID1,MLPH,NCOR2,NOTCH1,OBSCN,PLEKHG2,PLEKHG3,PLK1,PPP6R2,PSD2,PTPN23,RAB11FIP3,RAPGEF1,RAPGEFL1,RBBP6,RHOF,RNF40,RPTOR,SBF1,SCAF1,SGSM1,SGSM2,SH2B1,SIK1,SKI,SLC9A1,SPATA13,SRCIN1,STRN4,TP73,TRAF3,TRIO,TSPAN5,VAV2\n2 ADCY6,AKAP17A,ALOX15,ALS2,ANKRD11,ARHGAP17,ARHGAP33,ARHGAP39,ARHGAP44,ARHGEF11,ARHGEF17,ARHGEF19,ARHGEF39,ARNT2,ARRDC1,ATXN1L,AXIN2,BCL9L,BRD3,BRD4,BTBD19,BTNL9,C12H17ORF100,C1QA,C1QTNF6,CACNA1G,CAMSAP1,CASKIN1,CAVIN3,CCNF,CD59,CD79A,CDH24,CENPT,CEP131,CEP164,CEP170B,CHD2,CHD7,CHERP,CLEC16A,COL1A1,COL5A1,CREBBP,CRSP3,CRTC1,CSRP1,CUL9,DBF4B,DENND4B,DENND6B,DGKD,DIAPH1,DIO2,DLG4,DLL1,DNAH1,DOCK6,DPP4,DYNC1H1,E2F1,E2F7,EFS,EGFR,EHBP1L1,EHMT1,ELMSAN1,ENSSSCG00000035856,EP300,FARP2,FBXL18,FURIN,FXYD1,GAS7,GAS8,GBF1,GIGYF1,GIPC3,HDAC6,HDAC7,HERC2,HTT,IGSF9,INPPL1,ISG15,KANSL1,KCNQ4,KCP,KCTD7,KIF12,KIF18B,KIF1A,KIF1C,KIF21B,KIF26A,KIF7,KMT2B,KNDC1,KSR1,LARP1,LDB3,LRP5,LZTS1,MAST2,MED12,MEGF8,MID1,MLPH,MMRN1,MNT,MRAP2,MYH14,MYH3,MYH7B,MYH9,NAV2,NCOR2,NECTIN1,NOTCH1,NSD2,NUMA1,OBSCN,PAX2,PER3,PIK3R2,PLCG1,PLEKHA6,PLEKHG2,PLEKHG3,PLK1,PLXNA1,PLXNA3,PLXNB3,PPP6R2,PRDM15,PSD2,PTPN23,PTPRF,RAB11FIP3,RAPGEF1,RAPGEFL1,RBBP6,RERE,RGS2,RHOF,RNF123,RNF40,RPTOR,RSPO3,S100A9,SALL1,SARM1,SART3,SBF1,SCAF1,SEMA4C,SEMA4F,SETD5,SGSM1,SGSM2,SH2B1,SH3PXD2B,SIK1,SKI,SLC9A1,SPATA13,SPTAN1,SRCIN1,STRN4,SYNE2,SYT3,TCAP,TENM2,TLE2,TMEFF2,TONSL,TP73,TRAF3,TRANK1,TRAPPC12,TRIM66,TRIO,TRRAP,TSPAN5,TSPO,TYK2,UBR4,UNC5B,USP20,VAV2,VEGFA,WDFY3,WDR62,ZMYND8\n3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ALS2,ARHGEF11,ARHGEF17,ARHGEF19,ARHGEF39,DENND6B,DOCK6,FARP2,GBF1,KNDC1,OBSCN,PLEKHG2,PLEKHG3,PSD2,RAPGEF1,RAPGEFL1,SBF1,SPATA13,TRIO,VAV2\n4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ALS2,ARHGEF11,ARHGEF17,ARHGEF19,ARHGEF39,DENND6B,FARP2,KNDC1,OBSCN,PLEKHG2,PLEKHG3,RAPGEF1,SBF1,SPATA13,TRIO,VAV2\n5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ALS2,ARHGAP44,ARHGEF11,ARHGEF17,ARHGEF19,ARHGEF39,CLEC16A,DENND6B,DIAPH1,DOCK6,FARP2,GAS8,GBF1,KNDC1,MLPH,OBSCN,PLEKHG2,PLEKHG3,PSD2,RAB11FIP3,RAPGEF1,RAPGEFL1,SBF1,SGSM1,SGSM2,SPATA13,TRIO,VAV2\n6                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ALS2,ARHGEF11,ARHGEF17,ARHGEF19,ARHGEF39,FARP2,OBSCN,PLEKHG2,PLEKHG3,SPATA13,TRIO,VAV2",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> 𝐂𝐋𝐈𝐍𝐈𝐂𝐒",
      "LollipopPlot"
    ]
  },
  {
    "objectID": "Clinics/LollipopPlot.html#可视化",
    "href": "Clinics/LollipopPlot.html#可视化",
    "title": "棒棒糖图",
    "section": "可视化",
    "text": "可视化\n\n1. 基础绘图\n基础棒棒图显示了COL17A1基因与免疫浸润相关性的结果。[1]\n\n# 基础棒棒图\n# 对相关系数和p值转换为分类变量\ndata$pvalue_group &lt;- cut(data$pvalue,\n                         breaks = c(0, 0.2, 0.4, 0.6,0.8, 1),\n                         labels = c(\"&lt; 0.2\",\"&lt; 0.4\",\"&lt; 0.6\",\"&lt; 0.8\",\"&lt;1\"),\n                         right=FALSE)# right=FALSE表示表示区间为左闭右开\ndata$cor_group_size &lt;- cut(abs(data$cor),# 绝对值\n                      breaks = c(0, 0.1, 0.2, 0.3, 0.4, 0.5),\n                      labels = c(\"0.1\",\"0.2\",\"0.3\",\"0.4\",\"0.5\"),\n                      right=FALSE) \n# 排序\ndata = data[order(data$cor),]\ndata$cell = factor(data$cell, levels = data$cell)\n\np = ggplot(data, \n           aes(x = cor, y = cell, color = pvalue_group)) +\n  scale_color_manual(name=\"pvalue\",\n                     values = c(\"#146432\", \n                                \"#4DB748\", \n                                #\"#FAA519\", #由于没有这个区间的数据，故注释掉\n                                \"#FABECD\" #,\n                                #\"#FAD700\"#由于没有这个区间的数据，故注释掉\n                                ))+ #棒棒糖中糖果的颜色选择\n  geom_segment(aes(x = 0, y = cell, xend = cor, yend = cell),\n               color = 'black', #棒棒糖中棒子的绘制\n               linewidth = 0.5) +\n  geom_point(aes(size = cor_group_size))+ #棒棒糖中糖果的绘制\n  labs(title = \"COL17A1\",#图片标题\n       size = \"abs(cor)\") + #图例的名称\n  guides(color = \"none\")+ #隐藏多余的图例   \n  theme_bw()+ #清空格式\n  theme(plot.title=element_text(size=8,  #标题大小\n                                hjust=0.5 ), #标题位置\n        legend.position = \"bottom\", #图例的位置\n        text = element_text(family = \"serif\"),#设置字体为Times New Roman\n        panel.grid = element_line(linetype = \"dotted\",color='grey')) \np\n\n\n\n\n\n\n\n图 1: 基础棒棒图\n\n\n\n\n\n注：图题为基因名，纵轴为系报名，横轴为该基因的表达量，cor为基因表达量与细胞丰度的相关性，其中横轴为相关性，大小为相关性的绝对值，颜色为P值。\n为了使棒棒糖图展示的信息更丰富，我们可以在图右侧添加信息，我们在上一步已经依据p值进行了排序，在这一步可以增加p值的文本，使得图片可读性更强。\n\ndata$pvalue_col &lt;- cut(data$pvalue,\n                       breaks = c(0, 0.05,1),\n                       labels = c(\"&lt; 0.05\",\"&gt; 0.05\"),\n                       right=FALSE) #在data中添加颜色分类信息\ndata$pvalue_text &lt;- ifelse(data$pvalue&gt;0.05,sprintf(\"%.3f\", data$pvalue),'&lt;0.001')#在data中添加需要绘制的文本\np1 = ggplot()+\n  geom_text(data,mapping = aes(x = 0, y = cell, color = pvalue_col, \n                               label = pvalue_text))+\n  scale_color_manual(name=\"\",values = c(\"red\", \"black\"))+\n  theme_void()+\n  theme(text = element_text(family = \"serif\"))+\n  guides(color=F) #去掉图例\n\np|p1\n\n\n\n\n\n\n\n图 2: 添加文本信息\n\n\n\n\n\n注：图题为基因名，纵轴为系报名，横轴为该基因的表达量，cor为基因表达量与细胞丰度的相关性，其中横轴为相关性，大小为相关性的绝对值，颜色为P值，右侧数字为P值。\n\n\n2. 添加图例\n\nstack_data = data.frame( x = c(\"legend\",\"legend\",\"legend\",\"legend\",\"legend\"),\n                         class = c(\"0-0.2\", \"0.2-0.4\", \"0.4-0.6\", \"0.6-0.8\",  \"0.8-1\"),\n                         color_range = c(0.2,0.2,0.2,0.2,0.2))\n\np2 &lt;- ggplot(stack_data, aes(x = x, y = color_range, fill = class)) +\n  geom_bar(stat = 'identity', position = \"stack\", width = 0.3) +\n  scale_fill_manual(name = \"P-value\",values = c(\"#146432\", \"#4DB748\", \"#FAA519\", \"#FABECD\", \"#FAD700\")) +  # 设置颜色\n  scale_y_continuous(breaks = seq(0, 1, by = 0.2), \n                     labels = c(\"0\",\"0.2\",\"0.4\",\"0.5\",\"0.8\",\"1.0\" ), \n                     sec.axis = sec_axis(~., breaks = seq(0, 1, by = 0.2), \n                                         labels = c(\"0\", \"0.2\", \"0.4\", \"0.6\", \"0.8\", \"1.0\"))) +  # 设置y轴刻度并将y轴移动到右侧\n  labs(title = \"pvalue\")+#图片标题\n  theme_minimal() +\n  theme(axis.text.x = element_blank(),  # 去掉x轴标签\n        axis.title.x = element_blank(),  # 去掉x轴标题\n        axis.text.y = element_blank(),  # 去掉y轴左侧标题\n        axis.title.y = element_blank(),  # 去掉y轴左侧标题\n        panel.grid = element_blank(),    # 去掉背景网格线\n        plot.margin = unit(c(0, 0, 0, 0), \"cm\"),  # 去掉图形的四周空白\n        axis.text.y.right = element_text(size = 12),  # 设置y轴右侧标签的字体大小\n        legend.position = \"none\", # 去掉图例\n        plot.title=element_text(size=10,  #标题大小\n                                hjust=0.5 ), #标题位置\n        text = element_text(family = \"serif\")) #设置字体为Times New Roman  \n\np|p1|p2\n\n\n\n\n\n\n\n图 3: 添加图例\n\n\n\n\n\n注：图题为基因名，纵轴为系报名，横轴为该基因的表达量，cor为基因表达量与细胞丰度的相关性，其中横轴为相关性，大小为相关性的绝对值，颜色为P值，右侧数字为P值。\n\n\n3. 美化拼图\n\nlayout &lt;- c(\n  area(t = 1, l = 1, b = 1, r = 2),\n  area(t = 1, l = 3, b = 1, r = 3),\n  area(t = 1, l = 4, b = 1, r = 4)\n)\n\np + p1 + p2 +\n  plot_layout(design = layout)\n\n\n\n\n\n\n\n图 4: 美化拼图\n\n\n\n\n\n如果有需要的话可以进一步使用Power point或者Adobe illustration进行美化。\n\n\n4. 富集分析绘图\n\n# 富集分析棒棒糖图\ndata_2 &lt;- data_2[,c(1,2,4,7)] #只留下绘图需要的信息\ncolnames(data_2) &lt;- c(\"GO_aspect\",\"GO_term\",\"P\",\"count\") #重命名列名\ndata_2 &lt;- data_2[data_2$GO_aspect!='KEGG',] #去除掉KEGG富集分析的数据\n\ndata_2$Padj &lt;- p.adjust(data_2$P, method = \"BH\")# 使用Benjamin-Hochberg方法计算Padj\ndata_2$log10Padj = -log10(data_2$Padj)#计算-log10Padj\n\ndata_2$GO_aspect[data_2$GO_aspect==\"GO:BP\"] =\"BP\"\ndata_2$GO_aspect[data_2$GO_aspect==\"GO:CC\"] =\"CC\"\ndata_2$GO_aspect[data_2$GO_aspect==\"GO:MF\"] =\"MF\"\n\n# 按GO_aspect分组，然后每组按log10Padj排序，并取前15条数据\ndata_2 &lt;- data_2 %&gt;%  group_by(GO_aspect) %&gt;%\n  arrange(GO_aspect, desc(log10Padj)) %&gt;%  # 按log10Padj降序排序\n  slice_head(n = 15)  # 取前15条\n\n\n#绘图\nggdotchart(data_2, x = \"GO_term\", y = \"log10Padj\",\n           color = \"GO_aspect\",                          # 按组显示颜色\n           palette = c(\"#090886\", \"#F90708\", \"#25821F\"), # 自定义调色板\n           sorting = \"descending\",                       # 按降序对值排序\n           add = \"segments\",                             # 添加从y=0到点的线段\n           group = \"GO_aspect\",                          # 按组排序\n           dot.size = 8,                                 # 点大小\n           label = round(data_2$count),                  # 将mpg值添加为点标签\n           font.label = list(color = \"white\", size = 9, \n                             vjust = 0.5),               # 调整标签参数\n           ggtheme = theme_pubr()                        # ggplot2主题\n)+labs(x=NULL,y=expression(-log[10](Padj)),\n        title=NULL)\n\n\n\n\n\n\n\n图 5: 富集分析棒棒糖图\n\n\n\n\n\n注：纵轴为-log10Padj，横轴为GO条目，颜色为GO类别，圆圈中数字为富集到各GO条目的基因个数。",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> 𝐂𝐋𝐈𝐍𝐈𝐂𝐒",
      "LollipopPlot"
    ]
  },
  {
    "objectID": "Clinics/LollipopPlot.html#应用场景",
    "href": "Clinics/LollipopPlot.html#应用场景",
    "title": "棒棒糖图",
    "section": "应用场景",
    "text": "应用场景\n\n1. 相关性分析\n\n\n\n\n\n\n图 6: 相关性分析\n\n\n\n棒棒糖图（原文图9A）的应用展示了COL17A1基因与免疫浸润相关性的结果。[1]\n\n\n2. 基因通路富集分析\n\n\n\n\n\n\n图 7: 基因通路富集分析\n\n\n\n棒棒糖图（原文图3）的应用展示了差异表达基因的GO富集分析结果。[2]",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> 𝐂𝐋𝐈𝐍𝐈𝐂𝐒",
      "LollipopPlot"
    ]
  },
  {
    "objectID": "Clinics/LollipopPlot.html#参考文献",
    "href": "Clinics/LollipopPlot.html#参考文献",
    "title": "棒棒糖图",
    "section": "参考文献",
    "text": "参考文献\n[1] Yang, M. Y., Ji, M. H., Shen, T., & Lei, L. (2022). Integrated Analysis Identifies Four Genes as Novel Diagnostic Biomarkers Which Correlate with Immune Infiltration in Preeclampsia. Journal of immunology research, 2022, 2373694. https://doi.org/10.1155/2022/2373694\n[2] Paukszto, L., Mikolajczyk, A., Jastrzebski, J. P., Majewska, M., Dobrzyn, K., Kiezun, M., Smolinska, N., & Kaminski, T. (2020). Transcriptome, Spliceosome and Editome Expression Patterns of the Porcine Endometrium in Response to a Single Subclinical Dose of Salmonella Enteritidis Lipopolysaccharide. International journal of molecular sciences, 21(12), 4217. https://doi.org/10.3390/ijms21124217",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> 𝐂𝐋𝐈𝐍𝐈𝐂𝐒",
      "LollipopPlot"
    ]
  },
  {
    "objectID": "Clinics/MetaForestPlot.html",
    "href": "Clinics/MetaForestPlot.html",
    "title": "元分析森林图",
    "section": "",
    "text": "森林图是 meta 分析中常用的图形表示，以可视化单个研究的结果。它显示观察到的效果大小，置信区间和每项研究的重量，从而可以清楚地比较整个研究的结果。",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> 𝐂𝐋𝐈𝐍𝐈𝐂𝐒",
      "MetaForestPlot"
    ]
  },
  {
    "objectID": "Clinics/MetaForestPlot.html#示例",
    "href": "Clinics/MetaForestPlot.html#示例",
    "title": "元分析森林图",
    "section": "",
    "text": "森林图是 meta 分析中常用的图形表示，以可视化单个研究的结果。它显示观察到的效果大小，置信区间和每项研究的重量，从而可以清楚地比较整个研究的结果。",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> 𝐂𝐋𝐈𝐍𝐈𝐂𝐒",
      "MetaForestPlot"
    ]
  },
  {
    "objectID": "Clinics/MetaForestPlot.html#环境配置",
    "href": "Clinics/MetaForestPlot.html#环境配置",
    "title": "元分析森林图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包： meta, metafor, ggplot2, dplyr, tidyr, grid, forestplot\n\n\n# 安装包\nif (!requireNamespace(\"meta\", quietly = TRUE)) {\n  install.packages(\"meta\")\n}\nif (!requireNamespace(\"metafor\", quietly = TRUE)) {\n  install.packages(\"metafor\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"tidyr\", quietly = TRUE)) {\n  install.packages(\"tidyr\")\n}\nif (!requireNamespace(\"grid\", quietly = TRUE)) {\n  install.packages(\"grid\")\n}\nif (!requireNamespace(\"forestplot\", quietly = TRUE)) {\n  install.packages(\"forestplot\")\n}\n\n# 加载包\nlibrary(meta)\nlibrary(metafor)\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(grid)\nlibrary(forestplot)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version    date (UTC) lib source\n abind      * 1.4-8      2024-09-12 [1] RSPM\n checkmate  * 2.3.3      2025-08-18 [1] RSPM\n dplyr      * 1.1.4      2023-11-17 [1] RSPM\n forestplot * 3.1.7      2025-06-12 [1] RSPM\n ggplot2    * 4.0.1      2025-11-14 [1] RSPM\n Matrix     * 1.7-4      2025-08-28 [3] CRAN (R 4.5.2)\n meta       * 8.2-1      2025-09-01 [1] RSPM\n metadat    * 1.4-0      2025-02-04 [1] RSPM\n metafor    * 4.8-0      2025-01-28 [1] RSPM\n numDeriv   * 2016.8-1.1 2019-06-06 [1] RSPM\n tidyr      * 1.3.2      2025-12-19 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> 𝐂𝐋𝐈𝐍𝐈𝐂𝐒",
      "MetaForestPlot"
    ]
  },
  {
    "objectID": "Clinics/MetaForestPlot.html#数据准备",
    "href": "Clinics/MetaForestPlot.html#数据准备",
    "title": "元分析森林图",
    "section": "数据准备",
    "text": "数据准备\n\n# 生成模拟数据\nset.seed(2023)\nn_studies &lt;- 15\nmeta_data &lt;- tibble(\n  `Study Name` = paste(\"Study\", LETTERS[1:n_studies]),\n  `Odds Ratio` = exp(rnorm(n_studies, mean = 0.2, sd = 0.4)),\n  `Lower 95% CI` = exp(rnorm(n_studies, mean = 0.1, sd = 0.35)),\n  `Upper 95% CI` = exp(rnorm(n_studies, mean = 0.3, sd = 0.45)),\n  `Weight (%)` = runif(n_studies, 0.5, 3),\n  `Treatment Group` = sample(c(\"DrugA\", \"DrugB\"), n_studies, replace = TRUE)\n) %&gt;% \n  mutate(\n    across(c(`Odds Ratio`, `Lower 95% CI`, `Upper 95% CI`), ~round(., 2)),\n    `Weight (%)` = round(`Weight (%)`/sum(`Weight (%)`)*100, 1),\n    `Study Name` = factor(`Study Name`, levels = rev(`Study Name`))\n  ) \n\n# 查看最终的合并数据集\nhead(meta_data)\n\n# A tibble: 6 × 6\n  `Study Name` `Odds Ratio` `Lower 95% CI` `Upper 95% CI` `Weight (%)`\n  &lt;fct&gt;               &lt;dbl&gt;          &lt;dbl&gt;          &lt;dbl&gt;        &lt;dbl&gt;\n1 Study A              1.18           1.41           1.19          7.5\n2 Study B              0.82           1.36           2.4           3.3\n3 Study C              0.58           1.29           0.94          9.3\n4 Study D              1.13           1.51           1.32          9.2\n5 Study E              0.95           1.35           1.01          8.3\n6 Study F              1.89           0.96           1.11          3.4\n# ℹ 1 more variable: `Treatment Group` &lt;chr&gt;",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> 𝐂𝐋𝐈𝐍𝐈𝐂𝐒",
      "MetaForestPlot"
    ]
  },
  {
    "objectID": "Clinics/MetaForestPlot.html#可视化",
    "href": "Clinics/MetaForestPlot.html#可视化",
    "title": "元分析森林图",
    "section": "可视化",
    "text": "可视化\n\n1. 基础绘图\n\n# 基础森林图\np &lt;-\n  ggplot(meta_data, aes(x = `Odds Ratio`, y = `Study Name`)) +\n  geom_vline(xintercept = 1, linetype = \"dashed\", color = \"grey50\") +\n  geom_errorbarh(aes(xmin = `Lower 95% CI`, xmax = `Upper 95% CI`), \n                 height = 0.15, color = \"#2c7fb8\", linewidth = 0.8) +\n  geom_point(aes(size = `Weight (%)`), shape = 18, color = \"#d95f00\") +\n  scale_x_continuous(trans = \"log\", \n                     breaks = c(0.25, 0.5, 1, 2, 4),\n                     limits = c(0.2, 5)) +\n  labs(x = \"Odds Ratio (95% CI)\", \n       y = \"\",\n       title = \"Meta-Analysis Forest Plot\",\n       subtitle = \"Random Effects Model\") +\n  theme_minimal(base_size = 12) +\n  theme(\n    panel.grid.major.y = element_blank(),\n    panel.grid.minor.x = element_blank(),\n    plot.title = element_text(face = \"bold\", hjust = 0.5),\n    plot.subtitle = element_text(hjust = 0.5, color = \"grey50\"),\n    legend.position = \"bottom\"\n  )\np\n\n\n\n\n\n\n\n图 1: 基础绘图\n\n\n\n\n\n\n# 数据准备 ---------------------------------------------------------------\ndataset &lt;- data.frame(\nStudy_Name = c(\"ART\",\"WBC\",\"CPR\",\"DTA\",\"EPC\",\"FFT\",\"GEO\",\"HBC\",\"PTT\",\"JOK\"),\nOdds_Ratio = c(0.9, 2, 0.3, 0.4, 0.5, 1.3, 2.5, 1.6, 1.9, 1.1),\nLower_95_CI = c(0.75, 1.79, 0.18, 0.2, 0.38, 1.15, 2.41, 1.41, 1.66, 0.97),\nUpper_95_CI = c(1.05, 2.21, 0.42, 0.6, 0.62, 1.45, 2.59, 1.79, 2.14, 1.23),\nEffect_Type = factor(c('Not sig.', 'Risk', 'Protective', 'Protective', 'Protective', \n                       'Risk', 'Risk', 'Risk', 'Risk', 'Not sig.'),\n                     levels = c(\"Risk\", \"Protective\", \"Not sig.\")),\nSample_Size = c(450, 420, 390, 400, 470, 390, 400, 388, 480, 460)\n) %&gt;%  \nmutate(\n  log_OR = log(Odds_Ratio),\n  log_Lower = log(Lower_95_CI),\n  log_Upper = log(Upper_95_CI),\n  Study_Name = factor(Study_Name, levels = rev(Study_Name)))\n\n\nx_limits &lt;- c(-3.9, 2)  # 数据坐标范围（左边界到log(5)≈1.6）\nget_npc &lt;- function(x) {\n(x - x_limits[1]) / diff(x_limits)  # 标准化坐标转换\n}\n\n\ncolumn_system &lt;- list(\nstudy = list(\n  data_x = -3.8, \n  npc_x = get_npc(-3.8),\n  label = \"Study\",\n  width = 1.2\n),\nevents = list(\n  data_x = -3.5,\n  npc_x = get_npc(-3.5),\n  label = \"Events\\n(Case/Control)\",\n  width = 1.8\n),\nor = list(\n  data_x = -3.1,\n  npc_x = get_npc(-3.1),\n  label = \"Odds Ratio\\n(95% CI)\",\n  width = 2.2\n),\np = list(\n  data_x = -2.7,\n  npc_x = get_npc(-2.7),\n  label = \"P Value\",\n  width = 1.2\n),\nsample = list(\n  data_x = -2.4,\n  npc_x = get_npc(-2.4),\n  label = \"Sample\\nSize\",\n  width = 1.2\n)\n)\n\n\nggplot(dataset, aes(y = Study_Name)) +\n\nannotation_custom(\n  grob = textGrob(\n    label = sapply(column_system, function(x) x$label),\n    x = unit(sapply(column_system, function(x) x$npc_x), \"npc\"),\n    y = unit(1.06, \"npc\"),\n    hjust = 0.5,\n    vjust = 0,\n    gp = gpar(\n      fontface = \"bold\", \n      fontsize = 12, \n      lineheight = 0.8,\n      col = \"black\"\n    )\n  )\n) +\n\n\n# 研究名称（右对齐）\ngeom_text(\n  aes(x = column_system$study$data_x, label = Study_Name),\n  size = 3.5, \n  hjust = 1,\n  nudge_x = -0.05  # 微调位置\n) +\n\n# 事件发生率（右对齐）\ngeom_text(\n  aes(x = column_system$events$data_x,\n      label = c(\"17/13\", \"23/18\", \"30/25\", \"10/8\", \"31/25\",\n                \"17/13\", \"23/18\", \"24/20\", \"17/12\", \"2.00/1.90\")),\n  size = 3.5, \n  hjust = 1\n) +\n\n# OR值（右对齐）\ngeom_text(\n  aes(x = column_system$or$data_x,\n      label = sprintf(\"%.2f (%.2f-%.2f)\", Odds_Ratio, Lower_95_CI, Upper_95_CI)),\n  size = 3.5,\n  hjust = 1\n) +\n\n# P值（右对齐）\ngeom_text(\n  aes(x = column_system$p$data_x,\n      label = c(\"&lt;0.001\", \"&lt;0.001\", \"0.075\", \"&lt;0.001\", \"&lt;0.001\",\n                \"&lt;0.001\", \"&lt;0.001\", \"&lt;0.001\", \"&lt;0.001\", \"0.650\")),\n  size = 3.5, \n  color = \"#d95f02\",\n  hjust = 1\n) +\n\n# 样本量（右对齐）\ngeom_text(\n  aes(x = column_system$sample$data_x, label = Sample_Size),\n  size = 3.5,\n  fontface = \"bold\",\n  hjust = 1\n) +\n\n\ngeom_vline(\n  xintercept = 0, \n  linetype = \"solid\", \n  color = \"black\", \n  linewidth = 0.8\n) +\ngeom_errorbarh(\n  aes(xmin = log_Lower, xmax = log_Upper),\n  height = 0.15, \n  color = \"grey40\", \n  linewidth = 0.8\n) +\ngeom_point(\n  aes(x = log_OR, size = Sample_Size, fill = Effect_Type),\n  shape = 21, \n  color = \"white\", \n  stroke = 1\n) +\n\n\nscale_x_continuous(\n  name = \"Odds Ratio (log scale)\",\n  breaks = log(c(0.25, 0.5, 1, 2, 4)),\n  labels = c(0.25, 0.5, 1, 2, 4),\n  limits = x_limits,\n  expand = expansion(add = c(0.1, 0.2))\n) +\nscale_size_continuous(\n  range = c(4, 10),\n  breaks = c(300, 400, 500),\n  guide = guide_legend(\n    title.position = \"top\",\n    title = \"Sample Size\",\n    nrow = 1,\n    override.aes = list(shape = 21, fill = \"grey50\")\n  )\n) +\nscale_fill_manual(\n  values = c(\n    Risk = \"#d95f02\", \n    Protective = \"#1b9e77\", \n    \"Not sig.\" = \"#7570b3\"\n  ),\n  guide = guide_legend(\n    title = NULL,\n    nrow = 1,\n    override.aes = list(size = 5)\n  )\n) +\n\n\nlabs(title = \"Multivariable Analysis of Clinical Factors\") +\ntheme_minimal(base_size = 12) +\ntheme(\n  panel.grid.major.y = element_blank(),\n  panel.grid.minor.y = element_blank(),\n  axis.title.y = element_blank(),\n  axis.text.y = element_blank(),\n  axis.ticks.y = element_blank(),\n  axis.title.x = element_text(\n    color = \"grey30\",\n    margin = margin(t = 10)\n  ),\n  axis.text.x = element_text(color = \"grey30\"),\n  plot.title = element_text(\n    hjust = 0.5, \n    face = \"bold\", \n    size = 16, \n    margin = margin(b = 20)\n  ),\n  legend.position = \"bottom\",\n  legend.box = \"horizontal\",\n  legend.spacing.x = unit(0.8, \"cm\"),\n  legend.title = element_text(size = 11),\n  legend.text = element_text(size = 10),\n  plot.margin = margin(t = 80, b = 20, l = 30, r = 30),\n  plot.background = element_rect(\n    fill = \"#f0f8ff\", \n    color = NA,\n    linewidth = 0.5\n  )\n) +\ncoord_cartesian(clip = \"off\")\n\n\n\n\n\n\n\n图 2: 基础绘图\n\n\n\n\n\n\n\n2. 现有R包作图\n\n# 森林图\ntest_data &lt;- data.frame(id = 1:4,\n                        coef1 = c(1, 1.59, 1.3, 1.24),\n                        coef2 = c(1, 1.7, 1.4, 1.04),\n                        low1 = c(1, 1.3, 1.1, 0.99),\n                        low2 = c(1, 1.6, 1.2, 0.7),\n                        high1 = c(1, 1.94, 1.6, 1.55),\n                        high2 = c(1, 1.8, 1.55, 1.33))\n\n# Convert into dplyr formatted data\nout_data &lt;- test_data |&gt;\n  pivot_longer(cols = everything() & -id) |&gt;\n  mutate(group = gsub(\"(.+)([12])$\", \"\\\\2\", name),\n         name = gsub(\"(.+)([12])$\", \"\\\\1\", name)) |&gt;\n  pivot_wider() |&gt;\n  group_by(id) |&gt;\n  mutate(col1 = lapply(id, \\(x) ifelse(x &lt; 4,\n                                       paste(\"Category\", id),\n                                       expression(Category &gt;= 4))),\n         col2 = lapply(1:n(), \\(i) substitute(expression(bar(x) == val),\n                                              list(val = mean(coef) |&gt; round(2)))),\n         col2 = if_else(id == 1,\n                        rep(\"ref\", n()) |&gt; as.list(),\n                        col2)) |&gt;\n  group_by(group)\n\nout_data |&gt;\n  forestplot(mean = coef,\n             lower = low,\n             upper = high,\n             labeltext = c(col1, col2),\n             title = \"Cool study\",\n             zero = c(0.98, 1.02),\n             grid = structure(c(2^-.5, 2^.5),\n                              gp = gpar(col = \"steelblue\", lty = 2)\n             ),\n             boxsize = 0.25,\n             xlab = \"The estimates\",\n             new_page = TRUE,\n             legend = c(\"Treatment\", \"Placebo\"),\n             legend_args = fpLegend(\n               pos = list(\"topright\"),\n               title = \"Group\",\n               r = unit(.1, \"snpc\"),\n               gp = gpar(col = \"#CCCCCC\", lwd = 1.5)\n             )) |&gt;\n  fp_set_style(box = c(\"royalblue\", \"gold\"),\n               line = c(\"darkblue\", \"orange\"),\n               summary = c(\"darkblue\", \"red\"))\n\n\n\n\n\n\n\n图 3: 现有R包作图",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> 𝐂𝐋𝐈𝐍𝐈𝐂𝐒",
      "MetaForestPlot"
    ]
  },
  {
    "objectID": "Clinics/MetaForestPlot.html#应用场景",
    "href": "Clinics/MetaForestPlot.html#应用场景",
    "title": "元分析森林图",
    "section": "应用场景",
    "text": "应用场景\n\n1. Meta分析结果可视化\n\n\n\n\n\n\n图 4: 元分析森林图应用1\n\n\n\n森林图（forest plot），从定义上讲，它一般是在平面直角坐标系中，以一条垂直于X轴的无效线（通常坐标X=1或0）为中心，用若干条平行于X轴的线段，来表示每个研究的效应量大小及其95%可信区间，并用一个棱形来表示多个研究合并的效应量及可信区间，它是Meta分析中最常用的结果综合表达形式。\n\n\n2. 多因素回归分析结果展示\n\n\n\n\n\n\n图 5: 元分析森林图应用2\n\n\n\n森林图是一种非常灵活的可视化工具，不仅可以用于展示Meta分析的结果，还可以用于展示单因素或多因素回归分析的结果。\n\n\n3. 基因关联研究可视化\n\n\n\n\n\n\n图 6: 元分析森林图应用3\n\n\n\nTwoSampleMR包做出来的森林图。",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> 𝐂𝐋𝐈𝐍𝐈𝐂𝐒",
      "MetaForestPlot"
    ]
  },
  {
    "objectID": "Clinics/MetaForestPlot.html#参考文献",
    "href": "Clinics/MetaForestPlot.html#参考文献",
    "title": "元分析森林图",
    "section": "参考文献",
    "text": "参考文献\n[1] Lewis, S., & Clarke, M. (2001). Forest Plots: Trying to See the Wood and the Trees. BMJ, 322(7300), 1479–1480.DOI: 10.1136/bmj.322.7300.1479.\n[2] Higgins, J. P. T., Thomas, J., Chandler, J., et al. (2022). Cochrane Handbook for Systematic Reviews of Interventions (Version 6.3).\n[3] Gordon, M., & Lumley, T. (2023). forestplot: Advanced Forest Plot Using ‘grid’ Graphics (R package version 3.1.1).\n[4] Moher, D., Hopewell, S., Schulz, K. F., et al. (2010). CONSORT 2010 Statement: Updated Guidelines for Reporting Parallel Group Randomized Trials. Annals of Internal Medicine, 152(11), 726–732.DOI: 10.7326/0003-4819-152-11-201006010-00232.\n[5] Murrell, P. (2018). R Graphics (3rd ed.). Chapman & Hall/CRC.ISBN: 978-1439888417",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> 𝐂𝐋𝐈𝐍𝐈𝐂𝐒",
      "MetaForestPlot"
    ]
  },
  {
    "objectID": "Omics/ChromosomePlot.html",
    "href": "Omics/ChromosomePlot.html",
    "title": "染色体图",
    "section": "",
    "text": "染色体图（Ideogram）是一种用于可视化染色体结构和染色体上各类基因组特征的图形工具。它通常以每条染色体为单位，按比例绘制出染色体的长度和着丝粒等结构，并可在染色体上标注基因密度、遗传变异、表达水平、重复序列、功能标记等多种信息。\n染色体图的形态可以是直线型或环状型（如Circos图）。其中，直线型染色体图更适合展示染色体的线性结构与局部数据变化，特别适用于基因组扫描、群体比较、遗传图谱等研究。而其可视化效果不仅便于直观理解染色体上数据的分布，还可以叠加多层信息如热图、标记符号、折线、色块等。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "ChromosomePlot"
    ]
  },
  {
    "objectID": "Omics/ChromosomePlot.html#示例",
    "href": "Omics/ChromosomePlot.html#示例",
    "title": "染色体图",
    "section": "示例",
    "text": "示例\n\n\n\n\n\n图片利用 RIdeogram 包内置拟南芥属物种（Liriodendron）数据绘制的带有双折线标签的染色体图。每条染色体以比例绘制，中心的颜色表示基因组热图数据（此处为 Fst 值，反映群体分化程度），两侧的上下折线分别代表两个群体（CE 和 CW）在不同染色体区域上的 Pi 值（核苷酸多态性）。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "ChromosomePlot"
    ]
  },
  {
    "objectID": "Omics/ChromosomePlot.html#环境配置",
    "href": "Omics/ChromosomePlot.html#环境配置",
    "title": "染色体图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: 跨平台（Linux/MacOS/Windows）\n编程语言: R\n依赖包: RIdeogram\n\n\n# 安装包\nif (!requireNamespace(\"RIdeogram\", quietly = TRUE)) {\n  install.packages(\"RIdeogram\")\n}\n\n# 加载包\nlibrary(RIdeogram)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package   * version date (UTC) lib source\n RIdeogram * 0.2.2   2020-01-20 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "ChromosomePlot"
    ]
  },
  {
    "objectID": "Omics/ChromosomePlot.html#数据准备",
    "href": "Omics/ChromosomePlot.html#数据准备",
    "title": "染色体图",
    "section": "数据准备",
    "text": "数据准备\n使用RIDeogram包的内置数据。\n\ndata(human_karyotype, package=\"RIdeogram\")\ndata(gene_density, package=\"RIdeogram\")\ndata(Random_RNAs_500, package=\"RIdeogram\")\n\n可以通过 head() 函数查看各数据的基本格式：\n\nhead(human_karyotype)\n\n  Chr Start       End  CE_start    CE_end\n1   1     0 248956422 122026459 124932724\n2   2     0 242193529  92188145  94090557\n3   3     0 198295559  90772458  93655574\n4   4     0 190214555  49712061  51743951\n5   5     0 181538259  46485900  50059807\n6   6     0 170805979  58553888  59829934\n\n\nhuman_karyotype核型数据包含五列，第1列是染色体ID，第2列和第3列是染色体起始和终止位置，第4列和第5列是着丝粒的起始和终止位置。注：若无着丝粒信息，仅保留前三列即可。\n\nhead(gene_density)\n\n  Chr   Start     End Value\n1   1       1 1000000    65\n2   1 1000001 2000000    76\n3   1 2000001 3000000    35\n4   1 3000001 4000000    30\n5   1 4000001 5000000    10\n6   1 5000001 6000000    10\n\n\ngene_density数据用于绘制热图，包含染色体ID、起始和终止位置，第4列是数值（如基因数目、SNP密度等），用于染色体上的热度映射。\n\nhead(Random_RNAs_500)\n\n   Type    Shape Chr    Start      End  color\n1  tRNA   circle   6 69204486 69204568 6a3d9a\n2  rRNA      box   3 68882967 68883091 33a02c\n3  rRNA      box   5 55777469 55777587 33a02c\n4  rRNA      box  21 25202207 25202315 33a02c\n5 miRNA triangle   1 86357632 86357687 ff7f00\n6 miRNA triangle  11 74399237 74399333 ff7f00\n\n\nRandom_RNAs_500数据为标签信息（track），共六列包含：标签类型（如tRNA, rRNA, miRNA等），形状（可选：circle、box 或 triangle），染色体、起始、终止位置，标签颜色。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "ChromosomePlot"
    ]
  },
  {
    "objectID": "Omics/ChromosomePlot.html#可视化",
    "href": "Omics/ChromosomePlot.html#可视化",
    "title": "染色体图",
    "section": "可视化",
    "text": "可视化\n\n1. 基础染色体图\n运行后可以在工作目录中找到一个 SVG 文件和一个 PNG 文件。\n\n# 基础染色体图\nideogram(karyotype = human_karyotype)\nconvertSVG(\"chromosome.svg\", device = \"png\")\n\n\n\n\n\n\n\n图 1: 基础染色体图\n\n\n\n\n\n2. 包含热图的染色体图\n使用overlaid参数将全基因组数据映射到染色体图谱上，将整个人类基因组的基因密度可视化。\n\n# 包含热图的染色体图\nideogram(karyotype = human_karyotype, overlaid = gene_density)\nconvertSVG(\"chromosome.svg\", device = \"png\")\n\n\n\n\n\n\n\n图 2: 包含热图的染色体图\n\n\n\n\n\n3. 轨迹标签\n将一些全基因组范围的数据以轨道的形式映射在染色体图的侧边。\n\n# 轨迹标签\nideogram(karyotype = human_karyotype, label = Random_RNAs_500, label_type = \"marker\")\nconvertSVG(\"chromosome.svg\", device = \"png\")\n\n\n\n\n\n\n\n图 3: 轨迹标签\n\n\n\n\n\n4. 同时绘制热图与轨迹标签\n同时映射叠加的热图和染色体表象上的轨道标签。\n\n# 同时绘制热图与轨迹标签\nideogram(karyotype = human_karyotype, overlaid = gene_density, label = Random_RNAs_500, label_type = \"marker\")\nconvertSVG(\"chromosome.svg\", device = \"png\")\n\n\n\n\n\n\n\n图 4: 同时绘制热图与轨迹标签\n\n\n\n\n\n5. 自定义热图颜色\n如果要更改热图的颜色，可以修改参数 colorset1（默认值为 colorset1 = c(\"#4575b4\", \"#ffffbf\", \"#d73027\")）。修改颜色可以使用内置的颜色名称，也可以使用 colors()，或采用 \"#rrggbb\" 或 \"#rrggbbaa\" 格式的十六进制颜色代码。\n\n# 自定义热图颜色\nideogram(karyotype = human_karyotype, overlaid = gene_density, label = Random_RNAs_500, label_type = \"marker\", colorset1 = c(\"#fc8d59\", \"#ffffbf\", \"#91bfdb\"))\nconvertSVG(\"chromosome.svg\", device = \"png\")\n\n\n\n\n\n\n\n图 5: 自定义热图颜色\n\n\n\n\n\n6. 不含着丝粒信息的染色体图\n如果研究的物种没有明确的着丝粒位置信息，也可以绘制染色体图。在这种情况下，karyotype（核型）文件中只需包含三列：染色体编号、起始位置和终止位置，而不需要第四、第五列的着丝粒起止坐标。\n为了模拟这种情况，可以将 RIdeogram 自带的 human_karyotype 数据框中的后两列删除：\n\n# 不含着丝粒信息的染色体图\nhuman_karyotype &lt;- human_karyotype[,1:3]\nideogram(karyotype = human_karyotype, overlaid = gene_density, label = Random_RNAs_500, label_type = \"marker\")\nconvertSVG(\"chromosome.svg\", device = \"png\")\n\n\n\n\n\n\n\n图 6: 不含着丝粒信息的染色体图\n\n\n\n即使缺少着丝粒信息，RIdeogram 仍然可以绘图，只是图中不会标出着丝粒区域。\n\n\n7. 仅使用部分染色体时的宽度设置\n在一些情况下，例如只分析物种的部分染色体（如前10条），默认的图宽可能会显得过于分散或留白较多。此时建议通过调整 width 参数来优化图像布局。\n为模拟这种情况，可以从 human_karyotype 数据中保留前10条染色体，并比较在默认宽度和调整后的宽度下绘图的效果：\n修改前：\n\n# 修改前\nhuman_karyotype &lt;- human_karyotype[1:10,]\nideogram(karyotype = human_karyotype, overlaid = gene_density, label = Random_RNAs_500, label_type = \"marker\")\nconvertSVG(\"chromosome.svg\", device = \"png\")\n\n\n\n\n\n\n\n图 7: 修改前\n\n\n\n修改后：\n\n# 修改后\nhuman_karyotype &lt;- human_karyotype[1:10,]\nideogram(karyotype = human_karyotype, overlaid = gene_density, label = Random_RNAs_500, label_type = \"marker\", width = 100)\nconvertSVG(\"chromosome.svg\", device = \"png\")\n\n\n\n\n\n\n\n图 8: 修改后\n\n\n\n\n\n8. 调整图例位置\n如果希望移动图例的位置，可以通过修改参数 Lx 和 Ly 来实现。这两个参数分别控制图例左上角相对于图像边缘的位置，默认值分别为 Lx = 160 和 Ly = 35。\n\nLx：图例左上角距离图像左边的距离。\nLy：图例左上角距离图像上边的距离。\n\n通过调整这两个参数，可以避免图例与图像主体重叠，或根据排版需求将其放置在更合适的位置。\n\n# 调整图例位置\nideogram(karyotype = human_karyotype, overlaid = gene_density, label = Random_RNAs_500, label_type = \"marker\", width = 100, Lx = 80, Ly = 25)\nconvertSVG(\"chromosome.svg\", device = \"png\")\n\n\n\n\n\n\n\n图 9: 调整图例位置\n\n\n\n\n\n9. 不同标签类型\nRIdeogram 支持多种标签类型，可以根据可视化需求选择不同的方式展示数据。目前支持的标签类型包括：\n\n\"marker\"（标记点）\n\"heatmap\"（热图）\n\"line\"（折线）\n\"polygon\"（多边形）\n\n\n9.1 热图标签\n\n# 热图标签\ndata(human_karyotype, package=\"RIdeogram\")\nideogram(karyotype = human_karyotype, overlaid = gene_density, label = LTR_density, label_type = \"heatmap\", colorset1 = c(\"#f7f7f7\", \"#e34a33\"), colorset2 = c(\"#f7f7f7\", \"#2c7fb8\"))\nconvertSVG(\"chromosome.svg\", device = \"png\")\n\n\n\n\n\n\n\n图 10: 热图标签\n\n\n\n该图使用RIdeogram内置的人类染色体数据，展示了两个特征（基因密度和LTR元件密度）在染色体上的分布情况。不同颜色深浅表示不同数值区间，有助于观察基因组中各区域的密度差异。\n\n\n9.2 单条折线标签\n\n# 单条折线标签\ndata(liriodendron_karyotype, package=\"RIdeogram\")\ndata(Fst_between_CE_and_CW, package=\"RIdeogram\")\ndata(Pi_for_CE, package=\"RIdeogram\")\nideogram(karyotype = liriodendron_karyotype, overlaid = Fst_between_CE_and_CW, label = Pi_for_CE, label_type = \"line\", colorset1 = c(\"#e5f5f9\", \"#99d8c9\", \"#2ca25f\"))\nconvertSVG(\"chromosome.svg\", device = \"png\")\n\n\n\n\n\n\n\n图 11: 单条折线标签\n\n\n\n该图展示了单个指标（Pi值）在染色体上的连续变化趋势，通过折线的起伏可直观反映基因多样性在不同区段的分布模式。\n\n\n9.3 双条折线标签\n\n# 双条折线标签\ndata(liriodendron_karyotype, package=\"RIdeogram\")\ndata(Fst_between_CE_and_CW, package=\"RIdeogram\")\ndata(Pi_for_CE_and_CW, package=\"RIdeogram\")\nideogram(karyotype = liriodendron_karyotype, overlaid = Fst_between_CE_and_CW, label = Pi_for_CE_and_CW, label_type = \"line\", colorset1 = c(\"#e5f5f9\", \"#99d8c9\", \"#2ca25f\"))\nconvertSVG(\"chromosome.svg\", device = \"png\")\n\n\n\n\n\n\n\n图 12: 双条折线标签\n\n\n\n该图展示了两个群体（CE和CW）在染色体上的Pi值对比，双线并列描绘有助于发现两者在某些染色体区段上的多样性差异。\n\n\n9.4 单个多边形标签\n\n# 单个多边形标签\ndata(liriodendron_karyotype, package=\"RIdeogram\")\ndata(Fst_between_CE_and_CW, package=\"RIdeogram\")\ndata(Pi_for_CE, package=\"RIdeogram\")\nideogram(karyotype = liriodendron_karyotype, overlaid = Fst_between_CE_and_CW, label = Pi_for_CE, label_type = \"polygon\", colorset1 = c(\"#e5f5f9\", \"#99d8c9\", \"#2ca25f\"))\nconvertSVG(\"chromosome.svg\", device = \"png\")\n\n\n\n\n\n\n\n图 13: 单个多边形标签\n\n\n\n该图以多边形形式展示单一指标的变异情况，面积的变化更显著地体现了值的大小，适合用于强调局部显著区域。\n\n\n9.5 双多边形标签\n\n# 双多边形标签\ndata(liriodendron_karyotype, package=\"RIdeogram\") \ndata(Fst_between_CE_and_CW, package=\"RIdeogram\") \ndata(Pi_for_CE_and_CW, package=\"RIdeogram\") \nideogram(karyotype = liriodendron_karyotype, overlaid = Fst_between_CE_and_CW, label = Pi_for_CE_and_CW, label_type = \"polygon\", colorset1 = c(\"#e5f5f9\", \"#99d8c9\", \"#2ca25f\"))\nconvertSVG(\"chromosome.svg\", device = \"png\")\n\n\n\n\n\n\n\n图 14: 双多边形标签\n\n\n\n第二个多边形标签会自动横向错开 0.2 染色体宽度，以提升可读性。该图通过两组多边形同时展示两个群体在染色体上的指标差异，重叠区域或间距能够直观比较各区段的数值分布和趋势。\n\n\n\n10. 输出不同格式图像文件\n除了 png 格式外，也可以用device参数生成其他格式：\n\nconvertSVG(\"chromosome.svg\", device = \"tiff\", dpi = 600)\n\n不用device，将 SVG 图像转换为其他格式的快捷函数有：\n\nsvg2png(\"chromosome.svg\")\nsvg2pdf(\"chromosome.svg\")\nsvg2jpg(\"chromosome.svg\")\nsvg2tiff(\"chromosome.svg\")",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "ChromosomePlot"
    ]
  },
  {
    "objectID": "Omics/ChromosomePlot.html#应用",
    "href": "Omics/ChromosomePlot.html#应用",
    "title": "染色体图",
    "section": "应用",
    "text": "应用\n\n\n\n\n\n\n图 15: iMapper 映射和分析插入位点序列数据\n\n\n\n\n\n\n\n\n\n图 16: 由 IsoPlotter 推断并映射到染色体上的组合结构域示意图",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "ChromosomePlot"
    ]
  },
  {
    "objectID": "Omics/ChromosomePlot.html#参考资料",
    "href": "Omics/ChromosomePlot.html#参考资料",
    "title": "染色体图",
    "section": "参考资料",
    "text": "参考资料\n[1] RIdeogram: drawing SVG graphics to visualize and map genome-wide data on idiograms https://cran.r-project.org/web/packages/RIdeogram/vignettes/RIdeogram.html [2] Hao Z, Lv D, Ge Y, Shi J, Weijers D, Yu G, Chen J. 2020. RIdeogram: drawing SVG graphics to visualize and map genome-wide data on the idiograms. PeerJ Comput. Sci. 6:e251 http://doi.org/10.7717/peerj-cs.251",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "ChromosomePlot"
    ]
  },
  {
    "objectID": "Omics/PopulationMapPlot.html",
    "href": "Omics/PopulationMapPlot.html",
    "title": "人口图",
    "section": "",
    "text": "展示疾病发病率的地理分布，颜色深浅表示发病率高低，地图边界表示行政区划。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "PopulationMapPlot"
    ]
  },
  {
    "objectID": "Omics/PopulationMapPlot.html#示例",
    "href": "Omics/PopulationMapPlot.html#示例",
    "title": "人口图",
    "section": "",
    "text": "展示疾病发病率的地理分布，颜色深浅表示发病率高低，地图边界表示行政区划。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "PopulationMapPlot"
    ]
  },
  {
    "objectID": "Omics/PopulationMapPlot.html#环境配置",
    "href": "Omics/PopulationMapPlot.html#环境配置",
    "title": "人口图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: 跨平台（Linux/MacOS/Windows）\n编程语言: R\n依赖包: sf; rnaturalearth; rnaturalearthdata; gstat; dplyr; ggplot2; ggspatial; ggnewscale; ggrepel; ggfx; doParallel; viridis\n\n\n# 安装包\nif (!requireNamespace(\"sf\", quietly = TRUE)) {\n  install.packages(\"sf\")\n}\nif (!requireNamespace(\"rnaturalearth\", quietly = TRUE)) {\n  install.packages(\"rnaturalearth\")\n}\nif (!requireNamespace(\"rnaturalearthdata\", quietly = TRUE)) {\n  install.packages(\"rnaturalearthdata\")\n}\nif (!requireNamespace(\"gstat\", quietly = TRUE)) {\n  install.packages(\"gstat\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"ggspatial\", quietly = TRUE)) {\n  install.packages(\"ggspatial\")\n}\nif (!requireNamespace(\"ggnewscale\", quietly = TRUE)) {\n  install.packages(\"ggnewscale\")\n}\nif (!requireNamespace(\"ggrepel\", quietly = TRUE)) {\n  install.packages(\"ggrepel\")\n}\nif (!requireNamespace(\"ggfx\", quietly = TRUE)) {\n  install.packages(\"ggfx\")\n}\nif (!requireNamespace(\"doParallel\", quietly = TRUE)) {\n  install.packages(\"doParallel\")\n}\nif (!requireNamespace(\"viridis\", quietly = TRUE)) {\n  install.packages(\"viridis\")\n}\n\n# 加载包\nlibrary(sf)\nlibrary(rnaturalearth)\nlibrary(rnaturalearthdata)\nlibrary(gstat) \nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(ggspatial) \nlibrary(ggnewscale)\nlibrary(ggrepel)\nlibrary(ggfx)\nlibrary(doParallel)\nlibrary(viridis)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package           * version date (UTC) lib source\n doParallel        * 1.0.17  2022-02-07 [1] RSPM\n dplyr             * 1.1.4   2023-11-17 [1] RSPM\n foreach           * 1.5.2   2022-02-02 [1] RSPM\n ggfx              * 1.0.3   2025-09-03 [1] RSPM\n ggnewscale        * 0.5.2   2025-06-20 [1] RSPM\n ggplot2           * 4.0.1   2025-11-14 [1] RSPM\n ggrepel           * 0.9.6   2024-09-07 [1] RSPM\n ggspatial         * 1.1.10  2025-08-24 [1] RSPM\n gstat             * 2.1-4   2025-07-10 [1] RSPM\n iterators         * 1.0.14  2022-02-05 [1] RSPM\n rnaturalearth     * 1.1.0   2025-07-28 [1] RSPM\n rnaturalearthdata * 1.0.0   2024-02-09 [1] RSPM\n sf                * 1.0-23  2025-11-28 [1] RSPM\n viridis           * 0.6.5   2024-01-29 [1] RSPM\n viridisLite       * 0.4.2   2023-05-02 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "PopulationMapPlot"
    ]
  },
  {
    "objectID": "Omics/PopulationMapPlot.html#数据准备",
    "href": "Omics/PopulationMapPlot.html#数据准备",
    "title": "人口图",
    "section": "数据准备",
    "text": "数据准备\n\n# 全球地理数据\nworld &lt;- ne_countries(scale = \"medium\", returnclass = \"sf\")\n# 模拟流行病学数据\nset.seed(123)\nworld$incidence &lt;- runif(nrow(world), 0, 100)  # 随机生成发病率数据",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "PopulationMapPlot"
    ]
  },
  {
    "objectID": "Omics/PopulationMapPlot.html#可视化",
    "href": "Omics/PopulationMapPlot.html#可视化",
    "title": "人口图",
    "section": "可视化",
    "text": "可视化\n\n1. 基础绘图\n\n# 全球疾病发病率分布基础地图\np1 &lt;- ggplot(data = world) +\n  geom_sf(aes(fill = incidence)) +\n  scale_fill_viridis(option = \"C\") +\n  labs(title = \"Global Disease Incidence\",\n       fill = \"Incidence Rate\\n(per 100k)\")\n\np1\n\n\n\n\n\n\n\n图 1: 全球疾病发病率分布基础地图\n\n\n\n\n\n\n\n\n\n\n\n提示\n\n\n\n关键参数解析: binwidth / bins aes(fill): 定义颜色映射的流行病学指标\nscale_fill_viridis(): 使用无障碍颜色梯度\nne_countries(): 控制地图详细程度的scale参数（small/medium/large）\n\n\n\n# 定制化流行病学地图\np2 &lt;- ggplot(data = world) +\n  geom_sf(aes(fill = incidence), color = \"white\", size = 0.2) +\n  scale_fill_gradientn(colors = c(\"#2c7bb6\", \"#abd9e9\", \"#ffffbf\", \"#fdae61\", \"#d7191c\"),\n                       breaks = c(20, 40, 60, 80)) +\n  # 比例尺\n  annotation_scale(\n    location = \"bl\",\n    plot_unit = \"km\",\n    style = \"ticks\",\n    width_hint = 0.1\n  ) +\n  # 指北针（修复后）\n  annotation_north_arrow(\n    location = \"tr\",\n    which_north = \"grid\",  # 使用网格北\n    style = north_arrow_minimal(\n      line_width = 1,\n      text_size = 10\n    ),\n    pad_x = unit(1.2, \"cm\"),\n    pad_y = unit(1.2, \"cm\")\n  ) +\n  coord_sf(crs =  \"+proj=robin\",\n           xlim = c(-1.6e7, 1.6e7),\n           ylim = c(-7.5e6, 8.5e6),\n           expand = FALSE) +  # 使用罗宾森投影\n  theme_void() +\n  guides(fill = guide_colorbar(barwidth = 1)) +\n  labs(fill = \"Incidence Rate\")+ \n  theme(\n    legend.position = c(0.1, 0.3)  # 相对位置坐标（左下角为0,0）\n  )\n\np2\n\n\n\n\n\n\n\n图 2: 定制化流行病学地图\n\n\n\n\n\n\n\n2. 进阶绘图\n\n# 进阶绘图\n#进一步处理数据，利用空间点，来推断附近面的情况\n#减少计算时间，以下点较少，推算距离越近，分辨率提高，更准确\n# 并行初始化\nregisterDoParallel(cores = 4)\n\n# 数据准备\nworld_proj &lt;- st_transform(world, \"+proj=eqc +units=m\")\ncentroids &lt;- st_centroid(world_proj) %&gt;% \n  dplyr::select(incidence)\n\n# 创建低分辨率网格（100x100）\ngrid &lt;- st_make_grid(world_proj, n = c(100,100)) %&gt;% \n  st_as_sf() %&gt;%\n  st_join(world_proj, join = st_intersects)\n\n# 变异函数模型优化\nvariogram_model &lt;- vgm(\n  psill = 30,\n  model = \"Exp\",  # 改用指数模型\n  range = 2e6,    # 2000公里相关范围\n  nugget = 5\n)\n\n# 分块并行计算\ngrid_chunks &lt;- split(grid, cut(st_coordinates(st_centroid(grid))[,1], 4))\n\nkrige_result &lt;- foreach(i=1:4, .combine=rbind) %dopar% {\n  krige(incidence ~ 1,\n        locations = centroids,\n        newdata = grid_chunks[[i]],\n        model = variogram_model,\n        nmax = 30)\n} %&gt;% st_as_sf()\n\n# 转换回WGS84坐标系\nkrige_result &lt;- st_transform(krige_result, 4326)\n\n\nadvanced_map &lt;- ggplot() +\n  # 空间插值表面\n  geom_sf(data = krige_result, \n          aes(fill = var1.pred, color = var1.pred),\n          alpha = 0.6) +\n  scale_fill_gradientn(\n    colors = c(\"#2c7bb6\", \"#abd9e9\", \"#ffffbf\", \"#fdae61\", \"#d7191c\"),\n    name = \"Interpolated\\nIncidence\"\n  ) +\n  scale_color_gradientn(\n    colors = c(\"#2c7bb6\", \"#abd9e9\", \"#ffffbf\", \"#fdae61\", \"#d7191c\"),\n    guide = \"none\"\n  ) +\n  ggnewscale::new_scale_fill() +\n  \n  # 原始国家边界\n  geom_sf(data = world, \n          aes(fill = incidence),\n          color = \"white\", \n          size = 0.1,\n          alpha = 0.5) +\n  scale_fill_gradientn(\n    colors = c(\"#2c7bb6\", \"#abd9e9\", \"#ffffbf\", \"#fdae61\", \"#d7191c\"),\n    name = \"Country\\nIncidence\",\n    breaks = seq(0, 100, 20)\n  ) +\n  \n  # 3D浮雕效果\n  ggfx::with_shadow(\n    geom_sf(data = world,\n            aes(geometry = geometry),\n            color = \"grey30\",\n            fill = NA,\n            size = 0.2),\n    sigma = 5,\n    x_offset = 3,\n    y_offset = 3\n  ) +\n  \n  # 热点标注\n  geom_sf(data = world %&gt;% filter(incidence &gt; quantile(incidence, 0.9)),\n          color = \"red\",\n          fill = NA,\n          size = 0.5) +\n  ggrepel::geom_label_repel(\n    data = world %&gt;% filter(incidence &gt; quantile(incidence, 0.9)),\n    aes(label = name, geometry = geometry),\n    stat = \"sf_coordinates\",\n    size = 2.5,\n    box.padding = 0.2,\n    min.segment.length = 0,\n    fill = alpha(\"white\", 0.8)\n  ) +\n  \n  # 地图元素\n  annotation_north_arrow(\n    location = \"tr\",\n    width = unit(1.2, \"cm\"),   # 新增宽度参数\n    height = unit(1.2, \"cm\"),  # 新增高度参数\n    style = north_arrow_minimal()  # 移除尺寸参数\n  ) +\n  \n  # 坐标投影\n  coord_sf(crs = \"+proj=robin\") +\n  \n  # 主题设置\n  theme_void() +\n  theme(\n    legend.position = c(0.12, 0.3),\n    legend.background = element_rect(fill = alpha(\"white\", 0.8), color = NA),\n    plot.title = element_text(hjust = 0.5, face = \"bold\", size = 16),\n    panel.background = element_rect(fill = \"#F0F8FF\")\n  ) +\n  labs(title = \"Advanced Spatial Distribution of Disease Incidence\")\n\nadvanced_map\n\n\n\n\n\n\n\n图 3: 进阶绘图\n\n\n\n如果你有需要的话可以选择使用callout-tip添加对参数的详细描述。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "PopulationMapPlot"
    ]
  },
  {
    "objectID": "Omics/PopulationMapPlot.html#应用",
    "href": "Omics/PopulationMapPlot.html#应用",
    "title": "人口图",
    "section": "应用",
    "text": "应用\n\n\n\n\n\n\n人口图应用\n\n该图显示了全球各国常见肿瘤的差异。 [1]",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "PopulationMapPlot"
    ]
  },
  {
    "objectID": "Omics/PopulationMapPlot.html#参考资料",
    "href": "Omics/PopulationMapPlot.html#参考资料",
    "title": "人口图",
    "section": "参考资料",
    "text": "参考资料\n[1] Global Burden of Disease 2019 Cancer Collaboration; Kocarnik JM, Compton K, Dean FE, et al. Cancer Incidence, Mortality, Years of Life Lost, Years Lived With Disability, and Disability-Adjusted Life Years for 29 Cancer Groups From 2010 to 2019: A Systematic Analysis for the Global Burden of Disease Study 2019. JAMA Oncol. 2022;8(3):420-444. https://doi.org/10.1001/jamaoncol.2021.6987\n[2] Fidler MM, Gupta S, Soerjomataram I, Ferlay J, Steliarova-Foucher E, Bray F. Cancer incidence and mortality among young adults aged 20-39 years worldwide in 2012: a population-based study. Lancet Oncol. 2017;18(12):1579-1589. https://doi.org/10.1016/S1470-2045(17)30677-0\n[3] Wickham H, Chang W, Henry L, et al. ggplot2: Create Elegant Data Visualisations Using the Grammar of Graphics [Computer software]. (Version 3.4.0). 2022. https://ggplot2.tidyverse.org/reference/ggsf.html",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "PopulationMapPlot"
    ]
  },
  {
    "objectID": "Omics/KeggPathwayPlot.html",
    "href": "Omics/KeggPathwayPlot.html",
    "title": "KEGG通路图",
    "section": "",
    "text": "(a)展示了包含基因数据的经典信号通路（hsa04110 Cell cycle）的Graphviz视图；(b)展示了包含离散基因数据和连续代谢物数据的代谢通路（hsa00640 Propanoate metabolism）的KEGG视图。\n图片、R包等均来源于Luo等人的文章。[1]",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "KeggPathwayPlot"
    ]
  },
  {
    "objectID": "Omics/KeggPathwayPlot.html#示例",
    "href": "Omics/KeggPathwayPlot.html#示例",
    "title": "KEGG通路图",
    "section": "",
    "text": "(a)展示了包含基因数据的经典信号通路（hsa04110 Cell cycle）的Graphviz视图；(b)展示了包含离散基因数据和连续代谢物数据的代谢通路（hsa00640 Propanoate metabolism）的KEGG视图。\n图片、R包等均来源于Luo等人的文章。[1]",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "KeggPathwayPlot"
    ]
  },
  {
    "objectID": "Omics/KeggPathwayPlot.html#环境配置",
    "href": "Omics/KeggPathwayPlot.html#环境配置",
    "title": "KEGG通路图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：pathview, dbplyr\n\n\n# 安装包\nif (!requireNamespace(\"pathview\", quietly = TRUE)) {\n  remotes::install_github(\"datapplab/pathview\")\n}\nif (!requireNamespace(\"dbplyr\", quietly = TRUE)) {\n  install.packages(\"dbplyr\")\n}\n\n# 加载包\nlibrary(pathview)\nlibrary(dbplyr)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package  * version date (UTC) lib source\n dbplyr   * 2.5.1   2025-09-10 [1] RSPM\n pathview * 1.47.1  2025-11-02 [1] Github (datapplab/pathview@1f17eb7)\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "KeggPathwayPlot"
    ]
  },
  {
    "objectID": "Omics/KeggPathwayPlot.html#数据准备",
    "href": "Omics/KeggPathwayPlot.html#数据准备",
    "title": "KEGG通路图",
    "section": "数据准备",
    "text": "数据准备\n示例数据为基因表达矩阵: 行为基因的ENTREZ ID，列为样本名，表达数据经过归一化处理。其实这里可以为任何数值型数据，例如fold change, p-value等等，根据自己的需求来定。\n\ndata(\"gse16873.d\")\nhead(gse16873.d)\n\n               DCIS_1      DCIS_2       DCIS_3      DCIS_4       DCIS_5\n10000     -0.30764480 -0.14722769 -0.023784808 -0.07056193 -0.001323087\n10001      0.41586805 -0.33477259 -0.513136907 -0.16653712  0.111122223\n10002      0.19854925  0.03789588  0.341865341 -0.08527420  0.767559264\n10003     -0.23155297 -0.09659311 -0.104727283 -0.04801404 -0.208056443\n100048912 -0.04490724 -0.05203146  0.036390376  0.04807823  0.027205816\n10004     -0.08756237 -0.05027725  0.001821133  0.03023835  0.008034394\n               DCIS_6\n10000     -0.15026813\n10001      0.13400734\n10002      0.15828609\n10003      0.03344448\n100048912  0.05444739\n10004     -0.06860749\n\ngene_data &lt;- as.data.frame(gse16873.d)\nhead(gene_data)\n\n               DCIS_1      DCIS_2       DCIS_3      DCIS_4       DCIS_5\n10000     -0.30764480 -0.14722769 -0.023784808 -0.07056193 -0.001323087\n10001      0.41586805 -0.33477259 -0.513136907 -0.16653712  0.111122223\n10002      0.19854925  0.03789588  0.341865341 -0.08527420  0.767559264\n10003     -0.23155297 -0.09659311 -0.104727283 -0.04801404 -0.208056443\n100048912 -0.04490724 -0.05203146  0.036390376  0.04807823  0.027205816\n10004     -0.08756237 -0.05027725  0.001821133  0.03023835  0.008034394\n               DCIS_6\n10000     -0.15026813\n10001      0.13400734\n10002      0.15828609\n10003      0.03344448\n100048912  0.05444739\n10004     -0.06860749",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "KeggPathwayPlot"
    ]
  },
  {
    "objectID": "Omics/KeggPathwayPlot.html#可视化",
    "href": "Omics/KeggPathwayPlot.html#可视化",
    "title": "KEGG通路图",
    "section": "可视化",
    "text": "可视化\n\n1. 基础绘图\n观察单个样本（DCIS_1）的细胞周期信号通路图（KEGG ID: 04110）。\n\n1.1 KEGG视图\n当设置kegg.native = TRUE时，输出的通路图是基于原始KEGG视图绘制的。输出图像自动保存在了当前目录下。\n\np1 &lt;- pathview(gene.data = gse16873.d[, 1], # 输入基因矩阵\n               pathway.id = \"04110\", # 通路ID\n               species = \"hsa\", # 物种：人类\n               out.suffix = \"gse16873_KEGG\", # 输出文件的后缀\n               kegg.native = T, # 以原始KEGG视图输出\n               same.layer = T # 绘制单个图层\n               )\np1\n\n\n\n\n\n\n\n图 1: KEGG视图\n\n\n\n为了更好的理解kegg.native = TRUE，我们对比一下KEGG官网的Cell cycle的通路图（https://www.kegg.jp/pathway/map04110）\n\n\n\n\n\n\n图 2: KEGG官网的Cell cycle的通路图\n\n\n\n不难发现，我们输出的结果图其实就是在官网提供的通路图的基础上，对研究样本的通路基因的表达差异进行了可视化。而为当kegg.native = FALSE时，则改为使用Graphviz引擎制图，输出是PDF格式的向量图，这个后续会介绍。\n然后我们再查看一下pathview函数输出结果p1的结构，其为一个长度为2的list。包含了我们绘图所需要的数据。\n\n\n\n\n\n\n提示\n\n\n\n\nplot.data.gene (data.frame)：储存画图用到的基因数据\nplot.data.cpd (data.frame)：储存画图用到的化合物数据\nkegg.names: 映射节点的基因/化合物的KEGG格式ID（即 Entrez Gene ID 或 KEGG Compound Accessions）\nlabels: 映射节点的基因/化合物的名称\nall.mapped: 映射到该节点的所有基因/化合物的ID。\ntype: 节点类型。（“基因”、“酶”、“化合物”、“同源物”）\nx: 原始KEGG通路图中的x坐标。\ny: 原始KEGG通路图中的y坐标。\nwidth: 原始KEGG通路图中的节点宽度。\nheight: 原始KEGG通路图中的节点高度。\nmol.data: 映射节点的基因/化合物的数据（对应输入数据gene.data）\nmol.data: 映射节点的基因/化合物的颜色代码\n\n\n\n\n\n1.2 Graphviz视图\n介绍了以KEGG原始形式输出图像（kegg.native = TRUE）后，我们来看下使用Graphviz输出的图（kegg.native = FALSE）的图像格式。\n\np2 &lt;- pathview(gene.data = gse16873.d[, 1], \n               pathway.id = \"04110\", \n               species = \"hsa\", \n               out.suffix = \"gse16873_Graph\", \n               kegg.native = F ,# 以Graphviz输出形式输出\n               same.layer = T # 绘制单个图层\n               )\np2\n\n\n\n\n\n\n\n图 3: Graphviz视图\n\n\n\nKEGG原始格式图保留了所有通路的元数据，即空间和时间信息、组织/细胞类型、输入、输出和连接，这对通路生物学的可读性和解释很重要。而Graphviz视图为PDF格式矢量图，可以更好地控制节点和边缘属性，更好地查看路径拓扑，如能够用Adobe illustration进行进一步美化。\n在Graphviz形式输出的通路图中，same.layer参数的意义与KEGG原始图有所不同，转为描述图例与通路图的图层关系。当same.layer = TRUE时，图例和通路图处于同一个图层之中，并且图例只描述了边缘类型（Egde types），缺少了节点类型（Node types）。\n当same.layer = FALSE时，图例和通路图分别处于两个图层，图例同时描述了边缘类型（Egde types）和节点类型（Node types）。\n\np3 &lt;- pathview(gene.data = gse16873.d[, 1], \n               pathway.id = \"04110\", \n               species = \"hsa\", \n               out.suffix = \"gse16873_Graph\", \n               kegg.native = F ,# 以Graphviz输出形式输出\n               same.layer = T # 绘制单个图层\n               )\np3\n\n\n\n\n\n\n\n图 4: same-layer设置\n\n\n\n\n\n\n2. 图形调整\n考虑到许多改变图形样式的参数仅在kegg.native = FALSE时生效，接下来我们多数情况也基于此来进行绘图\n\n2.1 节点样式调整\n\np4 &lt;- pathview(gene.data = gse16873.d[, 1],\n               pathway.id = \"04110\", \n               species = \"hsa\", \n               out.suffix = \"gse16873_node\", \n               kegg.native = F ,\n               same.layer = F ,\n               low = '#4575B4', #\n               mid = '#F7F7BD', #\n               high = '#D73027', #\n               cex = 0.5 ,# 字体大小\n               afactor = 1.6 ,# 节点大小\n               limit = list( gene = 2 ) # 图例上下限\n               )\np4\n\n\n\n\n\n\n\n图 5: 节点样式调整\n\n\n\n\n\n2.2 节点的拆分与扩展\n通过设置参数split.group来实现控制节点组拆分为独立的节点，设置expand.node可以将多基因节点扩展为单个基因。\n节点组的拆分 (split.group = TRUE) :\n\np5 &lt;- pathview(gene.data = gse16873.d[, 1],\n               pathway.id = \"04110\", \n               species = \"hsa\", \n               out.suffix = \"gse16873_split\", \n               kegg.native = F ,\n               same.layer = F ,\n               split.group = T # TRUE\n               ) \n\np5\n\n\n\n\n\n\n\n图 6: 节点的拆分与扩展\n\n\n\n多基因节点扩展为单个基因：(split.group = TRUE & expand.node = TRUE):\n\np6 &lt;- pathview(gene.data = gse16873.d[, 1],\n               pathway.id = \"04110\", \n               species = \"hsa\", \n               out.suffix = \"gse16873_expand\", \n               kegg.native = F ,\n               same.layer = F ,\n               split.group = T,\n               expand.node = T # TRUE\n               ) \n\nunique(p6$plot.data.gene$kegg.names) %&gt;% length()\n# [1] 88\nunique(p7$plot.data.gene$kegg.names) %&gt;% length()\n# [1] 158\n\n# 多出的节点即为原多基因节点的扩展\nsetdiff(unique(B),intersect(A,B))\n\n然后发现线条变得错综复杂，以至于我们重点关注的节点和节点之间的关系被淹没了。\n\n\n\n\n\n\n图 7: 多基因节点扩展为单个基因\n\n\n\n\n\n2.3 多组样本\n以上例子仅绘制了单个样本的通路图，如果是为了比较两个或多个样本的通路变化情况，则需要设置multi.state = TRUE。可以将多个样本的数据整合到同一张通路图中。此时每个节点会被分割成多个片段，每个片段对应一个样本。\n\np8 &lt;- pathview(gene.data = gse16873.d[, 1:3], # 多样本\n               pathway.id = \"04110\", \n               species = \"hsa\", \n               out.suffix = \"gse16873_samples\", \n               kegg.native = F ,\n               same.layer = F ,\n               multi.state = T # \n               )\n\n呈现的效果是：节点被分割成多个对应样本数量的片段，一个样本对应一个色块\n\n\n\n\n\n\n图 8: 多组样本\n\n\n\n\n\n2.4 化合物的通路图\n化合物数据\n之前我们只介绍了基因数据的通路可视化，如果单纯做化合物数据的话，其实是跟基因一样的，只需要修改gene.data为cpd.data。\n\n# 模拟6个样本的化合物数据\ndata(\"cpd.simtypes\")\ncpd_data &lt;- sim.mol.data(mol.type=\"cpd\", nmol=3000)\ncpd_data2 &lt;- matrix(sample(cpd_data,18000,replace = T), ncol = 6)\nrownames(cpd_data2) = names(cpd_data)\ncolnames(cpd_data2) = colnames(gene_data)\nhead(cpd_data2)\n\nKEGG视图\n\np9 &lt;- pathview(cpd.data = cpd_data2, # 化合物数据\n               pathway.id = \"00640\", # \n               species = \"hsa\", \n               out.suffix = \"gse16873_KEGG_cpd\", \n               kegg.native = T , # KEGG视图\n               same.layer = F  \n               ) \n\n\n\n\n\n\n\n图 9: KEGG视图\n\n\n\nGraphviz视图\n\np10 &lt;- pathview(cpd.data = cpd_data, # 化合物数据\n               pathway.id = \"00640\", \n               species = \"hsa\", \n               out.suffix = \"gse16873_Graphviz_cpd\", \n               kegg.native = F , # Graphviz视图\n               same.layer = F  ,\n               cpd.lab.offset = -1.0 #化合物标签位置\n               ) \n\n\n\n\n\n\n\n图 10: Graphviz视图\n\n\n\n化合物和基因数据\n接下来我们举例说明同时绘制基因和化合物数据的情况：\nKEGG视图\n\np11 &lt;- pathview(gene.data = gene_data[,1:4], # 基因数据\n               cpd.data = cpd_data2[,1:2], # 化合物数据\n               pathway.id = \"00640\", \n               species = \"hsa\", \n               out.suffix = \"gse16873_KEGG_gene_cpd\", \n               kegg.native = T , # KEGG视图\n               same.layer = F  ,\n               cpd.lab.offset = -1.0 ,\n               key.pos = 'bottomright',\n               match.data = F, # 不匹配样本数\n               multi.state = T ,\n               bins = list(gene = 8, cpd = 8), # 改变图例色块的数量\n               low = list(gene = \"#6495ED\", cpd = \"#006400\"),\n               mid = list(gene = \"#F7F7BD\", cpd = \"#F7F7BD\"), \n               high = list(gene = \"#D73027\", cpd =\"#FFD700\")\n               ) \n\n\n\n\n\n\n\n图 11: KEGG视图\n\n\n\nGraphviz视图\n\np12 &lt;- pathview(gene.data = gene_data[,1:4], # 基因数据\n               cpd.data = cpd_data2[,1:2], # 化合物数据\n               pathway.id = \"00640\", \n               species = \"hsa\", \n               out.suffix = \"gse16873_Graphviz_gene_cpd\", \n               kegg.native = F , # Graphviz视图\n               same.layer = F  ,\n               cpd.lab.offset = -1.0 ,\n               key.pos = 'topright',\n               match.data = F, # 不匹配样本数\n               multi.state = T ,\n               bins = list(gene = 10, cpd = 10), # 改变图例色块的数量\n               low = list(gene = \"#6495ED\", cpd = \"#006400\"),\n               mid = list(gene = \"#F7F7BD\", cpd = \"#F7F7BD\"), \n               high = list(gene = \"#D73027\", cpd =\"#FFD700\")\n               ) \n\n\n\n\n\n\n\n图 12: Graphviz视图\n\n\n\n当gene和cpd数据的样本数不一致时，此时参数应设置为match.data=FALSE，若设置为match.data = TRUE，则样本数少的数据会生成相差的NA列以配对样本数量。默认NA数据为透明无色，可通过na.col设置颜色。\n\np13 &lt;- pathview(gene.data = gene_data[,1:4],\n               cpd.data = cpd_data2[,1:2], \n               pathway.id = \"00640\", \n               species = \"hsa\", \n               out.suffix = \"gse16873_Graphviz_gene_cpd_match\", \n               kegg.native = F , # Graphviz视图\n               same.layer = F  ,\n               cpd.lab.offset = -1.0 ,\n               key.pos = 'topright',\n               match.data = T, # 匹配样本数：为cpd添加2列NA\n               multi.state = T , \n               bins = list(gene = 10, cpd = 10),\n               na.col = 'transparent' , # NA数据颜色设置\n               low = list(gene = \"#6495ED\", cpd = \"#006400\"),\n               mid = list(gene = \"#F7F7BD\", cpd = \"#F7F7BD\"), \n               high = list(gene = \"#D73027\", cpd =\"#FFD700\")\n               ) \n\n可以发现化合物节点只有一半是有颜色的，因为另一半是NA，默认为透明无色。\n\n\n\n\n\n\n图 13: 设置颜色\n\n\n\n\n\n2.5 离散数据\n如果我们的输入数据不是像上述例子的连续变量，而是如high/low的分类变量(可用1/0替换)或显著差异的基因名称，则需要设置discrete参数以绘制离散变量的通路视图。\n这里我们取基因数据为离散变量1/0，而化合物为连续变量。\n\n# 获取基因数据 （离散变量）\ndata(\"gse16873.d\")\ngene_data &lt;- gse16873.d\ncolnames(gene_data)\ngene_data2 &lt;- apply(gene_data, 2, function(x){\n  ifelse(x &gt; mean(x), 1 , 0 )\n}) %&gt;% as.data.frame()\nstr(gene_data2)\n\n\np14 &lt;- pathview(gene.data = gene_data2[,1:4], # 离散变量\n               cpd.data = cpd_data2[,1:2], # 连续变量\n               pathway.id = \"00640\", \n               species = \"hsa\", \n               out.suffix = \"gse16873_KEGG_gene_cpd_discrete\", \n               kegg.native = T , # KEGG视图\n               same.layer = F  ,\n               cpd.lab.offset = -1.0 ,\n               key.pos = 'topright',\n               match.data = F, \n               multi.state = T ,\n               bins = list(gene = 1, cpd = 6), \n               low = list(gene = \"#F7F7BD\", cpd = \"#006400\"),\n               mid = list(gene = \"#F7F7BD\", cpd = \"#F7F7BD\"), \n               high = list(gene = \"#D73027\", cpd =\"#FFD700\"),\n               discrete = list(gene = T, cpd = F) ,# 离散数据为T\n               limit = list(gene = 1, cpd = c(-1,1)) ,\n               both.dirs = list(gene = F, cpd = T) # gene为单向数据\n               ) \n\n\n\n\n\n\n\n图 14: 离散数据1\n\n\n\n\np15 &lt;- pathview(gene.data = gene_data[,1:4], # 离散变量\n               cpd.data = cpd_data2[,1:2], # 连续变量\n               pathway.id = \"00640\", \n               species = \"hsa\", \n               out.suffix = \"gse16873_Graphviz_gene_cpd_discrete\",\n               kegg.native = F , # Graphviz视图\n               same.layer = F  ,\n               cpd.lab.offset = -1.0 ,\n               key.pos = 'topright',\n               match.data = F, \n               multi.state = T , \n               bins = list(gene = 1, cpd = 6), \n               low = list(gene = \"#F7F7BD\", cpd = \"#006400\"),\n               mid = list(gene = \"#F7F7BD\", cpd = \"#F7F7BD\"), \n               high = list(gene = \"#D73027\", cpd =\"#FFD700\"),\n               discrete = list(gene = T, cpd = F) ,# 离散数据为T\n               limit = list(gene = 1, cpd = c(-1,1)),\n               both.dirs = list(gene = F, cpd = T) # gene.data为单向数据\n               ) \n\n\n\n\n\n\n\n图 15: 离散数据2",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "KeggPathwayPlot"
    ]
  },
  {
    "objectID": "Omics/KeggPathwayPlot.html#应用场景",
    "href": "Omics/KeggPathwayPlot.html#应用场景",
    "title": "KEGG通路图",
    "section": "应用场景",
    "text": "应用场景\n\n\n\n\n\n\n图 16: KEGG通路图应用\n\n\n\n该图展示了关键的KEGG途径：MAPK信号通路和细胞衰老信号通路。红色节点代表cingulin b-mo突变体中上调的DEG，绿色标记的节点代表cingulin b-mo突变体中下调的DEG，而蓝色标记的节点代表对照MO和c链蛋白B-MO胚胎之间的重叠靶标。该分析是从不同组的三个独立实验进行的，每个组都有30个胚胎。[2]",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "KeggPathwayPlot"
    ]
  },
  {
    "objectID": "Omics/KeggPathwayPlot.html#参考文献",
    "href": "Omics/KeggPathwayPlot.html#参考文献",
    "title": "KEGG通路图",
    "section": "参考文献",
    "text": "参考文献\n[1] Luo, W., & Brouwer, C. (2013). Pathview: an R/Bioconductor package for pathway-based data integration and visualization. Bioinformatics (Oxford, England), 29(14), 1830–1831. https://doi.org/10.1093/bioinformatics/btt285IF: 4.4 B3.\n[2] Lu Y, Tang D, Zheng Z, et al. Cingulin b Is Required for Zebrafish Lateral Line Development Through Regulation of Mitogen-Activated Protein Kinase and Cellular Senescence Signaling Pathways. Front Mol Neurosci. 2022;15:844668. Published 2022 May 5. doi:10.3389/fnmol.2022.844668.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "KeggPathwayPlot"
    ]
  },
  {
    "objectID": "Omics/MultiVolcanoPlot.html",
    "href": "Omics/MultiVolcanoPlot.html",
    "title": "多组火山图",
    "section": "",
    "text": "多组火山图是一种用于高通量数据（如转录组、蛋白组）差异表达分析的图形。相比于传统火山图，多组火山图可以同时展示多个分组的结果，便于横向比较差异特征的一致性或特异性。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "MultiVolcanoPlot"
    ]
  },
  {
    "objectID": "Omics/MultiVolcanoPlot.html#示例",
    "href": "Omics/MultiVolcanoPlot.html#示例",
    "title": "多组火山图",
    "section": "示例",
    "text": "示例\n\n\n\n\n\n这个多组火山图展示了单细胞测序数据中多个细胞类群的差异基因表达模式。X 轴不同的颜色的方块表示不同的细胞类群，方块内部的散点表示差异基因，使用 geom_jitter 函数给散点添加了抖动效果，以避免数据点重叠。Y 轴表示差异倍数（Average log2FoldChange，红色散点表示 log2FC&gt;0 的上调基因，蓝色散点表示 log2FC&lt;0 的下调基因，文字标记出了 top5 差异基因。多组火山图不仅突出了各细胞类群特异性差异基因（如特定细胞类型的标记基因），还能直观识别跨细胞类群共有的关键调控分子。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "MultiVolcanoPlot"
    ]
  },
  {
    "objectID": "Omics/MultiVolcanoPlot.html#环境配置",
    "href": "Omics/MultiVolcanoPlot.html#环境配置",
    "title": "多组火山图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：scRNAtoolVis; corrplot\n\n\n# 安装包\nif (!requireNamespace(\"scRNAtoolVis\", quietly = TRUE)) {\n  remotes::install_github('junjunlab/scRNAtoolVis')\n}\nif (!requireNamespace(\"corrplot\", quietly = TRUE)) {\n  install.packages(\"corrplot\")\n}\n\n# 加载包\nlibrary(scRNAtoolVis)\nlibrary(corrplot)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package      * version date (UTC) lib source\n corrplot     * 0.95    2024-10-14 [1] RSPM\n dplyr        * 1.1.4   2023-11-17 [1] RSPM\n forcats      * 1.0.1   2025-09-25 [1] RSPM\n ggplot2      * 4.0.1   2025-11-14 [1] RSPM\n lubridate    * 1.9.4   2024-12-08 [1] RSPM\n purrr        * 1.2.0   2025-11-04 [1] RSPM\n readr        * 2.1.6   2025-11-14 [1] RSPM\n scRNAtoolVis * 0.1.0   2025-12-24 [1] Github (junjunlab/scRNAtoolVis@6fede18)\n stringr      * 1.6.0   2025-11-04 [1] RSPM\n tibble       * 3.3.0   2025-06-08 [1] RSPM\n tidyr        * 1.3.2   2025-12-19 [1] RSPM\n tidyverse    * 2.0.0   2023-02-22 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "MultiVolcanoPlot"
    ]
  },
  {
    "objectID": "Omics/MultiVolcanoPlot.html#数据准备",
    "href": "Omics/MultiVolcanoPlot.html#数据准备",
    "title": "多组火山图",
    "section": "数据准备",
    "text": "数据准备\n数据使用 scRNAtoolVis 包中提供的 pbmc.markers 单细胞测序差异基因数据集。\n\n# 读取数据\ndata('pbmc.markers')\n# 查看数据集\nhead(pbmc.markers)\n\n              p_val avg_log2FC pct.1 pct.2     p_val_adj     cluster  gene\nRPS12 2.008629e-140  0.7256738 1.000 0.991 2.754633e-136 Naive CD4 T RPS12\nRPS27 2.624075e-140  0.7242847 0.999 0.992 3.598656e-136 Naive CD4 T RPS27\nRPS6  1.280169e-138  0.6742630 1.000 0.995 1.755623e-134 Naive CD4 T  RPS6\nRPL32 4.358823e-135  0.6121027 0.999 0.995 5.977689e-131 Naive CD4 T RPL32\nRPS14 3.618793e-128  0.6179756 1.000 0.994 4.962812e-124 Naive CD4 T RPS14\nCYBA  1.090337e-124 -1.5739355 0.661 0.914 1.495288e-120 Naive CD4 T  CYBA\n\n\n注意：数据集中应至少包括 p_val、avg_log2FC、p_val_adj、cluster、gene 这五列，且列名称不能改变，列顺序可以改变。绘图中展示的分组方块的名称为 cluster 列内容中的名称。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "MultiVolcanoPlot"
    ]
  },
  {
    "objectID": "Omics/MultiVolcanoPlot.html#可视化",
    "href": "Omics/MultiVolcanoPlot.html#可视化",
    "title": "多组火山图",
    "section": "可视化",
    "text": "可视化\n\n1. 基础绘图\n可以使用 scRNAtoolVis 包中提供的 jjVolcano 函数绘制多组火山图。\n\n# 基础多组火山图\np &lt;- jjVolcano(\n  diffData = pbmc.markers,\n  topGeneN = 5,\n  log2FC.cutoff = 0.5,\n  col.type = \"updown\",\n  aesCol = c('#0099CC','#CC3333'),\n  tile.col = corrplot::COL2('PuOr', 15)[4:12],\n  cluster.order = rev(unique(pbmc.markers$cluster)),\n  size  = 3.5,\n  fontface = 'italic'\n  )\n\np\n\n\n\n\n\n\n\n图 1: 基础多组火山图\n\n\n\n\n\nFigure 1 绘制了九种单细胞类群中上调和下调的差异基因。\n\n\n\n\n\n\n提示\n\n\n\n关键参数: \n\ndiffData: 输入的差异基因表格，数据结构如 pbmc.markers 所示。\nmyMarkers: 自定义要展示文字标签的基因，例如：myMarkers = c('PPBP', 'PF4') 自定义展示两个基因的文字标签。\n\n\n\n\n# 设置参数 myMarkers = c('PPBP', 'PF4')\np &lt;- jjVolcano(\n  diffData = pbmc.markers,\n  myMarkers = c('PPBP', 'PF4'),\n  log2FC.cutoff = 0.5,\n  col.type = \"updown\",\n  aesCol = c('#0099CC','#CC3333'),\n  tile.col = corrplot::COL2('PuOr', 15)[4:12],\n  cluster.order = rev(unique(pbmc.markers$cluster)),\n  size  = 3.5,\n  fontface = 'italic',\n  legend.position = c(0.7,0.9)\n  )\n\np\n\n\n\n\n\n\n\n图 2: 关键参数：myMarkers\n\n\n\n\n\n\n\n\n\n\n\n提示\n\n\n\n关键参数: \n\ntopGeneN: 展示多少个 top 基因的文字标签，Figure1 示例中 topGeneN = 5 展示了每个类群中 top5 的上调和下调基因的文字标签，topGeneN 和 myMarkers 参数不能同时使用。\nlog2FC.cutoff: 设置 log2FoldChange 的阈值，该参数决定了分组方块的上下边界。\n\n\n\n\n# 设置 log2FC.cutoff=0.5\np1 &lt;- jjVolcano(\n  diffData = pbmc.markers,\n  topGeneN = 0,\n  log2FC.cutoff = 0.5,\n  col.type = \"updown\",\n  aesCol = c('#0099CC','#CC3333'),\n  tile.col = corrplot::COL2('PuOr', 15)[4:12],\n  cluster.order = rev(unique(pbmc.markers$cluster)),\n  size  = 3.5,\n  fontface = 'italic',\n  legend.position = c(0.7,0.9)\n  )\n\n# 设置 log2FC.cutoff=2.5\np2 &lt;- jjVolcano(\n  diffData = pbmc.markers,\n  topGeneN = 0,\n  log2FC.cutoff = 2.5,\n  col.type = \"updown\",\n  aesCol = c('#0099CC','#CC3333'),\n  tile.col = corrplot::COL2('PuOr', 15)[4:12],\n  cluster.order = rev(unique(pbmc.markers$cluster)),\n  size  = 3.5,\n  fontface = 'italic',\n  legend.position = c(0.7,0.9)\n  )\n\np1 + p2\n\n\n\n\n\n\n\n图 3: 关键参数：log2FC.cutoff\n\n\n\n\n\n\n\n\n\n\n\n提示\n\n\n\n关键参数: \n\ncol.type: 散点颜色分组方式，Figure1 示例按照 “updown” 分组，也可以按照 “adjustP” 分组。\n\n\n\n\n# 设置参数 col.type=\"adjustP\"\np &lt;- jjVolcano(\n  diffData = pbmc.markers,\n  topGeneN = 5,\n  log2FC.cutoff = 0.5,\n  col.type = \"adjustP\",\n  aesCol = c('#0099CC','#CC3333'),\n  tile.col = corrplot::COL2('PuOr', 15)[4:12],\n  cluster.order = rev(unique(pbmc.markers$cluster)),\n  size  = 3.5,\n  fontface = 'italic',\n  legend.position = c(0.7,0.9)\n  )\n\np\n\n\n\n\n\n\n\n图 4: 关键参数：col.type\n\n\n\n\n\n\n\n\n\n\n\n提示\n\n\n\n关键参数: \n\naesCol：设置散点的颜色配色。\ntile.col：设置分组方块的颜色配色。\ncluster.order：设置分组方块的顺序。\nsize：设置基因文字标签的字体大小。\nfontface：设置基因文字标签的字体样式。\nlegend.position：设置 legend 的位置。\n\n\n\n\n\n2. 旋转方向\n使用 jjVolcano 函数中的 flip 参数可以旋转热图的方向。\n\n# 横向多组火山图\np &lt;- \n  jjVolcano(\n    diffData = pbmc.markers,\n    tile.col = corrplot::COL2('PiYG', 15)[4:12],\n    size  = 3.5,\n    fontface = 'italic',\n    legend.position = c(0.8,0.2),\n    flip = T)\n\np\n\n\n\n\n\n\n\n图 5: 关键参数：flip\n\n\n\n\n\nFigure 5 通过设置参数 flip = T 将多组火山图旋转为横向。\n\n\n3. 极坐标\n\n# 极坐标多组火山图\np &lt;- jjVolcano(\n  diffData = pbmc.markers,\n  tile.col = corrplot::COL2('RdBu', 15)[4:12],\n  size  = 3.5,\n  fontface = 'italic',\n  polar = T)\n\np\n\n\n\n\n\n\n\n图 6: 关键参数：polar\n\n\n\n\n\nFigure 6 通过设置参数 polar = T 将多组火山图转换为极坐标。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "MultiVolcanoPlot"
    ]
  },
  {
    "objectID": "Omics/MultiVolcanoPlot.html#应用场景",
    "href": "Omics/MultiVolcanoPlot.html#应用场景",
    "title": "多组火山图",
    "section": "应用场景",
    "text": "应用场景\n\n\n\n\n\n\n图 7: 多组火山图应用\n\n\n\nFigure 7H 显示了所有十个单细胞类群中上调和下调基因的差异基因表达分析。调整后的P值&lt;0.01表示为红色，而调整后的P值≥0.01表示为黑色 [1]。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "MultiVolcanoPlot"
    ]
  },
  {
    "objectID": "Omics/MultiVolcanoPlot.html#参考文献",
    "href": "Omics/MultiVolcanoPlot.html#参考文献",
    "title": "多组火山图",
    "section": "参考文献",
    "text": "参考文献\n[1] Asp M, Giacomello S, Larsson L, et al. A Spatiotemporal Organ-Wide Gene Expression and Cell Atlas of the Developing Human Heart. Cell. 2019;179(7):1647-1660.e19. doi:10.1016/j.cell.2019.11.025.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "MultiVolcanoPlot"
    ]
  },
  {
    "objectID": "Omics/SyntenyBlocksPlot.html",
    "href": "Omics/SyntenyBlocksPlot.html",
    "title": "共线性块图",
    "section": "",
    "text": "共线性被广泛应用于复杂基因组的研究。本教程将基于R包syntR，对识别两个遗传图谱之间共享的共线性区块、染色体重排和绘图进行总结。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "SyntenyBlocksPlot"
    ]
  },
  {
    "objectID": "Omics/SyntenyBlocksPlot.html#示例",
    "href": "Omics/SyntenyBlocksPlot.html#示例",
    "title": "共线性块图",
    "section": "",
    "text": "共线性被广泛应用于复杂基因组的研究。本教程将基于R包syntR，对识别两个遗传图谱之间共享的共线性区块、染色体重排和绘图进行总结。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "SyntenyBlocksPlot"
    ]
  },
  {
    "objectID": "Omics/SyntenyBlocksPlot.html#环境配置",
    "href": "Omics/SyntenyBlocksPlot.html#环境配置",
    "title": "共线性块图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：syntR;\n\n\n# 安装包\nif (!requireNamespace(\"UpSetR\", quietly = TRUE)) {\n  remotes::install_github(\"ksamuk/syntR\")\n}\n\n# 加载包\nlibrary(syntR)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package     * version date (UTC) lib source\n dplyr       * 1.1.4   2023-11-17 [1] RSPM\n intervals   * 0.15.5  2024-08-23 [1] RSPM\n magrittr    * 2.0.4   2025-09-12 [1] RSPM\n reshape2    * 1.4.5   2025-11-12 [1] RSPM\n syntR       * 1.0     2025-11-02 [1] Github (ksamuk/syntR@bce120c)\n tidyr       * 1.3.2   2025-12-19 [1] RSPM\n viridis     * 0.6.5   2024-01-29 [1] RSPM\n viridisLite * 0.4.2   2023-05-02 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "SyntenyBlocksPlot"
    ]
  },
  {
    "objectID": "Omics/SyntenyBlocksPlot.html#数据准备",
    "href": "Omics/SyntenyBlocksPlot.html#数据准备",
    "title": "共线性块图",
    "section": "数据准备",
    "text": "数据准备\nsyntR 需要两个遗传图谱中的标记位置（每个标记的染色体和图谱位置）。在使用 syntR 之前，需要分别推断两个图谱中的标记顺序。在使用 syntR 绘图，先使用R/qtl、ASMap 和 Lep-MAP获得两个不同图谱中单个标记（如 SNP、微卫星等）的位置数据。也可用minimap2的比对结果转换为为类似的输入文件用于分析和绘图。\n\n# 加载示例标记数据\ndata(ann_pet_map)\nhead(ann_pet_map)\n\n             map1_name map1_chr map1_pos            map2_name map2_chr map2_pos\n1 HanXRQChr12_10463750    Ann12 23.33200 HanXRQChr12_10463750 Pet12_16 0.000000\n2 HanXRQChr12_10463069    Ann12 23.33091 HanXRQChr12_10463069 Pet12_16 3.660274\n3 HanXRQChr12_67274477    Ann12 51.14234 HanXRQChr12_67274477 Pet12_16 3.660274\n4 HanXRQChr12_11545866    Ann12 25.01880 HanXRQChr12_11545866 Pet12_16 3.660274\n5 HanXRQChr12_11545707    Ann12 25.01856 HanXRQChr12_11545707 Pet12_16 3.660274\n6  HanXRQChr12_9937279    Ann12 22.47337  HanXRQChr12_9937279 Pet12_16 4.567248\n\n\n数据分位六列：\n\nmap1_name：标记的唯一标识符。在本例中，标记的命名是基于其在参考基因组中的位置（通过比对 GBS 读数确定）。\nmap1_chr：第一个图谱中标记所在的染色体编号。\nmap1_pos：第一个图谱中标记的位置（例如以 cM 为单位）。\nmap2_name：同上，但用于图谱 2。这些名称可能与 map1_names 相同，也可能不相同。\nmap2_chr：第二个图谱中标记所在的染色体编号。\nmap2_pos：第二个图谱中的标记的位置。\n\n示例数据是通过比较两种蝴蝶 Helianthus petiolaris ssp. petiolaris 和 H. petiolaris ssp. fallax 的GBS数据产生的。首先加载标记数据(ann_pet_map)和map1的染色体长度列表(ann_chr_lengths)，并通过make_one_map 函数将其转化为一个包含三个元素的列表(标记数据，map1和map2之间染色体中断的位置):\n\n# 读取 map1 的染色体长度列表\n# 这是一个可选文件，用于定义最大长度\n# 如果已知，则为每条染色体的长度（以 cM 为单位）\n# 注意：当被比较的标记未覆盖整个图谱时，这很有用\ndata(ann_chr_lengths)\nann_chr_lengths\n\n  map1_chr map1_max_chr_lengths\n1    Ann08                63.68\n2    Ann09                96.46\n3    Ann12                71.68\n4    Ann15                80.29\n5    Ann16               103.49\n6    Ann17                97.14\n\n\n\n# make_one_map 将所有标记放在一个尺度上\n# 并在染色体之间添加填充\n# 以辅助算法并实现可视化\nmap_list &lt;- make_one_map(ann_pet_map, map1_max_chr_lengths = ann_chr_lengths)",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "SyntenyBlocksPlot"
    ]
  },
  {
    "objectID": "Omics/SyntenyBlocksPlot.html#可视化",
    "href": "Omics/SyntenyBlocksPlot.html#可视化",
    "title": "共线性块图",
    "section": "可视化",
    "text": "可视化\n\n1. 调整图谱顺序\n使用 plot_maps() 创建标记数据的基本点阵图：\n\n# 调整图谱顺序\nplot_maps(map_df = map_list[[1]], map1_chrom_breaks = map_list[[2]], map2_chrom_breaks = map_list[[3]])\n\n\n\n\n\n\n\n图 1: 调整图谱顺序\n\n\n\n\n\n染色体上标注了物种特有的名称，染色体断裂处用横竖线表示。\n因为染色体是任意排序的(染色体没有固有顺序)，这些图看起来相当分散。为了提高可读性，可以重新排列物种 2 的染色体顺序，使其与物种 1 的顺序一致（沿 x 轴绘制）。还可以旋转任何 “完全颠倒”的染色体，使它们（按染色体比例）沿 1:1 线排列。\n\n# 调整图谱顺序\nmap2_chr_order &lt;- c(\"Pet8\", \"Pet9\", \"Pet12_16\", \"Pet15\", \"Pet16_17\", \"Pet17\")\nflip_chrs &lt;- c(\"Pet9\")\nmap_list &lt;- make_one_map(ann_pet_map, map1_max_chr_lengths = ann_chr_lengths, map2_chr_order = map2_chr_order, flip_chrs = flip_chrs)\nplot_maps(map_df = map_list[[1]], map1_chrom_breaks = map_list[[2]], map2_chrom_breaks = map_list[[3]])\n\n\n\n\n\n\n\n图 2: 调整图谱顺序\n\n\n\n\n\n\n\n2. 确定最佳翻转参数\nsyntR 算法的关键调整参数是 max_cluster_range（CR max），其次是 max_nn_dist（NN dist）。max_cluster_range 决定了标记群的最大大小，这些标记群将被折叠成一个单点以便进一步分析。它定义了聚类标记所能跨越的最大距离。max_cluster_range 的值越大，将有越多的标记集结成一个点。\nmax_nn_dist 决定哪些标记被视为异常值，并从进一步分析中剔除。在 max_nn_dist 范围内没有相邻标记的标记被视为异常值。max_nn_dist 值越大，被移除的标记越少。 找到这两个参数最佳组合的简单方法是拟合这两个参数的取值范围，并选择能使两个图谱的覆盖率（分配给同源区块的图谱百分比）最大化和离群值数量最小化的取值（下图中的 “综合”是这些指标的比例总和）。\n选择最佳的CR max 和 NN dist 的方法：(1) 使用一系列参数组合运行 syntR；(2) 保存关于在同源区块中代表的每个图谱的遗传距离和每次运行保留的标记数的汇总统计；(3) 找到能最大化平均加权这三个测量值的复合统计的参数组合。在存在多个局部最大值的情况下，选择 CR max 值最小的局部最大值，以减少潜在假阳性的数量。\n可以使用 max_cluster_range = 2 和 max_nn_dist = 10 的默认值跳过这一步。这一参数可能非常适合大多数遗传图谱。\n\n# 寻找最佳参数组合\n# 使用每个参数组合运行 find_synteny_blocks 并收集汇总统计数据\n\nparameter_data &lt;- test_parameters(map_list, max_cluster_range_list = seq(1, 5, by = 0.5), max_nn_dist_list = seq(10, 50, by = 10))\nplot_summary_stats(parameter_data[[1]], \"composite\")\n\n\n\n\n\n\n\n图 3: 确定最佳翻转参数\n\n\n\n\n\n在本例中，选择 max_cluster_range 为 2， max_nn_dsit 为 10。\n\n\n3. 识别同源区块\n确定两个调整参数后，我们就可以运行 syntR 的主要功能：find_synteny_blocks。 该函数将一组标记数据（包含在我们之前创建的 map_list 对象中）通过 Ostevik 等人描述的算法进行错误检测和同源区块识别。 运行方法如下：\n\n# 识别同源区块\nsynt_blocks &lt;- find_synteny_blocks(map_list, max_cluster_range = 2, max_nn_dist = 10, plots = TRUE)\n\n\n\n\n\n\n\n图 4: 识别同源区块\n\n\n\n\n\n\n\n\n\n\n\n图 5: 识别同源区块\n\n\n\n\n\n\n\n\n\n\n\n图 6: 识别同源区块\n\n\n\n\n\n当 plots=TRUE 时，函数会生成三幅图，显示算法的进展情况。在第一幅图中，映射误差通过预聚类步骤进行平滑处理。接下来，异常值会被标记和移除。最后，通过 syntR 之友聚类算法确定同源区块。\nfind_synteny_blocks 输出一个包含五个数据框的列表对象：\n\n# 打印 synt_blocks 的内容\n\nlapply(synt_blocks, head)\n\n$marker_df\n             map1_name map1_chr map1_pos map1_posfull            map2_name\n1 HanXRQChr12_10463750    Ann12 23.33200     223.4720 HanXRQChr12_10463750\n2 HanXRQChr12_10463069    Ann12 23.33091     223.4709 HanXRQChr12_10463069\n3 HanXRQChr12_67274477    Ann12 51.14234     251.2823 HanXRQChr12_67274477\n4 HanXRQChr12_11545866    Ann12 25.01880     225.1588 HanXRQChr12_11545866\n5 HanXRQChr12_11545707    Ann12 25.01856     225.1586 HanXRQChr12_11545707\n6  HanXRQChr12_9937279    Ann12 22.47337     222.6134  HanXRQChr12_9937279\n  map2_chr map2_pos map2_posfull cluster block final_block orientation\n1 Pet12_16 0.000000     283.4780       1     2           2    positive\n2 Pet12_16 3.660274     287.1382       2     2           2    positive\n3 Pet12_16 3.660274     287.1382       3  &lt;NA&gt;          NA     outlier\n4 Pet12_16 3.660274     287.1382       4     2           2    positive\n5 Pet12_16 3.660274     287.1382       4     2           2    positive\n6 Pet12_16 4.567248     288.0452       2     2           2    positive\n\n$synteny_blocks_df\n  block map1_chr map1_start  map1_end map2_chr map2_start  map2_end\n1     5    Ann08   0.307917  3.096819     Pet8    0.00000  5.872578\n2     6    Ann08   7.970652 11.630196     Pet8   12.06862 28.437648\n3     7    Ann08  15.356354 22.979486     Pet8   28.43765 38.207576\n4     8    Ann08  24.903278 28.616233     Pet8   38.20758 43.602465\n5     9    Ann08  32.578270 34.839079     Pet8   48.02882 50.686116\n6    10    Ann08  29.056599 32.577711     Pet8   51.58404 59.123579\n   orientation\n1     negative\n2     positive\n3     negative\n4     positive\n5 unclassified\n6     negative\n\n$map1_breaks\n      start       end\n1  3.096819  7.970652\n2 11.630196 15.356354\n3 22.979486 24.903278\n4 28.616233 29.056599\n5 32.577711 32.578270\n6 34.839079 37.529721\n\n$map2_breaks\n      start      end\n1  5.872578 12.06862\n2 28.437648 28.43765\n3 38.207576 38.20758\n4 43.602465 48.02882\n5 50.686116 51.58404\n6 59.123579 59.12358\n\n$summary_stats\n  num_blocks map1_coverage map2_coverage n_outliers\n1         41      382.8091      567.0453        205\n\n\n这些要素是：\n\n$marker_df 数据框，包括标记原始列表及其同源区块分配。\n$synteny_blocks_df 一个数据框，概括了每张地图中每个同源区块的跨度（以地图单元为单位），以及具有充分方向性证据的同源区块的推断方向（并列、倒置等）。\n$map1_breaks 一个数据框，列出了 map1 中合成组块之间的断点。\n$map2_breaks 一个数据框，列出了 map2 中合成组块之间的断点。\n$summary_stats 总结算法结果（覆盖率等）的数据框\n\n可以如下图所示绘制出图块的方向：\n\n# 绘制出图块的方向\nsynt_blocks[[1]] %&gt;%\n    plot_maps(map_list[[2]], map_list[[3]], col = c(\"blue\", \"grey\", \"red\", \"black\")[as.numeric(as.factor(.$orientation))], \n              main = \"Synteny block orientation\",  cex_val = 0.75)\n\n\n\n\n\n\n\n图 7: 绘制出图块的方向\n\n\n\n\n\n在这种情况下，蓝色 = 倒置，红色 = 同线，灰色/黑色 = 未分类。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "SyntenyBlocksPlot"
    ]
  },
  {
    "objectID": "Omics/SyntenyBlocksPlot.html#应用场景",
    "href": "Omics/SyntenyBlocksPlot.html#应用场景",
    "title": "共线性块图",
    "section": "应用场景",
    "text": "应用场景\n\n\n\n\n\n\n图 8: 共线性块图应用",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "SyntenyBlocksPlot"
    ]
  },
  {
    "objectID": "Omics/SyntenyBlocksPlot.html#参考文献",
    "href": "Omics/SyntenyBlocksPlot.html#参考文献",
    "title": "共线性块图",
    "section": "参考文献",
    "text": "参考文献\n[1] Ostevik, Kate L., Kieran Samuk, and Loren H. Rieseberg. “Ancestral reconstruction of karyotypes reveals an exceptional rate of nonrandom chromosomal evolution in sunflower.” Genetics 214, no. 4 (2020): 1031-1045.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "SyntenyBlocksPlot"
    ]
  },
  {
    "objectID": "Omics/NetworkPlot.html",
    "href": "Omics/NetworkPlot.html",
    "title": "网络图",
    "section": "",
    "text": "在微生物组学研究中，理解微生物之间的相互作用至关重要。而网络分析作为一种强大的方法，能够帮助我们可视化和量化这些复杂关系。接下来向大家介绍 MetaNet 包的网络操作与注释功能，它能让我们的网络分析更加深入和直观。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "NetworkPlot"
    ]
  },
  {
    "objectID": "Omics/NetworkPlot.html#示例",
    "href": "Omics/NetworkPlot.html#示例",
    "title": "网络图",
    "section": "示例",
    "text": "示例",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "NetworkPlot"
    ]
  },
  {
    "objectID": "Omics/NetworkPlot.html#环境配置",
    "href": "Omics/NetworkPlot.html#环境配置",
    "title": "网络图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：MetaNet; pcutils; igraph; dplyr\n\n\n# 安装包\nif (!requireNamespace(\"MetaNet\", quietly = TRUE)) {\n  install.packages(\"MetaNet\")\n}\nif (!requireNamespace(\"pcutils\", quietly = TRUE)) {\n  install.packages(\"pcutils\")\n}\nif (!requireNamespace(\"igraph\", quietly = TRUE)) {\n  install.packages(\"igraph\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\n\n# 加载包\nlibrary(MetaNet)\nlibrary(pcutils)\nlibrary(igraph)\nlibrary(dplyr)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package * version date (UTC) lib source\n dplyr   * 1.1.4   2023-11-17 [1] RSPM\n igraph  * 2.2.1   2025-10-27 [1] RSPM\n MetaNet * 0.2.7   2025-06-26 [1] RSPM\n pcutils * 0.2.8   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "NetworkPlot"
    ]
  },
  {
    "objectID": "Omics/NetworkPlot.html#数据准备",
    "href": "Omics/NetworkPlot.html#数据准备",
    "title": "网络图",
    "section": "数据准备",
    "text": "数据准备\n\n1. 导入数据\n\n数据使用 pcutils 中的 otutab 数据集\nMetaNet 是一个针对组学数据的综合网络分析 R 包\nc_net_calculate() 函数用于快速计算变量间的相关性\nc_net_build() 函数用于构建网络\n\n\ndata(otutab, package = \"pcutils\")\nt(otutab) -&gt; totu\nc_net_calculate(totu, method = \"spearman\") -&gt; corr\nc_net_build(corr, r_threshold = 0.6, p_threshold = 0.05, delete_single = T) -&gt; co_net\nclass(co_net) \n\n[1] \"metanet\" \"igraph\" \n\n\n\n\n2. 获取网络属性\n用 MetaNet 构建网络后，得到的是一个分类对象，它来自 igraph。意味着可以同时使用 MetaNet 的专有功能和 igraph 的通用功能。接下来了解如何获取网络的基本信息：\n\n# 获取整体网络属性\nget_n(co_net)\n\n  n_type\n1 single\n\n# 查看节点(顶点)属性\nget_v(co_net) %&gt;% head(5)\n\n                          name  v_group  v_class size\n1 s__un_f__Thermomonosporaceae v_group1 v_class1    4\n2        s__Pelomonas_puraquae v_group1 v_class1    4\n3     s__Rhizobacter_bergeniae v_group1 v_class1    4\n4     s__Flavobacterium_terrae v_group1 v_class1    4\n5         s__un_g__Rhizobacter v_group1 v_class1    4\n                         label  shape   color\n1 s__un_f__Thermomonosporaceae circle #a6bce3\n2        s__Pelomonas_puraquae circle #a6bce3\n3     s__Rhizobacter_bergeniae circle #a6bce3\n4     s__Flavobacterium_terrae circle #a6bce3\n5         s__un_g__Rhizobacter circle #a6bce3\n\n### 查看边属性\nget_e(co_net) %&gt;% head(5)\n\n  id                         from                            to    weight\n1  1 s__un_f__Thermomonosporaceae     s__Actinocorallia_herbida 0.6759546\n2  2 s__un_f__Thermomonosporaceae       s__Kribbella_catacumbae 0.6742386\n3  3 s__un_f__Thermomonosporaceae       s__Kineosporia_rhamnosa 0.7378741\n4  4 s__un_f__Thermomonosporaceae   s__un_f__Micromonosporaceae 0.6236449\n5  5 s__un_f__Thermomonosporaceae s__Flavobacterium_saliperosum 0.6045747\n        cor      p.value   e_type     width   color  e_class lty\n1 0.6759546 0.0020739524 positive 0.6759546 #48A4F0 e_class1   1\n2 0.6742386 0.0021502138 positive 0.6742386 #48A4F0 e_class1   1\n3 0.7378741 0.0004730567 positive 0.7378741 #48A4F0 e_class1   1\n4 0.6236449 0.0056818984 positive 0.6236449 #48A4F0 e_class1   1\n5 0.6045747 0.0078660171 positive 0.6045747 #48A4F0 e_class1   1\n\n\n这些函数返回的数据框包含了最基本的多组学生物网络的关键信息，如节点名称、分组、大小、边的权重等。 MetaNet 在构建网络时已经设置了一些内部属性（如v_group、v_class、e_type等），这些属性将影响后续的分析和可视化。\n\n\n3. 为网络添加生物学意义\n在微生物组研究中，仅有网络结构是不够的，我们需要整合分类学、丰度等生物学信息。MetaNet 提供了灵活的注释功能：\n\n# 向节点添加分类信息\nc_net_annotate(co_net, taxonomy[\"Phylum\"], mode = \"v\") -&gt; co_net1\nanno &lt;- data.frame(\"from\" = \"s__un_f__Thermomonosporaceae\", \n                   \"to\" = \"s__Actinocorallia_herbida\", new_atr = \"new\")\nc_net_annotate(co_net, anno, mode = \"e\") -&gt; co_net1\n\n在 MetaNet 中提供 c_net_set() 函数，它可以同时添加多个注释表并指定哪些列用于设置节点大小、颜色等属性：\n\nAbundance_df &lt;- data.frame(\"Abundance\" = colSums(totu))\nco_net1 &lt;- c_net_set(co_net, taxonomy[\"Phylum\"], Abundance_df)\nco_net1 &lt;- co_net\nV(co_net1)$new_attri &lt;- seq_len(length(co_net1))\nE(co_net1)$new_attri &lt;- \"new attribute\"\nget_e(co_net1) %&gt;% head(5)\n\n  id                         from                            to    weight\n1  1 s__un_f__Thermomonosporaceae     s__Actinocorallia_herbida 0.6759546\n2  2 s__un_f__Thermomonosporaceae       s__Kribbella_catacumbae 0.6742386\n3  3 s__un_f__Thermomonosporaceae       s__Kineosporia_rhamnosa 0.7378741\n4  4 s__un_f__Thermomonosporaceae   s__un_f__Micromonosporaceae 0.6236449\n5  5 s__un_f__Thermomonosporaceae s__Flavobacterium_saliperosum 0.6045747\n        cor      p.value   e_type     width   color  e_class lty     new_attri\n1 0.6759546 0.0020739524 positive 0.6759546 #48A4F0 e_class1   1 new attribute\n2 0.6742386 0.0021502138 positive 0.6742386 #48A4F0 e_class1   1 new attribute\n3 0.7378741 0.0004730567 positive 0.7378741 #48A4F0 e_class1   1 new attribute\n4 0.6236449 0.0056818984 positive 0.6236449 #48A4F0 e_class1   1 new attribute\n5 0.6045747 0.0078660171 positive 0.6045747 #48A4F0 e_class1   1 new attribute\n\n\n这样，就能获得一个既有统计意义又有生物学背景的网络信息。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "NetworkPlot"
    ]
  },
  {
    "objectID": "Omics/NetworkPlot.html#可视化",
    "href": "Omics/NetworkPlot.html#可视化",
    "title": "网络图",
    "section": "可视化",
    "text": "可视化\n\n1. 构建网络\n简单多组学网络：包含微生物组，代谢组，转录组等信息。\n\n# 基础网络图\ndata(\"multi_test\", package = \"MetaNet\")\ndata(\"c_net\", package = \"MetaNet\")\nmulti1 &lt;- multi_net_build(list(Microbiome = micro, Metabolome = metab, Transcriptome = transc))\nplot(multi1)\n\n\n\n\n基础网络图\n\n\n\n\n\n\n2. 添加 annotation\n\n# 设置顶点类别\nmulti1_with_anno &lt;- c_net_set(multi1, \n                              micro_g, metab_g, \n                              transc_g, \n                              vertex_class = c(\"Phylum\", \"kingdom\", \"type\"))\n\n# 设置顶点大小\nmulti1_with_anno &lt;- c_net_set(multi1_with_anno,\n                              data.frame(\"Abundance1\" = colSums(micro)),\n                              data.frame(\"Abundance2\" = colSums(metab)),\n                              data.frame(\"Abundance3\" = colSums(transc)),\n                              vertex_size = paste0(\"Abundance\", 1:3))\n\nplot(multi1_with_anno)\n\n\n\n\n添加 annotation\n\n\n\n\n\n\n3. 筛选子网络\n\n# 筛选子网络\ndata(\"multi_net\", package = \"MetaNet\")\nmulti2 &lt;- c_net_filter(multi1_with_anno, v_group %in% \n                         c(\"Microbiome\", \"Metabolome\")) %&gt;%\n  c_net_filter(., e_class == \"intra\", mode = \"e\")\n\nplot(multi2, lty_legend = T, main = \"Sub-network\") \n\n\n\n\n筛选子网络\n\n\n\n\n\n\n4. 合并网络\n\n# 网络1\ndata(\"c_net\")\nplot(co_net)\n\n\n\n\n网络1\n\n\n\n\n\n# 网络2\ndata(\"c_net\")\nplot(co_net2)\n\n\n\n\n网络2\n\n\n\n\n\n# 合并网络\nco_net_union &lt;- c_net_union(co_net, co_net2)\nplot(co_net_union)\n\n\n\n\n合并网络\n\n\n\n\nMetaNet 包为微生物网络分析提供了全面的工具集，从基础的网络构建到高级的注释与可视化。通过灵活使用这些功能，我们能够从复杂的微生物组数据中提取有意义的生物学模式，为理解微生物群落结构与功能提供新视角。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "NetworkPlot"
    ]
  },
  {
    "objectID": "Omics/NetworkPlot.html#参考文献",
    "href": "Omics/NetworkPlot.html#参考文献",
    "title": "网络图",
    "section": "参考文献",
    "text": "参考文献\n[1] K. Contrepois, S. Wu, K. J. Moneghetti, D. Hornburg, et al., [Molecular Choreography of Acute Exercise (https://doi.org/10.1016/j.cell.2020.04.043). Cell. 181, 1112–1130.e16 (2020).\n[2] Y. Deng, Y. Jiang, Y. Yang, Z. He, et al., Molecular ecological network analyses. BMC bioinformatics (2012), doi:10.1186/1471-2105-13-113.\n[3] K. Faust, J. Raes, Microbial interactions: From networks to models. Nature Reviews Microbiology (2012), doi:10.1038/nrmicro2832.\n[4] Chen Peng (2025). MetaNet: Network Analysis for Omics Data. R package",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "NetworkPlot"
    ]
  },
  {
    "objectID": "Omics/CollinearityPlot.html",
    "href": "Omics/CollinearityPlot.html",
    "title": "共线性图",
    "section": "",
    "text": "共线性图（Collinearity Plot）常用于比较不同物种的基因组序列，识别保守的同源基因区块及其排列顺序，揭示进化过程中染色体结构的变化。该图广泛应用于研究基因组进化、功能基因定位及物种亲缘关系分析等。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "CollinearityPlot"
    ]
  },
  {
    "objectID": "Omics/CollinearityPlot.html#示例",
    "href": "Omics/CollinearityPlot.html#示例",
    "title": "共线性图",
    "section": "示例",
    "text": "示例\n\n\n\n\n\n该图为三元基因组的共线性图，其中 Amborella、Grape、Liriodendron 表示三个不同的物种，长条代表基因组，数字为染色体编号，连线表示不同的物种基因组之间的比较。高亮的连线表示感兴趣的基因组区域的比较。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "CollinearityPlot"
    ]
  },
  {
    "objectID": "Omics/CollinearityPlot.html#环境配置",
    "href": "Omics/CollinearityPlot.html#环境配置",
    "title": "共线性图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: 跨平台（Linux/MacOS/Windows）\n编程语言: R\n依赖包: RIdeogram\n\n\n# 安装包\nif (!requireNamespace(\"RIdeogram\", quietly = TRUE)) {\n  install.packages(\"RIdeogram\")\n}\n\n# 加载包\nlibrary(RIdeogram)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package   * version date (UTC) lib source\n RIdeogram * 0.2.2   2020-01-20 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "CollinearityPlot"
    ]
  },
  {
    "objectID": "Omics/CollinearityPlot.html#数据准备",
    "href": "Omics/CollinearityPlot.html#数据准备",
    "title": "共线性图",
    "section": "数据准备",
    "text": "数据准备\n我们导入 RIdeogram 包中提供的示例数据，karyotype_ternary_comparison 中包含了不同的物种以及基因组信息，synteny_ternary_comparison 中包含了不同物种之间基因组的比较信息。\n\ndata(karyotype_ternary_comparison, package=\"RIdeogram\")\ndata(synteny_ternary_comparison, package=\"RIdeogram\")\n\n\n# 查看 karyotype_ternary_comparison 数据格式\nhead(karyotype_ternary_comparison)\n\n  Chr Start      End   fill   species size  color\n1  NA     1 15980527 fcb06b Amborella   10 fcb06b\n2  NA     1 11522362 fcb06b Amborella   10 fcb06b\n3  NA     1 11085951 fcb06b Amborella   10 fcb06b\n4  NA     1 10537363 fcb06b Amborella   10 fcb06b\n5  NA     1  9585472 fcb06b Amborella   10 fcb06b\n6  NA     1  9414115 fcb06b Amborella   10 fcb06b\n\n\n\n# 查看 synteny_ternary_comparison 数据格式\nhead(synteny_ternary_comparison)\n\n  Species_1 Start_2   End_2 Species_2  Start_1    End_1   fill type\n1         1 4761181 2609697         1   342802   981451 cccccc    1\n2         6 6344197 8074393         1 15387184 16716190 cccccc    1\n3        10 6457890 9052487         1 11224953 14959548 cccccc    1\n4        13 6318795 1295413         1 20564870 21386271 cccccc    1\n5        16 1398101 2884119         1 21108654 22221088 cccccc    1\n6        16 1482529 2093625         1 21864494 22364888 cccccc    1",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "CollinearityPlot"
    ]
  },
  {
    "objectID": "Omics/CollinearityPlot.html#可视化",
    "href": "Omics/CollinearityPlot.html#可视化",
    "title": "共线性图",
    "section": "可视化",
    "text": "可视化\n\n1. 基础绘图\n可以使用 RIdeogram 包中提供的 ideogram 函数绘制共线性图。\n\n# 基础共线性图\nideogram(karyotype = karyotype_ternary_comparison, synteny = synteny_ternary_comparison)\nconvertSVG(\"chromosome.svg\", device = \"png\")\n\n\n\n\n\n\n\n图 1: 基础共线性图\n\n\n\n\n\n\n\n\n\n提示\n\n\n\n关键参数: \n\nkaryotype：包含不同物种以及基因组信息的表格，数据结构如 karyotype_ternary_comparison 所示。\noverlaid：包含了不同物种之间基因组比较信息的表格，数据结构如 synteny_ternary_comparison 所示。\n\n\n\n\n\n2. 修改颜色\n如果您想对修改绘图的颜色，只需修改 karyotype 和 overlaid 表格中的颜色列。如下所示，我们修改了 karyotype_ternary_comparison 表格中的 color 和 fill 列，以及 synteny_ternary_comparison 中的 fill 列。\n\n# 修改三个物种颜色\nchange_color1 &lt;- c(\"fcb06b\"=\"ff0000\", \"078dd8\"=\"00ff00\", \"139b08\"=\"0000ff\")\nkaryotype_ternary_comparison$color &lt;- as.character(change_color1[karyotype_ternary_comparison$color])\nkaryotype_ternary_comparison$fill &lt;- as.character(change_color1[karyotype_ternary_comparison$fill])\n\n# 修改连线颜色\nchange_color2 &lt;- c(\"cccccc\"=\"add8e6\", \"e41a1c\"=\"8b0000\")\nsynteny_ternary_comparison$fill &lt;- as.character(change_color2[synteny_ternary_comparison$fill])\n\n# 绘图\nideogram(karyotype = karyotype_ternary_comparison, synteny = synteny_ternary_comparison)\n\n\n\n\n\n\n\n图 2: 修改颜色",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "CollinearityPlot"
    ]
  },
  {
    "objectID": "Omics/CollinearityPlot.html#应用",
    "href": "Omics/CollinearityPlot.html#应用",
    "title": "共线性图",
    "section": "应用",
    "text": "应用\n\n\n\n\n\n\n图 3: 共线性图应用\n\n\n\n该图展示了 R2R3-MYB 基因在 B. napus 和 3 个祖先植物物种中的同源关系。图中显示了 Arabidopsis (A. thaliana)、Brassica rapa (B. rapa)、Brassica oleracea (B. oleracea)、Brassica napus (B. napus) 之间的共线性。[1]",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "CollinearityPlot"
    ]
  },
  {
    "objectID": "Omics/CollinearityPlot.html#参考资料",
    "href": "Omics/CollinearityPlot.html#参考资料",
    "title": "共线性图",
    "section": "参考资料",
    "text": "参考资料\n[1] Luo D, Mei D, Wei W, Liu J. Identification and Phylogenetic Analysis of the R2R3-MYB Subfamily in Brassica napus. Plants (Basel). 2023;12(4):886. Published 2023 Feb 16. doi:10.3390/plants12040886",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> 𝐎𝐌𝐈𝐂𝐒",
      "CollinearityPlot"
    ]
  },
  {
    "objectID": "About.html",
    "href": "About.html",
    "title": "关于我们",
    "section": "",
    "text": "Bizard（白泽） 是一个致力于生物医学数据可视化的开源社区项目，由罗鹏、王诗翔、李剑峰、曾健明等研究者共同发起。项目名称源自中国古代神话中的神兽“白泽”，传说它通晓万物，曾为黄帝作鬼神图鉴，象征着对知识的广泛掌握与信息的可视化表达。\n我们希望搭建一个协作主导、社区参与的生物医学可视化开源平台，为学习、应用与讨论数据可视化提供一体化空间，构建国内外独具特色的生物信息学基础设施。",
    "crumbs": [
      "<i class='fa-solid fa-people-group'></i> About Us"
    ]
  },
  {
    "objectID": "About.html#项目简介",
    "href": "About.html#项目简介",
    "title": "关于我们",
    "section": "",
    "text": "Bizard（白泽） 是一个致力于生物医学数据可视化的开源社区项目，由罗鹏、王诗翔、李剑峰、曾健明等研究者共同发起。项目名称源自中国古代神话中的神兽“白泽”，传说它通晓万物，曾为黄帝作鬼神图鉴，象征着对知识的广泛掌握与信息的可视化表达。\n我们希望搭建一个协作主导、社区参与的生物医学可视化开源平台，为学习、应用与讨论数据可视化提供一体化空间，构建国内外独具特色的生物信息学基础设施。",
    "crumbs": [
      "<i class='fa-solid fa-people-group'></i> About Us"
    ]
  },
  {
    "objectID": "About.html#项目愿景",
    "href": "About.html#项目愿景",
    "title": "关于我们",
    "section": "🎯 项目愿景",
    "text": "🎯 项目愿景\n在数据驱动的生物医学研究时代，可视化是连接数据与科学故事的桥梁。尽管已有众多图形界面软件和生信云平台，可重复研究仍是科研发展的重要方向。对于初学者而言，编程与绘图的学习曲线陡峭，相关资料分散，实践应用困难。\nBizard项目希望通过以下方式解决这些问题：\n\n提供系统、实用、可复现的绘图教程；\n构建开放、协作、可持续的社区生态；\n推动R、Python等语言在生物医学中的深入应用；\n打造理论与实践结合的学习平台，降低学习门槛。",
    "crumbs": [
      "<i class='fa-solid fa-people-group'></i> About Us"
    ]
  },
  {
    "objectID": "About.html#核心特色",
    "href": "About.html#核心特色",
    "title": "关于我们",
    "section": "🧬 核心特色",
    "text": "🧬 核心特色\n\n🔓 开源协作：所有代码与文档在 GitHub 公开维护\n📘 理论+实践：每个教程含代码解析与生物学背景说明\n🌍 社区共建：联合国内外可视化爱好者共同创作\n📚 持续更新：根据更新发布预印本，定期迭代内容\n🧑‍🔬 学术共享：贡献者按实际贡献署名，推动开放科学",
    "crumbs": [
      "<i class='fa-solid fa-people-group'></i> About Us"
    ]
  },
  {
    "objectID": "About.html#技术路线",
    "href": "About.html#技术路线",
    "title": "关于我们",
    "section": "🛠️ 技术路线",
    "text": "🛠️ 技术路线\n\n语言基础：初期以 R 语言为主，逐步扩展至 Python 等语言；\n内容来源：基于 The R Graph Gallery 等经典案例；\n应用场景：结合真实生物医学数据，提供可复现的绘图流程；\n教学形式：每个案例包括代码、图表、生物学背景、使用建议等模块。",
    "crumbs": [
      "<i class='fa-solid fa-people-group'></i> About Us"
    ]
  },
  {
    "objectID": "About.html#社区与协作",
    "href": "About.html#社区与协作",
    "title": "关于我们",
    "section": "🤝 社区与协作",
    "text": "🤝 社区与协作\nBizard 与 Openbiox 生信开源社区深度协作，致力于：\n\n建立开放、透明、包容的社区文化；\n鼓励多元背景成员参与内容创作与项目共建；\n促进知识分享与技术交流；\n形成成员-贡献-成果的可持续更新机制。",
    "crumbs": [
      "<i class='fa-solid fa-people-group'></i> About Us"
    ]
  },
  {
    "objectID": "About.html#加入我们",
    "href": "About.html#加入我们",
    "title": "关于我们",
    "section": "📬 加入我们",
    "text": "📬 加入我们\n我们诚挚邀请对以下方向感兴趣的你加入，随时都可以通过 GitHub 进行交流和贡献：\n\n生物医学数据可视化；\n开源协作与开放科学；\n教程撰写与代码贡献；\n社区运营与内容翻译。\n\n如有需要与合作，请联系项目核心负责人：\n\n罗鹏：luopeng@smu.edu.cn\n\n王诗翔：wangshx@csu.edu.cn",
    "crumbs": [
      "<i class='fa-solid fa-people-group'></i> About Us"
    ]
  },
  {
    "objectID": "About.html#项目链接",
    "href": "About.html#项目链接",
    "title": "关于我们",
    "section": "📎 项目链接",
    "text": "📎 项目链接\n\n🌐 项目主页：https://openbiox.github.io/Bizard/\n📂 GitHub 仓库：https://github.com/openbiox/Bizard\n📄 预印本论文：https://arxiv.org/abs/2503.06845\n\n\n\n🌱 Bizard（白泽），让可视化成为生物医学研究的通用语言。",
    "crumbs": [
      "<i class='fa-solid fa-people-group'></i> About Us"
    ]
  },
  {
    "objectID": "Hiplot/171-time-roc.html",
    "href": "Hiplot/171-time-roc.html",
    "title": "时间依赖 ROC",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Time ROC 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/time-roc?lang=zh_cn\n生存分析中受试者操作特征（ROC）与时间记录分析。",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Time ROC"
    ]
  },
  {
    "objectID": "Hiplot/171-time-roc.html#环境配置",
    "href": "Hiplot/171-time-roc.html#环境配置",
    "title": "时间依赖 ROC",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; plotROC; survivalROC; ggplot2; grid\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"plotROC\", quietly = TRUE)) {\n  install.packages(\"plotROC\")\n}\nif (!requireNamespace(\"survivalROC\", quietly = TRUE)) {\n  install.packages(\"survivalROC\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"grid\", quietly = TRUE)) {\n  install.packages(\"grid\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(plotROC)\nlibrary(survivalROC)\nlibrary(ggplot2)\nlibrary(grid)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package     * version date (UTC) lib source\n data.table  * 1.17.8  2025-07-10 [1] RSPM\n ggplot2     * 4.0.1   2025-11-14 [1] RSPM\n jsonlite    * 2.0.0   2025-03-27 [1] RSPM\n plotROC     * 2.3.3   2025-08-25 [1] RSPM\n survivalROC * 1.0.3.1 2022-12-05 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Time ROC"
    ]
  },
  {
    "objectID": "Hiplot/171-time-roc.html#数据准备",
    "href": "Hiplot/171-time-roc.html#数据准备",
    "title": "时间依赖 ROC",
    "section": "数据准备",
    "text": "数据准备\n\n&lt;表1&gt;：（数字）生存数据（即生存，风险）。\n&lt;表2&gt;：（数字）时间数据。\n\n\n# 加载数据\ndata1 &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/time-roc/data.json\")$exampleData$textarea[[1]])\ndata1 &lt;- as.data.frame(data1)\ndata2 &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/time-roc/data.json\")$exampleData$textarea[[2]])\ndata2 &lt;- as.data.frame(data2)\n\n# 整理数据格式\nsurv_table &lt;- data1\ncolnames(surv_table) &lt;- c(\"surv\", \"cens\", \"risk\")\nmtime &lt;- as.data.frame(data2)[, 1]\nsroc &lt;- lapply(mtime, function(t) {\n  stroc &lt;- survivalROC(\n    Stime = surv_table$surv,\n    status = surv_table$cens,\n    marker = surv_table$risk,\n    predict.time = t,\n    method = \"KM\"\n  )\n  data.frame(\n    TPF = stroc[[\"TP\"]],\n    FPF = stroc[[\"FP\"]],\n    cut = stroc[[\"cut.values\"]],\n    time = rep(\n      stroc[[\"predict.time\"]],\n      length(stroc[[\"TP\"]])\n    ),\n    AUC = rep(\n      stroc$AUC,\n      length(stroc$FP)\n    )\n  )\n})\nmroc &lt;- do.call(rbind, sroc)\nmroc$time &lt;- factor(mroc$time)\n\n# 查看数据\nhead(data1)\n\n       surv cens       risk\n1 11.126027    0 0.19205450\n2  9.794521    0 0.47734974\n3 13.690411    0 0.04605343\n4 10.068493    0 0.29717146\n5  3.317808    0 0.18144610\n6 12.312329    0 0.62681895\n\nhead(data2)\n\n  times\n1     2\n2     4\n3     6\n4     8\n5    10",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Time ROC"
    ]
  },
  {
    "objectID": "Hiplot/171-time-roc.html#可视化",
    "href": "Hiplot/171-time-roc.html#可视化",
    "title": "时间依赖 ROC",
    "section": "可视化",
    "text": "可视化\n\n# 时间依赖 ROC\ncol &lt;- c(\"#E64B35FF\",\"#4DBBD5FF\",\"#00A087FF\",\"#3C5488FF\",\"#F39B7FFF\")\np &lt;- ggplot(mroc, aes(x = FPF, y = TPF, label = cut, color = time)) +\n  plotROC::geom_roc(labels = FALSE, stat = \"identity\", n.cuts = 0) +\n  geom_abline(slope = 1, intercept = 0, color = \"red\", linetype = 2) +\n  labs(title = \"ROC Dependence Time\", x = \"False positive rate\",\n       y = \"True positive rate\", \n       color = paste(\"Time\", \"(\", \"Year\", \")\")) +\n  theme_bw() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12, hjust = 0.5),\n        axis.title = element_text(size = 10),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10)) +\n  scale_color_manual(values = col)\n\nauc &lt;- levels(factor(mroc$AUC))\nfor (i in 1:length(auc)) {\n  p &lt;- p + annotate(\"text\",\n    x = 0.75,\n    y = 0.05 + 0.05 * i, ## 注释text的位置\n    col = col[i],\n    label = paste(\n      paste(paste(mtime[i], \"Year\", sep = \" \"), \" = \"),\n      round(as.numeric(auc[i]), 2)\n    )\n  )\n}\n\np\n\n\n\n\n\n\n\n图 1: 时间依赖 ROC",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Time ROC"
    ]
  },
  {
    "objectID": "Hiplot/157-rose-chart.html",
    "href": "Hiplot/157-rose-chart.html",
    "title": "玫瑰图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Rose Chart 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/rose-chart?lang=zh_cn\n玫瑰图是一种在极坐标下绘制的柱形图，使用圆弧的半径长短表示数据的大小。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Rose Chart"
    ]
  },
  {
    "objectID": "Hiplot/157-rose-chart.html#环境配置",
    "href": "Hiplot/157-rose-chart.html#环境配置",
    "title": "玫瑰图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Rose Chart"
    ]
  },
  {
    "objectID": "Hiplot/157-rose-chart.html#数据准备",
    "href": "Hiplot/157-rose-chart.html#数据准备",
    "title": "玫瑰图",
    "section": "数据准备",
    "text": "数据准备\n载入数据为分为三列，第一列是样本名称，第二列为分组，第三列为样本对应的数值。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/rose-chart/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndata[, 2] &lt;- factor(data[, 2], levels = unique(data[, 2]))\n\n# 查看数据\nhead(data)\n\n    Sample       Group Freq\n1    Brain Upregulated  142\n2    Colon Upregulated  270\n3   Kidney Upregulated  108\n4 Pancreas Upregulated  194\n5     Skin Upregulated  189\n6   Testis Upregulated   97",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Rose Chart"
    ]
  },
  {
    "objectID": "Hiplot/157-rose-chart.html#可视化",
    "href": "Hiplot/157-rose-chart.html#可视化",
    "title": "玫瑰图",
    "section": "可视化",
    "text": "可视化\n\n# 玫瑰图\np &lt;- ggplot(data, aes(x = Sample, y = Freq)) +\n  geom_col(aes(fill = Group), width = 0.9, size = 0, alpha = 0.8) +\n  coord_polar() +\n  ggtitle(\"Rose Chart\") +\n  scale_fill_manual(values = c(\"#E64B35FF\", \"#4DBBD5FF\")) +\n  theme_bw() +\n  theme(aspect.ratio = 1,\n        axis.text.x = element_text(colour = \"black\"),\n        axis.text.y = element_text(colour = \"black\"),\n        legend.title = element_blank(),\n        legend.position = \"bottom\",\n        plot.title = element_text(hjust = 0.5))\n\np\n\n\n\n\n\n\n\n图 1: 玫瑰图\n\n\n\n\n\n案例数据中是使用scRNA-Seq对人类不同器官进行测序后，得到的不同器官上下调基因的分布情况。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Rose Chart"
    ]
  },
  {
    "objectID": "Hiplot/168-streamgraph.html",
    "href": "Hiplot/168-streamgraph.html",
    "title": "流动图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Streamgraph 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/streamgraph?lang=zh_cn",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Streamgraph"
    ]
  },
  {
    "objectID": "Hiplot/168-streamgraph.html#环境配置",
    "href": "Hiplot/168-streamgraph.html#环境配置",
    "title": "流动图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; streamgraph\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"streamgraph\", quietly = TRUE)) {\n  remotes::install_github(\"hrbrmstr/streamgraph\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(streamgraph)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package     * version date (UTC) lib source\n data.table  * 1.17.8  2025-07-10 [1] RSPM\n jsonlite    * 2.0.0   2025-03-27 [1] RSPM\n streamgraph * 0.9.0   2025-11-02 [1] Github (hrbrmstr/streamgraph@76f7173)\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Streamgraph"
    ]
  },
  {
    "objectID": "Hiplot/168-streamgraph.html#数据准备",
    "href": "Hiplot/168-streamgraph.html#数据准备",
    "title": "流动图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/streamgraph/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ncolnames(data) &lt;- c(\"date\",\"key\",\"value\")\n\n# 查看数据\nhead(data)\n\n  date key  value\n1 1990   a 0.7688\n2 1990   b 0.5782\n3 1990   c 0.8164\n4 1990   d 0.4791\n5 1990   e 0.8793\n6 1990   f 0.4640",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Streamgraph"
    ]
  },
  {
    "objectID": "Hiplot/168-streamgraph.html#可视化",
    "href": "Hiplot/168-streamgraph.html#可视化",
    "title": "流动图",
    "section": "可视化",
    "text": "可视化\n\n# 流动图\np &lt;- streamgraph(data, key = \"key\", value = \"value\", date = \"date\",\n                 offset = \"silhouette\", interpolate = \"cardinal\",\n                 interactive = F, scale = \"date\") %&gt;% \n  sg_fill_brewer(palette = \"Spectral\")\n\np\n\n\n\n\n\n\n\n\n图 1: 流动图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Streamgraph"
    ]
  },
  {
    "objectID": "Hiplot/141-pie.html",
    "href": "Hiplot/141-pie.html",
    "title": "饼图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Pie 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/pie?lang=zh_cn\n饼图是通过将一个圆形切分成多个切片以显示每一部分所占总体比例的统计图表。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pie"
    ]
  },
  {
    "objectID": "Hiplot/141-pie.html#环境配置",
    "href": "Hiplot/141-pie.html#环境配置",
    "title": "饼图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2; dplyr\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(dplyr)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n dplyr      * 1.1.4   2023-11-17 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pie"
    ]
  },
  {
    "objectID": "Hiplot/141-pie.html#数据准备",
    "href": "Hiplot/141-pie.html#数据准备",
    "title": "饼图",
    "section": "数据准备",
    "text": "数据准备\n载入数据为不同分组及其数据。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/pie/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ncolnames(data) &lt;- c(\"Group\", \"Value\")\ndata &lt;- data %&gt;%\n  arrange(desc(Group)) %&gt;%\n  mutate(prop = Value / sum(data$Value) * 100) %&gt;%\n  mutate(ypos = Value / length(unique(Group)) +\n           c(0, cumsum(Value)[-length(Value)]) + 5)\n\n# 查看数据\nhead(data)\n\n   Group Value     prop   ypos\n1 Group4    43 38.73874  15.75\n2 Group3    21 18.91892  53.25\n3 Group2    34 30.63063  77.50\n4 Group1    13 11.71171 106.25",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pie"
    ]
  },
  {
    "objectID": "Hiplot/141-pie.html#可视化",
    "href": "Hiplot/141-pie.html#可视化",
    "title": "饼图",
    "section": "可视化",
    "text": "可视化\n\n# 饼图\np &lt;- ggplot(data, aes(x = \"\", y = Value, fill = Group)) +\n  geom_col(width = 1) +\n  geom_bar(stat = \"identity\", width = 1, color = \"white\") +\n  geom_text(aes(y = ypos, \n                label = sprintf(\"%s\\n(n=%s, %s%%)\", Group, Value,\n                                round(Value / sum(data$Value) * 100, 2))), \n            color = \"white\", fontface = \"bold\") +\n  coord_polar(theta = \"y\", start = 0, direction = -1) +\n  guides(fill = guide_legend(title = \"Group\")) +\n  scale_fill_discrete(\n    breaks = data$Group,\n    labels = paste(data$Group,\" (\", round(data$Value / sum(data$Value) * 100, 2),\n                   \"%)\", sep = \"\")) +\n  scale_fill_manual(values = c(\"#00468BFF\",\"#ED0000FF\",\"#42B540FF\",\"#0099B4FF\")) +\n  ggtitle(\"Pie Plot\") + \n  theme_minimal() +\n  theme(\n    axis.title.x = element_blank(),\n    axis.title.y = element_blank(),\n    axis.text.x = element_blank(),\n    axis.text.y = element_blank(),\n    panel.border = element_blank(),\n    panel.grid = element_blank(),\n    axis.ticks = element_blank(),\n    plot.title = element_text(size = 14, face = \"bold\",\n                              hjust = 0.5, vjust = -1),\n    legend.position = \"none\"\n  )\n    \n  \np\n\n\n\n\n\n\n\n图 1: 饼图\n\n\n\n\n\n在一个圆图中，每个切片的弧长（其中心角和中心角所对应区域的弧长）与所表示的数量成正比。该饼图展示了 1~4 组分别的样本数量及样本数量所对应的占比。一组样本数量 13，占比 11.71%，二组样本数量 34，占比 30.63%，三组样本数量 21，占比 18.92%，四组样本数量 43，占比38.74%。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pie"
    ]
  },
  {
    "objectID": "Hiplot/106-map-germany-town.html",
    "href": "Hiplot/106-map-germany-town.html",
    "title": "德国地图 (镇)",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Germany Map (Town) 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/map-germany-town?lang=zh_cn",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Germany Map (Town)"
    ]
  },
  {
    "objectID": "Hiplot/106-map-germany-town.html#环境配置",
    "href": "Hiplot/106-map-germany-town.html#环境配置",
    "title": "德国地图 (镇)",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2; RColorBrewer\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(RColorBrewer)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package      * version date (UTC) lib source\n data.table   * 1.17.8  2025-07-10 [1] RSPM\n ggplot2      * 4.0.1   2025-11-14 [1] RSPM\n jsonlite     * 2.0.0   2025-03-27 [1] RSPM\n RColorBrewer * 1.1-3   2022-04-03 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Germany Map (Town)"
    ]
  },
  {
    "objectID": "Hiplot/106-map-germany-town.html#数据准备",
    "href": "Hiplot/106-map-germany-town.html#数据准备",
    "title": "德国地图 (镇)",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/map-germany-town/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\ndt_map &lt;- readRDS(url(\"https://download.hiplot.cn/ui/basic/map-germany-town/germany_town.rds\"))\n\n# 整理数据格式\ndt_map$Value &lt;- data$value[match(dt_map$ENG_NAME, data$name)]\n\n# 查看数据\nhead(data)\n\n          name value\n1 Allmendingen   711\n2      Altheim   540\n3    Berghülen   582\n4   Blaubeuren   454\n5    Blaustein   766\n6     Balzheim   480",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Germany Map (Town)"
    ]
  },
  {
    "objectID": "Hiplot/106-map-germany-town.html#可视化",
    "href": "Hiplot/106-map-germany-town.html#可视化",
    "title": "德国地图 (镇)",
    "section": "可视化",
    "text": "可视化\n\n# 德国地图 (镇)\np &lt;- ggplot(dt_map) +\n  geom_polygon(aes(x = long, y = lat, group = group, fill = Value),\n               alpha = 0.9, size = 0.5) +\n  geom_path(aes(x = long, y = lat, group = group), color = \"black\", size = 0.2) +\n  coord_fixed() +\n  scale_fill_gradientn(\n    colours = colorRampPalette(rev(brewer.pal(11,\"RdYlBu\")))(500),\n    breaks = seq(min(data$value), max(data$value), \n                 round((max(data$value)-min(data$value))/7)),\n    name = \"Color Key\",\n    guide = guide_legend(\n      direction = \"vertical\", keyheight = unit(1, units = \"mm\"),\n      keywidth = unit(8, units = \"mm\"),\n      title.position = \"top\", title.hjust = 0.5, label.hjust = 0.5,\n      nrow = 1, byrow = T, reverse = F, label.position = \"bottom\")) +\n  theme(text = element_text(color = \"#3A3F4A\"),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank(),\n        legend.position = \"top\",\n        legend.text = element_text(size = 4 * 1.5, color = \"black\"),\n        legend.title = element_text(size = 5 * 1.5, color = \"black\"),\n        plot.title = element_text(\n          face = \"bold\", size = 5 * 1.5, hjust = 0.5, \n          margin = margin(t = 4, b = 5), color = \"black\"),\n        plot.background = element_rect(fill = \"#FFFFFF\", color = \"#FFFFFF\"),\n        panel.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        legend.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        plot.margin = unit(c(1.5, 1.5, 1.5, 1.5), \"cm\")) +\n  labs(x = NULL, y = NULL, title = \"Germany Map\")\n\np\n\n\n\n\n\n\n\n图 1: 德国地图 (镇)",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Germany Map (Town)"
    ]
  },
  {
    "objectID": "Hiplot/154-ridge.html",
    "href": "Hiplot/154-ridge.html",
    "title": "岭图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Ridge 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/ridge?lang=zh_cn\n岭图是一种将点连接围成形似山岭的图形。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Ridge"
    ]
  },
  {
    "objectID": "Hiplot/154-ridge.html#环境配置",
    "href": "Hiplot/154-ridge.html#环境配置",
    "title": "岭图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggridges; ggplot2; ggthemes\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggridges\", quietly = TRUE)) {\n  install.packages(\"ggridges\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"ggthemes\", quietly = TRUE)) {\n  install.packages(\"ggthemes\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggridges)\nlibrary(ggplot2)\nlibrary(ggthemes)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n ggridges   * 0.5.7   2025-08-27 [1] RSPM\n ggthemes   * 5.2.0   2025-11-30 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Ridge"
    ]
  },
  {
    "objectID": "Hiplot/154-ridge.html#数据准备",
    "href": "Hiplot/154-ridge.html#数据准备",
    "title": "岭图",
    "section": "数据准备",
    "text": "数据准备\n载入数据为三种分组及其对应的数值。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/ridge/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndata$group &lt;- factor(data$group, levels = unique(data$group)[length(unique(data$group)):1])\n\n# 查看数据\nhead(data)\n\n  value group\n1   5.1    G1\n2   4.9    G1\n3   4.7    G1\n4   4.6    G1\n5   5.0    G1\n6   5.4    G1",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Ridge"
    ]
  },
  {
    "objectID": "Hiplot/154-ridge.html#可视化",
    "href": "Hiplot/154-ridge.html#可视化",
    "title": "岭图",
    "section": "可视化",
    "text": "可视化\n\n# 岭图\np &lt;- ggplot(data, aes(x = value, y = group, fill = group, col = group)) +\n  geom_density_ridges(scale = 5, alpha = 0.8) +\n  labs(x = \"value\", y = \"group\") +\n  theme(plot.title = element_text(hjust = 0.5),\n        legend.position = \"none\") +\n  ggtitle(\"Ridge Plot\") +\n  guides(color = guide_legend(reverse = TRUE),\n         fill = guide_legend(reverse = TRUE)) +\n  scale_fill_manual(values = c(\"#e04d39\",\"#5bbad6\",\"#1e9f86\")) +\n  scale_color_manual(values = c(\"#e04d39\",\"#5bbad6\",\"#1e9f86\")) +\n  theme_stata() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 1: 岭图\n\n\n\n\n\n不同颜色表示不同分组，可以观测数据大致的高低程度。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Ridge"
    ]
  },
  {
    "objectID": "Hiplot/156-roc.html",
    "href": "Hiplot/156-roc.html",
    "title": "ROC 曲线",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot ROC 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/roc?lang=zh_cn\n接收者工作特征曲线（ROC 曲线）是用来说明二元分类器系统在其识别阈值变化时诊断能力的图形。",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "ROC"
    ]
  },
  {
    "objectID": "Hiplot/156-roc.html#环境配置",
    "href": "Hiplot/156-roc.html#环境配置",
    "title": "ROC 曲线",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; pROC; ggplotify\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"pROC\", quietly = TRUE)) {\n  install.packages(\"pROC\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(pROC)\nlibrary(ggplotify)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version  date (UTC) lib source\n data.table * 1.17.8   2025-07-10 [1] RSPM\n ggplotify  * 0.1.3    2025-09-20 [1] RSPM\n jsonlite   * 2.0.0    2025-03-27 [1] RSPM\n pROC       * 1.19.0.1 2025-07-31 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "ROC"
    ]
  },
  {
    "objectID": "Hiplot/156-roc.html#数据准备",
    "href": "Hiplot/156-roc.html#数据准备",
    "title": "ROC 曲线",
    "section": "数据准备",
    "text": "数据准备\n示例数据为一列二分类变量的结局和三列不同变量（诊断指标）及其数值。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/roc/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\nname_val &lt;- colnames(data)[2:ncol(data)]\nnum_value &lt;- ncol(data) - 1\n\n# 查看数据\nhead(data)\n\n  outcome value-Am value-GG value-EL\n1    Good        3     0.33    17.30\n2    Good        2     0.11    12.71\n3    Good        4     0.28     9.44\n4    Good        2     0.07    11.07\n5    Good        1     0.10    19.46\n6    Good        4     0.32    10.83",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "ROC"
    ]
  },
  {
    "objectID": "Hiplot/156-roc.html#可视化",
    "href": "Hiplot/156-roc.html#可视化",
    "title": "ROC 曲线",
    "section": "可视化",
    "text": "可视化\n\n# ROC 曲线\ncol &lt;- c(\"#00468BFF\",\"#ED0000FF\",\"#42B540FF\")\np &lt;- as.ggplot(function() {\n  for (i in 1:num_value) {\n    if (i == 1) {\n      roc_data &lt;- roc(data[, 1], data[, i + 1],\n        percent = T, plot = T, grid = T, lty = i, quiet = T,\n        print.auc = F, col = col[i], smooth = F,\n        main = \"ROC Plot\"\n      )\n      text(30, 50, \"AUC\", font = 2, col = \"darkgray\")\n      text(30, 50 - 10 * i,\n        paste(name_val[i], \":\", sprintf(\"%0.4f\", as.numeric(roc_data$auc))),\n        col = col[i]\n      )\n    } else {\n      roc_data &lt;- roc(data[, 1], data[, i + 1],\n        percent = T, plot = T, grid = T, add = T, lty = i, quiet = T,\n        print.auc = F, col = col[i]\n      )\n      text(30, 50 - 10 * i,\n        paste(name_val[i], \":\", sprintf(\"%0.4f\", as.numeric(roc_data$auc))),\n        col = col[i]\n      )\n    }\n  }\n    })\n\np\n\n\n\n\n\n\n\n图 1: ROC 曲线\n\n\n\n\n\n横轴表示特异性，纵轴表示敏感性，二者之间没有函数关系。曲线越靠近左上角，认为该诊断指标预测能力越好。图示中每种颜色表示一个变量（诊断指标），蓝色曲线和红色曲线的预测能力明显较绿色曲线好。AUC 为 ROC 曲线下面积。AUC = 1 表示该曲线存在至少一个阈值能得出完美预测。0.5 &lt; AUC &lt; 1，优于随机猜测，妥善选择阈值，能有预测价值。AUC = 0.5，跟随机猜测一样，模型没有预测价值。若 AUC &lt; 0.5，可能原因是二分类变量如（0，1）与结局设置颠倒，调换结局赋值即可。在本图示中，value-Am (86.9792) &gt; value-GG (84.3750) &gt; value-EL (56.7708)，可以认为 Am 变量的预测能力最好。",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "ROC"
    ]
  },
  {
    "objectID": "Hiplot/019-chi-square-fisher.html",
    "href": "Hiplot/019-chi-square-fisher.html",
    "title": "卡方与 Fisher 检验",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Chi-square-fisher Test 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/chi-square-fisher?lang=zh_cn\n卡方与 Fisher 检验可用于分类变量频数差异检验，该工具将自动选择卡方和 Fisher 确切性检验统计方法。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Chi-square-fisher Test"
    ]
  },
  {
    "objectID": "Hiplot/019-chi-square-fisher.html#环境配置",
    "href": "Hiplot/019-chi-square-fisher.html#环境配置",
    "title": "卡方与 Fisher 检验",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2; visdat; aplot\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"visdat\", quietly = TRUE)) {\n  install.packages(\"visdat\")\n}\nif (!requireNamespace(\"aplot\", quietly = TRUE)) {\n  install.packages(\"aplot\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(visdat)\nlibrary(aplot)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n aplot      * 0.2.9   2025-09-12 [1] RSPM\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n visdat     * 0.6.0   2023-02-02 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Chi-square-fisher Test"
    ]
  },
  {
    "objectID": "Hiplot/019-chi-square-fisher.html#数据准备",
    "href": "Hiplot/019-chi-square-fisher.html#数据准备",
    "title": "卡方与 Fisher 检验",
    "section": "数据准备",
    "text": "数据准备\n数据表支持两种格式：列联表（示例 1）和单行记录表（示例 2）\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/chi-square-fisher/data.json\")$exampleData[[1]]$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\nrownames(data) &lt;- data[,1]\ndata &lt;- data[,-1]\ncb &lt;- combn(nrow(data), 2)\nfinal &lt;- data.frame()\nfor (i in 1:ncol(cb)) {\n  tmp &lt;- data[cb[,i],]\n  groups &lt;- paste0(rownames(data)[cb[,i]], collapse = \" | \")\n  \n  res &lt;- tryCatch({\n    chisq.test(tmp)\n    }, warning = function(w) {\n      tryCatch({fisher.test(tmp)}, error = function(e) {\n        return(fisher.test(tmp, simulate.p.value = TRUE))\n        })\n  })\n  val_percent &lt;- apply(tmp, 1, function(x) {\n    sprintf(\"%s (%s%%)\", x, round(x / sum(x), 2) * 100)\n  })\n  val_percent1 &lt;- paste0(colnames(tmp), \":\", val_percent[,1])\n  val_percent1 &lt;- paste0(val_percent1, collapse = \" | \")\n  val_percent2 &lt;- paste0(colnames(tmp), \":\", val_percent[,2])\n  val_percent2 &lt;- paste0(val_percent2, collapse = \" | \")\n  tmp &lt;- data.frame(\n    groups = groups,\n    val_percent_left = val_percent1,\n    val_percent_right = val_percent2,\n    statistic = ifelse(is.null(res$statistic), NA,\n      as.numeric(res$statistic)),\n    pvalue = as.numeric(res$p.value),\n    method = res$method\n  )\n  final &lt;- rbind(final, tmp)\n}\nfinal &lt;- as.data.frame(final)\nfinal$pvalue &lt; as.numeric(final$pvalue)\n\n [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n\nfinal$statistic &lt; as.numeric(final$statistic)\n\n [1] FALSE FALSE FALSE    NA FALSE FALSE    NA FALSE    NA    NA\n\n# 查看数据\nhead(final)\n\n  groups                        val_percent_left\n1  A | B L:401 (48%) | M:216 (26%) | H:221 (26%)\n2  A | C L:401 (48%) | M:216 (26%) | H:221 (26%)\n3  A | D L:401 (48%) | M:216 (26%) | H:221 (26%)\n4  A | E L:401 (48%) | M:216 (26%) | H:221 (26%)\n5  B | C L:254 (37%) | M:259 (38%) | H:169 (25%)\n6  B | D L:254 (37%) | M:259 (38%) | H:169 (25%)\n                        val_percent_right    statistic       pvalue\n1 L:254 (37%) | M:259 (38%) | H:169 (25%) 2.810229e+01 7.900708e-07\n2 L:400 (48%) | M:215 (26%) | H:220 (26%) 4.566425e-04 9.997717e-01\n3 L:252 (38%) | M:251 (38%) | H:162 (24%) 2.614390e+01 2.103411e-06\n4       L:3 (23%) | M:5 (38%) | H:5 (38%)           NA 1.633146e-01\n5 L:400 (48%) | M:215 (26%) | H:220 (26%) 2.821998e+01 7.449197e-07\n6 L:252 (38%) | M:251 (38%) | H:162 (24%) 6.689139e-02 9.671074e-01\n                              method\n1         Pearson's Chi-squared test\n2         Pearson's Chi-squared test\n3         Pearson's Chi-squared test\n4 Fisher's Exact Test for Count Data\n5         Pearson's Chi-squared test\n6         Pearson's Chi-squared test",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Chi-square-fisher Test"
    ]
  },
  {
    "objectID": "Hiplot/019-chi-square-fisher.html#可视化",
    "href": "Hiplot/019-chi-square-fisher.html#可视化",
    "title": "卡方与 Fisher 检验",
    "section": "可视化",
    "text": "可视化\n\n# 卡方与 Fisher 检验\np1 &lt;- vis_value(final[\"statistic\"]) + \n  scale_fill_gradientn(colours = c(\"#3362ab\",\"#87b7d7\",\"#e8e0db\",\"#eea07d\",\"#ad1c2e\"))\n\np2 &lt;- vis_expect(final[\"pvalue\"], ~.x &lt; 0.05) +\n  scale_fill_manual(values = c(\"#1c438a\",\"#e7120c\"))\n\np &lt;- p1+p2\np\n\n\n\n\n\n\n\n图 1: 卡方与 Fisher 检验",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Chi-square-fisher Test"
    ]
  },
  {
    "objectID": "Hiplot/164-simple-funnel-diagram.html",
    "href": "Hiplot/164-simple-funnel-diagram.html",
    "title": "简易漏斗图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Simple Funnel Diagram 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/simple-funnel-diagram?lang=zh_cn",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Simple Funnel Diagram"
    ]
  },
  {
    "objectID": "Hiplot/164-simple-funnel-diagram.html#环境配置",
    "href": "Hiplot/164-simple-funnel-diagram.html#环境配置",
    "title": "简易漏斗图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; magrittr; echarts4r\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"magrittr\", quietly = TRUE)) {\n  install.packages(\"magrittr\")\n}\nif (!requireNamespace(\"echarts4r\", quietly = TRUE)) {\n  install.packages(\"echarts4r\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(magrittr)\nlibrary(echarts4r)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n echarts4r  * 0.4.6   2025-09-11 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n magrittr   * 2.0.4   2025-09-12 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Simple Funnel Diagram"
    ]
  },
  {
    "objectID": "Hiplot/164-simple-funnel-diagram.html#数据准备",
    "href": "Hiplot/164-simple-funnel-diagram.html#数据准备",
    "title": "简易漏斗图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/simple-funnel-diagram/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 查看数据\nhead(data)\n\n       key value\n1     view    60\n2    click    30\n3 purchase    20",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Simple Funnel Diagram"
    ]
  },
  {
    "objectID": "Hiplot/164-simple-funnel-diagram.html#可视化",
    "href": "Hiplot/164-simple-funnel-diagram.html#可视化",
    "title": "简易漏斗图",
    "section": "可视化",
    "text": "可视化\n\n# 自定义热图\np &lt;- data %&gt;%\n  e_charts() %&gt;%\n  e_funnel(value, key) %&gt;%\n  e_title(\"Funnel\") %&gt;%\n  e_theme(\"macarons\")\n\np\n\n\n\n\n\n\n\n图 1: 自定义热图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Simple Funnel Diagram"
    ]
  },
  {
    "objectID": "Hiplot/134-parliament.html",
    "href": "Hiplot/134-parliament.html",
    "title": "议会图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Parliament 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/parliament?lang=zh_cn\n议会图是一种形似议会坐席，以点代表一个数据，从而更加灵活地展示各组所占份额比的数据处理方式。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Parliament"
    ]
  },
  {
    "objectID": "Hiplot/134-parliament.html#环境配置",
    "href": "Hiplot/134-parliament.html#环境配置",
    "title": "议会图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggpol; ggplot2\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggpol\", quietly = TRUE)) {\n  install.packages(\"ggpol\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggpol)\nlibrary(ggplot2)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n ggpol      * 0.0.7   2025-12-23 [1] Github (erocoar/ggpol@0844060)\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Parliament"
    ]
  },
  {
    "objectID": "Hiplot/134-parliament.html#数据准备",
    "href": "Hiplot/134-parliament.html#数据准备",
    "title": "议会图",
    "section": "数据准备",
    "text": "数据准备\n数据载入为分组及其对应数值。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/parliament/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 查看数据\nhead(data)\n\n  group value\n1    G1   200\n2    G2    46\n3    G3    92\n4    G4    80\n5    G5   150",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Parliament"
    ]
  },
  {
    "objectID": "Hiplot/134-parliament.html#可视化",
    "href": "Hiplot/134-parliament.html#可视化",
    "title": "议会图",
    "section": "可视化",
    "text": "可视化\n\n# 议会图\np &lt;- ggplot(data) +\n  geom_parliament(alpha = 1, aes(seats = value, fill = group), color = \"black\") +\n  coord_fixed() +\n  scale_fill_discrete(name = \"group\", labels = unique(data$group)) +\n  scale_fill_manual(values = c(\"#E64B35FF\",\"#4DBBD5FF\",\"#00A087FF\",\"#3C5488FF\",\n                                \"#F39B7FFF\")) +\n  ggtitle(\"Parliament Plot\") +\n  theme_void() +\n  theme(legend.position = \"bottom\",\n        plot.title = element_text(hjust = 0.5))\n\np\n\n\n\n\n\n\n\n图 1: 议会图\n\n\n\n\n\n不同颜色表示不同分组，每一个点代表一个数据。它是由很多点组成半环形，最小的份额在议会图里可以用一个点来表示。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Parliament"
    ]
  },
  {
    "objectID": "Hiplot/084-group-line.html",
    "href": "Hiplot/084-group-line.html",
    "title": "分组折线图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Group Line 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/group-line?lang=zh_cn",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Group Line"
    ]
  },
  {
    "objectID": "Hiplot/084-group-line.html#环境配置",
    "href": "Hiplot/084-group-line.html#环境配置",
    "title": "分组折线图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Group Line"
    ]
  },
  {
    "objectID": "Hiplot/084-group-line.html#数据准备",
    "href": "Hiplot/084-group-line.html#数据准备",
    "title": "分组折线图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/group-line/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 查看数据\nhead(data)\n\n  x        y names groups\n1 1 2.253573    L1      A\n2 2 2.231082    L1      A\n3 3 1.740380    L1      A\n4 4 2.255786    L1      A\n5 5 2.429561    L1      A\n6 6 1.951557    L1      A",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Group Line"
    ]
  },
  {
    "objectID": "Hiplot/084-group-line.html#可视化",
    "href": "Hiplot/084-group-line.html#可视化",
    "title": "分组折线图",
    "section": "可视化",
    "text": "可视化\n\n# 分组折线图\np &lt;- ggplot(data, aes(x = x, y = y, group = names, color = groups)) +\n  geom_line() +\n  geom_point() +\n  scale_color_manual(values = c(\"#e04d39\",\"#5bbad6\")) +\n  theme_bw()\n\np\n\n\n\n\n\n\n\n图 1: 分组折线图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Group Line"
    ]
  },
  {
    "objectID": "Hiplot/020-chord.html",
    "href": "Hiplot/020-chord.html",
    "title": "弦图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Chord Plot 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/chord?lang=zh_cn\n复杂的数据关系交互作用以和弦图的形式表现出来。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Chord Plot"
    ]
  },
  {
    "objectID": "Hiplot/020-chord.html#环境配置",
    "href": "Hiplot/020-chord.html#环境配置",
    "title": "弦图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; circlize; ggplotify\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"circlize\", quietly = TRUE)) {\n  install.packages(\"circlize\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(circlize)\nlibrary(ggplotify)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n circlize   * 0.4.17  2025-12-08 [1] RSPM\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplotify  * 0.1.3   2025-09-20 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Chord Plot"
    ]
  },
  {
    "objectID": "Hiplot/020-chord.html#数据准备",
    "href": "Hiplot/020-chord.html#数据准备",
    "title": "弦图",
    "section": "数据准备",
    "text": "数据准备\n基因与通路或基因本体相互作用的数据框架或矩阵。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/chord/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\nrow.names(data) &lt;- data[, 1]\ndata &lt;- data[, -1]\ndata &lt;- as.matrix(data)\n\n# 查看数据\nhead(data)\n\n   E1 E2 E3 E4 E5\nS1  4 16 12 18 11\nS2  7 11  2 15 10\nS3  9  2 17 16 11\nS4 14  9 12  3 17\nS5  1  1  7  1 12\nS6 10 18  9 13  9",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Chord Plot"
    ]
  },
  {
    "objectID": "Hiplot/020-chord.html#可视化",
    "href": "Hiplot/020-chord.html#可视化",
    "title": "弦图",
    "section": "可视化",
    "text": "可视化\n\n# 弦图\nPalette &lt;- c(\"#E64B35FF\",\"#4DBBD5FF\",\"#00A087FF\",\"#3C5488FF\",\"#F39B7FFF\",\n             \"#8491B4FF\",\"#91D1C2FF\",\"#DC0000FF\",\"#7E6148FF\",\"#B09C85FF\")\ngrid.col &lt;- c(Palette, Palette, Palette[1:5])\np &lt;- as.ggplot(function() {\n  chordDiagram(\n    data, grid.col = grid.col, grid.border = NULL, transparency = 0.5,\n    row.col = NULL, column.col = NULL,  order = NULL,\n    directional = 0, # 1, -1, 0, 2\n    direction.type = \"diffHeight\", # diffHeight and arrows\n    diffHeight = convert_height(2, \"mm\"), reduce = 1e-5, xmax = NULL, \n    self.link = 2, symmetric = FALSE, keep.diagonal = FALSE, \n    preAllocateTracks = NULL,\n    annotationTrack = c(\"name\", \"grid\", \"axis\"),\n    annotationTrackHeight = convert_height(c(3, 3), \"mm\"),\n    link.border = NA, link.lwd = par(\"lwd\"), link.lty = par(\"lty\"), \n    link.sort = FALSE, link.decreasing = TRUE, link.largest.ontop = FALSE,\n    link.visible = T, link.rank = NULL, link.overlap = FALSE,\n    scale = F, group = NULL, big.gap = 10, small.gap = 1\n    )\n  })\n\np\n\n\n\n\n\n\n\n图 1: 弦图",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Chord Plot"
    ]
  },
  {
    "objectID": "Hiplot/085-half-violin.html",
    "href": "Hiplot/085-half-violin.html",
    "title": "半小提琴图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Half Violin 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/half-violin?lang=zh_cn\n半小提琴图是在保留小提琴图右半部分图形的基础上，将左侧部分换成数据频次计数图形，也是用于显示数据分布及概率密度的统计图表。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Half Violin"
    ]
  },
  {
    "objectID": "Hiplot/085-half-violin.html#环境配置",
    "href": "Hiplot/085-half-violin.html#环境配置",
    "title": "半小提琴图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2; dplyr; ggpubr; ggthemes\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"ggpubr\", quietly = TRUE)) {\n  install.packages(\"ggpubr\")\n}\nif (!requireNamespace(\"ggthemes\", quietly = TRUE)) {\n  install.packages(\"ggthemes\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(ggpubr)\nlibrary(ggthemes)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n dplyr      * 1.1.4   2023-11-17 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n ggpubr     * 0.6.2   2025-10-17 [1] RSPM\n ggthemes   * 5.2.0   2025-11-30 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Half Violin"
    ]
  },
  {
    "objectID": "Hiplot/085-half-violin.html#数据准备",
    "href": "Hiplot/085-half-violin.html#数据准备",
    "title": "半小提琴图",
    "section": "数据准备",
    "text": "数据准备\n载入数据为载入数据为数据集 (不同肿瘤中基因名称及表达水平)。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/half-violin/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ncolnames(data) &lt;- c(\"Value\", \"Group\")\ndata[, 2] &lt;- factor(data[, 2], levels = unique(data[, 2]))\n\n# 查看数据\nhead(data)\n\n     Value Group\n1 12.10228   AML\n2 12.61382   AML\n3 12.52741   AML\n4 12.67990   AML\n5 12.64837   AML\n6 12.12146   AML",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Half Violin"
    ]
  },
  {
    "objectID": "Hiplot/085-half-violin.html#可视化",
    "href": "Hiplot/085-half-violin.html#可视化",
    "title": "半小提琴图",
    "section": "可视化",
    "text": "可视化\n\n# 半小提琴图\ngeom_flat_violin &lt;- function(\n  mapping = NULL, data = NULL, stat = \"ydensity\", position = \"dodge\", \n  trim = TRUE, scale = \"area\", show.legend = NA, inherit.aes = TRUE, ...) {\n  ggplot2::layer(data = data, mapping = mapping, stat = stat, \n                 geom = geom_flat_violin_proto, position = position,\n                 show.legend = show.legend, inherit.aes = inherit.aes,\n                 params = list(trim = trim, scale = scale, ...))\n}\n\n\"%||%\" &lt;- function(a, b) {\n  if (!is.null(a)) {\n    a\n  } else {\n    b\n  }\n}\n\ngeom_flat_violin_proto &lt;-\n  ggproto(\"geom_flat_violin_proto\", Geom,\n          setup_data = function(data, params) {\n            data$width &lt;- data$width %||%\n              params$width %||% (resolution(data$x, FALSE) * 0.9)\n            \n            data %&gt;%\n              dplyr::group_by(.data = ., group) %&gt;%\n              dplyr::mutate(.data = ., ymin = min(y), ymax = max(y), xmin = x,\n                            xmax = x + width / 2)\n          },\n          \n          draw_group = function(data, panel_scales, coord) {\n            data &lt;- base::transform(data, xminv = x, \n                                    xmaxv = x + violinwidth * (xmax - x))\n            \n            newdata &lt;- base::rbind(\n              dplyr::arrange(.data = base::transform(data, x = xminv), y),\n              dplyr::arrange(.data = base::transform(data, x = xmaxv), -y))\n            \n            newdata &lt;- rbind(newdata, newdata[1, ])\n            \n            ggplot2:::ggname(\"geom_flat_violin\",\n                             GeomPolygon$draw_panel(newdata, panel_scales, coord))\n          },\n          \n          draw_key = draw_key_polygon,\n          \n          default_aes = ggplot2::aes(weight = 1, colour = \"grey20\", fill = \"white\",\n                                     size = 0.5, alpha = NA, linetype = \"solid\"),\n          required_aes = c(\"x\", \"y\")\n        )\n\np &lt;- ggplot(data = data, aes(Group, Value, fill = Group)) +\n  geom_flat_violin(alpha = 1, scale = \"count\", trim = FALSE) +\n  geom_boxplot(width = 0.05, fill = \"white\", alpha = 1, \n               outlier.colour = NA, position = position_nudge(0.05)) +\n  stat_summary(fun = mean, geom = \"point\", fill = \"white\", shape = 21, size = 2,\n               position = position_nudge(0.05)) +\n  geom_dotplot(alpha = 1, binaxis = \"y\", dotsize = 0.5, stackdir = \"down\", \n               binwidth = 0.1, position = position_nudge(-0.025)) +\n  theme(legend.position = \"none\") +\n  xlab(colnames(data)[2]) +\n  ylab(colnames(data)[1]) +\n  guides(fill = F) +\n  ggtitle(\"Half Violin Plot\") +\n  scale_fill_manual(values = c(\"#e04d39\",\"#5bbad6\",\"#1e9f86\")) +\n  theme_stata() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 1: 半小提琴图\n\n\n\n\n\n半小提琴图可以反映数据分布，同箱形图类似，方框中黑色横线显示各肿瘤中基因表达水平的中位数， 白色方框中上下框边代表数据集中的上，下四分位点；左半面可观测数值点的分布状况；小提琴图还可以反映数据密度，数据集数据越集中则图形越胖。图示中 BLGG 组中的基因表达分布更集中，BIC 组次之，AML 组则分布最分散。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Half Violin"
    ]
  },
  {
    "objectID": "Hiplot/186-waterfalls.html",
    "href": "Hiplot/186-waterfalls.html",
    "title": "瀑布图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Waterfalls 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/waterfalls?lang=zh_cn\n瀑布图用于显示顺序引入正值或负值的累积效应。这些中间值可以基于时间或基于类别。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Waterfalls"
    ]
  },
  {
    "objectID": "Hiplot/186-waterfalls.html#环境配置",
    "href": "Hiplot/186-waterfalls.html#环境配置",
    "title": "瀑布图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; waterfalls; ggplot2\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"waterfalls\", quietly = TRUE)) {\n  install.packages(\"waterfalls\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(waterfalls)\nlibrary(ggplot2)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n waterfalls * 1.0.0   2022-11-20 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Waterfalls"
    ]
  },
  {
    "objectID": "Hiplot/186-waterfalls.html#数据准备",
    "href": "Hiplot/186-waterfalls.html#数据准备",
    "title": "瀑布图",
    "section": "数据准备",
    "text": "数据准备\n加载的数据具有两个列，其中第一个针对类别的项目，第二个针对其相应的值。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/waterfalls/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 查看数据\nhead(data)\n\n  label value\n1     a   100\n2     b   -20\n3     c    10\n4     d    20\n5     e   110",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Waterfalls"
    ]
  },
  {
    "objectID": "Hiplot/186-waterfalls.html#可视化",
    "href": "Hiplot/186-waterfalls.html#可视化",
    "title": "瀑布图",
    "section": "可视化",
    "text": "可视化\n\n# 瀑布图\np &lt;- waterfall(data, rect_text_labels = data$value, rect_text_size = 1,\n    rect_text_labels_anchor = \"centre\", calc_total = T,\n    total_axis_text = \"Total\", total_rect_text = sum(data$value),\n    total_rect_color = \"steelblue\", total_rect_text_color = \"black\",\n    rect_width = 0.7, rect_border = \"black\", draw_lines = TRUE,\n    linetype = 2, fill_by_sign = F, \n    fill_colours = c(\"#E64B35FF\",\"#4DBBD5FF\",\"#00A087FF\",\"#3C5488FF\",\"#F39B7FFF\",\n                     \"#8491B4FF\"),\n    scale_y_to_waterfall = T) +\n  theme_bw() +\n  theme(axis.text = element_text(size = 12),\n        plot.title = element_text(hjust = 0.5)) +\n  labs(title = \"Waterfalls Plot\")\n\np\n\n\n\n\n\n\n\n图 1: 瀑布图\n\n\n\n\n\n如示例图所示，X轴表示每个基于类别的项目，y轴显示其累积值。足够极端的增量和减小会导致累积总数在各个点上方降低和低于轴的高于轴的上方。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Waterfalls"
    ]
  },
  {
    "objectID": "Hiplot/081-group-bubble.html",
    "href": "Hiplot/081-group-bubble.html",
    "title": "分组气泡图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Group Bubble 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/group-bubble?lang=zh_cn",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Group Bubble"
    ]
  },
  {
    "objectID": "Hiplot/081-group-bubble.html#环境配置",
    "href": "Hiplot/081-group-bubble.html#环境配置",
    "title": "分组气泡图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Group Bubble"
    ]
  },
  {
    "objectID": "Hiplot/081-group-bubble.html#数据准备",
    "href": "Hiplot/081-group-bubble.html#数据准备",
    "title": "分组气泡图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/group-bubble/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 查看数据\nhead(data)\n\n  Sepal.Length Sepal.Width Petal.Length Petal.Width Species\n1          5.1         3.5          1.4         0.2  setosa\n2          4.9         3.0          1.4         0.2  setosa\n3          4.7         3.2          1.3         0.2  setosa\n4          4.6         3.1          1.5         0.2  setosa\n5          5.0         3.6          1.4         0.2  setosa\n6          5.4         3.9          1.7         0.4  setosa",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Group Bubble"
    ]
  },
  {
    "objectID": "Hiplot/081-group-bubble.html#可视化",
    "href": "Hiplot/081-group-bubble.html#可视化",
    "title": "分组气泡图",
    "section": "可视化",
    "text": "可视化\n\n# 分组气泡图\np &lt;- ggplot(data = data, aes(x = Sepal.Length, y = Sepal.Width, \n                             size = Petal.Width, color = Species)) +\n  geom_point(alpha = 0.7) +\n  scale_size(range = c(1, 4)) +\n  scale_color_manual(values = c(\"#e04d39\",\"#5bbad6\",\"#1e9f86\")) +\n  theme_bw()\n\np\n\n\n\n\n\n\n\n图 1: 分组气泡图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Group Bubble"
    ]
  },
  {
    "objectID": "Hiplot/072-ggpubr-boxplot.html",
    "href": "Hiplot/072-ggpubr-boxplot.html",
    "title": "GGPubr 箱线图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot GGPubr Boxplot 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/ggpubr-boxplot?lang=zh_cn\n特性丰富的箱线图（GGPubr 接口）。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "GGPubr Boxplot"
    ]
  },
  {
    "objectID": "Hiplot/072-ggpubr-boxplot.html#环境配置",
    "href": "Hiplot/072-ggpubr-boxplot.html#环境配置",
    "title": "GGPubr 箱线图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggpubr; ggthemes\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggpubr\", quietly = TRUE)) {\n  install.packages(\"ggpubr\")\n}\nif (!requireNamespace(\"ggthemes\", quietly = TRUE)) {\n  install.packages(\"ggthemes\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggpubr)\nlibrary(ggthemes)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n ggpubr     * 0.6.2   2025-10-17 [1] RSPM\n ggthemes   * 5.2.0   2025-11-30 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "GGPubr Boxplot"
    ]
  },
  {
    "objectID": "Hiplot/072-ggpubr-boxplot.html#数据准备",
    "href": "Hiplot/072-ggpubr-boxplot.html#数据准备",
    "title": "GGPubr 箱线图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/ggpubr-boxplot/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 查看数据\nhead(data)\n\n   len supp dose\n1  4.2   VC  0.5\n2 11.5   VC  0.5\n3  7.3   VC  0.5\n4  5.8   VC  0.5\n5  6.4   VC  0.5\n6 10.0   VC  0.5",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "GGPubr Boxplot"
    ]
  },
  {
    "objectID": "Hiplot/072-ggpubr-boxplot.html#可视化",
    "href": "Hiplot/072-ggpubr-boxplot.html#可视化",
    "title": "GGPubr 箱线图",
    "section": "可视化",
    "text": "可视化\n\n# GGPubr 箱线图\np &lt;- ggboxplot(\n  data = data, x = \"supp\", y = \"len\", facet.by = \"dose\",\n  merge = T,\n  color = \"supp\",\n  fill = \"white\") + \n  stat_compare_means(\n    label = \"p.signif\",\n    label.x.npc = \"center\",\n    method = \"wilcox\") + \n  scale_y_continuous(expand = expansion(mult = c(0.2, 0.2))) +\n  scale_fill_manual(values = c(\"#e04d39\",\"#5bbad6\")) +\n  ggtitle(\"Complex Boxplot\") + \n  theme_stata() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 1: GGPubr 箱线图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "GGPubr Boxplot"
    ]
  },
  {
    "objectID": "Hiplot/187-pca.html",
    "href": "Hiplot/187-pca.html",
    "title": "主成分分析",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot PCA 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/pca?lang=zh_cn\n主成分分析是以“降维”*” 为核心，用较少的几个综合指标（主成分）代替多指标的数据，还原数据最本质特征的数据处理方式。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "PCA"
    ]
  },
  {
    "objectID": "Hiplot/187-pca.html#环境配置",
    "href": "Hiplot/187-pca.html#环境配置",
    "title": "主成分分析",
    "section": "环境配置",
    "text": "环境配置\n\n系统: 跨平台 (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; gmodels, ggpubr, ggplot2\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"gmodels\", quietly = TRUE)) {\n  install.packages(\"gmodels\")\n}\nif (!requireNamespace(\"ggpubr\", quietly = TRUE)) {\n  install.packages(\"ggpubr\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(gmodels)\nlibrary(ggpubr)\nlibrary(ggplot2)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n ggpubr     * 0.6.2   2025-10-17 [1] RSPM\n gmodels    * 2.19.1  2024-03-06 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "PCA"
    ]
  },
  {
    "objectID": "Hiplot/187-pca.html#数据准备",
    "href": "Hiplot/187-pca.html#数据准备",
    "title": "主成分分析",
    "section": "数据准备",
    "text": "数据准备\n加载的数据包括基因表达值（基因名称及对应表达量）和样本信息（样本名称及分组）。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/pca/data.json\")$exampleData[[1]]$textarea[[1]])\ndata &lt;- as.data.frame(data)\ngroup &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/pca/data.json\")$exampleData[[1]]$textarea[[2]])\ngroup &lt;- as.data.frame(group)\n\n# 整理数据格式\nrownames(data) &lt;- data[, 1]\ndata &lt;- as.matrix(data[, -1])\npca_info &lt;- fast.prcomp(data)\n## 创建配置\nconf &lt;- list(\n  dataArg = list(\n    list(list(value = \"group\")),  # 按group列着色\n    list(list(value = \"\"))         # 无形状分组\n  ),\n  general = list(\n    title = \"Principal Component Analysis\",\n    palette = \"Set1\"\n  )\n)\n## 执行PCA - 注意需要转置数据，因为PCA是对样本（列）进行分析\npca_info &lt;- prcomp(t(data), scale. = TRUE)\n## 准备绘图数据\naxis &lt;- sapply(conf$dataArg[[1]], function(x) x$value)\n## 处理颜色分组\nif (is.null(axis[1]) || axis[1] == \"\") {\n  colorBy &lt;- rep('ALL', ncol(data))\n} else {\n  ## 确保样本顺序匹配\n  colorBy &lt;- group[match(colnames(data), group$sample), axis[1]]\n}\ncolorBy &lt;- factor(colorBy, levels = unique(colorBy))\n## 创建PCA数据框\npca_data &lt;- data.frame(\n  sample = rownames(pca_info$x),\n  PC1 = pca_info$x[, 1],\n  PC2 = pca_info$x[, 2],\n  colorBy = colorBy\n)\n## 计算解释方差\nvariance_explained &lt;- round(pca_info$sdev^2 / sum(pca_info$sdev^2) * 100, 1)\n\n# 查看数据\nstr(data)\n\n num [1:9, 1:6] 6.6 5.76 9.56 8.4 8.42 ...\n - attr(*, \"dimnames\")=List of 2\n  ..$ : chr [1:9] \"GBP4\" \"BCAT1\" \"CMPK2\" \"STOX2\" ...\n  ..$ : chr [1:6] \"M1\" \"M2\" \"M3\" \"M8\" ...\n\nstr(group)\n\n'data.frame':   6 obs. of  2 variables:\n $ sample: chr  \"M1\" \"M2\" \"M3\" \"M8\" ...\n $ group : chr  \"G1\" \"G1\" \"G1\" \"G2\" ...\n\nhead(pca_data)\n\n    sample        PC1         PC2 colorBy\nM1      M1  0.8626164  2.17168331      G1\nM2      M2  2.1114348  0.50696347      G1\nM3      M3  2.9706882 -1.81112892      G1\nM8      M8 -3.0779404 -0.85045239      G2\nM9      M9 -2.5038211  0.08748266      G2\nM10    M10 -0.3629779 -0.10454813      G2",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "PCA"
    ]
  },
  {
    "objectID": "Hiplot/187-pca.html#可视化",
    "href": "Hiplot/187-pca.html#可视化",
    "title": "主成分分析",
    "section": "可视化",
    "text": "可视化\n\n# 主成分分析\np &lt;- ggplot(pca_data, aes(x = PC1, y = PC2, color = colorBy)) +\n  geom_point(size = 4, alpha = 0.8) +\n  geom_hline(yintercept = 0, linetype = \"dashed\", color = \"gray70\") +\n  geom_vline(xintercept = 0, linetype = \"dashed\", color = \"gray70\") +\n  stat_ellipse(level = 0.95, show.legend = FALSE) +\n  ggtitle(conf$general$title) +\n  labs(\n    x = paste0(\"PC1 (\", variance_explained[1], \"%)\"),\n    y = paste0(\"PC2 (\", variance_explained[2], \"%)\"),\n    color = axis[1]\n  ) +\n  \n  # 自定义颜色方案\n  scale_color_brewer(palette = conf$general$palette) +\n  \n  # 添加样本标签\n  geom_text(aes(label = sample), \n            hjust = 0.5, vjust = -1, size = 3.5, show.legend = FALSE) +\n  \n  # 主题设置\n  theme_bw(base_size = 12) +\n  theme(\n    plot.title = element_text(hjust = 0.5, face = \"bold\", size = 16),\n    axis.title = element_text(size = 14, face = \"bold\"),\n    axis.text = element_text(size = 12),\n    legend.title = element_text(size = 12, face = \"bold\"),\n    legend.text = element_text(size = 11),\n    legend.position = \"right\",\n    panel.grid.major = element_line(color = \"grey90\", linewidth = 0.3),\n    panel.grid.minor = element_blank(),\n    panel.border = element_rect(fill = NA, color = \"grey50\", linewidth = 0.5),\n    aspect.ratio = 1\n  )\n\n# 显示图形\np\n\nToo few points to calculate an ellipse\nToo few points to calculate an ellipse\n\n\nWarning: Removed 2 rows containing missing values or values outside the scale range\n(`geom_path()`).\n\n\n\n\n\n主成分分析\n\n\n\n\n不同颜色表示不同样本，可解读主成分与原变量的关系，如：M1 对 PC1 具有较大的贡献，而 M8 与 PC1 呈较大的负相关性。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "PCA"
    ]
  },
  {
    "objectID": "Hiplot/103-map-france-town.html",
    "href": "Hiplot/103-map-france-town.html",
    "title": "法国地图 (镇)",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot France Map (Town) 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/map-france-town?lang=zh_cn",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "France Map (Town)"
    ]
  },
  {
    "objectID": "Hiplot/103-map-france-town.html#环境配置",
    "href": "Hiplot/103-map-france-town.html#环境配置",
    "title": "法国地图 (镇)",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2; RColorBrewer\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(RColorBrewer)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package      * version date (UTC) lib source\n data.table   * 1.17.8  2025-07-10 [1] RSPM\n ggplot2      * 4.0.1   2025-11-14 [1] RSPM\n jsonlite     * 2.0.0   2025-03-27 [1] RSPM\n RColorBrewer * 1.1-3   2022-04-03 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "France Map (Town)"
    ]
  },
  {
    "objectID": "Hiplot/103-map-france-town.html#数据准备",
    "href": "Hiplot/103-map-france-town.html#数据准备",
    "title": "法国地图 (镇)",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/map-france-town/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\ndt_map &lt;- readRDS(url(\"https://download.hiplot.cn/ui/basic/map-france-town/france_town.rds\"))\n\n# 整理数据格式\ndt_map$Value &lt;- data$value[match(dt_map$ENG_NAME, data$name)]\n\n# 查看数据\nhead(data)\n\n                   name value\n1           Bischwiller   669\n2              Haguenau   935\n3 Niederbronn-les-Bains   356\n4              Molsheim   199\n5               Rosheim   971\n6                Saales   532",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "France Map (Town)"
    ]
  },
  {
    "objectID": "Hiplot/103-map-france-town.html#可视化",
    "href": "Hiplot/103-map-france-town.html#可视化",
    "title": "法国地图 (镇)",
    "section": "可视化",
    "text": "可视化\n\n# 法国地图 (镇)\np &lt;- ggplot(dt_map) +\n  geom_polygon(aes(x = long, y = lat, group = group, fill = Value),\n               alpha = 0.9, size = 0.5) +\n  geom_path(aes(x = long, y = lat, group = group), color = \"black\", size = 0.2) +\n  coord_fixed() +\n  scale_fill_gradientn(\n    colours = colorRampPalette(rev(brewer.pal(11,\"RdYlBu\")))(500),\n    breaks = seq(min(data$value), max(data$value), \n                 round((max(data$value)-min(data$value))/7)),\n    name = \"Color Key\",\n    guide = guide_legend(\n      direction = \"vertical\", keyheight = unit(1, units = \"mm\"),\n      keywidth = unit(8, units = \"mm\"),\n      title.position = \"top\", title.hjust = 0.5, label.hjust = 0.5,\n      nrow = 1, byrow = T, reverse = F, label.position = \"bottom\")) +\n  theme(text = element_text(color = \"#3A3F4A\"),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank(),\n        legend.position = \"top\",\n        legend.text = element_text(size = 4 * 1.5, color = \"black\"),\n        legend.title = element_text(size = 5 * 1.5, color = \"black\"),\n        plot.title = element_text(\n          face = \"bold\", size = 5 * 1.5, hjust = 0.5, \n          margin = margin(t = 4, b = 5), color = \"black\"),\n        plot.background = element_rect(fill = \"#FFFFFF\", color = \"#FFFFFF\"),\n        panel.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        legend.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        plot.margin = unit(c(1.5, 1.5, 1.5, 1.5), \"cm\")) +\n  labs(x = NULL, y = NULL, title = \"France Map\")\n\np\n\n\n\n\n\n\n\n图 1: 法国地图 (镇)",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "France Map (Town)"
    ]
  },
  {
    "objectID": "Hiplot/093-line-errorbar.html",
    "href": "Hiplot/093-line-errorbar.html",
    "title": "线图（误差线）",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Line (errorbar) 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/line-errorbar?lang=zh_cn\n误差线主要指示数据每一个数据点的误差范围，显示潜在的误差或相对于系列中每一个数据的的不确定程度。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Line (errorbar)"
    ]
  },
  {
    "objectID": "Hiplot/093-line-errorbar.html#环境配置",
    "href": "Hiplot/093-line-errorbar.html#环境配置",
    "title": "线图（误差线）",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggpubr\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggpubr\", quietly = TRUE)) {\n  install.packages(\"ggpubr\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggpubr)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n ggpubr     * 0.6.2   2025-10-17 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Line (errorbar)"
    ]
  },
  {
    "objectID": "Hiplot/093-line-errorbar.html#数据准备",
    "href": "Hiplot/093-line-errorbar.html#数据准备",
    "title": "线图（误差线）",
    "section": "数据准备",
    "text": "数据准备\n载入数据为两种分组及其对应的数值。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/line-errorbar/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndata[, 3] &lt;- factor(data[, 3], levels = unique(data[, 3]))\n\n# 查看数据\nhead(data)\n\n  Value Group2 Group1\n1   4.2 treat1    low\n2  11.5 treat1    low\n3   7.3 treat1    low\n4   5.8 treat1    low\n5   6.4 treat1    low\n6  10.0 treat1    low",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Line (errorbar)"
    ]
  },
  {
    "objectID": "Hiplot/093-line-errorbar.html#可视化",
    "href": "Hiplot/093-line-errorbar.html#可视化",
    "title": "线图（误差线）",
    "section": "可视化",
    "text": "可视化\n\n# 线图（误差线）\np &lt;- ggline(\n  data, x = \"Group1\", y = \"Value\", color = \"Group2\",\n  add = \"mean_se\", title = \"Line plot with errorbar\", palette = \"npg\") +\n  stat_compare_means(aes_(group = as.name(\"Group2\"))) +\n  theme_bw() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12, hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 1: 线图（误差线）\n\n\n\n\n\nlow 类型中的红色上线表示 treat1 中 low 类型中数值最大值，红色下线表示 treat1 中 low 类型中数值最小值，其他以此类推。分别对treat1 和 treat2 按照 low，mid，high 类型进行秩和检验，显示 P 值于图形上方。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Line (errorbar)"
    ]
  },
  {
    "objectID": "Hiplot/151-rcs-cox.html",
    "href": "Hiplot/151-rcs-cox.html",
    "title": "限制性立方样条 COX 模型",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot RCS-COX 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/rcs-cox?lang=zh_cn\n非线性回归分析。",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "RCS-COX"
    ]
  },
  {
    "objectID": "Hiplot/151-rcs-cox.html#环境配置",
    "href": "Hiplot/151-rcs-cox.html#环境配置",
    "title": "限制性立方样条 COX 模型",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; rms; survival; ggplot2; stringr\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"rms\", quietly = TRUE)) {\n  install.packages(\"rms\")\n}\nif (!requireNamespace(\"survival\", quietly = TRUE)) {\n  install.packages(\"survival\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"stringr\", quietly = TRUE)) {\n  install.packages(\"stringr\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(rms)\nlibrary(survival)\nlibrary(ggplot2)\nlibrary(stringr)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n Hmisc      * 5.2-4   2025-10-05 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n rms        * 8.1-0   2025-10-14 [1] RSPM\n stringr    * 1.6.0   2025-11-04 [1] RSPM\n survival   * 3.8-3   2024-12-17 [3] CRAN (R 4.5.2)\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "RCS-COX"
    ]
  },
  {
    "objectID": "Hiplot/151-rcs-cox.html#数据准备",
    "href": "Hiplot/151-rcs-cox.html#数据准备",
    "title": "限制性立方样条 COX 模型",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/rcs-cox/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndata &lt;- na.omit(data)\nex &lt;- set::not(colnames(data), c(\"main\", \"time\", \"event\"))\nex &lt;- str_c(ex, collapse = \"+\")\ndd &lt;&lt;- datadist(data)\noptions(datadist = \"dd\")\nfor (i in 3:5) {\n  fit &lt;- coxph(as.formula(paste0(\"Surv(time, event) ~ rcs(main, nk = i, inclx = T)+\", ex, collapse = \"+\")), data = data, x = TRUE)\n  tmp &lt;- extractAIC(fit)\n  if (i == 3) {\n    AIC &lt;- tmp[2]\n    nk &lt;&lt;- 3\n  }\n  if (tmp[2] &lt; AIC) {\n    AIC &lt;- tmp[2]\n    nk &lt;&lt;- i\n  }\n}\nfit &lt;- cph(as.formula(paste0(\"Surv(time, event) ~ rcs(main, nk = nk, inclx = T)+\", ex, collapse = \"+\")), data = data, x = TRUE)\ndd$limits$main[2] &lt;- median(data$main)\nfit &lt;- update(fit)\norr &lt;- Predict(fit, main, fun = exp, ref.zero = TRUE)\n\n# 查看数据\nhead(data)\n\n      main x1 x2 time event\n1 25.54051  1  1 2178     0\n2 24.02398  1  2 2172     0\n3 22.14290  1  3 2190     0\n4 26.63187  1  4  297     1\n5 24.41255  1  5 2131     0\n6 23.24236  1  6    1     1",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "RCS-COX"
    ]
  },
  {
    "objectID": "Hiplot/151-rcs-cox.html#可视化",
    "href": "Hiplot/151-rcs-cox.html#可视化",
    "title": "限制性立方样条 COX 模型",
    "section": "可视化",
    "text": "可视化\n\n# 限制性立方样条 COX 模型\np &lt;- ggplot() +\n  geom_line(data = orr, aes(main, yhat), linetype = \"solid\", size = 1, alpha = 1,\n            colour = \"#FF0000\") +\n  geom_ribbon(data = orr, aes(main, ymin = lower, ymax = upper), alpha = 0.6, \n              fill = \"#FFC0CB\") +\n  geom_hline(yintercept = 1, linetype = 2, size = 0.5) +\n  geom_vline(xintercept = dd$limits$main[2], linetype = 2, size = 0.5) +\n  labs(x = \" \", y = \"Hazard Ratio(95%CI)\") +\n  theme_bw() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n \np\n\n\n\n\n\n\n\n图 1: 限制性立方样条 COX 模型",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "RCS-COX"
    ]
  },
  {
    "objectID": "Hiplot/129-neural-network.html",
    "href": "Hiplot/129-neural-network.html",
    "title": "神经网络",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Neural Network 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/neural-network?lang=zh_cn",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Neural Network"
    ]
  },
  {
    "objectID": "Hiplot/129-neural-network.html#环境配置",
    "href": "Hiplot/129-neural-network.html#环境配置",
    "title": "神经网络",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; NeuralNetTools; nnet\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"NeuralNetTools\", quietly = TRUE)) {\n  install.packages(\"NeuralNetTools\")\n}\nif (!requireNamespace(\"nnet\", quietly = TRUE)) {\n  install.packages(\"nnet\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(NeuralNetTools)\nlibrary(nnet)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package        * version date (UTC) lib source\n data.table     * 1.17.8  2025-07-10 [1] RSPM\n jsonlite       * 2.0.0   2025-03-27 [1] RSPM\n NeuralNetTools * 1.5.3   2022-01-06 [1] RSPM\n nnet           * 7.3-20  2025-01-01 [3] CRAN (R 4.5.2)\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Neural Network"
    ]
  },
  {
    "objectID": "Hiplot/129-neural-network.html#数据准备",
    "href": "Hiplot/129-neural-network.html#数据准备",
    "title": "神经网络",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/neural-network/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 查看数据\nhead(data)\n\n         Y1        Y2          X1         X2         X3\n1 0.7646258 0.5494452 -0.89691455 -1.8923489  0.6408445\n2 0.2383994 0.4605024  0.18484918  1.2928042 -1.6013778\n3 0.3800247 0.2527468  1.58784533 -0.6182543 -0.7778154\n4 0.3545279 0.6319730 -1.13037567  1.0409383 -1.6473925\n5 0.3667356 0.4684437 -0.08025176  1.1758795  0.1542662\n6 0.5509560 0.4439474  0.13242028 -1.5018321 -1.1756313",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Neural Network"
    ]
  },
  {
    "objectID": "Hiplot/129-neural-network.html#可视化",
    "href": "Hiplot/129-neural-network.html#可视化",
    "title": "神经网络",
    "section": "可视化",
    "text": "可视化\n\n# 神经网络\nmod &lt;- nnet(Y1 ~ X1 + X2 + X3, data = neuraldat, size = 10,\n            maxint = 100, decay = 0)\n\n# weights:  51\ninitial  value 61.996560 \niter  10 value 0.526277\niter  20 value 0.235248\niter  30 value 0.171233\niter  40 value 0.123628\niter  50 value 0.057141\niter  60 value 0.036613\niter  70 value 0.027728\niter  80 value 0.021773\niter  90 value 0.018570\niter 100 value 0.014148\nfinal  value 0.014148 \nstopped after 100 iterations\n\n# plot\npar(mar = numeric(4))\nplotnet(mod)\n\n\n\n\n\n\n\n图 1: 神经网络",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Neural Network"
    ]
  },
  {
    "objectID": "Hiplot/183-volcano.html",
    "href": "Hiplot/183-volcano.html",
    "title": "火山图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Volcano 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/volcano?lang=zh_cn\n火山图是一种直观展示两个样本间基因差异表达的分布图。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Volcano"
    ]
  },
  {
    "objectID": "Hiplot/183-volcano.html#环境配置",
    "href": "Hiplot/183-volcano.html#环境配置",
    "title": "火山图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggpubr\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggpubr\", quietly = TRUE)) {\n  install.packages(\"ggpubr\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggpubr)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n ggpubr     * 0.6.2   2025-10-17 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Volcano"
    ]
  },
  {
    "objectID": "Hiplot/183-volcano.html#数据准备",
    "href": "Hiplot/183-volcano.html#数据准备",
    "title": "火山图",
    "section": "数据准备",
    "text": "数据准备\n载入数据为基因名称及其对应的 logFC 和 p.value。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/volcano/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\n## 对差异p(adj.P.Val一列)进行log10转换\ndata[, \"logP\"] &lt;- -log10(as.numeric(data[, \"P.Value\"]))\ndata[, \"logFC\"] &lt;- as.numeric(data[, \"logFC\"])\n## 新加一列Group\ndata[, \"Group\"] &lt;- \"not-significant\"\n## Up and down\ndata$Group[which((data[, \"P.Value\"] &lt; 0.05) & (data$logFC &gt;= 2))] &lt;- \"Up-regulated\"\ndata$Group[which((data[, \"P.Value\"] &lt; 0.05) & (data$logFC &lt;= 2 * -1))] &lt;- \"Down-regulated\"\n## 新加一列Label\ndata[[\"Label\"]] &lt;- \"\"\n## 对差异表达基因的p值进行从小到大排序\ndata &lt;- data[order(data[, \"P.Value\"]), ]\n## 高表达的基因中，选择adj.P.Val最小的10个\nup_genes &lt;- head(data[, \"Symbol\"][which(data$Group == \"Up-regulated\")], 10)\ndown_genes &lt;- head(data[, \"Symbol\"][which(data$Group == \"Down-regulated\")], 10)\nnot_sig_genes &lt;- NA\n## 将up_genes和down_genes合并，并加入到Label中\ndeg_top_genes &lt;- c(as.character(up_genes), as.character(not_sig_genes),\nas.character(down_genes))\ndeg_top_genes &lt;- deg_top_genes[!is.na(deg_top_genes)]\ndata$Label[match(deg_top_genes, data[, \"Symbol\"])] &lt;- deg_top_genes\n\n# 查看数据\nhead(data)\n\n    Symbol     logFC  P.Value     logP           Group    Label\n1      LTB  2.580831 1.17e-14 13.93181    Up-regulated      LTB\n2    CDCA5 -2.326302 2.46e-13 12.60906  Down-regulated    CDCA5\n3 C10orf54  3.307901 3.53e-13 12.45223    Up-regulated C10orf54\n4    CAPN7  2.514235 1.04e-12 11.98297    Up-regulated    CAPN7\n5     OIP5 -2.166620 1.43e-12 11.84466  Down-regulated     OIP5\n7     PKIG -1.560504 1.58e-12 11.80134 not-significant",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Volcano"
    ]
  },
  {
    "objectID": "Hiplot/183-volcano.html#可视化",
    "href": "Hiplot/183-volcano.html#可视化",
    "title": "火山图",
    "section": "可视化",
    "text": "可视化\n\n# 火山图\noptions(ggrepel.max.overlaps = 100)\np &lt;- ggscatter(data, x = \"logFC\", y = \"logP\", color = \"Group\", \n               palette = c(\"#2f5688\", \"#BBBBBB\", \"#CC0000\"), size = 1, \n               alpha = 0.5, font.label = 8, repel = TRUE, label=data$Label,\n               xlab = \"log2(Fold Change)\", ylab = \"-log10(P Value)\",\n               show.legend.text = FALSE) +\n  ggtitle(\"Volcano Plot\") +\n  geom_hline(yintercept = -log(0.05, 10), linetype = \"dashed\") +\n  geom_vline(xintercept = c(2, -2), linetype = \"dashed\") +\n  theme_bw() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 1: 火山图\n\n\n\n\n\n横轴用 log2（fold change）表示，差异越大的基因分布在图片两端。纵坐标用 -log10（p.value）表示，取值为 T 检验显著性 P 值的负对数。蓝色的点代表下调的基因，红色的点代表上调的基因，灰色的点代表差异不显著的基因。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Volcano"
    ]
  },
  {
    "objectID": "Hiplot/109-map-oceania-antarc.html",
    "href": "Hiplot/109-map-oceania-antarc.html",
    "title": "大洋洲/南极洲地图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Oceania/Antarc Map 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/map-oceania-antarc?lang=zh_cn",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Oceania/Antarc Map"
    ]
  },
  {
    "objectID": "Hiplot/109-map-oceania-antarc.html#环境配置",
    "href": "Hiplot/109-map-oceania-antarc.html#环境配置",
    "title": "大洋洲/南极洲地图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2; RColorBrewer\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(RColorBrewer)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package      * version date (UTC) lib source\n data.table   * 1.17.8  2025-07-10 [1] RSPM\n ggplot2      * 4.0.1   2025-11-14 [1] RSPM\n jsonlite     * 2.0.0   2025-03-27 [1] RSPM\n RColorBrewer * 1.1-3   2022-04-03 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Oceania/Antarc Map"
    ]
  },
  {
    "objectID": "Hiplot/109-map-oceania-antarc.html#数据准备",
    "href": "Hiplot/109-map-oceania-antarc.html#数据准备",
    "title": "大洋洲/南极洲地图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/map-oceania-antarc/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\ndt_map &lt;- readRDS(url(\"https://download.hiplot.cn/ui/basic/map-oceania-antarc/oca.rds\"))\n\n# 整理数据格式\ndt_map$Value &lt;- data$value[match(dt_map$ENG_NAME, data$region)]\n\n# 查看数据\nhead(data)\n\n                      region value\n1        American Samoa (US)   672\n2                 Antarctica     3\n3    Pacific Is Refuges (US)   320\n4 Cook Islands (NEW ZEALAND)   740\n5                       FIJI   303\n6  French Polynesia (FRANCE)   879",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Oceania/Antarc Map"
    ]
  },
  {
    "objectID": "Hiplot/109-map-oceania-antarc.html#可视化",
    "href": "Hiplot/109-map-oceania-antarc.html#可视化",
    "title": "大洋洲/南极洲地图",
    "section": "可视化",
    "text": "可视化\n\n# 大洋洲/南极洲地图\np &lt;- ggplot(dt_map) +\n  geom_polygon(aes(x = long, y = lat, group = group, fill = Value),\n               alpha = 0.9, size = 0.5) +\n  geom_path(aes(x = long, y = lat, group = group), color = \"black\", size = 0.2) +\n  coord_fixed() +\n  scale_fill_gradientn(\n    colours = colorRampPalette(rev(brewer.pal(11,\"RdYlBu\")))(500),\n    breaks = seq(min(data$value), max(data$value), \n                 round((max(data$value)-min(data$value))/7)),\n    name = \"Color Key\",\n    guide = guide_legend(\n      direction = \"vertical\", keyheight = unit(1, units = \"mm\"),\n      keywidth = unit(8, units = \"mm\"),\n      title.position = \"top\", title.hjust = 0.5, label.hjust = 0.5,\n      nrow = 1, byrow = T, reverse = F, label.position = \"bottom\")) +\n  theme(text = element_text(color = \"#3A3F4A\"),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank(),\n        legend.position = \"top\",\n        legend.text = element_text(size = 4 * 1.5, color = \"black\"),\n        legend.title = element_text(size = 5 * 1.5, color = \"black\"),\n        plot.title = element_text(\n          face = \"bold\", size = 5 * 1.5, hjust = 0.5, \n          margin = margin(t = 4, b = 5), color = \"black\"),\n        plot.background = element_rect(fill = \"#FFFFFF\", color = \"#FFFFFF\"),\n        panel.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        legend.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        plot.margin = unit(c(1.5, 1.5, 1.5, 1.5), \"cm\")) +\n  labs(x = NULL, y = NULL, title = \"Oceania/Antarc Map\")\n\np\n\n\n\n\n\n\n\n图 1: 大洋洲/南极洲地图",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Oceania/Antarc Map"
    ]
  },
  {
    "objectID": "Hiplot/145-pyramid-chart2.html",
    "href": "Hiplot/145-pyramid-chart2.html",
    "title": "金字塔图 2",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Pyramid Chart 2 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/pyramid-chart2?lang=zh_cn\n金字塔图是一种将数据分布于中轴两侧类似金字塔的图形。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pyramid Chart 2"
    ]
  },
  {
    "objectID": "Hiplot/145-pyramid-chart2.html#环境配置",
    "href": "Hiplot/145-pyramid-chart2.html#环境配置",
    "title": "金字塔图 2",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; apyramid; ggplot2\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"apyramid\", quietly = TRUE)) {\n  install.packages(\"apyramid\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(apyramid)\nlibrary(ggplot2)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n apyramid   * 0.1.3   2023-02-14 [1] RSPM\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pyramid Chart 2"
    ]
  },
  {
    "objectID": "Hiplot/145-pyramid-chart2.html#数据准备",
    "href": "Hiplot/145-pyramid-chart2.html#数据准备",
    "title": "金字塔图 2",
    "section": "数据准备",
    "text": "数据准备\n载入数据为年龄段，性别分类及前两种变量组合后的人口数目。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/pyramid-chart2/data.json\")$exampleData[[1]]$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\nx &lt;- as.integer(data[,\"age\"])\ndata$age_group &lt;- cut(x, breaks = pretty(x), right = TRUE, include.lowest = TRUE)\n\n# 查看数据\nhead(data[,1:5])\n\n  case_id date_of_onset date_of_hospitalisation date_of_outcome outcome\n1       1     2013/2/19                    &lt;NA&gt;        2013/3/4   Death\n2       2     2013/2/27                2013/3/3       2013/3/10   Death\n3       3      2013/3/9               2013/3/19        2013/4/9   Death\n4       4     2013/3/19               2013/3/27            &lt;NA&gt;    &lt;NA&gt;\n5       5     2013/3/19               2013/3/30       2013/5/15 Recover\n6       6     2013/3/21               2013/3/28       2013/4/26   Death",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pyramid Chart 2"
    ]
  },
  {
    "objectID": "Hiplot/145-pyramid-chart2.html#可视化",
    "href": "Hiplot/145-pyramid-chart2.html#可视化",
    "title": "金字塔图 2",
    "section": "可视化",
    "text": "可视化\n\n# 金字塔图2\np &lt;- age_pyramid(data, \"age_group\", split_by = \"Gender\") + \n  scale_fill_manual(values = c(\"#BC3C29FF\",\"#0072B5FF\")) +\n  xlab(\"Age group\") + \n  ylab(\"Gender\") +\n  theme_classic() +\n  theme(text = element_text(family = \"Arial\"),\n      plot.title = element_text(size = 12,hjust = 0.5),\n      axis.title = element_text(size = 12),\n      axis.text = element_text(size = 10),\n      axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n      legend.position = \"right\",\n      legend.direction = \"vertical\",\n      legend.title = element_text(size = 10),\n      legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 1: 金字塔图2\n\n\n\n\n\n图示将年龄段按照顺序从下到上依次显示在中轴线上，左侧表示男性人数，右侧表示女性人数，x 轴表示人口数量，该图可以很明显看出男女在不同年龄段的人数占比情况以及相同性别中不同年龄组的占比情况。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pyramid Chart 2"
    ]
  },
  {
    "objectID": "Hiplot/178-venn.html",
    "href": "Hiplot/178-venn.html",
    "title": "韦恩图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Venn 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/venn?lang=zh_cn\n维恩图是一种表示不同有限集合之间所有可能的逻辑关系的图。这些图将集合内元素描述为平面上的点，将集合描述为封闭曲线内的区域。维恩图由多个重叠的闭合曲线 (通常是圆) 组成，每个曲线代表一个集合。标记为S曲线内的点表示集合 S 中的元素，而边界外的点表示集合 S 中不存在的元素。例如，两个集合中的所有元素的交集，S∩T，在视觉上用集合 S 和 T 的重叠区域来表示。在维恩图中，曲线以各种可能的方式重叠，显示了集合之间所有可能的关系。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Venn"
    ]
  },
  {
    "objectID": "Hiplot/178-venn.html#环境配置",
    "href": "Hiplot/178-venn.html#环境配置",
    "title": "韦恩图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; VennDiagram; grDevices\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"VennDiagram\", quietly = TRUE)) {\n  install.packages(\"VennDiagram\")\n}\nif (!requireNamespace(\"grDevices\", quietly = TRUE)) {\n  install.packages(\"grDevices\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(VennDiagram)\nlibrary(grDevices)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package       * version date (UTC) lib source\n data.table    * 1.17.8  2025-07-10 [1] RSPM\n futile.logger * 1.4.3   2016-07-10 [1] RSPM\n jsonlite      * 2.0.0   2025-03-27 [1] RSPM\n VennDiagram   * 1.7.3   2022-04-12 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Venn"
    ]
  },
  {
    "objectID": "Hiplot/178-venn.html#数据准备",
    "href": "Hiplot/178-venn.html#数据准备",
    "title": "韦恩图",
    "section": "数据准备",
    "text": "数据准备\n载入数据为 5 个含有基因名称的集合。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/venn/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\nfor (i in seq_len(ncol(data))) {\n  data[is.na(data[, i]), i] &lt;- \"\"\n}\nraw &lt;- data\ndata &lt;- as.data.frame(raw[raw[, 1] != \"\", 1])\ncolnames(data) &lt;- colnames(raw)[1]\nlist.num &lt;- 1\nfor (i in 2:ncol(raw)) {\n  if (any(!is.na(raw[, i]) & raw[, i] != \"\")) {\n    tmp &lt;- raw[i]\n    tmp &lt;- tmp[tmp[, 1] != \"\", ]\n    tmp &lt;- as.data.frame(tmp)\n    colnames(tmp) &lt;- colnames(raw)[i]\n    assign(paste0(\"data\", i), tmp)\n    list.num &lt;- list.num + 1\n  }\n}\ncolnames(data) &lt;- paste(\"V\", seq_len(ncol(data)), sep = \"\")\ncolnames(data2) &lt;- paste(\"V\", seq_len(ncol(data2)), sep = \"\")\ncolnames(data3) &lt;- paste(\"V\", seq_len(ncol(data3)), sep = \"\")\ncolnames(data4) &lt;- paste(\"V\", seq_len(ncol(data4)), sep = \"\")\ncolnames(data5) &lt;- paste(\"V\", seq_len(ncol(data5)), sep = \"\")\ndata_list &lt;- list(\n  n1 = data$V1, n2 = data2$V1, n3 = data3$V1,\n  n4 = data4$V1, n5 = data5$V1\n)\nnames(data_list) &lt;- colnames(raw)[1:5]\n\n# 查看数据\nhead(data)\n\n       V1\n1   ISG15\n2  TTLL10\n3    HES4\n4  OR4G4P\n5 MND2P28\n6  FAM87B",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Venn"
    ]
  },
  {
    "objectID": "Hiplot/178-venn.html#可视化",
    "href": "Hiplot/178-venn.html#可视化",
    "title": "韦恩图",
    "section": "可视化",
    "text": "可视化\n\n# 韦恩图\ncol &lt;- c(\"#E64B35FF\",\"#4DBBD5FF\",\"#00A087FF\",\"#3C5488FF\",\"#F39B7FFF\")\np &lt;- venn.diagram(\n  data_list, scaled = F, euler.d = F, filename = NULL, col = \"black\",\n  fill = col,\n  cex = c(\n    1.5, 1.5, 1.5, 1.5, 1.5, 1, 0.8, 1, 0.8, 1, 0.8, 1, 0.8,\n    1, 0.8, 1, 0.55, 1, 0.55, 1, 0.55, 1, 0.55, 1, 0.55, 1, 1, 1, 1, 1, 1.5\n  ),\n  cat.col = col, cat.cex = 1,\n  main.fontfamily = \"Arial\", fontfamily = \"Arial\", cat.fontface = \"bold\",\n  cat.fontfamily = \"Arial\", margin = 0.1, main = \"Vene Plot\", alpha = 0.8\n);grid::grid.draw(p)\n\n\n\n\n\n\n\n图 1: 韦恩图\n\n\n\n\n\n5 种颜色的闭合曲线代表 5 个集合，数字表示多个集合重叠或者未重叠的基因数，例如：示例图中 8 代表 5 个示例集合中均含有 8 个相同的基因名称。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Venn"
    ]
  },
  {
    "objectID": "Hiplot/001-area.html",
    "href": "Hiplot/001-area.html",
    "title": "面积图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Area Plot 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/area?lang=zh_cn\n面积图是一种基于折线图并以图形方式显示定量数据的图形。轴和线之间的区域通常用颜色、纹理和图案来强调。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Area"
    ]
  },
  {
    "objectID": "Hiplot/001-area.html#环境配置",
    "href": "Hiplot/001-area.html#环境配置",
    "title": "面积图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2; ggthemes\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"ggthemes\", quietly = TRUE)) {\n  install.packages(\"ggthemes\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(ggthemes)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n ggthemes   * 5.2.0   2025-11-30 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Area"
    ]
  },
  {
    "objectID": "Hiplot/001-area.html#数据准备",
    "href": "Hiplot/001-area.html#数据准备",
    "title": "面积图",
    "section": "数据准备",
    "text": "数据准备\n载入数据为 x 轴数值和 y 轴数值。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/area/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 查看数据\nhead(data)\n\n   group xaxis.value yaxis.value\n1 Group1        1900          26\n2 Group1        1901          27\n3 Group1        1902          10\n4 Group1        1903          16\n5 Group1        1904          19\n6 Group1        1905          18",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Area"
    ]
  },
  {
    "objectID": "Hiplot/001-area.html#可视化",
    "href": "Hiplot/001-area.html#可视化",
    "title": "面积图",
    "section": "可视化",
    "text": "可视化\n\n# 面积图\np &lt;- ggplot(data, aes(x = xaxis.value, y = yaxis.value, fill = group)) +\n  geom_area(alpha = 1) +\n  ylab(\"yaxis.value\") +\n  xlab(\"xaxis.value\") +\n  ggtitle(\"Area Plot\") +\n  scale_fill_manual(values = c(\"#e04d39\",\"#5bbad6\",\"#1e9f86\")) +\n  theme_stata() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 1: 面积图\n\n\n\n\n\n不同颜色代表不同组的面积图。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Area"
    ]
  },
  {
    "objectID": "Hiplot/035-custom-icon-scatter.html",
    "href": "Hiplot/035-custom-icon-scatter.html",
    "title": "自定义图标散点图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Custom Icon Scatter 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/custom-icon-scatter?lang=zh_cn\n可自定义图标的散点图。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Custom Icon Scatter"
    ]
  },
  {
    "objectID": "Hiplot/035-custom-icon-scatter.html#环境配置",
    "href": "Hiplot/035-custom-icon-scatter.html#环境配置",
    "title": "自定义图标散点图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; echarts4r; echarts4r.assets\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"echarts4r\", quietly = TRUE)) {\n  install.packages(\"echarts4r\")\n}\nif (!requireNamespace(\"echarts4r.assets\", quietly = TRUE)) {\n  remotes::install_github(\"JohnCoene/echarts4r.assets\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(echarts4r)\nlibrary(echarts4r.assets)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package          * version date (UTC) lib source\n data.table       * 1.17.8  2025-07-10 [1] RSPM\n echarts4r        * 0.4.6   2025-09-11 [1] RSPM\n echarts4r.assets * 0.0.1   2025-11-02 [1] Github (JohnCoene/echarts4r.assets@77b1fe0)\n jsonlite         * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Custom Icon Scatter"
    ]
  },
  {
    "objectID": "Hiplot/035-custom-icon-scatter.html#数据准备",
    "href": "Hiplot/035-custom-icon-scatter.html#数据准备",
    "title": "自定义图标散点图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/custom-icon-scatter/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndraw_data &lt;- data.frame(\n  x = data[[\"mpg\"]],\n  y = data[[\"wt\"]],\n  size = data[[\"qsec\"]]\n  )\nrm(data)\n\n# 查看数据\nhead(draw_data)\n\n     x     y  size\n1 21.0 2.620 16.46\n2 21.0 2.875 17.02\n3 22.8 2.320 18.61\n4 21.4 3.215 19.44\n5 18.7 3.440 17.02\n6 18.1 3.460 20.22",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Custom Icon Scatter"
    ]
  },
  {
    "objectID": "Hiplot/035-custom-icon-scatter.html#可视化",
    "href": "Hiplot/035-custom-icon-scatter.html#可视化",
    "title": "自定义图标散点图",
    "section": "可视化",
    "text": "可视化\n\n# 自定义图标散点图\np &lt;- draw_data |&gt;\n  e_charts(x) |&gt;\n  e_scatter(\n    y,\n    size,\n    symbol = ea_icons(\"warning\"),\n    name = \"warning\"\n    )\n\np\n\n\n\n\n\n\n\n图 1: 自定义图标散点图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Custom Icon Scatter"
    ]
  },
  {
    "objectID": "Hiplot/113-map-uk.html",
    "href": "Hiplot/113-map-uk.html",
    "title": "英国地图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot UK Map 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/map-uk?lang=zh_cn",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "South America Map"
    ]
  },
  {
    "objectID": "Hiplot/113-map-uk.html#环境配置",
    "href": "Hiplot/113-map-uk.html#环境配置",
    "title": "英国地图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2; RColorBrewer\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(RColorBrewer)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package      * version date (UTC) lib source\n data.table   * 1.17.8  2025-07-10 [1] RSPM\n ggplot2      * 4.0.1   2025-11-14 [1] RSPM\n jsonlite     * 2.0.0   2025-03-27 [1] RSPM\n RColorBrewer * 1.1-3   2022-04-03 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "South America Map"
    ]
  },
  {
    "objectID": "Hiplot/113-map-uk.html#数据准备",
    "href": "Hiplot/113-map-uk.html#数据准备",
    "title": "英国地图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/map-uk/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\ndt_map &lt;- readRDS(url(\"https://download.hiplot.cn/ui/basic/map-uk/uk.rds\"))\n\n# 整理数据格式\ndt_map$Value &lt;- data$value[match(dt_map$name, data$name)]\n\n# 查看数据\nhead(data)\n\n              name value\n1 Northern Ireland   691\n2         Scotland   455\n3          England   530\n4            Wales   767",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "South America Map"
    ]
  },
  {
    "objectID": "Hiplot/113-map-uk.html#可视化",
    "href": "Hiplot/113-map-uk.html#可视化",
    "title": "英国地图",
    "section": "可视化",
    "text": "可视化\n\n# 英国地图\np &lt;- ggplot(dt_map) +\n  geom_polygon(aes(x = long, y = lat, group = group, fill = Value),\n               alpha = 0.9, size = 0.5) +\n  geom_path(aes(x = long, y = lat, group = group), color = \"black\", size = 0.2) +\n  coord_fixed() +\n  scale_fill_gradientn(\n    colours = colorRampPalette(rev(brewer.pal(11,\"RdYlBu\")))(500),\n    breaks = seq(min(data$value), max(data$value), \n                 round((max(data$value)-min(data$value))/7)),\n    name = \"Color Key\",\n    guide = guide_legend(\n      direction = \"vertical\", keyheight = unit(1, units = \"mm\"),\n      keywidth = unit(8, units = \"mm\"),\n      title.position = \"top\", title.hjust = 0.5, label.hjust = 0.5,\n      nrow = 1, byrow = T, reverse = F, label.position = \"bottom\")) +\n  theme(text = element_text(color = \"#3A3F4A\"),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank(),\n        legend.position = \"top\",\n        legend.text = element_text(size = 4 * 1.5, color = \"black\"),\n        legend.title = element_text(size = 5 * 1.5, color = \"black\"),\n        plot.title = element_text(\n          face = \"bold\", size = 5 * 1.5, hjust = 0.5, \n          margin = margin(t = 4, b = 5), color = \"black\"),\n        plot.background = element_rect(fill = \"#FFFFFF\", color = \"#FFFFFF\"),\n        panel.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        legend.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        plot.margin = unit(c(1.5, 1.5, 1.5, 1.5), \"cm\")) +\n  labs(x = NULL, y = NULL, title = \"UK Map\")\n\np\n\n\n\n\n\n\n\n图 1: 英国地图",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "South America Map"
    ]
  },
  {
    "objectID": "Hiplot/100-map-china.html",
    "href": "Hiplot/100-map-china.html",
    "title": "中国地图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot China Map 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/map-china?lang=zh_cn",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "China Map"
    ]
  },
  {
    "objectID": "Hiplot/100-map-china.html#环境配置",
    "href": "Hiplot/100-map-china.html#环境配置",
    "title": "中国地图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2; RColorBrewer\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(RColorBrewer)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package      * version date (UTC) lib source\n data.table   * 1.17.8  2025-07-10 [1] RSPM\n ggplot2      * 4.0.1   2025-11-14 [1] RSPM\n jsonlite     * 2.0.0   2025-03-27 [1] RSPM\n RColorBrewer * 1.1-3   2022-04-03 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "China Map"
    ]
  },
  {
    "objectID": "Hiplot/100-map-china.html#数据准备",
    "href": "Hiplot/100-map-china.html#数据准备",
    "title": "中国地图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/map-china/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\ndt_map &lt;- readRDS(url(\"https://download.hiplot.cn/ui/basic/map-china/china.rds\"))\n\n# 整理数据格式\ndt_map$Value &lt;- data$value[match(dt_map$FCNAME, data$name)]\n\n# 查看数据\nhead(data)\n\n    name value\n1 安徽省  6118\n2 福建省  3581\n3 甘肃省  2617\n4 广东省  9449\n5 贵州省  3762\n6 海南省   845",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "China Map"
    ]
  },
  {
    "objectID": "Hiplot/100-map-china.html#可视化",
    "href": "Hiplot/100-map-china.html#可视化",
    "title": "中国地图",
    "section": "可视化",
    "text": "可视化\n\n# 中国地图\np &lt;- ggplot(dt_map, aes(x = long, y = lat, group = group, fill = Value)) +\n  labs(fill = \"Value\") +\n  geom_polygon() +\n  geom_path() +\n  coord_fixed() +\n  scale_fill_gradientn(\n    colours = colorRampPalette(rev(brewer.pal(11,\"RdYlBu\")))(500),\n    na.value = \"grey10\",\n    limits = c(0, max(dt_map$Value) * 1.2)) +\n    ggtitle(\"China Map Plot\") +\n  theme_minimal()\n\np\n\n\n\n\n\n\n\n图 1: 中国地图",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "China Map"
    ]
  },
  {
    "objectID": "Hiplot/024-circular-pie-chart.html",
    "href": "Hiplot/024-circular-pie-chart.html",
    "title": "环形饼图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Circular Pie Chart 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/circular-pie-chart?lang=zh_cn\n饼图的另一种形式",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Circular Pie Chart"
    ]
  },
  {
    "objectID": "Hiplot/024-circular-pie-chart.html#环境配置",
    "href": "Hiplot/024-circular-pie-chart.html#环境配置",
    "title": "环形饼图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Circular Pie Chart"
    ]
  },
  {
    "objectID": "Hiplot/024-circular-pie-chart.html#数据准备",
    "href": "Hiplot/024-circular-pie-chart.html#数据准备",
    "title": "环形饼图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/circular-pie-chart/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndata$draw_percent &lt;- data[[\"values\"]] / sum(data[[\"values\"]]) * 100\ndata$draw_class &lt;- 1\ndata2 &lt;- data\ndata2[[\"values\"]] &lt;- 0\ndata2$draw_class &lt;- 0\ndata &lt;- rbind(data, data2)\nfiltered_data &lt;- data[data[[\"values\"]] &gt; 0,]\n\n# 查看数据\nhead(data)\n\n  labels values draw_percent draw_class\n1      A     20    16.666667          1\n2      B     30    25.000000          1\n3      C     15    12.500000          1\n4      D     10     8.333333          1\n5      E     45    37.500000          1\n6      A      0    16.666667          0",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Circular Pie Chart"
    ]
  },
  {
    "objectID": "Hiplot/024-circular-pie-chart.html#可视化",
    "href": "Hiplot/024-circular-pie-chart.html#可视化",
    "title": "环形饼图",
    "section": "可视化",
    "text": "可视化\n\n# 环形饼图\np &lt;- ggplot(data, aes(x = draw_class, y = values, fill = labels)) +\n  geom_bar(position = \"stack\", stat = \"identity\", width = 0.7) +\n  geom_text(data = filtered_data, aes(label = sprintf(\"%.2f%%\", draw_percent)),\n            position = position_stack(vjust = 0.5), size = 3) +\n  coord_polar(theta = \"y\") +\n  xlab(\"\") +\n  ylab(\"Pie Chart\") +\n  scale_fill_manual(values = c(\"#e64b35ff\",\"#4dbbd5ff\",\"#00a087ff\",\"#3c5488ff\",\"#f39b7fff\")) +\n  theme_minimal() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(color = \"black\"),\n        axis.text.y = element_blank(),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10),\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank())\n\np\n\n\n\n\n\n\n\n图 1: 环形饼图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Circular Pie Chart"
    ]
  },
  {
    "objectID": "Hiplot/101-map-china2.html",
    "href": "Hiplot/101-map-china2.html",
    "title": "中国地图 2",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot China Map 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/map-china2?lang=zh_cn",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "China Map 2"
    ]
  },
  {
    "objectID": "Hiplot/101-map-china2.html#环境配置",
    "href": "Hiplot/101-map-china2.html#环境配置",
    "title": "中国地图 2",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2; RColorBrewer\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(RColorBrewer)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package      * version date (UTC) lib source\n data.table   * 1.17.8  2025-07-10 [1] RSPM\n ggplot2      * 4.0.1   2025-11-14 [1] RSPM\n jsonlite     * 2.0.0   2025-03-27 [1] RSPM\n RColorBrewer * 1.1-3   2022-04-03 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "China Map 2"
    ]
  },
  {
    "objectID": "Hiplot/101-map-china2.html#数据准备",
    "href": "Hiplot/101-map-china2.html#数据准备",
    "title": "中国地图 2",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/map-china2/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\ndt_map &lt;- readRDS(url(\"https://download.hiplot.cn/ui/basic/map-china/china.rds\"))\n\n# 整理数据格式\ndt_map$Value &lt;- data$value[match(dt_map$FCNAME, data$name)]\n\n# 查看数据\nhead(data)\n\n    name value\n1 安徽省  6118\n2 福建省  3581\n3 甘肃省  2617\n4 广东省  9449\n5 贵州省  3762\n6 海南省   845",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "China Map 2"
    ]
  },
  {
    "objectID": "Hiplot/101-map-china2.html#可视化",
    "href": "Hiplot/101-map-china2.html#可视化",
    "title": "中国地图 2",
    "section": "可视化",
    "text": "可视化\n\n# 中国地图2\np &lt;- ggplot(dt_map) +\n  geom_polygon(aes(x = long, y = lat, group = group, fill = Value),\n               alpha = 0.9, size = 0.5) +\n  geom_path(aes(x = long, y = lat, group = group), color = \"black\", size = 0.2) +\n  coord_fixed() +\n  scale_fill_gradientn(\n    colours = colorRampPalette(rev(brewer.pal(11,\"RdYlBu\")))(500),\n    breaks = seq(min(data$value), max(data$value), \n                 round((max(data$value)-min(data$value))/7)),\n    name = \"Color Key\",\n    guide = guide_legend(\n      direction = \"vertical\", keyheight = unit(1, units = \"mm\"),\n      keywidth = unit(8, units = \"mm\"),\n      title.position = \"top\", title.hjust = 0.5, label.hjust = 0.5,\n      nrow = 1, byrow = T, reverse = F, label.position = \"bottom\")) +\n  theme(text = element_text(color = \"#3A3F4A\"),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank(),\n        legend.position = \"top\",\n        legend.text = element_text(size = 4 * 1.5, color = \"black\"),\n        legend.title = element_text(size = 5 * 1.5, color = \"black\"),\n        plot.title = element_text(\n          face = \"bold\", size = 5 * 1.5, hjust = 0.5, \n          margin = margin(t = 4, b = 5), color = \"black\"),\n        plot.background = element_rect(fill = \"#FFFFFF\", color = \"#FFFFFF\"),\n        panel.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        legend.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        plot.margin = unit(c(1.5, 1.5, 1.5, 1.5), \"cm\")) +\n  labs(x = NULL, y = NULL, title = \"China Map\")\n\np\n\n\n\n\n\n\n\n图 1: 中国地图2",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "China Map 2"
    ]
  },
  {
    "objectID": "Hiplot/042-diffusion-map.html",
    "href": "Hiplot/042-diffusion-map.html",
    "title": "扩散映射图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Diffusion Map 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/diffusion-map?lang=zh_cn\n扩散映射（diffusion-map）是一种非线性降维算法，可以用于可视化发育轨迹。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Diffusion Map"
    ]
  },
  {
    "objectID": "Hiplot/042-diffusion-map.html#环境配置",
    "href": "Hiplot/042-diffusion-map.html#环境配置",
    "title": "扩散映射图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; destiny; ggplotify; scatterplot3d; ggpubr\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"destiny\", quietly = TRUE)) {\n  install.packages(\"https://github.com/theislab/destiny/archive/refs/tags/v3.1.1.tar.gz\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\nif (!requireNamespace(\"scatterplot3d\", quietly = TRUE)) {\n  install.packages(\"scatterplot3d\")\n}\nif (!requireNamespace(\"ggpubr\", quietly = TRUE)) {\n  install.packages(\"ggpubr\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(destiny)\nlibrary(ggplotify)\nlibrary(scatterplot3d)\nlibrary(ggpubr)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package       * version date (UTC) lib source\n data.table    * 1.17.8  2025-07-10 [1] RSPM\n destiny       * 3.25.0  2025-11-06 [1] Github (theislab/destiny@8cc0bff)\n ggplot2       * 4.0.1   2025-11-14 [1] RSPM\n ggplotify     * 0.1.3   2025-09-20 [1] RSPM\n ggpubr        * 0.6.2   2025-10-17 [1] RSPM\n jsonlite      * 2.0.0   2025-03-27 [1] RSPM\n scatterplot3d * 0.3-44  2023-05-05 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Diffusion Map"
    ]
  },
  {
    "objectID": "Hiplot/042-diffusion-map.html#数据准备",
    "href": "Hiplot/042-diffusion-map.html#数据准备",
    "title": "扩散映射图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata1 &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/diffusion-map/data.json\")$exampleData[[1]]$textarea[[1]])\ndata1 &lt;- as.data.frame(data1)\ndata2 &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/diffusion-map/data.json\")$exampleData[[1]]$textarea[[2]])\ndata2 &lt;- as.data.frame(data2)\n\n# 整理数据格式\nsample.info &lt;- data2\nrownames(data1) &lt;- data1[, 1]\ndata1 &lt;- as.matrix(data1[, -1])\n## tsne\nset.seed(123)\ndm_info &lt;- DiffusionMap(t(data1))\ndm_info &lt;- cbind(DC1 = dm_info$DC1, DC2 = dm_info$DC2, DC3 = dm_info$DC3)\ndm_data &lt;- data.frame(\n  sample = colnames(data1),\n  dm_info\n)\n\ncolorBy &lt;- sample.info[match(colnames(data1), sample.info[, 1]), \"Group\"]\ncolorBy &lt;- factor(colorBy, level = colorBy[!duplicated(colorBy)])\ndm_data$colorBy = colorBy\n\n# 查看数据\nhead(dm_data)\n\n   sample        DC1        DC2         DC3 colorBy\nM1     M1 0.05059918 0.15203860 -0.06533168      G1\nM2     M2 0.05030863 0.14435034 -0.06044277      G1\nM3     M3 0.04271398 0.09273382 -0.02730427      G1\nM4     M4 0.04680742 0.10425273 -0.03789962      G1\nM5     M5 0.04971521 0.12786900 -0.05608321      G1\nM6     M6 0.04840072 0.12728303 -0.05256815      G1",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Diffusion Map"
    ]
  },
  {
    "objectID": "Hiplot/042-diffusion-map.html#可视化",
    "href": "Hiplot/042-diffusion-map.html#可视化",
    "title": "扩散映射图",
    "section": "可视化",
    "text": "可视化\n\n1. 2D\n\n# 2D 扩散映射图\np &lt;- ggscatter(data = dm_data,  x = \"DC1\", y = \"DC2\", color = \"colorBy\",\n               size = 2, palette = \"lancet\", alpha = 1) +\n  labs(color = \"Group\") +\n  ggtitle(\"Diffusion Map\") +\n  scale_color_manual(values = c(\"#3B4992FF\",\"#EE0000FF\",\"#008B45FF\")) +\n  theme_classic() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 1: 2D 扩散映射图\n\n\n\n\n\n\n\n2. 3D\n\n# 3D 扩散映射图\ngroup.color &lt;- c(\"#3B4992FF\",\"#EE0000FF\",\"#008B45FF\")\nnames(group.color) &lt;- unique(dm_data$colorBy)\ngroup.color &lt;- group.color[!is.na(names(group.color))]\nif (length(group.color) == 0) {\n  group.color &lt;- c(Default=\"black\")\n  dm_data$colorBy &lt;- \"Default\"\n}\np &lt;- as.ggplot(function(){\n  scatterplot3d(x = dm_data$DC1, y = dm_data$DC2, z = dm_data$DC3,\n                color =  alpha(group.color[dm_data$colorBy], 1),\n                xlim=c(min(dm_data$DC1), max(dm_data$DC1)),\n                ylim=c(min(dm_data$DC2), max(dm_data$DC2)),\n                zlim=c(min(dm_data$DC3), max(dm_data$DC3)),\n                pch = 16, cex.symbols  = 0.6,\n                scale.y = 0.8,\n                xlab = \"DC1\", ylab = \"DC2\", zlab = \"DC3\",\n                angle = 40,\n                main = \"Diffusion Map\",\n                col.axis = \"#444444\", col.grid = \"#CCCCCC\")\n  legend(\"right\", legend = names(group.color),\n         col = alpha(group.color, 0.8), pch = 16)\n    })\np &lt;- p + theme_classic()\n\np\n\n\n\n\n\n\n\n图 2: 3D 扩散映射图",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Diffusion Map"
    ]
  },
  {
    "objectID": "Hiplot/088-histogram.html",
    "href": "Hiplot/088-histogram.html",
    "title": "直方图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Histogram 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/histogram?lang=zh_cn\n直方图是由一系列高度不等的纵向条纹或线段表示连续性变量数据的分布情况。",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Histogram"
    ]
  },
  {
    "objectID": "Hiplot/088-histogram.html#环境配置",
    "href": "Hiplot/088-histogram.html#环境配置",
    "title": "直方图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2; ggthemes\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"ggthemes\", quietly = TRUE)) {\n  install.packages(\"ggthemes\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(ggthemes)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n ggthemes   * 5.2.0   2025-11-30 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Histogram"
    ]
  },
  {
    "objectID": "Hiplot/088-histogram.html#数据准备",
    "href": "Hiplot/088-histogram.html#数据准备",
    "title": "直方图",
    "section": "数据准备",
    "text": "数据准备\n载入数据为数据集(不同治疗方案治疗效果数据)。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/histogram/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndata[, 2] &lt;- factor(data[, 2], levels = unique(data[, 2]))\n\n# 查看数据\nhead(data)\n\n  Value Group2\n1   4.2 treat1\n2  11.5 treat1\n3   7.3 treat1\n4   5.8 treat1\n5   6.4 treat1\n6  10.0 treat1",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Histogram"
    ]
  },
  {
    "objectID": "Hiplot/088-histogram.html#可视化",
    "href": "Hiplot/088-histogram.html#可视化",
    "title": "直方图",
    "section": "可视化",
    "text": "可视化\n\n# 直方图\np &lt;- ggplot(data, aes(x=Value, fill=Group2)) +\n  geom_histogram(alpha = 1, bins = 12, col = \"white\") +\n  ggtitle(\"Histogram Plot\") +\n  scale_fill_manual(values = c(\"#e04d39\",\"#5bbad6\",\"#1e9f86\")) +\n  theme_stata() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 1: 直方图\n\n\n\n\n\n图中长方形的宽度与组距成正比且可不相同，纵轴代表频数。",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Histogram"
    ]
  },
  {
    "objectID": "Hiplot/163-scatterpie.html",
    "href": "Hiplot/163-scatterpie.html",
    "title": "散点饼图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Scatterpie 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/scatterpie?lang=zh_cn\n散点饼图用于可视化不同空间坐标中数据分类值的比例情况。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Scatterpie"
    ]
  },
  {
    "objectID": "Hiplot/163-scatterpie.html#环境配置",
    "href": "Hiplot/163-scatterpie.html#环境配置",
    "title": "散点饼图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; scatterpie\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"scatterpie\", quietly = TRUE)) {\n  install.packages(\"scatterpie\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(scatterpie)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n scatterpie * 0.2.6   2025-09-12 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Scatterpie"
    ]
  },
  {
    "objectID": "Hiplot/163-scatterpie.html#数据准备",
    "href": "Hiplot/163-scatterpie.html#数据准备",
    "title": "散点饼图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/scatterpie/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 查看数据\nhead(data)\n\n            x          y          A        B        C        D\n1  -56.047565  12.665926 0.71040656 2.887786 1.309570 2.892264\n2  -23.017749  -1.427338 0.25688371 1.403569 1.375096 4.945092\n3    7.050839  68.430114 0.24669188 0.524395 3.189978 5.138863\n4   12.928774 -11.288549 0.34754260 3.144288 3.789556 2.295894\n5 -126.506123  29.230687 0.95161857 3.029335 1.048951 2.471943\n6  -68.685285   6.192712 0.04502772 3.203072 2.596539 4.439393",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Scatterpie"
    ]
  },
  {
    "objectID": "Hiplot/163-scatterpie.html#可视化",
    "href": "Hiplot/163-scatterpie.html#可视化",
    "title": "散点饼图",
    "section": "可视化",
    "text": "可视化\n\n# 散点饼图\np &lt;- ggplot() +\n  geom_scatterpie(data = data, aes(x = x, y = y), cols = colnames(data)[-c(1, 2)]) +\n  scale_fill_manual(values = c(\"#E64B35FF\",\"#4DBBD5FF\",\"#00A087FF\",\"#3C5488FF\")) +\n  labs(x=\"x\", y=\"y\") +\n  theme_minimal() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 1: 散点饼图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Scatterpie"
    ]
  },
  {
    "objectID": "Hiplot/034-custom-heat-map.html",
    "href": "Hiplot/034-custom-heat-map.html",
    "title": "自定义热图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Custom Heatmap 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/custom-heat-map?lang=zh_cn\n自定义热图，按照给定数据直接绘制热图。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Custom Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/034-custom-heat-map.html#环境配置",
    "href": "Hiplot/034-custom-heat-map.html#环境配置",
    "title": "自定义热图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Custom Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/034-custom-heat-map.html#数据准备",
    "href": "Hiplot/034-custom-heat-map.html#数据准备",
    "title": "自定义热图",
    "section": "数据准备",
    "text": "数据准备\n案例数据为hiplot.org官方logo的灰度图像。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/custom-heat-map/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndraw_data &lt;- as.matrix(data[, 2:ncol(data)])\nrow_num &lt;- nrow(draw_data)\ncol_num &lt;- ncol(draw_data)\ncol_labels &lt;- colnames(data)\ncol_labels &lt;- col_labels[2:ncol(data)]\nrow_labels &lt;- data$name\nrm(data)\ndf &lt;- expand.grid(row = 1:row_num, col = 1:col_num)\ndf$value &lt;- c(draw_data)\n\n# 查看数据\nhead(df)\n\n  row col value\n1   1   1   236\n2   2   1   236\n3   3   1   236\n4   4   1   236\n5   5   1   236\n6   6   1   236",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Custom Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/034-custom-heat-map.html#可视化",
    "href": "Hiplot/034-custom-heat-map.html#可视化",
    "title": "自定义热图",
    "section": "可视化",
    "text": "可视化\n\n# 自定义热图\np &lt;- ggplot(df, aes(x = col, y = row, fill = value)) +\n  geom_point(shape = 21, size = 8, aes(fill = value), color = \"white\") +\n  scale_fill_gradient(low = \"#DDDDDD\", high = \"#0000F5\") +\n  guides(fill = guide_colorbar(title = \"Value\")) +\n  theme(\n    panel.background = element_rect(fill = \"white\"),\n    panel.grid = element_blank(),\n    axis.text = element_text(size = 10),\n    axis.ticks = element_blank(),\n    axis.title = element_blank()\n    ) +\n  scale_x_continuous(breaks = 1:col_num, labels = col_labels, position = \"top\") +\n  scale_y_reverse(breaks = 1:row_num, labels = row_labels, position = \"left\")\n\np\n\n\n\n\n\n\n\n图 1: 自定义热图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Custom Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/112-map-uk-city.html",
    "href": "Hiplot/112-map-uk-city.html",
    "title": "英国地图 (城市)",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot UK Map (City) 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/map-uk-city?lang=zh_cn",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Oceania/Antarc Map"
    ]
  },
  {
    "objectID": "Hiplot/112-map-uk-city.html#环境配置",
    "href": "Hiplot/112-map-uk-city.html#环境配置",
    "title": "英国地图 (城市)",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2; RColorBrewer\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(RColorBrewer)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package      * version date (UTC) lib source\n data.table   * 1.17.8  2025-07-10 [1] RSPM\n ggplot2      * 4.0.1   2025-11-14 [1] RSPM\n jsonlite     * 2.0.0   2025-03-27 [1] RSPM\n RColorBrewer * 1.1-3   2022-04-03 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Oceania/Antarc Map"
    ]
  },
  {
    "objectID": "Hiplot/112-map-uk-city.html#数据准备",
    "href": "Hiplot/112-map-uk-city.html#数据准备",
    "title": "英国地图 (城市)",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/map-uk-city/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\ndt_map &lt;- readRDS(url(\"https://download.hiplot.cn/ui/basic/map-uk-city/uk_city.rds\"))\n\n# 整理数据格式\ndt_map$Value &lt;- data$value[match(dt_map$ENG_NAME, data$name)]\n\n# 查看数据\nhead(data)\n\n               name value\n1 Rhondda Cynon Taf   503\n2       Eilean Siar   221\n3          Bridgend   993\n4           Lincoln   798\n5     Richmondshire   169\n6           Ashford   653",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Oceania/Antarc Map"
    ]
  },
  {
    "objectID": "Hiplot/112-map-uk-city.html#可视化",
    "href": "Hiplot/112-map-uk-city.html#可视化",
    "title": "英国地图 (城市)",
    "section": "可视化",
    "text": "可视化\n\n# 英国地图 (城市)\np &lt;- ggplot(dt_map) +\n  geom_polygon(aes(x = long, y = lat, group = group, fill = Value),\n               alpha = 0.9, size = 0.5) +\n  geom_path(aes(x = long, y = lat, group = group), color = \"black\", size = 0.2) +\n  coord_fixed() +\n  scale_fill_gradientn(\n    colours = colorRampPalette(rev(brewer.pal(11,\"RdYlBu\")))(500),\n    breaks = seq(min(data$value), max(data$value), \n                 round((max(data$value)-min(data$value))/7)),\n    name = \"Color Key\",\n    guide = guide_legend(\n      direction = \"vertical\", keyheight = unit(1, units = \"mm\"),\n      keywidth = unit(8, units = \"mm\"),\n      title.position = \"top\", title.hjust = 0.5, label.hjust = 0.5,\n      nrow = 1, byrow = T, reverse = F, label.position = \"bottom\")) +\n  theme(text = element_text(color = \"#3A3F4A\"),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank(),\n        legend.position = \"top\",\n        legend.text = element_text(size = 4 * 1.5, color = \"black\"),\n        legend.title = element_text(size = 5 * 1.5, color = \"black\"),\n        plot.title = element_text(\n          face = \"bold\", size = 5 * 1.5, hjust = 0.5, \n          margin = margin(t = 4, b = 5), color = \"black\"),\n        plot.background = element_rect(fill = \"#FFFFFF\", color = \"#FFFFFF\"),\n        panel.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        legend.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        plot.margin = unit(c(1.5, 1.5, 1.5, 1.5), \"cm\")) +\n  labs(x = NULL, y = NULL, title = \"UK Map\")\n\np\n\n\n\n\n\n\n\n图 1: 英国地图 (城市)",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Oceania/Antarc Map"
    ]
  },
  {
    "objectID": "Hiplot/111-map-south-america.html",
    "href": "Hiplot/111-map-south-america.html",
    "title": "南美洲地图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot South America Map 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/map-south-america?lang=zh_cn",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "South America Map"
    ]
  },
  {
    "objectID": "Hiplot/111-map-south-america.html#环境配置",
    "href": "Hiplot/111-map-south-america.html#环境配置",
    "title": "南美洲地图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2; RColorBrewer\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(RColorBrewer)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package      * version date (UTC) lib source\n data.table   * 1.17.8  2025-07-10 [1] RSPM\n ggplot2      * 4.0.1   2025-11-14 [1] RSPM\n jsonlite     * 2.0.0   2025-03-27 [1] RSPM\n RColorBrewer * 1.1-3   2022-04-03 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "South America Map"
    ]
  },
  {
    "objectID": "Hiplot/111-map-south-america.html#数据准备",
    "href": "Hiplot/111-map-south-america.html#数据准备",
    "title": "南美洲地图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/map-south-america/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\ndt_map &lt;- readRDS(url(\"https://download.hiplot.cn/ui/basic/map-south-america/sa.rds\"))\n\n# 整理数据格式\ndt_map$Value &lt;- data$value[match(dt_map$ENG_NAME, data$region)]\n\n# 查看数据\nhead(data)\n\n     region value\n1 Argentina   198\n2   Bolivia   568\n3    Brazil   191\n4     Chile   275\n5  Colombia   901\n6   Ecuador   604",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "South America Map"
    ]
  },
  {
    "objectID": "Hiplot/111-map-south-america.html#可视化",
    "href": "Hiplot/111-map-south-america.html#可视化",
    "title": "南美洲地图",
    "section": "可视化",
    "text": "可视化\n\n# 南美洲地图\np &lt;- ggplot(dt_map) +\n  geom_polygon(aes(x = long, y = lat, group = group, fill = Value),\n               alpha = 0.9, size = 0.5) +\n  geom_path(aes(x = long, y = lat, group = group), color = \"black\", size = 0.2) +\n  coord_fixed() +\n  scale_fill_gradientn(\n    colours = colorRampPalette(rev(brewer.pal(11,\"RdYlBu\")))(500),\n    breaks = seq(min(data$value), max(data$value), \n                 round((max(data$value)-min(data$value))/7)),\n    name = \"Color Key\",\n    guide = guide_legend(\n      direction = \"vertical\", keyheight = unit(1, units = \"mm\"),\n      keywidth = unit(8, units = \"mm\"),\n      title.position = \"top\", title.hjust = 0.5, label.hjust = 0.5,\n      nrow = 1, byrow = T, reverse = F, label.position = \"bottom\")) +\n  theme(text = element_text(color = \"#3A3F4A\"),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank(),\n        legend.position = \"top\",\n        legend.text = element_text(size = 4 * 1.5, color = \"black\"),\n        legend.title = element_text(size = 5 * 1.5, color = \"black\"),\n        plot.title = element_text(\n          face = \"bold\", size = 5 * 1.5, hjust = 0.5, \n          margin = margin(t = 4, b = 5), color = \"black\"),\n        plot.background = element_rect(fill = \"#FFFFFF\", color = \"#FFFFFF\"),\n        panel.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        legend.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        plot.margin = unit(c(1.5, 1.5, 1.5, 1.5), \"cm\")) +\n  labs(x = NULL, y = NULL, title = \"South America Map\")\n\np\n\n\n\n\n\n\n\n图 1: 南美洲地图",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "South America Map"
    ]
  },
  {
    "objectID": "Hiplot/152-rcs-lrm.html",
    "href": "Hiplot/152-rcs-lrm.html",
    "title": "限制性立方样条模型",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot RCS-LRM 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/rcs-lrm?lang=zh_cn\n非线性回归分析。",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "RCS-LRM"
    ]
  },
  {
    "objectID": "Hiplot/152-rcs-lrm.html#环境配置",
    "href": "Hiplot/152-rcs-lrm.html#环境配置",
    "title": "限制性立方样条模型",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; rms; survival; ggplot2; stringr\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"rms\", quietly = TRUE)) {\n  install.packages(\"rms\")\n}\nif (!requireNamespace(\"survival\", quietly = TRUE)) {\n  install.packages(\"survival\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"stringr\", quietly = TRUE)) {\n  install.packages(\"stringr\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(rms)\nlibrary(survival)\nlibrary(ggplot2)\nlibrary(stringr)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n Hmisc      * 5.2-4   2025-10-05 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n rms        * 8.1-0   2025-10-14 [1] RSPM\n stringr    * 1.6.0   2025-11-04 [1] RSPM\n survival   * 3.8-3   2024-12-17 [3] CRAN (R 4.5.2)\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "RCS-LRM"
    ]
  },
  {
    "objectID": "Hiplot/152-rcs-lrm.html#数据准备",
    "href": "Hiplot/152-rcs-lrm.html#数据准备",
    "title": "限制性立方样条模型",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/rcs-lrm/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndata &lt;- na.omit(data)\nex &lt;- set::not(colnames(data), c(\"main\", \"group\"))\nex &lt;- str_c(ex, collapse = \"+\")\ndd &lt;&lt;- datadist(data)\noptions(datadist = \"dd\")\nfor (i in 3:5) {\n  fit &lt;- lrm(as.formula(paste0(\"group~rcs(main,nk=i,inclx = T)+\", ex, collapse = \"+\")), data = data, x = TRUE)\n  tmp &lt;- AIC(fit)\n  if (i == 3) {\n    AIC &lt;- tmp\n    nk &lt;&lt;- 3\n  }\n  if (tmp &lt; AIC) {\n    AIC &lt;- tmp\n    nk &lt;&lt;- i\n  }\n}\nfit &lt;- lrm(as.formula(paste0(\"group~rcs(main,nk=nk,inclx = T)+\", ex, collapse = \"+\")), data = data, x = TRUE)\ndd$limits$main[2] &lt;- median(data$main)\nfit &lt;- update(fit)\norr &lt;- Predict(fit, main, fun = exp, ref.zero = TRUE)\n\n# 查看数据\nhead(data)\n\n  main   X2 X3 group\n1  100 0.90  0     1\n2   90 0.65  1     1\n3  400 1.36  0     1\n4  200 0.83  0     1\n5  300 1.38  0     1\n6  200 0.69  0     1",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "RCS-LRM"
    ]
  },
  {
    "objectID": "Hiplot/152-rcs-lrm.html#可视化",
    "href": "Hiplot/152-rcs-lrm.html#可视化",
    "title": "限制性立方样条模型",
    "section": "可视化",
    "text": "可视化\n\n# 限制性立方样条模型\np &lt;- ggplot() +\n  geom_line(data = orr, aes(main, yhat), linetype = \"solid\", size = 1, alpha = 1,\n            colour = \"#FF0000\") +\n  geom_ribbon(data = orr, aes(main, ymin = lower, ymax = upper), alpha = 0.6, \n              fill = \"#FFC0CB\") +\n  geom_hline(yintercept = 1, linetype = 2, size = 0.5) +\n  geom_vline(xintercept = dd$limits$main[2], linetype = 2, size = 0.5) +\n  labs(x = \"main\", y = \"Odds Ratio(95%CI)\") +\n  theme_bw() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n \np\n\n\n\n\n\n\n\n图 1: 限制性立方样条模型",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "RCS-LRM"
    ]
  },
  {
    "objectID": "Hiplot/028-contour-xy.html",
    "href": "Hiplot/028-contour-xy.html",
    "title": "等高线图 (XY)",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Contour (XY) 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/contour-xy?lang=zh_cn\n等高线图 (XY) 是一种通过等高线反映数据密集程度的数据处理方式。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Contour (XY)"
    ]
  },
  {
    "objectID": "Hiplot/028-contour-xy.html#环境配置",
    "href": "Hiplot/028-contour-xy.html#环境配置",
    "title": "等高线图 (XY)",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2; ggisoband\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"ggisoband\", quietly = TRUE)) {\n  remotes::install_github(\"clauswilke/ggisoband\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(ggisoband)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version    date (UTC) lib source\n data.table * 1.17.8     2025-07-10 [1] RSPM\n ggisoband  * 0.0.0.9000 2025-11-02 [1] Github (clauswilke/ggisoband@eef779f)\n ggplot2    * 4.0.1      2025-11-14 [1] RSPM\n jsonlite   * 2.0.0      2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Contour (XY)"
    ]
  },
  {
    "objectID": "Hiplot/028-contour-xy.html#数据准备",
    "href": "Hiplot/028-contour-xy.html#数据准备",
    "title": "等高线图 (XY)",
    "section": "数据准备",
    "text": "数据准备\n载入数据为两个变量。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/contour-xy/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ncolnames(data) &lt;- c(\"xvalue\", \"yvalue\")\n\n# 查看数据\nhead(data)\n\n  xvalue yvalue\n1  2.620    110\n2  2.875    110\n3  2.320     93\n4  3.215    110\n5  3.440    175\n6  3.460    105",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Contour (XY)"
    ]
  },
  {
    "objectID": "Hiplot/028-contour-xy.html#可视化",
    "href": "Hiplot/028-contour-xy.html#可视化",
    "title": "等高线图 (XY)",
    "section": "可视化",
    "text": "可视化\n\n# 等高线图 (XY)\np &lt;- ggplot(data, aes(xvalue, yvalue)) +\n  geom_density_bands(\n    alpha = 1,\n    aes(fill = stat(density)), color = \"gray40\", size = 0.2\n    ) +\n  geom_point(alpha = 1, shape = 21, fill = \"white\") +\n  scale_fill_viridis_c(guide = \"legend\") +\n  ylab(\"value2\") +\n  xlab(\"value1\") +\n  ggtitle(\"Contour-XY Plot\") +\n  theme_bw() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 1: 等高线图 (XY)\n\n\n\n\n\n正如地理上的等高线代表不同高度一样，等高线图上的不同等高线代表不同密度，越靠中心，等高线圈越小，代表其区域数据密度程度越高。如：黄色区域数据密集程度最高，而蓝色区域数据密集程度最低。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Contour (XY)"
    ]
  },
  {
    "objectID": "Hiplot/010-barplot.html",
    "href": "Hiplot/010-barplot.html",
    "title": "柱状图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Barplot 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/barplot?lang=zh_cn\n条形图用于显示带有矩形条的类别数据，矩形条的高度或长度与它们所代表的值成比例。条形图可以垂直或水平绘制。条形图显示了离散类别之间的比较。图表的一个轴显示要比较的特定类别，另一个轴代表测量值。一些条形图显示的条形也可显示多个测量变量的值。",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Barplot"
    ]
  },
  {
    "objectID": "Hiplot/010-barplot.html#环境配置",
    "href": "Hiplot/010-barplot.html#环境配置",
    "title": "柱状图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2; ggthemes\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"ggthemes\", quietly = TRUE)) {\n  install.packages(\"ggthemes\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(ggthemes)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n ggthemes   * 5.2.0   2025-11-30 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Barplot"
    ]
  },
  {
    "objectID": "Hiplot/010-barplot.html#数据准备",
    "href": "Hiplot/010-barplot.html#数据准备",
    "title": "柱状图",
    "section": "数据准备",
    "text": "数据准备\n载入数据为不同治疗方案中不同剂量药物作用效果数据。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/barplot/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndata[, 2] &lt;- factor(data[, 2], levels = unique(data[, 2]))\ndata[, 3] &lt;- factor(data[, 3], levels = unique(data[, 3]))\n\n# 查看数据\nhead(data)\n\n  value  treat dose\n1    13 Group1 high\n2    34 Group2 high\n3    21 Group3 high\n4    43 Group4 high\n5    25 Group1  mid\n6     8 Group2  mid",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Barplot"
    ]
  },
  {
    "objectID": "Hiplot/010-barplot.html#可视化",
    "href": "Hiplot/010-barplot.html#可视化",
    "title": "柱状图",
    "section": "可视化",
    "text": "可视化\n\n# 柱状图\np &lt;- ggplot(data, aes(x = dose, y = value, fill = treat)) +\n  geom_bar(position = position_dodge(0.9), stat = \"identity\") +\n  ggtitle(\"Bar Plot\") +\n  geom_text(aes(label = value), position = position_dodge(0.9), vjust = 1.5, color = \"white\", size = 3.5) +\n  scale_fill_manual(values = c(\"#e04d39\",\"#5bbad6\",\"#1e9f86\",\"#3c5488ff\")) +\n  theme_stata() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 1: 柱状图\n\n\n\n\n\n该条形图展示了不同治疗组（组 1 ~ 组 4）分别用低、中、高剂量进行治疗时，不同的治疗效果。组 1 使用中剂量治疗时效果最好，组 2 使用高剂量治疗时效果最好，组 3 使用剂量治疗时无较大差距，组 4 使用高剂量治疗时效果最好。",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Barplot"
    ]
  },
  {
    "objectID": "Hiplot/059-gantt.html",
    "href": "Hiplot/059-gantt.html",
    "title": "甘特图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Gantt 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/gantt?lang=zh_cn\n甘特图是一种用来说明项目进度条形图。",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Gantt"
    ]
  },
  {
    "objectID": "Hiplot/059-gantt.html#环境配置",
    "href": "Hiplot/059-gantt.html#环境配置",
    "title": "甘特图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; tidyverse; ggthemes\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"tidyverse\", quietly = TRUE)) {\n  install.packages(\"tidyverse\")\n}\nif (!requireNamespace(\"ggthemes\", quietly = TRUE)) {\n  install.packages(\"ggthemes\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(tidyverse)\nlibrary(ggthemes)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n dplyr      * 1.1.4   2023-11-17 [1] RSPM\n forcats    * 1.0.1   2025-09-25 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n ggthemes   * 5.2.0   2025-11-30 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n lubridate  * 1.9.4   2024-12-08 [1] RSPM\n purrr      * 1.2.0   2025-11-04 [1] RSPM\n readr      * 2.1.6   2025-11-14 [1] RSPM\n stringr    * 1.6.0   2025-11-04 [1] RSPM\n tibble     * 3.3.0   2025-06-08 [1] RSPM\n tidyr      * 1.3.2   2025-12-19 [1] RSPM\n tidyverse  * 2.0.0   2023-02-22 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Gantt"
    ]
  },
  {
    "objectID": "Hiplot/059-gantt.html#数据准备",
    "href": "Hiplot/059-gantt.html#数据准备",
    "title": "甘特图",
    "section": "数据准备",
    "text": "数据准备\n载入数据为 4 个样本即四位患者，3 个项目即 3 种治疗方法，以及每种治疗方法的起止时间。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/gantt/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\nusr_ylab &lt;- colnames(data)[1]\nif (!is.numeric(data[, 2])) {\n  data[, 2] &lt;- factor(data[, 2], levels = unique(data[, 2]))\n}\ndata_gather &lt;- gather(data, \"state\", \"date\", 3:4)\nsample &lt;- levels(data_gather$sample)\ndata_gather$sample &lt;- factor(data_gather$sample,\n  levels = rev(unique(data_gather$sample))\n)\n\n# 查看数据\nhead(data_gather)\n\n    sample   item state date\n1 patient1 treat1 start    1\n2 patient2 treat1 start    2\n3 patient2 treat2 start    5\n4 patient2 treat3 start    7\n5 patient3 treat3 start    6\n6 patient3 treat1 start    3",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Gantt"
    ]
  },
  {
    "objectID": "Hiplot/059-gantt.html#可视化",
    "href": "Hiplot/059-gantt.html#可视化",
    "title": "甘特图",
    "section": "可视化",
    "text": "可视化\n\n# 甘特图\np &lt;- ggplot(data_gather, aes(date, sample, color = item)) +\n  geom_line(size = 10, alpha = 1) +\n  labs(x = \"Time\", y = \"sample\", title = \"Gantt Plot\") +\n  theme(axis.ticks = element_blank()) +\n  scale_color_manual(values = c(\"#e04d39\",\"#5bbad6\",\"#1e9f86\")) +\n  theme_stata() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 1: 甘特图\n\n\n\n\n\n横轴表示时间进度，纵轴表示 4 位患者，3 种颜色表示 3 种治疗方法，该图可以观测到每位患者不同治疗方法使用的时间进度。",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Gantt"
    ]
  },
  {
    "objectID": "Hiplot/045-donut.html",
    "href": "Hiplot/045-donut.html",
    "title": "环形图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Donut 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/donut?lang=zh_cn\n环形图是饼图的一种变体，它有一个允许包含数据整体额外信息的空白中心。且与饼图目的一致，都是用来说明数据比例。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Donut"
    ]
  },
  {
    "objectID": "Hiplot/045-donut.html#环境配置",
    "href": "Hiplot/045-donut.html#环境配置",
    "title": "环形图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Donut"
    ]
  },
  {
    "objectID": "Hiplot/045-donut.html#数据准备",
    "href": "Hiplot/045-donut.html#数据准备",
    "title": "环形图",
    "section": "数据准备",
    "text": "数据准备\n载入数据为不同分组及其数据。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/donut/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndata$fraction &lt;- data[, 2] / sum(data[, 2])\ndata$ymax &lt;- cumsum(data$fraction)\ndata$ymin &lt;- c(0, head(data$ymax, n = -1))\ndata$labelPosition &lt;- (data$ymax + data$ymin) / 2\ndata$label &lt;- paste0(data[, 1], \"\\n\",\n  \"(\", data[, 2], \", \", sprintf(\"%2.2f%%\", 100 * data[, 2] / sum(data[, 2])), \")\",\n  sep = \"\"\n)\n\n# 查看数据\nhead(data)\n\n   group value  fraction      ymax      ymin labelPosition                label\n1 Group1    13 0.1171171 0.1171171 0.0000000    0.05855856 Group1\\n(13, 11.71%)\n2 Group2    34 0.3063063 0.4234234 0.1171171    0.27027027 Group2\\n(34, 30.63%)\n3 Group3    21 0.1891892 0.6126126 0.4234234    0.51801802 Group3\\n(21, 18.92%)\n4 Group4    43 0.3873874 1.0000000 0.6126126    0.80630631 Group4\\n(43, 38.74%)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Donut"
    ]
  },
  {
    "objectID": "Hiplot/045-donut.html#可视化",
    "href": "Hiplot/045-donut.html#可视化",
    "title": "环形图",
    "section": "可视化",
    "text": "可视化\n\n# 环形图\np &lt;- ggplot(data, aes_(ymax = as.name(\"ymax\"), ymin = as.name(\"ymin\"), \n                       xmax = 4, xmin = 3, fill = as.name(colnames(data)[1]))) +\n  geom_rect() +\n  geom_text(x = 5 + (4 - 5) / 3,\n            aes(y = labelPosition, label = label), size = 4) +\n  coord_polar(theta = \"y\") +\n  xlim(c(2, 5)) +\n  scale_fill_manual(values = c(\"#00468BCC\",\"#ED0000CC\",\"#42B540CC\",\"#0099B4CC\")) +\n  ggtitle(\"Donut Plot\") +\n  theme_void() +\n  theme(plot.title = element_text(hjust = 0.5),\n        legend.position = \"none\")\n\np\n\n\n\n\n\n\n\n图 1: 环形图\n\n\n\n\n\n不同颜色表示不同组群，不同面积表示数据及占比。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Donut"
    ]
  },
  {
    "objectID": "Hiplot/023-circular-barplot.html",
    "href": "Hiplot/023-circular-barplot.html",
    "title": "环状条形图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Circular Barplot 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/circular-barplot?lang=zh_cn\n绘制环状条形图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Circular Barplot"
    ]
  },
  {
    "objectID": "Hiplot/023-circular-barplot.html#环境配置",
    "href": "Hiplot/023-circular-barplot.html#环境配置",
    "title": "环状条形图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2; dplyr\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(dplyr)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n dplyr      * 1.1.4   2023-11-17 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Circular Barplot"
    ]
  },
  {
    "objectID": "Hiplot/023-circular-barplot.html#数据准备",
    "href": "Hiplot/023-circular-barplot.html#数据准备",
    "title": "环状条形图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/circular-barplot/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndata$group &lt;- as.factor(data$group)\nempty_bar &lt;- 2\nto_add &lt;- data.frame(matrix(NA, empty_bar*nlevels(data$group), ncol(data)))\ncolnames(to_add) &lt;- colnames(data)\nto_add$group &lt;- rep(levels(data$group), each=empty_bar)\ndata &lt;- rbind(data, to_add)\ndata &lt;- data %&gt;% arrange(group)\ndata$id &lt;- seq(1, nrow(data))\n\nlabel_data &lt;- data\nnumber_of_bar &lt;- nrow(label_data)\nangle &lt;- 90 - 360 * (label_data$id-0.5) /number_of_bar\nlabel_data$hjust &lt;- ifelse( angle &lt; -90, 1, 0)\nlabel_data$angle &lt;- ifelse(angle &lt; -90, angle+180, angle)\n\nbase_data &lt;- data %&gt;% \n  group_by(group) %&gt;% \n  summarize(start=min(id), end=max(id) - empty_bar) %&gt;% \n  rowwise() %&gt;% \n  mutate(title=mean(c(start, end)))\n\n# 查看数据\nhead(data)\n\n  individual group value id\n1   Mister 1     A    82  1\n2   Mister 2     A    98  2\n3   Mister 3     A    72  3\n4   Mister 4     A    34  4\n5   Mister 5     A    60  5\n6   Mister 6     A    61  6",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Circular Barplot"
    ]
  },
  {
    "objectID": "Hiplot/023-circular-barplot.html#可视化",
    "href": "Hiplot/023-circular-barplot.html#可视化",
    "title": "环状条形图",
    "section": "可视化",
    "text": "可视化\n\n# 环状条形图\np &lt;- ggplot(data, aes(x=as.factor(id), y=value, fill=group)) +\n  geom_bar(aes(x=as.factor(id), y=value, fill=group), stat=\"identity\", alpha=0.5) +\n  ylim(-50,max(na.omit(data$value))+30) +\n  geom_segment(data=base_data, aes(x = start, y = -5, xend = end, yend = -5), colour = \"black\", alpha=0.8, size=0.8 , inherit.aes = FALSE )  +\n  geom_text(data=base_data, aes(x = title, y = -12, label=group), colour = \"black\", alpha=0.8, size=4, fontface=\"bold\", inherit.aes = FALSE) +\n  geom_text(data=label_data, aes(x=id, y=value+8, label=individual, hjust=hjust), color=\"black\", fontface=\"bold\",alpha=0.6, size=3, angle= label_data$angle, inherit.aes = FALSE ) +\n  geom_text(data=label_data, aes(x=id, y=value-10, label=value, hjust=hjust), color=\"black\", fontface=\"bold\",alpha=0.6, size=3, angle= label_data$angle, inherit.aes = FALSE ) +\n  coord_polar() + \n  scale_fill_manual(values = c(\"#3b4992ff\",\"#ee0000ff\",\"#008b45ff\",\"#631879ff\")) +\n  theme_minimal() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_blank(),\n        axis.text = element_blank(),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10),\n        panel.grid = element_blank(),\n        plot.margin = unit(rep(-1,4), \"cm\"))\n\np\n\n\n\n\n\n\n\n图 1: 环状条形图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Circular Barplot"
    ]
  },
  {
    "objectID": "Hiplot/099-map-china-county.html",
    "href": "Hiplot/099-map-china-county.html",
    "title": "中国地图 (县)",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot China Map (County) 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/map-china-county?lang=zh_cn",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "China Map (County)"
    ]
  },
  {
    "objectID": "Hiplot/099-map-china-county.html#环境配置",
    "href": "Hiplot/099-map-china-county.html#环境配置",
    "title": "中国地图 (县)",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2; RColorBrewer\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(RColorBrewer)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package      * version date (UTC) lib source\n data.table   * 1.17.8  2025-07-10 [1] RSPM\n ggplot2      * 4.0.1   2025-11-14 [1] RSPM\n jsonlite     * 2.0.0   2025-03-27 [1] RSPM\n RColorBrewer * 1.1-3   2022-04-03 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "China Map (County)"
    ]
  },
  {
    "objectID": "Hiplot/099-map-china-county.html#数据准备",
    "href": "Hiplot/099-map-china-county.html#数据准备",
    "title": "中国地图 (县)",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/map-china-county/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\ndt_map &lt;- readRDS(url(\"https://download.hiplot.cn/ui/basic/map-china-county/china.county.rds\"))\n\n# 整理数据格式\ndt_map$Value &lt;- data$value[match(dt_map$county, data$name)]\n\n# 查看数据\nhead(data)\n\n      name value\n1   东城区   739\n2   西城区   536\n3   朝阳区   138\n4   丰台区   561\n5 石景山区   345\n6   海淀区   898",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "China Map (County)"
    ]
  },
  {
    "objectID": "Hiplot/099-map-china-county.html#可视化",
    "href": "Hiplot/099-map-china-county.html#可视化",
    "title": "中国地图 (县)",
    "section": "可视化",
    "text": "可视化\n\n# 中国地图 (县)\np &lt;- ggplot(dt_map) +\n  geom_polygon(aes(x = long, y = lat, group = group, fill = Value),\n               alpha = 0.9, size = 0.5) +\n  geom_path(aes(x = long, y = lat, group = group), color = \"black\", size = 0.2) +\n  coord_fixed() +\n  scale_fill_gradientn(\n    colours = colorRampPalette(rev(brewer.pal(11,\"RdYlBu\")))(500),\n    breaks = seq(min(data$value), max(data$value), \n                 round((max(data$value)-min(data$value))/7)),\n    name = \"\",\n    guide = guide_legend(\n      direction = \"vertical\", keyheight = unit(1, units = \"mm\"),\n      keywidth = unit(8, units = \"mm\"),\n      title.position = \"top\", title.hjust = 0.5, label.hjust = 0.5,\n      nrow = 1, byrow = T, reverse = F, label.position = \"bottom\")) +\n  theme(text = element_text(color = \"#3A3F4A\"),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank(),\n        legend.position = \"top\",\n        legend.text = element_text(size = 4 * 1.5, color = \"black\"),\n        legend.title = element_text(size = 5 * 1.5, color = \"black\"),\n        plot.title = element_text(\n          face = \"bold\", size = 5 * 1.5, hjust = 0.5, \n          margin = margin(t = 4, b = 5), color = \"black\"),\n        plot.background = element_rect(fill = \"#FFFFFF\", color = \"#FFFFFF\"),\n        panel.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        legend.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        plot.margin = unit(c(1.5, 1.5, 1.5, 1.5), \"cm\")) +\n  labs(x = NULL, y = NULL, title = \"China City Map\")\n\np\n\n\n\n\n\n\n\n图 1: 中国地图 (县)",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "China Map (County)"
    ]
  },
  {
    "objectID": "Hiplot/013-big-corrplot.html",
    "href": "Hiplot/013-big-corrplot.html",
    "title": "大样本相关性热图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Corrplot Big Data 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/big-corrplot?lang=zh_cn\n相关性热图是一种分析多个变量，两两之间相关性的图形。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Corrplot Big Data"
    ]
  },
  {
    "objectID": "Hiplot/013-big-corrplot.html#环境配置",
    "href": "Hiplot/013-big-corrplot.html#环境配置",
    "title": "大样本相关性热图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ComplexHeatmap\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ComplexHeatmap\", quietly = TRUE)) {\n  BiocManager::install(\"ComplexHeatmap\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ComplexHeatmap)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package        * version date (UTC) lib source\n ComplexHeatmap * 2.26.0  2025-10-29 [1] Bioconduc~\n data.table     * 1.17.8  2025-07-10 [1] RSPM\n jsonlite       * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Corrplot Big Data"
    ]
  },
  {
    "objectID": "Hiplot/013-big-corrplot.html#数据准备",
    "href": "Hiplot/013-big-corrplot.html#数据准备",
    "title": "大样本相关性热图",
    "section": "数据准备",
    "text": "数据准备\n载入数据为基因名称及每个样本的表达量。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/big-corrplot/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndata &lt;- data[!is.na(data[, 1]), ]\nidx &lt;- duplicated(data[, 1])\ndata[idx, 1] &lt;- paste0(data[idx, 1], \"--dup-\", cumsum(idx)[idx])\nrownames(data) &lt;- data[, 1]\ndata &lt;- data[, -1]\nstr2num_df &lt;- function(x) {\n  x[] &lt;- lapply(x, function(l) as.numeric(l))\n  x\n}\ntmp &lt;- t(str2num_df(data))\ncorr &lt;- round(cor(tmp, use = \"na.or.complete\", method = \"pearson\"), 3)\n\n# 查看数据\nhead(corr)\n\n         RGL4   MPP7   UGCG CYSTM1  ANXA2 ENDOD1 ARHGAP24   CST7 HIST1H2BM\nRGL4    1.000  0.914  0.929  0.936 -0.592 -0.908    0.888  0.949    -0.603\nMPP7    0.914  1.000  0.852  0.907 -0.543 -0.862    0.762  0.899    -0.656\nUGCG    0.929  0.852  1.000  0.956 -0.440 -0.791    0.854  0.840    -0.694\nCYSTM1  0.936  0.907  0.956  1.000 -0.358 -0.762    0.812  0.852    -0.632\nANXA2  -0.592 -0.543 -0.440 -0.358  1.000  0.826   -0.660 -0.723     0.541\nENDOD1 -0.908 -0.862 -0.791 -0.762  0.826  1.000   -0.907 -0.961     0.709\n         EREG   EMP1  NFAM1 SLC40A1   CD52 HIST1H2BH PFKFB3 SNORD116-20  STX11\nRGL4   -0.021 -0.495  0.859   0.506 -0.704    -0.680  0.889       0.188  0.953\nMPP7   -0.196 -0.447  0.898   0.648 -0.734    -0.770  0.842       0.048  0.915\nUGCG    0.153 -0.358  0.858   0.361 -0.671    -0.711  0.943       0.202  0.951\nCYSTM1  0.074 -0.272  0.866   0.339 -0.612    -0.683  0.933       0.225  0.985\nANXA2   0.222  0.902 -0.662  -0.668  0.775     0.626 -0.463       0.375 -0.374\nENDOD1  0.191  0.713 -0.872  -0.611  0.854     0.791 -0.814       0.141 -0.787\n        SYNE2   TCN1\nRGL4    0.780  0.889\nMPP7    0.795  0.888\nUGCG    0.922  0.927\nCYSTM1  0.908  0.973\nANXA2  -0.327 -0.249\nENDOD1 -0.657 -0.708",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Corrplot Big Data"
    ]
  },
  {
    "objectID": "Hiplot/013-big-corrplot.html#可视化",
    "href": "Hiplot/013-big-corrplot.html#可视化",
    "title": "大样本相关性热图",
    "section": "可视化",
    "text": "可视化\n\n# 大样本相关性热图\np &lt;- ComplexHeatmap::Heatmap(\n  corr, col = colorRampPalette(c(\"#4477AA\",\"#FFFFFF\",\"#BB4444\"))(50),\n  clustering_distance_rows = \"euclidean\",\n  clustering_method_rows = \"ward.D2\",\n  clustering_distance_columns = \"euclidean\",\n  clustering_method_columns = \"ward.D2\",\n  show_column_dend = FALSE, show_row_dend = FALSE,\n  column_names_gp = gpar(fontsize = 8),\n  row_names_gp = gpar(fontsize = 8)\n)\n\np\n\n\n\n\n\n\n\n图 1: 大样本相关性热图\n\n\n\n\n\n红色系表示两个基因之间呈正相关，蓝色系表示两个基因之间呈负相关，每一格中的数字表示相关系数。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Corrplot Big Data"
    ]
  },
  {
    "objectID": "Hiplot/119-meta-bin.html",
    "href": "Hiplot/119-meta-bin.html",
    "title": "二分类变量 Meta 分析",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Meta-analysis of Binary Data 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/meta-bin?lang=zh_cn",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Meta-analysis of Binary Data"
    ]
  },
  {
    "objectID": "Hiplot/119-meta-bin.html#环境配置",
    "href": "Hiplot/119-meta-bin.html#环境配置",
    "title": "二分类变量 Meta 分析",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; meta; ggplotify\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"meta\", quietly = TRUE)) {\n  install.packages(\"meta\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(meta)\nlibrary(ggplotify)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplotify  * 0.1.3   2025-09-20 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n meta       * 8.2-1   2025-09-01 [1] RSPM\n metadat    * 1.4-0   2025-02-04 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Meta-analysis of Binary Data"
    ]
  },
  {
    "objectID": "Hiplot/119-meta-bin.html#数据准备",
    "href": "Hiplot/119-meta-bin.html#数据准备",
    "title": "二分类变量 Meta 分析",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/meta-bin/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\nm1 &lt;- metabin(ev.exp, n.exp, ev.cont, n.cont, studlab = Study, data = data)\n\n# 查看数据\nhead(data)\n\n       Study ev.exp n.exp ev.cont n.cont\n1   Fletcher      1    12       4     11\n2      Dewar      4    21       7     21\n3 Lippschutz      6    43       7     41\n4 European_1     20    83      15     84\n5 European_2     69   373      94    357",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Meta-analysis of Binary Data"
    ]
  },
  {
    "objectID": "Hiplot/119-meta-bin.html#可视化",
    "href": "Hiplot/119-meta-bin.html#可视化",
    "title": "二分类变量 Meta 分析",
    "section": "可视化",
    "text": "可视化\n\n# 二分类变量 Meta 分析\np &lt;- as.ggplot(function(){\n  meta::forest(m1, layout = \"meta\")\n  })\n\np\n\n\n\n\n\n\n\n图 1: 二分类变量 Meta 分析",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Meta-analysis of Binary Data"
    ]
  },
  {
    "objectID": "Hiplot/146-pyramid-stack.html",
    "href": "Hiplot/146-pyramid-stack.html",
    "title": "金字塔堆叠图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Pyramid Stack 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/pyramid-stack?lang=zh_cn\n金字塔堆叠图可以用于展示年龄组多变量。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pyramid Stack"
    ]
  },
  {
    "objectID": "Hiplot/146-pyramid-stack.html#环境配置",
    "href": "Hiplot/146-pyramid-stack.html#环境配置",
    "title": "金字塔堆叠图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2; ggthemes; dplyr\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"ggthemes\", quietly = TRUE)) {\n  install.packages(\"ggthemes\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(ggthemes)\nlibrary(dplyr)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n dplyr      * 1.1.4   2023-11-17 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n ggthemes   * 5.2.0   2025-11-30 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pyramid Stack"
    ]
  },
  {
    "objectID": "Hiplot/146-pyramid-stack.html#数据准备",
    "href": "Hiplot/146-pyramid-stack.html#数据准备",
    "title": "金字塔堆叠图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/pyramid-stack/data.json\")$exampleData[[1]]$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndata[,3] &lt;- factor(data[,3], levels = unique(data[,3]))\ndata[,1] &lt;- factor(data[,1], levels = unique(data[,1]))\n\n# 查看数据\nhead(data)\n\n    age gender year       pop\n1   0-4   male 1950 171.85124\n2   5-9   male 1950 137.99242\n3 10-14   male 1950 133.27428\n4 15-19   male 1950 121.69274\n5 20-24   male 1950 112.39438\n6 25-29   male 1950  96.59408",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pyramid Stack"
    ]
  },
  {
    "objectID": "Hiplot/146-pyramid-stack.html#可视化",
    "href": "Hiplot/146-pyramid-stack.html#可视化",
    "title": "金字塔堆叠图",
    "section": "可视化",
    "text": "可视化\n\n# 金字塔堆叠图\np &lt;- ggplot(data = data, aes(x = age, y = pop, fill = year)) +\n  geom_bar(data = data %&gt;% filter(gender == \"female\") %&gt;% arrange(rev(year)),\n           stat = \"identity\", position = \"identity\") +\n  geom_bar(data = data %&gt;% filter(gender == \"male\") %&gt;% arrange(rev(year)),\n           stat = \"identity\", position = \"identity\", mapping = aes(y = -pop)) +\n  coord_flip() +\n  geom_hline(yintercept = 0) +\n  scale_fill_economist() +\n  scale_fill_manual(values = c(\"#e04d39\",\"#5bbad6\",\"#1e9f86\")) +\n  labs(y = \"pop | male (left) - female (right)\", x= \"\") +\n  theme_economist(horizontal = FALSE) +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"top\",\n        legend.direction = \"horizontal\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10),\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank())\n\np\n\n\n\n\n\n\n\n图 1: 金字塔堆叠图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pyramid Stack"
    ]
  },
  {
    "objectID": "Hiplot/120-meta-cont.html",
    "href": "Hiplot/120-meta-cont.html",
    "title": "连续变量 Meta 分析",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Meta-analysis of Continuous Data 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/meta-cont?lang=zh_cn",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Meta-analysis of Continuous Data"
    ]
  },
  {
    "objectID": "Hiplot/120-meta-cont.html#环境配置",
    "href": "Hiplot/120-meta-cont.html#环境配置",
    "title": "连续变量 Meta 分析",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; meta; ggplotify\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"meta\", quietly = TRUE)) {\n  install.packages(\"meta\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(meta)\nlibrary(ggplotify)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplotify  * 0.1.3   2025-09-20 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n meta       * 8.2-1   2025-09-01 [1] RSPM\n metadat    * 1.4-0   2025-02-04 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Meta-analysis of Continuous Data"
    ]
  },
  {
    "objectID": "Hiplot/120-meta-cont.html#数据准备",
    "href": "Hiplot/120-meta-cont.html#数据准备",
    "title": "连续变量 Meta 分析",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/meta-cont/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\nm1 &lt;- metacont(n.e, mean.e, sd.e, n.c, mean.c, sd.c, studlab = Study, data = data,\n              sm = \"SMD\")\n\n# 查看数据\nhead(data)\n\n  Study n.e mean.e sd.e n.c mean.c  sd.c\n1     A  13    5.0 4.70  13   6.50  3.80\n2     B  30    4.9 1.71  50   6.10  2.30\n3     C  35   22.5 3.44  35  24.90 10.65\n4     D  20   12.5 1.47  20  12.30  1.66\n5     E   8    6.5 0.76   8   7.38  1.41",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Meta-analysis of Continuous Data"
    ]
  },
  {
    "objectID": "Hiplot/120-meta-cont.html#可视化",
    "href": "Hiplot/120-meta-cont.html#可视化",
    "title": "连续变量 Meta 分析",
    "section": "可视化",
    "text": "可视化\n\n# 连续变量 Meta 分析\np &lt;- as.ggplot(function(){\n  meta::forest(m1, layout = \"meta\")\n  })\n\np\n\n\n\n\n\n\n\n图 1: 连续变量 Meta 分析",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Meta-analysis of Continuous Data"
    ]
  },
  {
    "objectID": "Hiplot/087-hic-heatmap.html",
    "href": "Hiplot/087-hic-heatmap.html",
    "title": "Hi-C 热图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Hi-C Heatmap 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/hic-heatmap?lang=zh_cn\nHi-C 热图用于显示不同染色体上的全基因组染色质与热图的相互作用。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Hi-C Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/087-hic-heatmap.html#环境配置",
    "href": "Hiplot/087-hic-heatmap.html#环境配置",
    "title": "Hi-C 热图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2; RColorBrewer\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(RColorBrewer)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package      * version date (UTC) lib source\n data.table   * 1.17.8  2025-07-10 [1] RSPM\n ggplot2      * 4.0.1   2025-11-14 [1] RSPM\n jsonlite     * 2.0.0   2025-03-27 [1] RSPM\n RColorBrewer * 1.1-3   2022-04-03 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Hi-C Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/087-hic-heatmap.html#数据准备",
    "href": "Hiplot/087-hic-heatmap.html#数据准备",
    "title": "Hi-C 热图",
    "section": "数据准备",
    "text": "数据准备\n加载的数据具有三个列，其中第一个用于一个基因座箱索引，第二个是另一个基因座箱索引的第二列，而这两个基因座之间的相互作用频率是第三个。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/hic-heatmap/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 查看数据\nhead(data)\n\n  index_bin1 index_bin2 freq\n1        135        428   13\n2        365        479   38\n3        209        340    8\n4        216        166   34\n5        288        484    5\n6        162        479   14",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Hi-C Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/087-hic-heatmap.html#可视化",
    "href": "Hiplot/087-hic-heatmap.html#可视化",
    "title": "Hi-C 热图",
    "section": "可视化",
    "text": "可视化\n\n# Hi-C 热图\n## 计算bins的个数\nbins_num &lt;- max(data$index_bin1) + 1\n## 设置HiC数据的resolution\nresolution &lt;- 500\nres &lt;- resolution * 1000\n# 设置分隔单位,以50Mb为单位进行分隔\nintervals &lt;- 50\nspacing &lt;- intervals * 1000000\n## 计算breaks的数目\nbreaks_num &lt;- (res * bins_num) / spacing\n## 设置breaks\nbreaks &lt;- c()\nfor (i in 0:breaks_num) {\n  breaks &lt;- c(breaks, i * intervals)\n}\n\np &lt;- ggplot(data = data, aes(x = index_bin1 * res, y = index_bin2 * res)) +\n  geom_tile(aes(fill = freq)) +\n  scale_fill_gradientn(\n    colours = colorRampPalette(rev(brewer.pal(11,\"RdYlBu\")))(500),\n    limits = c(0, max(data$freq) * 1.2)\n  ) +\n  scale_y_reverse() +\n  scale_x_continuous(breaks = breaks * 1000000, labels = paste0(breaks, \"Mb\")) +\n  scale_y_continuous(breaks = breaks * 1000000, labels = paste0(breaks, \"Mb\")) +\n  theme(panel.grid = element_blank(), axis.title = element_blank()) +\n  labs(title = paste0(\"(resolution: \", res / 1000, \"Kb)\"), x=\"\", y=\"\") +\n  theme_bw() +\n  theme(plot.title = element_text(hjust = 0.5),\n        legend.position = \"right\", legend.key.size = unit(0.8, \"cm\"),\n        panel.grid = element_blank())\n\np\n\n\n\n\n\n\n\n图 1: Hi-C 热图\n\n\n\n\n\n示例图每个小格表示每个基因，颜色深浅表示该基因表达量大小，表达量越大颜色越深（红色为上调，绿色为下调）。每行表示每个基因在不同样本中的表达量状况，每列表示每个样本所有基因的表达量情况。上方树形图表示不同组群和年龄的不同样本的聚类分析结果，左侧树形图表示来自不同样本的不同基因的聚类分析结果。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Hi-C Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/130-nomogram-logistic.html",
    "href": "Hiplot/130-nomogram-logistic.html",
    "title": "诺莫图 (逻辑回归)",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Nomogram (Logistic) 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/nomogram-logistic?lang=zh_cn",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Nomogram (Logistic)"
    ]
  },
  {
    "objectID": "Hiplot/130-nomogram-logistic.html#环境配置",
    "href": "Hiplot/130-nomogram-logistic.html#环境配置",
    "title": "诺莫图 (逻辑回归)",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; rms; ggplotify\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"rms\", quietly = TRUE)) {\n  install.packages(\"rms\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(rms)\nlibrary(ggplotify)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplotify  * 0.1.3   2025-09-20 [1] RSPM\n Hmisc      * 5.2-4   2025-10-05 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n rms        * 8.1-0   2025-10-14 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Nomogram (Logistic)"
    ]
  },
  {
    "objectID": "Hiplot/130-nomogram-logistic.html#数据准备",
    "href": "Hiplot/130-nomogram-logistic.html#数据准备",
    "title": "诺莫图 (逻辑回归)",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/nomogram-logistic/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndd &lt;- datadist(data)\noptions(datadist = \"dd\")\n## 建立 Logistic 模型并运行列线图\nlogistic_res &lt;- lrm(data=data, as.formula(paste(\n    colnames(data)[1], \" ~ \",\n    paste(colnames(data)[2:length(colnames(data))],\n      collapse = \"+\"\n    )\n  ))\n)\nlogistic_nomo &lt;- nomogram(logistic_res, maxscale = 100,\n  fun= function(x)1/(1+exp(-x)), lp=F, funlabel=\"Dead Risk\",\n  fun.at=c(.001,.01,.05,seq(.1,.9,by=.1),.95,.99,.999)\n)\n\n# 查看数据\nhead(data)\n\n  status age sex ph.ecog ph.karno pat.karno meal.cal wt.loss\n1      2  74   1       1       90       100     1175      NA\n2      2  68   1       0       90        90     1225      15\n3      1  56   1       0       90        90       NA      15\n4      2  57   1       1       90        60     1150      11\n5      2  60   1       0      100        90       NA       0\n6      1  74   1       1       50        80      513       0",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Nomogram (Logistic)"
    ]
  },
  {
    "objectID": "Hiplot/130-nomogram-logistic.html#可视化",
    "href": "Hiplot/130-nomogram-logistic.html#可视化",
    "title": "诺莫图 (逻辑回归)",
    "section": "可视化",
    "text": "可视化\n\n# 诺莫图 (逻辑回归)\np &lt;- as.ggplot(function() {\n  plot(logistic_nomo,\n    scale = 1\n  )\n  title(main = \"Nomogram (Logistic)\")\n})\n\np\n\n\n\n\n\n\n\n图 1: 诺莫图 (逻辑回归)",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Nomogram (Logistic)"
    ]
  },
  {
    "objectID": "Hiplot/132-parallel-coordinate.html",
    "href": "Hiplot/132-parallel-coordinate.html",
    "title": "平行坐标图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Parallel Coordinate 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/parallel-coordinate?lang=zh_cn",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Parallel Coordinate"
    ]
  },
  {
    "objectID": "Hiplot/132-parallel-coordinate.html#环境配置",
    "href": "Hiplot/132-parallel-coordinate.html#环境配置",
    "title": "平行坐标图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; GGally; hrbrthemes; viridis; ggthemes\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"GGally\", quietly = TRUE)) {\n  install.packages(\"GGally\")\n}\nif (!requireNamespace(\"hrbrthemes\", quietly = TRUE)) {\n  remotes::install_github(\"hrbrmstr/hrbrthemes\")\n}\nif (!requireNamespace(\"viridis\", quietly = TRUE)) {\n  install.packages(\"viridis\")\n}\nif (!requireNamespace(\"ggthemes\", quietly = TRUE)) {\n  install.packages(\"ggthemes\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(GGally)\nlibrary(hrbrthemes)\nlibrary(viridis)\nlibrary(ggthemes)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package     * version date (UTC) lib source\n data.table  * 1.17.8  2025-07-10 [1] RSPM\n GGally      * 2.4.0   2025-08-23 [1] RSPM\n ggplot2     * 4.0.1   2025-11-14 [1] RSPM\n ggthemes    * 5.2.0   2025-11-30 [1] RSPM\n hrbrthemes  * 0.9.2   2025-11-02 [1] Github (hrbrmstr/hrbrthemes@d3fd029)\n jsonlite    * 2.0.0   2025-03-27 [1] RSPM\n viridis     * 0.6.5   2024-01-29 [1] RSPM\n viridisLite * 0.4.2   2023-05-02 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Parallel Coordinate"
    ]
  },
  {
    "objectID": "Hiplot/132-parallel-coordinate.html#数据准备",
    "href": "Hiplot/132-parallel-coordinate.html#数据准备",
    "title": "平行坐标图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/parallel-coordinate/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndata[, 6] &lt;- factor(data[, 6], levels = unique(data[, 6]))\n\n# 查看数据\nhead(data)\n\n    Name Value1 Value2 Value3 Value4       Group\n1    ATR    5.1    3.5    1.4    0.2 p53 pathway\n2  CHEK1    4.9    3.0    1.4    0.2 p53 pathway\n3  GORAB    4.7    3.2    1.3    0.2 p53 pathway\n4 CDKN2A    4.6    3.1    1.5    0.2 p53 pathway\n5   MDM2    5.0    3.6    1.4    0.2 p53 pathway\n6   MDM4    5.4    3.9    1.7    0.4 p53 pathway",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Parallel Coordinate"
    ]
  },
  {
    "objectID": "Hiplot/132-parallel-coordinate.html#可视化",
    "href": "Hiplot/132-parallel-coordinate.html#可视化",
    "title": "平行坐标图",
    "section": "可视化",
    "text": "可视化\n\n# 平行坐标图\np &lt;- ggparcoord(data, columns = 2:(ncol(data) - 1), groupColumn = ncol(data),\n                title = \"Parallel Coordinate Plot for cancer Data\",\n                alphaLines = 0.3, scale = \"globalminmax\",\n                showPoints = T, boxplot = F) +\n  theme_base() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12, hjust = 0.5),\n        axis.title = element_text(size = 10),\n        axis.text = element_text(size = 12),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10)) +\n  scale_color_viridis(discrete = TRUE) +\n  facet_grid(formula(paste(\"~\", (colnames(data)[ncol(data)]))))\n\np\n\n\n\n\n\n\n\n图 1: 平行坐标图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Parallel Coordinate"
    ]
  },
  {
    "objectID": "Hiplot/055-fishplot.html",
    "href": "Hiplot/055-fishplot.html",
    "title": "鱼形图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Fishplot 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/fishplot?lang=zh_cn\n克隆演化分析。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Fishplot"
    ]
  },
  {
    "objectID": "Hiplot/055-fishplot.html#环境配置",
    "href": "Hiplot/055-fishplot.html#环境配置",
    "title": "鱼形图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; fishplot\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"fishplot\", quietly = TRUE)) {\n  remotes::install_github(\"chrisamiller/fishplot\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(fishplot)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n fishplot   * 0.5.2   2025-11-02 [1] Github (chrisamiller/fishplot@3336c93)\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Fishplot"
    ]
  },
  {
    "objectID": "Hiplot/055-fishplot.html#数据准备",
    "href": "Hiplot/055-fishplot.html#数据准备",
    "title": "鱼形图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/fishplot/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 查看数据\nhead(data)\n\n  timepoints parents sample.name event1 event2 event3 event4\n1          0       0     Sample1    100      2      2     98\n2         30       1     Sample1     45      0      0      0\n3         75       1     Sample1      0      0      2     95\n4        150       3     Sample1      0      0      1     40\n\n\n\ntimepoints：为矩阵的每一列指定时间点\nparents：指定克隆之间的父母关系\nsamplename：样品名称（支持多个样品）\nother：包含所有时间点所有克隆的肿瘤比例估计值的数值矩阵",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Fishplot"
    ]
  },
  {
    "objectID": "Hiplot/055-fishplot.html#可视化",
    "href": "Hiplot/055-fishplot.html#可视化",
    "title": "鱼形图",
    "section": "可视化",
    "text": "可视化\n\n## 创建一个 fish 对象\nfish = createFishObject(as.matrix(data[,4:7]), parents=data$parents, \n                        timepoints=data$timepoints, \n                        col = c(\"#888888\",\"#e8130c\",\"#f8150d\",\"#55158f\"))\n## 计算绘图的布局\nfish = layoutClones(fish)\n## 使用 splining 方法绘制图（推荐），并提供标签和绘图标题的时间点\nfishPlot(fish,shape=\"spline\", title.btm=\"Sample1\", title = \"Fishplot\",\n         cex.title=1, vlines=c(0,30,75,150), \n         vlab=c(\"Day 0\",\"Day 30\",\"Day 75\",\"Day 150\"))\n\n\n\n\n\n\n\n图 1: 鱼形图",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Fishplot"
    ]
  },
  {
    "objectID": "Hiplot/083-group-dumbbell.html",
    "href": "Hiplot/083-group-dumbbell.html",
    "title": "分组哑铃图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Group Dumbbell 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/group-dumbbell?lang=zh_cn",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Group Dumbbell"
    ]
  },
  {
    "objectID": "Hiplot/083-group-dumbbell.html#环境配置",
    "href": "Hiplot/083-group-dumbbell.html#环境配置",
    "title": "分组哑铃图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2; ggalt\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"ggalt\", quietly = TRUE)) {\n  remotes::install_github(\"hrbrmstr/ggalt\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(ggalt)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggalt      * 0.6.1   2025-11-02 [1] Github (hrbrmstr/ggalt@8941f8c)\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Group Dumbbell"
    ]
  },
  {
    "objectID": "Hiplot/083-group-dumbbell.html#数据准备",
    "href": "Hiplot/083-group-dumbbell.html#数据准备",
    "title": "分组哑铃图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/group-dumbbell/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndata &lt;- data[order(data[[\"group\"]], data[[\"y1952\"]]),]\ndata[[\"country\"]] &lt;- factor(data[[\"country\"]], levels = data[[\"country\"]])\n\n# 查看数据\nhead(data)\n\n              country  y1952  y2007 group\n13              Haiti 37.579 60.916     A\n2             Bolivia 40.414 65.554     A\n12          Guatemala 42.023 70.259     A\n11        El Salvador 45.262 71.878     A\n9  Dominican Republic 45.928 72.235     A\n10            Ecuador 48.357 74.994     A",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Group Dumbbell"
    ]
  },
  {
    "objectID": "Hiplot/083-group-dumbbell.html#可视化",
    "href": "Hiplot/083-group-dumbbell.html#可视化",
    "title": "分组哑铃图",
    "section": "可视化",
    "text": "可视化\n\n# 分组哑铃图\np &lt;- ggplot(data = data, aes(x = y1952, xend = y2007, y = country, color = group)) +\n  geom_dumbbell(size = 1, size_xend = 2, size_x = 2) +\n  theme_bw()\n\np\n\n\n\n\n\n\n\n图 1: 分组哑铃图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Group Dumbbell"
    ]
  },
  {
    "objectID": "Hiplot/148-qqplot.html",
    "href": "Hiplot/148-qqplot.html",
    "title": "QQ 图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot QQ Plot 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/qqplot?lang=zh_cn\n用于直观验证一组数据是否来自某个分布，或者验证某两组数据是否来自同一（族）分布。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "QQ Plot"
    ]
  },
  {
    "objectID": "Hiplot/148-qqplot.html#环境配置",
    "href": "Hiplot/148-qqplot.html#环境配置",
    "title": "QQ 图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; grafify\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"grafify\", quietly = TRUE)) {\n  install.packages(\"grafify\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(grafify)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n grafify    * 5.1.0   2025-08-25 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "QQ Plot"
    ]
  },
  {
    "objectID": "Hiplot/148-qqplot.html#数据准备",
    "href": "Hiplot/148-qqplot.html#数据准备",
    "title": "QQ 图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/qqplot/data.json\")$exampleData[[1]]$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndata[, \"Genotype\"] &lt;- factor(data[, \"Genotype\"], levels = unique(data[, \"Genotype\"]))\n\n# 查看数据\nhead(data)\n\n  Genotype Cytokine Experiment facet\n1       WT 1.312322     Exp_ 1     A\n2       WT 2.171466     Exp_ 2     A\n3       WT 1.497610     Exp_ 3     A\n4       WT 1.088861     Exp_ 4     A\n5       WT 1.270528     Exp_ 5     A\n6       WT 3.012708     Exp_ 6     A",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "QQ Plot"
    ]
  },
  {
    "objectID": "Hiplot/148-qqplot.html#可视化",
    "href": "Hiplot/148-qqplot.html#可视化",
    "title": "QQ 图",
    "section": "可视化",
    "text": "可视化\n\n# QQ 图\np &lt;- plot_qqline(data = data, ycol = Cytokine, group = Genotype,\n                 symsize = 2, symthick = 0.5, s_alpha = 1) +\n  ggtitle(\"QQplot without facet\") +\n  xlab(\"theoretical\") + ylab(\"sample\") + \n  guides(fill = guide_legend(title = \"Genotype\")) +\n  scale_color_manual(values = c(\"#E69F00\",\"#4DB1DC\")) +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 1: QQ 图",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "QQ Plot"
    ]
  },
  {
    "objectID": "Hiplot/098-map-china-city.html",
    "href": "Hiplot/098-map-china-city.html",
    "title": "中国地图 (市)",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Americas Map 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/map-china-city?lang=zh_cn",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "China Map (City)"
    ]
  },
  {
    "objectID": "Hiplot/098-map-china-city.html#环境配置",
    "href": "Hiplot/098-map-china-city.html#环境配置",
    "title": "中国地图 (市)",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2; RColorBrewer\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(RColorBrewer)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package      * version date (UTC) lib source\n data.table   * 1.17.8  2025-07-10 [1] RSPM\n ggplot2      * 4.0.1   2025-11-14 [1] RSPM\n jsonlite     * 2.0.0   2025-03-27 [1] RSPM\n RColorBrewer * 1.1-3   2022-04-03 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "China Map (City)"
    ]
  },
  {
    "objectID": "Hiplot/098-map-china-city.html#数据准备",
    "href": "Hiplot/098-map-china-city.html#数据准备",
    "title": "中国地图 (市)",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/map-china-city/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\ndt_map &lt;- readRDS(url(\"https://download.hiplot.cn/ui/basic/map-china-city/china.city.rds\"))\n\n# 整理数据格式\ndt_map$Value &lt;- data$value[match(dt_map$city, data$name)]\n\n# 查看数据\nhead(data)\n\n      name value\n1   北京市   756\n2   天津市   321\n3 石家庄市   232\n4   唐山市   467\n5 秦皇岛市   549\n6   邯郸市   226",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "China Map (City)"
    ]
  },
  {
    "objectID": "Hiplot/098-map-china-city.html#可视化",
    "href": "Hiplot/098-map-china-city.html#可视化",
    "title": "中国地图 (市)",
    "section": "可视化",
    "text": "可视化\n\n# 中国地图 (市)\np &lt;- ggplot(dt_map) +\n  geom_polygon(aes(x = long, y = lat, group = group, fill = Value),\n               alpha = 0.9, size = 0.5) +\n  geom_path(aes(x = long, y = lat, group = group), color = \"black\", size = 0.2) +\n  coord_fixed() +\n  scale_fill_gradientn(\n    colours = colorRampPalette(rev(brewer.pal(11,\"RdYlBu\")))(500),\n    breaks = seq(min(data$value), max(data$value), \n                 round((max(data$value)-min(data$value))/7)),\n    name = \"\",\n    guide = guide_legend(\n      direction = \"vertical\", keyheight = unit(1, units = \"mm\"),\n      keywidth = unit(8, units = \"mm\"),\n      title.position = \"top\", title.hjust = 0.5, label.hjust = 0.5,\n      nrow = 1, byrow = T, reverse = F, label.position = \"bottom\")) +\n  theme(text = element_text(color = \"#3A3F4A\"),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank(),\n        legend.position = \"top\",\n        legend.text = element_text(size = 4 * 1.5, color = \"black\"),\n        legend.title = element_text(size = 5 * 1.5, color = \"black\"),\n        plot.title = element_text(\n          face = \"bold\", size = 5 * 1.5, hjust = 0.5, \n          margin = margin(t = 4, b = 5), color = \"black\"),\n        plot.background = element_rect(fill = \"#FFFFFF\", color = \"#FFFFFF\"),\n        panel.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        legend.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        plot.margin = unit(c(1.5, 1.5, 1.5, 1.5), \"cm\")) +\n  labs(x = NULL, y = NULL, title = \"China City Map\")\n\np\n\n\n\n\n\n\n\n图 1: 中国地图 (市)",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "China Map (City)"
    ]
  },
  {
    "objectID": "Hiplot/074-ggseqlogo.html",
    "href": "Hiplot/074-ggseqlogo.html",
    "title": "序列 Logo",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Seqlogo 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/ggseqlogo?lang=zh_cn\n序列 Logo 是一种用来描述结合位点序列模式的图形。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Seqlogo"
    ]
  },
  {
    "objectID": "Hiplot/074-ggseqlogo.html#环境配置",
    "href": "Hiplot/074-ggseqlogo.html#环境配置",
    "title": "序列 Logo",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggseqlogo; ggplot2\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggseqlogo\", quietly = TRUE)) {\n  install.packages(\"ggseqlogo\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggseqlogo)\nlibrary(ggplot2)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n ggseqlogo  * 0.2.2   2025-12-22 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Seqlogo"
    ]
  },
  {
    "objectID": "Hiplot/074-ggseqlogo.html#数据准备",
    "href": "Hiplot/074-ggseqlogo.html#数据准备",
    "title": "序列 Logo",
    "section": "数据准备",
    "text": "数据准备\n载入数据为多个转录因子在多个基因上的结合位点的序列。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/ggseqlogo/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndata &lt;- data[, !sapply(data, function(x) {all(is.na(x))})]\ndata &lt;- as.list(data)\ndata &lt;- lapply(data, function(x) {return(x[!is.na(x)])})\n\n# 查看数据\nstr(data[1:5])\n\nList of 5\n $ MA0001.1: chr [1:97] \"CCATATATAG\" \"CCATATATAG\" \"CCATAAATAG\" \"CCATAAATAG\" ...\n $ MA0002.1: chr [1:26] \"AATTGTGGTTA\" \"ATCTGTGGTTA\" \"AATTGTGGTAA\" \"TTCTGCGGTTA\" ...\n $ MA0004.1: chr [1:20] \"CACGTG\" \"CACGTG\" \"CACGTG\" \"CACGTG\" ...\n $ MA0005.1: chr [1:90] \"CCTAATTGGGC\" \"CCTAATTTGGC\" \"CCTAATCGGGC\" \"CCTAATCGGGC\" ...\n $ MA0006.1: chr [1:24] \"CGCGTG\" \"CGCGTG\" \"CGCGTG\" \"CGCGTG\" ...",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Seqlogo"
    ]
  },
  {
    "objectID": "Hiplot/074-ggseqlogo.html#可视化",
    "href": "Hiplot/074-ggseqlogo.html#可视化",
    "title": "序列 Logo",
    "section": "可视化",
    "text": "可视化\n\n# 序列 Logo\np &lt;- ggseqlogo(\n  data,\n  ncol = 4,\n  col_scheme = \"nucleotide\",\n  seq_type = \"dna\",\n  method = \"bits\") + \n  theme(plot.title = element_text(hjust = 0.5))\n\np\n\n\n\n\n\n\n\n图 1: 序列 Logo\n\n\n\n\n\n采用 bits 计算的方式将一个结合位点序列展示在图表一列，可以清晰观测到不同序列占比较大的碱基。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Seqlogo"
    ]
  },
  {
    "objectID": "Hiplot/079-gocircle.html",
    "href": "Hiplot/079-gocircle.html",
    "title": "GO圈图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot GOCircle Plot 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/gocircle?lang=zh_cn\nGO圈图用于显示圆图结合了基因表达和基因注释富集数据。术语的子集与GOBar图一起显示与基因表达数据的散点图结合使用。整个图都在特定的坐标系上绘制，以实现圆形布局。该段标记为术语ID。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "GOCircle Plot"
    ]
  },
  {
    "objectID": "Hiplot/079-gocircle.html#环境配置",
    "href": "Hiplot/079-gocircle.html#环境配置",
    "title": "GO圈图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; GOplot; ggplotify\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"GOplot\", quietly = TRUE)) {\n  install.packages(\"GOplot\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(GOplot)\nlibrary(ggplotify)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package      * version date (UTC) lib source\n data.table   * 1.17.8  2025-07-10 [1] RSPM\n ggdendro     * 0.2.0   2024-02-23 [1] RSPM\n ggplot2      * 4.0.1   2025-11-14 [1] RSPM\n ggplotify    * 0.1.3   2025-09-20 [1] RSPM\n GOplot       * 1.0.2   2016-03-30 [1] RSPM\n gridExtra    * 2.3     2017-09-09 [1] RSPM\n jsonlite     * 2.0.0   2025-03-27 [1] RSPM\n RColorBrewer * 1.1-3   2022-04-03 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "GOCircle Plot"
    ]
  },
  {
    "objectID": "Hiplot/079-gocircle.html#数据准备",
    "href": "Hiplot/079-gocircle.html#数据准备",
    "title": "GO圈图",
    "section": "数据准备",
    "text": "数据准备\n加载的数据是具有七个列的GO富集的结果：category, GO id, GO term, gene count, gene name, logFC, adjust pvalue and zscore。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/gocircle/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ncolnames(data) &lt;- c(\"category\",\"ID\",\"term\",\"count\",\"genes\",\"logFC\",\"adj_pval\",\"zscore\")\ndata &lt;- data[!is.na(data$adj_pval),]\ndata$adj_pval &lt;- as.numeric(data$adj_pval)\ndata$zscore &lt;- as.numeric(data$zscore)\ndata$count &lt;- as.numeric(data$count)\n\n# 查看数据\nhead(data)\n\n  category         ID              term count  genes      logFC adj_pval\n1       BP GO:0007507 heart development    54   DLC1 -0.9707875 2.17e-06\n2       BP GO:0007507 heart development    54   NRP2 -1.5153173 2.17e-06\n3       BP GO:0007507 heart development    54   NRP1 -1.1412315 2.17e-06\n4       BP GO:0007507 heart development    54   EDN1  1.3813006 2.17e-06\n5       BP GO:0007507 heart development    54 PDLIM3 -0.8876939 2.17e-06\n6       BP GO:0007507 heart development    54   GJA1 -0.8179480 2.17e-06\n      zscore\n1 -0.8164966\n2 -0.8164966\n3 -0.8164966\n4 -0.8164966\n5 -0.8164966\n6 -0.8164966",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "GOCircle Plot"
    ]
  },
  {
    "objectID": "Hiplot/079-gocircle.html#可视化",
    "href": "Hiplot/079-gocircle.html#可视化",
    "title": "GO圈图",
    "section": "可视化",
    "text": "可视化\n\n# GO圈图\np &lt;- function () {\n  GOCircle(data, title = \"GO Enrichment Circleplot\",\n           nsub = 10, rad1 = 2, rad2 = 3, table.legend = T, label.size = 5,\n           zsc.col = c(\"#FC8D59\",\"#FFFFBF\",\"#99D594\")) + \n    theme(plot.title = element_text(hjust = 0.5))\n}\np &lt;- as.ggplot(p)\n\np\n\n\n\n\n\n\n\n图 1: GO圈图\n\n\n\n如示例图所示，外圈显示了分配基因的logFC的每个项的散点图。默认情况下，红色圆圈显示上调和蓝色的下调。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "GOCircle Plot"
    ]
  },
  {
    "objectID": "Hiplot/029-cor-heatmap-simple.html",
    "href": "Hiplot/029-cor-heatmap-simple.html",
    "title": "简单可变相关热图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Simplified Correlation Heatmap 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/cor-heatmap-simple?lang=zh_cn\n提供一个简单化版本的相关热图可视化。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Simplified Correlation Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/029-cor-heatmap-simple.html#环境配置",
    "href": "Hiplot/029-cor-heatmap-simple.html#环境配置",
    "title": "简单可变相关热图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2; sigminer\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"sigminer\", quietly = TRUE)) {\n  BiocManager::install(\"sigminer\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(sigminer)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package      * version date (UTC) lib source\n Biobase      * 2.70.0  2025-10-29 [1] Bioconduc~\n BiocGenerics * 0.56.0  2025-10-29 [1] Bioconduc~\n data.table   * 1.17.8  2025-07-10 [1] RSPM\n generics     * 0.1.4   2025-05-09 [1] RSPM\n ggplot2      * 4.0.1   2025-11-14 [1] RSPM\n jsonlite     * 2.0.0   2025-03-27 [1] RSPM\n sigminer     * 2.3.1   2024-05-11 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Simplified Correlation Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/029-cor-heatmap-simple.html#数据准备",
    "href": "Hiplot/029-cor-heatmap-simple.html#数据准备",
    "title": "简单可变相关热图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/cor-heatmap-simple/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 查看数据\nhead(data)\n\n   mpg cyl disp  hp drat    wt  qsec vs am gear carb\n1 21.0   6  160 110 3.90 2.620 16.46  0  1    4    4\n2 21.0   6  160 110 3.90 2.875 17.02  0  1    4    4\n3 22.8   4  108  93 3.85 2.320 18.61  1  1    4    1\n4 21.4   6  258 110 3.08 3.215 19.44  1  0    3    1\n5 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2\n6 18.1   6  225 105 2.76 3.460 20.22  1  0    3    1",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Simplified Correlation Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/029-cor-heatmap-simple.html#可视化",
    "href": "Hiplot/029-cor-heatmap-simple.html#可视化",
    "title": "简单可变相关热图",
    "section": "可视化",
    "text": "可视化\n\n# 简单可变相关热图\np &lt;- show_cor(\n  data = data,\n  x_vars = c(\"mpg\",\"cyl\",\"disp\"),\n  y_vars = c(\"wt\",\"hp\",\"drat\"),\n  cor_method = \"pearson\",\n  vis_method = \"square\",\n  lab = T,\n  test = T,\n  hc_order = F,\n  legend.title = \"Corr\"\n  ) +\n  ggtitle(\"\") +\n  labs(x=\"\", y=\"\") +\n  theme_bw() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 1: 简单可变相关热图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Simplified Correlation Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/118-matrix-bubble.html",
    "href": "Hiplot/118-matrix-bubble.html",
    "title": "矩阵气泡图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Matrix Bubble 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/matrix-bubble?lang=zh_cn\n彩色矩阵气泡用于可视化不同细胞（列）中多个基因（行）的表达矩阵数据。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Matrix Bubble"
    ]
  },
  {
    "objectID": "Hiplot/118-matrix-bubble.html#环境配置",
    "href": "Hiplot/118-matrix-bubble.html#环境配置",
    "title": "矩阵气泡图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggalluvial; ggplot2\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggalluvial\", quietly = TRUE)) {\n  install.packages(\"ggalluvial\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggalluvial)\nlibrary(ggplot2)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggalluvial * 0.12.5  2023-02-22 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Matrix Bubble"
    ]
  },
  {
    "objectID": "Hiplot/118-matrix-bubble.html#数据准备",
    "href": "Hiplot/118-matrix-bubble.html#数据准备",
    "title": "矩阵气泡图",
    "section": "数据准备",
    "text": "数据准备\n数据结构：\n\n&lt;1st-col&gt;: (String) 单元格样本名称作为 X 轴\n&lt;2nd-col&gt;: (String) 基因名作为Y轴\n&lt;3rd-col&gt;: (Numeric) 基因表达\n&lt;4rd-col&gt;: (Numeric) 组\n\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/matrix-bubble/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndata[, 1] &lt;- factor(data[, 1], levels = unique(data[, 1]))\ndata[, 2] &lt;- factor(data[, 2], levels = unique(data[, 2]))\n\n# 查看数据\nhead(data)\n\n      x     y value  group\n1 cell1 gene1     1 groupC\n2 cell1 gene2     5 groupC\n3 cell1 gene3    10 groupC\n4 cell1 gene4    15 groupC\n5 cell1 gene5    20 groupC\n6 cell1 gene6    25 groupC",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Matrix Bubble"
    ]
  },
  {
    "objectID": "Hiplot/118-matrix-bubble.html#可视化",
    "href": "Hiplot/118-matrix-bubble.html#可视化",
    "title": "矩阵气泡图",
    "section": "可视化",
    "text": "可视化\n\n# 矩阵气泡图\np &lt;- ggplot(data = data, aes(x = x, y = y, size = value, color = y)) +\n  geom_point(alpha = 1) +\n  labs(title = \"Matrix Bubble\") +\n  guides(color = FALSE) +\n  theme(panel.background = element_blank(),\n        panel.grid.major = element_line(colour = \"gray\"),\n        strip.background = element_blank(),\n        panel.border = element_rect(colour = \"black\", fill = NA),\n        panel.spacing = unit(0, \"lines\"),\n        plot.title = element_text(size = 12, hjust = 0.5),\n        text = element_text(family = \"Arial\"),\n        legend.title = element_text(size = 10),\n        axis.text.x = element_text(angle=0, hjust=0.5, vjust=1)) +\n  facet_grid(~group, scales = 'fixed', margins = F) +\n  scale_color_manual(values = c(\n    \"#3B4992FF\",\"#EE0000FF\",\"#008B45FF\",\"#631879FF\",\"#008280FF\",\"#BB0021FF\",\n    \"#5F559BFF\",\"#A20056FF\",\"#808180FF\",\"#1B1919FF\"))\n\np\n\n\n\n\n\n\n\n图 1: 矩阵气泡图",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Matrix Bubble"
    ]
  },
  {
    "objectID": "Hiplot/144-pyramid-chart.html",
    "href": "Hiplot/144-pyramid-chart.html",
    "title": "金字塔图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Pyramid Chart 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/pyramid-chart?lang=zh_cn\n金字塔图是一种将数据分布于中轴两侧类似金字塔的图形。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pyramid Chart"
    ]
  },
  {
    "objectID": "Hiplot/144-pyramid-chart.html#环境配置",
    "href": "Hiplot/144-pyramid-chart.html#环境配置",
    "title": "金字塔图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggcharts\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggcharts\", quietly = TRUE)) {\n  install.packages(\"ggcharts\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggcharts)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggcharts   * 0.2.1   2020-05-20 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pyramid Chart"
    ]
  },
  {
    "objectID": "Hiplot/144-pyramid-chart.html#数据准备",
    "href": "Hiplot/144-pyramid-chart.html#数据准备",
    "title": "金字塔图",
    "section": "数据准备",
    "text": "数据准备\n载入数据为年龄段，性别分类及前两种变量组合后的人口数目。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/pyramid-chart/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 查看数据\nhead(data)\n\n    age    sex    pop\n1   0-4   male 225817\n2   0-4 female 213072\n3   5-9   male 223656\n4   5-9 female 210508\n5 10-14   male 214782\n6 10-14 female 201672",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pyramid Chart"
    ]
  },
  {
    "objectID": "Hiplot/144-pyramid-chart.html#可视化",
    "href": "Hiplot/144-pyramid-chart.html#可视化",
    "title": "金字塔图",
    "section": "可视化",
    "text": "可视化\n\n# 金字塔图\np &lt;- pyramid_chart(data = data, x = age, y = pop, group = sex, \n                   title = \"\", sort = \"no\", bar_colors = c(\"#C20B01\",\"#196ABD\")) +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 1: 金字塔图\n\n\n\n\n\n图示将年龄段按照顺序从下到上依次显示在中轴线上，左侧表示男性人数，右侧表示女性人数，x 轴表示人口数量，该图可以很明显看出男女在不同年龄段的人数占比情况以及相同性别中不同年龄组的占比情况。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pyramid Chart"
    ]
  },
  {
    "objectID": "Hiplot/181-violin.html",
    "href": "Hiplot/181-violin.html",
    "title": "小提琴图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Violin 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/violin?lang=zh_cn\n小提琴图，因形似小提琴而得名，是结合了箱形图和核密度图，用于显示数据分布及概率密度的统计图表。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Violin"
    ]
  },
  {
    "objectID": "Hiplot/181-violin.html#环境配置",
    "href": "Hiplot/181-violin.html#环境配置",
    "title": "小提琴图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggpubr; ggthemes\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggpubr\", quietly = TRUE)) {\n  install.packages(\"ggpubr\")\n}\nif (!requireNamespace(\"ggthemes\", quietly = TRUE)) {\n  install.packages(\"ggthemes\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggpubr)\nlibrary(ggthemes)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n ggpubr     * 0.6.2   2025-10-17 [1] RSPM\n ggthemes   * 5.2.0   2025-11-30 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Violin"
    ]
  },
  {
    "objectID": "Hiplot/181-violin.html#数据准备",
    "href": "Hiplot/181-violin.html#数据准备",
    "title": "小提琴图",
    "section": "数据准备",
    "text": "数据准备\n载入数据为数据集 (不同肿瘤中基因名称及表达水平)。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/violin/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ngroups &lt;- unique(data[, 2])\nngroups &lt;- length(groups)\ncomb &lt;- combn(1:ngroups, 2)\nmy_comparisons &lt;- list()\nfor (i in seq_len(ncol(comb))) {\n  my_comparisons[[i]] &lt;- groups[comb[, i]]\n}\n\n# 查看数据\nhead(data)\n\n  Expresssion Tumor\n1    12.10228   AML\n2    12.61382   AML\n3    12.52741   AML\n4    12.67990   AML\n5    12.64837   AML\n6    12.12146   AML",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Violin"
    ]
  },
  {
    "objectID": "Hiplot/181-violin.html#可视化",
    "href": "Hiplot/181-violin.html#可视化",
    "title": "小提琴图",
    "section": "可视化",
    "text": "可视化\n\n# 小提琴图\np &lt;- ggviolin(data, x = \"Tumor\", y = \"Expresssion\", fill = \"Tumor\", add = \"boxplot\",\n              xlab = \"Tumor\", ylab = \"Expresssion\", \n              add.params = list(fill = \"white\"),\n              palette = c(\"#e04d39\",\"#5bbad6\",\"#1e9f86\"),\n              title = \"Violin Plot\", alpha = 1) + \n  stat_compare_means(comparisons = my_comparisons, label = \"p.signif\") +\n  theme_stata() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 1: 小提琴图\n\n\n\n\n\n小提琴图可以反映数据分布，同箱形图类似，方框中黑色横线显示各肿瘤中基因表达水平的中位数， 白色方框中上下框边代表数据集中的上，下四分位点；小提琴图还可以反映数据密度，数据集数据越集中则图形越胖。图示中BLGG 组中的基因表达分布更集中，BIC 组次之，AML组则分布最分散。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Violin"
    ]
  },
  {
    "objectID": "Hiplot/066-ggdist.html",
    "href": "Hiplot/066-ggdist.html",
    "title": "分布图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Dist Plot 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/ggdist?lang=zh_cn\n分布图是一种采用置信分布的可视化图形。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Dist Plot"
    ]
  },
  {
    "objectID": "Hiplot/066-ggdist.html#环境配置",
    "href": "Hiplot/066-ggdist.html#环境配置",
    "title": "分布图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggdist; tidyr; broom; modelr; ggplot2\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggdist\", quietly = TRUE)) {\n  install.packages(\"ggdist\")\n}\nif (!requireNamespace(\"tidyr\", quietly = TRUE)) {\n  install.packages(\"tidyr\")\n}\nif (!requireNamespace(\"broom\", quietly = TRUE)) {\n  install.packages(\"broom\")\n}\nif (!requireNamespace(\"modelr\", quietly = TRUE)) {\n  install.packages(\"modelr\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggdist)\nlibrary(tidyr)\nlibrary(broom)\nlibrary(modelr)\nlibrary(ggplot2)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n broom      * 1.0.11  2025-12-04 [1] RSPM\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggdist     * 3.3.3   2025-04-23 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n modelr     * 0.1.11  2023-03-22 [1] RSPM\n tidyr      * 1.3.2   2025-12-19 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Dist Plot"
    ]
  },
  {
    "objectID": "Hiplot/066-ggdist.html#数据准备",
    "href": "Hiplot/066-ggdist.html#数据准备",
    "title": "分布图",
    "section": "数据准备",
    "text": "数据准备\n载入数据为 5 种条件及其对应的值。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/ggdist/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndata[, 1] &lt;- factor(data[, 1], levels = rev(unique(data[, 1])))\ndata &lt;- tibble(data)\ndata2 = lm(response ~ condition, data = data)\ndata3 &lt;- data_grid(data, condition) %&gt;%\n  augment(data2, newdata = ., se_fit = TRUE)\n\n# 查看数据\nhead(data)\n\n# A tibble: 6 × 2\n  condition response\n  &lt;fct&gt;        &lt;dbl&gt;\n1 A           -0.420\n2 B            1.69 \n3 C            1.37 \n4 D            1.04 \n5 E           -0.144\n6 A           -0.301",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Dist Plot"
    ]
  },
  {
    "objectID": "Hiplot/066-ggdist.html#可视化",
    "href": "Hiplot/066-ggdist.html#可视化",
    "title": "分布图",
    "section": "可视化",
    "text": "可视化\n\n# 分布图\np &lt;- ggplot(data3, aes_(y = as.name(colnames(data[1])))) +\n  stat_dist_halfeye(aes(dist = \"student_t\", arg1 = df.residual(data2),\n                        arg2 = .fitted, arg3 = .se.fit),\n                    scale = .5) +\n  geom_point(aes_(x = as.name(colnames(data[2]))),\n             data = data, pch = \"|\", size = 2,\n             position = position_nudge(y = -.15)) +\n  ggtitle(\"ggdist Plot\") + \n  xlab(\"response\") + ylab(\"condition\") +\n  theme_ggdist() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 1: 分布图\n\n\n\n\n\n图示给出的是条件下均值的置信度分布，可以看出 5 种条件下对应值的大致分布情况。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Dist Plot"
    ]
  },
  {
    "objectID": "Hiplot/058-funnel-plot.html",
    "href": "Hiplot/058-funnel-plot.html",
    "title": "漏斗图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Funnel Plot 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/funnel-plot?lang=zh_cn\n可以用于分析 Meta 分析结果中潜在偏倚因子。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Funnel Plot"
    ]
  },
  {
    "objectID": "Hiplot/058-funnel-plot.html#环境配置",
    "href": "Hiplot/058-funnel-plot.html#环境配置",
    "title": "漏斗图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; FunnelPlotR; gridExtra\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"FunnelPlotR\", quietly = TRUE)) {\n  install.packages(\"FunnelPlotR\")\n}\nif (!requireNamespace(\"gridExtra\", quietly = TRUE)) {\n  install.packages(\"gridExtra\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(FunnelPlotR)\nlibrary(gridExtra)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package     * version date (UTC) lib source\n data.table  * 1.17.8  2025-07-10 [1] RSPM\n FunnelPlotR * 0.6.0   2025-07-23 [1] RSPM\n gridExtra   * 2.3     2017-09-09 [1] RSPM\n jsonlite    * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Funnel Plot"
    ]
  },
  {
    "objectID": "Hiplot/058-funnel-plot.html#数据准备",
    "href": "Hiplot/058-funnel-plot.html#数据准备",
    "title": "漏斗图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/funnel-plot/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 查看数据\nhead(data)\n\n  los hmo white died age80 type type1 type2 type3 provnum     prds\n1   4   0     1    0     0    1     1     0     0   30001 9.667315\n2   9   1     1    0     0    1     1     0     0   30001 8.956472\n3   3   1     1    1     1    1     1     0     0   30001 6.856678\n4   9   0     1    0     0    1     1     0     0   30001 9.667315\n5   1   0     1    1     1    1     1     0     0   30001 7.400868\n6   4   0     1    1     0    1     1     0     0   30001 7.561051",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Funnel Plot"
    ]
  },
  {
    "objectID": "Hiplot/058-funnel-plot.html#可视化",
    "href": "Hiplot/058-funnel-plot.html#可视化",
    "title": "漏斗图",
    "section": "可视化",
    "text": "可视化\n\n# 漏斗图\np &lt;- funnel_plot(\n  data, numerator = los, denominator = prds,  group = provnum, data_type = \"SR\",\n  limit = 99, label = \"outlier\", sr_method = \"SHMI\", trim_by=0.1, \n  title = \"Funnel Plot\", x_range = \"auto\", y_range = \"auto\"\n  )\n\np\n\nA funnel plot object with 54 points of which 9 are outliers. \nPlot is adjusted for overdispersion. \n\n\n\n\n\n\n\n\n图 1: 漏斗图",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Funnel Plot"
    ]
  },
  {
    "objectID": "Hiplot/173-treemap.html",
    "href": "Hiplot/173-treemap.html",
    "title": "树型图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Treemap 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/treemap?lang=zh_cn\n树形图是一种用图形形式来表示层次结构的树形结构图。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Treemap"
    ]
  },
  {
    "objectID": "Hiplot/173-treemap.html#环境配置",
    "href": "Hiplot/173-treemap.html#环境配置",
    "title": "树型图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; treemap\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"treemap\", quietly = TRUE)) {\n  install.packages(\"treemap\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(treemap)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n treemap    * 2.4-4   2023-05-25 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Treemap"
    ]
  },
  {
    "objectID": "Hiplot/173-treemap.html#数据准备",
    "href": "Hiplot/173-treemap.html#数据准备",
    "title": "树型图",
    "section": "数据准备",
    "text": "数据准备\n载入数据为不同分组及其数据。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/treemap/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 查看数据\nhead(data)\n\n   group value\n1 Group1    13\n2 Group2    34\n3 Group3    21\n4 Group4    43",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Treemap"
    ]
  },
  {
    "objectID": "Hiplot/173-treemap.html#可视化",
    "href": "Hiplot/173-treemap.html#可视化",
    "title": "树型图",
    "section": "可视化",
    "text": "可视化\n\n# 树型图\ntreemap(data, index = colnames(data)[1], vSize = colnames(data)[2],\n        vColor = colnames(data)[1], type = \"index\", title = \"\", \n        algorithm = \"pivotSize\", sortID = colnames(data)[1], border.lwds = 1,\n        fontcolor.labels = \"#000000\", inflate.labels = F, overlap.labels = 0.5,\n        fontfamily.title = \"Arial\", fontfamily.legend = \"Arial\",\n        fontfamily.labels = \"Arial\", \n        palette = c(\"#E64B35FF\",\"#4DBBD5FF\",\"#00A087FF\",\"#3C5488FF\",\"#F39B7FFF\"), \n        aspRatio = 6 / 6)\n\n\n\n\n\n\n\n图 1: 树型图\n\n\n\n\n\n不同颜色表示不同组群 ，不同面积表示数据及占比。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Treemap"
    ]
  },
  {
    "objectID": "Hiplot/158-sankey.html",
    "href": "Hiplot/158-sankey.html",
    "title": "桑基图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Sankey 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/sankey?lang=zh_cn\n桑基图是一种流量图，其中箭头的宽度与流量成比例。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Sankey"
    ]
  },
  {
    "objectID": "Hiplot/158-sankey.html#环境配置",
    "href": "Hiplot/158-sankey.html#环境配置",
    "title": "桑基图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggalluvial; ggplot2\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggalluvial\", quietly = TRUE)) {\n  install.packages(\"ggalluvial\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggalluvial)\nlibrary(ggplot2)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggalluvial * 0.12.5  2023-02-22 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Sankey"
    ]
  },
  {
    "objectID": "Hiplot/158-sankey.html#数据准备",
    "href": "Hiplot/158-sankey.html#数据准备",
    "title": "桑基图",
    "section": "数据准备",
    "text": "数据准备\n载入数据为 4 个变量及每4种变量组合下的频数。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/sankey/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\nvalue &lt;- \"Freq\"\naxis &lt;- c(\"Class\", \"Sex\")\nusr_axis &lt;- c()\nfor (i in seq_len(length(axis))) {\n  usr_axis &lt;- c(usr_axis, axis[i])\n  assign(paste0(\"axis\", i), axis[i])\n}\nindex_axis &lt;- match(usr_axis, colnames(data))\nindex_value &lt;- match(value, colnames(data))\ndata1 &lt;- data[, c(index_value, index_axis)]\n## 定义带颜色\nnlevels &lt;- as.numeric(apply(data1[, -1], 2, function(data) {\n  return(length(unique(data)))\n}))\nband_color &lt;- c(\"#8DD3C7\", \"#FFFFB3\", \"#BEBADA\", \"#FB8072\", \"#8DD3C7\", \"#FFFFB3\")\n## 重命名数据\ndata_rename &lt;- data1\ncolnames(data_rename) &lt;- c(\n  \"value\",\n  paste(\"axis\", seq_len(length(usr_axis)), sep = \"\")\n)\n\n# 查看数据\nhead(data)\n\n  Class    Sex   Age Survived Freq\n1   1st   Male Child       No    0\n2   2nd   Male Child       No    0\n3   3rd   Male Child       No   35\n4  Crew   Male Child       No    0\n5   1st Female Child       No    0\n6   2nd Female Child       No    0",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Sankey"
    ]
  },
  {
    "objectID": "Hiplot/158-sankey.html#可视化",
    "href": "Hiplot/158-sankey.html#可视化",
    "title": "桑基图",
    "section": "可视化",
    "text": "可视化\n\n# 桑基图\np &lt;- ggplot(data_rename, aes(y = value, axis1 = axis1, axis2 = axis2)) +\n  geom_alluvium(alpha = 1, aes(fill = data1[, colnames(data1) == \"Sex\"]),\n                width = 0, reverse = FALSE) +\n  scale_x_discrete(limits = usr_axis, expand = c(0.02, 0.1)) +\n  ylab(\"\") +\n  scale_fill_discrete(name = \"Sex\") +\n  coord_flip() +\n  geom_stratum(alpha = 1, width = 1 / 8, reverse = FALSE, fill = band_color,\n               color = \"white\") +\n  geom_text(stat = \"stratum\", infer.label = TRUE, reverse = FALSE) +\n  ggtitle(\"Sankey plot\") +\n  guides(fill = guide_legend(title = \"Sex\")) +\n  scale_fill_manual(values = c(\"#00468BFF\", \"#ED0000FF\")) +\n  theme_bw() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 1: 桑基图\n\n\n\n\n\nfemale 分流的颜色为蓝色，male 分流的颜色为红色，蓝色分流出去的宽度和等于 female 的总宽度。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Sankey"
    ]
  },
  {
    "objectID": "Hiplot/006-barplot-errorbar2.html",
    "href": "Hiplot/006-barplot-errorbar2.html",
    "title": "误差线柱状图2",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Barplot (errorbar2) 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/barplot-errorbar2?lang=zh_cn\n带误差线和误差组的条形图。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Barplot (errorbar2)"
    ]
  },
  {
    "objectID": "Hiplot/006-barplot-errorbar2.html#环境配置",
    "href": "Hiplot/006-barplot-errorbar2.html#环境配置",
    "title": "误差线柱状图2",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2; grafify; ggpubr\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"grafify\", quietly = TRUE)) {\n  install.packages(\"grafify\")\n}\nif (!requireNamespace(\"ggpubr\", quietly = TRUE)) {\n  install.packages(\"ggpubr\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(grafify)\nlibrary(ggpubr)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n ggpubr     * 0.6.2   2025-10-17 [1] RSPM\n grafify    * 5.1.0   2025-08-25 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Barplot (errorbar2)"
    ]
  },
  {
    "objectID": "Hiplot/006-barplot-errorbar2.html#数据准备",
    "href": "Hiplot/006-barplot-errorbar2.html#数据准备",
    "title": "误差线柱状图2",
    "section": "数据准备",
    "text": "数据准备\n数据表:\n第一列: (数值) Y 轴值。\n第二列: (数值或字符串) X 轴类别。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/barplot-errorbar2/data.json\")$exampleData[[1]]$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndata[, 2] &lt;- factor(data[, 2], levels = unique(data[, 2]))\n\n# 查看数据\nhead(data)\n\n  score   class\n1    60    math\n2    62    math\n3    70 chinese\n4    73 chinese\n5    80 english\n6    85 english",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Barplot (errorbar2)"
    ]
  },
  {
    "objectID": "Hiplot/006-barplot-errorbar2.html#可视化",
    "href": "Hiplot/006-barplot-errorbar2.html#可视化",
    "title": "误差线柱状图2",
    "section": "可视化",
    "text": "可视化\n\n# 误差线柱状图2\np &lt;- plot_scatterbar_sd(\n  data, ycol = get(colnames(data)[1]), xcol = get(colnames(data)[2]),\n  b_alpha = 1, ewid = 0.2, jitter = 0.1) +\n  stat_compare_means(data = data, aes(data[, 2], data[, 1], fill = data[, 2]),\n                     label = \"p.format\", ref.group = \".all.\", vjust = -2, \n                     method = \"t.test\") +\n  guides(fill=guide_legend(title=colnames(data)[2])) +\n  scale_y_continuous(expand = expansion(mult = c(0, 0.2))) +\n  labs(x=\"class\", y=\"score\") +\n  scale_fill_manual(values = c(\"#E64B35FF\",\"#4DBBD5FF\",\"#00A087FF\",\"#3C5488FF\")) +\n  theme_classic2() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 1: 误差线柱状图2",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Barplot (errorbar2)"
    ]
  },
  {
    "objectID": "Hiplot/047-dual-y-axis.html",
    "href": "Hiplot/047-dual-y-axis.html",
    "title": "双Y轴图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Dual Y Axis Chart 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/dual-y-axis?lang=zh_cn\n双Y轴图可以将两组数量级较大的数据放在同一个图中进行展示。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Dual Y Axis Chart"
    ]
  },
  {
    "objectID": "Hiplot/047-dual-y-axis.html#环境配置",
    "href": "Hiplot/047-dual-y-axis.html#环境配置",
    "title": "双Y轴图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Dual Y Axis Chart"
    ]
  },
  {
    "objectID": "Hiplot/047-dual-y-axis.html#数据准备",
    "href": "Hiplot/047-dual-y-axis.html#数据准备",
    "title": "双Y轴图",
    "section": "数据准备",
    "text": "数据准备\n载入数据为分为三列，第一列是x轴的数值，第二列为左侧Y轴的数值，第三列为右侧Y轴的数值。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/dual-y-axis/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 查看数据\nhead(data)\n\n  x     data1     data2\n1 1 0.6105444 1000.5383\n2 2 0.9961953  981.0398\n3 3 0.6314076  961.0601\n4 4 0.8651855  941.2540\n5 5 0.8169382  922.3971\n6 6 0.1877025  903.3067",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Dual Y Axis Chart"
    ]
  },
  {
    "objectID": "Hiplot/047-dual-y-axis.html#可视化",
    "href": "Hiplot/047-dual-y-axis.html#可视化",
    "title": "双Y轴图",
    "section": "可视化",
    "text": "可视化\n\n# 双Y轴图\np &lt;- ggplot(data, aes(x = x)) +\n  geom_line(aes(y = data[, 2]), size = 1, color = \"#D72C15\") +\n  geom_line(aes(y = data[, 3] / as.numeric(10)), size = 1, color = \"#02657B\") +\n  scale_y_continuous(\n    name = colnames(data)[2],\n    sec.axis = sec_axis(~ . * as.numeric(10), name = colnames(data)[3])) +\n  ggtitle(\"Dual Y Axis Chart\") + xlab(\"x\") +\n  theme_bw() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 1: 双Y轴图\n\n\n\n\n\n案例数据中左侧Y轴比例尺量级在0-100的范围，而右侧Y轴比例尺则在0-1000。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Dual Y Axis Chart"
    ]
  },
  {
    "objectID": "Hiplot/071-ggpiestats.html",
    "href": "Hiplot/071-ggpiestats.html",
    "title": "饼状图（ggpiestats）",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Piestats 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/ggpiestats?lang=zh_cn",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Piestats"
    ]
  },
  {
    "objectID": "Hiplot/071-ggpiestats.html#环境配置",
    "href": "Hiplot/071-ggpiestats.html#环境配置",
    "title": "饼状图（ggpiestats）",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggstatsplot; ggplot2\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggstatsplot\", quietly = TRUE)) {\n  install.packages(\"ggstatsplot\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggstatsplot)\nlibrary(ggplot2)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package     * version date (UTC) lib source\n data.table  * 1.17.8  2025-07-10 [1] RSPM\n ggplot2     * 4.0.1   2025-11-14 [1] RSPM\n ggstatsplot * 0.13.4  2025-12-09 [1] RSPM\n jsonlite    * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Piestats"
    ]
  },
  {
    "objectID": "Hiplot/071-ggpiestats.html#数据准备",
    "href": "Hiplot/071-ggpiestats.html#数据准备",
    "title": "饼状图（ggpiestats）",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/ggpiestats/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\naxis &lt;- c(\"am\", \"cyl\")\ndata[, axis[1]] &lt;- factor(data[, axis[1]], levels = unique(data[, axis[1]]))\ndata[, axis[2]] &lt;- factor(data[, axis[2]], levels = unique(data[, axis[2]]))\n\n# 查看数据\nhead(data)\n\n   mpg cyl disp  hp drat    wt  qsec vs am gear carb\n1 21.0   6  160 110 3.90 2.620 16.46  0  1    4    4\n2 21.0   6  160 110 3.90 2.875 17.02  0  1    4    4\n3 22.8   4  108  93 3.85 2.320 18.61  1  1    4    1\n4 21.4   6  258 110 3.08 3.215 19.44  1  0    3    1\n5 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2\n6 18.1   6  225 105 2.76 3.460 20.22  1  0    3    1",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Piestats"
    ]
  },
  {
    "objectID": "Hiplot/071-ggpiestats.html#可视化",
    "href": "Hiplot/071-ggpiestats.html#可视化",
    "title": "饼状图（ggpiestats）",
    "section": "可视化",
    "text": "可视化\n\n# 饼状图\np &lt;- ggpiestats(data = data, x = am, y = cyl,\n                paired = F) +\n  scale_fill_manual(values = c(\"#3B4992FF\",\"#EE0000FF\"))\n\np\n\n\n\n\n\n\n\n图 1: 饼状图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Piestats"
    ]
  },
  {
    "objectID": "Hiplot/027-contour-matrix.html",
    "href": "Hiplot/027-contour-matrix.html",
    "title": "等高线图 (矩阵)",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Contour (Matrix) 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/contour-matrix?lang=zh_cn\n等高图（矩阵）是一种以二维形式展示三维数据的图形。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Contour (Matrix)"
    ]
  },
  {
    "objectID": "Hiplot/027-contour-matrix.html#环境配置",
    "href": "Hiplot/027-contour-matrix.html#环境配置",
    "title": "等高线图 (矩阵)",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2; reshape2; ggisoband; cowplot\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"reshape2\", quietly = TRUE)) {\n  install.packages(\"reshape2\")\n}\nif (!requireNamespace(\"ggisoband\", quietly = TRUE)) {\n  remotes::install_github(\"clauswilke/ggisoband\")\n}\nif (!requireNamespace(\"cowplot\", quietly = TRUE)) {\n  install.packages(\"cowplot\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(reshape2)\nlibrary(ggisoband)\nlibrary(cowplot)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version    date (UTC) lib source\n cowplot    * 1.2.0      2025-07-07 [1] RSPM\n data.table * 1.17.8     2025-07-10 [1] RSPM\n ggisoband  * 0.0.0.9000 2025-11-02 [1] Github (clauswilke/ggisoband@eef779f)\n ggplot2    * 4.0.1      2025-11-14 [1] RSPM\n jsonlite   * 2.0.0      2025-03-27 [1] RSPM\n reshape2   * 1.4.5      2025-11-12 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Contour (Matrix)"
    ]
  },
  {
    "objectID": "Hiplot/027-contour-matrix.html#数据准备",
    "href": "Hiplot/027-contour-matrix.html#数据准备",
    "title": "等高线图 (矩阵)",
    "section": "数据准备",
    "text": "数据准备\n载入数据为一个矩阵。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/contour-matrix/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndata &lt;- as.matrix(data)\ncolnames(data) &lt;- NULL\ndata3d &lt;- reshape2::melt(data)\nnames(data3d) &lt;- c(\"x\", \"y\", \"z\")\n\n# 查看数据\nhead(data3d)\n\n  x y   z\n1 1 1 100\n2 2 1 101\n3 3 1 102\n4 4 1 103\n5 5 1 104\n6 6 1 105",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Contour (Matrix)"
    ]
  },
  {
    "objectID": "Hiplot/027-contour-matrix.html#可视化",
    "href": "Hiplot/027-contour-matrix.html#可视化",
    "title": "等高线图 (矩阵)",
    "section": "可视化",
    "text": "可视化\n\n# 等高线图 (矩阵)\ncomplex_general_theme &lt;- \n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np1 &lt;- ggplot(data3d, aes(x, y, z = z)) +\n  geom_isobands(\n    alpha = 1,\n    aes(color = stat(zmin)), fill = NA\n  ) +\n  scale_color_viridis_c() +\n  coord_cartesian(expand = FALSE) +\n  theme_bw() +\n  complex_general_theme\n\np2 &lt;- ggplot(data3d, aes(x, y, z = z)) +\n  geom_isobands(\n    alpha = 1,\n    aes(fill = stat(zmin)), color = NA\n  ) +\n  scale_fill_viridis_c(guide = \"legend\") +\n  coord_cartesian(expand = FALSE) +\n  theme_bw() +\n  complex_general_theme\n\nplot_grid(p1, p2, labels = c(\"A\", \"B\"), label_size = 12)\n\n\n\n\n\n\n\n等高线图 (矩阵)\n\n黄色代表最高，深紫色代表最低，高度刻度范围是90-190。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Contour (Matrix)"
    ]
  },
  {
    "objectID": "Hiplot/167-stacked-percentage-bar-chart.html",
    "href": "Hiplot/167-stacked-percentage-bar-chart.html",
    "title": "百分比堆叠条形图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Percentsge Stacked Bar Chart 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/stacked-percentage-bar-chart?lang=zh_cn",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Percentsge Stacked Bar Chart"
    ]
  },
  {
    "objectID": "Hiplot/167-stacked-percentage-bar-chart.html#环境配置",
    "href": "Hiplot/167-stacked-percentage-bar-chart.html#环境配置",
    "title": "百分比堆叠条形图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2; dplyr; tidyr; scales\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"tidyr\", quietly = TRUE)) {\n  install.packages(\"tidyr\")\n}\nif (!requireNamespace(\"scales\", quietly = TRUE)) {\n  install.packages(\"scales\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(scales)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n dplyr      * 1.1.4   2023-11-17 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n scales     * 1.4.0   2025-04-24 [1] RSPM\n tidyr      * 1.3.2   2025-12-19 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Percentsge Stacked Bar Chart"
    ]
  },
  {
    "objectID": "Hiplot/167-stacked-percentage-bar-chart.html#数据准备",
    "href": "Hiplot/167-stacked-percentage-bar-chart.html#数据准备",
    "title": "百分比堆叠条形图",
    "section": "数据准备",
    "text": "数据准备\n案例数据为某商场中三种商品在一星期内的销量，销量数据会被自动计算为百分比的形式进行绘图。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/stacked-percentage-bar-chart/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndata$total &lt;- rowSums(data[, -1])\ndata_long &lt;- gather(data, kinds, value, -days, -total)\ndata_long &lt;- data_long %&gt;%\n  group_by(days) %&gt;%\n  mutate(percent = value / total * 100)\ndata_long[[\"days\"]] &lt;- factor(data_long[[\"days\"]], levels = data[[\"days\"]])\n\n# 查看数据\nhead(data)\n\n       days goods1 goods2 goods3 total\n1    Monday    150    300      0   450\n2   Tuesday    200    250      0   450\n3 Wednesday    300    100      0   400\n4  Thursday    200    300      0   500\n5    Friday    100    300      0   400\n6  Saturday     50     50    400   500",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Percentsge Stacked Bar Chart"
    ]
  },
  {
    "objectID": "Hiplot/167-stacked-percentage-bar-chart.html#可视化",
    "href": "Hiplot/167-stacked-percentage-bar-chart.html#可视化",
    "title": "百分比堆叠条形图",
    "section": "可视化",
    "text": "可视化\n\n# 百分比堆叠条形图\np &lt;- ggplot(data_long, aes(x = percent, y = days, fill = kinds)) +\n  geom_bar(stat = \"identity\", position = \"stack\") +\n  geom_text(aes(label = ifelse(percent != 0, paste0(round(percent), \"%\"), \"\")),\n            position = position_stack(vjust = 0.5)) +\n  labs(title = \"Percentage Stacked Bar Chart\", x = \"Percentage\", y = \"Days\") +\n  scale_x_continuous(labels = percent_format(scale = 1)) +\n  theme_bw() +\n  theme(plot.title = element_text(hjust = 0.5)) +\n  scale_fill_manual(values = c(\"#E64B35FF\",\"#4DBBD5FF\",\"#00A087FF\"))\n\np\n\n\n\n\n\n\n\n图 1: 百分比堆叠条形图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Percentsge Stacked Bar Chart"
    ]
  },
  {
    "objectID": "Hiplot/094-line-regression.html",
    "href": "Hiplot/094-line-regression.html",
    "title": "线性回归",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Line Regression 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/line-regression?lang=zh_cn\n线性回归是一种对自变量和因变量之间关系进行线性建模的回归方法。只有一个自变量的情况称为简单回归,大于一个自变量情况的叫做多元回归。",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Line Regression"
    ]
  },
  {
    "objectID": "Hiplot/094-line-regression.html#环境配置",
    "href": "Hiplot/094-line-regression.html#环境配置",
    "title": "线性回归",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggrepel; ggplot2\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggrepel\", quietly = TRUE)) {\n  install.packages(\"ggrepel\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggrepel)\nlibrary(ggplot2)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n ggrepel    * 0.9.6   2024-09-07 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Line Regression"
    ]
  },
  {
    "objectID": "Hiplot/094-line-regression.html#数据准备",
    "href": "Hiplot/094-line-regression.html#数据准备",
    "title": "线性回归",
    "section": "数据准备",
    "text": "数据准备\n载入数据为自变量，因变量和分组。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/line-regression/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndata$group &lt;- factor(data$group, levels = unique(data$group))\n\n# 查看数据\nhead(data)\n\n  value1 value2 group\n1   36.8  29.44    G1\n2   54.0  43.20    G1\n3   26.0  26.00    G1\n4   39.0  31.20    G1\n5   33.0  29.70    G1\n6   29.0  34.80    G1",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Line Regression"
    ]
  },
  {
    "objectID": "Hiplot/094-line-regression.html#可视化",
    "href": "Hiplot/094-line-regression.html#可视化",
    "title": "线性回归",
    "section": "可视化",
    "text": "可视化\n\n# 线性回归\n## 定义方程\nequation &lt;- function(x, add_p = FALSE) {\n  xs &lt;- summary(x)\n  lm_coef &lt;- list(\n    a = as.numeric(round(coef(x)[1], digits = 2)),\n    b = as.numeric(round(coef(x)[2], digits = 2)),\n    r2 = round(xs$r.squared, digits = 2),\n    pval = xs$coef[2, 4] \n  )\n  if (add_p) {\n    lm_eq &lt;- substitute(italic(y) == a + b %.% italic(x) * \",\" ~ ~\n  italic(R)^2 ~ \"=\" ~ r2 * \",\" ~ ~ italic(p) ~ \"=\" ~ pval, lm_coef)\n  } else {\n    lm_eq &lt;- substitute(italic(y) == a + b %.% italic(x) * \",\" ~ ~\n  italic(R)^2 ~ \"=\" ~ r2, lm_coef)\n  }\n  as.expression(lm_eq)\n}\n## 绘图\np &lt;- ggplot(data, aes(x = value1, y = value2, colour = group)) +\n  geom_point(show.legend = TRUE) +\n  geom_smooth(method = \"lm\", se = T, show.legend = F) +\n  geom_rug(sides = \"bl\", size = 1, show.legend = F) +\n  scale_color_manual(values = c(\"#00468BFF\",\"#ED0000FF\")) +\n  ggtitle(\"Line Reguression Plot\") +\n  theme_bw() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12, hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n  \n## 使用 ggrepel 为每个组添加注释\nrepels &lt;- rep(\"\", nrow(data))\nfor (g in unique(data$group)) {\n  fit &lt;- lm(value2 ~ value1, data = data[data$group == g, ])\n  v &lt;- max(data[data$group == g, \"value2\"])\n  repels[which(data$value2 == v)[1]] &lt;- equation(fit, add_p = F)\n}\np &lt;- p + geom_text_repel(\n  data = data,\n  label = repels,\n  size = 4,\n  force = 5,\n  label.padding = 5,\n  na.rm = TRUE,\n  min.segment.length = 100,\n  show.legend = FALSE,\n  nudge_x = 0,\n  nudge_y = 0\n  )\n\np\n\n\n\n\n\n\n\n图 1: 线性回归\n\n\n\n不同颜色表示不同分组，可添加线性回归方程，R的平方越接近 1，说明拟合的曲线和实际曲线越趋近。灰色条带代表 95% 置信区间。",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Line Regression"
    ]
  },
  {
    "objectID": "Hiplot/117-map-world2.html",
    "href": "Hiplot/117-map-world2.html",
    "title": "世界地图 2",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot World Map 2 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/map-world2?lang=zh_cn",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "World Map 2"
    ]
  },
  {
    "objectID": "Hiplot/117-map-world2.html#环境配置",
    "href": "Hiplot/117-map-world2.html#环境配置",
    "title": "世界地图 2",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2; RColorBrewer\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(RColorBrewer)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package      * version date (UTC) lib source\n data.table   * 1.17.8  2025-07-10 [1] RSPM\n ggplot2      * 4.0.1   2025-11-14 [1] RSPM\n jsonlite     * 2.0.0   2025-03-27 [1] RSPM\n RColorBrewer * 1.1-3   2022-04-03 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "World Map 2"
    ]
  },
  {
    "objectID": "Hiplot/117-map-world2.html#数据准备",
    "href": "Hiplot/117-map-world2.html#数据准备",
    "title": "世界地图 2",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/map-world2/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\ndt_map &lt;- readRDS(url(\"https://download.hiplot.cn/ui/basic/map-world/world.rds\"))\n\n# 整理数据格式\ndt_map$Value &lt;- data$death_rate[match(dt_map$ENG_NAME, data$region)]\n\n# 查看数据\nhead(data)\n\n          region death_rate\n1    Afghanistan       13.4\n2        Albania        6.8\n3        Algeria        4.3\n4 American Samoa        5.9\n5        Andorra        7.3\n6         Angola        9.2",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "World Map 2"
    ]
  },
  {
    "objectID": "Hiplot/117-map-world2.html#可视化",
    "href": "Hiplot/117-map-world2.html#可视化",
    "title": "世界地图 2",
    "section": "可视化",
    "text": "可视化\n\n# 世界地图 2\np &lt;- ggplot(dt_map) +\n  geom_polygon(aes(x = long, y = lat, group = group, fill = Value),\n               alpha = 0.9, size = 0.5) +\n  geom_path(aes(x = long, y = lat, group = group), color = \"black\", size = 0.2) +\n  coord_fixed() +\n  scale_fill_gradientn(\n    colours = colorRampPalette(rev(brewer.pal(11,\"RdYlBu\")))(500),\n    breaks = seq(round(min(dt_map$Value)), round(max(dt_map$Value)), \n                 round((max(dt_map$Value)-min(dt_map$Value))/7)),\n    name = \"Color Key\",\n    guide = guide_legend(\n      direction = \"vertical\", keyheight = unit(1, units = \"mm\"),\n      keywidth = unit(8, units = \"mm\"),\n      title.position = \"top\", title.hjust = 0.5, label.hjust = 0.5,\n      nrow = 1, byrow = T, reverse = F, label.position = \"bottom\")) +\n  theme(text = element_text(color = \"#3A3F4A\"),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank(),\n        legend.position = \"top\",\n        legend.text = element_text(size = 4 * 1.5, color = \"black\"),\n        legend.title = element_text(size = 5 * 1.5, color = \"black\"),\n        plot.title = element_text(\n          face = \"bold\", size = 5 * 1.5, hjust = 0.5, \n          margin = margin(t = 4, b = 5), color = \"black\"),\n        plot.background = element_rect(fill = \"#FFFFFF\", color = \"#FFFFFF\"),\n        panel.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        legend.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        plot.margin = unit(c(1.5, 1.5, 1.5, 1.5), \"cm\")) +\n  labs(x = NULL, y = NULL, title = \"World Map\")\n\np\n\n\n\n\n\n\n\n图 1: 世界地图 2",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "World Map 2"
    ]
  },
  {
    "objectID": "Hiplot/046-dotchart.html",
    "href": "Hiplot/046-dotchart.html",
    "title": "滑珠图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Dotchart 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/dotchart?lang=zh_cn\n滑珠图是一种珠子在柱上滑行的图形，是条形图与散点图的叠加。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Dotchart"
    ]
  },
  {
    "objectID": "Hiplot/046-dotchart.html#环境配置",
    "href": "Hiplot/046-dotchart.html#环境配置",
    "title": "滑珠图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggpubr\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggpubr\", quietly = TRUE)) {\n  install.packages(\"ggpubr\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggpubr)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n ggpubr     * 0.6.2   2025-10-17 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Dotchart"
    ]
  },
  {
    "objectID": "Hiplot/046-dotchart.html#数据准备",
    "href": "Hiplot/046-dotchart.html#数据准备",
    "title": "滑珠图",
    "section": "数据准备",
    "text": "数据准备\n载入数据为基因名称及其对应的基因表达值和分组。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/dotchart/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 查看数据\nhead(data)\n\n      Name Value  Group\n1     BMP2  18.7 Group1\n2     XIST  14.3 Group1\n3 C19orf38  16.4 Group1\n4    PDZD3  17.3 Group1\n5   MAPRE2  15.2 Group1\n6     IRF4  10.4 Group1",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Dotchart"
    ]
  },
  {
    "objectID": "Hiplot/046-dotchart.html#可视化",
    "href": "Hiplot/046-dotchart.html#可视化",
    "title": "滑珠图",
    "section": "可视化",
    "text": "可视化\n\n# 滑珠图\np &lt;- ggdotchart(data, x = \"Name\", y = \"Value\", group = \"Group\", color = \"Group\",\n                rotate = T, sorting = \"descending\",\n                y.text.col = F, add = \"segments\", dot.size = 2) +\n  xlab(\"Name\") +\n  ylab(\"Value\") +\n  ggtitle(\"DotChart Plot\") +\n  scale_color_manual(values = c(\"#e04d39\",\"#5bbad6\",\"#1e9f86\")) +\n  theme_classic() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 1: 滑珠图\n\n\n\n\n\n每种颜色表示不同的分组，能够直观了解不同基因表达值的差异。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Dotchart"
    ]
  },
  {
    "objectID": "Hiplot/096-map-africa.html",
    "href": "Hiplot/096-map-africa.html",
    "title": "非洲地图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Africa Map 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/map-africa?lang=zh_cn",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Africa Map"
    ]
  },
  {
    "objectID": "Hiplot/096-map-africa.html#环境配置",
    "href": "Hiplot/096-map-africa.html#环境配置",
    "title": "非洲地图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2; RColorBrewer\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(RColorBrewer)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package      * version date (UTC) lib source\n data.table   * 1.17.8  2025-07-10 [1] RSPM\n ggplot2      * 4.0.1   2025-11-14 [1] RSPM\n jsonlite     * 2.0.0   2025-03-27 [1] RSPM\n RColorBrewer * 1.1-3   2022-04-03 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Africa Map"
    ]
  },
  {
    "objectID": "Hiplot/096-map-africa.html#数据准备",
    "href": "Hiplot/096-map-africa.html#数据准备",
    "title": "非洲地图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/map-africa/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\ndt_map &lt;- readRDS(url(\"https://download.hiplot.cn/ui/basic/map-africa/afr.rds\"))\n\n# 整理数据格式\ndt_map$Value &lt;- data$value[match(dt_map$ADM0_NAME, data$region)]\n\n# 查看数据\nhead(data)\n\n        region value\n1        Sudan   258\n2       Angola   911\n3        Benin   318\n4     Botswana   759\n5 Burkina Faso   983\n6     Cameroon   618",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Africa Map"
    ]
  },
  {
    "objectID": "Hiplot/096-map-africa.html#可视化",
    "href": "Hiplot/096-map-africa.html#可视化",
    "title": "非洲地图",
    "section": "可视化",
    "text": "可视化\n\n# 非洲地图\np &lt;- ggplot(dt_map) +\n  geom_polygon(aes(x = long, y = lat, group = group, fill = Value),\n               alpha = 0.9, size = 0.5) +\n  geom_path(aes(x = long, y = lat, group = group), color = \"black\", size = 0.2) +\n  coord_fixed() +\n  scale_fill_gradientn(\n    colours = colorRampPalette(rev(brewer.pal(11,\"RdYlBu\")))(500),\n    breaks = seq(9, 985, 139),\n    name = \"Color Key\",\n    guide = guide_legend(\n      direction = \"vertical\", keyheight = unit(1, units = \"mm\"),\n      keywidth = unit(8, units = \"mm\"),\n      title.position = \"top\", title.hjust = 0.5, label.hjust = 0.5,\n      nrow = 1, byrow = T, reverse = F, label.position = \"bottom\")) +\n  theme(text = element_text(color = \"#3A3F4A\"),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank(),\n        legend.position = \"top\",\n        legend.text = element_text(size = 4 * 1.5, color = \"black\"),\n        legend.title = element_text(size = 5 * 1.5, color = \"black\"),\n        plot.title = element_text(\n          face = \"bold\", size = 5 * 1.5, hjust = 0.5, \n          margin = margin(t = 4, b = 5), color = \"black\"),\n        plot.background = element_rect(fill = \"#FFFFFF\", color = \"#FFFFFF\"),\n        panel.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        legend.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        plot.margin = unit(c(1.5, 1.5, 1.5, 1.5), \"cm\")) +\n  labs(x = NULL, y = NULL, title = \"Africa Map\")\n\np\n\n\n\n\n\n\n\n图 1: 非洲地图",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Africa Map"
    ]
  },
  {
    "objectID": "Hiplot/063-ggbarstats.html",
    "href": "Hiplot/063-ggbarstats.html",
    "title": "堆叠条形图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Barstats 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/ggbarstats?lang=zh_cn",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Barstats"
    ]
  },
  {
    "objectID": "Hiplot/063-ggbarstats.html#环境配置",
    "href": "Hiplot/063-ggbarstats.html#环境配置",
    "title": "堆叠条形图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggstatsplot; ggplot2; cowplot\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggstatsplot\", quietly = TRUE)) {\n  install.packages(\"ggstatsplot\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"cowplot\", quietly = TRUE)) {\n  install.packages(\"cowplot\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggstatsplot)\nlibrary(ggplot2)\nlibrary(cowplot)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package     * version date (UTC) lib source\n cowplot     * 1.2.0   2025-07-07 [1] RSPM\n data.table  * 1.17.8  2025-07-10 [1] RSPM\n ggplot2     * 4.0.1   2025-11-14 [1] RSPM\n ggstatsplot * 0.13.4  2025-12-09 [1] RSPM\n jsonlite    * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Barstats"
    ]
  },
  {
    "objectID": "Hiplot/063-ggbarstats.html#数据准备",
    "href": "Hiplot/063-ggbarstats.html#数据准备",
    "title": "堆叠条形图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/ggbarstats/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\naxis &lt;- c(\"relig\", \"partyid\", \"race\")\ndata[, axis[1]] &lt;- factor(data[, axis[1]], levels = rev(unique(data[, axis[1]])))\ndata[, axis[2]] &lt;- factor(data[, axis[2]], levels = unique(data[, axis[2]]))\ndata[, axis[3]] &lt;- factor(data[, axis[3]], levels = unique(data[, axis[3]]))\n\n# 查看数据\nhead(data)\n\n  year       marital age  race        rincome            partyid      relig\n1 2000 Never married  26 White  $8000 to 9999       Ind,near rep Protestant\n2 2000      Divorced  48 White  $8000 to 9999 Not str republican Protestant\n3 2000       Widowed  67 White Not applicable        Independent Protestant\n4 2000      Divorced  25 White Not applicable   Not str democrat       None\n5 2000       Married  25 White $20000 - 24999    Strong democrat Protestant\n6 2000      Divorced  44 White  $7000 to 7999       Ind,near dem Protestant\n              denom tvhours\n1  Southern baptist      12\n2  Baptist-dk which      NA\n3   No denomination       2\n4    Not applicable       1\n5  Southern baptist      NA\n6 Lutheran-mo synod      NA",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Barstats"
    ]
  },
  {
    "objectID": "Hiplot/063-ggbarstats.html#可视化",
    "href": "Hiplot/063-ggbarstats.html#可视化",
    "title": "堆叠条形图",
    "section": "可视化",
    "text": "可视化\n\n# 堆叠条形图\ng &lt;- unique(data[,axis[3]])\nplist &lt;- list()\nfor (i in 1:length(g)) {\n  fil &lt;- data[,axis[3]] == g[i]\n  plist[[i]] &lt;- ggbarstats(\n    data = data[fil,], x = relig, y = partyid,\n    plotgrid.args = list(ncol = 1), paired = F, k = 2) +\n    scale_fill_manual(values = c(\"#00468BFF\",\"#ED0000FF\",\"#42B540FF\"))\n}\np &lt;- plot_grid(plotlist = plist, ncol = 1)\n\np\n\n\n\n\n\n\n\n图 1: 堆叠条形图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Barstats"
    ]
  },
  {
    "objectID": "Hiplot/147-pyramid-stack2.html",
    "href": "Hiplot/147-pyramid-stack2.html",
    "title": "金字塔堆叠图2",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Pyramid Stack2 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/pyramid-stack2?lang=zh_cn\n金字塔堆叠图可以用于展示年龄组多变量。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pyramid Stack2"
    ]
  },
  {
    "objectID": "Hiplot/147-pyramid-stack2.html#环境配置",
    "href": "Hiplot/147-pyramid-stack2.html#环境配置",
    "title": "金字塔堆叠图2",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; plotrix; ggplotify\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"plotrix\", quietly = TRUE)) {\n  install.packages(\"plotrix\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(plotrix)\nlibrary(ggplotify)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplotify  * 0.1.3   2025-09-20 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n plotrix    * 3.8-13  2025-11-15 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pyramid Stack2"
    ]
  },
  {
    "objectID": "Hiplot/147-pyramid-stack2.html#数据准备",
    "href": "Hiplot/147-pyramid-stack2.html#数据准备",
    "title": "金字塔堆叠图2",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/pyramid-stack2/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\nagegrps &lt;- unique(data[,1])\nsplit_var &lt;- unique(data[,2])\ndat_left &lt;- as.matrix(data[data[,2] == split_var[1],-c(1,2)])\ndat_right &lt;- as.matrix(data[data[,2] == split_var[2],-c(1,2)])\n\n# 查看数据\nhead(data)\n\n  Month Year Class1 Class2 Class3 Class4\n1     1 2019      8    6.0      8    6.0\n2     2 2019      4    2.0      4    2.0\n3     3 2019      4    4.5      1    4.5\n4     4 2019      6    8.0      1    9.0\n5     5 2019      8    6.0      8    6.0\n6     6 2019      4    2.0      4    2.0",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pyramid Stack2"
    ]
  },
  {
    "objectID": "Hiplot/147-pyramid-stack2.html#可视化",
    "href": "Hiplot/147-pyramid-stack2.html#可视化",
    "title": "金字塔堆叠图2",
    "section": "可视化",
    "text": "可视化\n\n# 金字塔堆叠图2\np &lt;- as.ggplot(function() {\n  cols &lt;- c(\"#E64B35FF\",\"#4DBBD5FF\",\"#00A087FF\",\"#3C5488FF\")\n  names(cols) &lt;- colnames(dat_left)\n  cols &lt;- cols[1:ncol(dat_left)]\n  pyramid.plot(dat_left, dat_right, labels = agegrps, unit = \"Value\",\n               lxcol = cols, rxcol = cols,\n               laxlab=as.numeric(c(0,10,20,30)), raxlab=as.numeric(c(0,10,20,30)),\n               top.labels=c(split_var[1], colnames(data)[1], split_var[2]),\n               gap=4, ppmar=c(4,2,4,7), do.first=\"plot_bg(\\\"#FFFFFF\\\")\")\n  mtext(\"Porridge temperature by age and sex of bear\", 3, 2, cex=1)\n  legend(\"right\", inset=c(-0.25,0), legend = colnames(dat_left), fill = cols)\n  })\n\n32 32 \n\np\n\n\n\n\n\n\n\n图 1: 金字塔堆叠图2",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pyramid Stack2"
    ]
  },
  {
    "objectID": "Hiplot/135-pca2.html",
    "href": "Hiplot/135-pca2.html",
    "title": "主成分分析2",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot PCA2 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/pca2?lang=zh_cn\n主成分分析是以“降维”为核心，用较少的几个综合指标（主成分）代替多指标的数据，还原数据最本质特征的数据处理方式。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "PCA2"
    ]
  },
  {
    "objectID": "Hiplot/135-pca2.html#环境配置",
    "href": "Hiplot/135-pca2.html#环境配置",
    "title": "主成分分析2",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; FactoMineR; factoextra\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"FactoMineR\", quietly = TRUE)) {\n  install.packages(\"FactoMineR\")\n}\nif (!requireNamespace(\"factoextra\", quietly = TRUE)) {\n  install.packages(\"factoextra\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(FactoMineR)\nlibrary(factoextra)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n factoextra * 1.0.7   2020-04-01 [1] RSPM\n FactoMineR * 2.12    2025-07-23 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "PCA2"
    ]
  },
  {
    "objectID": "Hiplot/135-pca2.html#数据准备",
    "href": "Hiplot/135-pca2.html#数据准备",
    "title": "主成分分析2",
    "section": "数据准备",
    "text": "数据准备\n载入数据为数据集（基因名称及其对应的基因表达值）和样本信息（样本名称及分组）。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/pca2/data.json\")$exampleData[[1]]$textarea[[1]])\ndata &lt;- as.data.frame(data)\nsample_info &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/pca2/data.json\")$exampleData[[1]]$textarea[[2]])\nsample_info &lt;- as.data.frame(sample_info)\n\n# 整理数据格式\nrow.names(sample_info) &lt;- sample_info[,1]\nsample_info &lt;- sample_info[colnames(data)[-1],]\n## tsne\nrownames(data) &lt;- data[, 1]\ndata &lt;- as.matrix(data[, -1])\npca_data &lt;- PCA(t(as.matrix(data)), scale.unit = TRUE, ncp = 5, graph = FALSE)\n\n# 查看数据\nhead(data[,1:5])\n\n              M1       M2        M3       M4       M5\nGBP4    6.599344 5.226266  3.693288 3.938501 4.527193\nBCAT1   5.760380 4.892783  5.448924 3.485413 3.855669\nCMPK2   9.561905 4.549168  3.998655 5.614384 3.904793\nSTOX2   8.396409 8.717055  8.039064 7.643060 9.274649\nPADI2   8.419766 8.268430  8.451181 9.200732 8.598207\nSCARNA5 7.653074 5.780393 10.633550 5.913684 8.805605",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "PCA2"
    ]
  },
  {
    "objectID": "Hiplot/135-pca2.html#可视化",
    "href": "Hiplot/135-pca2.html#可视化",
    "title": "主成分分析2",
    "section": "可视化",
    "text": "可视化\n\n# 主成分分析2\np &lt;- fviz_pca_ind(pca_data, geom.ind = \"point\", pointsize = 6, addEllipses = TRUE,\n                  mean.point = F, col.ind = sample_info[,\"Group\"]) +\n  ggtitle(\"Principal Component Analysis\") +\n  scale_fill_manual(values = c(\"#00468BFF\",\"#ED0000FF\")) +\n  scale_color_manual(values = c(\"#00468BFF\",\"#ED0000FF\")) +\n  theme_bw() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 1: 主成分分析2\n\n\n\n\n\n不同颜色表示不同样本，可解读主成分与原变量的关系，如：M1 对 PC1 具有较大的贡献，而 M8 与 PC1 呈较大的负相关性。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "PCA2"
    ]
  },
  {
    "objectID": "Hiplot/097-map-americas.html",
    "href": "Hiplot/097-map-americas.html",
    "title": "美洲地图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Americas Map 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/map-americas?lang=zh_cn",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Americas Map"
    ]
  },
  {
    "objectID": "Hiplot/097-map-americas.html#环境配置",
    "href": "Hiplot/097-map-americas.html#环境配置",
    "title": "美洲地图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2; RColorBrewer\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(RColorBrewer)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package      * version date (UTC) lib source\n data.table   * 1.17.8  2025-07-10 [1] RSPM\n ggplot2      * 4.0.1   2025-11-14 [1] RSPM\n jsonlite     * 2.0.0   2025-03-27 [1] RSPM\n RColorBrewer * 1.1-3   2022-04-03 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Americas Map"
    ]
  },
  {
    "objectID": "Hiplot/097-map-americas.html#数据准备",
    "href": "Hiplot/097-map-americas.html#数据准备",
    "title": "美洲地图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/map-americas/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\ndt_map &lt;- readRDS(url(\"https://download.hiplot.cn/ui/basic/map-americas/amr.rds\"))\n\n# 整理数据格式\ndt_map$Value &lt;- data$value[match(dt_map$ENG_NAME, data$region)]\n\n# 查看数据\nhead(data)\n\n               region value\n1 Aruba (Netherlands)    48\n2 Antigua and Barbuda   749\n3           Argentina   667\n4       Anguilla (UK)    14\n5            Barbados    83\n6        Bermuda (UK)   109",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Americas Map"
    ]
  },
  {
    "objectID": "Hiplot/097-map-americas.html#可视化",
    "href": "Hiplot/097-map-americas.html#可视化",
    "title": "美洲地图",
    "section": "可视化",
    "text": "可视化\n\n# 美洲地图\np &lt;- ggplot(dt_map) +\n  geom_polygon(aes(x = long, y = lat, group = group, fill = Value),\n               alpha = 0.9, size = 0.5) +\n  geom_path(aes(x = long, y = lat, group = group), color = \"black\", size = 0.2) +\n  coord_fixed() +\n  scale_fill_gradientn(\n    colours = colorRampPalette(rev(brewer.pal(11,\"RdYlBu\")))(500),\n    breaks = seq(min(data$value), max(data$value), \n                 round((max(data$value)-min(data$value))/7)),\n    name = \"Color Key\",\n    guide = guide_legend(\n      direction = \"vertical\", keyheight = unit(1, units = \"mm\"),\n      keywidth = unit(8, units = \"mm\"),\n      title.position = \"top\", title.hjust = 0.5, label.hjust = 0.5,\n      nrow = 1, byrow = T, reverse = F, label.position = \"bottom\")) +\n  theme(text = element_text(color = \"#3A3F4A\"),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank(),\n        legend.position = \"top\",\n        legend.text = element_text(size = 4 * 1.5, color = \"black\"),\n        legend.title = element_text(size = 5 * 1.5, color = \"black\"),\n        plot.title = element_text(\n          face = \"bold\", size = 5 * 1.5, hjust = 0.5, \n          margin = margin(t = 4, b = 5), color = \"black\"),\n        plot.background = element_rect(fill = \"#FFFFFF\", color = \"#FFFFFF\"),\n        panel.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        legend.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        plot.margin = unit(c(1.5, 1.5, 1.5, 1.5), \"cm\")) +\n  labs(x = NULL, y = NULL, title = \"Americas Map\")\n\np\n\n\n\n\n\n\n\n图 1: 美洲地图",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Americas Map"
    ]
  },
  {
    "objectID": "Hiplot/123-mosaic.html",
    "href": "Hiplot/123-mosaic.html",
    "title": "马赛克比例图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Mosaic Ratio Plot 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/mosaic?lang=zh_cn\n使用马赛克方块展示数据比例。",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Mosaic Ratio Plot"
    ]
  },
  {
    "objectID": "Hiplot/123-mosaic.html#环境配置",
    "href": "Hiplot/123-mosaic.html#环境配置",
    "title": "马赛克比例图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; vcd; DescTools; ggplotify\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"vcd\", quietly = TRUE)) {\n  install.packages(\"vcd\")\n}\nif (!requireNamespace(\"DescTools\", quietly = TRUE)) {\n  install.packages(\"DescTools\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(vcd)\nlibrary(DescTools)\nlibrary(ggplotify)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n DescTools  * 0.99.60 2025-03-28 [1] RSPM\n ggplotify  * 0.1.3   2025-09-20 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n vcd        * 1.4-13  2024-09-16 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Mosaic Ratio Plot"
    ]
  },
  {
    "objectID": "Hiplot/123-mosaic.html#数据准备",
    "href": "Hiplot/123-mosaic.html#数据准备",
    "title": "马赛克比例图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/mosaic/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ntbl &lt;- xtabs(~ Survived + PassengerClass + Gender, data)\n\n# 查看数据\nhead(data)\n\n  PassengerId Survived PassengerClass\n1           1        0              3\n2           2        1              1\n3           3        1              3\n4           4        1              1\n5           5        0              3\n6           6        0              3\n                                                 Name Gender Age SibSp Parch\n1                             Braund, Mr. Owen Harris   Male  22     1     0\n2 Cumings, Mrs. John Bradley (Florence Briggs Thayer) Female  38     1     0\n3                              Heikkinen, Miss. Laina Female  26     0     0\n4        Futrelle, Mrs. Jacques Heath (Lily May Peel) Female  35     1     0\n5                            Allen, Mr. William Henry   Male  35     0     0\n6                                    Moran, Mr. James   Male  NA     0     0\n            Ticket    Fare Cabin Embarked\n1        A/5 21171  7.2500  &lt;NA&gt;        S\n2         PC 17599 71.2833   C85        C\n3 STON/O2. 3101282  7.9250  &lt;NA&gt;        S\n4           113803 53.1000  C123        S\n5           373450  8.0500  &lt;NA&gt;        S\n6           330877  8.4583  &lt;NA&gt;        Q",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Mosaic Ratio Plot"
    ]
  },
  {
    "objectID": "Hiplot/123-mosaic.html#可视化",
    "href": "Hiplot/123-mosaic.html#可视化",
    "title": "马赛克比例图",
    "section": "可视化",
    "text": "可视化\n\n# 马赛克比例图\np &lt;- as.ggplot(function() {\n  mosaic(tbl, shade = TRUE, legend = TRUE, main = \"Mosaic Ratio Plot\",\n         gp = shading_binary(tbl, col = c(\"#3B4992FF\",\"#EE0000FF\")))\n})\n\np\n\n\n\n\n\n\n\n图 1: 马赛克比例图",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Mosaic Ratio Plot"
    ]
  },
  {
    "objectID": "Hiplot/069-ggpiestats-group.html",
    "href": "Hiplot/069-ggpiestats-group.html",
    "title": "分组饼状图（ggpiestats）",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Piestats Group 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/ggpiestats-group?lang=zh_cn",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Piestats Group"
    ]
  },
  {
    "objectID": "Hiplot/069-ggpiestats-group.html#环境配置",
    "href": "Hiplot/069-ggpiestats-group.html#环境配置",
    "title": "分组饼状图（ggpiestats）",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggstatsplot; ggplot2; cowplot\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggstatsplot\", quietly = TRUE)) {\n  install.packages(\"ggstatsplot\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"cowplot\", quietly = TRUE)) {\n  install.packages(\"cowplot\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggstatsplot)\nlibrary(ggplot2)\nlibrary(cowplot)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package     * version date (UTC) lib source\n cowplot     * 1.2.0   2025-07-07 [1] RSPM\n data.table  * 1.17.8  2025-07-10 [1] RSPM\n ggplot2     * 4.0.1   2025-11-14 [1] RSPM\n ggstatsplot * 0.13.4  2025-12-09 [1] RSPM\n jsonlite    * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Piestats Group"
    ]
  },
  {
    "objectID": "Hiplot/069-ggpiestats-group.html#数据准备",
    "href": "Hiplot/069-ggpiestats-group.html#数据准备",
    "title": "分组饼状图（ggpiestats）",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/ggpiestats-group/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\naxis &lt;- c(\"genre\", \"mpaa\")\ndata[, axis[1]] &lt;- factor(data[, axis[1]], levels = unique(data[, axis[1]]))\ndata[, axis[2]] &lt;- factor(data[, axis[2]], levels = unique(data[, axis[2]]))\n\n# 查看数据\nhead(data)\n\n                                               title year length budget rating\n1                          Shawshank Redemption, The 1994    142     25    9.1\n2     Lord of the Rings: The Return of the King, The 2003    251     94    9.0\n3 Lord of the Rings: The Fellowship of the Ring, The 2001    208     93    8.8\n4             Lord of the Rings: The Two Towers, The 2002    223     94    8.8\n5                                       Pulp Fiction 1994    168      8    8.8\n6                                   Schindler's List 1993    195     25    8.8\n   votes  mpaa  genre\n1 149494     R  Drama\n2 103631 PG-13 Action\n3 157608 PG-13 Action\n4 114797 PG-13 Action\n5 132745     R  Drama\n6  97667     R  Drama",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Piestats Group"
    ]
  },
  {
    "objectID": "Hiplot/069-ggpiestats-group.html#可视化",
    "href": "Hiplot/069-ggpiestats-group.html#可视化",
    "title": "分组饼状图（ggpiestats）",
    "section": "可视化",
    "text": "可视化\n\n# 分组饼状图\ng &lt;- unique(data[,axis[2]])\nplist &lt;- list()\nfor (i in 1:length(g)) {\n  fil &lt;- data[,axis[2]] == g[i]\n  plist[[i]] &lt;- \n    ggpiestats(\n      data = data[fil,], x = genre, \n      title= paste('', axis[2], g[i], sep = ':'),\n      plotgrid.args = list(ncol = 3),\n      label.repel = TRUE,\n      k = 2\n    ) +\n    scale_fill_manual(values = c(\"#3B4992FF\",\"#EE0000FF\",\"#008B45FF\",\"#631879FF\",\n                                 \"#008280FF\",\"#BB0021FF\",\"#5F559BFF\",\"#A20056FF\",\n                                 \"#808180FF\"))\n}\n\nplot_grid(plotlist = plist, ncol = 3)\n\n\n\n\n\n\n\n图 1: 分组饼状图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Piestats Group"
    ]
  },
  {
    "objectID": "Hiplot/175-tsne.html",
    "href": "Hiplot/175-tsne.html",
    "title": "tSNE",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot tSNE 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/tsne?lang=zh_cn\nt-SNE 是一种非线性降维算法，适用于高维数据降维到 2 维或 3 维并进行可视化。该算法能够使较大相似度的点，t 分布在低维空间中的距离更近；而对于低相似度的点，t 分布在低维空间中的距离更远。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "tSNE"
    ]
  },
  {
    "objectID": "Hiplot/175-tsne.html#环境配置",
    "href": "Hiplot/175-tsne.html#环境配置",
    "title": "tSNE",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; Rtsne; ggpubr\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"Rtsne\", quietly = TRUE)) {\n  install.packages(\"Rtsne\")\n}\nif (!requireNamespace(\"ggpubr\", quietly = TRUE)) {\n  install.packages(\"ggpubr\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(Rtsne)\nlibrary(ggpubr)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n ggpubr     * 0.6.2   2025-10-17 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n Rtsne      * 0.17    2023-12-07 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "tSNE"
    ]
  },
  {
    "objectID": "Hiplot/175-tsne.html#数据准备",
    "href": "Hiplot/175-tsne.html#数据准备",
    "title": "tSNE",
    "section": "数据准备",
    "text": "数据准备\n载入数据为数据集（基因名称及其对应的基因表达值）和样本信息（样本名称及分组）。\n\n# 加载数据\ndata1 &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/tsne/data.json\")$exampleData[[1]]$textarea[[1]])\ndata1 &lt;- as.data.frame(data1)\ndata2 &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/tsne/data.json\")$exampleData[[1]]$textarea[[2]])\ndata2 &lt;- as.data.frame(data2)\n\n# 整理数据格式\nsample.info &lt;- data2\nrownames(data1) &lt;- data1[, 1]\ndata1 &lt;- as.matrix(data1[, -1])\n## tsne\nset.seed(123)\ntsne_info &lt;- Rtsne(t(data1), perplexity = 1, theta = 0.1, check_duplicates = FALSE)\ncolnames(tsne_info$Y) &lt;- c(\"tSNE_1\", \"tSNE_2\")\n# handle data\ntsne_data &lt;- data.frame(\n  sample = colnames(data1),\n  tsne_info$Y\n)\ncolorBy &lt;- sample.info[match(colnames(data1), sample.info[, 1]), \"group\"]\ncolorBy &lt;- factor(colorBy, level = colorBy[!duplicated(colorBy)])\ntsne_data$colorBy = colorBy\nshapeBy &lt;- NULL\n\n# 查看数据\nhead(data1)\n\n              M1       M2        M3       M8       M9      M10\nGBP4    6.599344 5.226266  3.693288 7.658312 8.666038 7.419708\nBCAT1   5.760380 4.892783  5.448924 8.765915 8.097206 8.262942\nCMPK2   9.561905 4.549168  3.998655 7.379591 7.938063 6.154118\nSTOX2   8.396409 8.717055  8.039064 3.542217 4.305187 6.964710\nPADI2   8.419766 8.268430  8.451181 4.136667 4.910986 4.080363\nSCARNA5 7.653074 5.780393 10.633550 3.822596 4.041078 7.956589\n\nhead(data2)\n\n  sample group\n1     M1    G1\n2     M2    G1\n3     M3    G1\n4     M8    G2\n5     M9    G2\n6    M10    G2",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "tSNE"
    ]
  },
  {
    "objectID": "Hiplot/175-tsne.html#可视化",
    "href": "Hiplot/175-tsne.html#可视化",
    "title": "tSNE",
    "section": "可视化",
    "text": "可视化\n\n# tsne\np &lt;- ggscatter(data = tsne_data, x = \"tSNE_1\", y = \"tSNE_2\", size = 2, \n               palette = \"lancet\", color = \"colorBy\") +\n  labs(color = \"group\") +\n  ggtitle(\"tSNE Plot1\") +\n  theme_bw() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 1: tsne\n\n\n\n\n\n不同颜色表示不同样本，与 PCA（主成分分析）图形解释相同，不同之处在于可视化效果，t-SNE 中对于不相似的点，用一个较小的距离会产生较大的梯度来让这些点排斥开来。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "tSNE"
    ]
  },
  {
    "objectID": "Hiplot/018-calibration-curve.html",
    "href": "Hiplot/018-calibration-curve.html",
    "title": "校准曲线",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Calibration Curve 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/calibration-curve?lang=zh_cn\n校准曲线用于评估一致性/校准，即预测值和实际值之间的差异。",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Calibration Curve"
    ]
  },
  {
    "objectID": "Hiplot/018-calibration-curve.html#环境配置",
    "href": "Hiplot/018-calibration-curve.html#环境配置",
    "title": "校准曲线",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; survival; rms; ggplotify\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"survival\", quietly = TRUE)) {\n  install.packages(\"survival\")\n}\nif (!requireNamespace(\"rms\", quietly = TRUE)) {\n  install.packages(\"rms\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(survival)\nlibrary(rms)\nlibrary(ggplotify)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplotify  * 0.1.3   2025-09-20 [1] RSPM\n Hmisc      * 5.2-4   2025-10-05 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n rms        * 8.1-0   2025-10-14 [1] RSPM\n survival   * 3.8-3   2024-12-17 [3] CRAN (R 4.5.2)\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Calibration Curve"
    ]
  },
  {
    "objectID": "Hiplot/018-calibration-curve.html#数据准备",
    "href": "Hiplot/018-calibration-curve.html#数据准备",
    "title": "校准曲线",
    "section": "数据准备",
    "text": "数据准备\n多列数据的数据帧（数字允许NA）。ie生存数据（状态为0和1）。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/calibration-curve/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\nres.lrm &lt;- lrm(as.formula(paste(\n  \"status ~ \", \n  paste(colnames(data)[3:length(colnames(data))], collapse = \"+\"))),\n  data = data, x = TRUE, y = TRUE)\n\nlrm.cal &lt;- calibrate(res.lrm, method = \"boot\", B = length(rownames(data)))\n\n# 查看数据\nhead(data)\n\n  time status age sex ph.ecog ph.karno pat.karno meal.cal wt.loss\n1  306      2  74   1       1       90       100     1175      NA\n2  455      2  68   1       0       90        90     1225      15\n3 1010      1  56   1       0       90        90       NA      15\n4  210      2  57   1       1       90        60     1150      11\n5  883      2  60   1       0      100        90       NA       0\n6 1022      1  74   1       1       50        80      513       0",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Calibration Curve"
    ]
  },
  {
    "objectID": "Hiplot/018-calibration-curve.html#可视化",
    "href": "Hiplot/018-calibration-curve.html#可视化",
    "title": "校准曲线",
    "section": "可视化",
    "text": "可视化\n\n# 校准曲线\np &lt;- as.ggplot(function() {\n  plot(lrm.cal,\n       xlab = \"Nomogram Predicted Survival\",\n       ylab = \"Actual Survival\",\n       main = \"Calibration Curve\"\n       )\n})\n\n\nn=168   Mean absolute error=0.064   Mean squared error=0.00489\n0.9 Quantile of absolute error=0.096\n\np\n\n\n\n\n\n\n\n图 1: 校准曲线",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Calibration Curve"
    ]
  },
  {
    "objectID": "Hiplot/131-nomogram.html",
    "href": "Hiplot/131-nomogram.html",
    "title": "诺莫图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Nomogram 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/nomogram?lang=zh_cn\n诺莫图常被用来评价肿瘤和医学的预后，并能直观地反映logistic回归或Cox回归的结果。",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Nomogram"
    ]
  },
  {
    "objectID": "Hiplot/131-nomogram.html#环境配置",
    "href": "Hiplot/131-nomogram.html#环境配置",
    "title": "诺莫图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; survival; rms; ggplotify\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"survival\", quietly = TRUE)) {\n  install.packages(\"survival\")\n}\nif (!requireNamespace(\"rms\", quietly = TRUE)) {\n  install.packages(\"rms\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(survival)\nlibrary(rms)\nlibrary(ggplotify)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplotify  * 0.1.3   2025-09-20 [1] RSPM\n Hmisc      * 5.2-4   2025-10-05 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n rms        * 8.1-0   2025-10-14 [1] RSPM\n survival   * 3.8-3   2024-12-17 [3] CRAN (R 4.5.2)\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Nomogram"
    ]
  },
  {
    "objectID": "Hiplot/131-nomogram.html#数据准备",
    "href": "Hiplot/131-nomogram.html#数据准备",
    "title": "诺莫图",
    "section": "数据准备",
    "text": "数据准备\n随时间变化的生存数据帧，根据实例数据用0,1等数字表示性别和状态。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/nomogram/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndd &lt;- datadist(data)\noptions(datadist = \"dd\")\n## 建立 COX 模型并运行列线图\ncox_res &lt;- psm(\n  data = data,\n  as.formula(paste(\n    sprintf(\"Surv(%s, %s) ~ \", colnames(data)[1], colnames(data)[2]),\n    paste(colnames(data)[3:length(colnames(data))],\n      collapse = \"+\"\n    )\n  )),\n  # Surv(time, status) ~ age + sex + ph.ecog + ph.karno + pat.karno,\n  dist = \"lognormal\"\n)\n## 建立 Survival 概率函数\nsurv &lt;- Survival(cox_res)\n## 构建分位数生存时间函数\nmed &lt;- Quantile(cox_res)\n\ncox_nomo &lt;- nomogram(\n  cox_res,\n  fun = list(function(x) surv(365, x), function(x) surv(1095, x),\n             function(x) surv(1825, x), function(x) med(lp = x)),\n  funlabel = c(\"1-year Survival Probability\",\n               \"3-year Survival Probability\",\n               \"5-year Survival Probability\",\n               \"Median Survival Time\"),\n  maxscale = 100\n)\n\n# 查看数据\nhead(data)\n\n  time status age sex ph.ecog ph.karno pat.karno meal.cal wt.loss\n1  306      2  74   1       1       90       100     1175      NA\n2  455      2  68   1       0       90        90     1225      15\n3 1010      1  56   1       0       90        90       NA      15\n4  210      2  57   1       1       90        60     1150      11\n5  883      2  60   1       0      100        90       NA       0\n6 1022      1  74   1       1       50        80      513       0",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Nomogram"
    ]
  },
  {
    "objectID": "Hiplot/131-nomogram.html#可视化",
    "href": "Hiplot/131-nomogram.html#可视化",
    "title": "诺莫图",
    "section": "可视化",
    "text": "可视化\n\n# 诺莫图\np &lt;- as.ggplot(function() {\n  plot(cox_nomo, scale = 1)\n  title(main = \"Nomogram (COX)\")\n})\n\np\n\n\n\n\n\n\n\n图 1: 诺莫图",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Nomogram"
    ]
  },
  {
    "objectID": "Hiplot/064-ggbetweenstats.html",
    "href": "Hiplot/064-ggbetweenstats.html",
    "title": "小提琴图（Betweenstats）",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Betweenstats 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/ggbetweenstats?lang=zh_cn",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Betweenstats"
    ]
  },
  {
    "objectID": "Hiplot/064-ggbetweenstats.html#环境配置",
    "href": "Hiplot/064-ggbetweenstats.html#环境配置",
    "title": "小提琴图（Betweenstats）",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggstatsplot; ggplot2; cowplot\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggstatsplot\", quietly = TRUE)) {\n  install.packages(\"ggstatsplot\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"cowplot\", quietly = TRUE)) {\n  install.packages(\"cowplot\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggstatsplot)\nlibrary(ggplot2)\nlibrary(cowplot)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package     * version date (UTC) lib source\n cowplot     * 1.2.0   2025-07-07 [1] RSPM\n data.table  * 1.17.8  2025-07-10 [1] RSPM\n ggplot2     * 4.0.1   2025-11-14 [1] RSPM\n ggstatsplot * 0.13.4  2025-12-09 [1] RSPM\n jsonlite    * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Betweenstats"
    ]
  },
  {
    "objectID": "Hiplot/064-ggbetweenstats.html#数据准备",
    "href": "Hiplot/064-ggbetweenstats.html#数据准备",
    "title": "小提琴图（Betweenstats）",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/ggbetweenstats/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\naxis &lt;- c(\"mpaa\", \"length\", \"genre\")\ndata[, axis[1]] &lt;- factor(data[, axis[1]], levels = unique(data[, axis[1]]))\ndata[, axis[3]] &lt;- factor(data[, axis[3]], levels = unique(data[, axis[3]]))\n\n# 查看数据\nhead(data)\n\n                                                                 title year\n1                       Lord of the Rings: The Return of the King, The 2003\n2                   Lord of the Rings: The Fellowship of the Ring, The 2001\n3                               Lord of the Rings: The Two Towers, The 2002\n4                                                            Star Wars 1977\n5                       Star Wars: Episode V - The Empire Strikes Back 1980\n6 Dr. Strangelove or: How I Learned to Stop Worrying and Love the Bomb 1964\n  length budget rating  votes  mpaa  genre\n1    251   94.0    9.0 103631 PG-13 Action\n2    208   93.0    8.8 157608 PG-13 Action\n3    223   94.0    8.8 114797 PG-13 Action\n4    125   11.0    8.8 134640    PG Action\n5    129   18.0    8.8 103706    PG Action\n6     93    1.8    8.7  63471    PG Comedy",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Betweenstats"
    ]
  },
  {
    "objectID": "Hiplot/064-ggbetweenstats.html#可视化",
    "href": "Hiplot/064-ggbetweenstats.html#可视化",
    "title": "小提琴图（Betweenstats）",
    "section": "可视化",
    "text": "可视化\n\n# 小提琴图\ng &lt;- unique(data[,axis[3]])\nplist &lt;- list()\nfor (i in 1:length(g)) {\n  fil &lt;- data[,axis[3]] == g[i]\n  plist[[i]] &lt;- ggbetweenstats(\n    data = data[fil,], x = mpaa, y = length,\n    title= paste('', axis[3], g[i], sep = ':'),\n    p.adjust.method = \"holm\",\n    plot.type = \"boxviolin\",\n    pairwise.comparisons = T,\n    pairwise.display = \"significant\",\n    effsize.type = \"unbiased\",\n    notch = T,\n    type = \"parametric\",\n    plotgrid.args = list(ncol = 2)) +\n    scale_color_manual(values = c(\"#00468BFF\",\"#ED0000FF\",\"#42B540FF\"))\n}\np &lt;- plot_grid(plotlist = plist, ncol = 2)\n\np\n\n\n\n\n\n\n\n图 1: 小提琴图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Betweenstats"
    ]
  },
  {
    "objectID": "Hiplot/049-easy-pairs.html",
    "href": "Hiplot/049-easy-pairs.html",
    "title": "简易配对图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Easy Pairs 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/easy-pairs?lang=zh_cn\n显示一个矩阵图，用于查看多个变量的相关关系和数据分布。",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Easy Pairs"
    ]
  },
  {
    "objectID": "Hiplot/049-easy-pairs.html#环境配置",
    "href": "Hiplot/049-easy-pairs.html#环境配置",
    "title": "简易配对图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; GGally\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"GGally\", quietly = TRUE)) {\n  install.packages(\"GGally\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(GGally)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n GGally     * 2.4.0   2025-08-23 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Easy Pairs"
    ]
  },
  {
    "objectID": "Hiplot/049-easy-pairs.html#数据准备",
    "href": "Hiplot/049-easy-pairs.html#数据准备",
    "title": "简易配对图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/easy-pairs/data.json\")$exampleData[[1]]$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 查看数据\nhead(data)\n\n  total_bill  tip gender smoker day   time size\n1      16.99 1.01 Female     No Sun Dinner    2\n2      10.34 1.66   Male     No Sun Dinner    3\n3      21.01 3.50   Male     No Sun Dinner    3\n4      23.68 3.31   Male     No Sun Dinner    2\n5      24.59 3.61 Female     No Sun Dinner    4\n6      25.29 4.71   Male     No Sun Dinner    4",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Easy Pairs"
    ]
  },
  {
    "objectID": "Hiplot/049-easy-pairs.html#可视化",
    "href": "Hiplot/049-easy-pairs.html#可视化",
    "title": "简易配对图",
    "section": "可视化",
    "text": "可视化\n\n# 简易配对图\np &lt;- ggpairs(data, columns = c(\"total_bill\", \"time\", \"tip\"),\n             mapping = aes_string(color = \"gender\")) +\n  ggtitle(\"Easy Pairs\") +\n  scale_fill_manual(values = c(\"#3B4992FF\",\"#EE0000FF\")) +\n  theme_bw() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 1: 简易配对图",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Easy Pairs"
    ]
  },
  {
    "objectID": "Hiplot/077-gobar.html",
    "href": "Hiplot/077-gobar.html",
    "title": "GO 条形图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot GOBar Plot 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/gobar?lang=zh_cn\nGO 条形图用于显示按 z-score 或 adjusted p-value 的负对数排序的 Z-score 彩色条形图。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "GOBar Plot"
    ]
  },
  {
    "objectID": "Hiplot/077-gobar.html#环境配置",
    "href": "Hiplot/077-gobar.html#环境配置",
    "title": "GO 条形图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; GOplot\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"GOplot\", quietly = TRUE)) {\n  install.packages(\"GOplot\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(GOplot)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package      * version date (UTC) lib source\n data.table   * 1.17.8  2025-07-10 [1] RSPM\n ggdendro     * 0.2.0   2024-02-23 [1] RSPM\n ggplot2      * 4.0.1   2025-11-14 [1] RSPM\n GOplot       * 1.0.2   2016-03-30 [1] RSPM\n gridExtra    * 2.3     2017-09-09 [1] RSPM\n jsonlite     * 2.0.0   2025-03-27 [1] RSPM\n RColorBrewer * 1.1-3   2022-04-03 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "GOBar Plot"
    ]
  },
  {
    "objectID": "Hiplot/077-gobar.html#数据准备",
    "href": "Hiplot/077-gobar.html#数据准备",
    "title": "GO 条形图",
    "section": "数据准备",
    "text": "数据准备\n加载的数据是具有七个列的GO富集的结果：category, GO id, GO term, gene count, gene name, logFC, adjust pvalue and zscore。\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/gobar/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ncolnames(data) &lt;- c(\"category\",\"ID\",\"term\",\"count\",\"genes\",\"logFC\",\"adj_pval\",\"zscore\")\ndata &lt;- data[data$category %in% c(\"BP\",\"CC\",\"MF\"),]\ndata &lt;- data[!is.na(data$adj_pval),]\ndata$adj_pval &lt;- as.numeric(data$adj_pval)\ndata$zscore &lt;- as.numeric(data$zscore)\n\n# 查看数据\nhead(data)\n\n  category         ID              term count  genes      logFC adj_pval\n1       BP GO:0007507 heart development    54   DLC1 -0.9707875 2.17e-06\n2       BP GO:0007507 heart development    54   NRP2 -1.5153173 2.17e-06\n3       BP GO:0007507 heart development    54   NRP1 -1.1412315 2.17e-06\n4       BP GO:0007507 heart development    54   EDN1  1.3813006 2.17e-06\n5       BP GO:0007507 heart development    54 PDLIM3 -0.8876939 2.17e-06\n6       BP GO:0007507 heart development    54   GJA1 -0.8179480 2.17e-06\n      zscore\n1 -0.8164966\n2 -0.8164966\n3 -0.8164966\n4 -0.8164966\n5 -0.8164966\n6 -0.8164966",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "GOBar Plot"
    ]
  },
  {
    "objectID": "Hiplot/077-gobar.html#可视化",
    "href": "Hiplot/077-gobar.html#可视化",
    "title": "GO 条形图",
    "section": "可视化",
    "text": "可视化\n\n# GO 条形图\np &lt;- GOBar(data, display = \"multiple\", order.by.zscore = T,\n           title = \"GO Enrichment Barplot \", \n           zsc.col = c(\"#EF8A62\",\"#F7F7F7\",\"#67A9CF\")) + \n    theme(plot.title = element_text(hjust = 0.5),\n          axis.text.x = element_text(size = 8))\n\np\n\n\n\n\n\n\n\n图 1: GO 条形图\n\n\n\n\n\n如示例图所示，x 轴表示每个 GO term，y 轴表示 -log(adj_pvalue)，每个条按 z-score 着色。如果显示分面，则面板的宽度将与 x 刻度的长度成正比。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "GOBar Plot"
    ]
  },
  {
    "objectID": "Hiplot/004-barplot-color-group.html",
    "href": "Hiplot/004-barplot-color-group.html",
    "title": "颜色组柱状图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Barplot Color Group 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/barplot-color-group?lang=zh_cn\n颜色组柱状图可以用于分组展示数据值，并按顺序标注不同颜色。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Barplot Color Group"
    ]
  },
  {
    "objectID": "Hiplot/004-barplot-color-group.html#环境配置",
    "href": "Hiplot/004-barplot-color-group.html#环境配置",
    "title": "颜色组柱状图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; plot3D; ggplotify\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"plot3D\", quietly = TRUE)) {\n  install.packages(\"plot3D\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(stringr)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n stringr    * 1.6.0   2025-11-04 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Barplot Color Group"
    ]
  },
  {
    "objectID": "Hiplot/004-barplot-color-group.html#数据准备",
    "href": "Hiplot/004-barplot-color-group.html#数据准备",
    "title": "颜色组柱状图",
    "section": "数据准备",
    "text": "数据准备\n数据表格（三列）：\nTerm | 条目名称，如 GO/KEGG 通路名称\nCount | 条目的数值大小，如某通路富集到的基因数\nType | 该通路所属大类：如 BP/MF/CC/KEGG\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/barplot-color-group/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ncolnames(data) &lt;- c(\"term\", \"count\", \"type\")\ndata[,\"term\"] &lt;- str_to_sentence(str_remove(data[,\"term\"], pattern = \"\\\\w+:\\\\d+\\\\W\"))\ndata[,\"term\"] &lt;- factor(data[,\"term\"], \n                        levels =  data[,\"term\"][length(data[,\"term\"]):1])\ndata[,\"type\"] &lt;- factor(data[,\"type\"], \n                        levels = data[!duplicated(data[,\"type\"]), \"type\"])\n\n# 查看数据\ndata\n\n                                                  term count type\n1                                      Immune response    20   BP\n2                        Defense response to bacterium    11   BP\n3                                      Cell chemotaxis     8   BP\n4                                        Cell adhesion    17   BP\n5                                Complement activation     8   BP\n6                  Cytokine-mediated signaling pathway     8   MF\n7                             Phagocytosis, engulfment     5   MF\n8              Negative regulation of jak-stat cascade     5   MF\n9                             Epoxygenase p450 pathway     4   MF\n10                Chemokine-mediated signaling pathway     6   MF\n11  Negative regulation of leukocyte apoptotic process     3   MF\n12                   B cell receptor signaling pathway     5   MF\n13          Cellular response to tumor necrosis factor     6   CC\n14                   Positive regulation of chemotaxis     3   CC\n15                 Positive regulation of angiogenesis     6   CC\n16                        Collagen fibril organization     4   CC\n17 Positive regulation of homotypic cell-cell adhesion    20 KEGG\n18              Regulation of cell projection assembly    14 KEGG\n19                 Prostate epithelial cord elongation    10 KEGG\n20                         Bile acid catabolic process     8 KEGG\n21                           Cellular response to drug     7 KEGG\n22                 Glycosaminoglycan metabolic process     4 KEGG",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Barplot Color Group"
    ]
  },
  {
    "objectID": "Hiplot/004-barplot-color-group.html#可视化",
    "href": "Hiplot/004-barplot-color-group.html#可视化",
    "title": "颜色组柱状图",
    "section": "可视化",
    "text": "可视化\n\n# 三维柱状图\np &lt;- ggplot(data = data, aes(x = term, y = count, fill = type)) +\n  geom_bar(stat = \"identity\", width = 0.8) + \n  theme_bw() +\n  xlab(\"Count\") +\n  ylab(\"Term\") +\n  guides(fill = guide_legend(title=\"Type\")) +\n  ggtitle(\"Barplot Color Group\") + \n  coord_flip() +\n  theme_classic() +\n  scale_fill_manual(values = c(\"#E64B35FF\",\"#4DBBD5FF\",\"#00A087FF\",\"#3C5488FF\")) +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 1: 颜色组柱状图\n\n\n\n\n\n上图展示了 GO/KEGG 通路富集分析结果的可视化。",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Barplot Color Group"
    ]
  },
  {
    "objectID": "Hiplot/116-map-world.html",
    "href": "Hiplot/116-map-world.html",
    "title": "世界地图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot World Map 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/map-world?lang=zh_cn",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "World Map"
    ]
  },
  {
    "objectID": "Hiplot/116-map-world.html#环境配置",
    "href": "Hiplot/116-map-world.html#环境配置",
    "title": "世界地图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggplot2; RColorBrewer\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(RColorBrewer)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package      * version date (UTC) lib source\n data.table   * 1.17.8  2025-07-10 [1] RSPM\n ggplot2      * 4.0.1   2025-11-14 [1] RSPM\n jsonlite     * 2.0.0   2025-03-27 [1] RSPM\n RColorBrewer * 1.1-3   2022-04-03 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "World Map"
    ]
  },
  {
    "objectID": "Hiplot/116-map-world.html#数据准备",
    "href": "Hiplot/116-map-world.html#数据准备",
    "title": "世界地图",
    "section": "数据准备",
    "text": "数据准备\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/map-world/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\ndt_map &lt;- readRDS(url(\"https://download.hiplot.cn/ui/basic/map-world/world.rds\"))\n\n# 整理数据格式\ndt_map$Value &lt;- data$death_rate[match(dt_map$ENG_NAME, data$region)]\n\n# 查看数据\nhead(data)\n\n          region death_rate\n1    Afghanistan       13.4\n2        Albania        6.8\n3        Algeria        4.3\n4 American Samoa        5.9\n5        Andorra        7.3\n6         Angola        9.2",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "World Map"
    ]
  },
  {
    "objectID": "Hiplot/116-map-world.html#可视化",
    "href": "Hiplot/116-map-world.html#可视化",
    "title": "世界地图",
    "section": "可视化",
    "text": "可视化\n\n# 世界地图\np &lt;- ggplot(dt_map) +\n  geom_polygon(aes(x = long, y = lat, group = group, fill = Value),\n               alpha = 0.9, size = 0.5) +\n  geom_path(aes(x = long, y = lat, group = group), \n            color = \"black\", size = 0.2) +\n  coord_fixed() +\n  scale_fill_gradientn(\n    colours = colorRampPalette(rev(brewer.pal(11,\"RdYlBu\")))(500),\n    na.value = \"grey10\",\n    limits = c(0, max(dt_map$Value) * 1.2)) +\n    ggtitle(\"World Map Plot\") +\n  theme_minimal() +\n  theme(plot.title = element_text(hjust = 0.5),\n        legend.position = \"bottom\", legend.direction = \"horizontal\")\n\np\n\n\n\n\n\n\n\n图 1: 世界地图",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "World Map"
    ]
  },
  {
    "objectID": "Hiplot/180-violin-group.html",
    "href": "Hiplot/180-violin-group.html",
    "title": "双分组小提琴图",
    "section": "",
    "text": "注记\n\n\n\nHiplot 网站\n本页面为 Hiplot Violin Group 插件的源码版本教程，您也可以使用 Hiplot 网站实现无代码绘图，更多信息请查看以下链接:\nhttps://hiplot.cn/basic/violin-group?lang=zh_cn\nT检验分组数据的小提琴图和盒图。",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Violin Group"
    ]
  },
  {
    "objectID": "Hiplot/180-violin-group.html#环境配置",
    "href": "Hiplot/180-violin-group.html#环境配置",
    "title": "双分组小提琴图",
    "section": "环境配置",
    "text": "环境配置\n\n系统: Cross-platform (Linux/MacOS/Windows)\n编程语言: R\n依赖包: data.table; jsonlite; ggpubr; ggthemes\n\n\n# 安装包\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggpubr\", quietly = TRUE)) {\n  install.packages(\"ggpubr\")\n}\nif (!requireNamespace(\"ggthemes\", quietly = TRUE)) {\n  install.packages(\"ggthemes\")\n}\n\n# 加载包\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggpubr)\nlibrary(ggthemes)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n data.table * 1.17.8  2025-07-10 [1] RSPM\n ggplot2    * 4.0.1   2025-11-14 [1] RSPM\n ggpubr     * 0.6.2   2025-10-17 [1] RSPM\n ggthemes   * 5.2.0   2025-11-30 [1] RSPM\n jsonlite   * 2.0.0   2025-03-27 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Violin Group"
    ]
  },
  {
    "objectID": "Hiplot/180-violin-group.html#数据准备",
    "href": "Hiplot/180-violin-group.html#数据准备",
    "title": "双分组小提琴图",
    "section": "数据准备",
    "text": "数据准备\n\n&lt;1st col&gt;：（数字）值数据\n&lt;2nd col&gt;：（String）第1列组\n&lt;3rd col&gt;：（字符串）第2列组\n\n\n# 加载数据\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/violin-group/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# 整理数据格式\ndata[, 3] &lt;- factor(data[, 3], levels = unique(data[, 3]))\n\n# 查看数据\nhead(data)\n\n  Value Group1 Group2\n1   4.2    low treat1\n2  11.5    low treat1\n3   7.3    low treat1\n4   5.8    low treat1\n5   6.4    low treat1\n6  10.0    low treat1",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Violin Group"
    ]
  },
  {
    "objectID": "Hiplot/180-violin-group.html#可视化",
    "href": "Hiplot/180-violin-group.html#可视化",
    "title": "双分组小提琴图",
    "section": "可视化",
    "text": "可视化\n\n# 双分组小提琴图\np &lt;- ggviolin(data, x = \"Group1\", y = \"Value\", color = \"Group2\", add = \"dotplot\",\n              add.params = list(fill = \"white\",size = 1), title = \"Violin Diagram\",\n              xlab = \"Group1\", ylab = \"Value\", fill = \"Group2\",\n              palette = c(\"#374E55FF\", \"#DF8F44FF\"), alpha = 0.5, trim = F) +\n  stat_compare_means(aes(group = data[, colnames(data)[3]]),\n    method = \"t.test\", vjust = -6, label.x.npc = \"left\", label.y.npc = \"top\",\n    tip.length = 0.03, bracket.size = 0.3, step.increase = 0, position = \"identity\",\n    na.rm = FALSE, show.legend = NA, inherit.aes = TRUE, geom = \"text\") +\n  theme_stata() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\n图 1: 双分组小提琴图",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Violin Group"
    ]
  },
  {
    "objectID": "Correlation/Bubble.html",
    "href": "Correlation/Bubble.html",
    "title": "气泡图",
    "section": "",
    "text": "气泡图是一种散点图，其中第三个数值变量映射到圆圈大小。本文介绍了使用 R 构建气泡图的几种方法。",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Bubble Plot"
    ]
  },
  {
    "objectID": "Correlation/Bubble.html#示例",
    "href": "Correlation/Bubble.html#示例",
    "title": "气泡图",
    "section": "示例",
    "text": "示例",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Bubble Plot"
    ]
  },
  {
    "objectID": "Correlation/Bubble.html#环境配置",
    "href": "Correlation/Bubble.html#环境配置",
    "title": "气泡图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：dplyr, ggplot2, gapminder, hrbrthemes, viridis\n\n\n# 安装包\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"gapminder\", quietly = TRUE)) {\n  install.packages(\"gapminder\")\n}\nif (!requireNamespace(\"hrbrthemes\", quietly = TRUE)) {\n  install.packages(\"hrbrthemes\")\n}\nif (!requireNamespace(\"viridis\", quietly = TRUE)) {\n  install.packages(\"viridis\")\n}\n\n# 加载包\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(gapminder) # 是一个 R 语言的数据包，它提供了来自 Gapminder.org 的数据摘要。这些数据包括了 142 个国家从 1952 年到 2007 年每五年的生命期望值、人均 GDP 和人口数据。\nlibrary(hrbrthemes)\nlibrary(viridis)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package     * version date (UTC) lib source\n dplyr       * 1.1.4   2023-11-17 [1] RSPM\n gapminder   * 1.0.1   2025-06-12 [1] RSPM\n ggplot2     * 4.0.1   2025-11-14 [1] RSPM\n hrbrthemes  * 0.9.2   2025-11-02 [1] Github (hrbrmstr/hrbrthemes@d3fd029)\n viridis     * 0.6.5   2024-01-29 [1] RSPM\n viridisLite * 0.4.2   2023-05-02 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Bubble Plot"
    ]
  },
  {
    "objectID": "Correlation/Bubble.html#数据准备",
    "href": "Correlation/Bubble.html#数据准备",
    "title": "气泡图",
    "section": "数据准备",
    "text": "数据准备\n主要运用 R 内置的 iris 数据集，TCGA 数据库和 gapminder 内置数据集。\n\n# R内置的data——iris\nhead(iris)\n\n  Sepal.Length Sepal.Width Petal.Length Petal.Width Species\n1          5.1         3.5          1.4         0.2  setosa\n2          4.9         3.0          1.4         0.2  setosa\n3          4.7         3.2          1.3         0.2  setosa\n4          4.6         3.1          1.5         0.2  setosa\n5          5.0         3.6          1.4         0.2  setosa\n6          5.4         3.9          1.7         0.4  setosa\n\n# TCGA数据库(运用2020年肺癌的临床数据)\nTCGA_clinic &lt;- readr::read_tsv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/raponi2006_public_raponi2006_public_clinicalMatrix.gz\")\nTCGA_clinic$T &lt;- as.factor(TCGA_clinic$T)\n\n# gapminder包\ndata &lt;- gapminder %&gt;% \n  filter(year==\"2007\") %&gt;% \n  dplyr::select(-year)",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Bubble Plot"
    ]
  },
  {
    "objectID": "Correlation/Bubble.html#可视化",
    "href": "Correlation/Bubble.html#可视化",
    "title": "气泡图",
    "section": "可视化",
    "text": "可视化\n\n1. 基本绘图\n\n# 以iris数据为例\np &lt;- ggplot(iris, aes(x=Sepal.Length, y=Sepal.Width, size = Species)) +\n  geom_point(alpha=0.4)\n\np\n\n\n\n\n\n\n\n图 1: 基本绘图\n\n\n\n\n\n这个气泡图描述了不同物种间Sepal.Length变量与Sepal.Width变量之间的关系。\n\n\n2. 改变颜色\n\n# 改变颜色\np &lt;- ggplot(iris, aes(x=Sepal.Length, y=Sepal.Width, size=Species,color=Species)) +\n  geom_point(alpha=0.3)\n\np\n\n\n\n\n\n\n\n图 2: 改变颜色\n\n\n\n\n\n这个气泡图描述了不同物种间Sepal.Length变量与Sepal.Width`变量之间的关系。\n\n\n3. 改变圆圈大小的范围\n\n# 以TCGA数据为例\np &lt;- TCGA_clinic %&gt;%\n  arrange(desc(Age)) %&gt;%\n  ggplot(aes(x=T, y=OS.time, size = Age,color=Age)) +\n  geom_point(alpha=0.4) +\n  scale_size(range = c(.1, 12), name=\"Age\")\n\np\n\n\n\n\n\n\n\n图 3: 改变圆圈大小的范围\n\n\n\n\n\n这个气泡图描述了不同肿瘤T分期中年龄与OS.time变量的关系。\n\n\n4. 精细化图片\n\n# 以gapminder包里面的数据为例\np &lt;- data %&gt;%\n  arrange(desc(pop)) %&gt;%\n  mutate(country = factor(country, country)) %&gt;%\n  ggplot(aes(x=gdpPercap, y=lifeExp, size=pop, fill=continent)) +\n  geom_point(alpha=0.5, shape=21, color=\"black\") +\n  scale_size(range = c(.1, 24), name=\"Population (M)\") +\n  scale_fill_viridis(discrete=TRUE, guide=FALSE, option=\"A\") +\n  theme_ipsum() +\n  theme(legend.position=\"bottom\") +\n  ylab(\"Life Expectancy\") +\n  xlab(\"Gdp per Capita\") +\n  theme(legend.position = \"none\")\n\np\n\n\n\n\n\n\n\n图 4: 精细化图片\n\n\n\n\n\n这个气泡图描述了世界各国预期寿命（y）与人均国内生产总值（x）之间的关系。",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Bubble Plot"
    ]
  },
  {
    "objectID": "Correlation/Bubble.html#应用场景",
    "href": "Correlation/Bubble.html#应用场景",
    "title": "气泡图",
    "section": "应用场景",
    "text": "应用场景\n\n1. 气泡图用于展示KEGG通路富集分析\n\n\n\n\n\n\n图 5: 气泡图应用\n\n\n\n这个气泡图展示了与新冠肺炎发生和进展相关的26种信号通路。[1]\n\n\n2. 气泡图可用于多变量数据展示\n\n\n\n\n\n\n图 6: 气泡图应用\n\n\n\n这个气泡图展示了根据系泊观测和历史温度剖面测量估计的极端温度异常之间的一致性。a、 根据系泊点估算的第95百分位EHTA气泡图和以系泊点为中心的5×5°网格框内的相应历史温度分布测量值。颜色表示来自不同地点的观测结果，点的大小表示10至1000米的观测深度。b与a相同，但适用于第5百分位ELTA。请注意，未绘制低于-3°C的ELTA（在KEO现场）。c、 d，与a（c）和b（d）相同，但AE（c）内观察到的EHTA测量值和CE（d）内观察的ELTA测量值的百分比（p）不同。带有灰色阴影的实心黑线表示具有95%置信水平的相应线性回归。[2]",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Bubble Plot"
    ]
  },
  {
    "objectID": "Correlation/Bubble.html#参考文献",
    "href": "Correlation/Bubble.html#参考文献",
    "title": "气泡图",
    "section": "参考文献",
    "text": "参考文献\n[1] Oh KK, Adnan M, Cho DH. Network pharmacology approach to decipher signaling pathways associated with target proteins of NSAIDs against COVID-19. Sci Rep. 2021 May 5;11(1):9606. doi: 10.1038/s41598-021-88313-5. PMID: 33953223; PMCID: PMC8100301.\n[2] He Q, Zhan W, Feng M, Gong Y, Cai S, Zhan H. Common occurrences of subsurface heatwaves and cold spells in ocean eddies. Nature. 2024 Oct;634(8036):1111-1117. doi: 10.1038/s41586-024-08051-2. Epub 2024 Oct 16. PMID: 39415017; PMCID: PMC11525169.\n[3] Wickham, H. (2016). ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York. https://ggplot2.tidyverse.org\n[4] Bryan, J. (2023). gapminder: Data from Gapminder (Version 1.0.0). Retrieved from https://CRAN.R-project.org/package=gapminder\n[5] Wickham, H. (2017). dplyr: A Grammar of Data Manipulation (Version 0.7.4). Retrieved from https://CRAN.R-project.org/package=dplyr\n[6] Rudis, B. (2017). hrbrthemes: Additional Themes, Theme Components and Utilities for ‘ggplot2’ (Version 0.8.7). Retrieved from https://github.com/hrbrmstr/hrbrthemes\n[7] Ross, N., & Garnier, S. (2016). viridis: Default Color Maps for ‘ggplot2’. Retrieved from https://cran.r-project.org/web/packages/viridis/index.html",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Bubble Plot"
    ]
  },
  {
    "objectID": "Correlation/Heatmap.html",
    "href": "Correlation/Heatmap.html",
    "title": "热图",
    "section": "",
    "text": "热图是一种用颜色表示矩阵中包含的各个值的可视化方式。常用来表示不同样品组代表性基因的表达差异、不同样品组代表性化合物的含量差异、不同样品之间的两两相似性。实际上，任何一个表格数据都可以转换为热图展示。",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Heatmap"
    ]
  },
  {
    "objectID": "Correlation/Heatmap.html#示例",
    "href": "Correlation/Heatmap.html#示例",
    "title": "热图",
    "section": "示例",
    "text": "示例\n\n\n\n\n\n在此热图中，每一行代表一辆汽车（如 Mazda RX4、Merc 450SLC 等），每一列表示汽车的某个属性（如 mpg：每加仑行驶的英里数，hp：马力，wt：重量等）。每个方块表示某辆车在某个属性上的数值大小，越接近黄色数值越高。\n顶部和左侧显示的线条表示层次聚类的结果（也称为树状图，dendrogram）。这些线条表示的是如何将行和列聚类的层次关系，即数据中不同行或列之间的相似性。\n\n\n\n\n\n\n注记\n\n\n\n注意: 由图可见，这个热图的信息量有限：很多变化被与其他变量相比具有非常高的值的hp和 disp变量吸收。（当所有变量被映射到同一颜色尺度时，hp和disp的较大值会主导颜色分布，导致图片不能很好的展示变量之间的差异。）我们需要对数据进行标准化，如下一节所述。",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Heatmap"
    ]
  },
  {
    "objectID": "Correlation/Heatmap.html#环境配置",
    "href": "Correlation/Heatmap.html#环境配置",
    "title": "热图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：readr, ggplot2, hrbrthemes, dplyr, tidyr, viridis, tibble, htmlwidgets, RColorBrewer, plotly, remotes, d3heatmap, heatmaply, lattice, ComplexHeatmap, pheatmap, circlize, gridExtra, cowplot\n\n\n# 安装包\nif (!requireNamespace(\"readr\", quietly = TRUE)) {\n  install.packages(\"readr\")\n}\nif (!requireNamespace(\"tidyverse\", quietly = TRUE)) {\n  install.packages(\"tidyverse\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"hrbrthemes\", quietly = TRUE)) {\n  remotes::install_github(\"hrbrmstr/hrbrthemes\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"tidyr\", quietly = TRUE)) {\n  install.packages(\"tidyr\")\n}\nif (!requireNamespace(\"viridis\", quietly = TRUE)) {\n  install.packages(\"viridis\")\n}\nif (!requireNamespace(\"tibble\", quietly = TRUE)) {\n  install.packages(\"tibble\")\n}\nif (!requireNamespace(\"htmlwidgets\", quietly = TRUE)) {\n  install.packages(\"htmlwidgets\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\nif (!requireNamespace(\"plotly\", quietly = TRUE)) {\n  install.packages(\"plotly\")\n}\nif (!requireNamespace(\"d3heatmap\", quietly = TRUE)) {\n  remotes::install_github(\"talgalili/d3heatmap\")\n}\nif (!requireNamespace(\"heatmaply\", quietly = TRUE)) {\n  install.packages(\"heatmaply\")\n}\nif (!requireNamespace(\"lattice\", quietly = TRUE)) {\n  install.packages(\"lattice\")\n}\nif (!requireNamespace(\"ComplexHeatmap\", quietly = TRUE)) {\n  BiocManager::install(\"ComplexHeatmap\")\n}\nif (!requireNamespace(\"pheatmap\", quietly = TRUE)) {\n  install.packages(\"pheatmap\")\n}\nif (!requireNamespace(\"circlize\", quietly = TRUE)) {\n  install.packages(\"circlize\")\n}\nif (!requireNamespace(\"gridExtra\", quietly = TRUE)) {\n  install.packages(\"gridExtra\")\n}\nif (!requireNamespace(\"cowplot\", quietly = TRUE)) {\n  install.packages(\"cowplot\")\n}\n\n# 加载包\nlibrary(readr)\nlibrary(hrbrthemes)     # ggplot2 的附加主题\nlibrary(dplyr)          # 数据操作函数\nlibrary(tidyr)          # 数据整理函数\nlibrary(viridis)        # 调色板可实现更好的可视化\nlibrary(tibble)         # 整洁的数据框\nlibrary(htmlwidgets)    # 交互式网页可视化\nlibrary(RColorBrewer)   # 可视化的调色板\nlibrary(plotly)         # 交互式绘图\nlibrary(d3heatmap)      # D3.js-based 交互式热图\nlibrary(heatmaply)      # 使用 ggplot2 制作交互式热图\nlibrary(lattice)        # 多元数据的网格图形\nlibrary(ComplexHeatmap) # 高级热图功能\nlibrary(pheatmap)       # 漂亮的热图，支持聚类\nlibrary(circlize)       # 圆形可视化\nlibrary(gridExtra)      # 网格布局可视化\nlibrary(cowplot)\nlibrary(tidyverse)\nlibrary(ggplot2)        # 数据可视化包\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package        * version date (UTC) lib source\n circlize       * 0.4.17  2025-12-08 [1] RSPM\n ComplexHeatmap * 2.26.0  2025-10-29 [1] Bioconduc~\n cowplot        * 1.2.0   2025-07-07 [1] RSPM\n d3heatmap      * 0.9.0   2025-11-02 [1] Github (talgalili/d3heatmap@0ff4b83)\n dplyr          * 1.1.4   2023-11-17 [1] RSPM\n forcats        * 1.0.1   2025-09-25 [1] RSPM\n ggplot2        * 4.0.1   2025-11-14 [1] RSPM\n gridExtra      * 2.3     2017-09-09 [1] RSPM\n heatmaply      * 1.6.0   2025-07-12 [1] RSPM\n hrbrthemes     * 0.9.2   2025-11-02 [1] Github (hrbrmstr/hrbrthemes@d3fd029)\n htmlwidgets    * 1.6.4   2023-12-06 [1] RSPM\n lattice        * 0.22-7  2025-04-02 [3] CRAN (R 4.5.2)\n lubridate      * 1.9.4   2024-12-08 [1] RSPM\n pheatmap       * 1.0.13  2025-06-05 [1] RSPM\n plotly         * 4.11.0  2025-06-19 [1] RSPM\n purrr          * 1.2.0   2025-11-04 [1] RSPM\n RColorBrewer   * 1.1-3   2022-04-03 [1] RSPM\n readr          * 2.1.6   2025-11-14 [1] RSPM\n stringr        * 1.6.0   2025-11-04 [1] RSPM\n tibble         * 3.3.0   2025-06-08 [1] RSPM\n tidyr          * 1.3.2   2025-12-19 [1] RSPM\n tidyverse      * 2.0.0   2023-02-22 [1] RSPM\n viridis        * 0.6.5   2024-01-29 [1] RSPM\n viridisLite    * 0.4.2   2023-05-02 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Heatmap"
    ]
  },
  {
    "objectID": "Correlation/Heatmap.html#数据准备",
    "href": "Correlation/Heatmap.html#数据准备",
    "title": "热图",
    "section": "数据准备",
    "text": "数据准备\n本节提供使用 R 内置数据集（mtcars、volcano）以及来自 UCSC Xena DATASETS 的 TCGA-CHOL.methylation450.tsv 数据集的简短教程。这些数据集将用于演示 R 中的热图可视化。本示例演示了如何在 R 中加载和使用这些数据集。\n\n# 加载内置 R 数据集“mtcars”\ndata(\"mtcars\", package = \"datasets\")\nmtcars_matrix &lt;- as.matrix(mtcars)\n\n# 加载和处理甲基化数据\nraw_methylation_data &lt;- readr::read_tsv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/TCGA-CHOL.methylation450.tsv\")\n\n# 转换为矩阵并清理行/列名称\nmethylation_matrix &lt;- raw_methylation_data[, -1] %&gt;%\n  as.data.frame() %&gt;%\n  `rownames&lt;-`(raw_methylation_data$Composite)\n\n# 整理为长格式\nmethylation_long &lt;- methylation_matrix %&gt;%\n  rownames_to_column(\"Composite\") %&gt;%\n  pivot_longer(cols = -Composite, names_to = \"Sample\", values_to = \"Methylation_Level\") %&gt;%\n  mutate(\n    Methylation_Level = as.numeric(Methylation_Level),\n    Composite = gsub(\"^cg0+\", \"cg\", Composite),\n    Sample = substr(Sample, 9, 12)\n  )\n\n# 标准化甲基化值\nmethylation_long_standardized &lt;- methylation_long %&gt;%\n  group_by(Composite) %&gt;%\n  mutate(Standardized_Level = scale(Methylation_Level)[,1]) %&gt;%\n  ungroup()\n\n# 转换回宽格式矩阵\nstandardized_methylation_matrix &lt;- methylation_long_standardized %&gt;%\n  select(Composite, Sample, Standardized_Level) %&gt;%\n  pivot_wider(names_from = Sample, values_from = Standardized_Level) %&gt;%\n  column_to_rownames(\"Composite\") %&gt;%\n  as.matrix()\n\n\n# 清理原始甲基化矩阵（原始热图的数值版本）\nmethylation_matrix_num &lt;- methylation_matrix %&gt;%\n  mutate(across(everything(), ~ as.numeric(as.character(.)))) %&gt;%\n  `rownames&lt;-`(gsub(\"^cg0+\", \"cg\", rownames(.))) %&gt;%\n  { `colnames&lt;-`(., substr(colnames(.), 9, 12)) } %&gt;%\n  as.matrix()",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Heatmap"
    ]
  },
  {
    "objectID": "Correlation/Heatmap.html#可视化",
    "href": "Correlation/Heatmap.html#可视化",
    "title": "热图",
    "section": "可视化",
    "text": "可视化\n\n1. 基础 R 热图\n\n1.1 基础热图\n使用heatmap()函数构建热图。下图是可以在基本 R 中构建的最基本的热图，没有使用参数。heatmap()以矩阵作为输入类型。如果数据是数据框类型，可以使用as.matrix()将其转换为矩阵。矩阵可以通过t()函数进行转置（transpose）。矩阵的转置操作会将原矩阵的行和列进行交换，交换 X 轴和 Y 轴。\n\nheatmap(mtcars_matrix)\n\n\n\n\n\n\n\n图 1: 基础 R 热图\n\n\n\n\n\n此热图通过颜色的变化展示了 mtcars 数据集中不同汽车的性能变量之间的数值差异。\n\n\n\n\n\n\n提示\n\n\n\n如图所示，这个热图并没有提供太多见解：所有的变异都被 hp 和 disp 两个变量吸收了，因为它们的数值远高于其他变量。（当所有变量被映射到同一颜色尺度时，hp和disp的较大值会主导颜色分布，使得其他变量（如mpg、wt等）的细微变化难以在图中体现。）我们需要对数据进行标准化，如下一节所述。\n\n\n\n\n1.2 标准化\n使用heatmap()函数的scale参数对矩阵进行标准化。它可以应用于行或列。这里选择列选项，因为我们需要吸收列之间的变化。\n\nheatmap(mtcars_matrix, scale=\"column\")\n\n\n\n\n\n\n\n图 2: 标准化\n\n\n\n\n\n此热图显示了mtcars数据中各性能变量的标准化值，使得不同性能变量在同一尺度上进行比较，从而提高图片的效果和准确性。\n\n\n1.3 聚类图和重新排序\n在绘制的热图中，行和列的顺序与原始mtcar矩阵不同。这是因为heatmap()使用聚类算法对变量和观测值进行重新排序：它计算每对行和列之间的距离，并尝试按相似性对它们进行排序。\n此外，热图旁边还提供了聚类图。可以使用Rowv和Colv参数取消聚类图，如下所示。\n\nheatmap(mtcars_matrix, Colv = NA, Rowv = NA, scale=\"column\")\n\n\n\n\n\n\n\n图 3: 聚类图和重新排序\n\n\n\n\n\n此热图显示了mtcars数据中各性能变量的标准化值，取消树状图后行和列按照原顺序排列。\n\n\n1.4 调色板\n热图可以使用不同调色板：\n\n使用 R 的原生调色板：terrain.color()，rainbow()，heat.colors()，topo.colors()，cm.colors()\n使用RColorBrewer建议的调色板\n自定义调色板\n\n\n# 原生调色板\nheatmap(mtcars_matrix, scale=\"column\", col = cm.colors(256))\nheatmap(mtcars_matrix, scale=\"column\", col = terrain.colors(256))\n\n# 使用Rcolorbrewer\ncoul &lt;- colorRampPalette(brewer.pal(8, \"PiYG\"))(25)\nheatmap(mtcars_matrix, scale=\"column\", col = coul)\n\n# 自定义调色板\nmy_palette &lt;- colorRampPalette(c(\"blue\", \"white\", \"red\"))(256)\nheatmap(mtcars_matrix, scale = \"column\", col = my_palette)\n\n\n\n\n\n\n\n图 4: 调色板\n\n\n\n\n\n\n\n\n\n\n\n图 5: 调色板\n\n\n\n\n\n\n\n\n\n\n\n图 6: 调色板\n\n\n\n\n\n\n\n\n\n\n\n图 7: 调色板\n\n\n\n\n\n这四个热图通过不同的调色板展示了相同数据：mtcars数据集中不同汽车的性能变量之间的数值差异，强调了调色板选择对视觉效果和数据解释的重要性。\n\nRColorBrewer\n使用display.brewer.all()函数展示RColorBrewer包中所有的颜色系列。\n\npar(plt=c(0.1,1,0,1))\ndisplay.brewer.all()\n\n\n\n\n\n\n\n图 8: RColorBrewer Basic R\n\n\n\n\n\n上图中，左侧是颜色系列的名称，右侧是对应的颜色。从图中可以看出，这些颜色系列共分为三类: - 第一类颜色是单种颜色由浅到深的梯度变化，记作seq(sequential)；该系列的颜色主要适用于连续型变量或有序分类变量； - 第二类颜色的彼此差异性较大，且不具备明显的等级关系，记作qual(qualitative)；该系列的颜色主要适用于无序的分类变量； - 第三类颜色是两种颜色分别朝两个方向由浅到深的梯度变化，记作div(diverging)；该系列的颜色主要适用于中间值具有特殊意义的连续变量或有序分类变量，如摄氏温度、Logistic模型的OR值等。\n\n\n\n1.5 自定义布局\n热图可以使用常用的main和xlab/ylab参数自定义标题和轴标题（左图），也可以使用labRow/colRow更改标签并使用cexRow/cexCol更改其大小（右图）。\n\n# 自定义标题和轴标题\np5 &lt;- heatmap(mtcars_matrix, Colv = NA, Rowv = NA, scale=\"column\", col = coul, xlab=\"variable\", main=\"heatmap\")\n\n# 自定义标签\np6 &lt;- par(mar = c(5, 0, 4, 2))  # 调整边距\nheatmap(mtcars_matrix, scale=\"column\", cexRow=.8, labRow=paste(\"new_\", rownames(mtcars_matrix),sep=\"\"), col= colorRampPalette(brewer.pal(8, \"Blues\"))(25))\n\n\n\n\n\n\n\n图 9: 自定义布局\n\n\n\n\n\n\n\n\n\n\n\n图 10: 自定义布局\n\n\n\n\n\n这两个热图通过自定义标题、轴标题和行标签，展示了 mtcars 数据集中不同汽车性能变量之间的标准化数值差异，强调了数据特征的可视化效果和信息传达的清晰度。\n\n\n1.6 带有颜色标记的热图\n通常，热图旨在将观察到的结构与预期的结构进行比较。可以使用RowSideColors参数在热图旁边添加一个颜色向量，以表示预期的结构。\n\nmy_group &lt;- as.numeric(as.factor(substr(rownames(mtcars_matrix), 1 , 1))) # 将行标签按首字母分组并转换为数字\ncolSide &lt;- brewer.pal(9, \"Set1\")[my_group] # 使用RColorBrewer包中的Set1方案生成9种颜色，为每个分组分配颜色标识\ncolMain &lt;- colorRampPalette(brewer.pal(8, \"Blues\"))(25)\nheatmap(mtcars_matrix, Colv = NA, Rowv = NA, scale=\"column\" , RowSideColors=colSide, col=colMain)\n\n\n\n\n\n\n\n图 11: 带有颜色标记的热图\n\n\n\n\n\n此热图按首字母分组并为每个组分配不同颜色，帮助观察者快速识别不同组别或类别之间的差异，进而更直观地理解数据的模式和趋势。\n\n\n\n2. ggplot2 热图\nggplot2使用geom_tile()函数来构建热图。但是只有heatmap()函数能提供标准化、聚类和树状图的选项。\n\n2.1 基础热图\n使用ggplot2和geom_tile()函数构建的最基本的热图。因为geom_tile()函数不能直接进行标准化，需要提前进行标准化。\n输入数据必须是长格式数据框，其中每行提供一个观察值。每个观察值至少需要 3 个变量：\n\nx: X 轴上的位置\ny: Y 轴上的位置\nfill: 将以颜色转换的数值\n\n\np &lt;- ggplot(methylation_long_standardized, aes(x = Sample, y = Composite, fill= Standardized_Level)) + \n  geom_tile()\n\np \n\n\n\n\n\n\n\n图 12: 基础热图\n\n\n\n\n\n此热图使用 ggplot2 展示了在 TCGA-CHOL 数据集中不同样本（Sample）和复合体（Composite）之间标准化甲基化水平（Standardized_Level）的分布，反映了不同样本在甲基化状态上的差异。\n\n\n2.2 调色板\n热图可以像任何ggplot2图表一样更改调色板。以下是使用不同方法的 3 个示例：\n\nscale_fill_gradient(): 提供调色板的极端颜色。\nscale_fill_distiller()): 提供ColorBrewer调色板。\nscale_fill_viridis() 使用 Viridis。不要忘记 discrete=FALSE 连续变量。（颜色的渐变具有连续性）。\n\n\n# Extreme colors\np7 &lt;- ggplot(methylation_long_standardized, aes(x = Sample, y = Composite, fill= Standardized_Level)) + \n  geom_tile()+\n  scale_fill_gradient(low=\"white\", high=\"blue\") +\n  theme_ipsum() +\n  theme(axis.text.x = element_text(size = 10))\n\n# ColorBrewer color palette\np8 &lt;- ggplot(methylation_long_standardized, aes(x = Sample, y = Composite, fill= Standardized_Level)) + \n  geom_tile() +\n  scale_fill_distiller(palette = \"RdPu\") +\n  theme_ipsum() +\n  theme(axis.text.x = element_text(size = 10)) \n\n# Using Viridis\np9 &lt;- ggplot(methylation_long_standardized, aes(x = Sample, y = Composite, fill= Standardized_Level)) + \n  geom_tile()+\n  scale_fill_viridis(discrete=FALSE) +\n  theme_ipsum() + \n  theme(axis.text.x = element_text(size = 10))\n\nplot_grid(p7, p8, p9, ncol = 3)\n\n\n\n\n\n\n\n图 13: 调色板\n\n\n\n\n\n这三个热图通过不同的调色板展示了相同数据：TCGA-CHOL 数据集中不同样本（Sample）和复合体（Composite）之间标准化甲基化水平（Standardized_Level）的分布，强调了调色板选择对视觉效果和数据解释的重要性。\n\n\n2.3 宽格式输入\n输入为一个宽矩阵是一个常见的问题，使用volcano数据集时就是这样。在这种情况下，可以使用tidyr包的gather()函数对其进行整理变成长格式，然后用ggplot进行可视化 。\n\nvolcano %&gt;%\n  as_tibble() %&gt;%\n  rowid_to_column(var=\"X\") %&gt;%\n  gather(key=\"Y\", value=\"Z\", -1) %&gt;%\n  \n  mutate(Y=as.numeric(gsub(\"V\",\"\",Y))) %&gt;%\n\n  ggplot(aes(X, Y, fill= Z)) + \n    geom_tile() +\n    theme_ipsum() +\n    theme(legend.position=\"none\")\n\n\n\n\n\n\n\n图 14: 宽格式输入\n\n\n\n\n\n此热图展示了火山数据集中不同点的高程值（Z），其中横轴代表行索引（X），纵轴代表列索引（Y），通过颜色填充表示高程的变化。\n\n\n2.4 交互式热图\nggplot2创造热图的一大优点是借助plotly包，图表可以在几秒钟内变为交互式。只需要将图表包装在一个对象中，然后在ggplotly()函数中调用它即可。\n你也可以自定义工具提示中的文本，提供更丰富的信息。尝试将鼠标悬停在单元格上以查看工具提示，选择要放大的区域。\n\n# 创建工具提示文本\nmethylation_long_annotated &lt;- methylation_long_standardized %&gt;%\n  mutate(text = paste0(\"Composite: \",Composite, \"\\n\", \"Sample: \", Sample, \"\\n\", \"Standardized_Level: \", Standardized_Level))\n\np &lt;- ggplot(methylation_long_annotated, aes(Composite, Sample, fill = Standardized_Level, text = text)) + \n  geom_tile() +\n  theme_ipsum()\n\npp &lt;- ggplotly(p, tooltip=\"text\", width = 1200, height = 700)\n\npp\n\n\n\n\n\n\n\n图 15: 交互式热图\n\n\n\n\n此交互式热图是使用plotly包构建，允许用户动态探索和深入分析数据，提供更直观的理解和信息获取。\n也可以使用d3heatmap包和heatmaply包创造交互性热图\n\n使用 d3heatmap 包\n\nd3heatmap(standardized_methylation_matrix, scale = \"row\", dendrogram = \"none\")\n\n\n\n\n\n\n\n图 16: 使用 d3heatmap 包\n\n\n\n\n使用 d3heatmap 包构建交互式热图，允许用户动态探索和深入分析数据，提供更直观的理解和信息获取。\n\n\n使用 heatmaply 包\n\np &lt;- heatmaply(standardized_methylation_matrix,\n               dendrogram = \"none\",\n               xlab = \"\", ylab = \"\",\n               main = \"\",\n               scale = \"row\",\n               margins = c(50,0,30,30),\n               grid_color = \"white\",\n               grid_width = 0.00001,\n               titleX = FALSE,\n               hide_colorbar = TRUE,\n               branches_lwd = 0.1,\n               fontsize_row = 5, fontsize_col = 5,\n               labCol = colnames(standardized_methylation_matrix),\n               labRow = rownames(standardized_methylation_matrix),\n               heatmap_layers = theme(axis.line = element_blank())\n)\n\np\n\n\n\n\n\n\n\n图 17: 使用 heatmaply 包\n\n\n\n\n使用heatmaply包构建交互式热图，允许用户动态探索和深入分析数据，提供更直观的理解和信息获取。\n\n\n\n\n3. lattice 热图\n用 lattice 包的 levelplot() 函数构建热图\n\n3.1 levelplot() 的基本用法\n\n# 将 Sample 和 Composite 列由字符转换为因子\nmethylation_long_standardized$Sample &lt;- as.factor(methylation_long_standardized$Sample)\nmethylation_long_standardized$Composite &lt;- as.factor(methylation_long_standardized$Composite) \n\nlevelplot(Standardized_Level ~ Sample * Composite, data = methylation_long_standardized,\n          xlab = \"Sample\", ylab = \"Composite\",\n          main = \"Heatmap of Standardized TCGA-CHOL Methylation Levels\")\n\n\n\n\n\n\n\n图 18: lattice 基础热图\n\n\n\n\n\n此热图使用lattice展示了在 TCGA-CHOL 数据集中不同样本（Sample）和复合体（Composite）之间标准化甲基化水平（Standardized_Level）的分布，反映了不同样本在甲基化状态上的差异。\n\n\n3.2 来自宽输入矩阵\n本文档的上一个示例基于长格式的数据框。这里改用方阵。这是该levelplot()函数理解的第二种格式。\n\n\n\n\n\n\n提示\n\n\n\n此处热图中行和列会调转。\n\n\n\nlevelplot(standardized_methylation_matrix)\n\n\n\n\n\n\n\n图 19: 来自宽输入矩阵\n\n\n\n\n\n此热图使用levelplot()函数宽格式输入，展示了在 TCGA-CHOL 数据集中不同样本在甲基化状态上的差异。\n\n\n3.3 翻转轴\nR 的函数t()允许转置输入矩阵，从而翻转 X 和 Y 坐标。这样，来自宽输入矩阵levelplot()热图的组织方式与输入矩阵完全相同。\nlevelplot()输入为宽矩阵时默认小格的纵横比是1:1，可以用aspect = \"fill\"根据矩阵的实际比例自动调整纵横比。\n\n# 翻转 X 和 Y 坐标\nlevelplot( t(standardized_methylation_matrix),\n           col.regions=heat.colors(220),\n           aspect = \"fill\") # 自动调整纵横比\n\n\n\n\n\n\n\n图 20: 翻转轴\n\n\n\n\n\n此热图展示了在 TCGA-CHOL 数据集中不同样本在甲基化状态上的差异。翻转 X 和 Y 坐标使得热图的组织方式与输入矩阵完全相同。\n\n\n3.4 调色板\n调色板的方法有多种： - R的原生调色板：terrain.color()，rainbow()，heat.colors()，topo.colors()，cm.colors() - RColorBrewer 调色板 - Viridis调色板：viridis, magma, inferno, plasma\n\n# 使用R原生调色板\np10 &lt;- levelplot(volcano, col.regions = terrain.colors(100)) # try cm.colors() or terrain.colors()\np10\n\n# 使用 Rcolorbrewer\ncoul &lt;- colorRampPalette(brewer.pal(8, \"PiYG\"))(25)\np11 &lt;- levelplot(volcano, col.regions = coul)\np11\n\n# 使用 Viridis\ncoul &lt;- viridis(100)\np12 &lt;- levelplot(volcano, col.regions = coul) \np12\n\n\n\n\n\n\n\n图 21: 调色板\n\n\n\n\n\n\n\n\n\n\n\n图 22: 调色板\n\n\n\n\n\n\n\n\n\n\n\n图 23: 调色板\n\n\n\n\n\n这三个热图通过不同的调色板展示了相同数据：volcano数据集中不同点的高程值，强调了调色板选择对视觉效果和数据解释的重要性。\n\n\n\n4. pheatmap 热图\n用 pheatmap 包构建热图，pheatmap 包同样可以用参数进行标准化\n\n4.1 基础热图\n\npheatmap(methylation_matrix_num, scale = \"row\")\n\n\n\n\n\n\n\n图 24: 基础热图\n\n\n\n\n\n此热图使用 pheatmap 包展示了在 TCGA-CHOL 数据集中不同样本在甲基化状态上的差异。\n\n\n4.2 调整聚类图\n\nclustering_distance_rows 和 clustering_distance_cols 表示行、列聚类使用的度量方法，默认为“euclidean”，也可为 “correlation”，即按照 Pearson correlation方法进行聚类。\nclustering_method 可以修改聚类方法，包括：‘ward’, ‘ward.D’, ‘ward.D2’, ‘single’, ‘complete’, ‘average’, ‘mcquitty’, ‘median’, ‘centroid’。\n\n\npheatmap(methylation_matrix_num, scale = \"row\", \n         clustering_distance_rows = \"euclidean\", clustering_distance_cols = \"euclidean\", # 聚类使用的度量方法\n         clustering_method = \"complete\", # 聚类方法\n         cluster_rows = T, cluster_cols = F, # 是否显示聚类树\n         treeheight_row = 30, treeheight_col = 30) # 聚类树高度调整\n\n\n\n\n\n\n\n图 25: 调整聚类图\n\n\n\n\n\n此热图使用 pheatmap 包展示了在 TCGA-CHOL 数据集中不同样本在甲基化状态上的差异，取消了不同样本之间的聚类，样本按照原顺序排列。\n\n\n4.3 标签角度及未聚类条件下的隔断位置\n\npheatmap(methylation_matrix_num, scale = \"row\", \n         clustering_distance_rows = \"euclidean\", clustering_distance_cols = \"euclidean\", # 聚类使用的度量方法\n         clustering_method = \"complete\", # 聚类方法\n         cluster_rows = T, cluster_cols = F, # 是否显示聚类树\n         treeheight_row = 30, treeheight_col = 30, # 聚类树高度调整\n         angle_col = \"45\", # 改变列标签的角度\n         gaps_col = c(3,6))  # 仅在未进行列聚类时使用，假设样本在3，6的位置隔断，分为三组\n\n\n\n\n\n\n\n图 26: 标签角度及未聚类条件下的隔断位置\n\n\n\n\n\n此热图调整标签角度，可以避免标签重叠，提升可读性；在未聚类条件下调整隔断位置则能突出特定样本之间的差异，便于直观分析。\n\n\n4.4 添加数值或标记\n\npheatmap(methylation_matrix_num, scale = \"row\",\n         border_color = \"white\", # 修改单元格边框颜色\n         display_numbers = TRUE, # 热图格子中显示相应的数值\n         fontsize_number = 9, \n         number_color = \"grey30\",\n         number_format = \"%.1f\") # 保留一位小数\n\n\n\n\n\n\n\n图 27: 添加数值或标记\n\n\n\n\n\n在热图上添加数值或标记可以提供更多上下文信息，帮助观察者快速识别每个样本或位点的具体甲基化水平，从而增强数据解读的直观性和准确性。\n\n使用原数据判断标注\n\npheatmap(methylation_matrix_num, scale = \"row\",\n         border_color = \"white\",\n         display_numbers = matrix(ifelse(methylation_matrix_num &gt; .8 | methylation_matrix_num &lt; -.8, \"*\", \"\"), nrow = nrow(methylation_matrix_num)),\n         fontsize_number = 9, \n         number_color = \"grey30\")\n\n\n\n\n\n\n\n图 28: 使用原数据判断标注\n\n\n\n\n\n此热图使用未标准化的数据进行标注，结果不具有可比性，可能会导致观察者对不同样本之间的差异产生误解。未标准化的值可能因样本间的绝对数值差异而掩盖了真实的相对变化，从而降低了数据解读的准确性。\n\n\n使用经过标准化的数据\n\npheatmap(standardized_methylation_matrix, scale = \"none\", # 不需要再标准化\n         border_color = \"white\",\n         display_numbers = matrix(ifelse(standardized_methylation_matrix &gt; 1 | standardized_methylation_matrix &lt; -1, \"*\", \"\"), nrow = nrow(standardized_methylation_matrix)),\n         fontsize_number = 9, \n         number_color = \"grey30\") \n\n\n\n\n\n\n\n图 29: 使用经过标准化的数据\n\n\n\n\n\n在热图上标记可以直观地突出显示重要的数值或特征，使观察者更容易识别出显著的甲基化状态变化或异常值，从而为后续分析提供指导。这种方式增强了数据的可读性和解读性，帮助用户快速获取关键信息。\n\n\n\n4.5 调色板\npheatmap 包生成的热图同样可以用多种方式更改调色板： - R的原生调色板:terrain.color()，rainbow()，heat.colors()，topo.colors()，cm.colors() - 自定义调色板 - RColorBrewer 调色板\n\n# R 原生调色板\np13 &lt;- pheatmap(standardized_methylation_matrix, scale = \"none\",\n         border_color = \"white\",\n         color = colorRampPalette(c(\"navy\",\"white\",\"firebrick3\"))(100))\n\n# 自定义调色板\np14 &lt;- pheatmap(standardized_methylation_matrix, scale = \"none\",\n         border_color = \"white\",\n         color = cm.colors(100))\n\n# 使用 Rcolorbrewer\ncoul &lt;- colorRampPalette(brewer.pal(8, \"PiYG\"))(25)\np15 &lt;- pheatmap(standardized_methylation_matrix, scale = \"none\",\n         border_color = \"white\",\n         color = coul)\n\n\n\n\n\n\n\n图 30: 调色板\n\n\n\n\n\n\n\n\n\n\n\n图 31: 调色板\n\n\n\n\n\n\n\n\n\n\n\n图 32: 调色板\n\n\n\n\n\n这三个热图通过不同的调色板展示了 TCGA-CHOL 数据集中不同样本在甲基化状态上的差异，强调了调色板选择对视觉效果和数据解释的重要性。\n\n\n\n5. complexheatmap 热图\nComplexHeatmap包是基于grid包的，使用面向对象的方式实现热图及其组件，主要包含以下几个类：\n\nHeatmap：绘制单个热图（注意是大写）\nHeatmapList：绘制热图列表\nHeatmapAnnotation: 定义热图的行、列注释列表，可以是热图的一部分，也可以独立于热图\n\n以及一些内部类：\n\nSingleAnnotation：定义单个行、列注释，组成 HeatmapAnnotation 的列表元素\nColorMapping: 定义值到颜色的映射\nAnnotationFunction: 用于自定义注释图形\n\n\n5.1 基础热图\n\nHeatmap(standardized_methylation_matrix)\n\n\n\n\n\n\n\n图 33: Complexheatmap 基础热图\n\n\n\n\n\n此热图使用 ComplexHeatmap 包展示了在 TCGA-CHOL 数据集中不同样本在甲基化状态上的差异。\n\n\n5.2 调色板\n通常，我们绘制的矩阵都是连续型数据，因此颜色映射函数需要接受一个向量输入，并返回一个向量输出。\n该包的作者推荐使用他写的另一个包 circlize 的函数 colorRamp2() 来设置颜色映射，colorRamp2()函数接受两个参数，第一个参数用来设置值映射范围断点，第二个参数用于设置对应的颜色值\n在以下示例中，线性插值-2和2之间的值以获得相应的颜色，大于2的值都映射为红色，小于-2的值都映射为绿色。\n\ncol_fun &lt;- colorRamp2(c(-2, 0, 2), c(\"green\", \"white\", \"red\"))\nHeatmap(standardized_methylation_matrix, name = \"Standardized_Level\", col = col_fun)\n\n\n\n\n\n\n\n图 34: complexheatmap 调色板\n\n\n\n\n\n此热图使用 colorRamp2() 设置颜色映射，展示在 TCGA-CHOL 数据集中不同样本在甲基化状态上的差异。\n另外，使用 colorRamp2() 可以使得多个热图之间的颜色具有可比性，如下所示，在2个热图中，相同的颜色总是对应相同的数值：\n\np1 &lt;- Heatmap(standardized_methylation_matrix, name = \"Standardized_Level1\", col = col_fun)\np2 &lt;- Heatmap(standardized_methylation_matrix/2, name = \"Standardized_Level2\", col = col_fun)\np1 + p2 \n\n\n\n\n\n\n\n图 35: complexheatmap 使用 colorRamp2\n\n\n\n\n\n此热图使用 colorRamp2() 在相同尺度进行颜色比较，展示在 TCGA-CHOL 数据集中不同样本在甲基化状态上的差异。\n如果矩阵是连续的，也可以简单地提供颜色的向量，并且颜色将被线性插值。 但是此方法对异常值不友好，因为颜色映射是根据整个矩阵中的最小值和最大值来确定的，如果矩阵中有极端的异常值，会导致其他正常范围内的值的颜色变化不明显。\n\nHeatmap(standardized_methylation_matrix, name = \"Standardized_Level\", col = rev(cm.colors(10)), column_title = \"color vector for continuous matrix\")\n\n\n\n\n\n\n\n图 36: complexheatmap 使用颜色向量\n\n\n\n\n\n此热图展示了线性插值设置颜色映射，展示在 TCGA-CHOL 数据集中不同样本在甲基化状态上的差异。\n还可以可视化NA，使用na_col参数指定NA的颜色：\n\nstandardized_methylation_matrix_na &lt;- standardized_methylation_matrix\nna_index &lt;- sample(c(TRUE, FALSE), nrow(standardized_methylation_matrix)*ncol(standardized_methylation_matrix), replace = TRUE, prob = c(1, 9))\nstandardized_methylation_matrix_na[na_index] &lt;- NA\nHeatmap(standardized_methylation_matrix_na, name = \"matrix with na\", na_col = \"grey\", column_title = \"matrix with na\")\n\n\n\n\n\n\n\n图 37: complexheatmap 使用 na_col 参数\n\n\n\n\n\n此热图使用 na_col 参数指定NA的颜色为灰色，展示在 TCGA-CHOL 数据集中不同样本在甲基化状态上的差异。\n默认情况下，颜色的线性内插的方式是遵循 LAB 颜色空间的变化，还有其他的颜色空间可供选择，如：RGB，XYZ，sRGB\n\nf1 &lt;- colorRamp2(seq(min(standardized_methylation_matrix), max(standardized_methylation_matrix), length = 3), c(\"blue\", \"#EEEEEE\", \"red\"))\nf2 &lt;- colorRamp2(seq(min(standardized_methylation_matrix), max(standardized_methylation_matrix), length = 3), c(\"blue\", \"#EEEEEE\", \"red\"), space = \"RGB\")\n\np1 &lt;- Heatmap(standardized_methylation_matrix, name = \"Standardized_Level1\", col = f1, column_title = \"color space in LAB\")\np2 &lt;- Heatmap(standardized_methylation_matrix, name = \"Standardized_Level2\", col = f2, column_title = \"color space in RGB\")\np1 + p2\n\n\n\n\n\n\n\n图 38: complexheatmap 不同的线性插值\n\n\n\n\n\n此热图展示不同颜色空间中 TCGA-CHOL 数据集中不同样本在甲基化状态上的差异。\n\n\n5.3 边框和网格线\n热图的最外层边框使用 border 参数设置，网格线使用 rect_gp 参数来设置\nborder 参数可以是逻辑值或颜色值，而 rect_gp 参数需要接受一个 grid::gpar 对象\n\nHeatmap(standardized_methylation_matrix, name = \"Standardized_Level\", border = \"black\", col = col_fun, rect_gp = gpar(col = \"white\", lwd = 2) )\n\n\n\n\n\n\n\n图 39: 边框和网格线\n\n\n\n\n\n此热图修改了边框和网格线，展示在 TCGA-CHOL 数据集中不同样本在甲基化状态上的差异。\n\n\n5.4 聚类\n更改 cluster_rows 和 cluster_columns 参数修改聚类图\n\np1 &lt;- Heatmap(standardized_methylation_matrix, cluster_rows = F, cluster_columns = F)\np1\n\n\n\n\n\n\n\n图 40: complexheatmap 聚类\n\n\n\n\n\n此热图取消了聚类，展示在 TCGA-CHOL 数据集中不同样本在甲基化状态上的差异。\n\n\n5.5 注释条和多个热图\n注释条是热图的重要组成部分，ComplexHeatmap包提供灵活的注释条设置。注释条可以放在热图的上下左右四个位置，通过top_annotation、bottom_annotation、left_annotation、right_annotation设置，所有的注释条都是通过HeatmapAnnotation()函数完成的（还有一个rowAnnotation()，但是可以通过设置HeatmapAnnotation(..., which = \"row\")实现，可以看做是变体）。\n\np1 &lt;- rowAnnotation(\n  \"Average Methylation\" = anno_barplot(\n    rowMeans(standardized_methylation_matrix), \n    gp = gpar(fill = \"blue\"), \n    width = unit(4, \"cm\"),\n    axis_param = list(at = pretty(rowMeans(standardized_methylation_matrix)), \n                      labels = format(pretty(rowMeans(standardized_methylation_matrix)), nsmall = 1, digits = 1))\n  )\n)\n\np2 &lt;- Heatmap(standardized_methylation_matrix, \n               name = \"Standardized Methylation Levels\", \n               col = f2, \n               row_km = 2,\n               column_names_gp = gpar(fontsize = 8))  # Based on row clustering\n\np1 + p2\n\n\n\n\n\n\n\n图 41: complexheatmap 多个热图\n\n\n\n\n\n此条形图为热图的注释条，显示每个位点的平均甲基化值。\nComplexHeatmap包的一大特色就是可以同时绘制多个热图，下图为水平排列的热图，垂直排列的热图原理与此类似。水平排列的热图要求具有相同的行。\n热图和条形图组合，显示了TCGA-CHOL 数据集中不同样本在甲基化状态上的差异和每个位点的平均甲基化值。",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Heatmap"
    ]
  },
  {
    "objectID": "Correlation/Heatmap.html#应用场景",
    "href": "Correlation/Heatmap.html#应用场景",
    "title": "热图",
    "section": "应用场景",
    "text": "应用场景\n\n1. 基础热图\n\n\n\n\n\n\nYang, M., Liu, B. et al.(2013)\n\n\n\n\n图 42: 基础热图应用\n\n\n\n52 名健康人的 TEC 匹配热图。（a）原始热图 （b）二进制热图。 [1]\n\n\n2. 带有颜色标记的热图\n\n\n\n\n\n\nKey, M. (2012)\n\n\n\n\n图 43: 带有颜色标记的热图应用\n\n\n\n对标签进行分组。可以使用所有热图函数标记行和列，但实现方式各不相同。heatmap （a） 和 heatmap.2 （b） 函数仅限于显示单个颜色条。heatmap.plus （c） 函数可以显示彩条矩阵。heatmap_plus （d） 函数可以显示二进制变量的数据帧。虽然 heatmap.2 和 heatmap.plus 可以生成矩形图像，但 heatmap 和 heatmap_plus 都会生成方形图像作为输出。 [2]\n\n\n3. 比较热图\n\n\n\n\n\n\nHoggard, T. et al.(2016)\n\n\n\n\n图 44: 比较热图应用\n\n\n\n比较 miniARS 实验以消除与 miniARS 染色体片段相关的分区和复制功能的歧义。（A） 将在 Cen-（含着丝粒）miniARS 或 Acen-（无着丝粒）miniARS 实验中耗尽的 MiniARS317 片段与在这些实验中富集的片段进行比较。（B） 共享 miniARS 数据集中位于给定竞争适应性十分位数的片段（即 Acen-miniARS 库和 Cen-miniARS 库中同时存在的片段）在此热图中表示。该热图图分为 100 个部分，每个部分代表 Acen-miniARS 和 Cen-miniARS 实验中竞争性适应度十分位数的不同组合，如图所示。左下角包含在 Acen- 和 Cen-miniARS 比赛中竞争适应性较低的片段，因此被确定为相对于种群中的其他片段具有较弱的复制和分区能力（分区“-”;复制 “−”）。在热图图的这一部分，有 288 个片段代表 62 个原点。右下角包含在 Acen-miniARS 库中具有高竞争适应性但在 Cen-miniARS 库中具有低竞争适应性的片段，因此被确定具有相对较强的分区能力但较弱的复制能力（分区“+”;复制 “−”）。在热图图的这一部分，有 103 个片段代表 32 个来源。左上角包含的片段在 Acen-miniARS 库中表现为低竞争适应性，但在 Cen-miniARS 库中表现为高竞争适应性，因此被确定具有相对较弱的分区能力但具有较强的复制能力（分区“−”;复制 “+”） 。在热图图的这一部分，有 105 个片段代表 33 个起点。（C） 对 B 中片段的组合分析，旨在定义对最大化分区能力至关重要的区域 [第一对（从上到上）和第四对热图] 与对最大化复制能力更关键的区域（第二对和第三对热图）。（D） 与 B 中的热图图相同，但它们仅包含来自指示 ARS 的 miniARS 片段。有关更多详细信息，请参阅正文。ARS，自主复制序列;FKH，叉头;ORC， 原点识别复合物;RAP1，Rap1 蛋白结合位点。 [3]",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Heatmap"
    ]
  },
  {
    "objectID": "Correlation/Heatmap.html#参考文献",
    "href": "Correlation/Heatmap.html#参考文献",
    "title": "热图",
    "section": "参考文献",
    "text": "参考文献\n\nYang, M., Liu, B., Zhao, M., Li, F., Wang, G., & Zhou, F. (2013). Normalizing electrocardiograms of both healthy persons and cardiovascular disease patients for biometric authentication. PLoS One, 8(8), e71523. https://doi.org/10.1371/journal.pone.0071523\n\nKey, M. (2012). A tutorial in displaying mass spectrometry-based proteomic data using heat maps. BMC Bioinformatics, 13(Suppl 16), S10. https://doi.org/10.1186/1471-2105-13-S16-S10\n\nHoggard, T., Liachko, I., Burt, C., Meikle, T., Jiang, K., Craciun, G., Dunham, M. J., & Fox, C. A. (2016). High throughput analyses of budding yeast ARSs reveal new DNA elements capable of conferring centromere-independent plasmid propagation. G3 (Bethesda), 6(4), 993–1012. https://doi.org/10.1534/g3.116.027904\n\nWickham, H. (2016). ggplot2: Elegant graphics for data analysis. Springer. https://r-graph-gallery.com/ggplot2-package.html\n\nRudis, B. (2020). hrbrthemes: Additional themes and theme components for ‘ggplot2’. https://cran.r-project.org/package=hrbrthemes\n\nWickham, H., François, R., Henry, L., & Müller, K. (2021). dplyr: A grammar of data manipulation. https://cran.r-project.org/package=dplyr\n\nWickham, H., & Henry, L. (2021). tidyr: Tidy messy data. https://cran.r-project.org/package=tidyr\n\nGarnier, S. (2018). viridis: Default color maps from ‘matplotlib’. https://cran.r-project.org/package=viridis\n\nHenry, L. (2022). tibble: Simple data frames. https://cran.r-project.org/package=tibble\n\nUrbanek, S. (2021). htmlwidgets: HTML widgets for R. https://cran.r-project.org/package=htmlwidgets\n\nNeuwirth, E. (2014). RColorBrewer: ColorBrewer palettes. https://cran.r-project.org/package=RColorBrewer\n\nWinston, L., & Hsu, T. (2021). plotly: Create interactive web graphics via ‘plotly.js’. https://cran.r-project.org/package=plotly\n\nD3heatmap: Interactive heatmaps using ‘d3.js’. https://cran.r-project.org/package=d3heatmap\n\nGang, C. (2020). heatmaply: Interactive heat maps for R. https://cran.r-project.org/package=heatmaply\n\nBecker, R. A., Wilks, A. R., & Brownrigg, R. (2021). lattice: The lattice package for R. https://cran.r-project.org/package=lattice\n\nAuguie, B. (2017). gridExtra: Miscellaneous Functions for “Grid” Graphics. https://cran.r-project.org/package=gridExtra",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Heatmap"
    ]
  },
  {
    "objectID": "Correlation/TernaryPlot.html",
    "href": "Correlation/TernaryPlot.html",
    "title": "三元图",
    "section": "",
    "text": "三元图是一种用于显示三个变量之间比例关系的图表。这三个变量通常代表某个成分（例如化学组成、物种比例、营养结构等），它们的和为常数，最常见的是1或100%。三元图使用等边三角形来表示这三个变量之间的比例关系，每个点的位置反映这三个变量的相对比例。这类图表常用于观察不同处理组之间成分分布的差异，检查样本是否在某些区域聚集（成分偏好），比较实验处理对成分比例的影响等。",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "TernaryPlot"
    ]
  },
  {
    "objectID": "Correlation/TernaryPlot.html#示例",
    "href": "Correlation/TernaryPlot.html#示例",
    "title": "三元图",
    "section": "示例",
    "text": "示例\n\n\n\n\n\n该图表显示了土壤植物连续体中玉米细菌群落的组成。",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "TernaryPlot"
    ]
  },
  {
    "objectID": "Correlation/TernaryPlot.html#环境配置",
    "href": "Correlation/TernaryPlot.html#环境配置",
    "title": "三元图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：ggtern,ggthemes\n\n\n# 安装包\nif (!requireNamespace(\"ggtern\", quietly = TRUE)) {\n  install.packages(\"ggtern\", type = \"source\")\n}\nif (!requireNamespace(\"ggthemes\", quietly = TRUE)) {\n  install.packages(\"ggthemes\")\n}\n\n# 加载包\nlibrary(ggtern)\nlibrary(ggthemes)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "TernaryPlot"
    ]
  },
  {
    "objectID": "Correlation/TernaryPlot.html#数据准备",
    "href": "Correlation/TernaryPlot.html#数据准备",
    "title": "三元图",
    "section": "数据准备",
    "text": "数据准备\n数据来源于论文[1]，以下是数据代码链接https://github.com/PlantNutrition/Liyu。\n\n# 读取数据\ndata &lt;- read.table(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/Tern_data.txt\", header=T, row.names=1, sep=\"\\t\", comment.char = \"\")\n# 查看数据集\nhead(data[,1:5])\n\n                CK      NPK     NPKM       size  Kingdom\nOTU_1     4.58e-04 4.58e-04 0.000534 0.04832414 Bacteria\nOTU_10    2.99e-04 2.33e-04 0.000229 0.02537028 Bacteria\nOTU_10588 7.93e-05 2.47e-04 0.000171 0.01656730 Bacteria\nOTU_10916 1.08e-05 9.01e-06 0.000450 0.01567026 Bacteria\nOTU_11360 3.18e-03 3.17e-03 0.002610 0.29890666 Bacteria\nOTU_11839 2.22e-04 4.11e-04 0.000253 0.02951640 Bacteria",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "TernaryPlot"
    ]
  },
  {
    "objectID": "Correlation/TernaryPlot.html#可视化",
    "href": "Correlation/TernaryPlot.html#可视化",
    "title": "三元图",
    "section": "可视化",
    "text": "可视化\n\n1. 基础三元图\n\n# 基础三元图\np1_1 &lt;- ggtern(data=data, aes(x=CK, y=NPK, z=NPKM)) +\n  geom_mask() +\n  geom_point(aes(size=size,color=Genus),alpha=0.8)\np1_1\n\n\n\n\n\n\n\n图 1: 基础三元图\n\n\n\n展示了三种施肥处理下木质部汁液中 OTU 的三元图。每个点的大小代表 OTU 的相对丰度。\n\n\n2. 改变主题\n\n# 改变主题\np2_1 &lt;- ggtern(data=data, aes(x=CK, y=NPK, z=NPKM)) +\n  geom_mask() +\n  geom_point(aes(size=size,color=Genus),alpha=0.8) +\n  theme_tropical()\np2_1\n\n\n\n\n\n\n\n图 2: 改变主题\n\n\n\n\n\n\n\n\n\n提示\n\n\n\nR 语言中的四种不同主题\ntheme_minimal：\n\n简单的白色背景，保留坐标轴和浅灰色网格线。不添加背景色和边框等不必要的装饰，专注于数据本身。默认情况下，图例背景会被移除，图例标题和标签会直接显示在图表上。\n\ntheme_bw：\n\n黑白高对比度主题，白色背景搭配深灰色网格线/边框。网格线更加突出，适合黑白打印或强调结构化布局。比默认主题 theme_grey 更清晰，没有渐变灰色背景。\n\ntheme_void：\n\n完全空白背景，移除所有非数据元素，例如坐标轴、网格线、标签、标题等。仅保留点、线和条形等几何对象，适用于高度可定制的设计。\n\ntheme_tropical：\n\n非 ggplot2 内置主题需要通过 ggthemes 等扩展包实现。色彩鲜艳，常用明亮的背景，并搭配粉色、蓝色和绿色等对比元素。风格活泼，适合非正式场合。\n\n\n\n\np2_2 &lt;- ggtern(data=data, aes(x=CK, y=NPK, z=NPKM)) +\n  geom_mask() +\n  geom_point(aes(size=size,color=Genus),alpha=0.8) +\n  theme_bw()\np2_2\n\n\n\n\n\n\n\n图 3: 改变主题\n\n\n\n\n\n3. 美化绘图\n\np3_1 &lt;- ggtern(data=data, aes(x=CK, y=NPK, z=NPKM)) +\n  geom_mask() +\n  geom_point(aes(size=size,color=Genus),alpha=0.8)+\n  scale_size(range=c(0,10))+\n  scale_color_manual(values=c('#E31A1C','#228B22','#1F78B4','#FDB462','#8B658B','#4876FF','#00BFFF','#EE82EE','#8B8682','#CDC9C9'),limits=c('Klebsiella','Pseudomonas','Enterobacteriaceae_unclassified','Rosenbergiella','Oxalobacteraceae_unclassified','Sphingobacterium','Lactococcus','Erwinia','Others','NotSig'))+\n  guides(size=\"none\")+theme_bw()+\n  theme(axis.text=element_blank(),axis.ticks=element_blank())+\n  theme_showarrows()\np3_1\n\n\n\n\n\n\n\n图 4: 美化绘图\n\n\n\n\n\n\n\n\n\n提示\n\n\n\n关键参数：调整参数\n\ngeom_mask：显示边界点\nscale_color_manual：填充颜色\ntheme_showarrows：添加箭头",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "TernaryPlot"
    ]
  },
  {
    "objectID": "Correlation/TernaryPlot.html#应用场景",
    "href": "Correlation/TernaryPlot.html#应用场景",
    "title": "三元图",
    "section": "应用场景",
    "text": "应用场景\n\n\n\n\n\n\n图 5: 显示细胞亚群的转录组学\n\n\n\n三个角代表上皮细胞的三个亚群，分别对应基底细胞、管腔祖细胞（LP）和成熟管腔细胞（ML）。从图中可以看出不同阶段的细胞类型组成和分化情况，以及对应簇的亚群状态。",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "TernaryPlot"
    ]
  },
  {
    "objectID": "Correlation/TernaryPlot.html#参考文献",
    "href": "Correlation/TernaryPlot.html#参考文献",
    "title": "三元图",
    "section": "参考文献",
    "text": "参考文献\n[1] Zhang L, Zhang M, Huang S, Li L, Gao Q, Wang Y, Zhang S, Huang S, Yuan L, Wen Y, Liu K, Yu X, Li D, Zhang L, Xu X, Wei H, He P, Zhou W, Philippot L, Ai C. A highly conserved core bacterial microbiota with nitrogen-fixation capacity inhabits the xylem sap in maize plants. Nat Commun. 2022 Jun 11;13(1):3361. doi: 10.1038/s41467-022-31113-w. PMID: 35688828; PMCID: PMC9187771.\n[2] Pal B, Chen Y, Milevskiy MJG, Vaillant F, Prokopuk L, Dawson CA, Capaldo BD, Song X, Jackling F, Timpson P, Lindeman GJ, Smyth GK, Visvader JE. Single cell transcriptome atlas of mouse mammary epithelial cells across development. Breast Cancer Res. 2021 Jun 29;23(1):69. doi: 10.1186/s13058-021-01445-4. PMID: 34187545; PMCID: PMC8243869.\n[3] Hamilton, N. E., & Ferry, M. (2018). ggtern: Ternary Diagrams Using ggplot2 [R package]. https://CRAN.R-project.org/package=ggtern\n[4] Arnold, J. (2024). ggthemes: Extra Themes, Scales and Geoms for ‘ggplot2’ [R package]. https://CRAN.R-project.org/package=ggthemes",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "TernaryPlot"
    ]
  },
  {
    "objectID": "Correlation/Density2D.html",
    "href": "Correlation/Density2D.html",
    "title": "二维密度图",
    "section": "",
    "text": "二维密度图可以表示两个数值变量组合的分布，通过颜色渐变（或等高线高低）表示区域内观测值的数量。既可以识别数据集中趋势，也可以分析两个变量之间是否存在某种关系等。散点图在展示大型数据集时可能变得难以解读，因为点会重叠，无法单独区分，此时可以使用二维密度图。",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "2D Density"
    ]
  },
  {
    "objectID": "Correlation/Density2D.html#示例",
    "href": "Correlation/Density2D.html#示例",
    "title": "二维密度图",
    "section": "示例",
    "text": "示例\n\n\n\n\n\n此图展示了TP53和MDM2基因表达值之间的二维核密度分布。通过栅格图的填充颜色，可以直观地看到在不同TP53和MDM2值组合下，样本的密度（即样本数量）。颜色越深表示该区域的样本密度越低，而颜色较浅表示样本密度较高。这种可视化有助于识别基因表达的模式和潜在的相关性。",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "2D Density"
    ]
  },
  {
    "objectID": "Correlation/Density2D.html#环境配置",
    "href": "Correlation/Density2D.html#环境配置",
    "title": "二维密度图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：ggplot2, RColorBrewer, hexbin, MASS, plotly, mvtnorm, patchwork\n\n\n# 安装包\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\nif (!requireNamespace(\"hexbin\", quietly = TRUE)) {\n  install.packages(\"hexbin\")\n}\nif (!requireNamespace(\"MASS\", quietly = TRUE)) {\n  install.packages(\"MASS\")\n}\nif (!requireNamespace(\"plotly\", quietly = TRUE)) {\n  install.packages(\"plotly\")\n}\nif (!requireNamespace(\"mvtnorm\", quietly = TRUE)) {\n  install.packages(\"mvtnorm\")\n}\nif (!requireNamespace(\"patchwork\", quietly = TRUE)) {\n  install.packages(\"patchwork\")\n}\n\n# 加载包\nlibrary(ggplot2)\nlibrary(RColorBrewer)\nlibrary(hexbin)\nlibrary(MASS)\nlibrary(plotly)\nlibrary(mvtnorm)\nlibrary(patchwork)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package      * version date (UTC) lib source\n ggplot2      * 4.0.1   2025-11-14 [1] RSPM\n hexbin       * 1.28.5  2024-11-13 [1] RSPM\n MASS         * 7.3-65  2025-02-28 [3] CRAN (R 4.5.2)\n mvtnorm      * 1.3-3   2025-01-10 [1] RSPM\n patchwork    * 1.3.2   2025-08-25 [1] RSPM\n plotly       * 4.11.0  2025-06-19 [1] RSPM\n RColorBrewer * 1.1-3   2022-04-03 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "2D Density"
    ]
  },
  {
    "objectID": "Correlation/Density2D.html#数据准备",
    "href": "Correlation/Density2D.html#数据准备",
    "title": "二维密度图",
    "section": "数据准备",
    "text": "数据准备\n使用 R 内置数据集 mtcars和 CSC Xena DATASETS 的 TCGA-BRCA.star_counts.tsv 数据集。\n\n# mtcars\ndata_mtcars &lt;- mtcars[, c(\"mpg\", \"hp\")]\n\n# TCGA-BRCA.star_counts\ntcga_raw &lt;- readr::read_tsv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/TCGA-BRCA.star_counts.tsv\")\n\ntcga_tp53_mdm2 &lt;- tcga_raw[tcga_raw$Ensembl_ID %in% c(\"ENSG00000141510.18\", \"ENSG00000131747.15\"), ]\nTP53_values &lt;- tcga_tp53_mdm2[1, -1]\nMDM2_values &lt;- tcga_tp53_mdm2[2, -1]\n\ndata_tcga &lt;- data.frame(TP53 = as.numeric(TP53_values),\n                        MDM2 = as.numeric(MDM2_values))",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "2D Density"
    ]
  },
  {
    "objectID": "Correlation/Density2D.html#可视化",
    "href": "Correlation/Density2D.html#可视化",
    "title": "二维密度图",
    "section": "可视化",
    "text": "可视化\n\n1. 二维直方图\n二维直方图用于分析两个变量之间的关系，绘图区域被划分为多个方块。使用geom_bin_2d()绘制二维直方图。此函数提供了bins参数来控制要显示的箱数。bins决定每一个箱体包含数据的多少，改变bins会对图形造成很大的影响，也会影响到想要表达的信息。\n\n# 二维直方图\np &lt;- ggplot(data_tcga, aes(x = TP53, y = MDM2)) +\n  geom_bin2d() +\n  labs(fill = \"Gene_expression\\n(STAR_counts)\") + \n  theme_bw()\n\np\n\n\n\n\n\n\n\n图 1: 二维直方图\n\n\n\n\n\n此图为TP53和MDM2基因表达的二维直方图，通过颜色深浅表示每个区域的数据点数量，能够清晰地显示数据分布和密度。颜色越深表示该区域的样本密度越低，而颜色较浅表示样本密度较高。\n\n# 修改bins + 调色板\np1 &lt;- \n  ggplot(data_tcga, aes(x = TP53, y = MDM2)) +\n  geom_bin2d(bins = 40) +\n  scale_fill_continuous(type = \"viridis\") +\n  labs(fill = \"Gene_expression\\n(STAR_counts)\") + \n  theme_bw()\n\n# 去除网格线 + 自定义颜色\np2 &lt;- \n  ggplot(data_tcga, aes(x = TP53, y = MDM2)) +\n  geom_bin2d(bins = 40) +\n  scale_fill_gradient(low = \"blue\", high = \"red\") + \n  labs(fill = \"Gene_expression\\n(STAR_counts)\") + \n  theme_bw() +\n  theme(panel.grid.major = element_blank(), \n        panel.grid.minor = element_blank())\np1+p2\n\n\n\n\n\n\n\n图 2: 改变颜色\n\n\n\n\n\n此图为TP53和MDM2基因表达的二维直方图，修改了bins参数和颜色使得图形更加美观，更能传递有效信息。左图随着数据增大从紫色渐变为黄色，右图由蓝色渐变为红色。\n\n\n2. 交互二维直方图\n使用mvtnorm包和plotly包绘制可交互二维直方图。\n\nfig &lt;- plot_ly(data_tcga, x = ~TP53, y = ~MDM2)\nfig2 &lt;- subplot(\n  fig %&gt;% add_histogram2d()\n)\n\nfig2\n\n\n\n\n\n\n\n图 3: 交互\n\n\n\n\n此图为 TP53 和 MDM2 的二维直方图，随着数据增大格子从紫色渐变为黄色。交互式图形允许用户悬停在不同区域以查看具体的密度值和数量，方便获取更详细的信息。\n使用 R 自带的数据集 mtcars。\n\n# 改变bins + 调色板\nfig &lt;- plot_ly(data_mtcars, x = ~mpg, y = ~hp)\nfig2 &lt;- fig %&gt;% add_histogram2d(colorscale = \"Blues\", nbinsx = 5, nbinsy = 6)\n\nfig2\n\n\n\n\n\n\n\n图 4: 使用 R 自带的数据集 mtcars\n\n\n\n\n此图使用 mtcars 数据集的 mpg（每加仑英里数）和 hp（马力）来绘制二维直方图，随着数据增大蓝色逐渐变浅。交互式图形允许用户悬停在不同区域以查看具体的密度值和数量，方便获取更详细的信息。\n\n\n3. 六边形箱图\n六边形箱图是一种可视化二维数据分布的图表类型。它将数据按照坐标轴划分为多个小六边形区域，并根据每个区域内数据点的数量进行不同的着色，以展示数据分布情况。使用geom_hex()函数绘制六边形箱图。\n\n# 六边形箱图\np &lt;- \n  ggplot(data_tcga, aes(x = TP53, y = MDM2)) +\n  geom_hex() +\n  labs(fill = \"Gene_expression\\n(STAR_counts)\") + \n  theme_bw()\np\n\n\n\n\n\n\n\n图 5: 六边形箱图\n\n\n\n\n\n此六边形图展示了TP53和MDM2基因表达的关系。颜色越深表示该区域的样本密度越低，而颜色较浅表示样本密度较高。\n\n# 修改bins + 调色板\np &lt;- \n  ggplot(data_tcga, aes(x = TP53, y = MDM2)) +\n  geom_hex(bins = 40) +\n  scale_fill_continuous(type = \"viridis\") +\n  labs(fill = \"Gene_expression\\n(STAR_counts)\") + \n  theme_bw()\np\n\n\n\n\n\n\n\n图 6: 修改bins和调色板\n\n\n\n\n\n此六边形图展示了TP53和MDM2基因表达的关系，修改了bins参数和颜色使得图形更加美观，更能传递有效信息。\n使用hexbin包绘制六边形箱图。\n\n# 使用`hexbin`包绘制六边形箱图\nbin &lt;- hexbin(TP53_values, MDM2_values, xbins=40)\nmy_colors = colorRampPalette(rev(brewer.pal(11,'Spectral')))\npar(mar = c(0, 0, 0, 10), pty = \"s\")\nplot(bin, main=\"\" , colramp = my_colors , legend = FALSE)\n\n\n\n\n\n\n\n图 7: 使用hexbin包绘制六边形箱图\n\n\n\n\n\n此六边形图使用hexbin包，展示了TP53和MDM2基因表达的关系。使用调色板给不同数值区间赋予不同的颜色，使图形更加美观。\n\n\n4. 二维密度图\n二维密度图是一种用于可视化两个变量之间的分布和关系的图表类型。它通过在二维平面上绘制密度等高线或填充颜色来表示数据点的分布情况。使用geom_density_2d或stat_density_2d绘制二维密度图。\n\n# 仅显示轮廓\np1 &lt;- \n  ggplot(data_tcga, aes(x = TP53, y = MDM2)) +\n  geom_density_2d()\n\n# 仅显示区域颜色\np2 &lt;- \n  ggplot(data_tcga, aes(x = TP53, y = MDM2)) +\n  stat_density_2d(aes(fill = ..level..), geom = \"polygon\")\n\n# 轮廓＋区域颜色\np3 &lt;- \n  ggplot(data_tcga, aes(x = TP53, y = MDM2)) +\n  stat_density_2d(aes(fill = ..level..), geom = \"polygon\", colour=\"white\")\n\np1+p2+p3\n\n\n\n\n\n\n\n图 8: 二维密度图\n\n\n\n\n\n此对比图提供了对TP53和MDM2基因表达值的多种多层次理解，便于快速识别数据的模式和趋势。二维等密度线可以帮助识别不同密度区域。通过颜色深浅表示基因的表达量，颜色越浅表示密度越高，从而直观展示数据的分布情况。\n\n# 栅格图\np &lt;- \n  ggplot(data_tcga, aes(x = TP53, y = MDM2)) +\n  stat_density_2d(aes(fill = ..density..), geom = \"raster\", contour = FALSE) +\n  scale_x_continuous(expand = c(0, 0)) +\n  scale_y_continuous(expand = c(0, 0)) +\n  theme(legend.position='none')\np\n\n\n\n\n\n\n\n图 9: 二维核密度图\n\n\n\n\n\n此图展示了TP53和MDM2基因表达值之间的二维核密度分布，通过颜色深浅表示基因的表达量，颜色越浅表示密度越高。\n\n\n5. 自定义调色板\n二维直方图、六边形箱图和二维密度图都可以自定义图表的颜色。可以使用scale_fill_distiller()函数定义颜色。\n\n# 自定义调色板\np1 &lt;- \n  ggplot(data_tcga, aes(x = TP53, y = MDM2)) +\n  stat_density_2d(aes(fill = ..density..), geom = \"raster\", contour = FALSE) +\n  scale_fill_distiller(palette=4, direction=-1) +\n  scale_x_continuous(expand = c(0, 0)) +\n  scale_y_continuous(expand = c(0, 0)) +\n  theme(legend.position='none')\n\np2 &lt;- \n  ggplot(data_tcga, aes(x = TP53, y = MDM2)) +\n  stat_density_2d(aes(fill = ..density..), geom = \"raster\", contour = FALSE) +\n  scale_fill_distiller(palette=4, direction=1) + #更改调色板的方向从第一个到最后一个\n  scale_x_continuous(expand = c(0, 0)) +\n  scale_y_continuous(expand = c(0, 0)) +\n  theme(legend.position='none')\n\n# 通过调色板名字使用调色板\np3 &lt;- \n  ggplot(data_tcga, aes(x = TP53, y = MDM2)) +\n  stat_density_2d(aes(fill = ..density..), geom = \"raster\", contour = FALSE) +\n  scale_fill_distiller(palette= \"Spectral\", direction=1) +\n  scale_x_continuous(expand = c(0, 0)) +\n  scale_y_continuous(expand = c(0, 0)) +\n  theme(legend.position='none')\n\np1+p2+p3\n\n\n\n\n\n\n\n图 10: 自定义调色板\n\n\n\n\n\n此图对比了不同调色板设置下的TP53和MDM2基因表达的二维密度分布，通过不同调色板的比较，可以观察到密度图在可视化表达上的差异，帮助选择更适合展示数据特征的颜色方案。\n\n\n6. 三维密度图\n可以将散点图数据变换成网格，计算网格每个位置上的数据点数量，然后不用渐变颜色来表示这个数量，而是用第三个维度来表示某些区域的密度更高。\n\n# 计算 KDE\nkd &lt;- with(data_tcga, MASS::kde2d(TP53, MDM2, n = 50))\n\nplot_ly(x = kd$x, y = kd$y, z = kd$z) %&gt;%\n  add_surface() %&gt;%\n  layout(scene = list(xaxis = list(title = \"TP53\"),\n                      yaxis = list(title = \"MDM2\"),\n                      zaxis = list(title = \"Density\")))\n\n\n\n\n\n\n\n图 11: 三维密度图\n\n\n\n\n此图展示了TP53和MDM2基因表达的三维核密度图（KDE），使用plotly包可以实现交互操作，用户可以旋转和缩放图形，深入分析数据，更全面地理解复杂数据集中的变量关系。颜色和高度同时表示数据的大小。",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "2D Density"
    ]
  },
  {
    "objectID": "Correlation/Density2D.html#应用场景",
    "href": "Correlation/Density2D.html#应用场景",
    "title": "二维密度图",
    "section": "应用场景",
    "text": "应用场景\n\n\n\n\n\n\n图 12: 二维密度图应用\n\n\n\n在 0.5 秒（左上）、5 秒（右上）和 10 秒（下）接触时间后打破甘露糖涂层的 AFM 悬臂和 A. castellanii 细胞之间的接触时，斜率与最后一次破裂事件位置的二维密度图。 [1]\n\n\n\n\n\n\n图 13: 二维密度图应用\n\n\n\n根据 LFP 信号的主成分分析对振荡模式进行统计分类的技术示例。(A) 二维大脑状态图。三个主要簇分别对应于清醒状态 (WK)、慢波睡眠 (SWS) 和快速眼动 (REM) 状态。(B) SI LFP 通道的功率谱图显示了大脑状态事件转换过程中信号功率振荡的不同模式。(C) 从图 A 中所示的二维状态获得的大脑状态睡眠图。编码了六种不同的大脑状态：WK、SWS、REM、胡须抽搐 (WT)、M（未定义运动）和 U（过渡状态）。(D) 从散点图 [例如 (A)] 计算出的密度图，显示了保守的簇拓扑和各种大脑状态的相对丰度。比例从深蓝色（低密度）到红色（高密度）。 (E) 速度图表示二维 StateMap 中自发轨迹的平均值。在三个主要簇（WK、SWS 和 REM）中可以观察到平稳性（低速），而在从一个簇到另一个簇的转换过程中达到最大速度。SNI 损伤后，WK 和 SWS 状态发作之间的速度增加，这也表明神经性疼痛期间 WK/SWS 转换增加。 [2]\n\n\n\n\n\n\n图 14: 二维密度图应用\n\n\n\n生态型 La-0 和 Fr.2 中变量 𝐼𝑅 和 𝐿⁢𝐶𝑅 之间的依赖关系。 (A) 𝐼𝑅 与 𝐿⁢𝐶𝑅 的二维核密度图表明，大多数 𝐿⁢𝐶𝑅 值位于垂直线 𝐼𝑅=0 周围的窄带中。 (B) 3D 核密度图表明，例如，以高联合概率𝑃(−1≤𝐼𝑅≤1,0≤𝐿⁢𝐶𝑅≤25)（由区间 −2≤𝐼𝑅≤2 和 0≤𝐿⁢𝐶𝑅≤25 形成的方底棱柱的体积，并被覆盖红色到黄色区域的表面截断）观察到值为 −2≤𝐼𝑅≤2 和 0≤𝐿⁢𝐶𝑅≤25 的基因组区域 R。对于这些区域，观察到 SNP 的概率很低（根据方程 (4) 和 (5)，并且支持区域方程 (3) 中 SNP 的归一化计数值很低。在另一个示例中，以低联合概率𝑃(−1≤𝐼𝑅≤1,150≤𝐿⁢𝐶𝑅≤200)（对应于在区间 −1≤𝐼𝑅≤1 和 150≤𝐿⁢𝐶𝑅≤200 内被方底表面截断的棱柱体积），观察到值为 −1≤𝐼𝑅≤1 和 150≤𝐿⁢𝐶𝑅≤200 的基因组区域 R；（C） Farlie–Gumbel–Morgenstern copula 是根据 𝐿⁢𝐶𝑅（Weibull PDF）和 𝐼𝑅（Skew–Laplace PDF）估计的边际分布的非线性拟合构建的。Farlie–Gumbel–Morgenstern copula 分布表明变量 𝐼𝑅 和 𝐿⁢𝐶𝑅 之间存在结构依赖性，该分布以可接受的方式描述了图 B 中显示的经验行为。 [3]",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "2D Density"
    ]
  },
  {
    "objectID": "Correlation/Density2D.html#参考文献",
    "href": "Correlation/Density2D.html#参考文献",
    "title": "二维密度图",
    "section": "参考文献",
    "text": "参考文献\n[1] Cardoso-Cruz H, Sameshima K, Lima D, Galhardo V. Dynamics of Circadian Thalamocortical Flow of Information during a Peripheral Neuropathic Pain Condition. Front Integr Neurosci. 2011 Aug 23;5:43. doi: 10.3389/fnint.2011.00043. PMID: 22007162; PMCID: PMC3188809.\n[2] Rey SA, Smith CA, Fowler MW, Crawford F, Burden JJ, Staras K. Ultrastructural and functional fate of recycled vesicles in hippocampal synapses. Nat Commun. 2015 Aug 21;6:8043. doi: 10.1038/ncomms9043. PMID: 26292808; PMCID: PMC4560786.\n[3] Sanchez R, Mackenzie SA. Genome-Wide Discriminatory Information Patterns of Cytosine DNA Methylation. Int J Mol Sci. 2016 Jun 17;17(6):938. doi: 10.3390/ijms17060938. PMID: 27322251; PMCID: PMC4926471.\n[4] Rudis, B. (2020). hrbrthemes: Additional Themes and Theme Components for ‘ggplot2’. https://cran.r-project.org/package=hrbrthemes\n[5] Neuwirth, E. (2014). RColorBrewer: ColorBrewer Palettes. https://cran.r-project.org/package=RColorBrewer\n[6] Ellison, A. M. (2019). hexbin: Hexagonal Binning for Visualization of Two-Dimensional Data. https://cran.r-project.org/package=hexbin\n[7] Venables, W. N., & Ripley, B. D. (2002). MASS: Modern Applied Statistics with S. https://cran.r-project.org/package=MASS\n[8] Sievert, C. (2023). plotly: Create Interactive Web Graphics via ‘plotly.js’. https://cran.r-project.org/package=plotly\n[9] Wickham, H. (2016). ggplot2: Elegant Graphics for Data Analysis. Springer. https://ggplot2.tidyverse.org\n[10] Genz, A., & Bretz, F. (2009). mvtnorm: Multivariate Normal and T Distributions. https://cran.r-project.org/package=mvtnorm",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "2D Density"
    ]
  },
  {
    "objectID": "Correlation/Scatter.html",
    "href": "Correlation/Scatter.html",
    "title": "散点图",
    "section": "",
    "text": "散点图是一种基础的可视化图表，用于表示因变量随自变量而变化的大致趋势。",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Scatter Plot"
    ]
  },
  {
    "objectID": "Correlation/Scatter.html#示例",
    "href": "Correlation/Scatter.html#示例",
    "title": "散点图",
    "section": "示例",
    "text": "示例\n\n\n\n\n\n以上基础散点图可以直观地表示因变量y随着自变量x变化的一个大致趋势，可以看出，y大致随着x的增加而增大。",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Scatter Plot"
    ]
  },
  {
    "objectID": "Correlation/Scatter.html#环境配置",
    "href": "Correlation/Scatter.html#环境配置",
    "title": "散点图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：ggplot2, ggpmisc, ggpubr, ggExtra, geomtextpath, plotly, dplyr\n\n\n# 安装包\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"ggpmisc\", quietly = TRUE)) {\n  install.packages(\"ggpmisc\")\n}\nif (!requireNamespace(\"ggpubr\", quietly = TRUE)) {\n  install.packages(\"ggpubr\")\n}\nif (!requireNamespace(\"ggExtra\", quietly = TRUE)) {\n  install.packages(\"ggExtra\")\n}\nif (!requireNamespace(\"geomtextpath\", quietly = TRUE)) {\n  install.packages(\"geomtextpath\")\n}\nif (!requireNamespace(\"plotly\", quietly = TRUE)) {\n  install.packages(\"plotly\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\n\n# 加载包\nlibrary(ggpmisc)\nlibrary(ggplot2)\nlibrary(ggpubr)\nlibrary(ggExtra)\nlibrary(geomtextpath)\nlibrary(plotly)\nlibrary(dplyr)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package      * version date (UTC) lib source\n dplyr        * 1.1.4   2023-11-17 [1] RSPM\n geomtextpath * 0.2.0   2025-07-21 [1] RSPM\n ggExtra      * 0.11.0  2025-09-01 [1] RSPM\n ggplot2      * 4.0.1   2025-11-14 [1] RSPM\n ggpmisc      * 0.6.3   2025-11-29 [1] RSPM\n ggpp         * 0.5.9   2025-06-28 [1] RSPM\n ggpubr       * 0.6.2   2025-10-17 [1] RSPM\n plotly       * 4.11.0  2025-06-19 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Scatter Plot"
    ]
  },
  {
    "objectID": "Correlation/Scatter.html#数据准备",
    "href": "Correlation/Scatter.html#数据准备",
    "title": "散点图",
    "section": "数据准备",
    "text": "数据准备\n使用 R 内置数据集 iris 和 NCBI GSE243555 数据集\n\n# 1.加载 iris 数据集\ndata &lt;- iris\n\n# 2.加载基因表达数据（前两行）\ndata_counts &lt;- read.csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/GSE243555_all_genes_with_counts.txt\", sep = \"\\t\", header = TRUE, nrows = 10) \n\naxis_names &lt;- data_counts[c(1, 2), 1]        # 保存名称\ndata_counts &lt;- data_counts %&gt;%      \n  select(-1) %&gt;%               # 去除第一列\n  slice(1:2) %&gt;%               # 保留前两行\n  t()  %&gt;%                     # 倒置\n  as.data.frame() %&gt;%\n  setNames(c(\"V1\", \"V2\"))      # 设置列名\n\nhead(data_counts)\n\n                           V1  V2\nMCF7.HG..1.              2905 178\nMCF7.HG..LG..2.          2496 161\nADIPO.HG..2.             1802 184\nADIPO.HG..LG..2.         1400 174\nMCF7...ADIPO..HG..2.     2180 154\nMCF7...ADIPO..HG..LG..2. 2123 118",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Scatter Plot"
    ]
  },
  {
    "objectID": "Correlation/Scatter.html#可视化",
    "href": "Correlation/Scatter.html#可视化",
    "title": "散点图",
    "section": "可视化",
    "text": "可视化\n\n1. 基本绘图\n图 1 这个图是基本散点图，调用geom_point()就可绘制出来。\n\n# 基本散点图\np &lt;- ggplot(data, aes(x = Sepal.Width, y = Sepal.Length)) +\n  geom_point()\n\np\n\n\n\n\n\n\n\n图 1: 基本绘图\n\n\n\n\n\n\n\n2. 设置点样式\n图 2 这个图在基本散点图的基础上更改了点的形状、大小和颜色样式。\n\n# 在`geom_point`中设置形状、大小和颜色参数\np &lt;- ggplot(data, aes(x = Sepal.Width, y = Sepal.Length)) +\n  geom_point(shape = 17, size = 1.5, color = \"blue\")\n\np\n\n\n\n\n\n\n\n图 2: 设置点样式\n\n\n\n\n\n\n\n\n\n\n\n提示\n\n\n\n关键参数: shape\nshape 为点的形状，可选值为0-25，具体形状见下图:\n\n\n\n\n\n\n\n\n\n3.多类数据绘图，更改图例位置\n\n多类数据绘图\n图 3 这个图使用color=Species将物种变量映射到颜色特征中，使不同物种有着不同的颜色。\n\n# 多类数据绘图\np_multi &lt;- ggplot(data, aes(x = Sepal.Width, y = Sepal.Length, color = Species)) +\n  geom_point(shape = 16, size = 1.5)\n\np_multi\n\n\n\n\n\n\n\n图 3: 多类数据绘图\n\n\n\n\n\n\n\n\n\n\n\n提示\n\n\n\n关键参数: color=Species\n这里将Species变量映射到了color特征中，不同的Species组会有不同的color；也可以将变量映射到多个特征比如alpha=Species（将物种变量映射到透明度特征中，即三类数据点会有不同的透明度）,shape=Species（将物种变量映射到形状变量中）等。\n\n\n\n\n将分类变量映射到其他特征\n图 4 这个图将物种变量映射到颜色和形状上，不同物种有不同的颜色和形状。\n\n## 将变量映射到其他任何特征中\np_multi &lt;- ggplot(data, aes(\n  x = Sepal.Width, y = Sepal.Length,\n  color = Species, shape = Species\n)) +\n  geom_point()\n\np_multi\n\n\n\n\n\n\n\n图 4: 将变量映射到其他任何特征中\n\n\n\n\n\n\n\n更改图例位置\n图 5 这个图将图例放在了图中的空白位置，显得更加美观。\n\n## 将变量映射到其他任何特征中\np_multi &lt;- ggplot(data, aes(\n  x = Sepal.Width, y = Sepal.Length,\n  color = Species, shape = Species\n)) +\n  geom_point() +\n  # 可以调用`theme()`更改图例位置\n  theme(legend.position = \"inside\", legend.position.inside = c(0.87, 0.8))\n\np_multi\n\n\n\n\n\n\n\n图 5: 更改图例位置\n\n\n\n\n\n\n\n\n\n\n\n提示\n\n\n\n关键参数: theme\nlegend.position：\n设置图例的位置，可选择的有”none”, “left”, “right”, “bottom”, “top”, “inside”,几种形式。\nlegend.position.inside：\n当且仅当legend.position=\"inside\"生效，一般形式为legend.position.inside=c(x,y)，其中x,y为数值，均在0-1之间。x越大，图例越靠右；y越大图例越靠上。可以根据实际空白处进行调整。\n\n\n\n\n\n4. 增加点标签\n\ngeom_text()点标签\n图 6 这个图使用geom_text()绘制点标签。\n\n# 基本绘图+点标签\n# 为了保证点不重叠，只选了物种为\"setosa\"数据进行绘图\np &lt;- ggplot(data = data[data$Species == \"setosa\", ], aes(x = Sepal.Width, y = Sepal.Length)) +\n  geom_point(shape = 16, size = 1.5, color = \"blue\") +\n  geom_text(\n    label = rownames(data[data$Species == \"setosa\", ]),\n    nudge_x = 0.03, nudge_y = -0.04,\n    check_overlap = T\n  )\n\np\n\n\n\n\n\n\n\n图 6: geom_text()点标签\n\n\n\n\n\n\n\n\n\n\n\n提示\n\n\n\n关键参数: geom_text\nlabel:\n显示在图上的标签内容，可以是列名也可以是其他特征。\nnudge_x,nudge_y:\n以每个点为中心，nudge_x,nudge_y表示与这个中心点的偏离值，通过调整使标签在最佳的位置。\ncheck_overlap：\n布尔值，当为true时，会避免重叠，但会使有些点标签不会显示；当为false时，不会检查点是否重叠。\n\n\n\n\ngeom_label()点标签\n图 7 这个图使用geom_label()也可以绘制点标签。\n\n# `geom_label`也可以用于绘制点标签，参数可以不变化\np &lt;- ggplot(data = data[data$Species == \"setosa\", ], aes(x = Sepal.Width, y = Sepal.Length)) +\n  geom_point(shape = 16, size = 1.5, color = \"blue\") +\n  geom_label(\n    label = rownames(data[data$Species == \"setosa\", ]),\n    nudge_x = 0.025, nudge_y = -0.04, size = 2.5\n  )\n\np\n\n\n\n\n\n\n\n图 7: geom_label()点标签\n\n\n\n\n\n\n\n\n5. 回归曲线和回归方程/相关系数\n\n绘制回归曲线\n图 8 这个图使用geom_smooth()引入了回归曲线，是文章中常见的形式。\n\n# 绘制回归曲线\np &lt;- ggplot(data_counts, aes(x = V1, y = V2)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", formula = y ~ x, se = T, color = \"red\")\n\np\n\n\n\n\n\n\n\n图 8: 绘制回归曲线\n\n\n\n\n\n\n\n\n\n\n\n提示\n\n\n\n关键参数: geom_smooth\nmethod:\n选择绘制回归曲线的方法，默认method=NULL，可选择”lm”, “glm”, “gam”, “loess” 或者自定义函数。\nformula:\n用于绘制回归曲线的公式，默认formula=NULL,可选择 y ~ x, y ~ poly(x, 2), y ~ log(x)等。\nse:\n布尔取值，true表示显示置信区间，默认se = TRUE。\n\n\n\n\n添加回归方程\n图 9 这个图在左上角标注了回归方程、R方、P值等信息。\n\n# 绘制回归曲线\np &lt;- ggplot(data_counts, aes(x = V1, y = V2)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", formula = y ~ x, se = T, color = \"red\") +\n  # 引入回归方程，eq：方程，R2：R方，P：p值\n  stat_poly_eq(use_label(\"eq\", \"R2.CI\", \"P\"), formula = y ~ x, size = 4, method = \"lm\")\n\np\n\n\n\n\n\n\n\n图 9: 添加回归方程\n\n\n\n\n\n\n\n\n\n\n\n提示\n\n\n\n关键参数: use_label\n所要添加的标签类型，“eq”,“R2”,“P”分别为回归方程的方程，R方值和p值，还有其他可选值如”R2.CI”(显示95%置信区间)、“method”(显示方法)。\n\n\n\n\n调整回归方程的标签位置\n图 10 这个图使用了label.y、label.x参数按照需要调整了标签位置。\n\n## 调整标签到合适的地方\np &lt;- ggplot(data_counts, aes(x = V1, y = V2)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", formula = y ~ x, se = T, color = \"red\") +\n  stat_poly_eq(use_label(\"eq\"),\n    formula = y ~ x, size = 4, method = \"lm\",\n    label.y = 0.45, label.x = 0.5, angle = -5\n  )\n\np\n\n\n\n\n\n\n\n图 10: 调整回归方程的标签位置\n\n\n\n\n\n\n\n引入回归方程的多类数据绘图\n图 11 这个图使用多类数据绘图，并添加了回归曲线及其标签。\n\n# 多类数据绘图并调整标签\np_multi &lt;- ggplot(data, aes(x = Sepal.Width, y = Sepal.Length, color = Species, shape = Species)) +\n  geom_point(size = 1.5) +\n  scale_colour_manual(values = c(\"setosa\" = \"purple\", \"versicolor\" = \"blue\", \"virginica\" = \"pink\")) +\n  theme(legend.position = \"inside\", legend.position.inside = c(0.87, 0.8)) +      # 设置图例位置\n  geom_smooth(method = \"lm\", formula = y ~ x, se = T) +\n  stat_poly_eq(use_label(\"eq\"),\n    formula = y ~ x, size = 3.5, method = \"lm\",\n    label.x = c(0.6, 0.6, 0.6), label.y = c(0.2, 0.6, 0.75), angle = 10, color = \"black\"\n  )\n\np_multi\n\n\n\n\n\n\n\n图 11: 引入回归方程的多类数据绘图\n\n\n\n\n\n\n\n显示相关系数\n图 12 这个图使用stat_cor()函数显示相关系数标签。\n\n# 显示相关系数\np &lt;- ggplot(data_counts, aes(x = V1, y = V2)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", formula = y ~ x, se = T, color = \"red\") +\n  stat_cor(\n    method = \"pearson\", label.sep = \",\",\n    p.accuracy = 0.00001, r.digits = 5, size = 4\n  )\n\np\n\n\n\n\n\n\n\n图 12: 显示相关系数\n\n\n\n\n\n\n\n\n\n\n\n提示\n\n\n\n关键参数: stat_cor\nmethod:\n计算相关系数的方法，可选项有”pearson” (默认)，“kendall”，“spearman”。\nlabel.sep:\n标签的间隔符，默认为”,“。\nr.accuracy,p.accuracy:\nR值或P值的精确度。\nr.digits,p.digits：\nR值或P值的有效数字。\n\n\n\n\n\n6. 添加回归曲线上的标签\n\n添加标签的单类数据绘图\n图 13 这个图使用geom_labelsmooth()为回归曲线添加标签。\n\n## 绘制回归线并添加标签\np &lt;- ggplot(data[data$Species == \"setosa\", ], aes(x = Sepal.Width, y = Sepal.Length)) +\n  geom_point(shape = 16, size = 2, color = \"blue\") +\n  geom_labelsmooth(aes(label = Species[1]),\n    fill = \"white\",\n    method = \"lm\", formula = y ~ x,\n    size = 6, linewidth = 1,\n    boxlinewidth = 0.6, linecolour = \"red\"\n  )\n\np\n\n\n\n\n\n\n\n图 13: 添加标签的单类数据绘图\n\n\n\n\n\n\n\n\n\n\n\n提示\n\n\n\n关键参数: geom_labelsmooth\nlabel：\n标签名称。\nfill：\n方框填充颜色。\nlinewidth:\n线的粗细。\nboxlinewidth:\n方框边框的粗细。\n\n\n\n\n添加标签的多类数据绘图\n图 14 这个图为多类数据添加相应标签。\n\n# 添加标签的多类数据绘图\np &lt;- ggplot(data, aes(x = Sepal.Width, y = Sepal.Length, color = Species, shape = Species)) +\n  geom_point(size = 2) +\n  theme(legend.position = \"none\") +\n  geom_labelsmooth(aes(label = Species),\n    fill = \"white\",\n    method = \"lm\", formula = y ~ x,\n    size = 3, linewidth = 0.6, boxlinewidth = 0.3\n  )\n\np     \n\n\n\n\n\n\n\n图 14: 添加标签的多类数据绘图\n\n\n\n\n\n\n\n\n7. 引入边缘轴须图\n图 15 这个图使用geom_rug()添加了边缘轴须。\n\np &lt;- ggplot(data, aes(x = Sepal.Width, y = Sepal.Length)) +\n  geom_point(shape = 16, size = 1.5, color = \"blue\") +\n  geom_rug(color = \"steelblue\", alpha = 0.1, linewidth = 1.5)\n\np\n\n\n\n\n\n\n\n图 15: 引入边缘轴须图\n\n\n\n\n\n\n\n8. 引入边际分布\n图 16 这个图引入了直方图的边际分布，多个参数可用于调节边际图样式。\n\n# 引入边际分布\np &lt;- ggplot(data, aes(x = Sepal.Width, y = Sepal.Length)) +\n  geom_point(shape = 16, size = 1.5, color = \"blue\")\n\np\n\np1 &lt;- ggMarginal(p,\n  type = \"histogram\", color = \"red\", fill = \"green\",\n  margins = \"both\", xparams = list(bins = 12, fill = \"purple\")\n)\n\np1\n\n\n\n\n\n\n\n图 16: 引入边际分布\n\n\n\n\n\n\n\n\n\n\n\n提示\n\n\n\n关键参数: ggMarginal\ntype:\n边际分布图的类型，可选项有”density”, “histogram”, “boxplot”, “violin”, “densigram”。\nmargins:\n设置哪个边缘绘制边际分布图，margins=c(x,y)表示x,y边都绘制边际图。\nxparams,yparams：\n设置边的图只对x或y维度有效，参数包括常见参数color、fill、size，也包含这个边际图的特有参数,比如直方图的bins。\nbins:\n同直方图的参数bins，将直方图划分成几个条块。\n\n\n\n\n9. 绘制3D交互式散点图\n图 17 这个图使用了3列数据，并支持交互浏览。\n\n## 3D交互式散点图\np &lt;- plot_ly(data,\n  x = ~ data$Sepal.Length, y = ~ data$Sepal.Width,\n  z = ~ data$Petal.Length, color = ~ data$Species,\n  colors = c(\"#FF6DAE\", \"#D4CA3A\", \"#00BDFF\"),\n  marker = list(size = 5)\n) %&gt;%\n  add_markers()        # 将上述图添加到`plotly`可视化中\n\np\n\n\n\n\n\n\n\n图 17: 绘制3D交互式散点图",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Scatter Plot"
    ]
  },
  {
    "objectID": "Correlation/Scatter.html#应用场景",
    "href": "Correlation/Scatter.html#应用场景",
    "title": "散点图",
    "section": "应用场景",
    "text": "应用场景\n\n\n\n\n\n\n图 18: 散点图应用场景\n\n\n\n图中显示KRT6B表达与免疫相关基因（包括CXCL9和CXCL10）呈正相关。 [1]\n\n\n\n\n\n\n图 19: 散点图应用场景\n\n\n\n图中显示，在棕色和深蓝色模块中，模块成员与基因重要性之间存在很强的正相关关系（cor=0.78&p&lt;0.001, cor=0.59&p&lt;0.001）。[2]\n\n\n\n\n\n\n图 20: 散点图应用场景\n\n\n\n图中探索了CXCR4和多种免疫细胞的关联。 [3]",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Scatter Plot"
    ]
  },
  {
    "objectID": "Correlation/Scatter.html#参考文献",
    "href": "Correlation/Scatter.html#参考文献",
    "title": "散点图",
    "section": "参考文献",
    "text": "参考文献\n[1] Song Q, Yu H, Cheng Y, et al. Bladder cancer-derived exosomal KRT6B promotes invasion and metastasis by inducing EMT and regulating the immune microenvironment[J]. J Transl Med, 2022,20(1):308.\n[2] Xie J, Chen L, Wu D, et al. Significance of liquid-liquid phase separation (LLPS)-related genes in breast cancer: a multi-omics analysis[J]. Aging (Albany NY), 2023,15(12):5592-5610.\n[3]Zhang S, Hou L, Sun Q. Correlation analysis of intestinal flora and immune function in patients with primary hepatocellular carcinoma[J]. J Gastrointest Oncol, 2022,13(3):1308-1316.",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Scatter Plot"
    ]
  },
  {
    "objectID": "Correlation/ComplexHeatmap.html",
    "href": "Correlation/ComplexHeatmap.html",
    "title": "复杂热图",
    "section": "",
    "text": "复杂热图（Complex Heatmap）是一种高级数据可视化工具，主要用于展示多维数据的矩阵关系，并在基础热图（Heatmap）上增加了多层次注释、聚类分析、数据拆分等功能。它能够更清晰地呈现复杂数据的内在结构和关联性。",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "ComplexHeatmap"
    ]
  },
  {
    "objectID": "Correlation/ComplexHeatmap.html#示例",
    "href": "Correlation/ComplexHeatmap.html#示例",
    "title": "复杂热图",
    "section": "",
    "text": "复杂热图（Complex Heatmap）是一种高级数据可视化工具，主要用于展示多维数据的矩阵关系，并在基础热图（Heatmap）上增加了多层次注释、聚类分析、数据拆分等功能。它能够更清晰地呈现复杂数据的内在结构和关联性。",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "ComplexHeatmap"
    ]
  },
  {
    "objectID": "Correlation/ComplexHeatmap.html#环境配置",
    "href": "Correlation/ComplexHeatmap.html#环境配置",
    "title": "复杂热图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：ComplexHeatmap, dendextend, tidyr, circlize, gridExtra, pheatmap\n\n\n# 安装包\nif (!requireNamespace(\"ComplexHeatmap\", quietly = TRUE)) {\n  BiocManager::install(\"ComplexHeatmap\")\n}\nif (!requireNamespace(\"dendextend\", quietly = TRUE)) {\n  install.packages(\"dendextend\")\n}\nif (!requireNamespace(\"tidyr\", quietly = TRUE)) {\n  install.packages(\"tidyr\")\n}\nif (!requireNamespace(\"circlize\", quietly = TRUE)) {\n  install.packages(\"circlize\")\n}\nif (!requireNamespace(\"gridExtra\", quietly = TRUE)) {\n  install.packages(\"gridExtra\")\n}\nif (!requireNamespace(\"pheatmap\", quietly = TRUE)) {\n  install.packages(\"pheatmap\")\n}\n\n# 加载包\nlibrary(ComplexHeatmap)\nlibrary(dendextend)\nlibrary(tidyr)\nlibrary(circlize)\nlibrary(gridExtra)\nlibrary(pheatmap)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package        * version date (UTC) lib source\n circlize       * 0.4.17  2025-12-08 [1] RSPM\n ComplexHeatmap * 2.26.0  2025-10-29 [1] Bioconduc~\n dendextend     * 1.19.1  2025-07-15 [1] RSPM\n gridExtra      * 2.3     2017-09-09 [1] RSPM\n pheatmap       * 1.0.13  2025-06-05 [1] RSPM\n tidyr          * 1.3.2   2025-12-19 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "ComplexHeatmap"
    ]
  },
  {
    "objectID": "Correlation/ComplexHeatmap.html#数据准备",
    "href": "Correlation/ComplexHeatmap.html#数据准备",
    "title": "复杂热图",
    "section": "数据准备",
    "text": "数据准备\n数据主要来自TCGA数据库的甲基化数据\n\n#data_mat(连续型)\ndata &lt;- readr::read_csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/TCGA.BRCA.sampleMap_HumanMethylation27_ch.csv\")\n\ndata &lt;- as.data.frame(data)\nrownames(data) &lt;- data[,1]\ndata &lt;- data[,-1]\n\ndata_TCGA &lt;- na.omit(data[1:20,1:20])\n\ndata_TCGA &lt;- as.matrix(data_TCGA)  \n\n#离散型\ndiscrete_mat = matrix(sample(1:5, 100, replace = TRUE), 10, 10)",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "ComplexHeatmap"
    ]
  },
  {
    "objectID": "Correlation/ComplexHeatmap.html#可视化",
    "href": "Correlation/ComplexHeatmap.html#可视化",
    "title": "复杂热图",
    "section": "可视化",
    "text": "可视化\n\n1. 基础复杂热图\n连续型变量\n这里我们以TCGA数据库的甲基化数据为例\n\n# 连续型变量\nHeatmap(data_TCGA , name = \"Methylation\")\n\n\n\n\n\n\n\n图 1: 连续型变量\n\n\n\n\n\n上图为甲基化水平的复杂热图，列为基因位点，行为样本。红色表示高甲基化水平，蓝色表示低甲基化水平。边轴为聚类分析结果。\n离散型变量\n这里我们以生成数据为例\n\n# 离散型变量\nHeatmap(discrete_mat,  name = \"mat\")\n\n\n\n\n\n\n\n图 2: 离散型变量\n\n\n\n\n\n上图为生成的离散变量的复杂热图，边轴为聚类分析结果。\n\n\n2. 个性化\n\n2.1 颜色自定义\n连续型变量\n\n# 连续型变量颜色自定义\ncol_fun = colorRamp2(c(0, 0.5, 1),  #设置截断点\n                     c(\"blue\", \"white\", \"pink\")) \nHeatmap(data_TCGA, name = \"Methylation\", col = col_fun, \n              column_title = \"自定义三段颜色\")\n\n\n\n\n\n\n\n图 3: 连续型变量颜色自定义\n\n\n\n\n\n\n# 连续型变量颜色自定义\nHeatmap(data_TCGA, name = \"Methylation\", col = rev(rainbow(10)), \n        column_title = \"创建颜色向量\")\n\n\n\n\n\n\n\n图 4: 连续型变量颜色自定义\n\n\n\n\n\n离散型变量\n\n# 离散型变量颜色自定义\ncolors &lt;- c(\n  \"1\" = \"#BBEDA7\",  \n  \"2\" = \"#F3D8FA\",  \n  \"3\" = \"#FFECA1\",  \n  \"4\" = \"#D9E6F7\",  \n  \"5\" = \"#EFBEC6\"   \n)\nHeatmap(discrete_mat, name = \"mat\", col = colors,\n        column_title = \"离散型变量颜色自定义\")\n\n\n\n\n\n\n\n图 5: 离散型变量颜色自定义\n\n\n\n\n\n\n\n2.2 边框自定义\n\n# 边框自定义\nHeatmap(data_TCGA, name = \"Methylation\", \n        border = \"black\", #border值可为FALSE或者颜色\n        rect_gp = gpar(col = \"white\", lwd = 2),#lty线型, lwd线宽\n        column_title = \"边框自定义\")\n\n\n\n\n\n\n\n图 6: 边框自定义\n\n\n\n\n\n\n\n\n3. 聚类\n可以自定义聚类方法，树状图位置、大小等\n\n# 聚类\nHeatmap(data_TCGA, name = \"Methylation\", \n       # row_dend_side = \"right\", \n       # column_dend_side = \"bottom\", #可调整树状图位置\n        column_dend_height = unit(1, \"cm\"), \n        row_dend_width = unit(1, \"cm\"),#可调整树状图距离\n        column_title = \"聚类自定义\",\n        clustering_distance_rows = \"pearson\", #聚类方法，可自设函数\n      # show_parent_dend_line = FALSE  #可隐藏虚线\n        ) \n\n\n\n\n\n\n\n图 7: 聚类\n\n\n\n\n\n树状图渲染\n我们还利用dendextend包对树状图进行颜色渲染\n\n# 树状图渲染\nrow_dend = as.dendrogram(hclust(dist(data_TCGA)))\nrow_dend = color_branches(row_dend, k = 2)  #生成分支\n#数字表示颜色数量\nHeatmap(data_TCGA, name = \"Methylation\", \n        cluster_rows = row_dend,\n      # row_dend_gp = gpar(col = \"red\")  #也可自定义颜色\n        )\n\n\n\n\n\n\n\n图 8: 树状图渲染\n\n\n\n\n\n上图可见树状图分支为不同颜色\n\n\n4. 分割\n连续型变量\n采用k-means聚类分割\n\n# 连续型变量分割\nHeatmap(data_TCGA, \n        name = \"Methylation\", \n        row_km = 2,  #设置分割数\n        column_km = 3)\n\n\n\n\n\n\n\n图 9: 连续型变量分割\n\n\n\n\n\n利用向量分割\n\n# 利用向量分割\nHeatmap(data_TCGA, name = \"Methylation\", \n        row_split = rep(c(\"A\", \"B\"), 9), \n        column_split = rep(c(\"C\", \"D\"), 10))\n\n\n\n\n\n\n\n图 10: 利用向量分割\n\n\n\n\n\n利用矩阵分割\n\n# 利用矩阵分割\nHeatmap(data_TCGA, name = \"Methylation\", \n        row_split = data.frame(rep(c(\"A\", \"B\"), 9), \n                               rep(c(\"C\", \"D\"), each = 9)))\n\n\n\n\n\n\n\n图 11: 利用矩阵分割\n\n\n\n\n\n以上分割方法均可行列独立混使用，设置show_parent_dend_line = FALSE可隐藏虚线\n离散型变量\n按指定行列进行分割\n\n# 按指定行列进行分割\nHeatmap(discrete_mat, \n        name = \"mat\", \n        col = 1:4, \n        row_split = discrete_mat[,1])#根据矩阵数据中的第一列进行分割\n\n\n\n\n\n\n\n图 12: 按指定行列进行分割\n\n\n\n\n\n参数分割\n可根据热图分割对标题，聚类参数等进行分割\n\n# 参数分割\nHeatmap(data_TCGA, name = \"Methylation\", \n        row_km = 2, \n        row_title_gp = gpar(col = c(\"#9A090A\", \"#0D4B99\"), font = 1:2),\n        row_names_gp = gpar(col = c(\"#748901\", \"#E6AC03\"), fontsize = c(10, 12)),\n        column_km = 3, \n        column_title_gp = gpar(fill = c(\"#BFD641\", \"#FE9900\", \"#CC6CE7\"), font = 1:3), #fill用于填充\n        column_names_gp = gpar(col = c(\"#1D6103\", \"#E08804\", \"#5E0676\"), fontsize = c(10, 12, 8)))\n\n\n\n\n\n\n\n图 13: 参数分割\n\n\n\n\n\n注释分割\n可根据热图分割对边注释进行分割\n\n# 注释分割\nHeatmap(data_TCGA, name = \"Methylation\", row_km = 2, column_km = 3,\n        top_annotation = HeatmapAnnotation(foo1 = 1:20, bar1 = anno_points(runif(20))),\n        right_annotation = rowAnnotation(foo2 = 18:1, bar2 = anno_barplot(runif(18)))\n)\n\n\n\n\n\n\n\n图 14: 注释分割\n\n\n\n\n\n上图中添加的点图、热图、条图注释均随主热图分割\n\n\n5. 标签添加\n添加数据\ncell_fun 接受一个函数，该函数会被应用到热图的每个单元格上。函数的参数如下：\n\nj: 列索引（列号）。\ni: 行索引（行号）。\nx, y: 单元格中心点的坐标（基于绘图设备的坐标系）。\nwidth, height: 单元格的宽度和高度。\nfill: 单元格对应的数值（即矩阵中的值）。\n\n\n# 添加数据\nsmall_mat = data_TCGA[1:9, 1:9]\ncol_fun = colorRamp2(c(0, 0.5, 1), c(\"#EBA7FE\", \"white\", \"pink\"))\nHeatmap(small_mat, name = \"Methylation\", col = col_fun,\n        cell_fun = function(j, i, x, y, width, height, fill) {\n          grid.text(sprintf(\"%.1f\", small_mat[i, j]), x, y, gp = gpar(fontsize = 10))\n        })\n\n\n\n\n\n\n\n图 15: 添加数据\n\n\n\n\n\n\n# 添加数据\nsmall_mat = data_TCGA[1:9, 1:9]\nHeatmap(small_mat, name = \"Methylation\",  col = col_fun,\n        cell_fun = function(j, i, x, y, width, height, fill) {\n          if(small_mat[i, j] &gt; 0.5) #设定显示范围\n            grid.text(sprintf(\"%.1f\", small_mat[i, j]), x, y, gp = gpar(fontsize = 10)) #添加文本/数值\n        })\n\n\n\n\n\n\n\n图 16: 添加数据\n\n\n\n\n\n上图仅显示甲基化水平大于0.5的数据\n添加图形\n\n# 添加图形\nsmall_mat = data_TCGA[1:9, 1:9]\nHeatmap(small_mat, name = \"Methylation\", col = col_fun,\n        row_km = 2, column_km = 2,\n        layer_fun = function(j, i, x, y, w, h, fill) {\n          ind_mat = restore_matrix(j, i, x, y)\n          ind = unique(c(ind_mat[1, 4], ind_mat[3, 2])) #定位,每个分割对应位置添加图形\n          grid.points(x[ind], y[ind], pch = 16, size = unit(4, \"mm\")) #添加点\n        }\n)\n\n\n\n\n\n\n\n图 17: 添加图形",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "ComplexHeatmap"
    ]
  },
  {
    "objectID": "Correlation/ComplexHeatmap.html#应用场景",
    "href": "Correlation/ComplexHeatmap.html#应用场景",
    "title": "复杂热图",
    "section": "应用场景",
    "text": "应用场景\n\n\n\n\n\n\n图 18: 复杂热图图应用\n\n\n\n上图是基于 AVR 数据[1]中 59 个差异甲基化 ATG 位点的无监督层次聚类热图。红色表示 DNA 甲基化程度高，绿色表示甲基化程度低。",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "ComplexHeatmap"
    ]
  },
  {
    "objectID": "Correlation/ComplexHeatmap.html#参考文献",
    "href": "Correlation/ComplexHeatmap.html#参考文献",
    "title": "复杂热图",
    "section": "参考文献",
    "text": "参考文献\n[1] Radhakrishna U, Albayrak S, Alpay-Savasan Z, Zeb A, Turkoglu O, Sobolewski P, Bahado-Singh RO. Genome-Wide DNA Methylation Analysis and Epigenetic Variations Associated with Congenital Aortic Valve Stenosis (AVS). PLoS One. 2016 May 6;11(5):e0154010. doi: 10.1371/journal.pone.0154010. PMID: 27152866; PMCID: PMC4859473.\n[2] Gu, Z. (2016) Complex heatmaps reveal patterns and correlations in multidimensional genomic data. Bioinformatics.Gu, Z. (2022) Complex Heatmap Visualization. iMeta.\n[3] Tal Galili (2015). dendextend: an R package for visualizing, adjusting, and comparing trees of hierarchical clustering. Bioinformatics. DOI:10.1093/bioinformatics/btv428\n[4] Wickham H, Vaughan D, Girlich M (2024). tidyr: Tidy Messy Data. R package version 1.3.1, CRAN: Package tidyr.\n[5] Gu, Z. (2014) circlize implements and enhances circular visualization in R. Bioinformatics.\n[6] Auguie B (2017). gridExtra: Miscellaneous Functions for “Grid” Graphics. R package version 2.3, CRAN: Package gridExtra.\n[7] Kolde R (2019). pheatmap: Pretty Heatmaps. R package version 1.0.12, CRAN: Package pheatmap.",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "ComplexHeatmap"
    ]
  },
  {
    "objectID": "Ranking/UpsetPlot.html",
    "href": "Ranking/UpsetPlot.html",
    "title": "Upset图",
    "section": "",
    "text": "Upset 图与 Venn 图类似，主要展示不同集合交叉点中的元素数量，然而当 Venn 图中集合达到 5 个时可读性开始急剧下降，Upset 图则可以很好的解决 Venn 图可读性差的问题，并且还能提供元素属性的附加统计信息。",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "UpsetPlot"
    ]
  },
  {
    "objectID": "Ranking/UpsetPlot.html#示例",
    "href": "Ranking/UpsetPlot.html#示例",
    "title": "Upset图",
    "section": "示例",
    "text": "示例\n\n\n\n\n\n此图为 Upset 图的基本样式，图像分为三部分，分别是上方的不同集合之间交集的元素数量发直方图，左侧为不同集合包含元素数量的直方图。中间的矩阵部分则是集合之间的交集情况，如下图所示：\n\n\n\n\n\n当一个交集的元素存在于某集合时使用黑点标记，否则使用白点标记，例如绿色部分仅在 B 集合处标记为黑色则表明该列为仅在 B 中存在的元素，以此类推。",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "UpsetPlot"
    ]
  },
  {
    "objectID": "Ranking/UpsetPlot.html#环境配置",
    "href": "Ranking/UpsetPlot.html#环境配置",
    "title": "Upset图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：UpSetR; ggupset\n\n\n# 安装包\nif (!requireNamespace(\"UpSetR\", quietly = TRUE)) {\n  install.packages(\"UpSetR\")\n}\nif (!requireNamespace(\"ggupset\", quietly = TRUE)) {\n  install.packages(\"ggupset\")\n}\n\n# 加载包\nlibrary(UpSetR)\nlibrary(ggupset)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package * version date (UTC) lib source\n ggupset * 0.4.1   2025-02-11 [1] RSPM\n UpSetR  * 1.4.0   2019-05-22 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "UpsetPlot"
    ]
  },
  {
    "objectID": "Ranking/UpsetPlot.html#数据准备",
    "href": "Ranking/UpsetPlot.html#数据准备",
    "title": "Upset图",
    "section": "数据准备",
    "text": "数据准备\n\nmovies 数据集由 GroupLens 实验室和 Bilal Alsallakh 创建；mutations 数据集最初由 TCGA 联盟创建，表示 284 个多形性胶质母细胞瘤中 100 个常见基因突变的突变情况。\n两个数据集均被包含至 UpSetR 包中\n\n\n# UpSetR 可以接受三种格式的数据，第一种是具有命名向量的list(见listInput变量)，第二种是表达式向量(见expressionInput变量)，第三种是0,1构成的数据框(见movies和mutations变量)\n# 读取 CSV 数据\n# list格式需要对list中的每个向量为一个集合，UpSetR要求对每个集合进行命名，向量中的元素为对应集合的成员。使用upset函数绘图时需要使用fromList函数对list数据进行格式转化。\nlistInput &lt;- list(one = c(1, 2, 3, 5, 7, 8, 11, 12, 13), two = c(1, 2, 4, 5, 10), three = c(1, 5, 6, 7, 8, 9, 10, 12, 13))\n#expression格式则接受一个类表达式的向量。表达式向量的元素是一个交集中集合的名称（以&分隔），以及该交集中的数字元素。使用upset函数绘图时需要使用fromExpression函数对list数据进行格式转化。\nexpressionInput &lt;- c(one = 2, two = 1, three = 2, `one&two` = 1, `one&three` = 4, `two&three` = 1, `one&two&three` = 2)\n\n# 数据框格式每列为一个集合，每行为一个元素。要求数据框由0 1组成，分别表示元素是否存在于集合，当列存在非01的值时，该列被认为是元素的属性。\nmovies &lt;- read.csv( system.file(\"extdata\", \"movies.csv\", package = \"UpSetR\"), header=T, sep=\";\" )\nmutations &lt;- read.csv( system.file(\"extdata\", \"mutations.csv\", package = \"UpSetR\"), header=T, sep = \",\")",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "UpsetPlot"
    ]
  },
  {
    "objectID": "Ranking/UpsetPlot.html#可视化",
    "href": "Ranking/UpsetPlot.html#可视化",
    "title": "Upset图",
    "section": "可视化",
    "text": "可视化\n\n1. 基础 Upset 图\n此基础 Upset 图展示了包含不同元素的电影数量。\n\n# 使用上面三种数据类型绘制 Upset 图\nupset(fromList(listInput))\nupset(fromExpression(expressionInput))\nupset(movies)\n\n\n\n\n\n\n\n图 1: 基础 Upset 图\n\n\n\n\n\n\n\n\n\n\n\n图 2: 基础 Upset 图\n\n\n\n\n\n\n\n\n\n\n\n图 3: 基础 Upset 图\n\n\n\n\n\n\n\n\n\n\n\n提示\n\n\n\n关键参数: nsets\nnsets 参数决定了使用多少个集合绘制 UpSet 图，未设置时默认为 5。\n\n\n\n# 设置 nset 为 6，使用 mutations 数据集\nupset(mutations, nsets = 6)\n\n\n\n\n\n\n\n图 4: 关键参数: nsets\n\n\n\n\n\n此图使用了突变次数最多的 6 个基因，展示了包含不同突变的多形性胶质母细胞瘤数量。\n\n\n\n\n\n\n提示\n\n\n\n关键参数: order.by\norder.by 参数决定了 UpSet 图中交集的排列顺序，未设置时根据取交集的集合数量从小到大排列，设置为 “degree” 时根据交集的元素数量从大到小排列，设置为 “freq” 时根据交集的大小从大到小排列。\n\n\n\n# order.by不同的三种设置方式，使用mutations数据集\nupset(mutations)\nupset(mutations, order.by = \"degree\")\nupset(mutations, order.by = \"freq\")\n\n\n\n\n\n\n\n图 5: 关键参数: order.by\n\n\n\n\n\n\n\n\n\n\n\n图 6: 关键参数: order.by\n\n\n\n\n\n\n\n\n\n\n\n图 7: 关键参数: order.by\n\n\n\n\n\n\n\n\n\n\n\n提示\n\n\n\n关键参数: sets\nsets 参数可以指定需要绘制的集合，未设置时取元素最多的 nsets 个集合，另外 keep.order 参数可以使集合柱状图的顺序与 sets 输入的顺序保持一致。\n\n\n\n# 指定\"TTN\",\"NF1\",\"FLG\",\"KEL\"四个基因为目标集合，并使集合柱状图顺序与sets参数一致保持\nupset(mutations, sets = c(\"TTN\",\"NF1\",\"FLG\",\"KEL\"), keep.order = T)\n\n\n\n\n\n\n\n图 8: 关键参数: sets\n\n\n\n\n\n\n\n\n\n\n\n提示\n\n\n\n关键参数: empty.intersections\nempty.intersections 参数默认设置为 “NULL”，此时不显示空交集，当设置为任意参数时会显示空交集。\n\n\n\n#显示空交集\nupset(mutations, sets = c(\"TTN\",\"NF1\",\"FLG\",\"KEL\"), keep.order = T, empty.intersections=T)\n\n\n\n\n\n\n\n图 9: 关键参数: empty.intersections\n\n\n\n\n\n\n\n\n\n\n\n提示\n\n\n\n关键参数: decreasing\ndecreasing 参数设置则可以调转 order.by 或 keep.order 的方向，有多个排序方向需要控制时，输入含有多个元素的向量，如”c(T,F)”\n\n\n\n# 调换排序方向\nupset(mutations, sets = c(\"TTN\",\"NF1\",\"FLG\",\"KEL\"), keep.order = T, decreasing = c(T, T))\n\n\n\n\n\n\n\n图 10: 关键参数: decreasing\n\n\n\n\n\n\n\n2. 个性化 Upset 图\n图像比例方面，mb.ratio 参数默认为 “c(0.7, 0.3)”，可以指定交集柱状图与交集矩阵点图之间的比例大小，需要输入一个含有两个元素的向量，分别表示柱状图与矩阵点图的高度占全图的高度比例。\n\nupset(mutations, mb.ratio=c(0.5,0.5))\n\n\n\n\n\n\n\n图 11: 关键参数: mb.ratio\n\n\n\n\n\n图像颜色方面，UpSetR 包提供了多个参数可以设置 Upset 图中不同部分的颜色：\n\nupset(mutations,\n      shade.color = \"#4C4C4C\", # 交集矩阵点图阴影的颜色\n      matrix.color = \"#067522\", # 矩阵中点和线的颜色\n      main.bar.color = \"#3E7B92\", # 交集元素数量柱状图的颜色\n      sets.bar.color = \"#C9AE42\" # 集合数量柱状图的颜色\n)\n\n\n\n\n\n\n\n图 12: Upset图颜色设置\n\n\n\n\n\n如果想要突出某些交集，则需要使用到 UpSetR 包提供的 queries 参数，queries 参数需要输入一个列表 list，这个 list 中至少包含一个子 list，每个子 list 中需要包含以下字段：query、params、color、active 和 query.name。\n\nquery 可输入 intersects 或 elements，效果都一样\nparams 指定一个子集，输入同样为一个 list，list 中的元素可为集合的名称，多个元素表示取这些元素的交集。\ncolor 是将在 plot 上表示的颜色。如果没有提供颜色，将从 UpSetR 默认调色板中选择一种颜色。\nactive 决定查询将如何在图上表示。如果 active 为 TRUE，则交叉大小条将被表示查询的条覆盖。如果 active 为 FALSE，一个抖动点将被放置在相交的大小条上。\nquery.name 为当前突出集合的名称，需要用 query.legend 参数指定图例位置，query.legend 可以输入”top”或”bottom”\n\n\nupset(mutations, sets = c(\"TTN\",\"NF1\",\"FLG\",\"KEL\"), keep.order = T,\n      query.legend = \"top\", \n      queries = list(list(query = intersects, params = list(\"TTN\"), active = T, query.name = \"NAME\"),\n                     list(query = elements, params = list(\"TTN\",\"NF1\"))))\n\n\n\n\n\n\n\n图 13: 关键参数: queries\n\n\n\n\n\n图像标签与字体方面，同样有多个参数可以调整：\n\nupset(mutations,\n      number.angles = 30, # 交集柱状图上方的数字倾斜角度\n      point.size = 2, # 矩阵中点的大小\n      line.size = 1, # 矩阵中线的大小\n      sets.x.label = \"NAME1\", # 集合柱状图的轴标签\n      mainbar.y.label = \"NAME2\", # 交集柱状图的轴标签\n      text.scale = c(1.3, 1.3, 1, 1, 1.2,1)) # 文本大小设置，分别对应交集柱状图的轴标签，分别对应交集柱状图的数字，集合柱状图的轴标签，集合柱状图的数字，集合的名字，交集柱状图上方的数字\n\n\n\n\n\n\n\n图 14: Upset图像标签与字体\n\n\n\n\n\n\n\n3. 进阶 Upset 图\n有时候还需要展示集合中元素的某些属性，如展示 1995 年上市的电影在不同交集中的分布。同样需要用到 queries 参数，在 params 字段中输入一个记录不同电影上市年份信息的列名 与 1995，即可高亮显示对应 1995 年上市电影的分布情况。\n\nupset(movies, sets = c(\"Action\", \"Adventure\", \"Children\", \"War\", \"Noir\"),\n      queries = list(list(query = elements, params = list(\"ReleaseDate\",1995), active = T)))\n\n\n\n\n\n\n\n图 15: params 字段\n\n\n\n\n\n如果是复合条件，例如仅高亮 1995 年上市的动作电影，可以额外引入 expression 参数用于对查询条件进行进一步限制。\n\nupset(movies, sets = c(\"Action\", \"Adventure\", \"Children\", \"War\", \"Noir\"),\n      queries = list(list(query = intersects, params = list(\"Action\"), active = T)),\n      expression = \"ReleaseDate == 1995\")\n\n\n\n\n\n\n\n图 16: 关键参数: expression\n\n\n\n\n\n上述方法仅限于离散型变量，然而元素的属性还可能包括连续性变量，对于连续性变量推荐自定义函数进行查询，以下代码可以用于高亮 Watches 属性大于 100 的元素：\n\nMyfunc &lt;- function(row, num) {\n  data &lt;- row[\"Watches\"] &gt; num\n}\nupset(movies, sets = c(\"Action\", \"Adventure\", \"Children\", \"War\", \"Noir\"),\n      queries = list(list(query = Myfunc, params = list(100), active = T)))\n\n\n\n\n\n\n\n图 17: Upset图连续变量\n\n\n\n\n\nUpsetR 还支持同时绘制其他类型的图像包括直方图、散点图、密度图。前二者需要使用 attribute.plots 参数绘制，箱线图需要使用 boxplot.summary 参数绘制，箱线图与其他三种图像不能兼容。 attribute.plots 包含以下子参数：\n\ngridrows：指定扩展绘图窗口的范围以留出属性图（attribute plots）的空间。UpSetR 绘图基于 100x100 的网格布局。例如，若将 gridrows 设为 50，新的网格布局将变为 150x100，其中 1/3 的区域用于放置属性图。\nplots：接收一个参数 list，包括 plot、x、y（若适用）和 queries。\n\nplot：是一个返回 ggplot 对象的函数，可输入histogram或scatter_plot。\nx：定义 ggplot 中使用的 x 轴美学映射（以字符串形式输入）。\ny：定义 ggplot 中使用的 y 轴美学映射（以字符串形式输入）。\nqueries：控制是否在属性图上叠加查询结果。若为 TRUE，属性图会叠加查询数据；若为 FALSE，则不在属性图中显示查询结果。\n\nncols：指定属性图在 gridrows 预留空间中的排列方式。例如：\n\n若输入两个属性图且 ncols=1，则两图上下排列。\n若输入两个属性图且 ncols=2，则两图并排显示。\n\n\n\nupset(movies, sets = c(\"Action\", \"Adventure\", \"Children\", \"War\", \"Noir\"),\n      queries = list(list(query = intersects, params = list(\"War\"), active = T),\n                     list(query = elements, params = list(\"Noir\"))),\n      attribute.plots=list(gridrows = 100, \n                           ncols = 1,\n                           plots = list(list(plot=histogram, \n                                             x=\"AvgRating\",\n                                             queries=T),\n                                        list(plot = scatter_plot, \n                                             y = \"AvgRating\", \n                                             x = \"Watches\",\n                                             queries = T)\n                                        )\n                           )\n      )\n\n\n\n\n\n\n\n图 18: 关键参数: attribute.plots\n\n\n\n\n\nboxplot.summary 相对简单，只需要指定元素属于对应的列名即可：\n\nupset(movies, sets = c(\"Action\", \"Adventure\", \"Children\", \"War\", \"Noir\"),\n      queries = list(list(query = intersects, params = list(\"War\"), active = T),\n                     list(query = elements, params = list(\"Noir\"))),\n      boxplot.summary = c(\"AvgRating\", \"ReleaseDate\"))\n\n\n\n\n\n\n\n图 19: 关键参数: boxplot.summary\n\n\n\n\n\n\n\n4. 生物数据示例\n数据集采用 ggupset 包中的 df_complex_conditions 数据集\n\n# 整理格式\ndf &lt;- df_complex_conditions\ndf$\"T8\" &lt;- ifelse(df$Timepoint==8,1,0)\ndf$\"T24\" &lt;- ifelse(df$Timepoint==24,1,0)\ndf$\"T48\" &lt;- ifelse(df$Timepoint==48,1,0)\ndf$KO &lt;- ifelse(df$KO==\"TRUE\",1,0)\ndf$DrugA &lt;- ifelse(df$DrugA==\"Yes\",1,0)\n# 需要注意的是UpSetR包不支持tibble数据框，需要转化为传统的dataframe\ndf &lt;- data.frame(df[sample(360,180),c(3,4,1,2,5:7)])  # 这里为了美观随机挑选一半的数据\n\n# upset绘图\nupset(df,\n      queries = list(list(query = intersects, params = list(\"DrugA\",\"T48\"), active = T)),\n      boxplot.summary = c(\"response\"))\n\n\n\n\n\n\n\n图 20: 关键参数: boxplot.summary\n\n\n\n\n\n此图展示了敲除体 KO 与 WT(KO行为白点) 在施加或不施加药物(DrugA)处理在不同时间后生物体的响应情况。",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "UpsetPlot"
    ]
  },
  {
    "objectID": "Ranking/UpsetPlot.html#应用场景",
    "href": "Ranking/UpsetPlot.html#应用场景",
    "title": "Upset图",
    "section": "应用场景",
    "text": "应用场景\n\n\n\n\n\n\n图 21: Upset 图应用\n\n\n\n该图展示了人群中患不同疾病的统计情况以及他们的生存时间。 [1]",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "UpsetPlot"
    ]
  },
  {
    "objectID": "Ranking/UpsetPlot.html#参考文献",
    "href": "Ranking/UpsetPlot.html#参考文献",
    "title": "Upset图",
    "section": "参考文献",
    "text": "参考文献\n[1] Peng X, Hu Y, Cai W. Association between urinary incontinence and mortality risk among US adults: a prospective cohort study. BMC Public Health. 2024 Oct 9;24(1):2753. doi: 10.1186/s12889-024-20091-x. PMID: 39385206; PMCID: PMC11463129.",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "UpsetPlot"
    ]
  },
  {
    "objectID": "Ranking/Radar.html",
    "href": "Ranking/Radar.html",
    "title": "雷达图",
    "section": "",
    "text": "雷达图（Radar Chart）或蜘蛛图（Spider Chart）或网络图（Web Chart）是一种二维图表类型，用于在一个或多个定量变量上绘制一系列值。在R语言中，fmsb库是构建这种图表的最佳工具。",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Radar/Spider Chart"
    ]
  },
  {
    "objectID": "Ranking/Radar.html#示例",
    "href": "Ranking/Radar.html#示例",
    "title": "雷达图",
    "section": "示例",
    "text": "示例",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Radar/Spider Chart"
    ]
  },
  {
    "objectID": "Ranking/Radar.html#环境配置",
    "href": "Ranking/Radar.html#环境配置",
    "title": "雷达图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：fmsb\n\n\n# 安装包\nif (!requireNamespace(\"fmsb\", quietly = TRUE)) {\n  install.packages(\"fmsb\")\n}\n\n# 加载包\nlibrary(fmsb)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package * version date (UTC) lib source\n fmsb    * 0.7.6   2024-01-19 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Radar/Spider Chart"
    ]
  },
  {
    "objectID": "Ranking/Radar.html#数据准备",
    "href": "Ranking/Radar.html#数据准备",
    "title": "雷达图",
    "section": "数据准备",
    "text": "数据准备\n主要运用 R 内置的 iris 数据集，自建数据集和 TCGA 数据库。\n输入数据格式需要非常具体。每一行必须是一个实体。每一列都是一个定量变量。前两行提供了每个变量将使用的最小值和最大值。\n\n# 1.R内置的data——iris\nhead(iris)\n\n  Sepal.Length Sepal.Width Petal.Length Petal.Width Species\n1          5.1         3.5          1.4         0.2  setosa\n2          4.9         3.0          1.4         0.2  setosa\n3          4.7         3.2          1.3         0.2  setosa\n4          4.6         3.1          1.5         0.2  setosa\n5          5.0         3.6          1.4         0.2  setosa\n6          5.4         3.9          1.7         0.4  setosa\n\n# 2.自建数据集\n## 这里创建了一个关于三位学生不同学科成绩情况的数据集\nset.seed(99)                  \ndata &lt;- as.data.frame(matrix( sample( 0:20 , 15 , replace=F) , ncol=5))\ncolnames(data) &lt;- c(\"math\" , \"english\" , \"biology\" , \"music\" , \"R-coding\" )\nrownames(data) &lt;- paste(\"mister\" , letters[1:3] , sep=\"-\")\ndata &lt;- rbind(rep(20,5) , rep(0,5) , data) \n\n# 3.TCGA数据库（肝癌的基因表达数据）\ntcga_group_radar &lt;- readr::read_csv(\n\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/tcga_group_radar.csv\")\ntcga_simple_bar &lt;- data.frame(tcga_group_radar[3,])",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Radar/Spider Chart"
    ]
  },
  {
    "objectID": "Ranking/Radar.html#可视化",
    "href": "Ranking/Radar.html#可视化",
    "title": "雷达图",
    "section": "可视化",
    "text": "可视化\n\n1. 基本绘图\n以iris数据为例\n\n#数据整理\niris_setosa &lt;- iris[c(1:50),]\niris_setosa &lt;- iris_setosa[,-5]\niris_setosa_radar &lt;- rbind(rep(6,4),rep(0,4),iris_setosa)\n#画图\npar(mar = c(1, 1, 1, 1))\nradarchart(iris_setosa_radar)\n\n\n\n\n\n\n\n图 1: 基本绘图\n\n\n\n\n\n这个雷达图描述了setosa这个种类中某一样本的四种基本属性的分布情况。\n以TCGA数据库为例\n\npar(mar = c(1, 1, 1, 1))\ntcga_simple_bar &lt;- rbind(rep(2.5,3),rep(0,3),tcga_simple_bar)\nradarchart(tcga_simple_bar)\n\n\n\n\n\n\n\n图 2: 基本绘图\n\n\n\n\n\n这个雷达图描述了某样本中TIGAR、RNF44、RAB4B基因的表达量。\n\n\n\n\n\n\n提示\n\n\n\n关键参数:\n多边形特征： - pcol：线条颜色 - pfcol：填充颜色 - plwd：线条宽度\n网格特征： - cglcol：网格颜色 - cglty：网格线类型 - axislabcol：坐标轴线条颜色 - caxislabels：要显示的坐标轴标签向量 - cglwd：网格宽度\n组标签： - vlcex：组标签大小\n\n\n\nradarchart(iris_setosa_radar,\n           axistype=1 ,  \n           pcol=rgb(0.2,0.5,0.5,0.9),\n           pfcol=rgb(0.2,0.5,0.5,0.1),\n           plwd=4,  \n           cglcol=\"grey\",cglty=1,axislabcol=\"grey\",\n           caxislabels=seq(0,20,5), cglwd=0.8, vlcex=0.8)\n\n\n\n\n\n\n\n图 3: 参数调整\n\n\n\n\n\n这个雷达图描述了setosa这个种类中某一样本的四种基本属性的分布情况。\n\n\n2. 多组群雷达图\n以自建数据集为例\n\nradarchart(data)\n\n\n\n\n\n\n\n图 4: 多组群雷达图\n\n\n\n\n\n这个雷达图描述了3个学生各科成绩的分布情况。\n调整参数\n\n# 设置颜色参数\ncolors_border=c(rgb(0.2,0.5,0.5,0.9),rgb(0.8,0.2,0.5,0.9),rgb(0.7,0.5,0.1,0.9) )\ncolors_in=c(rgb(0.2,0.5,0.5,0.4),rgb(0.8,0.2,0.5,0.4) ,rgb(0.7,0.5,0.1,0.4) )\n\n# 画图\nradarchart(data,\n           axistype=1 , \n           pcol=colors_border , pfcol=colors_in , plwd=4 , plty=1,\n           cglcol=\"grey\", cglty=1, \n           axislabcol=\"grey\", caxislabels=seq(0,20,5), \n           cglwd=0.8,\n           vlcex=0.8\n)\n\n# 添加图例\nlegend(x=0.7, y=1, \n       legend = rownames(data[-c(1,2),]), bty = \"n\",\n       pch=20,col=colors_in , text.col = \"grey\", \n       cex=1.2, pt.cex=3)\n\n\n\n\n\n\n\n图 5: 调整参数\n\n\n\n\n\n这个雷达图描述了3个学生各科成绩的分布情况。\n以TCGA数据库为例\n\npar(mar = c(1, 1, 1, 1))\ntcga_group_radar &lt;- rbind(rep(3,3),rep(0,3),tcga_group_radar)\ntcga_group_radar &lt;- as.data.frame(tcga_group_radar)#必须要转化为数据框的形式才可以画图\nradarchart(tcga_group_radar)\n\n\n\n\n\n\n\n图 6: TCGA\n\n\n\n\n\n这个雷达图描述了某样本中TIGAR、RNF44、RAB4B基因的表达量。",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Radar/Spider Chart"
    ]
  },
  {
    "objectID": "Ranking/Radar.html#应用场景",
    "href": "Ranking/Radar.html#应用场景",
    "title": "雷达图",
    "section": "应用场景",
    "text": "应用场景\n\n1. 多变量数据的综合比较\n\n\n\n\n\n\n图 7: 多变量数据的综合比较\n\n\n\n该研究利用雷达图来分析YIF1B基因在泛癌中的作用和预后价值。 [1]\n\n\n2. 适用综合评价多个指标\n\n\n\n\n\n\n图 8: 适用综合评价多个指标\n\n\n\n该研究使用雷达图来展示老年人脆弱性评估的各个领域。 [2]",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Radar/Spider Chart"
    ]
  },
  {
    "objectID": "Ranking/Radar.html#参考文献",
    "href": "Ranking/Radar.html#参考文献",
    "title": "雷达图",
    "section": "参考文献",
    "text": "参考文献\n[1] Liu J, Chen Z, Zhao P, Li W. Prognostic and immune regulating roles of YIF1B in Pan-Cancer: a potential target for both survival and therapy response evaluation. Biosci Rep. 2020 Jul 31;40(7):BSR20201384. doi: 10.1042/BSR20201384. PMID: 32648580; PMCID: PMC7378310.\n[2] Jung HW. Visualizing Domains of Comprehensive Geriatric Assessments to Grasp Frailty Spectrum in Older Adults with a Radar Chart. Ann Geriatr Med Res. 2020 Mar;24(1):55-56. doi: 10.4235/agmr.20.0013. Epub 2020 Mar 27. PMID: 32743323; PMCID: PMC7370779.\n[3] Nakazawa M (2024). fmsb: Functions for Medical Statistics Book with some Demographic Data. R package version 0.7.6, https://CRAN.R-project.org/package=fmsb.",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Radar/Spider Chart"
    ]
  },
  {
    "objectID": "Ranking/Lollipop.html",
    "href": "Ranking/Lollipop.html",
    "title": "棒棒糖图",
    "section": "",
    "text": "棒棒糖图（Lollipop plot）是条形图和散点图的变体，由一条线段和一个点组成，其在清晰展示数据的同时，减少了图形量。同时，棒棒糖图能够帮助将数值与类别对齐，非常适合比较多个类别的值之间的差异。",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Lollipop Plot"
    ]
  },
  {
    "objectID": "Ranking/Lollipop.html#示例",
    "href": "Ranking/Lollipop.html#示例",
    "title": "棒棒糖图",
    "section": "示例",
    "text": "示例",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Lollipop Plot"
    ]
  },
  {
    "objectID": "Ranking/Lollipop.html#环境配置",
    "href": "Ranking/Lollipop.html#环境配置",
    "title": "棒棒糖图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：ggplot2; tidyr; palmerpenguins; cowplot; hrbrthemes; ggalt; rstatix; ggpubr\n\n\n# 安装包\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"tidyr\", quietly = TRUE)) {\n  install.packages(\"tidyr\")\n}\nif (!requireNamespace(\"palmerpenguins\", quietly = TRUE)) {\n  install.packages(\"palmerpenguins\")\n}\nif (!requireNamespace(\"cowplot\", quietly = TRUE)) {\n  install.packages(\"cowplot\")\n}\nif (!requireNamespace(\"hrbrthemes\", quietly = TRUE)) {\n  install.packages(\"hrbrthemes\")\n}\nif (!requireNamespace(\"ggalt\", quietly = TRUE)) {\n  install.packages(\"ggalt\")\n}\nif (!requireNamespace(\"rstatix\", quietly = TRUE)) {\n  install.packages(\"rstatix\")\n}\nif (!requireNamespace(\"ggpubr\", quietly = TRUE)) {\n  install.packages(\"ggpubr\")\n}\n\n# 加载包\nlibrary(ggplot2)\nlibrary(tidyr)\nlibrary(palmerpenguins)\nlibrary(cowplot)\nlibrary(hrbrthemes)\nlibrary(ggalt)\nlibrary(rstatix)\nlibrary(ggpubr)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package        * version date (UTC) lib source\n cowplot        * 1.2.0   2025-07-07 [1] RSPM\n ggalt          * 0.6.1   2025-11-02 [1] Github (hrbrmstr/ggalt@8941f8c)\n ggplot2        * 4.0.1   2025-11-14 [1] RSPM\n ggpubr         * 0.6.2   2025-10-17 [1] RSPM\n hrbrthemes     * 0.9.2   2025-11-02 [1] Github (hrbrmstr/hrbrthemes@d3fd029)\n palmerpenguins * 0.1.1   2022-08-15 [1] RSPM\n rstatix        * 0.7.3   2025-10-18 [1] RSPM\n tidyr          * 1.3.2   2025-12-19 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Lollipop Plot"
    ]
  },
  {
    "objectID": "Ranking/Lollipop.html#数据准备",
    "href": "Ranking/Lollipop.html#数据准备",
    "title": "棒棒糖图",
    "section": "数据准备",
    "text": "数据准备\n主要利用R自带数据集以及TCGA数据库中的数据进行绘图\n\ndata_TCGA &lt;- read.csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/TCGA-BRCA.htseq_counts_processed.csv\")\n\ndata_TCGA1 &lt;- data_TCGA[1:25,] %&gt;%\n  gather(key = \"sample\",value = \"gene_expression\",3:1219)\n\ndata_tcga_mean &lt;- aggregate(data_TCGA1$gene_expression, \n                            by=list(data_TCGA1$gene_name), mean) #均值\ncolnames(data_tcga_mean) &lt;- c(\"gene\",\"expression\")\n\ndata_tcga_sd &lt;- aggregate(data_TCGA1$gene_expression, \n                          by=list(data_TCGA1$gene_name), sd)\ncolnames(data_tcga_sd) &lt;- c(\"gene\",\"sd\")\n\ndata_tcga &lt;- merge(data_tcga_mean, data_tcga_sd, by=\"gene\")\n\ndata_penguins &lt;- penguins\n\ndata_penguins_mean &lt;- aggregate(data_penguins$flipper_length_mm, \n                                by=list(data_penguins$species,data_penguins$sex), \n                                mean)\ncolnames(data_penguins_mean) &lt;- c(\"species\",\"sex\",\"flipper_length\")\n\n##将长格式数据转化为宽格式\ndata_penguins_mean &lt;- spread(data_penguins_mean, key=\"sex\", value=\"flipper_length\")\n\nrow_mean = apply(data_penguins_mean[,2:3],1,mean)\n\ndata_penguins_mean$mean &lt;- row_mean",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Lollipop Plot"
    ]
  },
  {
    "objectID": "Ranking/Lollipop.html#可视化",
    "href": "Ranking/Lollipop.html#可视化",
    "title": "棒棒糖图",
    "section": "可视化",
    "text": "可视化\n\n1. 基础棒棒糖图\n棒棒糖图由点和线组成，柱形图和散点图的数据输入均可用棒棒糖图进行绘制。\n以TCGA数据为例（类似于条形图）\n\n# `TCGA`数据集\np &lt;- ggplot(data_tcga, aes(x=gene, y=expression)) +\n  geom_point() + \n  geom_segment( aes(x=gene, xend=gene, y=0, yend=expression)) +\n  theme(axis.text.x = element_text(angle = 30,vjust = 0.85,hjust = 0.85))\n\np\n\n\n\n\n\n\n\n图 1: TCGA数据\n\n\n\n\n\n上图展示了不同基因的表达情况。\n以penguin数据集为例（类似于散点图）。\n\n# `penguin`数据集\np &lt;- ggplot(data_penguins, aes(x=bill_length_mm, y=bill_depth_mm)) +\n  geom_point() + \n  geom_segment( aes(x=0, xend=bill_length_mm, y=bill_depth_mm, yend=bill_depth_mm))\n  ##x=0,直线从y轴发起；y=0，直线从x轴发起；均等于0，直线从原点发起\n\np\n\n\n\n\n\n\n\n图 2: penguin数据集\n\n\n\n\n\n上图展示了企鹅喙长度与深度的分布关系。\n\n\n2. 自定义外观\n颜色与样式\n\n# 圆点\np1 &lt;- ggplot(data_tcga, aes(x=gene, y=expression)) +\n  geom_segment( aes(x=gene, xend=gene, y=0, yend=expression)) +\n  geom_point( size=5, color=\"red\",  #圈\n              fill=alpha(\"orange\"), #填充\n              alpha=0.7, shape=21, stroke=2) +\n  labs(title = \"圆点外观\")+\n  theme(plot.title = element_text(hjust = 0.5),\n        axis.text.x = element_text(angle = 60,vjust = 0.85,hjust = 0.75))\n\n# 茎\np2 &lt;- ggplot(data_tcga, aes(x=gene, y=expression)) +\n  geom_point() + \n  geom_segment( aes(x=gene, xend=gene, y=0, yend=expression),\n                size=1, color=\"blue\", linetype=\"dotdash\" )+\n  labs(title = \"茎外观\")+\n  theme(plot.title = element_text(hjust = 0.5),\n        axis.text.x = element_text(angle = 60,vjust = 0.85,hjust = 0.75))\n\n# theme\np3 &lt;- ggplot(data_tcga, aes(x=gene, y=expression)) +\n  geom_point(color=\"orange\", size=4) + \n  geom_segment( aes(x=gene, xend=gene, y=0, yend=expression),color=\"grey\") +\n  theme_light() +\n  theme(\n    panel.grid.major.x = element_blank(),\n    panel.border = element_blank(),\n    axis.ticks.x = element_blank(),\n    plot.title = element_text(hjust = 0.5),\n    axis.text.x = element_text(angle = 60,vjust = 0.85,hjust = 0.75)#标题居中\n  ) +\n  xlab(\"gene\") +\n  ylab(\"expression\")+\n  labs(title = \"主题\")\n\nplot_grid(p1,p2,p3, labels = LETTERS[1:3], ncol = 2)\n\n\n\n\n\n\n\n图 3: `颜色与样式\n\n\n\n\n\n翻转与基线\n\n##翻转\np4 &lt;- ggplot(data_tcga, aes(x=gene, y=expression)) +\n  geom_point(color=\"orange\", size=4) + \n  geom_segment( aes(x=gene, xend=gene, y=0, yend=expression),color=\"grey\") +\n  theme_light() +\n  labs(title = \"翻转棒棒糖图\")+\n  theme(\n    plot.title = element_text(hjust = 0.5), #标题居中\n    panel.grid.major.x = element_blank(),\n    panel.border = element_blank(),\n    axis.ticks.x = element_blank()\n  ) +\n  xlab(\"gene\") +\n  ylab(\"expression\") +\n  coord_flip() #万能翻转\n\n##更改基线\np5 &lt;- ggplot(data_tcga, aes(x=gene, y=expression)) +\n  geom_point(color=\"orange\", size=4) + \n  geom_segment( aes(x=gene, xend=gene, y=5, ##数值即为基线位置\n                    yend=expression),color=\"grey\") +\n  theme_light() +\n  theme(\n    panel.grid.major.x = element_blank(),\n    panel.border = element_blank(),\n    axis.ticks.x = element_blank(),\n    plot.title = element_text(hjust = 0.5),#标题居中\n    axis.text.x = element_text(angle = 60,vjust = 0.85,hjust = 0.75)\n  ) +\n  xlab(\"gene\") +\n  ylab(\"expression\")+\n  labs(title = \"更改基线\")\n\nplot_grid(p4,p5, labels = LETTERS[1:2], ncol = 2)\n\n\n\n\n\n\n\n图 4: `翻转与基线\n\n\n\n\n\n\n\n3. 高亮显示\n在需要特定高亮显示某些数据时，可以利用ifelse函数筛选高亮数据。\n以TCGA数据为例\n\n#高亮显示----\np6 &lt;- \n##绘图+高亮\n  ggplot(data_tcga, aes(x=gene, y=expression)) +\n  geom_segment(\n    aes(x=gene, xend=gene, y=0, yend=expression), \n    color=ifelse(data_tcga$gene %in% c(\"A4GALT\",\"A1CF\"), \"orange\", \"grey\"), \n    size=ifelse(data_tcga$gene %in% c(\"A4GALT\",\"A1CF\"), 1.3, 0.7)\n     ##用ifelse语句筛选高亮组\n  ) +\n  geom_point(\n    color=ifelse(data_tcga$gene %in% c(\"A4GALT\",\"A1CF\"), \"orange\", \"grey\"), \n    size=ifelse(data_tcga$gene %in% c(\"A4GALT\",\"A1CF\"), 5, 2)\n  ) +\n  theme_ipsum() +\n  coord_flip() +\n  theme(\n    legend.position=\"none\"\n  ) +\n  xlab(\"gene\") +\n  ylab(\"expression\") +\n\n##设置标签\n  annotate(\"text\", x=grep(\"A4GALT\", data_tcga$gene), #添加文字标签\n           y=data_tcga$expression[which(data_tcga$gene==\"A4GALT\")]*1.05, #确定标签位置\n           label=data_tcga$expression[which(data_tcga$gene==\"A4GALT\")] %&gt;% round(2), \n           color=\"orange\", size=4 , angle=0, fontface=\"bold\", hjust=0) +\n  annotate(\"text\", x=grep(\"A1CF\", data_tcga$gene), #添加文字标签\n           y=data_tcga$expression[which(data_tcga$gene==\"A1CF\")]*1.2, #确定标签位置\n           label=data_tcga$expression[which(data_tcga$gene==\"A1CF\")] %&gt;% round(2), \n           color=\"orange\", size=4 , angle=0, fontface=\"bold\", hjust=0)\n\np6\n\n\n\n\n\n\n\n图 5: `高亮显示\n\n\n\n\n\n对指定数据高亮显示，同时利用annotate()函数添加标签。\n\n\n4. 颜色区分\n同样的，可以使用ifelse函数分类数据，用不同的颜色表示不同来源的数据，\n以penguin数据集为例\n\ndata_penguins1 &lt;- na.omit(data_penguins)\ndata_penguins1$number &lt;- c(1:333)\ndata_penguins1$number &lt;- as.character(data_penguins1$number)\ndata_penguins1 &lt;- data_penguins1[1:20,]\n\np &lt;- ggplot(data_penguins1, aes(x=number, y=flipper_length_mm)) +\n  geom_segment(\n    aes(x=number, xend=number, y=0, yend=flipper_length_mm), \n    color=ifelse(data_penguins1$sex == \"female\",\"#FFB6C1\", \"#4169E1\"),alpha=0.5 ,\n    size=ifelse(data_penguins1$sex == \"female\", 1.3, 1.3))+\n  geom_point(\n    color=ifelse(data_penguins1$sex == \"female\", \"#FFB6C1\", \"#4169E1\"),\n    size=ifelse(data_penguins1$sex == \"female\", 5, 5)\n  ) +\n  theme_ipsum() +\n  theme(\n    legend.position=\"none\"\n  ) +\n  xlab(\"\") +\n  ylab(\"flipper length\")\np\n\n\n\n\n\n\n\n图 6: `颜色区分\n\n\n\n\n\n利用ifelse函数实现不同数据的分类处理，上图蓝色代表male，粉色代表female\n\n\n5. 哑铃图（克利夫兰点图）\n不同于普通棒棒糖图，哑铃图适合多组两个数据的比较,同时还可以添加中位数、均数等。\n以pinguin数据集为例\n\np &lt;- ggplot(aes(x=female,xend=male,y=species),data=data_penguins_mean) +\n  geom_dumbbell(colour_x = \"#FFB6C1\",\n                colour_xend = \"#4169E1\",\n                size_x = 2,size_xend = 1,\n                size=1,color=\"gray\",\n                dot_guide = T)+ #添加虚线\n  geom_point(aes(x=female,y=species,size=female),#size=female 外环大小表示数据大小\n             alpha=0.5,color=\"#FFB6C1\")+\n  geom_point(aes(x=male,y=species,size=male),\n             alpha=0.5,color=\"#4169E1\")+\n  theme_light()+\n  theme(panel.grid.minor.x =element_blank(),\n        panel.grid = element_blank(),\n        legend.title = element_blank()\n  )+\n  xlab(\"flipper length\") +\n  annotate(\"text\", x=200, y=3.5, label=\"female\",color=\"#FFB6C1\",size=7) +\n  annotate(\"text\", x=205, y=3.5, label=\"VS\",color=\"black\") +\n  annotate(\"text\", x=210, y=3.5, label=\"male\",color=\"#4169E1\",size=7) \n\np\n\n\n\n\n\n\n\n图 7: 哑铃图（克利夫兰点图）\n\n\n\n\n\n上图展示了三种不同品种的企鹅不同性别的翅膀长度均值的比较，其中外圈的大小表示数据的大小。\n\n5.1 添加均值\n利用geom_point在原图基础上添加均值点\n\n##添加均值\np &lt;- ggplot(aes(x=female,xend=male,y=species),data=data_penguins_mean)+\n  geom_dumbbell(colour_x = \"#FFB6C1\",\n                colour_xend = \"#4169E1\",\n                size_x = 2,size_xend = 2,\n                size=1,color=\"gray\")+ \n  geom_point(aes(x=female,y=species,size=female),#size=female 外环大小表示数据大小\n             alpha=0.7,color=\"#FFB6C1\")+\n  geom_point(aes(x=male,y=species,size=male),\n             alpha=0.7,color=\"#4169E1\")+\n  geom_point(aes(x=mean,y=species,size=mean),\n             alpha=0.5,color=\"orange\")+ #添加均值\n  theme_light()+\n  theme(panel.grid.minor.x =element_blank(),\n        panel.grid = element_blank(),\n        legend.title = element_blank()\n  )+\n  xlab(\"flipper length\") +\n  annotate(\"text\", x=200, y=3.5, label=\"female\",color=\"#FFB6C1\",size=7) +\n  annotate(\"text\", x=205, y=3.5, label=\"VS\",color=\"black\") +\n  annotate(\"text\", x=210, y=3.5, label=\"male\",color=\"#4169E1\",size=7) \n\np\n\n\n\n\n\n\n\n图 8: `添加均值\n\n\n\n\n\n在原数据的基础上增加均值点（还可以根据需要添加中位数、极差、数据量等）\n\n\n5.2 添加差异分析\n\n##添加差异分析\np_val1_sex &lt;- data_penguins %&gt;%  \n  group_by(species) %&gt;% \n  wilcox_test(formula = flipper_length_mm~sex)%&gt;%\n  add_significance(p.col = 'p',cutpoints = c(0,0.001,0.01,0.05,1),symbols = c('***','**','*','ns'))\n\np_val1_species &lt;- data_penguins %&gt;% \n  wilcox_test(formula = flipper_length_mm~species) %&gt;%\n  add_significance(p.col = 'p',cutpoints = c(0,0.001,0.01,0.05,1),symbols = c('***','**','*','ns')) \n\np &lt;- ggplot(aes(x=female,xend=male,y=species),data=data_penguins_mean)+\n  geom_dumbbell(colour_x = \"#FFB6C1\",\n                colour_xend = \"#4169E1\",\n                size_x = 2,size_xend = 2,\n                size=1,color=\"gray\")+\n  geom_point(aes(x=female,y=species,size=female),#size=female 外环大小表示数据大小\n             alpha=0.7,color=\"#FFB6C1\")+\n  geom_point(aes(x=male,y=species,size=male),\n             alpha=0.7,color=\"#4169E1\")+\n  geom_point(aes(x=mean,y=species,size=mean),\n             alpha=0.5,color=\"orange\")+ #添加均值\n  theme_light()+\n  theme(panel.grid.minor.x =element_blank(),\n        panel.grid = element_blank(),\n        legend.title = element_blank()\n  )+\n  xlab(\"flipper length\") +\n  annotate(\"text\", x=201.5, y=3.5, label=\"female\",color=\"#FFB6C1\") +\n  annotate(\"text\", x=205, y=3.5, label=\"VS\",color=\"black\") +\n  annotate(\"text\", x=208, y=3.5, label=\"male\",color=\"#4169E1\") +\n##差异标签\n##species\n  annotate(\"text\", y=1,x=216,\n           label=paste(\"Adelie&Chinstra p=\",\n                       p_val1_species$p[which(p_val1_species$group1==\"Adelie\"& p_val1_species$group2==\"Chinstrap\")],\n                       \" \",\n                       p_val1_species$p.signif[which(p_val1_species$group1==\"Adelie\"& p_val1_species$group2==\"Chinstrap\")])) +\n  annotate(\"text\", y=0.8,x=216,\n           label=paste(\"Adelie&Gentoo p=\",\n                       p_val1_species$p[which(p_val1_species$group1==\"Adelie\"& p_val1_species$group2==\"Gentoo\")],\n                       \" \",\n                       p_val1_species$p.signif[which(p_val1_species$group1==\"Adelie\"& p_val1_species$group2==\"Gentoo\")])) +\n  annotate(\"text\", y=0.6,x=216,\n           label=paste(\"Chinstrap&Gentoo p=\",\n                       p_val1_species$p[which(p_val1_species$group1==\"Chinstrap\"& p_val1_species$group2==\"Gentoo\")],\n                       \" \",\n                       p_val1_species$p.signif[which(p_val1_species$group1==\"Chinstrap\"& p_val1_species$group2==\"Gentoo\")])) +\n\n##sex\n  annotate(\"text\", y=grep(\"Gentoo\", data_penguins_mean$species)+0.15, #添加文字标签\n           x=data_penguins_mean$mean[which(data_penguins_mean$species==\"Gentoo\")], \n           #确定标签位置\n           label=p_val1_sex$p.adj.signif[which(p_val1_sex$species==\"Gentoo\")]) +\n  annotate(\"text\", y=grep(\"Chinstrap\", data_penguins_mean$species)+0.15, #添加文字标签\n           x=data_penguins_mean$mean[which(data_penguins_mean$species==\"Chinstrap\")], \n           #确定标签位置\n           label=p_val1_sex$p.adj.signif[which(p_val1_sex$species==\"Chinstrap\")]) +\n  annotate(\"text\", y=grep(\"Adelie\", data_penguins_mean$species)+0.15, #添加文字标签\n           x=data_penguins_mean$mean[which(data_penguins_mean$species==\"Adelie\")], \n           #确定标签位置\n           label=p_val1_sex$p.adj.signif[which(p_val1_sex$species==\"Adelie\")])\n\np\n\n\n\n\n\n\n\n图 9: `添加差异分析\n\n\n\n\n\n对原数据企鹅种类和企鹅性别对翅膀长度的影响进行差异分析，其结果均具有显著性。",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Lollipop Plot"
    ]
  },
  {
    "objectID": "Ranking/Lollipop.html#应用场景",
    "href": "Ranking/Lollipop.html#应用场景",
    "title": "棒棒糖图",
    "section": "应用场景",
    "text": "应用场景\n\n1. 棒棒糖图\n\n\n\n\n\n\n图 10: 棒棒糖图应用\n\n\n\nD图展示了AAGs（血管生成相关基因）中拷贝数变异缺失、增加和未发生变异的频率。 [1]\n\n\n2. 哑铃图\n\n\n\n\n\n\n图 11: 哑铃图应用\n\n\n\n(A)GRB10与渗透免疫细胞之间的相关性；(B)E2F3与渗透免疫细胞之间的相关性。\n点的大小代表基因与免疫细胞之间相关性的强度;点越大，相关性越强，点越小，相关性越弱。点的颜色代表p值，颜色越绿，p值越低，颜色越黄，p值越大。[2]",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Lollipop Plot"
    ]
  },
  {
    "objectID": "Ranking/Lollipop.html#参考文献",
    "href": "Ranking/Lollipop.html#参考文献",
    "title": "棒棒糖图",
    "section": "参考文献",
    "text": "参考文献\n[1] Qing X, Xu W, Liu S, Chen Z, Ye C, Zhang Y. Molecular Characteristics, Clinical Significance, and Cancer Immune Interactions of Angiogenesis-Associated Genes in Gastric Cancer. Front Immunol. 2022 Feb 22;13:843077. doi: 10.3389/fimmu.2022.843077. PMID: 35273618; PMCID: PMC8901990.\n[2] Deng YJ, Ren EH, Yuan WH, Zhang GZ, Wu ZL, Xie QQ. GRB10 and E2F3 as Diagnostic Markers of Osteoarthritis and Their Correlation with Immune Infiltration. Diagnostics (Basel). 2020 Mar 22;10(3):171. doi: 10.3390/diagnostics10030171. PMID: 32235747; PMCID: PMC7151213.\n[3] H. Wickham. ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York, 2016.\n[4] Wickham H, Vaughan D, Girlich M (2024). tidyr: Tidy Messy Data. R package version 1.3.1, https://CRAN.R-project.org/package=tidyr.\n[5] Horst AM, Hill AP, Gorman KB (2020). palmerpenguins: Palmer Archipelago (Antarctica) penguin data. R package version\n[6] Wilke C (2024). cowplot: Streamlined Plot Theme and Plot Annotations for ‘ggplot2’. R package version 1.1.3, https://CRAN.R-project.org/package=cowplot.\n[7] Rudis B (2024). hrbrthemes: Additional Themes, Theme Components and Utilities for ‘ggplot2’. R package version 0.8.7, https://CRAN.R-project.org/package=hrbrthemes.\n[8] Rudis B, Bolker B, Schulz J (2017). ggalt: Extra Coordinate Systems, ‘Geoms’, Statistical Transformations, Scales and Fonts for ‘ggplot2’. R package version 0.4.0, https://CRAN.R-project.org/package=ggalt.\n[9] Kassambara A (2023). rstatix: Pipe-Friendly Framework for Basic Statistical Tests. R package version 0.7.2, https://CRAN.R-project.org/package=rstatix.\n[10] Kassambara A (2023). ggpubr: ‘ggplot2’ Based Publication Ready Plots. R package version 0.6.0, https://CRAN.R-project.org/package=ggpubr.",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Lollipop Plot"
    ]
  },
  {
    "objectID": "Ranking/Parallel.html",
    "href": "Ranking/Parallel.html",
    "title": "平行坐标图",
    "section": "",
    "text": "平行坐标图(parallel coordinate plot)是可视化高维多元数据的一种常用方法，为了显示多维空间中的一组对象，绘制由多条平行且等距分布的轴，并将多维空间中的对象表示为在平行轴上具有顶点的折线。虽然平行折线图属于折线图的特殊类型，但是它和普通的折线图又具有明显的区别。因为平行折线图并不局限于描述某一种或者某几种趋势的变化关系。对于时间序列的不同时间节点、不同梯度的反应浓度等等数值，都可以使用平行坐标图来进行具体数值的描述。",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Parallel Coordinates Plot"
    ]
  },
  {
    "objectID": "Ranking/Parallel.html#示例",
    "href": "Ranking/Parallel.html#示例",
    "title": "平行坐标图",
    "section": "示例",
    "text": "示例\n\n\n\n\n\n顶点在每一个轴上的位置对应了该对象在该维度上的中的变量数值。此平行坐标图基于Iris数据集，将四个变量（花萼和花瓣的长度和宽度）作为垂直轴，每条线代表一个数据点（花的样本），线条颜色表示花的类别（Setosa、Versicolor、Virginica）。线条穿过每个轴上的点，显示该样本在不同变量上的数值。通过观察这些线的趋势和交叉情况，你可以看到不同类别的花在变量上的差异或相似性。如果线条不交叉，说明组在这些变量上表现相似；如果频繁交叉，说明组在这些变量上差异较大。",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Parallel Coordinates Plot"
    ]
  },
  {
    "objectID": "Ranking/Parallel.html#环境配置",
    "href": "Ranking/Parallel.html#环境配置",
    "title": "平行坐标图",
    "section": "环境配置",
    "text": "环境配置\n\n系统要求： 跨平台（Linux/MacOS/Windows）\n编程语言：R\n依赖包：GGally; hrbrthemes; viridis; dplyr; tidyr; tibble; ggbump; RColorBrewer; patchwork; MASS\n\n\n# 安装包\nif (!requireNamespace(\"GGally\", quietly = TRUE)) {\n  install.packages(\"GGally\")\n}\nif (!requireNamespace(\"hrbrthemes\", quietly = TRUE)) {\n  install.packages(\"hrbrthemes\")\n}\nif (!requireNamespace(\"viridis\", quietly = TRUE)) {\n  install.packages(\"viridis\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"tidyr\", quietly = TRUE)) {\n  install.packages(\"tidyr\")\n}\nif (!requireNamespace(\"tibble\", quietly = TRUE)) {\n  install.packages(\"tibble\")\n}\nif (!requireNamespace(\"ggbump\", quietly = TRUE)) {\n  install.packages(\"ggbump\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\nif (!requireNamespace(\"patchwork\", quietly = TRUE)) {\n  install.packages(\"patchwork\")\n}\nif (!requireNamespace(\"MASS\", quietly = TRUE)) {\n  install.packages(\"MASS\")\n}\n\n# 加载包\nlibrary(GGally)\nlibrary(hrbrthemes)\nlibrary(viridis)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(tibble)\nlibrary(ggbump)\nlibrary(RColorBrewer)\nlibrary(patchwork)\nlibrary(MASS)\n\n\nsessioninfo::session_info(\"attached\")\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.2 (2025-10-31)\n os       Ubuntu 24.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       UTC\n date     2025-12-24\n pandoc   3.1.3 @ /usr/bin/ (via rmarkdown)\n quarto   1.8.26 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package      * version   date (UTC) lib source\n dplyr        * 1.1.4     2023-11-17 [1] RSPM\n GGally       * 2.4.0     2025-08-23 [1] RSPM\n ggbump       * 0.1.99999 2025-12-23 [1] Github (davidsjoberg/ggbump@fe6d5c7)\n ggplot2      * 4.0.1     2025-11-14 [1] RSPM\n hrbrthemes   * 0.9.2     2025-11-02 [1] Github (hrbrmstr/hrbrthemes@d3fd029)\n MASS         * 7.3-65    2025-02-28 [3] CRAN (R 4.5.2)\n patchwork    * 1.3.2     2025-08-25 [1] RSPM\n RColorBrewer * 1.1-3     2022-04-03 [1] RSPM\n tibble       * 3.3.0     2025-06-08 [1] RSPM\n tidyr        * 1.3.2     2025-12-19 [1] RSPM\n viridis      * 0.6.5     2024-01-29 [1] RSPM\n viridisLite  * 0.4.2     2023-05-02 [1] RSPM\n\n [1] /home/runner/work/_temp/Library\n [2] /opt/R/4.5.2/lib/R/site-library\n [3] /opt/R/4.5.2/lib/R/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Parallel Coordinates Plot"
    ]
  },
  {
    "objectID": "Ranking/Parallel.html#数据准备",
    "href": "Ranking/Parallel.html#数据准备",
    "title": "平行坐标图",
    "section": "数据准备",
    "text": "数据准备\n使用R自带数据集iris和UCSC Xena网站(UCSC Xena (xenabrowser.net))的TCGA-CHOL.methylation450.tsv。\n\n# iris\ndata_iris &lt;- iris\ndata_iris &lt;- data_iris %&gt;%\n  group_by(Species) %&gt;%\n  sample_n(size = 20, replace = FALSE)\n\n# TCGA-CHOL.methylation450\nmethylation_raw &lt;- readr::read_tsv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/TCGA-CHOL.methylation450_.tsv\")\nmethylation_selected &lt;- methylation_raw[c(5,7,11),c(4:6)]\nrownames(methylation_selected) &lt;- c(\"cg236\", \"cg292\", \"cg658\")\ncolnames(methylation_selected) &lt;- substr(colnames(methylation_selected), 9, 12)\ndata_tcga &lt;- methylation_selected %&gt;%\n  rownames_to_column(var = \"Composite\") %&gt;%\n  pivot_longer(cols = -Composite, names_to = \"sample\", values_to = \"value\")\ndata_tcga &lt;- data_tcga %&gt;%\n  mutate(sample = as.numeric(factor(sample))) # 把sample转换为数值",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Parallel Coordinates Plot"
    ]
  },
  {
    "objectID": "Ranking/Parallel.html#可视化",
    "href": "Ranking/Parallel.html#可视化",
    "title": "平行坐标图",
    "section": "可视化",
    "text": "可视化\n\n1. 基本绘图\n使用ggplot2 包的拓展ggally包的ggparcoord()函数绘制平行图。\n\n1.1 基础平行图\n输入数据集必须是具有多个数值变量的数据框，每个变量都用作图表上的垂直轴。这些变量的列数在函数的columns参数中指定。此处，分类变量用于为线条着色，在groupColumn参数中指定。\n\n# 基础平行图\np &lt;- ggparcoord(data_iris, columns = 1:4, groupColumn = 5) \n\np\n\n\n\n\n\n\n\n图 1: 基础平行图\n\n\n\n\n\n此平行坐标图展示了iris数据集中的花萼长度、花萼宽度、花瓣长度、花瓣宽度之间的关系，每条线代表一个样本，而groupColumn指定的花的类别用于区分线的颜色。\n\n\n1.2 自定义颜色、主题、整体外观\n这张图表与上一张图表基本相同，但有以下自定义：\n\n使用viridis包改变调色板颜色\n使用title添加标题，并自定义theme\n使用showPoints添加点\n使用alphaLines改变了线条透明度\ntheme_ipsum()使用主题\n\n\n# 自定义颜色、主题、整体外观\np &lt;- ggparcoord(data_iris,\n           columns = 1:4, groupColumn = 5, order = \"anyClass\",\n           showPoints = TRUE, \n           title = \"Parallel Coordinate Plot for the Iris Data\",\n           alphaLines = 0.3) + \n  scale_color_viridis(discrete=TRUE) +\n  theme_ipsum()+\n  theme(plot.title = element_text(size=10))\n\np\n\n\n\n\n\n\n\n图 2: 自定义颜色、主题、整体外观\n\n\n\n\n\n此平行坐标图展示了iris数据集中的花萼长度、花萼宽度、花瓣长度、花瓣宽度之间的关系，自定义图片使图片更加美观易读。\n\n\n1.3 标准化\n标准化转换原始数据，使其可以与其他变量进行比较。这是比较没有相同单位的变量的关键步骤。\nggally包提供了一个比例参数scale。下面在同一数据集上应用了四个可能的选项：\n\nglobalminmax → 无标准化\nuniminmax → 标准化为最小值 = 0 和最大值 = 1\nstd → 单变量标准化（减去平均值并除以标准差）\ncenter → 标准化和中心变量（变量的中心位置都被调整为零）\n\n\n# 无标准化\np1 &lt;- ggparcoord(data_iris,\n    columns = 1:4, groupColumn = 5, order = \"anyClass\",\n    scale=\"globalminmax\",\n    showPoints = TRUE, \n    title = \"No scaling\",\n    alphaLines = 0.3\n    ) + \n  scale_color_viridis(discrete=TRUE) +\n  theme_ipsum()+\n  theme(\n    legend.position=\"none\",\n    plot.title = element_text(size=13)\n  ) +\n  xlab(\"\")\n\n# 标准化为最小值 = 0 和最大值 = 1\np2 &lt;- ggparcoord(data_iris,\n    columns = 1:4, groupColumn = 5, order = \"anyClass\",\n    scale=\"uniminmax\",\n    showPoints = TRUE, \n    title = \"Standardize to Min = 0 and Max = 1\",\n    alphaLines = 0.3\n    ) + \n  scale_color_viridis(discrete=TRUE) +\n  theme_ipsum()+\n  theme(\n    legend.position=\"none\",\n    plot.title = element_text(size=13)\n  ) +\n  xlab(\"\")\n\n# 单变量标准化\np3 &lt;- ggparcoord(data_iris,\n    columns = 1:4, groupColumn = 5, order = \"anyClass\",\n    scale=\"std\",\n    showPoints = TRUE, \n    title = \"Normalize univariately (substract mean & divide by sd)\",\n    alphaLines = 0.3\n    ) + \n  scale_color_viridis(discrete=TRUE) +\n  theme_ipsum()+\n  theme(\n    legend.position=\"none\",\n    plot.title = element_text(size=13)\n  ) +\n  xlab(\"\")\n\n# 标准化和中心变量\np4 &lt;- ggparcoord(data_iris,\n    columns = 1:4, groupColumn = 5, order = \"anyClass\",\n    scale=\"center\",\n    showPoints = TRUE, \n    title = \"Standardize and center variables\",\n    alphaLines = 0.3\n    ) + \n  scale_color_viridis(discrete=TRUE) +\n  theme_ipsum()+\n  theme(\n    legend.position=\"none\",\n    plot.title = element_text(size=13)\n  ) +\n  xlab(\"\")\n\np1 + p2 + p3 + p4 + plot_layout(ncol = 2)\n\n\n\n\n\n\n\n图 3: 标准化\n\n\n\n\n\n这四个图展示了不同的标准化方法对iris数据集的影响：\n\n无标准化 (No scaling)：展示原始数据，每个变量保留其原始范围，数值范围差异较大的变量更显著。\n最小值 = 0 和最大值 = 1 (Standardize to Min = 0 and Max = 1)：所有变量的值被缩放到相同范围（0到1），便于比较不同变量的变化趋势。\n单变量标准化 (Normalize univariately)：每个变量被标准化为均值为0、标准差为1，突出数据的相对差异。\n标准化和中心变量 (Standardize and center variables)：数据经过均值中心化，突出不同组在每个变量上的相对差异。\n\n这些图用颜色区分不同的花种，线条表示每个样本在不同变量上的值。\n\n\n1.4 突出显示组\n如果对某个特定群体感兴趣，可以通过改变不同分类的颜色突出显示：\n\n# 突出显示组\np &lt;- data_iris %&gt;%\n  arrange(desc(Species)) %&gt;%\n  ggparcoord(\n    columns = 1:4, groupColumn = 5, order = \"anyClass\",\n    showPoints = TRUE, \n    title = \"Original\",\n    alphaLines = 1\n    ) + \n  scale_color_manual(values=c( \"#69b3a2\", \"#E8E8E8\", \"#E8E8E8\") ) + # 通过改变不同分类的颜色来突出特定群体\n  theme_ipsum()+\n  theme(\n    legend.position=\"Default\",\n    plot.title = element_text(size=10)\n  ) +\n  xlab(\"\")\n\np\n\n\n\n\n\n\n\n图 4: 突出显示组\n\n\n\n\n\n这个图展示了iris数据集中不同花种在四个特征（花萼长度、花萼宽度、花瓣长度、花瓣宽度）上的表现。图中使用平行坐标图来显示每个样本在这些变量上的数值。通过按花种降序排列并着色，图中用绿色突出了Setosa花种，其余两种花种以灰色表示。线条代表样本，显示它们在不同特征上的数值变化。\n\n\n\n2. MASS 包\n\n2.1 基础平行图（MASS 包）\n使用MASS包构建平行坐标图。请注意，使用ggplot2可能是更好的选择。\n\nmy_colors &lt;- colors()[as.numeric(data_iris$Species) * 11]\nparcoord(data_iris[, c(1:4)], col = my_colors)\n\n\n\n\n\n\n\n图 5: MASS 包\n\n\n\n\n\n这个图是Iris数据集的平行坐标图，显示了数据集中四个变量（花萼长度、花萼宽度、花瓣长度和花瓣宽度）的分布。不同花种用不同颜色区分，通过观察不同颜色线条的走势，可以看到不同花种在这些变量上的模式差异。\n\n\n2.2 添加图例\n使用legend()添加图例。\n\nmy_colors &lt;- colors()[as.numeric(data_iris$Species) * 11]\nparcoord(data_iris[, c(1:4)], col = my_colors)\n\nlegend(\"topright\", \n       legend = levels(data_iris$Species), \n       col = unique(my_colors), \n       pch = 1) # 添加图例\n\n\n\n\n\n\n\n图 6: 添加图例\n\n\n\n\n\n这个图是Iris数据集的平行坐标图，显示了数据集中四个变量（花萼长度、花萼宽度、花瓣长度和花瓣宽度）的分布。不同花种用不同颜色区分，显示了图例，通过观察不同颜色线条的走势，可以看到每个花种在这些变量上的模式差异。\n\n\n2.3 重新排序变量\n在平行坐标图中找到最佳变量顺序非常重要。要更改它，只需更改输入数据集中的顺序即可。\n\npalette &lt;- brewer.pal(3, \"Set1\") \nmy_colors &lt;- palette[as.numeric(data_iris$Species)]\n\nparcoord(data_iris[,c(1,3,4,2)] , col= my_colors)\n\n\n\n\n\n\n\n图 7: 重新排序变量\n\n\n\n\n\n这个图是Iris数据集的平行坐标图，展示了花萼长度、花瓣长度、花瓣宽度和花萼宽度这四个变量的分布。不同花种用三种不同颜色表示，通过观察颜色线条的变化，可以看出不同花种在这些变量上的差异趋势。更改输入数据集中的顺序对变量进行重新排序。\n\n\n2.4 突出显示组\n如果对某个特定群体感兴趣，可以改变颜色，突出显示此分组。\n\nisSetosa &lt;- ifelse(data_iris$Species==\"setosa\",\"red\",\"grey\")\nparcoord(data_iris[,c(1,3,4,2)] , col=isSetosa)\n\n\n\n\n\n\n\n图 8: 突出显示组\n\n\n\n\n\n这个图是Iris数据集的平行坐标图，其中setosa花种用红色显示，其他花种用灰色显示。通过这个图，可以直观地看到setosa与其他花种在花萼长度、花瓣长度、花瓣宽度和花萼宽度上的分布差异。\n\n\n\n3. 凹凸图\n凹凸图是一种可以直观地展示变化趋势的图表，常用于对比不同类别的数据。\n\n3.1 基础凹凸图\n\np &lt;- ggplot(data_tcga, aes(x = sample, y = value, color = Composite)) +  \n  geom_bump(size = 2) +  \n  theme_minimal()\np\n\n\n\n\n\n\n\n图 9: 基础凹凸图\n\n\n\n\n\n这个图展示了不同“Composite”（cg236、cg292、cg658）在不同“sample”中的甲基化数值变化趋势。通过颜色区分不同的“Composite”组，线条表示每组在不同样本中的表现。观察线条的起伏可以看出每组在各个样本中数值的变化趋势和相对差异。\n\n\n3.2 更改颜色\n可以将单个点添加到凹凸图。这可以通过添加geom_point()图层来实现。使用ggbump包绘制凹凸图。\n\np &lt;- ggplot(data_tcga, aes(x = sample, y = value, color = Composite)) +  \n  geom_bump(size = 2) +  \n  geom_point(size = 6) +  \n  scale_color_brewer(palette = \"Paired\") +  \n  theme_minimal()\np\n\n\n\n\n\n\n\n图 10: 更改颜色\n\n\n\n\n\n这个图展示了不同“Composite”（cg236、cg292、cg658）在不同“sample”中的甲基化数值变化趋势。通过颜色区分不同的“Composite”组，线条表示每组在不同样本中的表现。观察线条的起伏可以看出每组在各个样本中数值的变化趋势和相对差异。通过添加点和改变颜色使图片更加美观易读。\n\n\n3.3 添加标签和标题\ngeom_text()和函数labs()可用于向图表添加标签和标题。\n\np &lt;- ggplot(data_tcga, aes(x = sample, y = value, color = Composite)) +  \n  geom_bump(size = 2) +  \n  geom_point(size = 6) +  \n  geom_text(aes(label = Composite), nudge_y = -0.01, fontface = \"bold\", size=3) + \n  scale_color_brewer(palette = \"Paired\") +  \n  theme_minimal() +  \n  labs(title = \"Bump Plot of Methylation Values\",    \n     x = \"Sample\", y = \"Value\")\np\n\n\n\n\n\n\n\n图 11: 添加标签和标题\n\n\n\n\n\n这个图展示了不同“Composite”（cg236、cg292、cg658）在不同“sample”中的甲基化值变化。线条表示每个“Composite”在不同样本中的数值趋势，点表示具体数值，标签标出“Composite”的名字。颜色区分不同的“Composite”，通过样本间的线条起伏可以看出它们的数值变化。",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Parallel Coordinates Plot"
    ]
  },
  {
    "objectID": "Ranking/Parallel.html#应用场景",
    "href": "Ranking/Parallel.html#应用场景",
    "title": "平行坐标图",
    "section": "应用场景",
    "text": "应用场景\n\n1. 基础平行图\n\n\n\n\n\n\n图 12: 基础平行图应用1\n\n\n\n不同参数集对突变、b 因子和运动预测的性能。 [1]\n\n\n\n\n\n\n图 13: 基础平行图应用2\n\n\n\n使用 （a） 平行坐标图、（b） 二元地理地图和 （c） 空间填充栅格在混合交通网络中选择最佳医疗保健中心。（注：两个变量，即总成本和差旅成本，在空间填充栅格中可视化。总成本用从灰色到紫色的色带表示，差旅成本用扫描线从左到右、从下到上升序排序。 [2]\n\n\n2. 分面平行图\n\n\n\n\n\n\n图 14: 分面平行图应用\n\n\n\n平行图说明了表现出 Depot*[Dex] 相互作用的基因的聚类分析。[3]",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Parallel Coordinates Plot"
    ]
  },
  {
    "objectID": "Ranking/Parallel.html#参考文献",
    "href": "Ranking/Parallel.html#参考文献",
    "title": "平行坐标图",
    "section": "参考文献",
    "text": "参考文献\n[1] Frappier V, Najmanovich RJ. A coarse-grained elastic network atom contact model and its use in the simulation of protein dynamics and the prediction of the effect of mutations. PLoS Comput Biol. 2014 Apr 24;10(4):e1003569. doi: 10.1371/journal.pcbi.1003569. PMID: 24762569; PMCID: PMC3998880.\n[2] Jia T, Tao H, Qin K, Wang Y, Liu C, Gao Q. Selecting the optimal healthcare centers with a modified P-median model: a visual analytic perspective. Int J Health Geogr. 2014 Oct 22;13:42. doi: 10.1186/1476-072X-13-42. PMID: 25336302; PMCID: PMC4293817.\n[3] Pickering RT, Lee MJ, Karastergiou K, Gower A, Fried SK. Depot Dependent Effects of Dexamethasone on Gene Expression in Human Omental and Abdominal Subcutaneous Adipose Tissues from Obese Women. PLoS One. 2016 Dec 22;11(12):e0167337. doi: 10.1371/journal.pone.0167337. PMID: 28005982; PMCID: PMC5179014.\n[4] Schloerke, B., Crowley, J., Cook, D., Hofmann, H., Wickham, H. (2021). GGally: Extension to ‘ggplot2’. https://cran.r-project.org/package=GGally\n[5] Rudis, B. (2020). hrbrthemes: Additional Themes and Theme Components for ‘ggplot2’. https://cran.r-project.org/package=hrbrthemes\n[6] Garnier, S. (2018). viridis: Colorblind-Friendly Color Maps for R. https://cran.r-project.org/package=viridis\n[7] Wickham, H., François, R., Henry, L., Müller, K. (2023). dplyr: A Grammar of Data Manipulation. https://cran.r-project.org/package=dplyr\n[8] Wickham, H., Henry, L. (2023). tidyr: Tidy Messy Data. https://cran.r-project.org/package=tidyr\n[9] Müller, K. (2023). tibble: Simple Data Frames. https://cran.r-project.org/package=tibble\n[10] Aumayr, A., & Münch, B. (2022). ggbump: Bump Charts with ggplot2. https://cran.r-project.org/package=ggbump\n[11] Neuwirth, E. (2023). RColorBrewer: ColorBrewer Palettes. https://cran.r-project.org/package=RColorBrewer",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Parallel Coordinates Plot"
    ]
  }
]