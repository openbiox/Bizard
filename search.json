[
  {
    "objectID": "Template/contribution_0323.html",
    "href": "Template/contribution_0323.html",
    "title": "A Biomedical Visualization Atlas",
    "section": "",
    "text": "å…ˆå»ºå›¾è¡¨å¾é›†issueï¼Œè¿›è¡Œå®¡æ ¸ç¡®å®šï¼š\n\næ ¹æ®ç›®æ ‡ä»»åŠ¡ç¡®å®šæ‰§è¡Œçš„å¯è§†åŒ–å›¾è¡¨ç±»å‹ã€‚\n\nåˆ†åˆ«æŒ‰å›¾è¡¨å»ºissueè®©æˆå‘˜åˆ—èµ„æ–™\n\nç¡®å®šåˆ›å»ºå¯è§†åŒ–æ•™ç¨‹æ‰€éœ€çš„ç”Ÿç‰©åŒ»å­¦æ•°æ®ç±»å‹ï¼›\næ ¹æ®å¯è§†åŒ–åº”ç”¨åœºæ™¯ä¼˜åŒ–æ•™ç¨‹æ’°å†™çš„ä¾§é‡ç‚¹ï¼ˆeg. éœ€è¦ç€é‡ä»‹ç»çš„å‡½æ•°/å‚æ•°ã€æ˜¯å¦è¦åŠ å…¥å¸¸ç”¨ç»Ÿè®¡å­¦åˆ†æï¼‰ã€‚\n\nåˆ†é…æˆå‘˜ç”³é¢†å®Œæˆ\nå®Œæˆå›¾æ–‡æ’°å†™éœ€è¦éµå¾ªé¡¹ç›®æ–‡æ¡£è§„èŒƒ\n\nå‚è€ƒæ ¹æ®ç°æœ‰å¯è§†åŒ–æ•™ç¨‹åˆ¶ä½œçš„qmdæ–‡æ¡£æ’°å†™ï¼›\nä¸»è¦æ¨¡å—ï¼šå¯è§†åŒ–å›¾è¡¨åŠå…¶åº”ç”¨åœºæ™¯ä»‹ç»ã€ç¯å¢ƒé…ç½®ã€åŸºç¡€ç»˜å›¾ä»£ç ã€è¿›é˜¶ç»˜å›¾ä»£ç ã€ç”Ÿç‰©åŒ»å­¦é¢†åŸŸåº”ç”¨ï¼ˆåŠå¤ç°ï¼‰â€¦â€¦\n\nç¿»è¯‘ä»»åŠ¡çš„ç”³é¢†å’Œå¤„ç†"
  },
  {
    "objectID": "Template/visualization_guidance_CH.html",
    "href": "Template/visualization_guidance_CH.html",
    "title": "Contribution_guidance",
    "section": "",
    "text": "å¯¹äºå¯è§†åŒ–æ•™ç¨‹çš„ç¤ºä¾‹æŒ‡å¯¼"
  },
  {
    "objectID": "Template/visualization_guidance_CH.html#example",
    "href": "Template/visualization_guidance_CH.html#example",
    "title": "Contribution_guidance",
    "section": "Example",
    "text": "Example\nã€Figure. ç¤ºä¾‹å›¾ã€‘\nå±•ç¤ºä»¥ä¸Šç¤ºä¾‹å›¾çš„æ ‡é¢˜/å›¾æ³¨ï¼Œå¹¶å¯¹ç¤ºä¾‹å›¾xyè½´æˆ–å…¶ä»–æ ‡è¯†ç‰©çš„å«ä¹‰è§£è¯»ã€‚"
  },
  {
    "objectID": "Template/visualization_guidance_CH.html#ç¯å¢ƒé…ç½®",
    "href": "Template/visualization_guidance_CH.html#ç¯å¢ƒé…ç½®",
    "title": "Contribution_guidance",
    "section": "ç¯å¢ƒé…ç½®",
    "text": "ç¯å¢ƒé…ç½®\n\nç³»ç»Ÿè¦æ±‚ è·¨å¹³å°ï¼ˆLinux/MacOS/Windowsï¼‰\nç¼–ç¨‹è¯­è¨€: R\nä¾èµ–èµ„æº: ï¼ˆå¡«å……å¯è§†åŒ–æ•™ç¨‹ä¾èµ–çš„RåŒ…æˆ–å…¶ä»–èµ„æºï¼‰\n\n\n#ä»£ç ç¤ºä¾‹----- \n# Installing necessary packages\nif (!requireNamespace(\"readr\", quietly = TRUE)) {\n  install.packages(\"readr\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"tidyverse\", quietly = TRUE)) {\n  install.packages(\"tidyverse\")\n}\n\n# Loading the libraries\nlibrary(readr) \nlibrary(ggplot2) \nlibrary(tidyverse)"
  },
  {
    "objectID": "Template/visualization_guidance_CH.html#æ•°æ®å‡†å¤‡",
    "href": "Template/visualization_guidance_CH.html#æ•°æ®å‡†å¤‡",
    "title": "Contribution_guidance",
    "section": "æ•°æ®å‡†å¤‡",
    "text": "æ•°æ®å‡†å¤‡\n\néœ€åŒ…å«Rå†…ç½®çš„æ•°æ®é›†ï¼ˆå¦‚irisã€penguinsï¼‰å’Œç”Ÿç‰©åŒ»å­¦ç›¸å…³æ•°æ®é›†ï¼ˆå¦‚ç»„å­¦æ•°æ®ã€ç”Ÿå­˜ä¿¡æ¯ã€ä¸´åºŠæŒ‡æ ‡ç­‰ï¼‰ã€‚\nç”Ÿç‰©åŒ»å­¦ç›¸å…³æ•°æ®é›†éœ€ä¸Šä¼ è‡³Bizardè…¾è®¯äº‘ä»¥ä¾¿è·å–æ’å…¥æ•™ç¨‹çš„é“¾æ¥ï¼Œæ¥è‡ªäºå…¬å…±æ•°æ®é›†çš„æ•°æ®æœ€ä½³ï¼Œè‹¥ç”±ä¸ªäºº/ç»„ç»‡æä¾›éœ€ç¡®ä¿æ•°æ®èƒ½å¤Ÿè¢«å…¬å¼€ã€‚æ•°æ®é›†å¤§å°éœ€å°äº1MBã€‚\n\n\n# æ•°æ®è¯»å…¥å’Œå¤„ç†ä»£ç å¯ä»¥è‡ªç”±é€‰æ‹©æ˜¯å¦å±•ç¤º------\n# è¯»å– TSV æ•°æ®\ndata &lt;- readr::read_tsv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/TCGA-LIHC.htseq_counts.tsv.gz\")\n\n# ç­›é€‰å¹¶é‡å¡‘ç¬¬ä¸€ä¸ªåŸºå›  TSPAN6 çš„æ•°æ®(Ensembl ID: ENSG00000000003.13)\ndata1 &lt;- data %&gt;%\n  filter(Ensembl_ID == \"ENSG00000000003.13\") %&gt;%\n  pivot_longer(\n    cols = -Ensembl_ID, \n    names_to = \"sample\", \n    values_to = \"expression\"\n  ) %&gt;%\n  mutate(var = \"var1\")  # æ·»åŠ ä¸€åˆ—æ¥åŒºåˆ†å˜é‡\n\n# ç­›é€‰å’Œé‡å¡‘ç¬¬äºŒä¸ªåŸºå›  SCYL3 çš„æ•°æ® (Ensembl ID: ENSG00000000457.12)\ndata2 &lt;- data %&gt;%\n  filter(Ensembl_ID == \"ENSG00000000457.12\") %&gt;%\n  pivot_longer(\n    cols = -Ensembl_ID, \n    names_to = \"sample\", \n    values_to = \"expression\"\n  ) %&gt;%\n  mutate(var = \"var2\")  # æ·»åŠ ä¸€åˆ—æ¥åŒºåˆ†å˜é‡\n\n# åˆå¹¶ä¸¤ä¸ªæ•°æ®é›†\ndata12 &lt;- bind_rows(data1, data2)\n\n# æŸ¥çœ‹æœ€ç»ˆçš„åˆå¹¶æ•°æ®é›†\nhead(data12)\n\n# A tibble: 0 Ã— 4\n# â„¹ 4 variables: Ensembl_ID &lt;chr&gt;, sample &lt;chr&gt;, expression &lt;chr&gt;, var &lt;chr&gt;"
  },
  {
    "objectID": "Template/visualization_guidance_CH.html#å¯è§†åŒ–",
    "href": "Template/visualization_guidance_CH.html#å¯è§†åŒ–",
    "title": "Contribution_guidance",
    "section": "å¯è§†åŒ–",
    "text": "å¯è§†åŒ–\n\n1. åŸºç¡€ç»˜å›¾\nä½¿ç”¨åŸºç¡€å‡½æ•°ç»˜åˆ¶å›¾ç‰‡çš„å›¾æ³¨å’Œç®€ä»‹ã€‚\nä¾‹ï¼š@fig-BasicHist æ˜¾ç¤ºäº† TSPAN6åŸºå› åœ¨ä¸åŒæ ·æœ¬ä¸­çš„è¡¨è¾¾æ°´å¹³åˆ†å¸ƒã€‚\n\n# åŸºç¡€ç»˜å›¾ä»£ç ç¤ºä¾‹-----\n#| label: fig-BasicHist\n#| fig-cap: \"Basic Histogram\"\n#| out.width: \"95%\"\n#| warning: false\n\n# åŸºç¡€æŸ±çŠ¶å›¾\np1 &lt;- ggplot(data1, aes(x = expression)) +\n  geom_histogram() + \n  labs(x = \"Gene Expression\", y = \"Count\")\n\np1\n\n\n\n\n\n\n\n\nè¡¥å……åŸºç¡€ä»£ç å¯ä»¥æ‰©å±•çš„é‡è¦å‚æ•°ï¼Œå¹¶æä¾›å¯¹åº”çš„ç»˜å›¾ä»£ç ã€‚ ä¾‹ï¼š ::: callout-tip å…³é”®å‚æ•°: binwidth / bins\nbinwidth æˆ– binå‚æ•°å†³å®šäº†æ¯ä¸ªåˆ†åŒºåŒ…å«å¤šå°‘æ•°æ®ã€‚ä¿®æ”¹è¿™äº›å€¼ä¼šæå¤§åœ°å½±å“ç›´æ–¹å›¾çš„å¤–è§‚å’Œä¼ é€’çš„ä¿¡æ¯ã€‚ :::\n\n# ä»£ç ç¤ºä¾‹ï¼ˆä»¥è¡¥å……å‚æ•°binsä¸ºä¾‹ï¼‰-----\n#| label: fig-bins\n#| fig-cap: \"Key Parameters: `binwidth` / `bins`\"\n#| fig.width: 8\n#| fig.heright: 2\n#| out.width: \"95%\"\n#| warning: false\n\np2_1 &lt;- ggplot(data1, aes(x = expression)) +\n  geom_histogram(bins = 30, fill = \"skyblue\", color = \"white\") +\n  ggtitle(\"Bins = 30\") + \n  labs(x = \"Gene Expression\", y = \"Count\")\n\np2_2 &lt;- ggplot(data1, aes(x = expression)) +\n  geom_histogram(bins = 50, fill = \"skyblue\", color = \"white\") +\n  ggtitle(\"Bins = 50\") + \n  labs(x = \"Gene Expression\", y = \"Count\")\n\ncowplot::plot_grid(p2_1, p2_2)\n\n\n\n\n\n\n\n\n\n\n2. æ›´å¤šè¿›é˜¶å›¾è¡¨ (ä¾‹ï¼šå¯†åº¦æ›²çº¿å’ŒæŸ±çŠ¶å›¾ç»“åˆ)\nä»‹ç»å¤æ‚çš„å¯è§†åŒ–ç±»å‹ï¼Œä¾‹å¦‚ä½¿ç”¨åŒ…å«æ›´å¤šè‡ªå®šä¹‰å‚æ•°çš„å‡½æ•°ã€ä½¿ç”¨å¤šç§åŸºç¡€å›¾è¡¨å åŠ ã€æ·»åŠ ç»Ÿè®¡å­¦æ£€éªŒç­‰ã€‚ ä¾‹ï¼šå¯†åº¦æ›²çº¿å¯ä»¥å¹³æ»‘åœ°è¡¨ç¤ºæ•°æ®åˆ†å¸ƒã€‚ç›´æ–¹å›¾ä¾èµ–äºåˆ†ä½æ•°ï¼Œè€Œå¯†åº¦æ›²çº¿åˆ™ä¸åŒï¼Œå®ƒä½¿ç”¨æ ¸å¯†åº¦ä¼°è®¡(KDE)æ¥å¹³æ»‘åˆ†å¸ƒã€‚è¿™æ ·å°±èƒ½æ›´æ¸…æ¥šåœ°äº†è§£æ•°æ®çš„æ•´ä½“è¶‹åŠ¿å’Œå½¢çŠ¶ã€‚\n\n# è¿›é˜¶ç»˜å›¾ä»£ç ç¤ºä¾‹-----\n#| label: fig-DensityCurve\n#| fig-cap: \"Histogram with Density Curve\"\n#| out.width: \"95%\"\n#| warning: false\n\np1 &lt;- ggplot(data1, aes(x = expression)) +\n  geom_histogram(aes(y = after_stat(density)), bins = 30, fill = \"skyblue\", color = \"white\") +\n  geom_density(alpha = 0.2, fill = \"#FF6666\") + \n  labs(x = \"Gene Expression\", y = \"Density\")\n\np1\n\n\n\n\n\n\n\n\nå¦‚æœä½ æœ‰éœ€è¦çš„è¯å¯ä»¥é€‰æ‹©ä½¿ç”¨callout-tipæ·»åŠ å¯¹å‚æ•°çš„è¯¦ç»†æè¿°ã€‚"
  },
  {
    "objectID": "Template/visualization_guidance_CH.html#åº”ç”¨",
    "href": "Template/visualization_guidance_CH.html#åº”ç”¨",
    "title": "Contribution_guidance",
    "section": "åº”ç”¨",
    "text": "åº”ç”¨\nå±•ç¤ºå¯è§†åŒ–å›¾è¡¨åœ¨ç”Ÿç‰©åŒ»å­¦æ–‡çŒ®ä¸­çš„å®é™…åº”ç”¨ï¼Œå¦‚æœåŸºç¡€å›¾è¡¨/è¿›é˜¶å›¾è¡¨è¢«å¹¿æ³›åº”ç”¨åœ¨å„ç±»ç”Ÿç‰©åŒ»å­¦æ–‡çŒ®ï¼Œåˆ™å¯ä»¥é€‰æ‹©åˆ†åˆ«å±•ç¤ºã€‚\nä¾‹ï¼š ### 1. åŸºç¡€æŸ±çŠ¶å›¾çš„åº”ç”¨\n\n\n\n\n\n\nFigureÂ 1: åŸºç¡€æŸ±çŠ¶å›¾çš„åº”ç”¨\n\n\n\nå›¾ 9 æ˜¾ç¤ºäº† n = 6æ—¶äººç±»XæŸ“è‰²ä½“å’Œäººç±»YæŸ“è‰²ä½“ç›´æ–¹å›¾ç›¸å¯¹é¢‘ç‡çš„å·®å¼‚ã€‚ [1]\néœ€è¡¥å……å›¾ç‰‡å›¾æ³¨å’Œæ¥æºæ–‡çŒ®ä¿¡æ¯ã€‚å¯è§†ä½œè€…æ„æ„¿è¡¥å……å¯¹è¯¥å›¾çš„ä»£ç å¤ç°ã€‚"
  },
  {
    "objectID": "Template/visualization_guidance_CH.html#å‚è€ƒæ–‡çŒ®",
    "href": "Template/visualization_guidance_CH.html#å‚è€ƒæ–‡çŒ®",
    "title": "Contribution_guidance",
    "section": "å‚è€ƒæ–‡çŒ®",
    "text": "å‚è€ƒæ–‡çŒ®\nä¾‹ï¼š 1. Costa, A. M., Machado, J. T., & Quelhas, M. D. (2011). Histogram-based DNA analysis for the visualization of chromosome, genome, and species information. Bioinformatics, 27(9), 1207â€“1214. https://doi.org/10.1093/bioinformatics/btr131"
  },
  {
    "objectID": "Template/visualization_guidance_CH.html#å…±äº«è€…",
    "href": "Template/visualization_guidance_CH.html#å…±äº«è€…",
    "title": "Contribution_guidance",
    "section": "å…±äº«è€…",
    "text": "å…±äº«è€…\n\nç¼–è¾‘: æ‚¨çš„å§“åã€‚\nå®¡é˜…: å®¡é˜…è€…å§“åã€‚"
  },
  {
    "objectID": "Clinics/KaplanMeierPlot.html",
    "href": "Clinics/KaplanMeierPlot.html",
    "title": "Kaplan Meier Plot",
    "section": "",
    "text": "Survival analysis studies the time that passes before an event occurs. The most common application in clinical research is the estimation of mortality (predicting the survival time of patients), but survival analysis can also be applied to other fields such as mechanical failure time.",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> ğ‚ğ‹ğˆğğˆğ‚ğ’",
      "KaplanMeierPlot"
    ]
  },
  {
    "objectID": "Clinics/KaplanMeierPlot.html#example",
    "href": "Clinics/KaplanMeierPlot.html#example",
    "title": "Kaplan Meier Plot",
    "section": "",
    "text": "Survival analysis studies the time that passes before an event occurs. The most common application in clinical research is the estimation of mortality (predicting the survival time of patients), but survival analysis can also be applied to other fields such as mechanical failure time.",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> ğ‚ğ‹ğˆğğˆğ‚ğ’",
      "KaplanMeierPlot"
    ]
  },
  {
    "objectID": "Clinics/KaplanMeierPlot.html#setup",
    "href": "Clinics/KaplanMeierPlot.html#setup",
    "title": "Kaplan Meier Plot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: survival, survminer, ggplot2, dplyr, tidyr, zoo, patchwork\n\n\n# Install packages\nif (!requireNamespace(\"survival\", quietly = TRUE)) {\n  install.packages(\"survival\")\n}\nif (!requireNamespace(\"survminer\", quietly = TRUE)) {\n  install.packages(\"survminer\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"tidyr\", quietly = TRUE)) {\n  install.packages(\"tidyr\")\n}\nif (!requireNamespace(\"zoo\", quietly = TRUE)) {\n  install.packages(\"zoo\")\n}\nif (!requireNamespace(\"patchwork\", quietly = TRUE)) {\n  install.packages(\"patchwork\")\n}\n\n# Load packages\nlibrary(survival)    \nlibrary(survminer)   \nlibrary(ggplot2)     \nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(zoo)\nlibrary(patchwork)",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> ğ‚ğ‹ğˆğğˆğ‚ğ’",
      "KaplanMeierPlot"
    ]
  },
  {
    "objectID": "Clinics/KaplanMeierPlot.html#data-preparation",
    "href": "Clinics/KaplanMeierPlot.html#data-preparation",
    "title": "Kaplan Meier Plot",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Using the built-in lung dataset (from the survival package)\ndata(\"lung\")\n# Data preprocessing\nsurv_data &lt;- lung %&gt;%\n  mutate(\n    status = ifelse(status == 2, 1, 0),  # Transition state code (1=event)\n    sex = factor(sex, labels = c(\"Male\", \"Female\")),\n    group = sample(c(\"Treatment\", \"Placebo\"), n(), replace = TRUE)\n  )\n\n# View data structure\nglimpse(surv_data)\n\nRows: 228\nColumns: 11\n$ inst      &lt;dbl&gt; 3, 3, 3, 5, 1, 12, 7, 11, 1, 7, 6, 16, 11, 21, 12, 1, 22, 16â€¦\n$ time      &lt;dbl&gt; 306, 455, 1010, 210, 883, 1022, 310, 361, 218, 166, 170, 654â€¦\n$ status    &lt;dbl&gt; 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, â€¦\n$ age       &lt;dbl&gt; 74, 68, 56, 57, 60, 74, 68, 71, 53, 61, 57, 68, 68, 60, 57, â€¦\n$ sex       &lt;fct&gt; Male, Male, Male, Male, Male, Male, Female, Female, Male, Maâ€¦\n$ ph.ecog   &lt;dbl&gt; 1, 0, 0, 1, 0, 1, 2, 2, 1, 2, 1, 2, 1, NA, 1, 1, 1, 2, 2, 1,â€¦\n$ ph.karno  &lt;dbl&gt; 90, 90, 90, 90, 100, 50, 70, 60, 70, 70, 80, 70, 90, 60, 80,â€¦\n$ pat.karno &lt;dbl&gt; 100, 90, 90, 60, 90, 80, 60, 80, 80, 70, 80, 70, 90, 70, 70,â€¦\n$ meal.cal  &lt;dbl&gt; 1175, 1225, NA, 1150, NA, 513, 384, 538, 825, 271, 1025, NA,â€¦\n$ wt.loss   &lt;dbl&gt; NA, 15, 15, 11, 0, 0, 10, 1, 16, 34, 27, 23, 5, 32, 60, 15, â€¦\n$ group     &lt;chr&gt; \"Placebo\", \"Treatment\", \"Placebo\", \"Treatment\", \"Placebo\", \"â€¦\n\n# Survival time distribution\nsummary(surv_data$time)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n    5.0   166.8   255.5   305.2   396.5  1022.0 \n\n# Fitting survival curves\nfit &lt;- survfit(Surv(time, status) ~ group, data = surv_data)\n\n# Extract curve data\nsurv_curve &lt;- surv_summary(fit) \n\n\n# Calculate the log-rank test P value\ndiff &lt;- survdiff(Surv(time, status) ~ group, data = surv_data)\np_value &lt;- signif(1 - pchisq(diff$chisq, length(diff$n)-1), 3)",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> ğ‚ğ‹ğˆğğˆğ‚ğ’",
      "KaplanMeierPlot"
    ]
  },
  {
    "objectID": "Clinics/KaplanMeierPlot.html#visualization",
    "href": "Clinics/KaplanMeierPlot.html#visualization",
    "title": "Kaplan Meier Plot",
    "section": "Visualization",
    "text": "Visualization\n\n1. Basic Plot\nUse basic functions to draw the caption and description of the image.\n\n# Basic survival curve\np1 &lt;- ggplot(surv_curve, aes(x = time, y = surv, color = strata)) +\n  geom_step(linewidth = 1) +\n  labs(x = \"Time (Months)\", y = \"Survival Probability\") +\n  scale_y_continuous(labels = scales::percent)\np1\n\n\n\n\n\n\n\nFigureÂ 1: Basic survival curve\n\n\n\n\n\n\n# Code Example (Taking the Supplementary Parameter bins as an example)-----\n## Custom aesthetic mapping\ngroup_colors &lt;- c(\"Treatment\" = \"#E64B35\", \"Placebo\" = \"#3182BD\")\nline_types &lt;- c(\"Treatment\" = \"solid\", \"Placebo\" = \"dashed\")\n\n# Complete plot code\np_km &lt;- ggplot(surv_curve, aes(x = time, color = group, fill = group)) +\n      # First draw the confidence interval\n      geom_ribbon(aes(ymin = lower, ymax = upper), \n                  alpha = 0.15, \n                  colour = NA) +\n      # Draw the survival curve again\n      geom_step(aes(y = surv, linetype = group), \n                linewidth = 1.2) +\n      # Color Mapping\n      scale_color_manual(\n        values = group_colors,\n        name = \"Treatment Group\",\n        labels = c(\"Placebo\", \"Treatment\")\n      ) +\n      # Fill color map\n      scale_fill_manual(\n        values = group_colors,\n        guide = \"none\"\n      ) +\n      # Line Mapping\n      scale_linetype_manual(\n        values = line_types,\n        guide = \"none\"  # Share legend with colors\n      ) +\n      # Coordinate axis optimization\n      scale_x_continuous(\n        name = \"Time (Months)\",\n        expand = c(0, 0),\n        breaks = seq(0, 1000, by = 100)\n      ) +\n      scale_y_continuous(\n        name = \"Survival Probability\",\n        labels = scales::percent,\n        limits = c(0, 1)\n      ) +\n      # Theme Settings\n      theme_classic(base_size = 12) +\n      theme(\n        legend.position = c(0.85, 0.85),\n        legend.background = element_rect(fill = \"white\", colour = \"grey50\"),\n        panel.grid.major.y = element_line(colour = \"grey90\")\n      )\np_km\n\n\n\n\n\n\n\nFigureÂ 2: Basic survival curve\n\n\n\n\n\n\n\n2. More advanced plot\n\n# ----------------------------\n# Risk table data generation\n# ----------------------------\n# Generate quantile breakpoints (automatically adapt to data distribution)\ncustom_breaks &lt;- quantile(surv_curve$time, \n                          probs = seq(0, 1, 0.25), \n                          na.rm = TRUE) %&gt;%\n  unique()  # Ensure breakpoints are unique\n\n# How to correctly generate interval labels\ntime_labels &lt;- paste0(\n  round(custom_breaks[-length(custom_breaks)]),  # Starting point (excluding the last one)\n  \"-\",\n  round(custom_breaks[-1])  # End point (excluding the first one)\n)\n\n# Generate segmented risk table data --------------------------------------------------------\nrisk_table_segmented &lt;- surv_curve %&gt;%\n  mutate(\n    time_interval = cut(time,\n                        breaks = custom_breaks,\n                        include.lowest = TRUE,\n                        right = FALSE,\n                        labels = time_labels)\n  ) %&gt;%\n  group_by(group, time_interval) %&gt;%\n  summarise(\n    n_risk = ifelse(all(is.na(n.risk)), 0, max(n.risk, na.rm = TRUE)),  # Take the maximum number of people at risk within the interval\n    .groups = \"drop\"\n  ) %&gt;%\n  complete(group, time_interval, fill = list(n_risk = 0)) %&gt;%\n  # 4. Added total row (fixed syntax)\n  bind_rows(\n    group_by(., group) %&gt;%\n      summarise(\n        time_interval = \"Total\",\n        n_risk = sum(n_risk, na.rm = TRUE),\n        .groups = \"drop\"\n      )\n  ) %&gt;%\n  mutate(\n    group = factor(group, levels = c(\"Treatment\", \"Placebo\")),\n    time_interval = factor(time_interval, levels = c(time_labels, \"Total\") )\n  )\n\n# Plot of a segmented risk table with borders ----------------------------------------------------\nrisk_table_plot &lt;- ggplot(risk_table_segmented, \n                          aes(x = time_interval, y = group)) +\n  # # Cell background (with border)\n  # geom_tile(color = \"gray50\", fill = \"white\", linewidth = 0.5, \n  #           width = 0.95, height = 0.95) +\n  # Numeric Label\n  geom_text(aes(label = n_risk), size = 4.5, fontface = \"bold\", color = \"black\") +\n  # Column header style\n  scale_x_discrete(\n    name = \"Time Interval (Months)\",\n    position = \"top\",\n    expand = expansion(add = 0.5)\n  ) +\n  scale_y_discrete(\n    name = NULL, \n    limits = rev,\n    labels = c(\"Treatment\\nGroup\", \"Placebo\\nGroup\")  # Add group labels\n  ) +\n  # Color system\n  scale_fill_manual(values = group_colors, guide = \"none\") +\n  # Theme System\n  theme_minimal(base_size = 12) +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 0, color = \"black\"),\n    axis.text.y = element_text(\n      color = group_colors,\n      face = \"bold\",\n      margin = margin(r = 15)\n    ),\n    panel.grid = element_blank(),\n    plot.margin = margin(t = 30, b = 5, unit = \"pt\"),\n    axis.title.x = element_text(margin = margin(t = 15))\n  ) +\n  # Add an outer border\n  annotate(\"rect\",\n           xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf,\n           color = \"gray30\", fill = NA, linewidth = 0.8)\nrisk_table_plot\n\n# ----------------------------\n# Plot parameter settings\n# ----------------------------\ngroup_colors &lt;- c(\"Treatment\" = \"#E64B35\", \"Placebo\" = \"#3182BD\")\ntheme_set(theme_minimal(base_size = 12))\n\n# ----------------------------\n# KM survival curve drawing\n# ----------------------------\np_km &lt;- ggplot(surv_curve, aes(x = time, color = group, fill = group)) +\n  # First draw the confidence interval\n  geom_ribbon(aes(ymin = lower, ymax = upper), \n              alpha = 0.15, \n              colour = NA) +\n  # Draw the survival curve again\n  geom_step(aes(y = surv, linetype = group), \n            linewidth = 1.2) +\n  # Color Mapping\n  scale_color_manual(\n    values = group_colors,\n    name = \"Treatment Group\",\n    labels = c(\"Placebo\", \"Treatment\")\n  ) +\n  # Fill color map\n  scale_fill_manual(\n    values = group_colors,\n    guide = \"none\"\n  ) +\n  # Line Mapping\n  scale_linetype_manual(\n    values = line_types,\n    guide = \"none\"  # Share legend with colors\n  ) +\n  # Coordinate axis optimization\n  scale_x_continuous(\n    name = \"Time (Months)\",\n    expand = c(0, 0),\n    breaks = seq(0, 1000, by = 100)\n  ) +\n  scale_y_continuous(\n    name = \"Survival Probability\",\n    labels = scales::percent,\n    limits = c(0, 1)\n  ) +\n  # Theme Settings\n  theme_classic(base_size = 12) +\n  theme(\n    legend.position = c(0.85, 0.85),\n    legend.background = element_rect(fill = \"white\", colour = \"grey50\"),\n    panel.grid.major.y = element_line(colour = \"grey90\")\n  )\np_km\n\n# ----------------------------\n# Graphic Combination\n# ----------------------------\nfinal_plot &lt;- p_km / risk_table_plot + \n  plot_layout(heights = c(3, 0.4))\n\nfinal_plot\n\n\n\n\n\n\n\nFigureÂ 3: Beautified survival curve",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> ğ‚ğ‹ğˆğğˆğ‚ğ’",
      "KaplanMeierPlot"
    ]
  },
  {
    "objectID": "Clinics/KaplanMeierPlot.html#application",
    "href": "Clinics/KaplanMeierPlot.html#application",
    "title": "Kaplan Meier Plot",
    "section": "Application",
    "text": "Application\n\n\n\n\n\n\nFigureÂ 4: Three sets of KM curves\n\n\n\nThis figure shows the comparison of the generated survival time between the three groups of data: Standard, New Drug, and Combination.",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> ğ‚ğ‹ğˆğğˆğ‚ğ’",
      "KaplanMeierPlot"
    ]
  },
  {
    "objectID": "Clinics/KaplanMeierPlot.html#reference",
    "href": "Clinics/KaplanMeierPlot.html#reference",
    "title": "Kaplan Meier Plot",
    "section": "Reference",
    "text": "Reference\n[1] Kassambara A, et al.Â Survminer: Drawing Survival Curves using ggplot2. JOSS 2017\n[2] Wickham H. ggplot2: Elegant Graphics for Data Analysis. Springer 2016",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> ğ‚ğ‹ğˆğğˆğ‚ğ’",
      "KaplanMeierPlot"
    ]
  },
  {
    "objectID": "Clinics/RegressionTable.html",
    "href": "Clinics/RegressionTable.html",
    "title": "Regression Analysis Table",
    "section": "",
    "text": "The regression analysis table is used to display the results of the regression model. It provides statistical information about the variables in the model and helps explain the relationship between the variables.",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> ğ‚ğ‹ğˆğğˆğ‚ğ’",
      "RegressionTable"
    ]
  },
  {
    "objectID": "Clinics/RegressionTable.html#example",
    "href": "Clinics/RegressionTable.html#example",
    "title": "Regression Analysis Table",
    "section": "Example",
    "text": "Example\n\n\n\n\n\nThe figure below shows a regression analysis based on the pbc dataset built into the survival package. The figure uses the Cox proportional hazards model and generalized linear regression model to explore the effects of serum protein, sex, and age on survival.",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> ğ‚ğ‹ğˆğğˆğ‚ğ’",
      "RegressionTable"
    ]
  },
  {
    "objectID": "Clinics/RegressionTable.html#setup",
    "href": "Clinics/RegressionTable.html#setup",
    "title": "Regression Analysis Table",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: survival, gtsummary, dplyr, datawizard\n\n\n# Installing packages\nif (!requireNamespace(\"survival\", quietly = TRUE)) {\n  install.packages(\"survival\")\n}\nif (!requireNamespace(\"gtsummary\", quietly = TRUE)) {\n  install.packages(\"gtsummary\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"datawizard\", quietly = TRUE)) {\n  install.packages(\"datawizard\")\n}\nif (!requireNamespace(\"broom.helpers\", quietly = TRUE)) {\n  remotes::install_github(\"larmarange/broom.helpers\")\n}\n\n# Load packages\nlibrary(survival)\nlibrary(gtsummary)\nlibrary(dplyr)\nlibrary(datawizard)\nlibrary(broom.helpers)",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> ğ‚ğ‹ğˆğğˆğ‚ğ’",
      "RegressionTable"
    ]
  },
  {
    "objectID": "Clinics/RegressionTable.html#data-preparation",
    "href": "Clinics/RegressionTable.html#data-preparation",
    "title": "Regression Analysis Table",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe pbc dataset, built into the survival R package, contains information on 418 patients with primary biliary cirrhosis (PBC) who had received ursodeoxycholic acid (UDCA) treatment at or before the start of the study. The pbc dataset records clinical information such as survival time, survival status, treatment method, age, sex, albumin level, and hepatomegaly.\n\ndf &lt;- pbc %&gt;%\n  filter(status != 1) %&gt;%\n  mutate(status = ifelse(status == 2, 1, 0)) %&gt;%\n  select(2:13) %&gt;%\n  na.omit() %&gt;% \n  # Divide `albumin` into 3 groups\n  mutate(albumin3cat = categorize(albumin, split = \"quantile\", n_groups = 3))\n\nhead(df[,1:6])\n\n  time status trt      age sex ascites\n1  400      1   1 58.76523   f       1\n2 4500      0   1 56.44627   f       0\n3 1012      1   1 70.07255   m       0\n4 1925      1   1 54.74059   f       0\n5 2503      1   2 66.25873   f       0\n6 1832      0   2 55.53457   f       0",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> ğ‚ğ‹ğˆğğˆğ‚ğ’",
      "RegressionTable"
    ]
  },
  {
    "objectID": "Clinics/RegressionTable.html#visualization",
    "href": "Clinics/RegressionTable.html#visualization",
    "title": "Regression Analysis Table",
    "section": "Visualization",
    "text": "Visualization\n\n1. Basic regression analysis table\n\n# Basic regression analysis table\nt1 &lt;- coxph(Surv(time, status) ~ albumin + sex + age,\n  data = df\n) %&gt;%\n  tbl_regression()\n\nt1\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\nlog(HR)\n95% CI\np-value\n\n\n\n\nalbumin\n-1.7\n-2.1, -1.2\n&lt;0.001\n\n\nsex\n\n\n\n\n\n\n\n\nÂ Â Â Â m\nâ€”\nâ€”\n\n\n\n\nÂ Â Â Â f\n-0.56\n-1.1, -0.06\n0.027\n\n\nage\n0.03\n0.01, 0.05\n0.004\n\n\n\nAbbreviations: CI = Confidence Interval, HR = Hazard Ratio\n\n\n\n\n\n\n\n\nFigureÂ 1: Basic regression analysis table\n\n\n\n\nThis table is a basic regression analysis table. The Cox proportional hazard model is called by coxph() and the results of the regression analysis are tabulated using tbl_regression().\n\n\n2. tbl_regression() parameter settings\n\n# tbl_regression() parameter settings\nt1 &lt;- coxph(Surv(time, status) ~ albumin + sex + age,\n  data = df\n) %&gt;%\n  # parameter settings\n  tbl_regression(\n    conf.level = 0.90,\n    exponentiate = TRUE,\n    include = c(\"sex\", \"albumin\"),\n    show_single_row = sex,\n    label = list(sex ~ \"sex as categorical\")\n  )\n\nt1\n\n\n\n\n\n\n\n\n\nCharacteristic\nHR\n90% CI\np-value\n\n\n\n\nsex as categorical\n0.57\n0.37, 0.87\n0.027\n\n\nalbumin\n0.19\n0.13, 0.28\n&lt;0.001\n\n\n\nAbbreviations: CI = Confidence Interval, HR = Hazard Ratio\n\n\n\n\n\n\n\n\nFigureÂ 2: tbl_regression() parameter settings\n\n\n\n\nThere are many parameter settings in the table tbl_regression(), which can change the confidence interval, row names and other information of the table.\n\n\n\n\n\n\nTip\n\n\n\nImportant parameter: tbl_regression\n\nconf.level: Determines the confidence level for the regression analysis. The default value of 0.95 indicates a 95% confidence interval.\nexponentiate: Whether to exponentiate the HR values. The default column is log(HR) values.\ninclude: Which independent variables (rows) are included in the statistical table.\nshow_single_row: Applies to binary variables and does not display the control group.\nlabel: Changes the name (row name) of the independent variable.\n\n\n\n\n\n3. Add global-p\n\n# Add global-p\ndf$albumin3cat=as.factor(df$albumin3cat)\n\nt1 &lt;- coxph(Surv(time, status) ~ albumin3cat + sex + age,\n            data = df) %&gt;%\n  tbl_regression()  %&gt;%\n  add_global_p()\n\nt1\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\nlog(HR)\n95% CI\np-value\n\n\n\n\nalbumin3cat\n\n\n\n\n&lt;0.001\n\n\nÂ Â Â Â 1\nâ€”\nâ€”\n\n\n\n\nÂ Â Â Â 2\n-0.72\n-1.2, -0.27\n\n\n\n\nÂ Â Â Â 3\n-1.3\n-1.7, -0.77\n\n\n\n\nsex\n\n\n\n\n0.073\n\n\nÂ Â Â Â m\nâ€”\nâ€”\n\n\n\n\nÂ Â Â Â f\n-0.48\n-0.98, 0.02\n\n\n\n\nage\n0.03\n0.01, 0.05\n&lt;0.001\n\n\n\nAbbreviations: CI = Confidence Interval, HR = Hazard Ratio\n\n\n\n\n\n\n\n\nFigureÂ 3: Add global-p\n\n\n\n\nThis table adds global P values via add_global_p().\n\n\n4. Add q-value\n\n# Add q-value\nt1 &lt;- coxph(Surv(time, status) ~ albumin + sex + age,\n  data = df\n) %&gt;%\n  tbl_regression() %&gt;%\n  # Add a q-value column\n  add_q()\n\nt1\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\nlog(HR)\n95% CI\np-value\nq-value1\n\n\n\n\nalbumin\n-1.7\n-2.1, -1.2\n&lt;0.001\n&lt;0.001\n\n\nsex\n\n\n\n\n\n\n\n\n\n\nÂ Â Â Â m\nâ€”\nâ€”\n\n\n\n\n\n\nÂ Â Â Â f\n-0.56\n-1.1, -0.06\n0.027\n0.027\n\n\nage\n0.03\n0.01, 0.05\n0.004\n0.006\n\n\n\n1 False discovery rate correction for multiple testing\n\n\nAbbreviations: CI = Confidence Interval, HR = Hazard Ratio\n\n\n\n\n\n\n\n\nFigureÂ 4: Add q-value\n\n\n\n\nThe table adds a q-value column via add_q().\n\n\n5. Merge columns\n\n# Merge columns\nt1 &lt;- coxph(Surv(time, status) ~ albumin3cat + sex + age,\n            data = df) %&gt;%\n  tbl_regression()  %&gt;%\n  # Modify the header name\n  modify_header(p.value = \"**P**\",estimate=\"**log(HR) (CI)**\") %&gt;%\n  # Combine the score column and the CI column and apply to rows where the score is not NA\n  modify_column_merge(\n    pattern = \"{estimate} ({conf.low}, {conf.high})\",\n    rows = !is.na(estimate)\n  )\n\nt1\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\nlog(HR) (CI)\nP\n\n\n\n\nalbumin3cat\n\n\n\n\n\n\nÂ Â Â Â 1\nâ€”\n\n\n\n\nÂ Â Â Â 2\n-0.72 (-1.2, -0.27)\n0.002\n\n\nÂ Â Â Â 3\n-1.3 (-1.7, -0.77)\n&lt;0.001\n\n\nsex\n\n\n\n\n\n\nÂ Â Â Â m\nâ€”\n\n\n\n\nÂ Â Â Â f\n-0.48 (-0.98, 0.02)\n0.062\n\n\nage\n0.03 (0.01, 0.05)\n&lt;0.001\n\n\n\nAbbreviations: CI = Confidence Interval, HR = Hazard Ratio\n\n\n\n\n\n\n\n\nFigureÂ 5: Merge columns\n\n\n\n\nThis table merges the score column and the CI column, which is a common form. The table header is appropriately modified after the merger.\n\n\n\n\n\n\nTip\n\n\n\nImportant Functions modify_header / modify_column_merge:\nmodify_header:modify_header() can be used to modify the header name. label represents the variable column, p.value represents the P-value column, ci represents the confidence interval column, estimate represents the score column, conf.low represents the lower confidence interval, and conf.high represents the upper confidence interval.\nmodify_column_merge: The pattern parameter specifies the pattern of columns to be merged, and the rows parameter specifies the rows to apply the merge to.\n\n\n\n\n6. Model integration\nModel horizontal integrationåˆ\n\n# Model horizontal integration\nt1 &lt;- coxph(Surv(time, status) ~ albumin + sex + age,\n  data = df\n) %&gt;%\n  tbl_regression()\nt2 &lt;- glm(time ~ albumin + sex + age,\n  data = df\n) %&gt;%\n  tbl_regression()\n# t1, t2 model integration\nt3 &lt;- tbl_merge(\n  tbls = list(t1, t2),\n  tab_spanner = c(\"**Cox Model**\", \"**GLM Model**\")\n)\n\nt3\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\n\nCox Model\n\n\nGLM Model\n\n\n\nlog(HR)\n95% CI\np-value\nBeta\n95% CI\np-value\n\n\n\n\nalbumin\n-1.7\n-2.1, -1.2\n&lt;0.001\n1,128\n813, 1,442\n&lt;0.001\n\n\nsex\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nÂ Â Â Â m\nâ€”\nâ€”\n\n\nâ€”\nâ€”\n\n\n\n\nÂ Â Â Â f\n-0.56\n-1.1, -0.06\n0.027\n34\n-360, 428\n0.9\n\n\nage\n0.03\n0.01, 0.05\n0.004\n-7.7\n-20, 4.9\n0.2\n\n\n\nAbbreviations: CI = Confidence Interval, HR = Hazard Ratio\n\n\n\n\n\n\n\n\nFigureÂ 6: Model horizontal integration\n\n\n\n\nThis table uses tbl_merge to horizontally integrate the results of the Cox proportional hazards model and the generalized linear regression model for patients with pdb.\nModel vertical integration\n\n# Model vertical integration\nt1 &lt;- coxph(Surv(time, status) ~ albumin + sex + age,\n  data = df[df$hepato==0,]\n) %&gt;%\n  tbl_regression()\n\nt2 &lt;- coxph(Surv(time, status) ~ albumin + sex + age,\n  data = df[df$hepato==1,]\n) %&gt;%\n  tbl_regression()\n\ntbl_stack(list(t1, t2), group_header = c(\"Patients without hepato\", \"Patients with hepato\"))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\nlog(HR)\n95% CI\np-value\n\n\n\n\nPatients without hepato\n\n\nalbumin\n-1.4\n-2.3, -0.47\n0.003\n\n\nsex\n\n\n\n\n\n\n\n\nÂ Â Â Â m\nâ€”\nâ€”\n\n\n\n\nÂ Â Â Â f\n-1.1\n-1.9, -0.36\n0.004\n\n\nage\n0.06\n0.03, 0.09\n&lt;0.001\n\n\nPatients with hepato\n\n\nalbumin\n-1.4\n-2.0, -0.87\n&lt;0.001\n\n\nsex\n\n\n\n\n\n\n\n\nÂ Â Â Â m\nâ€”\nâ€”\n\n\n\n\nÂ Â Â Â f\n-0.29\n-0.97, 0.38\n0.4\n\n\nage\n0.01\n-0.01, 0.04\n0.3\n\n\n\nAbbreviations: CI = Confidence Interval, HR = Hazard Ratio\n\n\n\n\n\n\n\n\nFigureÂ 7: Model vertical integration\n\n\n\n\nThis table uses tbl_stack to longitudinally integrate the results of the Cox proportional hazards model for the two groups of pdb patients with and without hepato.",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> ğ‚ğ‹ğˆğğˆğ‚ğ’",
      "RegressionTable"
    ]
  },
  {
    "objectID": "Clinics/RegressionTable.html#application",
    "href": "Clinics/RegressionTable.html#application",
    "title": "Regression Analysis Table",
    "section": "Application",
    "text": "Application\n\n\n\n\n\n\nFigureÂ 8: Regression Analysis Table\n\n\n\nUnivariate and multivariate Cox regression analyses were performed to assess 3-year tumor recurrence in patients with intermediate-risk NMIBC. [1]\n\n\n\n\n\n\nFigureÂ 9: Regression Analysis Table\n\n\n\nThis regression analysis table shows the independent predictors of late total mortality in multivariable Cox regression analysis. [2]",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> ğ‚ğ‹ğˆğğˆğ‚ğ’",
      "RegressionTable"
    ]
  },
  {
    "objectID": "Clinics/RegressionTable.html#reference",
    "href": "Clinics/RegressionTable.html#reference",
    "title": "Regression Analysis Table",
    "section": "Reference",
    "text": "Reference\n[1] CHEN J X, HUANG W T, ZHANG Q Y, et al.Â The optimal intravesical maintenance chemotherapy scheme for the intermediate-risk group non-muscle-invasive bladder cancer[J]. BMC Cancer, 2023,23(1): 1018.\n[2] BENKE K, ÃGG B, SZABÃ“ L, et al.Â Bentall procedure: quarter century of clinical experiences of a single surgeon[J]. J Cardiothorac Surg, 2016,11: 19.",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> ğ‚ğ‹ğˆğğˆğ‚ğ’",
      "RegressionTable"
    ]
  },
  {
    "objectID": "Clinics/Nomogram.html",
    "href": "Clinics/Nomogram.html",
    "title": "Nomogram",
    "section": "",
    "text": "Simply put, a nomogram graphically displays the results of logistic regression or Cox regression. It uses the regression coefficient of each independent variable to develop a scoring criteria, assigning a score to each independent variable value. A total score is then calculated for each patient, and a conversion function is used to convert this score into the probability of a specific outcome for that patient.\nCommon nomogram names mainly consist of three parts: 1. The name of the variable in the prediction model: for example, â€œstage,â€ â€œgender,â€ and â€œageâ€ in the figure. Each variable is marked with a scale on the line segment, indicating the range of values for that variable. The length of the line segment reflects the degree of influence of that factor on the outcome event. 2. Score: This includes individual scores (â€œÎ²(X-m) termsâ€ in the figure) and a total score (â€œTotal scoreâ€). The individual scores represent the scores of each variable at different values, while the total score is the sum of all variable scores. 3. Predicted probability: for example, â€œmean statusâ€ represents the probability of death.",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> ğ‚ğ‹ğˆğğˆğ‚ğ’",
      "Nomogram"
    ]
  },
  {
    "objectID": "Clinics/Nomogram.html#example",
    "href": "Clinics/Nomogram.html#example",
    "title": "Nomogram",
    "section": "Example",
    "text": "Example\n\n\n\n\n\nAs indicated by the red arrows, find the individual scores for each variable for this patient. Finally, add up the individual scores for all variables to obtain the patientâ€™s total score. Based on this total score, draw a vertical line downward to determine the patientâ€™s risk of invasive lung adenocarcinoma.",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> ğ‚ğ‹ğˆğğˆğ‚ğ’",
      "Nomogram"
    ]
  },
  {
    "objectID": "Clinics/Nomogram.html#setup",
    "href": "Clinics/Nomogram.html#setup",
    "title": "Nomogram",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: readr, rms, survival, regplot\n\n\n# Installing packages\nif (!requireNamespace(\"readr\", quietly = TRUE)) {\n  install.packages(\"readr\")\n}\nif (!requireNamespace(\"rms\", quietly = TRUE)) {\n  install.packages(\"rms\")\n}\nif (!requireNamespace(\"survival\", quietly = TRUE)) {\n  install.packages(\"survival\")\n}\nif (!requireNamespace(\"regplot\", quietly = TRUE)) {\n  install.packages(\"regplot\")\n}\n\n# Load packages\nlibrary(readr)\nlibrary(rms)\nlibrary(survival)\nlibrary(regplot)",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> ğ‚ğ‹ğˆğğˆğ‚ğ’",
      "Nomogram"
    ]
  },
  {
    "objectID": "Clinics/Nomogram.html#data-preparation",
    "href": "Clinics/Nomogram.html#data-preparation",
    "title": "Nomogram",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe data were downloaded from the Phenotype file of the GDC TCGA Liver Cancer (LIHC) database in the Xena browser [2].\n\n## Loading data\nclinical &lt;- readr::read_tsv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/TCGA-LIHC.clinical.tsv\")\nLIHC &lt;- cbind(clinical$sample,clinical[,c('gender.demographic',\n                                             'vital_status.demographic',\n                                             'days_to_death.demographic',\n                                             'age_at_index.demographic',\n                                             'ajcc_pathologic_stage.diagnoses')])\ncolnames(LIHC) &lt;- c('bcr_patient_barcode','gender','status','time','age','stage')\ntable(LIHC$status)\n\n\n       Alive         Dead Not Reported \n         265          172            2 \n\nLIHC &lt;- LIHC[LIHC$status != 'Not Reported',]\nLIHC$status &lt;- as.numeric(ifelse(LIHC$status=='Dead','2','1') ) # Death is 2 in nomogram",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> ğ‚ğ‹ğˆğğˆğ‚ğ’",
      "Nomogram"
    ]
  },
  {
    "objectID": "Clinics/Nomogram.html#visualization",
    "href": "Clinics/Nomogram.html#visualization",
    "title": "Nomogram",
    "section": "Visualization",
    "text": "Visualization\n\n1. Basic Nomogram\nThe basic nomogram shows the results of modeling survival status (status) with age (age), sex (gender), and disease stage (stage) using a generalized linear model.\n\n# Basic Nomogram\ndd=datadist(LIHC)\noptions(datadist=\"dd\")\n## Build a logist model and draw a nomogram\nf1 &lt;- lrm(status ~ age + gender + stage , data =  LIHC)\nnom &lt;- nomogram(f1, fun=plogis, lp=F, funlabel=\"Risk\")\nplot(nom)\n\n\n\n\n\n\n\nFigureÂ 1: Basic Nomogram\n\n\n\n\n\nWe can also use the nomogram to show the results of the Cox regression model for modeling survival time (time), survival status (status) with age (age), gender (gender), and disease stage (stage).\n\n## Constructing a COX proportional hazards model\nf2 &lt;- psm(Surv(time,status) ~ age+gender+stage,data =  LIHC, dist='lognormal')\nmed &lt;- Quantile(f2) # Calculate median survival time\nsurv &lt;- Survival(f2) # Constructing a survival probability function\n## Draw a nomogram of the median survival time of COX regression\nnom &lt;- nomogram(f2, fun=function(x) med(lp=x),funlabel=\"Median Survival Time\")\nplot(nom)\n\n\n\n\n\n\n\nFigureÂ 2: Constructing a COX proportional hazards model\n\n\n\n\n\nWe can also plot the predicted 3-year-5-year-survival probabilities using a nomogram.\n\n## The time unit of LIHC data is \"days\". Here we plot the 3-year and 5-year survival probabilities.\nnom &lt;- nomogram(f2, fun=list(function(x) surv(1095, x),\n                             function(x) surv(1825, x),\n                             function(x) med(lp=x)),\n                funlabel=c(\"3-year Survival Probability\", \"5-year Survival Probability\",\"Median Survival Time\"))\nplot(nom, xfrac=.2)\n\n\n\n\n\n\n\nFigureÂ 3: Predict 3-5 year survival probability\n\n\n\n\n\n\n\n2. Beautify Nomogram\nIn addition to using nomogram for modeling and drawing, we can also use the survival package and regplot package for modeling and drawing. The figure below shows the construction and drawing of the model using a generalized linear model.\n\n# Displays logistic regression, supports \"lm\", \"glm\", \"coxph\", \"survreg\" and \"negbin\"\n## Plot a logistic regression, showing odds scale and confidence interval\nlihcglm &lt;- glm(status ~ age + gender + stage, data=LIHC )\nregplot(lihcglm, \n        observation=LIHC[1,], \n        odds=TRUE, \n        interval=\"confidence\")\n\n\n\n\n\n\n\nFigureÂ 4: Beautify Nomogram1\n\n\n\nThe figure below shows the construction and drawing of the model using the generalized linear model.\n\nlihccox &lt;- coxph(formula = Surv(time,status) ~ age+gender+stage , data = LIHC)\nregplot(lihccox,\n        observation=LIHC[2,], # Scoring and displaying the indicators of observation 2 on the nomogram\n        failtime = c(1095,1825),# Predict 3-year and 5-year mortality risk, the unit here is day\n        prfail = TRUE, # TRUE is required in cox regression\n        showP = T, # Whether statistical differences are shown\n        droplines = F, # Observation 2 Example Scoring Whether to Draw a Line\n        interval=\"confidence\") # Displaying credible intervals for observations\n\n[1] \"note: points tables not constructed unless points=TRUE \"\n\n\n\n\n\n\n\n\nFigureÂ 5: Beautify Nomogram2",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> ğ‚ğ‹ğˆğğˆğ‚ğ’",
      "Nomogram"
    ]
  },
  {
    "objectID": "Clinics/Nomogram.html#application",
    "href": "Clinics/Nomogram.html#application",
    "title": "Nomogram",
    "section": "Application",
    "text": "Application\n\n\n\n\n\n\nFigureÂ 6: Applications of Nomogram\n\n\n\nThis figure shows two schematics of clinical applications that integrate a 6-miRNA-based classifier with four clinicopathological risk factors to predict which patients are likely to benefit from adjuvant chemotherapy after surgery for stage II colon cancer. [2]",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> ğ‚ğ‹ğˆğğˆğ‚ğ’",
      "Nomogram"
    ]
  },
  {
    "objectID": "Clinics/Nomogram.html#reference",
    "href": "Clinics/Nomogram.html#reference",
    "title": "Nomogram",
    "section": "Reference",
    "text": "Reference\n[1] Goldman MJ, Craft B, Hastie M, et al.Â Visualizing and interpreting cancer genomics data via the Xena platform. Nat Biotechnol. 2020;38(6):675-678. doi:10.1038/s41587-020-0546-8\n[2] Zhang JX, Song W, Chen ZH, et al.Â Prognostic and predictive value of a microRNA signature in stage II colon cancer: a microRNA expression analysis [published correction appears in Lancet Oncol. 2014 Jan;15(1):e4]. Lancet Oncol. 2013;14(13):1295-1306. doi:10.1016/S1470-2045(13)70491-1",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> ğ‚ğ‹ğˆğğˆğ‚ğ’",
      "Nomogram"
    ]
  },
  {
    "objectID": "Composition/PieChart.html",
    "href": "Composition/PieChart.html",
    "title": "Pie Chart",
    "section": "",
    "text": "A pie chart is a basic chart in statistics, using sectors of different sizes to represent the magnitude of each item. A pie chart provides a visual understanding of the proportion of each data point within the overall data.",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Pie Chart"
    ]
  },
  {
    "objectID": "Composition/PieChart.html#example",
    "href": "Composition/PieChart.html#example",
    "title": "Pie Chart",
    "section": "Example",
    "text": "Example\n\n\n\n\n\nThe image is a very basic pie chart. The different colored and sized sectors represent different data items, which can intuitively show the proportion of each data group in the overall data.",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Pie Chart"
    ]
  },
  {
    "objectID": "Composition/PieChart.html#setup",
    "href": "Composition/PieChart.html#setup",
    "title": "Pie Chart",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming Language: R\nDependencies: ggplot2\n\n\n# Install packages\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# Load packages\nlibrary(ggplot2)",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Pie Chart"
    ]
  },
  {
    "objectID": "Composition/PieChart.html#data-preparation",
    "href": "Composition/PieChart.html#data-preparation",
    "title": "Pie Chart",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe data comes from the PubMed paper â€œThe epidemiology of lung cancer in Hungary based on the characteristics of patients diagnosed in 2018â€[1], which includes statistics on lung cancer staging.\n\n# Data writing: one column for grouping, one column for values.\ndata &lt;- data.frame(\n  group = c(\"I\", \"II\", \"III\", \"IV\", \"NA\"),\n  value = c(402, 955, 1252, 3343, 3567)\n)\n\nhead(data)\n\n  group value\n1     I   402\n2    II   955\n3   III  1252\n4    IV  3343\n5    NA  3567",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Pie Chart"
    ]
  },
  {
    "objectID": "Composition/PieChart.html#visualization",
    "href": "Composition/PieChart.html#visualization",
    "title": "Pie Chart",
    "section": "Visualization",
    "text": "Visualization\n\n1. Basic pie chart\n\n# Basic drawing - bar chart\np &lt;- ggplot(data, aes(x = \"\", y = value, fill = group)) +\n  geom_col() # First, draw a bar chart, then transform it into a pie chart using coord_polar().\n\np\n\n\n\n\nBasic drawing - bar chart\n\n\n\n\nDrawing a bar chart is an intermediate step in drawing a pie chart using ggplot2. Then, by performing coordinate polarization using coord_polar(), the pie chart can be obtained.\n\n# Basic pie chart\np &lt;- ggplot(data, aes(x = \"\", y = value, fill = group)) +\n  geom_col() + # First, draw a bar chart, then transform it into a pie chart using coord_polar().\n  coord_polar(theta = \"y\") # Used for drawing pie charts\n\np\n\n\n\n\nBasic pie chart\n\n\n\n\nThe image shows a pie chart drawn using ggplot2, but coordinate labels and scales are not necessary.\n\n\n2. Simple pie chart\n\n# Use theme_void() to remove elements such as grid, backgroundcolor, and axis.label.\np &lt;- ggplot(data, aes(x = \"\", y = value, fill = group)) +\n  geom_col() +\n  coord_polar(theta = \"y\") +\n  theme_void()\np\n\n\n\n\nSimple pie chart\n\n\n\n\nThis pie chart removes elements such as grid, background color, and axis.label, making it look cleaner.\n\n\n3. Custom colors\n\n# Use scale_fill_manual() to customize colors.\np &lt;- ggplot(data, aes(x = \"\", y = value, fill = group)) +\n  geom_col() +\n  coord_polar(theta = \"y\") +\n  theme_void() +\n  scale_fill_manual(values = c(\"red\",\"blue\",\"purple\",\"pink\",\"grey\")) # Custom colors\np\n\n\n\n\nCustom colors\n\n\n\n\nThis pie chart uses scale_fill_manual() to customize the colors. Note that you should not use scale_color_manual(); the color of the sector in the chart is the fill color.\n\n\n4. Add Labels\nBefore adding labels, you need to calculate their positions. Since only the y-axis value is used when drawing a pie chart, you only need to calculate the y-axis coordinates. A pie chart is derived from a bar chart, so you only need to calculate the center y-value of each bar. For example, if group=\"I\", based on the position of bar group I in the bar chart, label_loc will equal the height of the four groups below plus half the height of group I.\n\n# Calculate label position\ndata$label_loc &lt;- NA # Add a column for label positions to the original data frame, initially NA.\nfor (i in 1:length(data$group)) { # Loop through and calculate the label position of the group.\n  locate &lt;- data$value[i] / 2 # The label position is the center of the current group plus the height of the group below it. The height of the group below it is calculated using a loop.\n  if (i &lt; length(data$group)) {\n    for (j in (i + 1):length(data$group)) {\n      locate &lt;- locate + data$value[j]\n    }\n  }\n  data$label_loc[i] &lt;- locate # Finally, the location of this group of tags was obtained.\n}\n\n# Draw a labeled pie chart\np &lt;- ggplot(data, aes(x = \"\", y = value, fill = group)) +\n  geom_col() +\n  coord_polar(theta = \"y\") +\n  theme_void() +\n  geom_text(aes(y = label_loc, label = group)) + # y is the y-axis position of the label, and label is the label name.\n  theme(legend.position = \"None\") # Since the groups are used as labels, the legend is removed here.\np\n\n\n\n\nAdd Labels\n\n\n\n\nThe pie chart was successfully labeled, but the code is a bit cumbersome. Using Python or Râ€™s pie() function would be much simpler.\n\n\n5. Add percentage labels\n\n# 1.Calculate the label position (same as above).\ndata$label_loc &lt;- NA \nfor (i in 1:length(data$group)) {\n  locate &lt;- data$value[i] / 2 \nif (i &lt; length(data$group)) {\n    for (j in (i + 1):length(data$group)) {\n      locate &lt;- locate + data$value[j]\n    }\n  }\n  data$label_loc[i] &lt;- locate\n}\n# 2.Calculate percentage\ndata$label &lt;- NA \nsum &lt;- sum(data$value) \nfor (i in 1:length(data$group)) {\n  data$label[i] &lt;- paste0(round(data$value[i] / sum * 100, 1), \"%\")\n}\n\n# Draw a percentage label pie chart\np &lt;- ggplot(data, aes(x = \"\", y = value, fill = group)) +\n  geom_col() +\n  coord_polar(theta = \"y\") +\n  theme_void() +\n  geom_text(aes(y = label_loc, label = label))\np\n\n\n\n\nAdd percentage labels\n\n\n\n\nThe pie chart legend shows groups, and the labels display percentages, making it more aesthetically pleasing and intuitive.\n\n\n6. Place the label outside the pie chart\nSometimes there are many groups, and putting the labels inside the pie chart can make it look very crowded.\n\n# The code for calculating percentage labels and label positions remains unchanged.\n# 1.Calculate the label position (same as above).\ndata$label_loc &lt;- NA \nfor (i in 1:length(data$group)) { \n  locate &lt;- data$value[i] / 2 \nif (i &lt; length(data$group)) {\n    for (j in (i + 1):length(data$group)) {\n      locate &lt;- locate + data$value[j]\n    }\n  }\n  data$label_loc[i] &lt;- locate \n}\n# 2.Calculate percentage\ndata$label &lt;- NA \nsum &lt;- sum(data$value) \nfor (i in 1:length(data$group)) {\n  data$label[i] &lt;- paste0(round(data$value[i] / sum * 100, 1), \"%\")\n}\n\n# Adjusting the x-value in geom_text() will move the label inward (decreasing the x-value) or outward (increasing the x-value).\np &lt;- ggplot(data, aes(x = \"\", y = value, fill = group)) +\n  geom_col() +\n  coord_polar(theta = \"y\") +\n  theme_void() +\n  geom_text(aes(x = rep_len(1.6, length(group)), y = label_loc, label = label))\np\n\n\n\n\nPlace the label outside the pie chart\n\n\n\n\nThe labels on the pie chart are placed outside the pie chart itself, which makes the pie chart look more aesthetically pleasing, especially when there are many groups.\n\n\n7. Add labels to the lines pointing to the pie chart\n\n# The code for calculating percentage labels and label positions remains unchanged.\n# 1.Calculate the label position (same as above).\ndata$label_loc &lt;- NA \nfor (i in 1:length(data$group)) { \n  locate &lt;- data$value[i] / 2 \nif (i &lt; length(data$group)) {\n    for (j in (i + 1):length(data$group)) {\n      locate &lt;- locate + data$value[j]\n    }\n  }\n  data$label_loc[i] &lt;- locate \n}\n# 2.Calculate percentage\ndata$label &lt;- NA \nsum &lt;- sum(data$value) \nfor (i in 1:length(data$group)) {\n  data$label[i] &lt;- paste0(round(data$value[i] / sum * 100, 1), \"%\") \n}\n\n# The line segment can be defined by adjusting the values of x and xend in geom_segment(), where the x value is greater than the radius of the pie chart, the xend value is slightly less than the coordinates of the label, and y and yend are still vectors representing the positions of the labels.\np &lt;- ggplot(data, aes(x = \"\", y = value, fill = group)) +\n  geom_col() +\n  coord_polar(theta = \"y\") +\n  theme_void() +\n  geom_text(aes(x = rep_len(1.6, length(group)), y = label_loc, label = label)) +\n  geom_segment(aes(\n    x = rep_len(1.45, length(group)),\n    xend = rep_len(1.58, length(group)),\n    y = label_loc, yend = label_loc\n  ))\np\n\n\n\n\nAdd labels to the lines pointing to the pie chart.\n\n\n\n\nThe labels on the pie chart have corresponding line segments pointing to specific areas of the pie chart, preventing confusion when there are many groups.",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Pie Chart"
    ]
  },
  {
    "objectID": "Composition/PieChart.html#applications",
    "href": "Composition/PieChart.html#applications",
    "title": "Pie Chart",
    "section": "Applications",
    "text": "Applications\n\n\n\n\n\n\nFigureÂ 1: Applications of Pie Chart 1\n\n\n\nThe figure shows that the recurrence pattern after failure of first-line treatment for small cell lung cancer is mainly recurrence of the primary lesion (31%), followed by brain metastasis (17%), lung or pleural metastasis (7%), bone metastasis (7%), liver metastasis (7%), mediastinal or cervical lymph node metastasis (6%), adrenal metastasis (4%), abdominal lymph node metastasis (1%), pancreatic and intestinal metastasis (2%), and unknown (18%). [1]\n\n\n\n\n\n\nFigureÂ 2: Applications of Pie Chart 2\n\n\n\nThe chart shows that the use of folic acid supplements and the intake of folic acid-fortified foods are quite low, with 75% of participants reporting that they have never taken folic acid supplements. [2]\n\n\n\n\n\n\nFigureÂ 3: Applications of Pie Chart 3\n\n\n\nThe chart shows the number of publications on TAO in each country. Japan has published the most related articles (91, 16.46%), followed by China (74, 13.38%), the United States (71, 12.84%), Turkey (54, 9.76%), Iran (45, 8.14%), and others. [3]",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Pie Chart"
    ]
  },
  {
    "objectID": "Composition/PieChart.html#reference",
    "href": "Composition/PieChart.html#reference",
    "title": "Pie Chart",
    "section": "Reference",
    "text": "Reference\n[1] ZHOU Y, WU Z, WANG H, et al.Â Evaluation of the prognosis in patients with small-cell lung cancer treated by chemotherapy using tumor shrinkage rate-based radiomics[J]. Eur J Med Res, 2024,29(1): 401.\n[2] AKWAA H O, IFIE I, NKWONTA C, et al.Â Knowledge, awareness, and use of folic acid among women of childbearing age living in a peri-urban community in Ghana: a cross-sectional survey[J]. BMC Pregnancy Childbirth, 2024,24(1): 241.\n[3] LIU Z, ZHOU C, GUO H, et al.Â Knowledge Mapping of Global Status and Trends for Thromboangiitis Obliterans: A Bibliometrics and Visual Analysis[J]. J Pain Res, 2023,16: 4071-4087.",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Pie Chart"
    ]
  },
  {
    "objectID": "Composition/GroupedBarplot.html",
    "href": "Composition/GroupedBarplot.html",
    "title": "Grouped and Stacked Barplot",
    "section": "",
    "text": "Grouped bar charts, or clustered bar charts, extend the functionality of univariate or single-category bar charts to multivariate bar charts. In these charts, bars are grouped according to their categories, and colors represent distinguishing factors for other categorical variables. The bars are positioned to cater to a group or primary group, with colors representing secondary categories. Grouped bar charts are particularly suitable for displaying the distribution of multiple groups of categorical data across different variables, facilitating the observation and comparison of differences between different categorical variables across different measures.",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Grouped and Stacked Barplot"
    ]
  },
  {
    "objectID": "Composition/GroupedBarplot.html#example",
    "href": "Composition/GroupedBarplot.html#example",
    "title": "Grouped and Stacked Barplot",
    "section": "Example",
    "text": "Example\nGrouped bar chart\n\n\n\n\n\nThis is a grouped bar chart showing the average values (calyx length, calyx width, petal length, and petal width) of three iris species (setosa, versicolor, and virginica) in the iris dataset across four different measures. The x-axis represents the four measures, and the y-axis (mean value) represents the average of these measures. The different colored bars (Species) represent the three iris species: setosa (red), versicolor (green), and virginica (blue). For each measure, the average values for the three flowers are displayed side-by-side in a bar chart.\nStacked Bar Chart\n\n\n\n\n\nThis is a stacked bar chart showing the average values of three iris species (setosa, versicolor, and virginica) across four different measures in the iris dataset. The bars are stacked, so the total height shown is the sum of the averages for all three species. The x-axis (Measurement): Similar to the previous chart, it represents the four measurements (calyx length, calyx width, petal length, and petal width). The y-axis (Mean Value): Represents the overall average of these measurements (the stacked averages of all species). Different colors represent the different iris species: setosa (red), versicolor (green), and virginica (blue). The total bar height for each measurement represents the overall mean for all three species, while the different colors within the bars represent the contribution of each species to that measurement.",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Grouped and Stacked Barplot"
    ]
  },
  {
    "objectID": "Composition/GroupedBarplot.html#setup",
    "href": "Composition/GroupedBarplot.html#setup",
    "title": "Grouped and Stacked Barplot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming Language: R\nDependencies: ggplot2; hrbrthemes; viridis; dplyr; tidyr; tibble; RColorBrewer; streamgraph\n\n\n# Install packages\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"hrbrthemes\", quietly = TRUE)) {\n  install.packages(\"hrbrthemes\")\n}\nif (!requireNamespace(\"viridis\", quietly = TRUE)) {\n  install.packages(\"viridis\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"tidyr\", quietly = TRUE)) {\n  install.packages(\"tidyr\")\n}\nif (!requireNamespace(\"tibble\", quietly = TRUE)) {\n  install.packages(\"tibble\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\nif (!requireNamespace(\"streamgraph\", quietly = TRUE)) {\n  install.packages(\"streamgraph\")\n}\n\n# Load packages\nlibrary(ggplot2)\nlibrary(hrbrthemes)\nlibrary(viridis)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(tibble)\nlibrary(RColorBrewer)\nlibrary(streamgraph)",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Grouped and Stacked Barplot"
    ]
  },
  {
    "objectID": "Composition/GroupedBarplot.html#data-preparation",
    "href": "Composition/GroupedBarplot.html#data-preparation",
    "title": "Grouped and Stacked Barplot",
    "section": "Data Preparation",
    "text": "Data Preparation\nWe used the built-in R dataset iris and TCGA-CHOL.methylation450.tsv from the UCSC Xena website (UCSC Xena (xenabrowser.net)).\n\n# iris\niris_means &lt;- iris %&gt;%\n  group_by(Species) %&gt;%\n  summarise(\n    mean_sepal_length = mean(Sepal.Length),\n    mean_sepal_width = mean(Sepal.Width),\n    mean_petal_length = mean(Petal.Length),\n    mean_petal_width = mean(Petal.Width)\n  ) # Calculate the mean of the four columns for each species.\n\niris_means_long &lt;- iris_means %&gt;%\n  pivot_longer(\n    cols = starts_with(\"mean\"),\n    names_to = \"Measurement\",\n    values_to = \"Value\"\n  )\n\niris_means_df &lt;- as.data.frame(iris_means) %&gt;%\n  column_to_rownames(var = \"Species\")\niris_matrix &lt;- as.matrix(iris_means_df)\niris_percentage &lt;- apply(iris_matrix, 2, function(x) { x * 100 / sum(x, na.rm = TRUE) })\n\n# TCGA-CHOL.methylation450\nTCGA_methylation &lt;- readr::read_tsv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/TCGA-CHOL.methylation450_.tsv\")\n\nmethylation_subset &lt;- TCGA_methylation[c(5:9),c(4:13)]\nmethylation_subset &lt;- as.data.frame(methylation_subset)\nrownames(methylation_subset) &lt;- c(\"cg236\", \"cg289\", \"cg292\", \"cg321\", \"cg363\")\ncolnames(methylation_subset) &lt;- substr(colnames(methylation_subset), 9, 12)\n\nmethylation_long &lt;- methylation_subset %&gt;%\n  rownames_to_column(var = \"Composite\") %&gt;%\n  pivot_longer(cols = -Composite, names_to = \"sample\", values_to = \"value\")\n\nmethylation_long$sample &lt;- as.numeric(factor(methylation_long$sample, levels = unique(methylation_long$sample))) # Convert the sample column to ordered values.\n\n# TCGA-STAD.star_counts\nTCGA_star &lt;- readr::read_tsv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/TCGA-STAD.star_counts.tsv\")\n\nselected_rows &lt;- TCGA_star[TCGA_star$Ensembl_ID %in% c(\"ENSG00000141510.18\", \n                                                 \"ENSG00000141736.14\", \n                                                 \"ENSG00000121879.6\",\n                                                 \"ENSG00000133703.13\"), ]\nselected_rows &lt;- as.data.frame(selected_rows)\nrownames(selected_rows) &lt;- c(\"PIK3CA\", \"KRAS\", \"TP53\", \"HER2\")\nselected_counts &lt;- selected_rows[,-1]\n\ntumor_counts &lt;- selected_counts %&gt;% select(ends_with(\"01A\"))\nnormal_counts &lt;- selected_counts %&gt;% select(ends_with(\"11A\"))\n\nmean_tumor &lt;- rowMeans(tumor_counts, na.rm = TRUE)\nmean_normal &lt;- rowMeans(normal_counts, na.rm = TRUE)\nmean_values &lt;- data.frame(mean_tumor, mean_normal)\n\nmean_expression_long &lt;- mean_values %&gt;%\n  rownames_to_column(\"Gene\") %&gt;%\n  pivot_longer(cols = -Gene, \n               names_to = \"Measurement\", \n               values_to = \"Mean_Value\")",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Grouped and Stacked Barplot"
    ]
  },
  {
    "objectID": "Composition/GroupedBarplot.html#visualization",
    "href": "Composition/GroupedBarplot.html#visualization",
    "title": "Grouped and Stacked Barplot",
    "section": "Visualization",
    "text": "Visualization\n\n1. ggplot2 (using iris data)\nThe ggplot2 package is probably the best choice for building grouped and stacked bar charts. The input dataframe needs to have two categorical variables, which will be passed to the x and fill parameters of the aes() function. Switching from grouped to stacked charts is very easy thanks to the position parameter.\n\n1.1 Grouped bar chart\n\n# Grouped bar chart\np &lt;- ggplot(iris_means_long, aes(fill = Species, y = Value, x = Measurement)) + \n  geom_bar(position = \"dodge\", stat = \"identity\") +\n  scale_fill_manual(values = c(\"#4A8CC3\", \"#E37939\", \"#8FBC89\")) + \n  labs(x = \"Measurement\", \n       y = \"Mean Value\") + \n  theme_minimal()\n\np\n\n\n\n\nGrouped bar chart\n\n\n\n\nThis grouped bar chart displays the average values of three iris species (setosa, versicolor, and virginica) in the iris dataset across four different measurements: sepal length, sepal width, petal length, and petal width. For each measurement, the average values for the three species are shown side-by-side in a bar chart.\n\n\n1.2 Stacked Bar Chart\nStacked bar charts are very similar to grouped bar charts. However, in a stacked bar chart, the subgroups are displayed overlapping each other, rather than side by side. You can achieve a stacked bar chart by changing the position parameter of the grouped bar chart to stack.\n\n# Stacked Bar Chart\np &lt;- ggplot(iris_means_long, aes(fill = Species, y = Value, x = Measurement)) + \n  geom_bar(position = \"stack\", stat = \"identity\") +\n  scale_fill_manual(values = c(\"#4A8CC3\", \"#E37939\", \"#8FBC89\")) + \n  labs(x = \"Measurement\", \n       y = \"Mean Value\") + \n  theme_minimal()\n\np\n\n\n\n\nStacked Bar Chart\n\n\n\n\nThis is a stacked bar chart showing the average values of three iris species (setosa, versicolor, and virginica) across four different measurements (calyx length, calyx width, petal length, and petal width). Each bar represents a measurement, and the different colors within the bars represent the contribution of each species to the average. This stacked bar chart allows for comparison of the overall mean values across different measurements, as well as the relative contribution of each species to each measurement.\n\n\n1.3 Percentage stacked bar chart\nSimply switch the parameter to position=\"fill\" to create a percentage stacked bar chart. In a percentage stacked bar chart, the percentage of each subgroup is shown, allowing you to study how their proportions evolve within the whole.\n\n# Percentage stacked bar chart\np &lt;- ggplot(iris_means_long, aes(fill = Species, y = Value, x = Measurement)) + \n  geom_bar(position = \"fill\", stat = \"identity\") +\n  scale_fill_manual(values = c(\"#4A8CC3\", \"#E37939\", \"#8FBC89\")) + \n  labs(x = \"Measurement\", \n       y = \"Mean Value\") + \n  theme_minimal()\n\np\n\n\n\n\nPercentage stacked bar chart\n\n\n\n\nThis percentage-stacked bar chart displays the relative averages of different iris species (setosa, versicolor, and virginica) across various measurements, such as sepal length, sepal width, petal length, and petal width. By using a stacked fill method, the chart visually shows the relative contribution of each species to each measurement, helping us understand the characteristic differences between species. This visualization facilitates the identification of key characteristics of each species and aids in further classification and comparative analysis.\n\n\n1.4 Custom grouped bar chart\nYou can customize the image to make the graphic look more personalized. In the example below, the following customizations were made:\n\nAdd a title\nUse a theme\nChange the color palette\nCustomize the axis title\nChange the font size\n\n\n# Custom grouped bar chart\np &lt;- ggplot(iris_means_long, aes(fill=Species, y=Value, x=Measurement)) + \n  geom_bar(position=\"stack\", stat=\"identity\") +\n  scale_fill_viridis(discrete = TRUE) + # Palette\n  labs(title = \"Grouped Barchart of Iris Means\",  # title\n       x = \"Measurement\", \n       y = \"Mean Value\") + # Axis title\n  theme_ipsum() + # theme\n  theme(axis.text.x = element_text(size = 10)) + # Font size\n  xlab(\"\")\n\np\n\n\n\n\nCustom grouped bar chart\n\n\n\n\nThis grouped bar chart displays the average values of three iris species (setosa, versicolor, and virginica) in the iris dataset across four different measures: sepal length, sepal width, petal length, and petal width. For each measure, the average values for the three flowers are displayed side-by-side in a bar chart. Custom images enhance the visual appeal of the graph and improve the readability and comparability of the data.\n\nAdd numerical labels\n\nUse geom_text() to add numerical labels.\n\n# Add numerical labels\np &lt;- ggplot(iris_means_long, aes(fill = Species, y = Value, x = Measurement)) + \n  geom_bar(position = \"stack\", stat = \"identity\") +\n  scale_fill_viridis(discrete = TRUE) + \n  labs(title = \"Grouped Barchart of Iris Means\", \n       x = \"Measurement\", \n       y = \"Mean Value\") + \n  theme_ipsum() + \n  theme(axis.text.x = element_text(size = 10)) + \n  xlab(\"\") +\n  geom_text(aes(label = round(Value, 2)), \n            position = position_stack(vjust = 0.5), \n            color = \"white\", \n            size = 4)\n\np\n\n\n\n\nAdd numerical labels\n\n\n\n\nThis grouped bar chart displays the average values (sepal length, sepal width, petal length, and petal width) of three iris species (setosa, versicolor, and virginica) in the iris dataset across four different measurements. Under each measurement, the average values for the three species are shown in a side-by-side bar chart. Numerical labels enhance the dataâ€™s visual appeal and readability.\n\n\n1.5 Faceted bar chart\nFaceted bar charts can be used instead of stacked or grouped bar charts. The facet_wrap() function makes drawing faceted bar charts very simple.\n\n# Faceted bar chart\np &lt;- ggplot(iris_means_long, aes(fill = Species, y = Value, x = Measurement)) + \n  geom_bar(position = \"dodge\", stat = \"identity\") +\n  labs(x = \"Measurement\", \n       y = \"Mean Value\") + \n  facet_wrap(~Species) +\n  theme_minimal() +\n  scale_fill_manual(values = c(\"#F1C89A\", \"#E79397\", \"#A797DA\")) + \n  theme(axis.text.x = element_text(size = 6),\n        strip.text = element_blank()) +  \n  xlab(\"\")\n\np\n\n\n\n\nFaceted bar chart\n\n\n\n\nThis faceted bar chart divides the data for three different flower species (setosa, versicolor, and virginica) into three independent subplots, each showing the average values for the species across four measurements. Within each subplot, the four measurements (calyx length, calyx width, petal length, and petal width) are presented as side-by-side bars, allowing for a clearer analysis of the differences in each measurement within the species.\n\n\n\n2. ggplot2 (using TCGA data)\nThe ggplot2 package is probably the best choice for building grouped and stacked bar charts. The input dataframe needs to have two categorical variables, which will be passed to the x and fill parameters of the aes() function. Switching from grouped to stacked charts is very easy thanks to the position parameter.\n\n2.1 Grouped bar chart\n\n# Grouped bar chart\np &lt;- ggplot(mean_expression_long, aes(fill = Measurement, y = Mean_Value, x = Gene)) + \n  geom_bar(position = \"dodge\", stat = \"identity\") +\n  labs(x = \"Gene\", \n       y = \"Mean Value\") + \n  theme_minimal()\n\np\n\n\n\n\nGrouped bar chart\n\n\n\n\nThis grouped bar chart shows the average expression levels of different genes (PIK3CA, KRAS, TP53, and HER2) in tumor and normal samples from the TCGA-STAD.star_counts dataset. Different fill colors distinguish tumor and normal samples, facilitating comparison of gene expression differences between the two states. This visualization helps reveal the potential roles of genes in tumor biology and provides important information for future research.\n\n\n2.2 Stacked Bar Chart\n\n# Stacked Bar Chart\np &lt;- ggplot(mean_expression_long, aes(fill = Measurement, y = Mean_Value, x = Gene)) + \n  geom_bar(position = \"stack\", stat = \"identity\") +\n  labs(x = \"Gene\", \n       y = \"Mean Value\") + \n  theme_minimal()\n\np\n\n\n\n\nStacked Bar Chart\n\n\n\n\nThis stacked bar chart displays the mean expression levels of different genes (PIK3CA, KRAS, TP53, and HER2) in tumor and normal samples from the TCGA-STAD.star_counts dataset. Tumor and normal samples are distinguished by different fill colors to facilitate comparison of gene expression differences between the two states. The stacked bar chart also allows comparison of the overall mean values of different measurements, as well as the relative contribution of each species to each measurement.\n\n\n\n3. Base R\nUse built-in functions in R to create grouped and stacked bar charts.\n\n3.1 Grouped bar chart\nThe input dataset must be a matrix of numbers. Each group is a column. Each subgroup is a row. The barplot() function will recognize this format and group the data automatically. The beside parameter allows you to switch between grouped bar charts and stacked bar charts.\n\n# Grouped bar chart\nbarplot(iris_matrix, \n        col = colors()[c(23, 89, 12)], \n        border = \"white\", \n        font.axis = 2, \n        beside = TRUE, \n        legend.text = rownames(iris_matrix), \n        ylab = \"Mean Value\",\n        font.lab = 2)\n\n\n\n\nGrouped bar chart\n\n\n\n\nThis grouped bar chart displays the average values (calyx length, calyx width, petal length, and petal width) of three iris species (setosa, versicolor, and virginica) across four different measures. Each measure is represented by three bars side-by-side, each corresponding to the average value of one of the three species. The three species are distinguished by color, and the chart visually illustrates their differences across the various measures. Significant differences in certain characteristics between the different species are clearly visible.\n\n\n3.2 Stacked Bar Chart\nStacked bar charts are very similar to grouped bar charts. The subgroups are simply stacked on top of each other, rather than displayed side-by-side. Stacked bar charts are the default option for the barplot() underlying function in R, so you donâ€™t need to use the beside parameter.\n\n# Stacked Bar Chart\nbarplot(iris_matrix, \n        col = colors()[c(23, 89, 12)], \n        border = \"white\", \n        font.axis = 2, \n        legend.text = rownames(iris_matrix), \n        ylab = \"Mean Value\",\n        font.lab = 2)\n\n\n\n\nStacked Bar Chart\n\n\n\n\nThis is a stacked bar chart showing the average values of three iris species (setosa, versicolor, and virginica) across four different measurements (calyx length, calyx width, petal length, and petal width). Each bar represents a measurement, and the different colors within the bars represent the contribution of each species to the average. This stacked bar chart allows for comparison of the overall mean values across different measurements, as well as the relative contribution of each species to each measurement.\n\n\n3.3 Percentage stacked bar chart\nA percentage stacked bar chart shows the evolution of the proportion of each subgroup, with the sum always equal to 100%. In basic R, the percentages need to be calculated manually using the apply() function. Itâ€™s simpler to plot a percentage stacked bar chart using ggplot2.\n\n# Percentage stacked bar chart\ncoul &lt;- brewer.pal(3, \"Pastel2\") \nbarplot(iris_percentage, \n        col = coul,  \n        border = \"white\", \n        ylab = \"Mean Value\", \n        legend.text = rownames(iris_percentage)) \n\n\n\n\nPercentage stacked bar chart\n\n\n\n\nThis stacked bar chart shows the percentage distribution of three iris species (setosa, versicolor, and virginica) across four features (calyx length, calyx width, petal length, and petal width) in the iris dataset. Each bar represents a specific feature, and the color represents a different species. By stacking the species data together, the chart reflects the proportion of each species across the various features. The chart shows that virginica has a larger proportion in petal-related features, while setosa has a larger proportion in calyx width. This chart clearly demonstrates the relative performance of each species across the various features.",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Grouped and Stacked Barplot"
    ]
  },
  {
    "objectID": "Composition/GroupedBarplot.html#applications",
    "href": "Composition/GroupedBarplot.html#applications",
    "title": "Grouped and Stacked Barplot",
    "section": "Applications",
    "text": "Applications\n\n1. Grouped bar chart\n\n\n\n\n\n\nFigureÂ 1: Applications of grouped bar chart\n\n\n\nPerformance comparison with known features in the literature. [1]\n\n\n2. Stacked bar chart\n\n\n\n\n\n\nFigureÂ 2: Applications of stacked bar chart\n\n\n\nLocalization of MamI-GFP in several mutants and determination of complementation/localization of mutant MamL-GFP. [2]\n\n\n3. Circular stacked bar chart\n\n\n\n\n\n\nFigureÂ 3: Applications of circular stacked bar chart\n\n\n\nTissue-specific proteins in healthy blood plasma. [3]\n\n\n4. Flow graph\n\n\n\n\n\n\nFigureÂ 4: Applications of flow graph\n\n\n\nGut and salivary microbiota dynamics of two subjects were studied over a period of more than one year. (A) Flow plot showing OTU fractional abundance over time. Each flow represents an OTU, and flows are grouped by phylum: Firmicutes (purple), Bacteroidetes (blue), Proteobacteria (green), Actinobacteria (yellow), and Tenericutes (red). Flow width reflects the relative OTU abundance at a given time point. The time points sampled are represented by gray dots on each flow plot. (B) Horizontal plot showing the abundance of most common OTUs over time. Horizontal plots allow for rapid visual comparisons between numerous time series. The plot is created by first centering each OTU time series at the median, then dividing the curves into colored bars with widths equal to the absolute deviation of the median. Next, the colored bars are overlaid and negative values are mirrored upwards. Thus, warmer areas represent the date range where taxa exceed the median abundance, while cooler areas represent the range where taxa are below the median abundance. The colored squares on the vertical axis correspond to the flow colors in (A). [4]",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Grouped and Stacked Barplot"
    ]
  },
  {
    "objectID": "Composition/GroupedBarplot.html#reference",
    "href": "Composition/GroupedBarplot.html#reference",
    "title": "Grouped and Stacked Barplot",
    "section": "Reference",
    "text": "Reference\n[1] Eichner J, Kossler N, Wrzodek C, Kalkuhl A, Bach Toft D, Ostenfeldt N, Richard V, Zell A. A toxicogenomic approach for the prediction of murine hepatocarcinogenesis using ensemble feature selection. PLoS One. 2013 Sep 10;8(9):e73938. doi: 10.1371/journal.pone.0073938. PMID: 24040119; PMCID: PMC3769381.\n[2] Raschdorf O, Forstner Y, Kolinko I, Uebe R, Plitzko JM, SchÃ¼ler D. Genetic and Ultrastructural Analysis Reveals the Key Players and Initial Steps of Bacterial Magnetosome Membrane Biogenesis. PLoS Genet. 2016 Jun 10;12(6):e1006101. doi: 10.1371/journal.pgen.1006101. PMID: 27286560; PMCID: PMC4902198.\n[3] MalmstrÃ¶m E, KilsgÃ¥rd O, Hauri S, Smeds E, Herwald H, MalmstrÃ¶m L, MalmstrÃ¶m J. Large-scale inference of protein tissue origin in gram-positive sepsis plasma using quantitative targeted proteomics. Nat Commun. 2016 Jan 6;7:10261. doi: 10.1038/ncomms10261. PMID: 26732734; PMCID: PMC4729823.\n[4] David LA, Materna AC, Friedman J, Campos-Baptista MI, Blackburn MC, Perrotta A, Erdman SE, Alm EJ. Host lifestyle affects human microbiota on daily timescales. Genome Biol. 2014;15(7):R89. doi: 10.1186/gb-2014-15-7-r89. Erratum in: Genome Biol. 2016 May 31;17(1):117. doi: 10.1186/s13059-016-0988-y. PMID: 25146375; PMCID: PMC4405912.\n[5] Wickham, H. (2016). ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York. https://ggplot2.tidyverse.org\n[6] Garnier, S. (2018). viridis: Colorblind-Friendly Color Maps for R. https://cran.r-project.org/package=viridis\n[7] Wickham, H., FranÃ§ois, R., Henry, L., MÃ¼ller, K. (2023). dplyr: A Grammar of Data Manipulation. https://cran.r-project.org/package=dplyr\n[8] Wickham, H., Henry, L. (2023). tidyr: Tidy Messy Data. https://cran.r-project.org/package=tidyr\n[9] MÃ¼ller, K. (2023). tibble: Simple Data Frames. https://cran.r-project.org/package=tibble\n[10] Neuwirth, E. (2023). RColorBrewer: ColorBrewer Palettes. https://cran.r-project.org/package=RColorBrewer\n[11] Rudis, B. (2022). streamgraph: Create Streamgraphs and Streamgraph htmlwidgets. https://cran.r-project.org/package=streamgraph",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Grouped and Stacked Barplot"
    ]
  },
  {
    "objectID": "Composition/PartPieChart.html",
    "href": "Composition/PartPieChart.html",
    "title": "Part highlights the pie chart",
    "section": "",
    "text": "(Image by Amy Shamblen on Unsplash)\nPie charts are a common type of chart used in data visualization, allowing you to intuitively display the proportions of various components of a data set. By making certain parts of the pie chart appear raised, you can better highlight specific data points.",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Part Pie Chart"
    ]
  },
  {
    "objectID": "Composition/PartPieChart.html#example",
    "href": "Composition/PartPieChart.html#example",
    "title": "Part highlights the pie chart",
    "section": "",
    "text": "(Image by Amy Shamblen on Unsplash)\nPie charts are a common type of chart used in data visualization, allowing you to intuitively display the proportions of various components of a data set. By making certain parts of the pie chart appear raised, you can better highlight specific data points.",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Part Pie Chart"
    ]
  },
  {
    "objectID": "Composition/PartPieChart.html#setup",
    "href": "Composition/PartPieChart.html#setup",
    "title": "Part highlights the pie chart",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: ggplot2, dplyr, plotrix, ggforce, ggpubr, patchwork\n\n\n# Install packages\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"plotrix\", quietly = TRUE)) {\n  install.packages(\"plotrix\")\n}\nif (!requireNamespace(\"ggforce\", quietly = TRUE)) {\n  install.packages(\"ggforce\")\n}\nif (!requireNamespace(\"ggpubr\", quietly = TRUE)) {\n  install.packages(\"ggpubr\")\n}\nif (!requireNamespace(\"patchwork\", quietly = TRUE)) {\n  install.packages(\"patchwork\")\n}\n\n# Load packages\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(plotrix)\nlibrary(ggforce)\nlibrary(ggpubr)\nlibrary(patchwork)",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Part Pie Chart"
    ]
  },
  {
    "objectID": "Composition/PartPieChart.html#data-preparation",
    "href": "Composition/PartPieChart.html#data-preparation",
    "title": "Part highlights the pie chart",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Generate simulated data\ncount.data &lt;- data.frame(\n  class = c(\"1st\", \"2nd\", \"3rd\", \"Crew\"),\n  n = c(325, 285, 706, 885),\n  prop = c(14.8, 12.9, 32.1, 40.2)\n)\n# Add label position\ncount.data &lt;- count.data %&gt;%\n  arrange(desc(class)) %&gt;%\n  mutate(lab.ypos = cumsum(prop) - 0.5*prop)\n# View the final merged dataset\nhead(count.data)\n\n  class   n prop lab.ypos\n1  Crew 885 40.2    20.10\n2   3rd 706 32.1    56.25\n3   2nd 285 12.9    78.75\n4   1st 325 14.8    92.60",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Part Pie Chart"
    ]
  },
  {
    "objectID": "Composition/PartPieChart.html#visualization",
    "href": "Composition/PartPieChart.html#visualization",
    "title": "Part highlights the pie chart",
    "section": "Visualization",
    "text": "Visualization\n\n1. Basic Plot\n\n1.1 Basic pie chart\n\n# Basic pie chart\nmycols &lt;- c(\"#0073C2FF\", \"#EFC000FF\", \"#868686FF\", \"#CD534CFF\")\np &lt;- \n  ggplot(count.data, aes(x = \"\", y = prop, fill = class)) +\n  geom_bar(width = 1, stat = \"identity\", color = \"white\") +\n  coord_polar(\"y\", start = 0)+\n  geom_text(aes(y = lab.ypos, label = prop), color = \"white\")+\n  scale_fill_manual(values = mycols) +\n  theme_void()\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Basic pie chart\n\n\n\n\n\n\n\n1.2 Hole-in-the-middle pie chart\n\n# Hole-in-the-middle pie chart\np2 &lt;- \n  ggplot(count.data, aes(x = 2, y = prop, fill = class)) +\n  geom_bar(stat = \"identity\", color = \"white\") +\n  coord_polar(theta = \"y\", start = 0) +\n  geom_text(aes(y = lab.ypos, label = prop), color = \"white\") +\n  scale_fill_manual(values = mycols) +\n  theme_void() +\n  xlim(0.5, 2.5)\n\np2\n\n\n\n\n\n\n\nFigureÂ 2: Hole-in-the-middle pie chart\n\n\n\n\n\n\n\n\n2. Advanced Plot\n\n2.1 3D pie chart\n\n# Create a data frame\n# Generate labels (combined categories and percentages)\nlabels &lt;- paste(count.data$class, \"\\n\", count.data$prop, \"%\", sep=\"\")\n\n# Draw a 3D pie chart\np3 &lt;- pie3D(\n  count.data$n,                # Use quantity as value\n  labels = labels,             # Custom labels\n  explode = 0.1,               # Set sector interval\n  main = \"3D Pie\",\n  col = rainbow(nrow(count.data)), # Use rainbow colors\n  labelcex = 1.2,              # Label font size\n  theta = 1                    # Control the angle of the 3D effect\n)\n\n\n\n\n\n\n\nFigureÂ 3: 3D pie chart\n\n\n\n\n\n\n\n2.2 Part highlights the pie chart\n\n# Create a data frame\ndata &lt;- data.frame(\n  gene = c(\"HRAS\", \"NRAS\", \"RET fusion\", \"MAP2K1\", \"ROS1 fusion\", \"ERBB2\", \n           \"ALK fusion\", \"MET ex14\",  \"BRAF\", \"EGFR\", \"KRAS\", \"None\", \"RIT1\",\n           \"ERBB2 amp\", \"MET amp\", \"NF1\"),\n  percentage = c(0.4, 0.4, 0.9, 0.9, 1.7, 1.7, 1.3, 4.3,  7.0, 11.3, 32.2, 24.4,\n                 2.2, 0.9, 2.2, 8.3)\n)\ndata$gene &lt;- factor(data$gene,levels = data$gene)\ndata$focus = c(rep(0, 12), rep(0.2, 4))\ndata$anno &lt;- ifelse(data$gene == \"KRAS\", \"KRAS\\n(32.2%)\",\n                    ifelse(data$gene == \"EGFR\", \"EGFR\\n(11.3%)\",\n                           ifelse(data$gene == \"BRAF\", \"BRAF\\n(7.0%)\",\n                                  ifelse(data$gene == \"None\", \"None\\n(24.4%)\",\n                                         ifelse(data$gene == \"NF1\", \"NF1\\n(8.3%)\", NA)))))\ndata &lt;- \n  data %&gt;%\n  mutate(end_angle = 2*pi*cumsum(percentage)/100,\n         start_angle = lag(end_angle, default = 0),\n         mid_angle = 0.5*(start_angle + end_angle)) %&gt;%\n  mutate(legend = paste0(gene,\" (\",percentage,\"%)\"))\n\ndata$legend &lt;- factor(data$legend,levels = data$legend)\n\ncol &lt;- c(\"#891619\",\"#040503\",\"#AF353D\",\"#CF5057\",\"#EE2129\",\"#E7604D\",\"#F58667\",\"#F7A387\",\"#FBC4AE\",\"#FDE2D6\",\"#FDF1EA\",\"#AAD9C0\",\"#0073AE\",\"#069BDA\",\"#68B0E1\",\"#B8CBE8\")\n\n# Draw a pie chart using ggplot\npie &lt;- \n  ggplot() +\n  geom_arc_bar(data=data, stat = \"pie\", # Draw pie charts in normal Cartesian coordinates, not polar coordinates\n               aes(x0=0,y0=0,r0=0,r=2, # If you need a donut chart, just change r0 to 1.\n                   amount=percentage,\n                   fill=gene,color=gene,\n                   explode=focus)) +\n  geom_arc(data=data[1:8,], size=1,color=\"black\",\n           aes(x0=0, y0=0, r=2.1, start = start_angle, end = end_angle)) +\n  geom_arc(data=data[11,], size=1,color=\"grey60\",\n           aes(x0=0, y0=0, r=2, start = start_angle-0.3, end = end_angle+0.3)) +\n  geom_arc(data=data[13:15,], size = 1,color=\"black\",\n           aes(x0=0,y0=0,r=2.3,size = index,start = start_angle, end = end_angle))+\n  annotate(\"text\", x=1.3, y=0.9, label=expression(atop(italic(\"BRAF\"),\"(7.0%)\")), \n           size=6, angle=0, hjust=0.5) +\n  annotate(\"text\", x=1.4, y=0.08, label=expression(atop(italic(\"EGFR\"),\"(11.3%)\")),\n           size=6, angle=0, hjust=0.5) +\n  annotate(\"text\", x=0.2, y=-1.1, label=expression(atop(italic(\"KRAS\"),\"(32.2%)\")),\n           size=6, angle=0, hjust=0.5) +\n  annotate(\"text\", x=-1.2, y=0.1, label=\"None\\n(24.4%)\", size=6, angle=0, \n           hjust=0.5) +\n  annotate(\"text\", x=-0.5, y=1.75, label=expression(atop(italic(\"NF1\"),\"(8.3%)\")),\n           size=6, angle=0, hjust=0.5) +\n  coord_fixed() +\n  theme_no_axes() +\n  scale_fill_discrete(breaks=data$gene[c(1:8, 13:15)],\n                      labels=data$legend[c(1:8, 13:15)], type=col) +\n  scale_color_discrete(breaks=data$gene[c(1:8, 13:15)],\n                       labels=data$legend[c(1:8, 13:15)], type=col) +\n  theme(panel.border = element_blank(),\n        legend.margin = margin(t = 1,r = 0,b = 0,l = 0,unit = \"cm\"),\n        legend.title = element_blank(),\n        legend.text = element_text(size=14),\n        legend.key.spacing.y = unit(0.3,\"cm\"),\n        legend.key.width = unit(0.4,\"cm\"),\n        legend.key.height = unit(0.4,\"cm\"))\n\npie\n\n\n\n\n\n\n\nFigureÂ 4: Part highlights the pie chart\n\n\n\nIn cancer genomics research, pie charts can be used to show the distribution of different types of gene mutations (such as point mutations, insertions, deletions, etc.) in a specific sample.",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Part Pie Chart"
    ]
  },
  {
    "objectID": "Composition/PartPieChart.html#application",
    "href": "Composition/PartPieChart.html#application",
    "title": "Part highlights the pie chart",
    "section": "Application",
    "text": "Application\n\n1. Disease distribution\n\n\n\n\n\n\nFigureÂ 5: Disease distribution\n\n\n\nIn epidemiological studies, pie charts can be used to show the proportion of different diseases in a patient population, such as the distribution of different cancer types.\n\n\n2. Cell ratio chart\n\n\n\n\n\n\nFigureÂ 6: Cell ratio chart\n\n\n\nPie charts can be used to display the proportions of different cell types or tissue components in a tissue section.",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Part Pie Chart"
    ]
  },
  {
    "objectID": "Composition/PartPieChart.html#reference",
    "href": "Composition/PartPieChart.html#reference",
    "title": "Part highlights the pie chart",
    "section": "Reference",
    "text": "Reference\n[1] Wickham, H. (2016). â€œggplot2: Elegant Graphics for Data Analysis.â€ Springer.\n[2] Wickham, H. (2020). â€œggplot2: Create Elegant Data Visualizations Using the Grammar of Graphics.â€ R package version 3.3.3.\n[3] Pedersen, T. L. (2020). â€œggforce: Accelerating ggplot2.â€ R package version 0.3.2.\n[4] Kassambara, A. (2020). â€œggpubr: â€˜ggplot2â€™ Based Publication Ready Plots.â€ R package version 0.4.0.\n[5] Harris, R. (2019). â€œexport: Export â€˜ggplot2â€™ and â€˜baseâ€™ Graphics in Various Formats.â€ R package version 0.5.1.\n[6] Rizzo, M. L. (2021). â€œggplot2 for Beginners.â€ R Journal, 13(1), 84-91.\n[7] Ma, F., & Zhang, J. (2020). â€œExploring the use of R for visualizing complex data types.â€ Journal of Open Source Software, 5(51), 2008.",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Part Pie Chart"
    ]
  },
  {
    "objectID": "Composition/Donut.html",
    "href": "Composition/Donut.html",
    "title": "Donut Chart",
    "section": "",
    "text": "A donut chart is a circular plot divided into sectors, each sector representing a part of the whole. It is very similar to a pie chart and can be constructed in ggplot2 and basic R.",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Donut Chart"
    ]
  },
  {
    "objectID": "Composition/Donut.html#example",
    "href": "Composition/Donut.html#example",
    "title": "Donut Chart",
    "section": "Example",
    "text": "Example",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Donut Chart"
    ]
  },
  {
    "objectID": "Composition/Donut.html#setup",
    "href": "Composition/Donut.html#setup",
    "title": "Donut Chart",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming Language: R\nDependencies: ggplot2\n\n\n# Install packages\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# Load packages\nlibrary(ggplot2)",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Donut Chart"
    ]
  },
  {
    "objectID": "Composition/Donut.html#data-preparation",
    "href": "Composition/Donut.html#data-preparation",
    "title": "Donut Chart",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe main use of the TCGA database and the R built-in dataset mtcars.\n\n# 1.TCGA database (clinical data on lung cancer in 2020)\nTCGA_cli_df &lt;- readr::read_tsv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/raponi2006_public_raponi2006_public_clinicalMatrix.gz\")\n\n# 2.R built-in data - mtcars\nhead(mtcars)\n\n                   mpg cyl disp  hp drat    wt  qsec vs am gear carb\nMazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4\nMazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4\nDatsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1\nHornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1\nHornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2\nValiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Donut Chart"
    ]
  },
  {
    "objectID": "Composition/Donut.html#visualization",
    "href": "Composition/Donut.html#visualization",
    "title": "Donut Chart",
    "section": "Visualization",
    "text": "Visualization\n\n1. Basic Plotting\n\n1.1 Taking TCGA data as an example\n\n# Data Preparation\ncounts &lt;- table(TCGA_cli_df$T)\ncounts &lt;- as.data.frame(counts)\nnames(counts)[names(counts) == \"Var1\"] &lt;- \"T\"\n# Calculate percentage\ncounts$fraction = counts$Freq / sum(counts$Freq)\n# Calculate the cumulative percentage (the value at the top of each rectangle).\ncounts$ymax = cumsum(counts$fraction)\n# Calculate the bottom of each rectangle to determine the starting position\ncounts$ymin = c(0, head(counts$ymax, n=-1))\n# Plot\np &lt;- ggplot(counts, aes(ymax=ymax, ymin=ymin, xmax=4, xmin=3, fill=T)) +\n  geom_rect() +\n  coord_polar(theta=\"y\") + \n  xlim(c(2, 4)) \n\np\n\n\n\n\n\n\n\nFigureÂ 1: Taking TCGA data as an example\n\n\n\n\n\nThis donut chart describes the proportion of different tumor stages in the total sample.\n\n\n1.2 Beautify plot\n\nUse theme_void() to remove unnecessary backgrounds, axes, labels, etc.\nChange the colors.\nDonâ€™t use legends; add labels directly to the groups.\n\n\n# Calculate percentage\ncounts$fraction = counts$Freq / sum(counts$Freq)\n# Calculate the cumulative percentage (the value at the top of each rectangle).\ncounts$ymax = cumsum(counts$fraction)\n# Calculate the bottom of each rectangle to determine the starting position\ncounts$ymin = c(0, head(counts$ymax, n=-1))\n# Calculate label position\ncounts$labelPosition &lt;- (counts$ymax + counts$ymin) / 2\n# label Name\ncounts$label &lt;- paste0(counts$T, \"\\n value: \", counts$Freq)\n# Plot\np &lt;- ggplot(counts, aes(ymax=ymax, ymin=ymin, xmax=4, xmin=3, fill=T)) +\n  geom_rect() +\n  geom_label( x=3.5, aes(y=labelPosition, label=label), size=6) + # This line of code controls the addition of labels to the chart, and removing it can delete labels.\n  scale_fill_brewer(palette=4) +\n  coord_polar(theta=\"y\") +\n  xlim(c(2, 4)) +\n  theme_void() +\n  theme(legend.position = \"none\")\n\np\n\n\n\n\n\n\n\nFigureÂ 2: Beautify plot\n\n\n\n\n\nThis donut chart describes the proportion of different tumor stages in the total sample.\n\n\n1.3 Take mtcars data as an example\n\n# Data Preparation\ncounts1 &lt;- table(mtcars$cyl)\ncounts1 &lt;- as.data.frame(counts1)\nnames(counts1)[names(counts1) == \"Var1\"] &lt;- \"cyl\"\ncounts1$fraction = counts1$Freq / sum(counts1$Freq)\ncounts1$ymax = cumsum(counts1$fraction)\ncounts1$ymin = c(0, head(counts1$ymax, n=-1))\ncounts1$labelPosition &lt;- (counts1$ymax + counts1$ymin) / 2\ncounts1$label &lt;- paste0(counts1$T, \"\\n value: \", counts1$Freq)\np &lt;- ggplot(counts1, aes(ymax=ymax, ymin=ymin, xmax=4, xmin=3, fill=cyl)) +\n  geom_rect() +\n  coord_polar(theta=\"y\") + \n  xlim(c(2, 4)) \n\np\n\n\n\n\n\n\n\nFigureÂ 3: Take mtcars data as an example\n\n\n\n\n\nThis donut chart describes the proportion of different cylinder numbers in the total sample.\n\n\n\n2. Change the thickness of the ring\n\nIf xlim is set to a large left edge, there will be no empty rings. Youâ€™ll get a pie chart.\nIf xlim is set to a low value, the rings will be thinner.\n\n\n2.1 Taking TCGA data as an example\n\np &lt;- ggplot(counts, aes(ymax=ymax, ymin=ymin, xmax=4, xmin=3, fill=T)) +\n  geom_rect() +\n  geom_text( x=2, aes(y=labelPosition, label=label, color=T), size=6) + # X controls the label position.\n  scale_fill_brewer(palette=\"Set1\") +\n  scale_color_brewer(palette=\"Set1\") +\n  coord_polar(theta=\"y\") +\n  xlim(c(-1, 4)) +\n  theme_void() +\n  theme(legend.position = \"none\")\n\np\n\n\n\n\n\n\n\nFigureÂ 4: Taking TCGA data as an example\n\n\n\n\n\nThis donut chart describes the proportion of different tumor stages in the total sample.\n\n\n2.2 Take mtcars data as an example\n\np &lt;- ggplot(counts1, aes(ymax=ymax, ymin=ymin, xmax=4, xmin=3, fill=cyl)) +\n  geom_rect() +\n  geom_text( x=1.5, aes(y=labelPosition, label=label, color=cyl), size=6) + # X indicates whether the label position is inside or outside the loop.\n  scale_fill_brewer(palette=\"Set2\") +\n  scale_color_brewer(palette=\"Set2\") +\n  coord_polar(theta=\"y\") +\n  xlim(c(-1, 4)) +\n  theme_void() +\n  theme(legend.position = \"none\")\n\np\n\n\n\n\n\n\n\nFigureÂ 5: Take mtcars data as an example\n\n\n\n\n\nThis donut chart describes the proportion of different cylinder numbers in the total sample.",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Donut Chart"
    ]
  },
  {
    "objectID": "Composition/Donut.html#applications",
    "href": "Composition/Donut.html#applications",
    "title": "Donut Chart",
    "section": "Applications",
    "text": "Applications\n\n\n\n\n\n\nFigureÂ 6: Applications of Donut Chart 1\n\n\n\nThis circular plot shows the distribution among clusters of human hippocampal scRNA-seq data. [1]\n\n\n\n\n\n\nFigureÂ 7: Applications of Donut Chart 2\n\n\n\nThis circular diagram shows the proportion of activated APs in the two types of neurons. [1]",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Donut Chart"
    ]
  },
  {
    "objectID": "Composition/Donut.html#reference",
    "href": "Composition/Donut.html#reference",
    "title": "Donut Chart",
    "section": "Reference",
    "text": "Reference\n[1] de Ceglia R, Ledonne A, Litvin DG, Lind BL, Carriero G, Latagliata EC, Bindocci E, Di Castro MA, Savtchouk I, Vitali I, Ranjak A, Congiu M, Canonica T, Wisden W, Harris K, Mameli M, Mercuri N, Telley L, Volterra A. Specialized astrocytes mediate glutamatergic gliotransmission in the CNS. Nature. 2023 Oct;622(7981):120-129. doi: 10.1038/s41586-023-06502-w. Epub 2023 Sep 6. PMID: 37674083; PMCID: PMC10550825.\n[2] Huang KP, Acosta AA, Ghidewon MY, McKnight AD, Almeida MS, Nyema NT, Hanchak ND, Patel N, Gbenou YSK, Adriaenssens AE, Bolding KA, Alhadeff AL. Dissociable hindbrain GLP1R circuits for satiety and aversion. Nature. 2024 Aug;632(8025):585-593. doi: 10.1038/s41586-024-07685-6. Epub 2024 Jul 10. PMID: 38987598.\n[3] Wickham, H. (2016). ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York. https://ggplot2.tidyverse.org",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Donut Chart"
    ]
  },
  {
    "objectID": "Distribution/Beeswarm.html",
    "href": "Distribution/Beeswarm.html",
    "title": "Beeswarm Plot",
    "section": "",
    "text": "A beeswarm plot disperses data points slightly to prevent overlap, making distribution density and trends clearer. It is especially useful for visualizing categorical data in small datasets. This section presents examples using R and the beeswarm and ggbeeswarm packages.",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Beeswarm Plot"
    ]
  },
  {
    "objectID": "Distribution/Beeswarm.html#example",
    "href": "Distribution/Beeswarm.html#example",
    "title": "Beeswarm Plot",
    "section": "Example",
    "text": "Example",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Beeswarm Plot"
    ]
  },
  {
    "objectID": "Distribution/Beeswarm.html#setup",
    "href": "Distribution/Beeswarm.html#setup",
    "title": "Beeswarm Plot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming Language: R\nDependencies: readr, beeswarm, ggbeeswarm, ggsignif, plyr ,tidyverse\n\n\n# Installing necessary packages\nif (!requireNamespace(\"readr\", quietly = TRUE)) {\n  install.packages(\"readr\")\n}\nif (!requireNamespace(\"beeswarm\", quietly = TRUE)) {\n  install.packages(\"beeswarm\")\n}\nif (!requireNamespace(\"ggbeeswarm\", quietly = TRUE)) {\n  install.packages(\"ggbeeswarm\")\n}\nif (!requireNamespace(\"ggsignif\", quietly = TRUE)) {\n  install.packages(\"ggsignif\")\n}\nif (!requireNamespace(\"plyr\", quietly = TRUE)) {\n  install.packages(\"plyr\")\n}\nif (!requireNamespace(\"tidyverse\", quietly = TRUE)) {\n  install.packages(\"tidyverse\")\n}\n\n\n# Loading the libraries\nlibrary(readr)\nlibrary(beeswarm) # This simple and easy-to-use package allows the construction of bee swarm plots in R with just one or two lines of code.\nlibrary(ggbeeswarm) # This package is an extension of ggplot2, allowing direct construction of bee swarm plots from the ggplot2 package, with more adjustable options and greater flexibility, facilitating statistical difference analysis.\nlibrary(ggsignif)\nlibrary(plyr)\nlibrary(tidyverse)",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Beeswarm Plot"
    ]
  },
  {
    "objectID": "Distribution/Beeswarm.html#data-preparation",
    "href": "Distribution/Beeswarm.html#data-preparation",
    "title": "Beeswarm Plot",
    "section": "Data Preparation",
    "text": "Data Preparation\nWe used the built-in R dataset (iris), along with the TCGA.LIHC.clinicalMatrix and TCGA-LIHC.star_fpkm datasets from UCSC Xena DATASETS. Selected genes were chosen for demonstration purposes.\n\n# Load iris dataset\ndata(\"iris\")\n\n# Load the TCGA-LIHC gene expression dataset from a processed CSV file  \nTCGA_gene_expression &lt;- read.csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/TCGA-LIHC.star_fpkm_processed.csv\")\n\n# Load the TCGA-LIHC clinical info dataset\nTCGA_clinic &lt;- read.csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/TCGA.LIHC.clinicalMatrix.csv\") %&gt;%\n  mutate(T = as.factor(T))\n\n#Prepare Statistics data\ndata_summary &lt;- function(data, varname, groupnames) {\n  summary_func &lt;- function(x, col) {\n    c(mean = mean(x[[col]], na.rm = TRUE),\n      sd = sd(x[[col]], na.rm = TRUE))\n  }\n  data_sum &lt;- ddply(data, groupnames, .fun = summary_func, varname)\n  \n  data_sum &lt;- rename_with(data_sum, ~ varname, \"mean\")\n  \n  return(data_sum)\n}\niris_sum &lt;- data_summary(iris, varname=\"Sepal.Length\", groupnames=\"Species\")\nTCGA_gene_sum &lt;- data_summary(TCGA_gene_expression, varname=\"gene_expression\", groupnames=\"sample\")",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Beeswarm Plot"
    ]
  },
  {
    "objectID": "Distribution/Beeswarm.html#visualization",
    "href": "Distribution/Beeswarm.html#visualization",
    "title": "Beeswarm Plot",
    "section": "Visualization",
    "text": "Visualization\n\n1. Basic Beeswarm Plot (beeswarm package)\nFigureÂ 1 illustrates the distribution of the Sepal.Length variable in the iris dataset.\n\np1 &lt;- beeswarm(iris$Sepal.Length)\n\n\n\n\n\n\n\nFigureÂ 1: Basic Beeswarm\n\n\n\n\n\nFigureÂ 2 illustrates the distribution of the expression levels of the RAB4B gene in the LICH database.\n\nTCGA_gene_expression_RAB4B &lt;- subset(TCGA_gene_expression, sample == \"RAB4B\")\np1_2 &lt;- beeswarm(TCGA_gene_expression_RAB4B$gene_expression)\n\n\n\n\n\n\n\nFigureÂ 2: Basic Beeswarm\n\n\n\n\n\n\n\n2. Flipping the Beeswarm Plot (beeswarm package)\nFigureÂ 3 illustrates the distribution of the OS.time variable in TCGA dataset.\n\np2 &lt;- beeswarm(TCGA_clinic$OS.time, horizontal=TRUE)\n\n\n\n\n\n\n\nFigureÂ 3: Flipping the Beeswarm\n\n\n\n\n\n\n\n3. Changing Basic Features of the Beeswarm Plot (beeswarm package)\n\n\n\n\n\n\nTip\n\n\n\nKey Parameters:\n(1) Color\nBy modifying the col parameter, we can change the color of the points.\n(2) the Symbol of Points\nThe pch parameter allows the symbol of the points to be changed.\n(3) the Size of Points\nThe cex parameter allows the size of the points to be changed.\n(4) the Position of Points\nThe method parameter allows the position of the points to be changed. The available options are:\n\nswarm (default): Points are randomly placed but do not overlap.\ncenter: Points are symmetrically distributed around the center of the chart.\nhex: Points are placed on a hexagonal grid.\nsquare: Points are located on a square grid.\n\n\n\nFigureÂ 4 illustrates the distribution of the Sepal.Length variable in the iris dataset.\n\np3_1 &lt;- beeswarm(iris$Sepal.Length,col= \"blue\",pch=16,\n         cex=1.5,method=\"center\" )\n\n\n\n\n\n\n\nFigureÂ 4: Basic Features\n\n\n\n\n\nFigureÂ 5 illustrates the distribution of the OS.time variable in TCGA dataset.\n\np3_2 &lt;- beeswarm(TCGA_clinic$OS.time,col= \"blue\",pch=16,\n         cex=1.5,method=\"center\" )\n\n\n\n\n\n\n\nFigureÂ 5: Basic Features\n\n\n\n\n\n\n\n4. Grouping (beeswarm package)\nUsing the ~ operator, we can easily create a grouped bee swarm plot.\nFigureÂ 6 illustrates the distribution of the Sepal.Length variable across different Species.\n\np4_1 &lt;- beeswarm( Sepal.Length ~ Species, data=iris, \n         col=c(\"orange\", \"lightblue\", \"magenta\"), pch =19)\n\n\n\n\n\n\n\nFigureÂ 6: grouping\n\n\n\n\n\nFigureÂ 7 illustrates the distribution of the OS.time variable across different tumor stages.\n\np4_2 &lt;- beeswarm(OS.time ~ T, data=TCGA_clinic, \n         col=c(\"orange\", \"lightblue\", \"magenta\"), pch =19)\n\n\n\n\n\n\n\nFigureÂ 7: grouping\n\n\n\n\n\n\n\n5. Custom Position Behavior (beeswarm package)\n\n\n\n\n\n\nTip\n\n\n\nWhen there are many data points, changing the position behavior of the points can prevent overlap between groups.\nThe available options are:\n\nnone (default): No correction is applied.\ngutter: Sets higher and lower limits for each group.\nwrap: Similar to gutter, but adds random noise to the position of the points.\nrandom: Randomly positions the points.\nomit: Omits overlapping points.\n\n\n\nFigureÂ 8 illustrates the distribution of the Sepal.Length variable across different Species.\n\np5_1 &lt;- beeswarm( Sepal.Length ~ Species, data=iris,\n         col=c(\"orange\", \"lightblue\", \"magenta\"), pch =19,corral =\"gutter\")\n\n\n\n\n\n\n\nFigureÂ 8: Custom Position Behavior\n\n\n\n\n\nFigureÂ 9 illustrates the distribution of the OS.time variable across different tumor stages.\n\np5_2 &lt;- beeswarm( OS.time ~ T, data=TCGA_clinic, \n         col=c(\"orange\", \"lightblue\", \"magenta\"), pch =15,corral = \"gutter\")\n\n\n\n\n\n\n\nFigureÂ 9: Custom Position Behavior\n\n\n\n\n\n\n\n6. Basic Beeswarm (ggbeeswarm package)\nFigureÂ 10 illustrates the distribution of the Sepal.Length variable in the iris dataset.\n\np6_1 &lt;- ggplot(iris,aes(y=Sepal.Length,x='')) + \n  geom_beeswarm()\np6_1\n\n\n\n\n\n\n\nFigureÂ 10: Basic Beeswarm\n\n\n\n\n\nFigureÂ 11 illustrates the distribution of the OS.time variable in TCGA dataset.\n\np6_2 &lt;- ggplot(TCGA_clinic,aes(y=OS.time,x='')) + \n  geom_beeswarm()\np6_2\n\n\n\n\n\n\n\nFigureÂ 11: Basic Beeswarm\n\n\n\n\n\n\n\n7. Flipping the Beeswarm Plot (ggbeeswarm package)\nFigureÂ 12 illustrates the distribution of the Sepal.Length variable in the iris dataset.\n\np7_1 &lt;- ggplot(iris,aes(x=Sepal.Length,y='')) +\n  geom_beeswarm()\np7_1\n\n\n\n\n\n\n\nFigureÂ 12: Flipping the Beeswarm\n\n\n\n\n\nFigureÂ 13 illustrates the distribution of the OS.time variable in TCGA dataset.\n\np7_2 &lt;- ggplot(TCGA_clinic,aes(x=OS.time,y='')) + \n  geom_beeswarm()\np7_2\n\n\n\n\n\n\n\nFigureÂ 13: Flipping the Beeswarm\n\n\n\n\n\n\n\n8. Customization of the Beeswarm Plot (ggbeeswarm package)\n\n\n\n\n\n\nTip\n\n\n\nKey Parameters:\nWe can use the theme() function to change the color of the points and the overall theme of the chart.\n\n\nFigureÂ 14 illustrates the distribution of the Sepal.Length variable in the iris dataset.\n\np8_1 &lt;- ggplot(iris,aes(y=Sepal.Length,x='')) +  \n  geom_beeswarm(color='blue') +    \n  theme_minimal()\np8_1\n\n\n\n\n\n\n\nFigureÂ 14: Changing Basic Features\n\n\n\n\n\nFigureÂ 15 illustrates the distribution of the OS.time variable in TCGA dataset.\n\np8_2 &lt;- ggplot(TCGA_clinic,aes(y=OS.time,x='')) + \n  geom_beeswarm(color='blue') +    \n  theme_minimal()\np8_2\n\n\n\n\n\n\n\nFigureÂ 15: Changing Basic Features\n\n\n\n\n\n\n\n9. Changing the Position of Points (ggbeeswarm package)\nBy default, the geom_beeswarm() function uses the swarm method to position the points. We can change this behavior using the method parameter. The available options are:\n\nswarm: The default method.\ncompactswarm: Similar to swarm, but the points are more compact.\ncenter: Points are centered on the x-axis.\nhex: Points are located within hexagons.\nsquare: Points are located within squares.\n\nFigureÂ 16 illustrates the distribution of the Sepal.Length variable across different Species.\n\np9_1 &lt;- ggplot(iris,aes(y=Sepal.Length,x='')) +\n   geom_beeswarm(method='center')\np9_1\n\n\n\n\n\n\n\nFigureÂ 16: Changing the Position of Points\n\n\n\n\n\n\n\n10. Customizing the Color of Points (ggbeeswarm package)\nWe can also use the scale_color_manual() function to customize the colors. Additionally, the theme_minimal() function can make the chart look more elegant.\nFigureÂ 17 illustrates the distribution of the OS.time variable across different tumor stages.\n\np10_1 &lt;- ggplot(TCGA_clinic,aes(x=T, y=OS.time, colour=T)) +\n  geom_beeswarm() + \n  scale_color_manual(values=c(\"#999999\", \"#E69F00\", \"#56B4E9\",\"blue\")) +  \n  theme_minimal()\np10_1\n\n\n\n\n\n\n\nFigureÂ 17: Customizing the Color of Points\n\n\n\n\n\n\n\n11. Grouping and Adding Statistical Analysis (ggbeeswarm package)\nFigureÂ 18 illustrates the distribution of the Sepal.Length variable in the iris dataset.\n\np11_1 &lt;- ggplot()+\n  geom_bar(iris_sum,\n           mapping=aes(x=Species,y=Sepal.Length,fill=Species),\n           stat=\"identity\",width=.6,\n           alpha=0.5,position=position_dodge())+\n  geom_errorbar(iris_sum,\n                mapping=aes(x=Species,y=Sepal.Length,\n                            ymin=Sepal.Length-sd,\n                            ymax=Sepal.Length+sd),\n                width=.4,position=position_dodge(.8))+\n  geom_beeswarm(iris,\n                mapping=aes(x=Species,y=Sepal.Length,fill=Species),\n                shape=21,color='black',size=3.5,cex=1.2,stroke=0.6)+\n  geom_signif(iris,\n              mapping=aes(x=Species,y=Sepal.Length),\n              comparisons=list(c(\"setosa\",\"versicolor\"),c(\"setosa\",\"virginica\")),\n              test=\"t.test\",step_increase=0.2,tip_length=0,textsize=6,size=1,\n              map_signif_level=T)\np11_1\n\n\n\n\n\n\n\nFigureÂ 18: Grouping\n\n\n\n\n\nFigureÂ 19 illustrates the gene expression data of three genes in liver cancer.\n\np11_2 &lt;- ggplot()+\n  geom_bar(TCGA_gene_sum,\n           mapping=aes(x=sample,y=gene_expression,fill=sample),\n           stat=\"identity\",width=.6,alpha=0.5,position=position_dodge())+\n geom_errorbar(TCGA_gene_sum,\n               mapping=aes(x=sample,y=gene_expression,\n                           ymin=gene_expression-sd,ymax=gene_expression+sd),\n                          width=.4,position=position_dodge(.8))+\n geom_beeswarm(TCGA_gene_expression,\n               mapping=aes(x=sample,y=gene_expression,fill=sample),\n               shape=21,color='black',size=3.5,cex=1.2,stroke=0.6)+\n  geom_signif(TCGA_gene_expression,\n              mapping=aes(x=sample,y=gene_expression),\n              comparisons=list(c(\"RAB4B\",\"TIGAR\"),c(\"RAB4B\",\"RNF44\"),c(\"TIGAR\",\"RNF44\")),\n              test=\"t.test\",step_increase=0.2, tip_length=0,textsize=6,\n              size=1,map_signif_level=T)\np11_2\n\n\n\n\n\n\n\nFigureÂ 19: Grouping",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Beeswarm Plot"
    ]
  },
  {
    "objectID": "Distribution/Beeswarm.html#applications",
    "href": "Distribution/Beeswarm.html#applications",
    "title": "Beeswarm Plot",
    "section": "Applications",
    "text": "Applications\n\n1. Display Cell Density\n\n\n\n\n\n\nFigureÂ 20: Applications of Beeswarm Plot\n\n\n\nThe beeswarm plot shows the density of CD8+T cells in tumors with high or low FOLR2+cell density.[1]\n\n\n2.Displaying Gene Expression Data Across Different Samples\n\n\n\n\n\n\nFigureÂ 21: Applications of Beeswarm Plot\n\n\n\nThe beeswarm plot shows the distribution of gene expression levels at different structural variation (SV) sites.[2]",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Beeswarm Plot"
    ]
  },
  {
    "objectID": "Distribution/Beeswarm.html#reference",
    "href": "Distribution/Beeswarm.html#reference",
    "title": "Beeswarm Plot",
    "section": "Reference",
    "text": "Reference\n1.Nalio Ramos R,Missolo-Koussou Y,Gerber-Ferder Y, et al.Â Tissue-resident FOLR2 + macrophages associate with CD8 + TÂ cell infiltration in human breast cancer. Cell. 2022;185 (7):1189-1207.e25. doi:10.1016/j.cell.2022.02.021\n2.Zhou Y,Zhang Z,Bao Z, et al.Â Graph pangenome captures missing heritability and empowers tomato breeding. Nature. 2022;606 (7914):527-534. doi:10.1038/s41586-022-04808-9\n3.Wickham, H. (2009). ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York. ISBN 978-0-387-98140-6 (Print) 978-0-387-98141-3 (E-Book). [DOI: 10.1007/978-0-387-98141-3] (https://doi.org/10.1007/978-0-387-98141-3)\n4.Erik Clarke, Scott Sherrill-Mix, Charlotte Dawson (2023). ggbeeswarm: Categorical Scatter (Violin Point) Plots. R package version 0.7.2. https://CRAN.R-project.org/package=ggbeeswarm\n5.Aron Eklund, James Trimble (2021). beeswarm: The Bee Swarm Plot, an Alternative to Stripchart. R package version 0.4.0. https://CRAN.R-project.org/package=beeswarm\n6.Wickham, H. (2017). dplyr: A Grammar of Data Manipulation (Version 0.7.4). Retrieved from https://CRAN.R-project.org/package=dplyr\n7.Huber, W., Carey, V. J., Gentleman, R., Anders, S., & Carlson, M. (2015). Bioconductor: Support for the analysis and comprehension of high-throughput genomic data. R package version 3.2. F1000Research, 4, 1-22. Retrieved from https://www.bioconductor.org/ 54^\n8.The R Graph Gallery â€“ Help and inspiration for R charts (r-graph-gallery.com)",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Beeswarm Plot"
    ]
  },
  {
    "objectID": "Distribution/BreakPlot.html",
    "href": "Distribution/BreakPlot.html",
    "title": "Break Plot",
    "section": "",
    "text": "Example of a combo chart with breakpoints.",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "BreakPlot"
    ]
  },
  {
    "objectID": "Distribution/BreakPlot.html#example",
    "href": "Distribution/BreakPlot.html#example",
    "title": "Break Plot",
    "section": "",
    "text": "Example of a combo chart with breakpoints.",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "BreakPlot"
    ]
  },
  {
    "objectID": "Distribution/BreakPlot.html#setup",
    "href": "Distribution/BreakPlot.html#setup",
    "title": "Break Plot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: ggplot2; ggbreak; dplyr; ggpubr; RColorBrewer; rstatix\n\n\n# Installing necessary packages\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"ggbreak\", quietly = TRUE)) {\n  install.packages(\"ggbreak\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"ggpubr\", quietly = TRUE)) {\n  install.packages(\"ggpubr\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\nif (!requireNamespace(\"rstatix\", quietly = TRUE)) {\n  install.packages(\"rstatix\")\n}\n\n# Load packages\nlibrary(ggplot2)\nlibrary(ggbreak)\nlibrary(dplyr)\nlibrary(ggpubr)\nlibrary(RColorBrewer)\nlibrary(rstatix)",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "BreakPlot"
    ]
  },
  {
    "objectID": "Distribution/BreakPlot.html#data-preparation",
    "href": "Distribution/BreakPlot.html#data-preparation",
    "title": "Break Plot",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Data Preparation\ndf &lt;- ToothGrowth %&gt;%\n  group_by(supp, dose) %&gt;%\n  summarise(\n    mean_len = mean(len),\n    sd_len = sd(len),\n    n = n(),\n    se_len = sd_len/sqrt(n),\n    .groups = 'drop')\n\n\n# Statistical tests (key repair points)\nstat.test &lt;- ToothGrowth %&gt;%\n  group_by(dose) %&gt;%\n  t_test(len ~ supp) %&gt;%\n  add_xy_position(x = \"dose\", dodge = 0.8)\n\nhead(df)\n\n# A tibble: 6 Ã— 6\n  supp   dose mean_len sd_len     n se_len\n  &lt;fct&gt; &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;  &lt;dbl&gt;\n1 OJ      0.5    13.2    4.46    10  1.41 \n2 OJ      1      22.7    3.91    10  1.24 \n3 OJ      2      26.1    2.66    10  0.840\n4 VC      0.5     7.98   2.75    10  0.869\n5 VC      1      16.8    2.52    10  0.795\n6 VC      2      26.1    4.80    10  1.52",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "BreakPlot"
    ]
  },
  {
    "objectID": "Distribution/BreakPlot.html#visualization",
    "href": "Distribution/BreakPlot.html#visualization",
    "title": "Break Plot",
    "section": "Visualization",
    "text": "Visualization\n\n1. Basic BarPlot\nUse basic functions to draw the caption and description of the image.\n\n# Basic BarPlot\np1 &lt;- ggplot(df, aes(x=dose, y=mean_len, fill=supp)) +\n  geom_col(position=position_dodge(0.4), width=0.2) +\n  geom_errorbar(aes(ymin=mean_len-sd_len, ymax=mean_len+sd_len),\n                width=0.1, position=position_dodge(0.4)) +\n  scale_y_continuous(breaks = seq(0, 30, 5)) +\n  scale_y_cut(breaks=c(15), which=1, scales=1.5) +\n  labs(x=\"Dose (mg/day)\", y=\"Tooth Length (mm)\") +\n  theme_classic()\n\np1\n\n\n\n\n\n\n\nFigureÂ 1: Basic BarPlot\n\n\n\n\n\n2. Grouped scatter plot\n\n# Grouped scatter plot\np2 &lt;- ggplot(ToothGrowth, aes(x=dose, y=len, color=supp)) +\n  geom_point(position=position_jitterdodge(jitter.width=0.2)) +\n  scale_y_continuous(breaks = seq(0, 40, 5)) +\n  scale_y_cut(breaks=c(15, 25), which=c(1,2), scales=c(1.5, 1)) +\n  labs(x=\"Dose (mg/day)\", y=\"Tooth Length (mm)\") +\n  theme_bw()\n\np2\n\n\n\n\n\n\n\nFigureÂ 2: Grouped scatter plot\n\n\n\n\n\n3. Line plot\n\n# Line plot\np3 &lt;- ggplot(df, aes(x=dose, y=mean_len, color=supp)) +\n  geom_line(linewidth=1) +\n  geom_point(size=3) +\n  scale_y_continuous(breaks = seq(0, 30, 5)) +\n  scale_y_cut(breaks=c(15), which=1, scales=1.5) +\n  labs(x=\"Dose (mg/day)\", y=\"Mean Tooth Length (mm)\") +\n  theme_minimal()\n\np3\n\n\n\n\n\n\n\nFigureÂ 3: Line plot\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nKey Parameters:\nbreaks: Sets the breakpoint positions\nwhich: Specifies the breakpoint interval (counting from the bottom up)\nscales: Sets the scale factor for each interval\nspace: Breakpoint spacing (default 0.1)\nposition_dodge(): Controls the spacing between grouped bars\nwidth is recommended to match the width parameter of geom_col.\n\n\n\n\n4. More advanced charts\n\n# More advanced charts\nmy_colors &lt;- c(\"#1B9E77\", \"#D95F02\")  # æ¥è‡ªRColorBrewerçš„Set2è°ƒè‰²æ¿\np4 &lt;- ggplot(df, aes(x = factor(dose), y = mean_len, fill = supp)) +\n  geom_col(position = position_dodge(0.8), width = 0.7, alpha = 0.9) +\n  geom_errorbar(\n    aes(ymin = mean_len - se_len, ymax = mean_len + se_len),\n    width = 0.2, position = position_dodge(0.8)\n  ) +\n  geom_text(\n    aes(group = supp, label = sprintf(\"%.1fÂ±%.1f\", mean_len, se_len)),\n    position = position_dodge(0.8), vjust = -1, size = 4\n  ) +\n  scale_y_continuous(\n    breaks = seq(0, 35, 5) # å¢åŠ ä¸Šæ–¹æ‰©å±•ç©ºé—´\n  ) +\n  scale_y_break(c(8,12)\n  ) +\n  scale_fill_manual(values = my_colors) +\n  labs(x = \"Dose (mg/day)\", y = \"Tooth Length (mm)\", fill = \"Supplement\") +\n  theme_minimal(base_size = 12) +\n  theme(\n    legend.position = \"top\",\n    panel.grid.major.x = element_blank()\n  )\n\np4\n\n\n\n\n\n\n\nFigureÂ 4: More advanced charts",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "BreakPlot"
    ]
  },
  {
    "objectID": "Distribution/BreakPlot.html#application",
    "href": "Distribution/BreakPlot.html#application",
    "title": "Break Plot",
    "section": "Application",
    "text": "Application\nShow the practical application of visualization charts in biomedical literature. If basic charts/advanced charts are widely used in various types of biomedical literature, you can choose to display them separately.\n\n1. Gene expression visualization (handling extreme outliers)\n\n\n\n\n\n\nFigureÂ 5: Applications of Break Plot\n\n\n\nChanges in gene expression are shown. [1]\n\n\n2. Clinical indicator distribution display (processing data of different dimensions)\n\n\n\n\n\n\nFigureÂ 6: Applications of Break Plot\n\n\n\nThe figure shows the changes in (A) [organ weight] and (B) organ-to-body weight ratio of the uteroplacenta, liver, kidney, heart, pancreas, and thymus at different stages of maternal pregnancy. [2]",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "BreakPlot"
    ]
  },
  {
    "objectID": "Distribution/BreakPlot.html#reference",
    "href": "Distribution/BreakPlot.html#reference",
    "title": "Break Plot",
    "section": "Reference",
    "text": "Reference\n[1] Xu S, et al.Â (2022) ggbreak: Effective Axis Break Creation in ggplot2. Journal of Open Source Software 7(74), 4301\n[2] Yu D, Wang H, Shyh-Chang N. A multi-tissue metabolome atlas of primate pregnancy. Cell. 2024 Feb 1;187(3):764-781.e14. doi: 10.1016/j.cell.2023.11.043.\n[3] Chen LQ, Hou BH, Mudgett MB, Frommer WB. Sugar transporters for intercellular exchange and nutrition of pathogens. Nature. 2010 Nov 25;468(7323):527-32. doi: 10.1038/nature09606.",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "BreakPlot"
    ]
  },
  {
    "objectID": "Distribution/Ridgeline.html",
    "href": "Distribution/Ridgeline.html",
    "title": "Ridgeline Plot",
    "section": "",
    "text": "A ridgeline plot, also known as a joyplot, visualizes the distribution of multiple numeric variables across different categories. This method is useful for comparing density distributions while preserving an overall view of trends and variations.",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Ridgeline Plot"
    ]
  },
  {
    "objectID": "Distribution/Ridgeline.html#example",
    "href": "Distribution/Ridgeline.html#example",
    "title": "Ridgeline Plot",
    "section": "Example",
    "text": "Example\n\n\n\n\n\nA Ridgeline plot represents the distribution of a numeric variable across several groups. In this example, the plot displays the distribution of diamond prices across different quality categories. The x-axis represents price values, while the density curves illustrate how frequently each price occurs within each quality group.",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Ridgeline Plot"
    ]
  },
  {
    "objectID": "Distribution/Ridgeline.html#setup",
    "href": "Distribution/Ridgeline.html#setup",
    "title": "Ridgeline Plot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming Language: R\nDependencies: readr, ggplot2, ggridges, viridis, hrbrthemes\n\n\n# Installing necessary packages\nif (!requireNamespace(\"readr\", quietly = TRUE)) {\n  install.packages(\"readr\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"ggridges\", quietly = TRUE)) {\n  install.packages(\"ggridges\")\n}\nif (!requireNamespace(\"hrbrthemes\", quietly = TRUE)) {\n  remotes::install_github(\"hrbrmstr/hrbrthemes\")\n}\nif (!requireNamespace(\"viridis\", quietly = TRUE)) {\n  install.packages(\"viridis\")\n}\n\n# Loading the libraries\nlibrary(readr)      # For reading TSV files\nlibrary(dplyr)      # For data manipulation\nlibrary(ggplot2)    # For creating plots\nlibrary(ggridges)   # For density ridgeline plots\nlibrary(hrbrthemes) # For enhanced ggplot2 themes\nlibrary(viridis)    # For color maps",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Ridgeline Plot"
    ]
  },
  {
    "objectID": "Distribution/Ridgeline.html#data-preparation",
    "href": "Distribution/Ridgeline.html#data-preparation",
    "title": "Ridgeline Plot",
    "section": "Data Preparation",
    "text": "Data Preparation\nHereâ€™s a brief tutorial using the built-in R datasets (iris) and the Lung Cancer (Raponi 2006) dataset from UCSC Xena DATASETS.\n\n# Load iris dataset\ndata(\"iris\")\n\n# Load Lung Cancer (Raponi 2006) clinical data\nTCGA_clinic &lt;- readr::read_tsv(\"https://ucsc-public-main-xena-hub.s3.us-east-1.amazonaws.com/download/raponi2006_public%2Fraponi2006_public_clinicalMatrix.gz\") %&gt;%\n  mutate(T = as.factor(T))\nhead(TCGA_clinic)\n\n# A tibble: 6 Ã— 16\n  sampleID   Age Differentiation Gender Histology     M     N Race \n  &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt;           &lt;chr&gt;  &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;\n1 LS-1        75 mod_poor        M      SCC           0     0 w    \n2 LS-10       61 poor            F      SCC           0     0 w    \n3 LS-100      72 mod             M      SCC           0     0 w    \n4 LS-101      75 mod             M      SCC           0     1 w    \n5 LS-102      76 mod             F      SCC           0     0 w    \n6 LS-103      58 well_mod        M      SCC           0     1 w    \n# â„¹ 8 more variables: Smoking_History_Packyears &lt;dbl&gt;, Stage &lt;chr&gt;,\n#   OS.time &lt;dbl&gt;, T &lt;fct&gt;, OS &lt;chr&gt;, `_INTEGRATION` &lt;chr&gt;, `_PATIENT` &lt;chr&gt;,\n#   `_GENOMIC_ID_raponi2006` &lt;chr&gt;",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Ridgeline Plot"
    ]
  },
  {
    "objectID": "Distribution/Ridgeline.html#visualization",
    "href": "Distribution/Ridgeline.html#visualization",
    "title": "Ridgeline Plot",
    "section": "Visualization",
    "text": "Visualization\n\n1. Basic Ridgeline Plot\nFigureÂ 1 illustrates the distribution of the Sepal.Length variable across different Species.\n\n# Basic Ridgeline plot\np1_1 &lt;- ggplot(iris, aes(x = Sepal.Length, y = Species, fill = Species)) +\n  geom_density_ridges(alpha = 0.5) +\n  theme_ridges(font_size = 16, grid = TRUE) +\n  theme(legend.position = \"right\")\n\np1_1\n\n\n\n\n\n\n\nFigureÂ 1: Basic Ridgeline Plot Using the iris Dataset\n\n\n\n\n\nFigureÂ 2 illustrates the distribution of the OS.time variable across primary tumor conditions and survival status.\n\n# Basic Ridgeline plot\np1_2 &lt;- ggplot(TCGA_clinic, aes(x = OS.time, y = T, fill = T)) +\n  geom_density_ridges(alpha = 0.5, scale = 2) +\n  theme_ridges(font_size = 16, grid = TRUE) +\n  theme(legend.position = \"right\")\n\np1_2\n\n\n\n\n\n\n\nFigureÂ 2: Basic Ridgeline Plot Using the Lung Cancer (Raponi 2006) Dataset\n\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nKey function notes: geom_density_ridges() / theme_ridges()\ngeom_density_ridges()\ngeom_density_ridges is a very flexible function that can be used to create multiple styles of ridgeline plots.\nHere are some commonly used parameters and options for geom_density_ridges():\n\nalpha: Sets the transparency.\ncolour: Sets the line color.\nfill: Fills colors based on categorical variables.\nscale: Controls the overlap between ridges.\n\ntheme_ridges()\ntheme_ridges is a theme function provided by the ggridges package specifically for beautifying ridge plots.\nThe parameters of this function include:\n\n**font_size**: Overall font size, default is 14.\nline_size: Default line size.\ngrid: If set to TRUE (default), it will draw a background grid; if set to FALSE, the background will be blank.\n\n\n\n\n\n2. Histogram Ridgeline Plots\nHistogram ridgeline plots are ideal for displaying data distributions and counts, whereas traditional ridgeline plots are better suited for comparing distribution shapes across categories. Density can be represented in various ways; for instance, setting stat = â€œbinlineâ€ creates a histogram-like appearance for each distribution.\nFigureÂ 3 illustrates the Sepal The distribution of the Length variable on different specifications.\n\np2_1 &lt;- ggplot(iris, aes(x = Sepal.Length, y = Species, fill = Species)) +\n  geom_density_ridges(alpha = 0.5, stat = \"binline\", bins = 10) +\n  theme_ridges(font_size = 16, grid = TRUE) +\n  theme(legend.position = \"none\")\n\np2_1\n\n\n\n\n\n\n\nFigureÂ 3: Histogram Ridgeline Plots Using the iris Dataset\n\n\n\n\n\nFigureÂ 4 illustrates the distribution of the OS.time variable in primary tumor conditions and survival status\n\np2_2 &lt;- ggplot(TCGA_clinic, aes(x = OS.time, y = T, fill = T)) +\n  geom_density_ridges(alpha = 0.5, stat = \"binline\", bins = 10) +\n  theme_ridges(font_size = 16, grid = TRUE) +\n  theme(legend.position = \"none\")\n\np2_2\n\n\n\n\n\n\n\nFigureÂ 4: Histogram Ridgeline Plots Using the Lung Cancer (Raponi 2006) Dataset\n\n\n\n\n\n\n\n3. Ridgeline Plot with Variable Colors\nColors can be assigned based on numerical variables instead of categorical ones, allowing for a more intuitive visualization of changes in data size.\nFigureÂ 5 illustrates the Sepal The distribution of the Length variable on different specifications.\n\np3_1 &lt;- ggplot(iris, aes(x = Sepal.Length, y = Species, fill = ..x..)) +  # Create ridge plot\n  geom_density_ridges_gradient(scale = 3, rel_min_height = 0.01) +  # Adjust parameters\n  scale_fill_viridis(name = \"Sepal.Length\", option = \"C\") +  # Adjust color mapping\n  labs(title = 'Sepal.Length in iris') + \n  theme_ipsum() +   # Set image theme\n  theme(legend.position = \"bottom\",  \n        panel.spacing = unit(0.1, \"lines\"),\n        strip.text.x = element_text(size = 8))\n\np3_1\n\n\n\n\n\n\n\nFigureÂ 5: Ridgeline Plot with Variable Colors Using the iris Dataset\n\n\n\n\n\nFigureÂ 6 illustrates the distribution of the OS.time variable in primary tumor conditions and survival status.\n\np3_2 &lt;- ggplot(TCGA_clinic, aes(x = OS.time, y = T, fill = ..x..)) +  # Create ridge plot\n  geom_density_ridges_gradient(scale = 1, rel_min_height = 0.01) +  # Adjust parameters\n  scale_fill_viridis(name = \"OS.time\", option = \"C\") +  # Adjust color mapping\n  labs(title = 'Distribution of OS.time in different tumor staging') + \n  theme_ipsum() +   # Set image theme\n  theme(legend.position = \"bottom\", panel.spacing = unit(0.1, \"lines\"),\n        strip.text.x = element_text(size = 8))\n\np3_2\n\n\n\n\n\n\n\nFigureÂ 6: Ridgeline Plot with Variable Colors Using the Lung Cancer (Raponi 2006) Dataset\n\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nKey function notes: scale_fill_viridis() / theme_ipsum()\nscale_fill_viridis()\nThis function from the viridis package provides color mapping schemes for continuous data.\nCommonly used parameters include:\n\nbegin and end: Control the start and end positions of the color mapping (values between 0 and 1).\ndirection: Controls the color direction.\n\nA value of 1 gradually darkens the color from low to high values.\nA value of -1 reverses this direction.\n\noption: Selects a predefined color scheme from the viridis package (e.g., â€œmagmaâ€, â€œinfernoâ€, or â€œplasmaâ€).\naesthetics: Specifies whether the color is applied to the fill (fill) or the outline (colour).\n\ntheme_ipsum()\nThis function from the hrbrthemes package provides a predefined theme for ggplot2.\nHere are some themes available in the hrbrthemes package:\n\ntheme_ipsum(): The core theme, featuring Arial Narrow font and emphasizing good typography and readability.\ntheme_ft_rc(): A clean and precise theme with a focus on typography.\ntheme_ipsum_rc(): A variant of theme_ipsum(), with possible different typography or color choices.\ntheme_ipsum_tw(): A theme designed for Twitter branding, using Twitterâ€™s colors and font styles.\ntheme_ipsum_ps(): Optimized for print design with specific typography and color choices.\ntheme_modern_rc(): A modern, minimalist theme suited for contemporary data visualization needs.",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Ridgeline Plot"
    ]
  },
  {
    "objectID": "Distribution/Ridgeline.html#applications",
    "href": "Distribution/Ridgeline.html#applications",
    "title": "Ridgeline Plot",
    "section": "Applications",
    "text": "Applications\n\n1. Ridgeline Plot for Group Comparison\n\n\n\n\n\n\nFigureÂ 7: Applications of Ridgeline Plot for Group Comparison\n\n\n\nRidgeline plots are used to visualize cytokine expression across various experimental conditions and to compare gene expression distributions in different cell populations. [1]\n\n\n2. Using Ridgeline Plots to Visualize Gene Set Enrichment Analysis Results\n\n\n\n\n\n\nFigureÂ 8: Applications of Using Ridgeline Plots to Visualize Gene Set Enrichment Analysis Results\n\n\n\nRidgeline plots are used to visualize gene set enrichment analysis results, highlighting biomarkers associated with Moyamoya disease. [2]",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Ridgeline Plot"
    ]
  },
  {
    "objectID": "Distribution/Ridgeline.html#reference",
    "href": "Distribution/Ridgeline.html#reference",
    "title": "Ridgeline Plot",
    "section": "Reference",
    "text": "Reference\n\nKrÃ¤mer B, Nalin AP, Ma F, Eickhoff S, Lutz P, Leonardelli S, Goeser F, Finnemann C, Hack G, Raabe J, ToVinh M, Ahmad S, Hoffmeister C, Kaiser KM, Manekeller S, Branchi V, Bald T, HÃ¶lzel M, HÃ¼neburg R, Nischalke HD, Semaan A, Langhans B, Kaczmarek DJ, Benner B, Lordo MR, Kowalski J, Gerhardt A, Timm J, Toma M, Mohr R, TÃ¼rler A, Charpentier A, van Bremen T, Feldmann G, Sattler A, Kotsch K, Abdallah AT, Strassburg CP, Spengler U, Carson WE 3rd, Mundy-Bosse BL, Pellegrini M, Oâ€™Sullivan TE, Freud AG, Nattermann J. Single-cell RNA sequencing identifies a population of human liver-type ILC1s. Cell Rep.Â 2023 Jan 31;42(1):111937. doi: 10.1016/j.celrep.2022.111937. Epub 2023 Jan 1. PMID: 36640314; PMCID: PMC9950534.\nXu Y, Chen B, Guo Z, Chen C, Wang C, Zhou H, Zhang C, Feng Y. Identification of diagnostic markers for moyamoya disease by combining bulk RNA-sequencing analysis and machine learning. Sci Rep.Â 2024 Mar 11;14(1):5931. doi: 10.1038/s41598-024-56367-w. PMID: 38467737; PMCID: PMC10928210.\nWickham, H. (2009). ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York. ISBN 978-0-387-98140-6 (Print) 978-0-387-98141-3 (E-Book). [DOI: 10.1007/978-0-387-98141-3] (https://doi.org/10.1007/978-0-387-98141-3)\nScherer, C. (2019). ggridges: Ridgeline plots in â€˜ggplot2â€™. Journal of Statistical Software, 88(1), 1-19. [DOI: 10.18637/jss.v088.i01] (https://doi.org/10.18637/jss.v088.i01)\nGarnier, S., Team, R. C., & Team, R. S. (2018). viridis: Default color maps for R. R package version 0.5.1. https://CRAN.R-project.org/package=viridis\nFournet, H. (2016). hrbrthemes: Additional themes, scales, and geoms for â€˜ggplot2â€™. R package version 1.7.6. https://CRAN.R-project.org/package=hrbrthemes",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Ridgeline Plot"
    ]
  },
  {
    "objectID": "Distribution/Histogram.html",
    "href": "Distribution/Histogram.html",
    "title": "Histogram",
    "section": "",
    "text": "A histogram uses rectangular bars to represent the frequency of data within specific intervals, where the total area of the bars corresponds to the total frequency. It is primarily used to visualize the distribution of continuous variables.",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Histogram"
    ]
  },
  {
    "objectID": "Distribution/Histogram.html#example",
    "href": "Distribution/Histogram.html#example",
    "title": "Histogram",
    "section": "Example",
    "text": "Example\n\n\n\n\n\nThis basic histogram illustrates the expression levels of the TSPAN6 gene across different samples. The x-axis represents the data values, with each bar covering a specific range of values, while the y-axis shows how many data points fall within that range. In this histogram, the bars indicate the count of values within each specified range.\nThe histogram reveals that the data is centered around a value of 12, with values spanning roughly from 8 to 16. The shape of the histogram is approximately bell-shaped, suggesting that the data may follow a normal distribution.",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Histogram"
    ]
  },
  {
    "objectID": "Distribution/Histogram.html#setup",
    "href": "Distribution/Histogram.html#setup",
    "title": "Histogram",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming Language: R\nDependencies: readr, ggplot2, ggExtra, tidyverse, cowplot, viridis, ggpmisc, ggpubr\n\n\n# Installing necessary packages\nif (!requireNamespace(\"readr\", quietly = TRUE)) {\n  install.packages(\"readr\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"ggExtra\", quietly = TRUE)) {\n  install.packages(\"ggExtra\")\n}\nif (!requireNamespace(\"tidyverse\", quietly = TRUE)) {\n  install.packages(\"tidyverse\")\n}\nif (!requireNamespace(\"cowplot\", quietly = TRUE)) {\n  install.packages(\"cowplot\")\n}\nif (!requireNamespace(\"viridis\", quietly = TRUE)) {\n  install.packages(\"viridis\")\n}\nif (!requireNamespace(\"ggpmisc\", quietly = TRUE)) {\n  install.packages(\"ggpmisc\")\n}\nif (!requireNamespace(\"ggpubr\", quietly = TRUE)) {\n  install.packages(\"ggpubr\")\n}\n\n# Loading the libraries\nlibrary(readr)      # Read tsv files\nlibrary(ggplot2)    # Load ggplot2 for creating plots\nlibrary(ggExtra)    # Load ggExtra for enhancing ggplot2 graphics\nlibrary(tidyverse)  # Load tidyverse for data manipulation functions\nlibrary(cowplot)  # Load cowplot for combining separate ggplots into the same graphic\nlibrary(viridis)    # Load viridis for color maps\nlibrary(ggpmisc)    # Load ggpmisc for extentions to ggplot2 with additional functions for statistical annotation\nlibrary(ggpubr)     # Load ggpubr for extentions to ggplot2 with adding publication-ready themes, arranging multiple plots, and statistical tests",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Histogram"
    ]
  },
  {
    "objectID": "Distribution/Histogram.html#data-preparation",
    "href": "Distribution/Histogram.html#data-preparation",
    "title": "Histogram",
    "section": "Data Preparation",
    "text": "Data Preparation\nWe used the built-in R datasets (iris, mtcars) and the TCGA-LIHC.htseq_counts.tsv dataset from UCSC Xena DATASETS.\n\n# Read the TSV data\ndata &lt;- readr::read_csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/TCGA-LIHC.htseq_counts.csv.gz\")\n\n# Filter and reshape data for the first gene TSPAN6 (Ensembl ID: ENSG00000000003.13)\ndata1 &lt;- data %&gt;%\n  filter(Ensembl_ID == \"ENSG00000000003.13\") %&gt;%\n  pivot_longer(\n    cols = -Ensembl_ID, \n    names_to = \"sample\", \n    values_to = \"expression\"\n  ) %&gt;%\n  mutate(var = \"var1\")  # Add a column to differentiate the variables\n\n# Filter and reshape data for the second gene SCYL3 (Ensembl ID: ENSG00000000457.12)\ndata2 &lt;- data %&gt;%\n  filter(Ensembl_ID == \"ENSG00000000457.12\") %&gt;%\n  pivot_longer(\n    cols = -Ensembl_ID, \n    names_to = \"sample\", \n    values_to = \"expression\"\n  ) %&gt;%\n  mutate(var = \"var2\")  # Add a column to differentiate the variables\n\n# Combine the two datasets\ndata12 &lt;- bind_rows(data1, data2)\n\n# View the final combined dataset\nhead(data12)\n\n# A tibble: 6 Ã— 4\n  Ensembl_ID         sample           expression var  \n  &lt;chr&gt;              &lt;chr&gt;                 &lt;dbl&gt; &lt;chr&gt;\n1 ENSG00000000003.13 TCGA-DD-A4NG-01A      12.8  var1 \n2 ENSG00000000003.13 TCGA-G3-AAV4-01A       9.72 var1 \n3 ENSG00000000003.13 TCGA-2Y-A9H1-01A      11.3  var1 \n4 ENSG00000000003.13 TCGA-CC-A3M9-01A      11.6  var1 \n5 ENSG00000000003.13 TCGA-K7-AAU7-01A      11.5  var1 \n6 ENSG00000000003.13 TCGA-BC-A10W-01A      12.0  var1",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Histogram"
    ]
  },
  {
    "objectID": "Distribution/Histogram.html#visualization",
    "href": "Distribution/Histogram.html#visualization",
    "title": "Histogram",
    "section": "Visualization",
    "text": "Visualization\n\n1. Basic Histograms\nFigureÂ 1 illustrates the distribution of expression levels for the TSPAN6 gene across different samples.\n\n# Basic Histogram\np1 &lt;- ggplot(data1, aes(x = expression)) +\n  geom_histogram() + \n  labs(x = \"Gene Expression\", y = \"Count\")\n\np1\n\n\n\n\n\n\n\nFigureÂ 1: Basic Histogram\n\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nKey Parameters: binwidth / bins\nThe binwidth or bins parameter determines how much data each bin will contain. Modifying these values can significantly affect the appearance of the histogram and the information conveyed.\n\n\n\np2_1 &lt;- ggplot(data1, aes(x = expression)) +\n  geom_histogram(bins = 30, fill = \"skyblue\", color = \"white\") +\n  ggtitle(\"Bins = 30\") + \n  labs(x = \"Gene Expression\", y = \"Count\")\n\np2_2 &lt;- ggplot(data1, aes(x = expression)) +\n  geom_histogram(bins = 50, fill = \"skyblue\", color = \"white\") +\n  ggtitle(\"Bins = 50\") + \n  labs(x = \"Gene Expression\", y = \"Count\")\n\ncowplot::plot_grid(p2_1, p2_2)\n\n\n\n\n\n\n\nFigureÂ 2: Key Parameters: binwidth / bins\n\n\n\n\n\n\n\n2. Histogram with Density Curve\nThe density curve provides a smooth representation of the data distribution. Unlike the histogram, which depends on the number of bins, the density curve uses kernel density estimation (KDE) to smooth the distribution. This allows a clearer understanding of the overall trend and shape of the data.\n\np1 &lt;- ggplot(data1, aes(x = expression)) +\n  geom_histogram(aes(y = after_stat(density)), bins = 30, fill = \"skyblue\", color = \"white\") +\n  geom_density(alpha = 0.2, fill = \"#FF6666\") + \n  labs(x = \"Gene Expression\", y = \"Density\")\n\np1\n\n\n\n\n\n\n\nFigureÂ 3: Histogram with Density Curve\n\n\n\n\n\n\n\n3. Mirrored Histogram\nA mirrored histogram provides an intuitive way to compare the distributions of two datasets. This visualization uses a mirrored structure, allowing you to quickly assess symmetry or differences between the datasets. By overlaying both histograms into a single plot, the mirrored histogram conserves visualization space while maintaining a clear representation of data distribution.\n\np &lt;- ggplot(data12, aes(x = expression, fill = var)) +\n  geom_histogram(data = subset(data12, var == \"var1\"), \n                 aes(y = after_stat(density)), \n                 binwidth = 0.5, \n                 alpha = 0.7, \n                 fill = \"#69b3a2\") +\n  geom_histogram(data = subset(data12, var == \"var2\"), \n                 aes(y = -after_stat(density)), \n                 binwidth = 0.5, \n                 alpha = 0.7, \n                 fill = \"#404080\") +\n  scale_fill_manual(values = c(\"var1\" = \"#69b3a2\", \"var2\" = \"#404080\")) +\n  labs(x = \"Gene Expression\", y = \"Density\")\n\np\n\n\n\n\n\n\n\nFigureÂ 4: Mirrored Histogram\n\n\n\n\n\n\n\n4. Overlapping Histograms on the Same Axis\nOverlaying or placing multiple histograms side by side on the same axis enables a direct comparison of distributions for two or more datasets within the same coordinate system. By adjusting colors and transparency, you can clearly visualize overlapping regions and distinguish between datasets. This technique is ideal for comparing 2â€“3 groups; more groups may lead to visual clutter, making the plot difficult to interpret.\n\np &lt;- data12 %&gt;%\n  ggplot(aes(x = expression, fill = var)) +\n  geom_histogram(color = \"#e9ecef\", alpha = 0.6, position = 'identity') +\n  scale_fill_manual(values = c(\"#69b3a2\", \"#404080\")) +\n  labs(x = \"Expression Value\", y = \"Count\", fill = \"Type\") +\n  theme_minimal()\n\np\n\n\n\n\n\n\n\nFigureÂ 5: Overlapping Histograms on the Same Axis\n\n\n\n\n\nTo more clearly compare the distances between multiple distributions, you can calculate the mean or median, and plot the density and vertical lines.\n\np &lt;- data12 %&gt;%\n  gghistogram(x = \"expression\",\n   color = \"var\",\n   fill = \"var\",\n   add = \"median\", # mean or median\n   rug = TRUE,\n   palette = c(\"#00AFBB\", \"#E7B800\")) +\n  theme_minimal()\n\np\n\n\n\n\n\n\n\nFigureÂ 6: Histogram mean or median distribution distance\n\n\n\n\n\n\n\n5. Faceted Histograms for Multiple Variables\nFaceted histograms provide a structured way to compare and analyze data across multiple variables or categorical groups by displaying them in separate panels. Unlike traditional histograms, faceted layouts are particularly effective for avoiding overlap in visualizations, ensuring clarity in comparisons, and enabling multidimensional data exploration. This approach is ideal for grouped or classified data and enhances the interpretability of complex datasets.\n\n# Use built-in iris dataset\ndata &lt;- iris\n\n# Reshape the data from wide to long format\ndata &lt;- data %&gt;%\n  gather(key = \"variable\", value = \"value\", -Species)  # Exclude the Species column\n\n# Plot the faceted histograms\np &lt;- data %&gt;%\n  ggplot(aes(x = value, color = Species, fill = Species)) +\n  geom_histogram(alpha = 0.6, binwidth = 0.3, position = \"identity\") +\n  scale_fill_viridis(discrete = TRUE, option = \"D\") +\n  scale_color_viridis(discrete = TRUE, option = \"D\") +\n  theme(\n    legend.position = \"bottom\",\n    panel.spacing = unit(0.5, \"lines\"),\n    strip.text.x = element_text(size = 10)\n  ) +\n  xlab(\"Value\") +\n  ylab(\"Frequency\") +\n  facet_grid(Species ~ variable, scales = \"free_x\")  # Create a facet grid\n\np\n\n\n\n\n\n\n\nFigureÂ 7: Faceted Histograms for Multiple Variables\n\n\n\n\n\n\n\n6. Adding Marginal Distributions Using ggMarginal()\n\n# Create a scatterplot with marginal histograms\np &lt;- ggplot(mtcars, aes(x = wt, y = mpg, color = factor(cyl), size = factor(cyl))) +\n  geom_point(aes(color = factor(cyl)), show.legend = TRUE) +  # Scatter points with color mapped to cylinder\n  geom_smooth(method = 'lm', formula = y ~ x, se = TRUE, linewidth = 1, aes(color = factor(cyl))) +  # Regression lines\n  scale_color_manual(values = c(\"#2e3b97\", \"#faad61\", \"#b76252\")) +  # Custom colors for regression lines\n  stat_regline_equation(\n    aes(label = paste(after_stat(eq.label), after_stat(rr.label), sep = \"~~~~\")),\n    formula = y ~ x, size = 3,\n    position = position_nudge(x = 2.7, y = 1)\n  ) +  # Add regression equations and RÂ² values\n  theme(legend.position = \"none\")  # Hide legend for cleaner visualization\n\n# Add marginal histograms to the scatterplot\np1 &lt;- ggMarginal(p, type = \"histogram\")\n\n# Display the plot\np1\n\n\n\n\n\n\n\nFigureÂ 8: Adding Marginal Distributions Using ggMarginal()\n\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nCustomizable Parameters for Plots with Marginal Distributions\n\nChange the size of the marginal plot using the size parameter.\nCustomize the appearance of the marginal plot with common parameters.\nDisplay only one marginal plot (either the x or y axis) using margins = 'x' or margins = 'y'.\n\n\n\n\n# Create a scatterplot with marginal histograms\np &lt;- ggplot(mtcars, aes(x = wt, y = mpg, color = factor(cyl), size = factor(cyl))) +\n  geom_point(aes(color = factor(cyl)), show.legend = TRUE) +  # Scatter points with color mapped to cylinder\n  geom_smooth(method = 'lm', formula = y ~ x, se = TRUE, linewidth = 1, aes(color = factor(cyl))) +  # Regression lines\n  scale_color_manual(values = c(\"#2e3b97\", \"#faad61\", \"#b76252\")) +  # Custom colors for regression lines\n  stat_regline_equation(\n    aes(label = paste(after_stat(eq.label), after_stat(rr.label), sep = \"~~~~\")),\n    formula = y ~ x, size = 1.5,\n    position = position_nudge(x = 2.2, y = 1)\n  ) +  # Add regression equations and RÂ² values\n  theme(legend.position = \"none\")  # Hide legend for cleaner visualization\n\n# Change the size of the marginal plot\np1 &lt;- ggMarginal(p, type = \"histogram\", size = 10)\n\n# Customize the appearance of the marginal plot\np2 &lt;- ggMarginal(p, type = \"histogram\", fill = \"slateblue\", xparams = list(bins = 10))\n\n# Display only one marginal plot (x-axis marginal plot)\np3 &lt;- ggMarginal(p, type = \"histogram\", margins = 'x')\n\ncowplot::plot_grid(p1, p2, p3)\n\n\n\n\n\n\n\nFigureÂ 9: Customizable Parameters for Plots with Marginal Distributions",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Histogram"
    ]
  },
  {
    "objectID": "Distribution/Histogram.html#applications",
    "href": "Distribution/Histogram.html#applications",
    "title": "Histogram",
    "section": "Applications",
    "text": "Applications\n\n1. Applications of Basic Histogram\n\n\n\n\n\n\nFigureÂ 10: Applications of Basic Histogram\n\n\n\nFigure 9 shows the differences between the relative frequencies of human X and human Y chromosomeâ€™s histograms for n = 6. [1]\n\n\n2. Applications of Faceted Histograms\n\n\n\n\n\n\n\n\n\n\n\n(a) Xiang, L. et al.(2023)\n\n\n\n\n\n\n\n\n\n\n\n(b) Gihr, G.A. et al.(2020)\n\n\n\n\n\n\n\nFigureÂ 11: Applications of Faceted Histograms\n\n\n\nFig. 10a shows the imaging features and whole-lesion histogram analysis of typical SPLs. [2]\nFig. 10b demonstrates examples of cranial MRI from patients with WHO grade I (upper row) and WHO grade II astrocytoma (lower row) including the corresponding whole tumor ADC histogram, H&E staining and Ki-67 immunohistochemistry. [3]",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Histogram"
    ]
  },
  {
    "objectID": "Distribution/Histogram.html#reference",
    "href": "Distribution/Histogram.html#reference",
    "title": "Histogram",
    "section": "Reference",
    "text": "Reference\n\nCosta, A. M., Machado, J. T., & Quelhas, M. D. (2011). Histogram-based DNA analysis for the visualization of chromosome, genome, and species information. Bioinformatics, 27(9), 1207â€“1214. https://doi.org/10.1093/bioinformatics/btr131\nXiang, L., Yang, H., Qin, Y., Wen, Y., Liu, X., & Zeng, W.-B. (2023). Differential value of diffusion kurtosis imaging and intravoxel incoherent motion in benign and malignant solitary pulmonary lesions. Frontiers in Oncology, 12, Article 1075072. https://doi.org/10.3389/fonc.2022.1075072\nGihr, G. A., Horvath-Rizea, D., Hekeler, E., Ganslandt, O., Henkes, H., Hoffmann, K.-T., Scherlach, C., & Schob, S. (2020). Histogram analysis of diffusion weighted imaging in low-grade gliomas: in vivo characterization of tumor architecture and corresponding neuropathology. Frontiers in Oncology, 10, 206. https://doi.org/10.3389/fonc.2020.00206\nWickham, H., Hester J, & Bryan J. (2024). readr: Read Rectangular Text Data. https://CRAN.R-project.org/package=readr\nWickham, H. (2016). ggplot2: Elegant graphics for data analysis. Springer. https://ggplot2.tidyverse.org\nGao, Y. (2021). ggExtra: Add marginal plots to ggplot2. https://cran.r-project.org/package=ggExtra\nWickham, H., & RStudio Team. (2019). tidyverse: Easily install and load the â€˜tidyverseâ€™. https://cran.r-project.org/package=tidyverse\nClaus O. Wilke. (2024). cowplot: Streamlined Plot Theme and Plot Annotations for â€˜ggplot2â€™. https://CRAN.R-project.org/package=cowplot\nGarcÃ­a, M. (2018). viridis: Default color maps from â€˜matplotlibâ€™. https://cran.r-project.org/package=viridis\nAubry, R., & Bouchard, C. (2020). ggpmisc: Miscellaneous extensions to â€˜ggplot2â€™. https://cran.r-project.org/package=ggpmisc\nKassambara, A. (2021). ggpubr: â€˜ggplot2â€™ based publication-ready plots. https://cran.r-project.org/package=ggpubr",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Histogram"
    ]
  },
  {
    "objectID": "DataOverTime/Timeseries.html",
    "href": "DataOverTime/Timeseries.html",
    "title": "Timeseries",
    "section": "",
    "text": "A time series graph is a statistical chart with time on the horizontal axis and the observed variable on the vertical axis, reflecting the trend of the observed variable over time.",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Timeseries"
    ]
  },
  {
    "objectID": "DataOverTime/Timeseries.html#example",
    "href": "DataOverTime/Timeseries.html#example",
    "title": "Timeseries",
    "section": "Example",
    "text": "Example\n\n\n\n\n\nThe figure shows a time series graph. The horizontal axis represents the date, and the vertical axis represents the observed variable psavert. It can be seen that psavert generally shows a decreasing trend over time.",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Timeseries"
    ]
  },
  {
    "objectID": "DataOverTime/Timeseries.html#setup",
    "href": "DataOverTime/Timeseries.html#setup",
    "title": "Timeseries",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming Language: R\nDependencies: ggplot2, patchwork, dplyr\n\n\n# Install packages\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"patchwork\", quietly = TRUE)) {\n  install.packages(\"patchwork\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n} \n\n# Load packages\nlibrary(ggplot2)\nlibrary(patchwork)\nlibrary(dplyr)",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Timeseries"
    ]
  },
  {
    "objectID": "DataOverTime/Timeseries.html#data-preparation",
    "href": "DataOverTime/Timeseries.html#data-preparation",
    "title": "Timeseries",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe subjectsâ€™ quantitative dehydration estimation data were obtained using the economics dataset that comes with R and the PhysioNet database [1].\n\n# 1.economics dataset\ndata &lt;- economics[1:60, c(1, 4)]\n\nhead(data)\n\n# A tibble: 6 Ã— 2\n  date       psavert\n  &lt;date&gt;       &lt;dbl&gt;\n1 1967-07-01    12.6\n2 1967-08-01    12.6\n3 1967-09-01    11.9\n4 1967-10-01    12.9\n5 1967-11-01    12.8\n6 1967-12-01    11.8\n\ndata_double &lt;- economics[1:60, c(1, 4, 5)]   # This data is used for subplot merging and dual y-axis.\n\nhead(data_double)\n\n# A tibble: 6 Ã— 3\n  date       psavert uempmed\n  &lt;date&gt;       &lt;dbl&gt;   &lt;dbl&gt;\n1 1967-07-01    12.6     4.5\n2 1967-08-01    12.6     4.7\n3 1967-09-01    11.9     4.6\n4 1967-10-01    12.9     4.9\n5 1967-11-01    12.8     4.7\n6 1967-12-01    11.8     4.8\n\n# 2.Quantitative dehydration estimation data\ndata_water &lt;- read.csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/dehydration_estimation.csv\", header = T)\n\naxis_name &lt;- colnames(data_water)[c(5, 8)]        # Record column names\ndata_water &lt;- data_water %&gt;%                      # Select 2 sets of data\n  slice(c(19:27, 46:54)) %&gt;%\n  select(c(1, 5, 8)) %&gt;%        \n  setNames(c(\"V1\", \"V2\", \"V3\")) %&gt;%               # Change column name\n  mutate(V4 = case_when(V1 == 3 ~ \"people1\",      # Column V4 serves as category labels.\n                        V1 == 6 ~ \"people2\"))\n\nhead(data_water)\n\n  V1 V2   V3      V4\n1  3  0 53.0 people1\n2  3  1 53.2 people1\n3  3  2 53.6 people1\n4  3  3 53.2 people1\n5  3  4 53.3 people1\n6  3  5 53.1 people1",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Timeseries"
    ]
  },
  {
    "objectID": "DataOverTime/Timeseries.html#visualization",
    "href": "DataOverTime/Timeseries.html#visualization",
    "title": "Timeseries",
    "section": "Visualization",
    "text": "Visualization\n\n1. Basic plot\n\n# Basic plot\np &lt;- ggplot(data, aes(x = date, y = psavert)) +\n  geom_line() +\n  xlab(\"\")\n\np\n\n\n\n\nBasic plot\n\n\n\n\nThe above graph uses the date as the x-axis and the observed variable as the y-axis. By drawing line segments using geom_line(), a basic time series graph can be obtained.\n\n\n2. Display observation point\n\n# geom_point() display observation point\np &lt;- ggplot(data, aes(x = date, y = psavert)) +\n  geom_line() +\n  xlab(\"\") +\n  geom_point()\n\np\n\n\n\n\nDisplay observation point\n\n\n\n\nThe observation point is displayed using geom_point() in the graph.\n\n\n3. Multi-class data plotting\n\n# Multi-class data plotting\np &lt;- ggplot(data_water, aes(x = V2, y = V3, group = V4)) +     # V4 category labels are mapped to grouping and color features.\n  geom_line(aes(color = V4)) +\n  geom_point(aes(color = V4)) +\n  ylab(axis_name[2]) +                      # Add axis labels\n  xlab(axis_name[1]) +\n  # Change the legend position\n  theme(legend.position = \"inside\", legend.position.inside = c(0.85, 0.85))\n\np\n\n\n\n\nMulti-class data plotting\n\n\n\n\nThe figure shows the changes in body water content of two subjects during their run.\n\n\n4. Change x-axis date labels\n\n4.1 Format the date labels\n\n# Set the date using scale_x_date()\np &lt;- ggplot(data, aes(x = date, y = psavert)) +\n  geom_line() +\n  xlab(\"\") + \n  geom_point() + \n  scale_x_date(date_labels = \"%Y-%m\")  \n\np\n\n\n\n\nFormat the date labels\n\n\n\n\nThe x-axis labels in the graph have been changed to year-month format.\n\n\n\n\n\n\nTip\n\n\n\nKey parameter: date_labels\nThe parameter date_labels in scale_x_date determines the format of the date text on the x-axis, where\n\nâ€œ%Yâ€: Year with century (e.g., 2024)\nâ€œ%yâ€: Year without century (e.g., 24)\nâ€œ%mâ€: Month (range 00-12)\nâ€œ%dâ€: Day of the month (range 01-31)\n\nThese can be used individually or in combination as desired. More details can be found in the strftime section of the R help menu.\n\n\n\n\n4.2 Set the display interval for date labels\n\n# Use scale_x_date() to set the display interval of date labels\np &lt;- ggplot(data, aes(x = date, y = psavert)) +\n  geom_line() +\n  xlab(\"\") + \n  geom_point() + \n  scale_x_date(date_labels = \"%Y/%m\",date_breaks = \"9 month\")\n\np\n\n\n\n\nSet the display interval for date labels\n\n\n\n\nThe date_breaks parameter in scale_x_date is used in the graph to change the display interval of the date labels.\n\n\n\n\n\n\nTip\n\n\n\nKey parameter: date_breaks\nshape specifies the shape of the point, with a possible value from 0 to 25. See the image below for examples.\nThe parameter date_breaks in scale_x_date determines the date label interval, in the form of:\nâ€œ2 yearsâ€, â€œ1 monthâ€, â€œ2 weeksâ€ are expressions with units of â€˜secâ€™ (seconds), â€˜minâ€™ (minutes), â€˜hourâ€™ (hours), â€˜dayâ€™ (days), â€˜weekâ€™ (weeks), â€˜monthâ€™ (months), or â€˜yearâ€™ (years). The â€˜sâ€™ is optional for plural forms.\n\n\n\n\n\n5. Adjust label angle\n\n# Adjust the label angle using theme()\np &lt;- ggplot(data, aes(x = date, y = psavert)) +\n  geom_line() +\n  xlab(\"\") + \n  geom_point() + \n  scale_x_date(date_labels = \"%Y/%m\",date_breaks = \"3 month\")+\n  theme(axis.text.x = element_text(angle = 60, hjust = 1))     # The `angle` parameter adjusts the label angle; `hjust=1` aligns the rightmost horizontal edge of the label name with the label tick mark.\n\np\n\n\n\n\nAdjust label angle\n\n\n\n\nAdjusting the label angle in the image effectively prevents label overlap.\n\n\n6. Time limit\n\n# Extracting a time-limited image using the limit parameter of scale_x_date()\np &lt;- ggplot(data, aes(x = date, y = psavert)) +\n  geom_line() +\n  xlab(\"\") + \n  geom_point() + \n  scale_x_date(date_labels = \"%Y/%m\",date_breaks = \"3 month\",\n               limit = c(as.Date(\"1968-01-01\"), as.Date(\"1969-12-01\")))+\n  theme(axis.text.x = element_text(angle = 60, hjust = 1))\n\np\n\n\n\n\nTime limit\n\n\n\n\nThe graph uses the limit parameter in scale_x_date to only extract data from January 1, 1968 to December 1, 1969.\n\n\n7. Notes and separators\n\n# Notes and separators\np &lt;- ggplot(data, aes(x = date, y = psavert)) +\n  geom_line() +\n  xlab(\"\") + \n  geom_point() + \n  scale_x_date(date_labels = \"%Y/%m\",date_breaks = \"3 month\")+\n  theme(axis.text.x = element_text(angle = 60, hjust = 1))+\n# Comment text\n  annotate(geom=\"text\",x=as.Date(\"1971-06-01\"),y=14.7,label=\"MAX of pasavert\")+\n# Comment points\n  annotate(geom=\"point\",x=as.Date(\"1971-06-01\"),y=14.7,color=\"red\")+\n# Add horizontal line\n  geom_hline(yintercept=13.5,color=\"blue\")\n\np\n\n\n\n\nNotes and separators\n\n\n\n\nThe highest point was marked and labeled using annotate(), and a horizontal dividing line was drawn using geom_hline().\n\n\n8. Subgraph merging\n\n# To display subgraphs on a single graph, the patchwork needs to be loaded.\np &lt;- ggplot(data_double, aes(x = date, y = psavert)) +\n  geom_line() +\n  xlab(\"\")\n\np1 &lt;- ggplot(data_double, aes(x = date, y = uempmed)) +\n  geom_line() +\n  xlab(\"\")\n\np + p1          # Subgraph merging\n\n\n\n\nSubgraph merging\n\n\n\n\nThe patchwork package can be used to place subgraphs on a graph.\n\n\n9. Dual y-axis\n\n# For dual y-axis setup, use sec.axis to set the second y-axis.\np &lt;- ggplot(data_double, aes(x = date)) +\n  geom_line(aes(y = psavert),color = \"red\") +\n  geom_line(aes(y = uempmed * 3),color = \"blue\") +      # The scales are inconsistent, so a multiplier is needed.\n  xlab(\"\")+\n  scale_y_continuous(\n    name = \"psavert\",\n# `transform` divides the left y-axis coordinate by the multiple above, and `name` sets the name.\n    sec.axis = sec_axis(transform = ~ . / 3, name = \"uempmed\")   \n  ) +\n# Set the title for the dual y-axis to the same color as the corresponding line segment for easy differentiation.\n  theme(\n    axis.title.y = element_text(color = \"red\", size = 13),\n    axis.title.y.right = element_text(color = \"blue\", size = 13),\n    legend.position = \"none\"\n  )\n\np\n\n\n\n\nDual y-axis\n\n\n\n\nThe two y-axis in the image have different scales, and the line color corresponds to the y-label color.",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Timeseries"
    ]
  },
  {
    "objectID": "DataOverTime/Timeseries.html#applications",
    "href": "DataOverTime/Timeseries.html#applications",
    "title": "Timeseries",
    "section": "Applications",
    "text": "Applications\n\n\n\n\n\n\nFigureÂ 1: Applications of timeseries 1\n\n\n\nThe figure shows the coverage of different doses of mumps-containing vaccine in the birth cohorts from 2005 to 2022. [1]\n\n\n\n\n\n\nFigureÂ 2: Applications of timeseries 2\n\n\n\nOverall benefit level (Figure A) and patient benefit level (Figure B) of lung cancer screening healthcare gaps using any method and low-dose computed tomography (LDCT). [2]\n\n\n\n\n\n\nFigureÂ 3: Applications of timeseries 3\n\n\n\nGeometric mean plasma concentration-time curves (Â±95% confidence interval) of apixaban 25Âµg alone in 8 healthy volunteers after (baseline; red symbols and lines) and on day 5 of ritonavir treatment (blue markers and lines). [3]",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Timeseries"
    ]
  },
  {
    "objectID": "DataOverTime/Timeseries.html#reference",
    "href": "DataOverTime/Timeseries.html#reference",
    "title": "Timeseries",
    "section": "Reference",
    "text": "Reference\n[1] FU C, XU W, ZHENG W, et al.Â Epidemiological characteristics and interrupted time series analysis of mumps in Quzhou City, 2005-2023[J]. Hum Vaccin Immunother, 2024,20(1): 2411828.\n[2] KUKHAREVA P V, LI H, CAVERLY T J, et al.Â Lung Cancer Screening Before and After a Multifaceted Electronic Health Record Intervention: A Nonrandomized Controlled Trial[J]. JAMA Netw Open, 2024,7(6): e2415383.\n[3] ROHR B S, KROHMER E, FOERSTER K I, et al.Â Time Course of the Interaction Between Oral Short-Term Ritonavir Therapy with Three Factor Xa Inhibitors and the Activity of CYP2D6, CYP2C19, and CYP3A4 in Healthy Volunteers[J]. Clin Pharmacokinet, 2024,63(4): 469-481.",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Timeseries"
    ]
  },
  {
    "objectID": "DataOverTime/LineChart.html",
    "href": "DataOverTime/LineChart.html",
    "title": "Line Chart",
    "section": "",
    "text": "Drawing line segments in various charts is common, and this module will draw all kinds of line segments that may be used.",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Line Chart"
    ]
  },
  {
    "objectID": "DataOverTime/LineChart.html#example",
    "href": "DataOverTime/LineChart.html#example",
    "title": "Line Chart",
    "section": "Example",
    "text": "Example\n\n\n\n\n\nThe figure shows a basic linear graph that can intuitively represent the trend of the dependent variable as the independent variable moves.",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Line Chart"
    ]
  },
  {
    "objectID": "DataOverTime/LineChart.html#setup",
    "href": "DataOverTime/LineChart.html#setup",
    "title": "Line Chart",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming Language: R\nDependencies: ggplot2, viridis, patchwork, gghighlight, ggpmisc\n\n\n# Install packages\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"viridis\", quietly = TRUE)) {\n  install.packages(\"viridis\")\n}\nif (!requireNamespace(\"patchwork\", quietly = TRUE)) {\n  install.packages(\"patchwork\")\n}\nif (!requireNamespace(\"gghighlight\", quietly = TRUE)) {\n  install.packages(\"gghighlight\")\n}\nif (!requireNamespace(\"ggpmisc\", quietly = TRUE)) {\n  install.packages(\"ggpmisc\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\n\n# Load packages\nlibrary(ggplot2)\nlibrary(viridis)     \nlibrary(patchwork)   \nlibrary(gghighlight) \nlibrary(ggpmisc)     \nlibrary(dplyr)",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Line Chart"
    ]
  },
  {
    "objectID": "DataOverTime/LineChart.html#data-preparation",
    "href": "DataOverTime/LineChart.html#data-preparation",
    "title": "Line Chart",
    "section": "Data Preparation",
    "text": "Data Preparation\nThis uses the built-in iris and economics datasets in R, along with a custom dataset and real-time glucose measurement data from the PhysioNet database. [1]ã€‚\n\n# 1.iris data\ndata &lt;- iris\n\nhead(data)\n\n  Sepal.Length Sepal.Width Petal.Length Petal.Width Species\n1          5.1         3.5          1.4         0.2  setosa\n2          4.9         3.0          1.4         0.2  setosa\n3          4.7         3.2          1.3         0.2  setosa\n4          4.6         3.1          1.5         0.2  setosa\n5          5.0         3.6          1.4         0.2  setosa\n6          5.4         3.9          1.7         0.4  setosa\n\n# 2.economics data\n# (1) Using economics data directly to draw graphs\n# (2) Processing economics data to draw time series graphs\ndata_economics &lt;- economics[,c(1, 4, 5)] %&gt;%\n  filter(grepl(\"-12-01\", date)) %&gt;%           # Select only December data for plotting\n  mutate(date = gsub(\"-.*\", \"\", date)) %&gt;%    # Only keep the year\n  slice(1:25) %&gt;%                             # Choose the first 25 years\n  arrange(date)                               # Sort\n\nhead(data_economics)\n\n# A tibble: 6 Ã— 3\n  date  psavert uempmed\n  &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt;\n1 1967     11.8     4.8\n2 1968     11.1     4.4\n3 1969     11.8     4.6\n4 1970     13.2     5.9\n5 1971     13       6.2\n6 1972     13.7     6.1\n\n# 3.Automatically generate data (for log transformation of the y-axis).\ndata_create &lt;- data.frame(\n  x = seq(11, 100),\n  y = seq(11, 100) / 2 + rnorm(90)\n)\n\nhead(data_create)\n\n   x        y\n1 11 5.563267\n2 12 4.093238\n3 13 5.531995\n4 14 7.076379\n5 15 6.372817\n6 16 7.977768\n\n# 4.Glucose level (used to emphasize specific line segments)\ndata_glucose &lt;- read.csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/Dexcom_001.csv\", header = T)\n\n# Glucose value data processing\ndata_glucose &lt;- data_glucose[,c(2, 8)] %&gt;%\n  slice(1:102) %&gt;%\n  setNames(c(\"V1\", \"V2\")) %&gt;%\n  filter(!is.na(V2) & V1 != \"\") %&gt;%     # Remove na\n  mutate(V3 = rep(1:30, times = 3),     # Divided into 3 stages\n         group = rep(c(\"stage one\", \"stage two\", \"stage three\"), each = 30))\n\nhead(data_glucose)\n\n               V1 V2 V3     group\n1 2020/2/13 17:23 61  1 stage one\n2 2020/2/13 17:28 59  2 stage one\n3 2020/2/13 17:33 58  3 stage one\n4 2020/2/13 17:38 59  4 stage one\n5 2020/2/13 17:43 63  5 stage one\n6 2020/2/13 17:48 67  6 stage one",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Line Chart"
    ]
  },
  {
    "objectID": "DataOverTime/LineChart.html#visualization",
    "href": "DataOverTime/LineChart.html#visualization",
    "title": "Line Chart",
    "section": "Visualization",
    "text": "Visualization\n\n1. Basic Plotting\n\n# Basic Plotting\np &lt;- ggplot(data, aes(x = Sepal.Length, y = Sepal.Width)) +\n  geom_line()\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Basic Plotting\n\n\n\n\n\nThis plot is a basic form of a line plot, which can be drawn by calling geom_line() in ggplot.\n\n\n2. Change line style\n\n# Change line style\np &lt;- ggplot(data, aes(x = Sepal.Length, y = Sepal.Width)) +\n  geom_line(orientation = \"x\", linewidth = 1, color = \"blue\", linetype = 2)\n\np\n\n\n\n\nChange line style\n\n\n\n\nThe line style of this graph can be changed by setting linewidth, color, and linetype.\n\n\n\n\n\n\nTip\n\n\n\nKey parameter: geom_line\n\nlinetype: Indicates the line type, with options ranging from 0 to 6 (where 0 = blank, 1 = solid, 2 = dashed, 3 = dotted, 4 = dotdash, 5 = longdash, 6 = twodash). See the image below for specific shapes:\n\n\n\n\n\n\n\norientation: The orientation of the line segment, with options â€œxâ€ and â€œyâ€. orientation=\"x\" draws the line with x as the independent variable and y as the dependent variable.\nlinewidth: The thickness of the line segment.\n\n\n\n\n\n3. y-axis scale logarithmic\n\n# y-axis scale logarithmic\np &lt;- ggplot(data_create, aes(x = x, y = y)) +\n  geom_line() +\n  scale_y_log10(breaks = c(1, 5, 10, 15, 20, 50, 100), limits = c(1, 100))\n\np\n\n\n\n\ny-axis scale logarithmic\n\n\n\n\nThis graph shows that the y-axis scale is not evenly spaced, but rather logarithmized, which magnifies the lower part of the curve.\n\n\n\n\n\n\nTip\n\n\n\nKey parameter: scale_y_log10\n\nbreaks: A set of numerical vectors can be used to represent the position of the y-axis ticks.\nlimits: A set of numerical vectors of length 2 can be used to represent the range of the y-axis ticks.\n\n\n\n\n# Before y-axis logarithmic conversion (for comparison)\np &lt;- ggplot(data_create, aes(x = x, y = y)) +\n  geom_line()\n\np\n\n\n\n\nBefore y-axis logarithmic conversion (for comparison)\n\n\n\n\nThis graph is without y-axis logarithmic transformation (for comparison), and you can see that the scale is evenly distributed.\n\n\n4. Multi-class data plotting\n\n# Multi-class data plotting\np &lt;- ggplot(data[data$Species != \"versicolor\", ], aes(x = Sepal.Length, y = Sepal.Width)) +\n  geom_line(aes(color = Species)) # Mapping species variables to color features\n\np\n\n\n\n\nMulti-class data plotting\n\n\n\n\nThis graph was created using two species from the iris dataset.\n\n\n5. Color Selection\n\n5.1 Use the viridis package\n\n# Multi-class data plotting\n# Plotting multiple types of data using the `viridis` package\np &lt;- ggplot(data[data$Species != \"versicolor\", ], aes(x = Sepal.Length, y = Sepal.Width)) +\n  geom_line(aes(color = Species)) +\n  scale_color_viridis(discrete = TRUE)\n\np\n\n\n\n\nUse the viridis package\n\n\n\n\nThis graph uses the scale_color_viridis function from the viridis package to select appropriate colors.\n\n\n5.2 Custom colors\n\n# Customize colors using `scale_color_manual()`.\np &lt;- ggplot(data[data$Species != \"versicolor\", ], aes(x = Sepal.Length, y = Sepal.Width)) +\n  geom_line(aes(color = Species)) +\n  scale_color_manual(values = c(\"red\",\"blue\"))\n\np\n\n\n\n\nCustom colors\n\n\n\n\nThis graph uses scale_color_manual() to customize the polyline to red and blue.\n\n\n\n6. Connect the line segments in the scatter plot\n\n6.1 Basic plot + line styles\n\n# Basic plot + line styles\np &lt;- ggplot(data[data$Species == \"setosa\", ], aes(x = Sepal.Width, y = Sepal.Length)) +\n  geom_point(shape = 17, size = 1.5, color = \"blue\") +\n  geom_line(size = 1, color = \"black\", linetype = 2)\n\np\n\n\n\n\nBasic plot + line styles\n\n\n\n\nThis is a basic connected scatter plot, using geom_point() to draw points and geom_line() to draw line segments.\n\n\n6.2 Connect according to time sequence\n\n# Connect according to time sequence\np &lt;- ggplot(data_economics, aes(x = psavert, y = uempmed)) +\n  geom_point(shape = 17, size = 1.5, color = \"blue\") +\n  geom_text(\n    label = data_economics$date, nudge_x = 0,\n    nudge_y = -0.1, size = 5\n  ) +\n# Use `geom_segment()` to draw a line segment.\n  geom_segment(\n    aes(\n      xend = c(tail(psavert, n = 24), NA),\n      yend = c(tail(uempmed, n = 24), NA)\n    ),\n    linewidth = 1\n  )\n\np\n\n\n\n\nConnect according to time sequence\n\n\n\n\nThis graph uses geom_segment() to connect points according to time sequence, which is quite different from the graph drawn by geom_line().\n\n\n\n\n\n\nTip\n\n\n\nKey parameters: geom_segment\nxend/yend: Corresponding to x and y, that is, (x,y) points to (xend,yend) to draw a line segment. In the code, c(tail(psavert, n=24),NA) takes the last 24 values of the psavert column and adds NA. This makes the preceding point point to the next point to draw a line segment, and the last point points to NA, so no line segment is drawn.\n\n\n\n\n6.3 Timing connection + arrow\n\n# Timing connection + arrow\np &lt;- ggplot(data_economics, aes(x = psavert, y = uempmed)) +\n  geom_point(shape = 17, size = 1.5, color = \"blue\") +\n  geom_text(\n    label = data_economics$date, nudge_x = 0,\n    nudge_y = -0.1, size = 5\n  ) +\n# Use `geom_segment()` to draw a line segment.\n  geom_segment(\n    aes(\n      xend = c(tail(psavert, n = 24), NA),\n      yend = c(tail(uempmed, n = 24), NA)\n    ),\n    linewidth = 1, arrow = arrow(length = unit(0.5, \"cm\"))\n  )\n\np\n\n\n\n\nTiming connection + arrow\n\n\n\n\nThis graph adds arrows to each connection line, making the temporal characteristics of the connected scatter plot more apparent.\n\n\n\n7. Plotting the regression curve\n\n7.1 Regression curve\n\n## Regression curve\np &lt;- ggplot(data, aes(x = Sepal.Width, y = Sepal.Length)) +\n  geom_point(shape = 16, size = 1.5, color = \"blue\") +\n  labs(x = \"Width\", y = \"Length\") +\n  geom_smooth(method = \"lm\", formula = y ~ x, se = F, color = \"red\") # Plotting the linear regression curve\n\np\n\n\n\n\nRegression curve\n\n\n\n\nThis graph is a regression curve plotted based on a scatter plot.\n\n\n7.2 Regression curve + confidence interval\n\n# Regression curve + confidence interval\np &lt;- ggplot(data, aes(x = Sepal.Width, y = Sepal.Length)) +\n  geom_point(shape = 16, size = 1.5, color = \"blue\") +\n  labs(x = \"Width\", y = \"Length\") +\n  geom_smooth(method = \"lm\", formula = y ~ x, se = T, color = \"red\") # Plotting the linear regression curve\n\np\n\n\n\n\nRegression curve + confidence interval\n\n\n\n\nThis plot adds a confidence interval (i.e., parameter se=TRUE) to the regression curve.\n\n\n7.3 Add regression curve labels\n\n# Add regression curve labels using `stat_poly_eq()`\np &lt;- ggplot(data, aes(x = Sepal.Width, y = Sepal.Length)) +\n  geom_point(shape = 16, size = 1.5, color = \"blue\") +\n  labs(x = \"Width\", y = \"Length\") +\n  geom_smooth(method = \"lm\", formula = y ~ x, se = T, color = \"red\") + # Plotting the linear regression curve\n  stat_poly_eq(use_label(\"eq\",\"R2\",\"P\"),formula = y~x,size = 4,method = \"lm\")\n\np\n\n\n\n\nAdd regression curve labels\n\n\n\n\nThis plot uses the stat_poly_eq() function from the ggpmisc package to add the regression curve equation, R-squared, and p-value.\n\n\n\n8. Notes and separators\n\n# Notes and separators\np &lt;- ggplot(data = economics[1:60, c(1, 4)], aes(x = date, y = psavert)) +\n  geom_line() +\n  xlab(\"\") +\n  scale_x_date(date_breaks = \"3 months\", date_labels = \"%Y-%m\") +\n# Text Annotation\n  annotate(\n    geom = \"text\", x = as.Date(\"1969-01-01\"), y = 14.5,\n    label = \"the enconomics of USA\"\n  ) +\n# Adjust the text angle on the x-axis\n  theme(axis.text.x = element_text(angle = 60, hjust = 1)) +\n# Note\n  annotate(geom = \"point\", x = as.Date(\"1971-06-01\"), y = 14.7, size = 5, shape = 21, fill = \"transparent\") +\n# Draw horizontal dividing lines\n  geom_hline(yintercept = 14, color = \"orange\")\n\np\n\n\n\n\nNotes and separators\n\n\n\n\nThis graph uses annotate to add annotations for points and text, and geom_hline to draw horizontal dividing lines.\n\n\n9. Multi-subgraph arrangement\nFor arranging multiple subgraphs, the patchwork package is required.\n\n# Multiple subgraph arrangements (requires the `patchwork` package)\ndata_double &lt;- economics[1:60, c(1, 4, 5)]\n\np &lt;- ggplot(data_double, aes(x = date, y = psavert)) +\n  geom_line() +\n  xlab(\"\")\n\np1 &lt;- ggplot(data_double, aes(x = date, y = uempmed)) +\n  geom_line() +\n  xlab(\"\")\n\np + p1\n\n\n\n\nMulti-subgraph arrangement\n\n\n\n\nThis diagram displays two sub-diagrams in one image, and the arrangement of the images uses the patchwork package.\n\n\n10. Dual y-axis\n\n# Dual y-axis\ndata_double &lt;- economics[1:60, c(1, 4, 5)]\n\np &lt;- ggplot(data_double, aes(x = date)) +\n  geom_line(aes(y = psavert), color = \"red\") +\n  geom_line(aes(y = uempmed * 3), color = \"blue\") + # To accommodate the range of the left y-axis, the values on the right y-axis need to be increased by a corresponding factor.\n  xlab(\"\") +\n  scale_y_continuous(\n    name = \"psavert\",\n    sec.axis = sec_axis(transform = ~ . / 3, name = \"uempmed\") # The scale of the coordinate axes should be reduced by the corresponding factor.\n  ) +\n  theme(\n    axis.title.y = element_text(color = \"red\", size = 13),\n    axis.title.y.right = element_text(color = \"blue\", size = 13),\n    legend.position = \"none\"\n  )\n\np\n\n\n\n\nDual y-axis\n\n\n\n\nThis graph has two different y-axis, and the scales on them can be different.\n\n\n11. Line chart + histogram\n\n# Line chart + histogram\ndata_double &lt;- economics[1:60, c(1, 4, 5)]\n\np &lt;- ggplot(data_double, aes(x = date)) +\n  geom_bar(aes(y = psavert), stat = \"identity\", fill = \"#69b3a2\") + # Drawing a bar chart\n  geom_line(aes(y = uempmed * 3), color = \"blue\") + # Draw a line graph\n  xlab(\"\") +\n  scale_y_continuous(\n    name = \"psavert\",\n    sec.axis = sec_axis(transform = ~ . / 3, name = \"uempmed\")\n  ) +\n  theme(\n    axis.title.y = element_text(color = \"#69b3a2\", size = 13),\n    axis.title.y.right = element_text(color = \"blue\", size = 13),\n    legend.position = \"none\"\n  )\n\np\n\n\n\n\nLine chart + histogram\n\n\n\n\nThe left y-axis of this graph is the histogram coordinate axis, and the right y-axis is the line graph coordinate axis.\n\n\n12. Emphasis on specific line segments\nA portion of the glucose observation data was selected and plotted in three stages, serving as the raw data to emphasize the line segment.\n\n# Emphasize specific line segments (requires the gghighlight package)\np &lt;- ggplot(data_glucose) +\n  geom_line(aes(V3, V2, color = group)) +\n  gghighlight(max(V2) &gt; 125, label_key = group) +\n  xlab(\"Observation time\") +\n  ylab(\"Value of glucose\")\n\np\n\n\n\n\nEmphasis on specific line segments\n\n\n\n\nThis chart highlights the broken line in the first stage using filtering criteria.\nDe-emphasize specific line segments.\n\n# Fading out specific line segments using the unhighlighted_params parameter\np &lt;- ggplot(data_glucose) +\n  geom_line(aes(V3, V2, color = group), linewidth = 1) +\n  gghighlight(max(V2) &gt; 125, label_key = group, \n    unhighlighted_params = list(\n      linewidth = 0.3,\n      colour = alpha(\"blue\", 0.7),\n      linetype = \"dashed\"\n    )\n  ) +\n  xlab(\"Observation time\") +\n  ylab(\"Value of glucose\")\n\np\n\n\n\n\nDe-emphasize specific line segments\n\n\n\n\nThis graph uses the unhighlighted_params parameter to modify the faded line format.",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Line Chart"
    ]
  },
  {
    "objectID": "DataOverTime/LineChart.html#applications",
    "href": "DataOverTime/LineChart.html#applications",
    "title": "Line Chart",
    "section": "Applications",
    "text": "Applications\n\n\n\n\n\n\nFigureÂ 2: Applications of line chart 1\n\n\n\nThe figure shows the coverage of different doses of mumps-containing vaccine in the birth cohorts from 2005 to 2022. [1]\n\n\n\n\n\n\nFigureÂ 3: Applications of line chart 2\n\n\n\nThe figure shows the relative error curves for the model methods based on the unused, original, and improved methods, where the average relative error of the component content model based on the improved method is better than that of the models based on the unused and original methods. [2]\n\n\n\n\n\n\nFigureÂ 4: Applications of line chart 3\n\n\n\nThe figure shows: (A) Distribution of the number of comorbidities in HCC patients; (B) Average number of comorbidities in HCC patients of different ages and sexes; (C) Distribution of the number of comorbidities in male HCC patients of different age groups; (D) Distribution of the number of comorbidities in female HCC patients of different age groups. [3]",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Line Chart"
    ]
  },
  {
    "objectID": "DataOverTime/LineChart.html#reference",
    "href": "DataOverTime/LineChart.html#reference",
    "title": "Line Chart",
    "section": "Reference",
    "text": "Reference\n[1] FU C, XU W, ZHENG W, et al.Â Epidemiological characteristics and interrupted time series analysis of mumps in Quzhou City, 2005-2023[J]. Hum Vaccin Immunother, 2024,20(1): 2411828.\n[2] LU R, LIU H, YANG H, et al.Â Multi-Delay Identification of Rare Earth Extraction Process Based on Improved Time-Correlation Analysis[J]. Sensors (Basel), 2023,23(3).\n[3] MU X M, WANG W, JIANG Y Y, et al.Â Patterns of Comorbidity in Hepatocellular Carcinoma: A Network Perspective[J]. Int J Environ Res Public Health, 2020,17(9).",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Line Chart"
    ]
  },
  {
    "objectID": "DataOverTime/AreaChart.html",
    "href": "DataOverTime/AreaChart.html",
    "title": "Area Chart",
    "section": "",
    "text": "An area chart is a line chart in which the area below the line is filled with color. It is mainly used to display values at continuous intervals or over a time span.",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Area Chart"
    ]
  },
  {
    "objectID": "DataOverTime/AreaChart.html#example",
    "href": "DataOverTime/AreaChart.html#example",
    "title": "Area Chart",
    "section": "Example",
    "text": "Example\n\n\n\n\n\nThis area plot shows the cumulative number of deaths per month in the TCGA-BRCA.survival.tsv dataset. The number of deaths per month is represented by stacked areas, with the size of the area proportional to the number of deaths in that month. The x-axis shows time, calculated in months, starting from the time the event occurred. The y-axis shows the number of deaths that occurred in the corresponding month. The area of each region represents the number of deaths in that month; the larger the region, the more deaths. The area plot provides a visual representation of the trend in the number of deaths over time. It can observe sharp increases in the number of deaths in certain months, or periods of low or stable deaths, which is helpful in analyzing mortality risk and other related factors within specific time periods.",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Area Chart"
    ]
  },
  {
    "objectID": "DataOverTime/AreaChart.html#setup",
    "href": "DataOverTime/AreaChart.html#setup",
    "title": "Area Chart",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming Language: R\nDependencies: tidyverse; viridis; dygraphs; xts; hrbrthemes; ggpattern\n\n\n# Install packages\nif (!requireNamespace(\"tidyverse\", quietly = TRUE)) {\n  install.packages(\"tidyverse\")\n}\nif (!requireNamespace(\"viridis\", quietly = TRUE)) {\n  install.packages(\"viridis\")\n}\nif (!requireNamespace(\"dygraphs\", quietly = TRUE)) {\n  install.packages(\"dygraphs\")\n}\nif (!requireNamespace(\"xts\", quietly = TRUE)) {\n  install.packages(\"xts\")\n}\nif (!requireNamespace(\"hrbrthemes\", quietly = TRUE)) {\n  install.packages(\"hrbrthemes\")\n}\nif (!requireNamespace(\"ggpattern\", quietly = TRUE)) {\n  install.packages(\"ggpattern\")\n}\n\n# Load packages\nlibrary(tidyverse)\nlibrary(viridis)\nlibrary(dygraphs)\nlibrary(xts)\nlibrary(hrbrthemes)\nlibrary(ggpattern)",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Area Chart"
    ]
  },
  {
    "objectID": "DataOverTime/AreaChart.html#data-preparation",
    "href": "DataOverTime/AreaChart.html#data-preparation",
    "title": "Area Chart",
    "section": "Data Preparation",
    "text": "Data Preparation\nWe used the built-in R dataset AirPassengers and TCGA-BRCA.survival.tsv from the UCSC Xena website (UCSC Xena (xenabrowser.net)).\n\n# TCGA-BRCA.survival.tsv\ntcga_brca_survival &lt;- readr::read_tsv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/TCGA-BRCA.survival.tsv\")\n\ntcga_brca_filtered &lt;- tcga_brca_survival %&gt;%\n  filter(OS.time &lt;= 2000) %&gt;%\n  mutate(month = floor(OS.time / 30))\n\nmonthly_death_counts &lt;- tcga_brca_filtered %&gt;%\n  filter(OS == 1) %&gt;%\n  group_by(month) %&gt;%\n  summarise(deaths = n())\n\n# AirPassengers\ndata(\"AirPassengers\")\nair_passenger_data &lt;- as.data.frame(AirPassengers)\n\nair_passenger_data$Month &lt;- rep(month.name, 12)\nair_passenger_data$Year &lt;- rep(1949:1960, each=12)\nair_passenger_data$x &lt;- as.numeric(air_passenger_data$x)\n\nair_passenger_long &lt;- air_passenger_data %&gt;%\n  gather(key = \"Variable\", value = \"Value\", -Year, -Month)\n\nair_passenger_percentage &lt;- air_passenger_long %&gt;%\n  group_by(Year) %&gt;%\n  mutate(Percentage = Value / sum(Value) * 100) # Calculate the percentage for each month\n\nair_passenger_time_series &lt;- data.frame(datetime = time(AirPassengers), count = as.vector(AirPassengers))\n\nair_passenger_time_series$datetime &lt;- as.Date(air_passenger_time_series$datetime)\nair_passenger_xts &lt;- xts(x = air_passenger_time_series$count, order.by = air_passenger_time_series$datetime) # Creating an XTS object",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Area Chart"
    ]
  },
  {
    "objectID": "DataOverTime/AreaChart.html#visualization",
    "href": "DataOverTime/AreaChart.html#visualization",
    "title": "Area Chart",
    "section": "Visualization",
    "text": "Visualization\n\n1. Basic Plotting\n\n1.1 Basic area plot\nUse the ggplot2 package to plot area graphs.\n\n# Basic area plot\np &lt;- ggplot(monthly_death_counts, aes(x = month, y = deaths)) +\n  geom_area() +\n  labs(title = \"Cumulative Deaths Over Time\",\n       x = \"Months\",\n       y = \"Number of Deaths\")\n\np\n\n\n\n\nBasic area plot\n\n\n\n\nThis area plot shows the cumulative number of deaths in each month within the TCGA-BRCA.survival.tsv dataset.\n\n\n1.2 Custom area plot\nSeveral options are available for customizing the appearance of the area map:\n\nAdd a title using ggtitle().\nChange the line style using parameters such as shape, size, and color.\nAdd opacity to the filled area using opacity.\nCustomize a general theme using the theme_ipsum() function in the hrbrthemes package.\nHighlight the top line using geom_line().\nDisplay a single data point using geom_point() if there arenâ€™t many observations.\n\n\n# Custom area plot\np &lt;- ggplot(monthly_death_counts, aes(x = month, y = deaths)) +\n  geom_area(fill=\"#69b3a2\", alpha=0.4) +\n  geom_line(color=\"#69b3a2\", size=1.2) +\n  geom_point(size=3, color=\"#69b3a2\") +\n  theme_ipsum() +\n  labs(title = \"Cumulative Deaths Over Time\",\n       x = \"Months\",\n       y = \"Number of Deaths\")\n\np\n\n\n\n\nCustom area plot\n\n\n\n\nThis area chart displays the cumulative number of deaths for each month in the TCGA-BRCA.survival.tsv dataset. Customizing the appearance of the area chart can make it better suited to the data presentation needs, while also enhancing readability and visual appeal.\n\n\n1.3 Add gradient colors\nTo add a color gradient instead of light blue, we need to use the ggpattern package and define the colors the graphic will use. The bottom color is white, and the top color is red.\n\n# Add gradient colors\np &lt;- ggplot(monthly_death_counts, aes(x = month, y = deaths)) +  \n  geom_area() +  \n  labs(title = \"Cumulative Deaths Over Time\",       \n      x = \"Months\",       \n      y = \"Number of Deaths\") +  \n  geom_area_pattern(data = monthly_death_counts, \n                    pattern = \"gradient\", \n                    pattern_fill = \"white\",\n                    pattern_fill2 = \"red\")\n\np\n\n\n\n\nAdd gradient colors\n\n\n\n\n\n\n1.4 Gradient colors with transparency\nTo add transparency to a graphic, simply use a naturally transparent color. For example, here weâ€™ll change white to a transparent gray. The bottom color is transparent light gray, and the top color is blue.\n\n# Gradient colors with transparency\np &lt;- ggplot(monthly_death_counts, aes(x = month, y = deaths)) +\n  geom_area_pattern(data = monthly_death_counts, \n                  pattern = \"gradient\",\n                  fill = \"#00000010\",\n                  pattern_fill  = \"#00000010\",\n                  pattern_fill2 = \"blue\")\n\np\n\n\n\n\nGradient colors with transparency\n\n\n\n\n\n\n1.5 Fully customized area map with gradient\nBy using the content seen above and adding other features (such as changing the theme, deleting axes, etc.), you will get even more beautiful graphics.\nThe code example below adds a black line to the top of an area chart, uses the hrbrthemes package to change the theme and remove the axis.\n\n# Fully customized area map with gradient\np &lt;- ggplot(monthly_death_counts, aes(x = month, y = deaths)) +\n  geom_area_pattern(data = monthly_death_counts,\n                    pattern = \"gradient\", \n                    fill = \"#00000000\",\n                    pattern_fill  = \"#00000000\",\n                    pattern_fill2 = \"magenta\") + \n  geom_line(data = monthly_death_counts, colour = \"black\", linewidth = 0.8) +\n  geom_point(shape = 16, size = 4.5, colour = \"purple\") +\n  geom_point(shape = 16, size = 2.5, colour = \"white\") +\n  ggtitle(\"Cumulative Deaths Over Time\") + \n  theme_bw() +\n  theme(plot.title = element_text(size = 14),\n        panel.border       = element_blank(),\n        axis.line.x        = element_line(),\n        text               = element_text(size = 12),\n        axis.ticks         = element_blank(),\n        axis.text.y        = element_text(margin = margin(0,15,0,0, unit = \"pt\"))) +\n  scale_alpha_identity() + labs(x=\"\",y=\"\")\n\np\n\n\n\n\nFully customized area map with gradient\n\n\n\n\n\n\n1.6 Drawing area plots using basic R\nUse the basic R function polygon() to build an area map without using any other packages.\n\nplot(monthly_death_counts$month, monthly_death_counts$deaths, col=rgb(0.2,0.1,0.5,0.9), type=\"o\", lwd=3,\n     xlab=\"Months\", ylab=\"Number of Deaths\", pch=20, main=\"Cumulative Deaths Over Time\")\n\npolygon(\n  x = c(min(monthly_death_counts$month), monthly_death_counts$month,\n        max(monthly_death_counts$month)), # Close x-boundary\n  y = c(0, monthly_death_counts$deaths, 0), # Close y-boundary\n  col = rgb(0.2, 0.1, 0.5, 0.2),\n  border = FALSE) # Use polygon() to fill the area.\n\n\n\n\nDrawing area plots using basic R\n\n\n\n\nThis area plot shows the cumulative number of deaths for each month in the TCGA-BRCA.survival.tsv dataset. Built using the basic R polygon() function without any additional packages, it visually illustrates the change in the number of deaths over time. The area in the plot represents the cumulative number of deaths for each month; the area gradually increases over time, reflecting the cumulative trend of deaths.\n\n\n\n2. Stacked area diagram\n\n2.1 Basic stacked area diagram\nA stacked area chart is a special type of area chart used to compare multiple variables within a given range. Each data series in a stacked area chart is drawn based on the previous data series; that is, each measurement fills the area between rows. By stacking different variables in a specific order, the area occupied by each variable becomes clearer, allowing for a more intuitive comparison of the size relationships and trends between variables.\nStacked area plots can be created using the ggplot2 package.\n\np &lt;- ggplot(air_passenger_long, aes(x = Year, y = Value, fill = Month)) +\n  geom_area() +\n  labs(title = \"Monthly Air Passengers (Stacked Area Chart)\", \n       x = \"Year\", y = \"Number of Passengers\") +\n  theme_minimal()\n\np\n\n\n\n\nBasic stacked area diagram\n\n\n\n\n\n\n2.2 Controlling the stacking order in ggplot2\n\nUse the factor() function to set a specific order for variables.\nUse sort() to sort alphabetically.\nSort based on specific data values.\n\n\n# Sort by month\nair_passenger_data$Month &lt;- factor(air_passenger_data$Month, levels = month.name) # Convert the Month column into ordered factors.\n\nair_passenger_long &lt;- air_passenger_data %&gt;%\n  gather(key = \"Variable\", value = \"Value\", -Year, -Month)\n\np &lt;- ggplot(air_passenger_long, aes(x = Year, y = Value, fill = Month)) +\n  geom_area() +\n  labs(title = \"Monthly Air Passengers\", \n       x = \"Year\", y = \"Number of Passengers\") +\n  theme_minimal()\n\np\n\n\n\n\nControlling the stacking order in ggplot2\n\n\n\n\nThis stacked area chart shows the monthly air passenger numbers from 1949 to 1960, with each monthâ€™s passenger numbers represented by stacked areas of different colors. The stacked areas are arranged in chronological order by month (January to December). This stacking method clearly shows the changes in passenger numbers each month and the trend comparison between different years, while also allowing observation of seasonal fluctuations in passenger numbers each year. The area chart uses color stacking to show the contribution of different months to the overall passenger numbers, facilitating intuitive analysis of passenger volume for different months in different years.\n\n# Sort alphabetically\nmyLevels &lt;- levels(factor(air_passenger_long$Month)) \nair_passenger_long$Month &lt;- factor(air_passenger_long$Month, levels = sort(myLevels))\n\np &lt;- ggplot(air_passenger_long, aes(x = Year, y = Value, fill = Month)) +\n  geom_area() +\n  labs(title = \"Monthly Air Passengers\",\n       x = \"Year\", y = \"Number of Passengers\") +\n  theme_minimal()\n\np\n\n\n\n\nSort alphabetically\n\n\n\n\nThis stacked area chart shows the number of air passengers each month from 1949 to 1960, with each monthâ€™s passenger numbers represented by stacked areas of different colors. Unlike previous charts, the months are arranged alphabetically, rather than in the natural month order (January to December). This method helps to see the contribution of each alphabetically ordered month to the total number of passengers in each year. While this arrangement allows analysts to observe the percentage of each month in the total number of passengers, it loses the original seasonal trend of the time series.\n\n# Sort by value for a specific year (e.g., 1949)\nmyLevels_value &lt;- air_passenger_long %&gt;%\n  filter(Year == 1949) %&gt;%  \n  arrange(Value) \n\nair_passenger_long$Month &lt;- factor(air_passenger_long$Month, levels = myLevels_value$Month)\n\np &lt;- ggplot(air_passenger_long, aes(x = Year, y = Value, fill = Month)) +\n  geom_area() +\n  labs(title = \"Monthly Air Passengers (Sorted by 1949 Values)\",\n       x = \"Year\", y = \"Number of Passengers\") +\n  theme_minimal()\n\np\n\n\n\n\nSort by value for a specific year (e.g., 1949)\n\n\n\n\nThis stacked area chart shows the number of air passengers each month from 1949 to 1960, with the number of passengers for each month represented by stacked areas of different colors. The months are not ordered by the calendar months (January to December), but rather by the number of passengers in each month of 1949, from lowest to highest. This allows for a visual observation of the relative proportions of passengers in each month of 1949 and shows how these numbers changed over different years.\n\n\n2.3 Custom styles\nThe overall appearance of a chart can be improved in the following ways:\n\nUse viridis color scale\nhrbrthemes packageâ€™s theme_ipsum\nAdd title using ggtitle\n\n\np &lt;- ggplot(air_passenger_long, aes(x = Year, y = Value, fill = Month)) +\n  geom_area(alpha=0.6 , size=.5, colour=\"white\") +\n  scale_fill_viridis(discrete = T) +\n  theme_ipsum() + \n  ggtitle(\"Monthly Air Passengers\")\n\np\n\n\n\n\nCustom styles\n\n\n\n\nThis stacked area chart displays monthly air passenger numbers from 1949 to 1960, with each monthâ€™s passenger numbers represented by stacked areas of different colors. Customizing the appearance of the area chart allows for better presentation of the data, while also enhancing readability and visual appeal.\n\n\n\n3. proportional stacked area diagram\nIn a scaled stacked area chart, the sum for each year is always equal to 100, and the value for each group is expressed as a percentage. To draw a scaled stacked area chart, you first need to calculate the percentages, which can be done using the dplyr package.\n\np &lt;- ggplot(air_passenger_percentage, aes(x = Year, y = Percentage, fill = Month)) +\n  geom_area(alpha = 0.6, size = 1, colour = \"black\") +\n  labs(title = \"Monthly Air Passengers\",\n       x = \"Year\", y = \"Percentage of Passengers\") +\n  theme_minimal()\n\np\n\n\n\n\nproportional stacked area diagram\n\n\n\n\nThis scaled-up area plot shows the percentage change in monthly air passenger numbers across different years in the AirPassengers dataset. Each layer in the plot (filled with a different color for each month) represents the proportion of passengers for that month within the year, stacked together to form the area plot. This scaled-up area plot provides a visual representation of how monthly air passenger numbers change over time, clearly identifying the relative proportion of each month in the total annual passenger count, and allowing observation of trends across different years.\n\n\n4. Interactive area plot\nUse the dygraph package for time series visualization. It provides features such as zooming, hovering, and minimaps.\n\np &lt;- dygraph(air_passenger_xts) %&gt;%\n  dyOptions(labelsUTC = TRUE, fillGraph = TRUE, fillAlpha = 0.1, drawGrid = FALSE, colors = \"#D8AE5A\") %&gt;%\n  dyRangeSelector() %&gt;%\n  dyCrosshair(direction = \"vertical\") %&gt;%\n  dyHighlight(highlightCircleSize = 5, highlightSeriesBackgroundAlpha = 0.2, hideOnMouseOut = FALSE) %&gt;%\n  dyRoller(rollPeriod = 1)\n\np\n\n\n\nInteractive area plot\n\n\nThis graph, created using dygraph, is a dynamic time-series plot showing the monthly trends in air passenger numbers across the AirPassengers dataset. Each point in the graph represents the number of passengers in a given month, and various interactive features (dynamic interactions, highlighting, vertical cross lines, and filled graphs) are used to enhance readability and interactivity.",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Area Chart"
    ]
  },
  {
    "objectID": "DataOverTime/AreaChart.html#applications",
    "href": "DataOverTime/AreaChart.html#applications",
    "title": "Area Chart",
    "section": "Applications",
    "text": "Applications\n\n1. Basic area diagram\n\n\n\n\n\n\nFigureÂ 1: Applications of basic area diagram\n\n\n\nOverrepresentation test to distinguish upregulated genes in the muscle transcriptome in JIS and AIS-GO molecular functions. Overlapping area plots of difference show the results of the overrepresentation test of GO molecular functions to distinguish upregulated genes in the paravertebral muscle transcriptome in the JIS and AIS groups. âˆ— Statistical significance above the peak marker of the overrepresentation test, calculated using Bonferroni multiple correction, P &lt; 0.05. [1]\n\n\n2. Stacked area diagram\n\n\n\n\n\n\nFigureÂ 2: Applications of stacked area diagram\n\n\n\nAn area plot showing the PICRUSt analysis of the sequence data. [2]\n\n\n\n\n\n\nFigureÂ 3: Applications of stacked area diagram\n\n\n\nTaxonomic and genomic abundance trends on days 14 and 28. The relative abundance of taxa and the predicted abundance of functional gene groups demonstrate the stability of gene group abundance relative to taxonomic changes. Relative abundance tables of taxa and genomes were assembled and used to generate area maps for all samples on days 14 and 28. The relative abundance of each identified taxa or functional genome for each sample is shown; (A) predicted genomes on day 14, (B) taxa on day 14, (C) predicted genomes on day 28, (D) taxa on day 28. On day 14, there are significant taxonomic differences between treatments (A), and a few genomes show small changes in abundance (B). On day 28, taxonomic changes (D) are accompanied by a small number of visible changes in genomic abundance (C). [3]",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Area Chart"
    ]
  },
  {
    "objectID": "DataOverTime/AreaChart.html#reference",
    "href": "DataOverTime/AreaChart.html#reference",
    "title": "Area Chart",
    "section": "Reference",
    "text": "Reference\n[1] Nowak R, Kwiecien M, Tkacz M, Mazurek U. Transforming growth factor-beta (TGF- Î²) signaling in paravertebral muscles in juvenile and adolescent idiopathic scoliosis. Biomed Res Int. 2014;2014:594287. doi: 10.1155/2014/594287. Epub 2014 Sep 15. PMID: 25313366; PMCID: PMC4181945.\n[2] Stewart CJ, Skeath T, Nelson A, Fernstad SJ, Marrs EC, Perry JD, Cummings SP, Berrington JE, Embleton ND. Preterm gut microbiota and metabolome following discharge from intensive care. Sci Rep.Â 2015 Nov 24;5:17141. doi: 10.1038/srep17141. PMID: 26598071; PMCID: PMC4657104.\n[3] Ballou AL, Ali RA, Mendoza MA, Ellis JC, Hassan HM, Croom WJ, Koci MD. Development of the Chick Microbiome: How Early Exposure Influences Future Microbial Diversity. Front Vet Sci. 2016 Jan 20;3:2. doi: 10.3389/fvets.2016.00002. PMID: 26835461; PMCID: PMC4718982.\n[4] Csardi, G., & Nepusz, T. (2006). igraph: Network analysis and visualization. https://cran.r-project.org/package=igraph\n[5] Wickham, H. (2016). ggraph: An implementation of grammar of graphics for graphs and networks. https://cran.r-project.org/package=ggraph\n[6] Wickham, H., & FranÃ§ois, R. (2021). tidyverse: The grammar of data manipulation. https://cran.r-project.org/package=tidyverse\n[7] Geyer, F., & Kolesnyk, I. (2020). CollapsibleTree: Interactive tree diagrams. https://cran.r-project.org/package=CollapsibleTree\n[8] Galili, T. (2015). dendextend: An R package for visualizing, adjusting, and comparing trees. https://cran.r-project.org/package=dendextend\n[9] Garnier, S. (2018). viridis: Default Color Maps from â€˜matplotlibâ€™. https://cran.r-project.org/package=viridis\n[10] Aubry, R., & Bouchard, C. (2020). dygraphs: Interactive time series plotting. https://cran.r-project.org/package=dygraphs\n[11] Hornik, K. (2021). xts: Extensible time series. https://cran.r-project.org/package=xts\n[12] Grolemund, G., & Wickham, H. (2011). lubridate: Make dates and times easier to work with. https://cran.r-project.org/package=lubridate\n[13] Wickham, H. (2016). ggplot2: Elegant graphics for data analysis. Springer. https://ggplot2.tidyverse.org\n[14] Wickham, H., & FranÃ§ois, R. (2021). dplyr: A Grammar of Data Manipulation. https://cran.r-project.org/package=dplyr\n[15] Wickham, H., & Henry, L. (2021). tidyr: Tidy Messy Data. https://cran.r-project.org/package=tidyr",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Area Chart"
    ]
  },
  {
    "objectID": "Animation/Animation.html",
    "href": "Animation/Animation.html",
    "title": "Animation",
    "section": "",
    "text": "System Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming Language: R\nDependencies: gapminder; ggplot2; gganimate; gifski; Cairo; babynames; hrbrthemes; dplyr; viridis; tidyr;\n\n\n# Install packages\nif (!requireNamespace(\"gapminder\", quietly = TRUE)) {\n  install.packages(\"gapminder\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"gganimate\", quietly = TRUE)) {\n  install.packages(\"gganimate\")\n}\nif (!requireNamespace(\"gifski\", quietly = TRUE)) {\n  install.packages(\"gifski\")\n}\nif (!requireNamespace(\"Cairo\", quietly = TRUE)) {\n  install.packages(\"Cairo\")\n}\nif (!requireNamespace(\"babynames\", quietly = TRUE)) {\n  install.packages(\"babynames\")\n}\nif (!requireNamespace(\"hrbrthemes\", quietly = TRUE)) {\n  install.packages(\"hrbrthemes\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"viridis\", quietly = TRUE)) {\n  install.packages(\"viridis\")\n}\nif (!requireNamespace(\"tidyr\", quietly = TRUE)) {\n  install.packages(\"tidyr\")\n}\n\n# Load packages\nlibrary(gapminder)\nlibrary(ggplot2)\nlibrary(gganimate)\nlibrary(gifski)\nlibrary(Cairo)\nlibrary(babynames)\nlibrary(hrbrthemes)\nlibrary(dplyr)\nlibrary(viridis)\nlibrary(tidyr)",
    "crumbs": [
      "<i class='fa-solid fa-seedling'></i> Animation",
      "Animation"
    ]
  },
  {
    "objectID": "Animation/Animation.html#setup",
    "href": "Animation/Animation.html#setup",
    "title": "Animation",
    "section": "",
    "text": "System Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming Language: R\nDependencies: gapminder; ggplot2; gganimate; gifski; Cairo; babynames; hrbrthemes; dplyr; viridis; tidyr;\n\n\n# Install packages\nif (!requireNamespace(\"gapminder\", quietly = TRUE)) {\n  install.packages(\"gapminder\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"gganimate\", quietly = TRUE)) {\n  install.packages(\"gganimate\")\n}\nif (!requireNamespace(\"gifski\", quietly = TRUE)) {\n  install.packages(\"gifski\")\n}\nif (!requireNamespace(\"Cairo\", quietly = TRUE)) {\n  install.packages(\"Cairo\")\n}\nif (!requireNamespace(\"babynames\", quietly = TRUE)) {\n  install.packages(\"babynames\")\n}\nif (!requireNamespace(\"hrbrthemes\", quietly = TRUE)) {\n  install.packages(\"hrbrthemes\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"viridis\", quietly = TRUE)) {\n  install.packages(\"viridis\")\n}\nif (!requireNamespace(\"tidyr\", quietly = TRUE)) {\n  install.packages(\"tidyr\")\n}\n\n# Load packages\nlibrary(gapminder)\nlibrary(ggplot2)\nlibrary(gganimate)\nlibrary(gifski)\nlibrary(Cairo)\nlibrary(babynames)\nlibrary(hrbrthemes)\nlibrary(dplyr)\nlibrary(viridis)\nlibrary(tidyr)",
    "crumbs": [
      "<i class='fa-solid fa-seedling'></i> Animation",
      "Animation"
    ]
  },
  {
    "objectID": "Animation/Animation.html#data-preparation",
    "href": "Animation/Animation.html#data-preparation",
    "title": "Animation",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe main methods for plotting are the built-in datasets in R and COVID-19 infection data.\n\n# data_gapminder\ndata_gapminder &lt;- gapminder\n\n# data_babynames\ndata_babynames &lt;- babynames\n\n# data_covi19\ndata_covi19 &lt;- readr::read_csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/data_covi19.csv\")\ndata_covi19$date &lt;- c(6:12)\ndata_covi19 &lt;- gather(data_covi19, key = \"area\", value = \"cases\", 2:7)\n\n# data_covi19_bar\ndata_covi19_bar_10 &lt;- filter(data_covi19, date == 10)\ndata_covi19_bar_10$frame &lt;- rep(\"a\",6)\n\ndata_covi19_bar_12 &lt;- filter(data_covi19, date == 12)\ndata_covi19_bar_12$frame &lt;- rep(\"b\",6)\n\ndata_covi19_bar &lt;- rbind(data_covi19_bar_10,data_covi19_bar_12)",
    "crumbs": [
      "<i class='fa-solid fa-seedling'></i> Animation",
      "Animation"
    ]
  },
  {
    "objectID": "Animation/Animation.html#visualization",
    "href": "Animation/Animation.html#visualization",
    "title": "Animation",
    "section": "Visualization",
    "text": "Visualization\n\n1. Scattered bubble animation\n\n1.1 Taking the gapminder dataset as an example\n\n# Scattered bubble animation----\np &lt;- ggplot(data_gapminder, aes(gdpPercap, lifeExp, size = pop, color = continent)) +\n  geom_point() +\n  scale_x_log10() +\n  theme_bw() +\n  # Drawing animation\n  labs(title = 'Year: {frame_time}', x = 'GDP per capita', y = 'life expectancy') +\n  transition_time(year) +\n  ease_aes('linear')\n\nanimate(p, renderer = gifski_renderer())\n\n\n\n\n\n\n\nFigureÂ 1: Scattered bubble animation\n\n\n\nThe image above is a scatter plot animation showing the relationship between life expectancy and GDP in capital cities of various regions over time. The size of the scatter points represents population, and the color represents the region.\n\n\n1.2 Grouped Scatter Bubble Animation\nIn addition to displaying groups on one chart, they can also be drawn separately.\n\n# Grouped Scatter Bubble Animation\np &lt;- ggplot(data_gapminder, aes(gdpPercap, lifeExp, size = pop, colour = country)) +\n  geom_point(alpha = 0.7, show.legend = FALSE) +\n  scale_colour_manual(values = country_colors) +\n  scale_size(range = c(2, 12)) +\n  scale_x_log10() +\n  facet_wrap(~continent) +  # facet by continent\n  # Drawing animation diagrams\n  labs(title = 'Year: {frame_time}', x = 'GDP per capita', y = 'life expectancy') +\n  transition_time(year) +\n  ease_aes('linear')\n\nanimate(p, renderer = gifski_renderer())\n\n\n\n\n\n\n\nFigureÂ 2: Grouped Scatter Bubble Animation\n\n\n\nThe map above shows different regions separately.\n\n\n\n2. Interval transition bar chart\nInterval transition bar charts can achieve transition animations between two sets of data.\n\n# Interval transition bar chart----\na &lt;- data.frame(group=c(\"A\",\"B\",\"C\"), values=c(3,2,4), frame=rep('a',3))\nb &lt;- data.frame(group=c(\"A\",\"B\",\"C\"), values=c(5,3,7), frame=rep('b',3))\ndata &lt;- rbind(a,b)  \n\n\n# Interval transition animation\np &lt;- ggplot(data, aes(x=group, y=values, fill=group)) + \n  geom_bar(stat='identity') +\n  theme_bw() +\n# Drawing animation\n  transition_states(\n    frame,  # frame as the basis for interval\n    transition_length = 2,\n    state_length = 1\n  ) +\n  ease_aes('sine-in-out')\n\nanimate(p, renderer = gifski_renderer())\n\n\n\n\n\n\n\nFigureÂ 3: Interval transition bar chart\n\n\n\nImplement a transition animation between two sets of data.\nUsing COVID-19 infection data as an example.\n\n# Using COVID-19 infection data as an example\n## Filtering data\ndata_covi19_bar &lt;- subset(data_covi19_bar, cases &gt; 50000)\n\np &lt;- ggplot(data_covi19_bar, aes(x=area, y=cases, fill=area)) + \n  geom_bar(stat='identity') +\n  theme_bw() +\n# Drawing animation\n  transition_states(\n    frame,\n    transition_length = 2,\n    state_length = 1\n  ) +\n  ease_aes('sine-in-out')\n\nanimate(p, renderer = gifski_renderer())\n\n\n\n\n\n\n\nFigureÂ 4: Taking COVID-19 infection data as an example\n\n\n\nThe image above shows a transitional animation of the number of new infections in various regions in October and December 2020.\n\n\n3. Dynamic line chart\nTaking the babynames dataset as an example\n\n# Dynamic line chart----\ndon &lt;- data_babynames %&gt;% \n  filter(name %in% c(\"Ashley\", \"Patricia\", \"Helen\")) %&gt;%\n  filter(sex==\"F\")\n\n\n# plot\ndon %&gt;%\n  ggplot( aes(x=year, y=n, group=name, color=name)) +\n  geom_line() +\n  geom_point() +\n  scale_color_viridis(discrete = TRUE) +\n  ggtitle(\"Dynamic line graphs of the number of newborns in each year using the three names\") +\n  theme_ipsum() +\n  ylab(\"Number of babies born\") +\n  transition_reveal(year) # Using time as the basis for animation\n\n\n\n\n\n\n\nFigureÂ 5: Dynamic line chart\n\n\n\nThe image above shows an animation illustrating the changing number of newborns using any of the three names from year to year.\nTaking COVID-19 infection data as an example\n\n## Taking COVID-19 infection data as an example\ndata_covi19 %&gt;%\n  ggplot( aes(x=date, y=cases, group=area, color=area)) +\n  geom_line() +\n  geom_point() +\n  scale_color_viridis(discrete = TRUE) +\n  ggtitle(\"Number of new COVID-19 infections in various regions in the second half of 2020\") +\n  theme_ipsum() +\n  ylab(\"cases\") +\n  xlab(\"month\") +\n  transition_reveal(date) # Using time as the basis for animation\n\n\n\n\n\n\n\nFigureÂ 6: Taking COVID-19 infection data as an example\n\n\n\nThe above chart is a line graph showing the number of new COVID-19 infections in various regions during the second half of 2020, with the horizontal axis representing the months.",
    "crumbs": [
      "<i class='fa-solid fa-seedling'></i> Animation",
      "Animation"
    ]
  },
  {
    "objectID": "Animation/Animation.html#applications",
    "href": "Animation/Animation.html#applications",
    "title": "Animation",
    "section": "Applications",
    "text": "Applications\nAnimated graphics can be applied to various Shiny websites to achieve dynamic data updates and real-time display.\n\n\n\n\n\n\nFigureÂ 7: Applications of animation\n\n\n\nThe image above shows the Shiny web tool, which displays real-time updates on the COVID-19 situation in Japan during the pandemic. GitHub - swsoyee/2019-ncov-japan: ğŸ¦  Interactive dashboard for real-time recording of COVID-19 outbreak in Japan\n\n\n\n\n\n\nFigureÂ 8: Applications of animation\n\n\n\nThe COVID-19 trajectory map developed by the Visualization and Visual Analytics Laboratory at Peking University.\nThe trajectory line in the image above, based on the case fatality rate and the number of infections, uses red squares to represent COVID-19. Placing it among data from other infectious diseases provides a visual profile of the epidemicâ€™s development, clearly reflecting the differences between COVID-19 and other large-scale epidemics.",
    "crumbs": [
      "<i class='fa-solid fa-seedling'></i> Animation",
      "Animation"
    ]
  },
  {
    "objectID": "Animation/Animation.html#reference",
    "href": "Animation/Animation.html#reference",
    "title": "Animation",
    "section": "Reference",
    "text": "Reference\n[1] Bryan J (2023). gapminder: Data from Gapminder. R package version 1.0.0, https://CRAN.R-project.org/package=gapminder.\n[2] Bryan J (2023). gapminder: Data from Gapminder. R package version 1.0.0, https://CRAN.R-project.org/package=gapminder.\n[3] H. Wickham. ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York, 2016. Pedersen T, Robinson D (2024). gganimate: A Grammar of Animated Graphics. R package version 1.0.9, https://CRAN.R-project.org/package=gganimate.\n[4] Ooms J, Kornel LesiÅ„ski, Authors of the dependency Rust crates (2024). gifski: Highest Quality GIF Encoder. R package version 1.32.0-1, https://CRAN.R-project.org/package=gifski.\n[5] Urbanek S, Horner J (2023). Cairo: R Graphics Device using Cairo Graphics Library for Creating High-Quality Bitmap (PNG, JPEG, TIFF), Vector (PDF, SVG, PostScript) and Display (X11 and Win32) Output. R package version 1.6-2, https://CRAN.R-project.org/package=Cairo.\n[6] Wickham H (2021). babynames: US Baby Names 1880-2017. R package version 1.0.1, https://CRAN.R-project.org/package=babynames.\n[7] Rudis B (2024). hrbrthemes: Additional Themes, Theme Components and Utilities for â€˜ggplot2â€™. R package version 0.8.7, https://CRAN.R-project.org/package=hrbrthemes.\n[8] Wickham H, FranÃ§ois R, Henry L, MÃ¼ller K, Vaughan D (2023). dplyr: A Grammar of Data Manipulation. R package version 1.1.4, https://CRAN.R-project.org/package=dplyr.\n[9] Simon Garnier, Noam Ross, Robert Rudis, AntÃ´nio P. Camargo, Marco Sciaini, and CÃ©dric Scherer (2024). viridis(Lite) - Colorblind-Friendly Color Maps for R. viridis package version 0.6.5. Wickham H, Vaughan D, Girlich M (2024). tidyr: Tidy Messy Data. R package version 1.3.1, https://CRAN.R-project.org/package=tidyr.",
    "crumbs": [
      "<i class='fa-solid fa-seedling'></i> Animation",
      "Animation"
    ]
  },
  {
    "objectID": "Proportion/ChordDiagram.html",
    "href": "Proportion/ChordDiagram.html",
    "title": "Chord Diagram",
    "section": "",
    "text": "Chord diagrams can use connecting lines or bars to represent the relationships between different objects. The connections in a chord diagram directly show the relationships between different objects; the width of the connection is proportional to the strength of the relationship, and the color of the connection can represent another mapping of the relationship, such as the type of relationship. The size of the sectors in the diagram represents the measurement of the objects.",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Chord Diagram"
    ]
  },
  {
    "objectID": "Proportion/ChordDiagram.html#example",
    "href": "Proportion/ChordDiagram.html#example",
    "title": "Chord Diagram",
    "section": "Example",
    "text": "Example\n\n\n\n\n\nThis chord graph shows the changes in blood glucose levels before and after taking a certain medication. Each arc represents a blood glucose level. The width of the chord represents the number or frequency of changes. Adjust the transparency; the chord color will be semi-transparent for clearer observation of the data flow.",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Chord Diagram"
    ]
  },
  {
    "objectID": "Proportion/ChordDiagram.html#setup",
    "href": "Proportion/ChordDiagram.html#setup",
    "title": "Chord Diagram",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming Language: R\nDependencies: tidyverse; readr; circlize; readxl; dplyr; igraph; ggraph; tidygraph; chorddiag; viridis\n\n\n# Install packages\nif (!requireNamespace(\"tidyverse\", quietly = TRUE)) {\n  install.packages(\"tidyverse\")\n}\nif (!requireNamespace(\"readr\", quietly = TRUE)) {\n  install.packages(\"readr\")\n}\nif (!requireNamespace(\"circlize\", quietly = TRUE)) {\n  install.packages(\"circlize\")\n}\nif (!requireNamespace(\"readxl\", quietly = TRUE)) {\n  install.packages(\"readxl\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"igraph\", quietly = TRUE)) {\n  install.packages(\"igraph\")\n}\nif (!requireNamespace(\"ggraph\", quietly = TRUE)) {\n  install.packages(\"ggraph\")\n}\nif (!requireNamespace(\"tidygraph\", quietly = TRUE)) {\n  install.packages(\"tidygraph\")\n}\nif (!requireNamespace(\"tidygraph\", quietly = TRUE)) {\n  remotes::install_github(\"mattflor/chorddiag\")\n}\nif (!requireNamespace(\"viridis\", quietly = TRUE)) {\n  install.packages(\"viridis\")\n}\n\n# Load packages\nlibrary(tidyverse)\nlibrary(readr)\nlibrary(circlize)\nlibrary(readxl)\nlibrary(dplyr)\nlibrary(igraph)\nlibrary(ggraph)\nlibrary(tidygraph)\nlibrary(chorddiag)\nlibrary(viridis)",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Chord Diagram"
    ]
  },
  {
    "objectID": "Proportion/ChordDiagram.html#data-preparation",
    "href": "Proportion/ChordDiagram.html#data-preparation",
    "title": "Chord Diagram",
    "section": "Data Preparation",
    "text": "Data Preparation\nThis uses TCGA-BRCA.star_counts.tsv from the UCSC Xena website (UCSC Xena (xenabrowser.net)) and Berberine_new.xlsx, which shows changes in blood glucose levels in patients after using a certain drug at a hospital.\n\n# TCGA-BRCA.star_counts.tsv\ntcga_brca_star_counts &lt;- readr::read_tsv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/TCGA-BRCA.star_counts.tsv\")\ntarget_ensembl_ids &lt;- c(\"ENSG00000012048.23\",  # BRCA1\n                        \"ENSG00000139618.16\",  # BRCA2\n                        \"ENSG00000141736.14\",  # ERBB2\n                        \"ENSG00000121879.6\",  # PIK3CA\n                        \"ENSG00000171862.11\",  # PTEN\n                        \"ENSG00000111537.5\")  # AKT1\ngene_data &lt;- tcga_brca_star_counts[tcga_brca_star_counts$Ensembl_ID %in% target_ensembl_ids, ]\ngene_data &lt;- gene_data[,2:101]\ngene_data_t &lt;- t(gene_data)\n\nx &lt;- c(gene_data_t[, 1], gene_data_t[, 3], gene_data_t[, 5])\ny &lt;- c(gene_data_t[, 2], gene_data_t[, 4], gene_data_t[, 6])\nfactor &lt;- rep(c(\"a\", \"b\", \"c\"), each = 100)\nplot_data &lt;- data.frame(x = x, y = y, factor = factor)\n\n# Berberine_new\nberberine_blood_glucose &lt;- readr::read_csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/Berberine_new.csv\")\nberberine_blood_glucose &lt;- berberine_blood_glucose %&gt;% na.omit()\n\nblood_glucose_category &lt;- function(value) {\n  if (value &lt; 4.5) {\n    return(\"Low\")\n  } else if (value &gt;= 4.5 & value &lt; 6.5) {\n    return(\"Normal\")\n  } else if (value &gt;= 6.5 & value &lt;= 11.0) {\n    return(\"Slightly High\")\n  } else {\n    return(\"High\")\n  }\n}\n\nberberine_blood_glucose$before_category &lt;- sapply(berberine_blood_glucose$before, blood_glucose_category)\nberberine_blood_glucose$after_category &lt;- sapply(berberine_blood_glucose$after, blood_glucose_category)\n\nadj_matrix &lt;- table(berberine_blood_glucose$before_category, berberine_blood_glucose$after_category) # Generate adjacency matrix\nadj_matrix_df &lt;- as.data.frame(as.table(adj_matrix))\n\nadj_matrix_wide &lt;- adj_matrix_df %&gt;%\n  pivot_wider(names_from = Var2, values_from = Freq, values_fill = list(Freq = 0))\nadj_matrix_wide_df &lt;- as.data.frame(adj_matrix_wide)\nrownames(adj_matrix_wide_df) &lt;- adj_matrix_wide_df$Var1\nm &lt;- as.matrix(adj_matrix_wide_df[, -1])",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Chord Diagram"
    ]
  },
  {
    "objectID": "Proportion/ChordDiagram.html#visualization",
    "href": "Proportion/ChordDiagram.html#visualization",
    "title": "Chord Diagram",
    "section": "Visualization",
    "text": "Visualization\n\n1. circular plot\nIn R, the circlize package can be used to create circular plots. A circular plot consists of multiple regions (three in this case), each representing the level of a factor. Creating a circular plot requires the following three steps:\nStep 1: Initialize the chart using circos.initialize()\nThis requires providing a factor vector and values for the X-axis. The pie chart will divide the chart into regions based on the number of factor levels. The length of each region will be proportional to the corresponding X-axis value.\nStep 2: Construct the regions using circos.trackPlotRegion()\nThis requires specifying factors again, and you can also specify the range of values for the Y-axis as needed.\nStep 3: Add charts to each region\nYou can draw charts in each region. Here, we use circos.trackPoints() to draw a scatter plot. The circlize package supports various types of pie charts; you can choose different visualization methods according to your needs.\n\n1.1 Basic plot\n\n# Initialize the circular plot\ncircos.clear()\ncircos.initialize(factors = plot_data$factor, x = plot_data$x)\n\n# Plot a circular scatter plot\ncircos.trackPlotRegion(factors = plot_data$factor, y = plot_data$y, track.height = 0.5, panel.fun = function(x, y) {\n  circos.axis()\n})\ncircos.trackPoints(plot_data$factor, plot_data$x, plot_data$y, col = \"blue\", pch = 16, cex = 0.5)\n\n# Add gene labeling\ncircos.text(x = 9, y = 20, labels = \"BRCA1 & BRCA2\", \n            sector.index = \"a\", facing = \"outside\", niceFacing = TRUE, \n            adj = c(0, 0.5), cex = 0.7, col = \"blue\")\n\ncircos.text(x = 11, y = 20, labels = \"ERBB2 & PIK3CA\", \n            sector.index = \"b\", facing = \"outside\", niceFacing = TRUE, \n            adj = c(0, 0.5), cex = 0.7, col = \"blue\")\n\ncircos.text(x = 17, y = 20, labels = \"PTEN & AKT1\", \n            sector.index = \"c\", facing = \"outside\", niceFacing = TRUE, \n            adj = c(0, 0.5), cex = 0.7, col = \"blue\")\n\n\n\n\nBasic plot\n\n\n\n# clear circular plot\ncircos.clear()\n\nThe circular scatter plot visually illustrates the gene expression levels and distribution characteristics of three pairs of breast cancer-related genes (BRCA1 & BRCA2, ERBB2 & PIK3CA, PTEN & AKT1). Each point represents the gene expression value in a sample, and by observing the distribution of points in different sector regions, differences in expression levels between gene pairs can be identified.\n\n\n1.2 Custom\nCustomization can be done at three different levels:\n\nInitialization phase:\n\nUse the regular par() function and the specialized circos.par() function for overall setup.\n\ncircos.axis():\n\nUsed to customize the appearance and layout of axes.\n\ncircos.trackPoints():\n\nUsed to customize the shape of points or graphs within a plot.\nMost parameters are consistent with basic R usage.\n\n# Set the background and margins of the graphic.\npar(\n  mar = c(1, 1, 1, 1),           # Set the margins of the graphic\n  bg = rgb(0.9, 0.9, 0.9)        # Set the background color of the graphic\n)\n# initialization\ncircos.clear()\ncircos.initialize(factors = plot_data$factor, x = plot_data$x)\n\n# Plot a circular scatter plot\ncircos.trackPlotRegion(factors = plot_data$factor, y = plot_data$y, track.height = 0.5, panel.fun = function(x, y) {\n  circos.axis(\n    h = \"top\",                 # Place the coordinate axes inside or outside the pie chart.\n    labels = TRUE,             # Display axis labels\n    major.tick = TRUE,         # Display major tick\n    labels.cex = 0.5,          # Set the size of the label\n    labels.font = 1,           # Set the font of the label\n    direction = \"outside\",     # The scales of the coordinate axes point outwards.\n    minor.ticks = 4,           # Set the number of minor ticks\n    major.tick.length = 0.08,  # Set the size of the major tick\n    lwd = 2                    # Set the width of the axes and tick\n  )\n})\n\ncircos.trackPoints(plot_data$factor, plot_data$x, plot_data$y, col = \"#69b3a2\", pch = 16, cex = 0.5)\n\n\n\n\nCustom\n\n\n\ncircos.clear()\n\nThe pie chart illustrates the correlation between three pairs of breast cancer-related genes. Customizable layout, colors, and labels can be adjusted to meet specific needs and questions, improving the clarity and interpretability of the chart and helping to better highlight key features and trends in the data.\n\n\n1.3 circular plot type\nThe circlize package provides various chart types: bar charts, scatter plots, line charts, vertical line charts, etc.\nCircular line chart\nYou can use circos.trackLines() to draw line charts.\n\n# Initialize the circular plot\ncircos.clear()\ncircos.initialize(factors = plot_data$factor, x = plot_data$x)\n\n# Plot a circular scatter plot\ncircos.trackPlotRegion(factors = plot_data$factor, y = plot_data$y, track.height = 0.5, panel.fun = function(x, y) {\n  circos.axis()\n})\ncircos.trackLines(plot_data$factor, plot_data$x[order(plot_data$x)], plot_data$y[order(plot_data$x)], col = rgb(0.1,0.5,0.8,0.3), lwd=2)\n\n\n\n\nCircular line chart\n\n\n\n# Clean the circular plot\ncircos.clear()\n\nCircular vertical line diagram\nSimilarly, use circos.trackLines() to draw a vertical line diagram.\n\n# Initialize the circular plot\ncircos.clear()\ncircos.initialize(factors = plot_data$factor, x = plot_data$x)\n\n# Plot a circular scatter plot\ncircos.trackPlotRegion(factors = plot_data$factor, y = plot_data$y, track.height = 0.5, panel.fun = function(x, y) {\n  circos.axis()\n})\ncircos.trackLines(plot_data$factor, plot_data$x[order(plot_data$x)], plot_data$y[order(plot_data$x)], col = rgb(0.1,0.5,0.8,0.3), lwd=2, type=\"h\")\n\n\n\n\nCircular vertical line diagram\n\n\n\n# Clean the circular plot\ncircos.clear()\n\nCircular Histogram\nEach chart type must be consistent with what is specified in the circos.trackPlotRegion function.\nFor example, for a scatter plot, the Y-axis needs to be specified, as shown previously. However, for a histogram constructed using circos.trackHist(), the Y-axis does not need to be specified.\n\n# Initialize the circular plot\ncircos.clear()\ncircos.initialize(factors = plot_data$factor, x = plot_data$x)\n\n# Drawing a histogram\ncircos.trackHist(\n  plot_data$factor,      \n  plot_data$x,           \n  col = \"#69b3a2\",       \n  bg.col = \"white\",      \n  track.height = 0.4    \n)\n\n\n\n\nCircular Histogram\n\n\n\n# Clean the circular plot\ncircos.clear()\n\nMulti-track circular plot\nThe circlize package can be used to construct circular graphs with multiple tracks.\n\n# Initialization parameters\npar(mar = c(1, 1, 1, 1))\ncircos.clear()\n\n# Initialize the circular plot\ncircos.initialize(factors = plot_data$factor, x = plot_data$x)\n\n# Add the first track and draw a line chart\ncircos.trackPlotRegion(factors = plot_data$factor, y = plot_data$y, panel.fun = function(x, y) {\n  circos.axis(labels.cex = 0.5, labels.font = 1, lwd = 0.8)\n})\ncircos.trackLines(plot_data$factor, plot_data$x[order(plot_data$x)], plot_data$y[order(plot_data$x)],\n                  col = rgb(0.1, 0.5, 0.8, 0.3), pch = 20, lwd = 2)\n\n# The second track, plot the scatter plot.\ncircos.trackPlotRegion(factors = plot_data$factor, y = plot_data$y, panel.fun = function(x, y) {\n  circos.axis(labels = FALSE, major.tick = FALSE)\n})\ncircos.trackPoints(plot_data$factor, plot_data$x, plot_data$y,\n                   col = rgb(0.9, 0.5, 0.8, 0.3), pch = 20, cex = 2)\n\n# The third track, draw a bar chart.\ncircos.par(\"track.height\" = 0.4)\ncircos.trackPlotRegion(factors = plot_data$factor, y = plot_data$y, panel.fun = function(x, y) {\n  circos.axis(labels = FALSE, major.tick = FALSE)\n})\ncircos.trackLines(plot_data$factor, plot_data$x, plot_data$y,\n                  col = rgb(0.9, 0.5, 0.1, 0.3), type = \"h\", lwd = 1.5) # It can still be stacked.\n\n# Add gene labeling\ncircos.text(x = 9, y = 40, labels = \"BRCA1 & BRCA2\", \n            sector.index = \"a\", facing = \"outside\", niceFacing = TRUE, \n            adj = c(0, 0.5), cex = 0.7, col = \"blue\")\n\ncircos.text(x = 11, y = 40, labels = \"ERBB2 & PIK3CA\", \n            sector.index = \"b\", facing = \"outside\", niceFacing = TRUE, \n            adj = c(0, 0.5), cex = 0.7, col = \"blue\")\n\ncircos.text(x = 17, y = 40, labels = \"PTEN & AKT1\", \n            sector.index = \"c\", facing = \"outside\", niceFacing = TRUE, \n            adj = c(0, 0.5), cex = 0.7, col = \"blue\")\n\n\n\n\nMulti-track circular plot\n\n\n\ncircos.clear()\n\nThe multi-track circular plot displays gene expression data for three pairs of breast cancer-related genes (BRCA1 & BRCA2, ERBB2 & PIK3CA, PTEN & AKT1). Different tracks utilize line plots, scatter plots, and bar charts to show the overall trend of gene expression, the distribution of data points, and the magnitude of change. The numbers on the outer ring represent the numerical range of gene expression levels, helping to understand the expression characteristics and interrelationships of different genes.\n\n\n1.4 Draw a part\nThe circlize package allows you to use the circos.par() function to display only a portion of the circular chart.\n\ncircos.clear()\n# Adjust the pie chart parameters to narrow the view area.\npar(mar = c(1, 2, 0.1, 0.1))  # Adjust margins\ncircos.par(\"track.height\" = 0.7,       # Each track height\n           \"canvas.xlim\" = c(0, 1),    # Horizontal limit range (zoom out view)\n           \"canvas.ylim\" = c(0, 1),    # Vertical range limitation (zoom out view)\n           \"gap.degree\" = 0,           # The angle between sectors\n           \"clock.wise\" = FALSE) \n\ncircos.initialize(factors = plot_data$factor, xlim = c(0, 20)) \ncircos.trackPlotRegion(factors = plot_data$factor, ylim = c(0, 20), bg.border = NA ) \n\n# Draw only the part where factor=a\ncircos.updatePlotRegion(sector.index = \"a\", bg.border = \"grey\" , bg.lwd=0.2)\ncircos.lines(plot_data$x, plot_data$y, pch = 16, cex = 0.5, type=\"h\" , col=\"#69b3a2\" , lwd=3)\n\n# Add axis\ncircos.axis(h=\"bottom\" , labels.cex=0.4, direction = \"inside\" )\n\n\n\n\nDraw a part\n\n\n\ncircos.clear()\n\n\n\n\n2. Chord diagram\nThe circlize package also provides functionality for building chord diagrams. It allows adding arcs between nodes to show flow. The circos.links() function builds connections one by one, while the chordDiagram() function draws the entire dataset at once.\n\n2.1 Add link\n\ncircos.clear()\npar(mar = c(1, 1, 1, 1) ) \ncircos.initialize(factors = plot_data$factor, x = plot_data$x)\n\ncircos.trackPlotRegion(factors = plot_data$factor, y = plot_data$y , bg.col = rgb(0.1,0.1,seq(0,1,0.1),0.4) , bg.border = NA)\n\n# Add a line between two points.\ncircos.link(\"a\", 3, \"b\", 3, h = 0.4)\n\n# Add lines between points and regions\ncircos.link(\"b\", 5, \"c\", c(6,8), col = \"green\", lwd = 2, lty = 2, border=\"black\" )\n\n# Add a line between the two areas.\ncircos.link(\"c\", c(8.5, 9.5), \"a\", c(-1,0), col = \"red\", border = \"blue\", h = 0.2)\n\n\n\n\nAdd link\n\n\n\n\n\n\n2.2 Basic Chord Diagram\nTaking Berberine_new as an example\n\nchordDiagram(m, transparency = 0.5)\n\n\n\n\nBasic Chord Diagram\n\n\n\n\nThis chord diagram illustrates the change in blood sugar levels before and after taking a certain medication.\nDefine colors\n\ncolor &lt;- c(\n  \"Low\" = \"#1f77b4\",    \n  \"Normal\" = \"#2ca02c\",    \n  \"Slightly High\" = \"#ff7f0e\", \n  \"High\" = \"#d62728\"\n)\n\nchordDiagram(m, grid.col = color, transparency = 0.5)\n\n\n\n\nDefine colors\n\n\n\n\nThis chord diagram illustrates the change in blood sugar levels before and after taking a certain medication, and the colors are defined to better suit user reading habits.\n\n\n2.3 Faceted chord diagram\nUse the layout function to define the layout.\n\nlayout(matrix(c(1, 2), nrow = 1, byrow = TRUE)) \n\nchordDiagram(m, transparency = 0.5)\nchordDiagram(m, transparency = 0.5) # chordDiagram() automatically assigns colors and generates two different chord diagrams.\n\n\n\n\nFaceted chord diagram\n\n\n\n\n\n\n2.4 Directional layered chord diagram\nIn the directional layered chord diagram, the arrows clearly indicate the direction of flow, highlighting the directionality of the flow through different heights, while also increasing the visual hierarchy of the graphic.\n\n# Convert the matrix to long format.\ndata_long &lt;- as.data.frame(as.table(m)) %&gt;%\n  rename(from = Var1, to = Var2, value = Freq)\n\n# Set color\ncategory_colors &lt;- viridis(4)\ngrid_col &lt;- category_colors[unique(c(data_long$from, data_long$to))]\n\n# Setting parameters for the circular plot\ncircos.clear()\ncircos.par(start.degree = 90, gap.degree = 4, track.margin = c(-0.1, 0.1), points.overflow.warning = FALSE)\npar(mar = rep(0, 4))\n\n# Draw a circular plot\nchordDiagram(\n  x = data_long, \n  grid.col = grid_col,\n  transparency = 0.25,\n  directional = 1,\n  direction.type = c(\"arrows\", \"diffHeight\"), \n  diffHeight  = -0.04,\n  annotationTrack = \"grid\", \n  annotationTrackHeight = c(0.05, 0.1),\n  link.arr.type = \"big.arrow\", \n  link.sort = TRUE, \n  link.largest.ontop = TRUE\n)\n\n# Add text and axes\ncircos.trackPlotRegion(\n  track.index = 1, \n  bg.border = NA, \n  panel.fun = function(x, y) {\n\n    xlim = get.cell.meta.data(\"xlim\")\n    sector.index = get.cell.meta.data(\"sector.index\")\n\n    # Add a name to each sector\n    circos.text(\n      x = mean(xlim), \n      y = 3.2, \n      labels = sector.index, \n      facing = \"bending\", \n      cex = 0.8\n    )\n  }\n)\n\n\n\n\nDirectional layered chord diagram\n\n\n\n\nThis chord diagram illustrates the change in blood glucose levels before and after taking a certain medication. Directional hierarchical chord diagrams, by adding arrows and a hierarchical structure, can more clearly show the direction and intensity of data flow, helping to identify the relationships between different categories and information transmission paths, thus enhancing data visualization and understanding.\n\n\n2.5 Highly customized chord diagrams\nYou can manually add links using the circos.link() function to build a highly customized chord graph.\nThe circlize package provides the chordDiagram() function, which can automatically build the entire chord graph, but its customization is less advanced.\n\n# Define categories and colors\ncategories &lt;- rownames(m)\ncategory_colors &lt;- data.frame(\n  category = categories,\n  r = c(255, 200, 150, 100),  \n  g = c(100, 150, 200, 255), \n  b = c(150, 100, 50, 200)  \n)\n\ndf1 &lt;- category_colors\ndf1$xmin &lt;- 0  # Starting point is 0\ndf1$xmax &lt;- rowSums(m) + colSums(m)  # Total traffic (inflow + outflow) for each category\ndf1$rcol &lt;- rgb(df1$r, df1$g, df1$b, max = 255)  # Section Color\ndf1$lcol &lt;- rgb(df1$r, df1$g, df1$b, alpha = 200, max = 255)  # Link color (transparent)\n\nlibrary(circlize)\n\n# circular plot initialization\npar(mar = rep(0, 4))\ncircos.clear()\ncircos.par(cell.padding = c(0, 0, 0, 0), track.margin = c(0, 0.1), start.degree = 90, gap.degree = 4)\n\ncircos.initialize(factors = df1$category, xlim = cbind(df1$xmin, df1$xmax))\ncircos.trackPlotRegion(ylim = c(0, 1), factors = df1$category, track.height = 0.1,\n                       panel.fun = function(x, y) {\n                         name = get.cell.meta.data(\"sector.index\")\n                         i = get.cell.meta.data(\"sector.numeric.index\")\n                         xlim = get.cell.meta.data(\"xlim\")\n                         ylim = get.cell.meta.data(\"ylim\")\n\n                         # Draw labels and sections\n                         circos.text(x = mean(xlim), y = 1.2, labels = name, facing = \"bending.inside\", cex = 0.6, adj = c(0.5, 0.5))\n                         circos.rect(xleft = xlim[1], ybottom = ylim[1], xright = xlim[2], ytop = ylim[2],\n                                     col = df1$rcol[i], border = df1$rcol[i])\n                       })\n\ndf1$sum1 &lt;- colSums(m)  # Cumulative outflow\ndf1$sum2 &lt;- numeric(nrow(df1))  # Cumulative inflow\n\n# Draw links by traversing the adjacency matrix\nfor (i in 1:nrow(m)) {\n  for (j in 1:ncol(m)) {\n    if (m[i, j] &gt; 0) {  # Only draw links with values\n      circos.link(sector.index1 = df1$category[i], point1 = c(df1$sum1[i], df1$sum1[i] + m[i, j]),\n                  sector.index2 = df1$category[j], point2 = c(df1$sum2[j], df1$sum2[j] + m[i, j]),\n                  col = df1$lcol[i])\n\n      # Update cumulative value\n      df1$sum1[i] &lt;- df1$sum1[i] + m[i, j]\n      df1$sum2[j] &lt;- df1$sum2[j] + m[i, j]\n    }\n  }\n}\n\n\n\n\nHighly customized chord diagrams\n\n\n\n\n\n\n2.6 Interactive Chord Diagram\nInteractivity makes chord diagrams easier to understand. In interactive chord diagrams, you can hover over specific groups to highlight all their connections.\n\n# Assign colors\ncategory &lt;- c(\"Low\", \"Normal\", \"Slightly High\", \"High\")\ndimnames(m) &lt;- list(\n  have = category,\n  prefer = category\n)\ngroupColors &lt;- c(\"#ADD9EE\", \"#7B92C7\", \"#F7C1CF\", \"#FFD47F\")\n\np &lt;- chorddiag(m, groupColors = groupColors, groupnamePadding = 20)\np\n\n\n\nInteractive Chord Diagram\n\n# Save\n# library(htmlwidgets)\n# saveWidget(p, file=paste0( getwd(), \"/HtmlWidget/chord_interactive.html\"))\n\nThis chord diagram illustrates the change in blood glucose levels before and after taking a certain medication. Interactive chord diagrams allow users to dynamically explore the data, viewing more detailed information with the mouse, thus enabling more flexible analysis of complex relationships and data flows, and improving data operability and comprehension.",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Chord Diagram"
    ]
  },
  {
    "objectID": "Proportion/ChordDiagram.html#applications",
    "href": "Proportion/ChordDiagram.html#applications",
    "title": "Chord Diagram",
    "section": "Applications",
    "text": "Applications\n\n1. Basic chord diagram\n\n\n\n\n\n\nFigureÂ 1: Applications of basic chord diagram\n\n\n\nOverlap between phosphorylation site differences in CK1tau and CK1 overexpression. The chord plot shows the number of identified phosphorylation sites whose abundance differed significantly from the generatrix in the phosphorylated proteomics analysis described here (&gt;1.5 or &lt;0.67 fold change, p &lt; 0.05, n = 5). Shared chords indicate overlap between the two datasets. Upregulated peptides are shown in dark blue, and downregulated peptides in light blue. [1]\n\n\n2. Faceted chord diagram\n\n\n\n\n\n\nFigureÂ 2: Applications of faceted chord diagram\n\n\n\nAn overview of the network interactions of the entire cortico-thalamic-basal ganglia circuit, divided by subregions. [2]\n\n\n3. Directional layered chord diagram\n\n\n\n\n\n\nFigureÂ 3: Applications of directional layered chord diagram\n\n\n\nThe chord diagram illustrates the network relationships of 12 specific species coexisting in an uncontaminated permafrost sample.[3]\n\n\n4. Highly customized chord diagrams\n\n\n\n\n\n\nFigureÂ 4: Applications of highly customized chord diagrams\n\n\n\nModular structure of the potential hippocampal connectome. A, Chord diagram of potential connections between all 122 types. Thick chords with arrows emphasize trisynaptic loops (dark green, perforation pathway; light green, temporal pathway; red, moss fibers; blue, Schaffer collaterals; orange, projection from CA1 to EC layer V); other connections are randomly colored to optimize visibility. Types are indicated by numbers in brackets and axon-dendritic patterns within subregions of their cell body location (color boxes convention and layer order; CA1 layers: SLM, SR, SP, SO; sublayers: molecular layer, SP, polymorphic layer; EC: I-VI). Shaded bars in the innermost loops indicate the total number of (signed) connections established by that type; excitatory types have outward-facing black bars, and inhibitory types have inward-facing gray bars. B, Modularity score (Q) of the entire network and the four detected modules. C, the community is closely related to DG (component connection density 75.9%), CA3 (59.3%), CA1 (64.6%) and EC (70.1%; not shown). [4]",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Chord Diagram"
    ]
  },
  {
    "objectID": "Proportion/ChordDiagram.html#reference",
    "href": "Proportion/ChordDiagram.html#reference",
    "title": "Chord Diagram",
    "section": "Reference",
    "text": "Reference\n[1] van Ooijen G, Martin SF, Barrios-Llerena ME, Hindle M, Le Bihan T, Oâ€™Neill JS, Millar AJ. Functional analysis of the rodent CK1tau mutation in the circadian clock of a marine unicellular alga. BMC Cell Biol. 2013 Oct 15;14:46. doi: 10.1186/1471-2121-14-46. PMID: 24127907; PMCID: PMC3852742.\n[2] Hunnicutt BJ, Jongbloets BC, Birdsong WT, Gertz KJ, Zhong H, Mao T. A comprehensive excitatory input map of the striatum reveals novel functional organization. Elife. 2016 Nov 28;5:e19103. doi: 10.7554/eLife.19103. PMID: 27892854; PMCID: PMC5207773.\n[3] Yang S, Wen X, Shi Y, Liebner S, Jin H, Perfumo A. Hydrocarbon degraders establish at the costs of microbial richness, abundance and keystone taxa after crude oil contamination in permafrost environments. Sci Rep.Â 2016 Nov 25;6:37473. doi: 10.1038/srep37473. PMID: 27886221; PMCID: PMC5122841.\n[4] Rees CL, Wheeler DW, Hamilton DJ, White CM, Komendantov AO, Ascoli GA. Graph Theoretic and Motif Analyses of the Hippocampal Neuron Type Potential Connectome. eNeuro. 2016 Nov 18;3(6):ENEURO.0205-16.2016. doi: 10.1523/ENEURO.0205-16.2016. PMID: 27896314; PMCID: PMC5114701.\n[5] Gu, Z. (2020). circlize: Circular visualization in R. https://cran.r-project.org/package=circlize\n[6] Wickham, H. (2021). readxl: Read Excel Files. https://cran.r-project.org/package=readxl\n[7] Wickham, H. (2021). dplyr: A Grammar of Data Manipulation. https://cran.r-project.org/package=dplyr\n[8] Csardi, G., & Nepusz, T. (2006). igraph: Complex network analysis. https://cran.r-project.org/package=igraph\n[9] Wickham, H. (2016). ggraph: An implementation of grammar of graphics for graphs and networks. https://cran.r-project.org/package=ggraph\n[10] Wickham, H., & FranÃ§ois, R. (2021). tidygraph: A tidy API for graph manipulation. https://cran.r-project.org/package=tidygraph",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Chord Diagram"
    ]
  },
  {
    "objectID": "Proportion/Network.html",
    "href": "Proportion/Network.html",
    "title": "Network Graph",
    "section": "",
    "text": "A network graph is a graphical model that resembles a network and consists of nodes and links, where links can be directed or undirected.",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Network Graph"
    ]
  },
  {
    "objectID": "Proportion/Network.html#example",
    "href": "Proportion/Network.html#example",
    "title": "Network Graph",
    "section": "Example",
    "text": "Example",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Network Graph"
    ]
  },
  {
    "objectID": "Proportion/Network.html#setup",
    "href": "Proportion/Network.html#setup",
    "title": "Network Graph",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming Language: R\nDependencies: igraph; cowplot; RColorBrewer; networkD3\n\n\n# Install packages\nif (!requireNamespace(\"igraph\", quietly = TRUE)) {\n  install.packages(\"igraph\")\n}\nif (!requireNamespace(\"cowplot\", quietly = TRUE)) {\n  install.packages(\"cowplot\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\nif (!requireNamespace(\"networkD3\", quietly = TRUE)) {\n  install.packages(\"networkD3\")\n}\n\n# Load packages\nlibrary(igraph)\nlibrary(cowplot)\nlibrary(RColorBrewer)\nlibrary(networkD3)",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Network Graph"
    ]
  },
  {
    "objectID": "Proportion/Network.html#data-preparation",
    "href": "Proportion/Network.html#data-preparation",
    "title": "Network Graph",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe plotting is mainly done using Râ€™s built-in datasets.\n\n# network_pmat\n## Correlation analysis results of various indicators in the Matcars dataset\ndata_pmat_links&lt;- readr::read_csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/data_mat.csv\")\ndata_pmat_links &lt;- na.omit(data_pmat_links)\ncolnames(data_pmat_links) &lt;- c(\"from\", \"to\", \"p.log\")\n\ndata_pmat_node &lt;- colnames(mtcars)\nnetwork_pmat &lt;- graph_from_data_frame(d=data_pmat_links, vertices=data_pmat_node, directed=F) \n\n# data_mat\n## mtcars clustering analysis\n## Calculate the correlation coefficient matrix\ndata_mat &lt;- cor(t(mtcars[,c(1,3:6)]))\n## Filtering highly relevant data\ndata_mat[data_mat&lt;0.995] &lt;- 0\n\n\nInput data types for network diagrams\nThere are four main types of data input for network graphs: adjacency matrix, incident matrix, edge matrix, and a list of connected text.\nHere we will demonstrate using random data.\n\n## Adjacency matrix (square matrix)-----\nset.seed(10)\ndata1 &lt;- matrix(sample(0:2, 25, replace=TRUE), nrow=5)\ncolnames(data1) = rownames(data1) = LETTERS[1:5]\n# Create a graph\nnetwork1 &lt;- graph_from_adjacency_matrix(data1)\n\ndata1\n\n  A B C D E\nA 2 2 1 2 2\nB 0 2 2 1 1\nC 1 2 1 2 1\nD 2 2 1 1 0\nE 1 2 0 2 0\n\n## Incident matrix (rows and columns are not necessarily equal; by default, rows are oriented to columns).-----\nset.seed(1)\ndata2 &lt;- matrix(sample(0:2, 15, replace=TRUE), nrow=3)\ncolnames(data2) &lt;- letters[1:5] # lowercase letters\nrownames(data2) &lt;- LETTERS[1:3] # uppercase letter\n# Create a graph\nnetwork2 &lt;- graph_from_incidence_matrix(data2)\n\nWarning: `graph_from_incidence_matrix()` was deprecated in igraph 1.6.0.\nâ„¹ Please use `graph_from_biadjacency_matrix()` instead.\n\ndata2\n\n  a b c d e\nA 0 1 2 2 0\nB 2 0 1 2 0\nC 0 2 1 0 1\n\n## Edge list (two columns represent source and destination respectively)-----\nlinks &lt;- data.frame(\nsource=c(\"A\",\"A\", \"A\", \"A\", \"A\",\"F\", \"B\"),\n  target=c(\"B\",\"B\", \"C\", \"D\", \"F\",\"A\",\"E\")\n)\n# Create a graph\nnetwork3 &lt;- graph_from_data_frame(d=links, directed=F) \n\nlinks\n\n  source target\n1      A      B\n2      A      B\n3      A      C\n4      A      D\n5      A      F\n6      F      A\n7      B      E\n\n## Linked text list----\nnetwork4 &lt;- graph_from_literal( A-B-C-D, E-A-E-A, D-C-A, D-A-D-C )\n\nFour data types of drawing examples\n\n# plot----\npar(mfrow=c(2,2), mar=c(1,1,1,1))\nplot(network1, main=\"Adjacency matrix (square matrix)\")\nplot(network2, main=\"Incident matrix\")\nplot(network3, main=\"Edge List\")\nplot(network4, main=\"Linked text list\")\n\n\n\n\nFour data types of drawing examples",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Network Graph"
    ]
  },
  {
    "objectID": "Proportion/Network.html#visualization",
    "href": "Proportion/Network.html#visualization",
    "title": "Network Graph",
    "section": "Visualization",
    "text": "Visualization\n\n1. Custom nodes, links, and tags\n\n# Custom----\n# Generate random data\nset.seed(1)\ndata3 &lt;- matrix(sample(0:1, 100, replace=TRUE, prob=c(0.8,0.2)), nc=10)\nnetwork5 &lt;- graph_from_adjacency_matrix(data3 , mode='undirected', diag=F )\n\npar(mfrow=c(2,2), mar=c(1,1,1,1))\n\n# Default network diagram\nplot(network5, main = \"Default network diagram\")\n# Custom Node\nplot(network5,\n     vertex.color = rgb(0.8,0.2,0.2,0.9),           # color\n     vertex.frame.color = \"Forestgreen\",            # Border color\n     vertex.shape=c(\"circle\",\"square\"),             # Node shape, optional:â€œnoneâ€, â€œcircleâ€, â€œsquareâ€, â€œcsquareâ€, â€œrectangleâ€ â€œcrectangleâ€, â€œvrectangleâ€, â€œpieâ€, â€œrasterâ€,  â€œsphereâ€\n     vertex.size=c(15:24),\n     main = \"Custom Node\"\n)\n# Custom labels\nplot(network5, \n     vertex.label=LETTERS[1:10],                    \n     vertex.label.color=c(\"red\",\"blue\"),\n     vertex.label.family=\"Times\",                   \n     vertex.label.font=c(1,2,3,4),                  \n     vertex.label.cex=c(0.5,1,1.5),                 \n     vertex.label.dist=0,                           \n     vertex.label.degree=0,                         \n     main = \"Custom labels\"\n)\n# Custom Links\nplot(network5,\n     edge.color=rep(c(\"red\",\"pink\"),5),           \n     edge.width=seq(1,10),                        \n     edge.arrow.size=1,                           \n     edge.arrow.width=1,                          \n     edge.lty=c(\"solid\"),                        \n     main = \"Custom Links\"\n)\n\n\n\n\nCustom nodes, links, and tags\n\n\n\n\n\n\n2. Layout\nDifferent network graph layouts can be used as needed, such as sphere, circle, random, fruchterman.reingold, etc.\n\n# Layout ----\n# Generate random data\ndata4 &lt;- matrix(sample(0:1, 400, replace=TRUE, prob=c(0.8,0.2)), nrow=20)\nnetwork6 &lt;- graph_from_adjacency_matrix(data4 , mode='undirected', diag=F )\n\n# Different layouts\npar(mfrow=c(2,2), mar=c(1,1,1,1))\nplot(network6, layout=layout.sphere, main=\"sphere\")\nplot(network6, layout=layout.circle, main=\"circle\")\nplot(network6, layout=layout.random, main=\"random\")\nplot(network6, layout=layout.fruchterman.reingold, main=\"fruchterman.reingold\")\n\n\n\n\nLayout\n\n\n\n\n\n\n3. Variable mapping to nodes and connections\n\n3.1 Variable classification mapping to nodes\n\n## Mapped to node\n# Generate random data\nlinks &lt;- data.frame(\nsource=c(\"A\",\"A\", \"A\", \"A\", \"A\",\"J\", \"B\", \"B\", \"C\", \"C\", \"D\",\"I\"),\n  target=c(\"B\",\"B\", \"C\", \"D\", \"J\",\"A\",\"E\", \"F\", \"G\", \"H\", \"I\",\"I\"),\n  importance=(sample(1:4, 12, replace=T))\n)\nnodes &lt;- data.frame(\n  name=LETTERS[1:10],\n  carac=c( rep(\"group1\",3),rep(\"group2\",2), rep(\"group3\",5))\n)\n\n# igraph\nnetwork &lt;- graph_from_data_frame(d=links, vertices=nodes, directed=F) \n\n# color\ncoul  &lt;- brewer.pal(3, \"Set1\") \n\n# Color vector\nmy_color &lt;- coul[as.numeric(as.factor(V(network)$carac))]\n\n# plot\nplot(network, vertex.color=my_color)\n\n# Add labels\nlegend(\"bottomleft\", \n       legend=levels(as.factor(V(network)$carac))  , \n       col = coul , bty = \"n\", pch=20 , pt.cex = 3, cex = 1.5, text.col=coul , \n       horiz = FALSE, inset = c(0.1, 0.1))\n\n\n\n\nVariable classification mapping to nodes\n\n\n\n\nThe node colors in the image above represent categories.\n\n\n3.2 Variable mapping to link\n\n## Variable mapping to link\nplot(network, vertex.color=my_color, edge.width=E(network)$importance*2 )\n\nlegend(\"bottomleft\", \n       legend=levels(as.factor(V(network)$carac))  , \n       col = coul , \n       bty = \"n\", \n       pch=20 , \n       pt.cex = 3, \n       cex = 1.5, \n       text.col=coul, \n       horiz = FALSE, \n       inset = c(0.1, 0.1))\n\n\n\n\nVariable mapping to link\n\n\n\n\nThe figure above shows the correlation analysis results (Î±=0.01) of various indicators in the mtcars dataset, using the marginal list data input type. Links indicate a correlation between two indicators; the thickness of the link represents -log10 of the p-value, with thicker links indicating more reliable results.\n\n\n\n4. Node size maps to number of connections\nThe degree function can be used here to calculate the number of connections.\n\n## The node size corresponds to the number of links (degree function).----\n# Calculate the number of links\ndeg &lt;- degree(network_pmat, mode=\"all\")\n\n# plot\nplot(network_pmat, \n     vertex.size=deg*6,\n     layout=layout.circle, \n     vertex.color=rgb(0.1,0.7,0.8,0.5),\n     edge.width=E(network_pmat)$value*0.5)\n\n\n\n\nNode size maps to number of connections\n\n\n\n\nIn the diagram above, the size of a node represents the number of links to that node (and the number of related metrics).\n\n\n5. Clustering results visualization\nHere, we take the mtcars dataset as an example for cluster analysis.\n\n# Clustering results visualization ----\n# Create igraph graph\nnetwork &lt;- graph_from_adjacency_matrix( data_mat, weighted=T, mode=\"undirected\", diag=F)\n\n# Colors are used to establish a mapping, with different colors representing different cylinders.\ncoul &lt;- brewer.pal(nlevels(as.factor(mtcars$cyl)), \"Set2\")\nmy_color &lt;- coul[as.numeric(as.factor(mtcars$cyl))]\n\n# plot\npar(bg=\"grey13\", mar=c(0,0,0,0))\nset.seed(4)\nplot(network, \n     vertex.size=12,\n     vertex.color=my_color, \n     vertex.label.cex=0.7,\n     vertex.label.color=\"white\",\n     vertex.frame.color=\"transparent\",\n     edge.color=rep(c(\"red\",\"pink\"),5),           \n     edge.width=seq(1,10),                      \n     edge.arrow.size=1,                           \n     edge.arrow.width=1,                         \n     edge.lty=c(\"solid\"),\n     edge.curved=0.3\n)\n\n# Add title and labels\ntext(0,0,\"mtcars network\",col=\"white\", cex=1.5)\nlegend(x=-0.2, y=-0.12, \n       legend=paste( levels(as.factor(mtcars$cyl)), \" cylinders\", sep=\"\"), \n       col = coul , \n       bty = \"n\", pch=20 , pt.cex = 2, cex = 1,\n       text.col=\"white\" , horiz = F)\n\n\n\n\nClustering results visualization\n\n\n\n\nThe image above shows the results of cluster analysis on the mtcars dataset based on mpg, disp, gp, and drat. Different colors represent different cyl clusters.\n\n\n6. 3D Interactive Network Diagram\nThe networkD3 package can be used to enable 3D interaction of network graphs.\n\n## Interaction (networkD3)----\np &lt;- simpleNetwork(data_pmat_links, height=\"100px\", width=\"100px\")\np\n\n\n\n3D Interactive Network Diagram\n\n\nInteractive elements can be used to achieve functions such as highlighting and dragging (the image above shows dragging a carb node).",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Network Graph"
    ]
  },
  {
    "objectID": "Proportion/Network.html#applications",
    "href": "Proportion/Network.html#applications",
    "title": "Network Graph",
    "section": "Applications",
    "text": "Applications\n\n\n\n\n\n\nFigureÂ 1: Applications of Network Graph\n\n\n\nThe above figure shows the motor network of the subjects in the experimental control group. (A) Individual voxels of the centroids of the regions corresponding to PMC, SMA, PMA, and SPL are identified bilaterally in each hemisphere. (B) Pairwise Pearson cross-correlation coefficients between each region are calculated, and an adjacency matrix is constructed. (C) A weighted undirected network graph is constructed from the cross-correlation adjacency matrix. (D) An adjacency matrix is constructed using the consistency of the 0.08â€“0.15 Hz frequency band, and a weighted undirected network graph is constructed, similar to the graph obtained from the cross-correlation. [1]",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Network Graph"
    ]
  },
  {
    "objectID": "Proportion/Network.html#reference",
    "href": "Proportion/Network.html#reference",
    "title": "Network Graph",
    "section": "Reference",
    "text": "Reference\n[1] Otten ML, Mikell CB, Youngerman BE, Liston C, Sisti MB, Bruce JN, Small SA, McKhann GM 2nd. Motor deficits correlate with resting state motor network connectivity in patients with brain tumours. Brain. 2012 Apr;135(Pt 4):1017-26. doi: 10.1093/brain/aws041. Epub 2012 Mar 8. PMID: 22408270; PMCID: PMC3326259.\n[2] Csardi G, Nepusz T (2006). â€œThe igraph software package for complex network research.â€ InterJournal, Complex Systems, 1695. https://igraph.org.\n[3] Wilke C (2024). cowplot: Streamlined Plot Theme and Plot Annotations for â€˜ggplot2â€™. R package version 1.1.3, https://CRAN.R-project.org/package=cowplot.\n[4] Neuwirth E (2022). RColorBrewer: ColorBrewer Palettes. R package version 1.1-3, https://CRAN.R-project.org/package=RColorBrewer.\n[5] Allaire J, Gandrud C, Russell K, Yetman C (2017). networkD3: D3 JavaScript Network Graphs from R. R package version 0.4, https://CRAN.R-project.org/package=networkD3.",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Network Graph"
    ]
  },
  {
    "objectID": "Proportion/Sankey.html",
    "href": "Proportion/Sankey.html",
    "title": "Sankey Diagram",
    "section": "",
    "text": "A Sankey diagram allows to study flows. Entities (nodes) are represented by rectangles or text. Arrows or arcs are used to show flows between them. In R, the networkD3 package is the best way to build them.",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Sankey Diagram"
    ]
  },
  {
    "objectID": "Proportion/Sankey.html#example",
    "href": "Proportion/Sankey.html#example",
    "title": "Sankey Diagram",
    "section": "Example",
    "text": "Example\n\n\n\n\n\nThis chart visualizes the genre distribution of summer movies over decades using a Sankey bump chart. It highlights the three most common genres (Drama, Comedy, and Romance) and shows how their prevalence has changed over time.",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Sankey Diagram"
    ]
  },
  {
    "objectID": "Proportion/Sankey.html#setup",
    "href": "Proportion/Sankey.html#setup",
    "title": "Sankey Diagram",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming Language: R\nDependencies: ggplot2, networkD3, dplyr, readxl, webshot, tidyverse, openxlsx, ggalluvial\n\n\n# Install packages\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"networkD3\", quietly = TRUE)) {\n  install.packages(\"networkD3\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"readxl\", quietly = TRUE)) {\n  install.packages(\"readxl\")\n}\nif (!requireNamespace(\"webshot\", quietly = TRUE)) {\n  install.packages(\"webshot\")\n}\nif (!requireNamespace(\"tidyverse\", quietly = TRUE)) {\n  install.packages(\"tidyverse\")\n}\nif (!requireNamespace(\"openxlsx\", quietly = TRUE)) {\n  install.packages(\"openxlsx\")\n}\nif (!requireNamespace(\"ggalluvial\", quietly = TRUE)) {\n  install.packages(\"ggalluvial\")\n}\n\n# Load packages\nlibrary(ggplot2)   \nlibrary(networkD3)   \nlibrary(dplyr)  \nlibrary(readxl) \nlibrary(webshot)   \nlibrary(tidyverse)\nlibrary(openxlsx)\nlibrary(ggalluvial)",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Sankey Diagram"
    ]
  },
  {
    "objectID": "Proportion/Sankey.html#data-preparation",
    "href": "Proportion/Sankey.html#data-preparation",
    "title": "Sankey Diagram",
    "section": "Data Preparation",
    "text": "Data Preparation\nHereâ€™s a brief tutorial using the clinical data of a certain drug froma clinical database. This dataset examines the impact of a drug on patientsâ€™ blood glucose levels, which are categorized into three levels: low (&lt;3.9 mmol/L), normal (3.9-6.1 mmol/L), and high (&gt;6.1 mmol/L). The absolute value of the change in glucose levels before and after drug administration is represented by value.This example demonstrates how to load and work with these datase.\n\n#Read drug clinical dataset\ndrugs &lt;- read.csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/drugs.csv\", stringsAsFactors = FALSE)\n# Create a node data frame\nnodes &lt;- data.frame(\n  name=c(as.character(drugs$source), \n         as.character(drugs$target)) %&gt;% unique())\n# Reformat\ndrugs$IDsource &lt;- match(drugs$source, nodes$name)-1 \ndrugs$IDtarget &lt;- match(drugs$target, nodes$name)-1\n\n\n#Read drug clinical dataset\ndrug &lt;- read.csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/drug.csv\", stringsAsFactors = FALSE)\nlevels(drug$`glucoseï¼ˆmmol/Lï¼‰`) &lt;- rev(levels(drug$`glucoseï¼ˆmmol/Lï¼‰`))",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Sankey Diagram"
    ]
  },
  {
    "objectID": "Proportion/Sankey.html#visualization",
    "href": "Proportion/Sankey.html#visualization",
    "title": "Sankey Diagram",
    "section": "Visualization",
    "text": "Visualization\n\n1. Using the networkD3 Package\n\n1.1 Basic Sankey Diagram\nFigureÂ 1 The sankey diagram describes the changes in blood glucose levels of patients before and after the use of a certain drug.\n\n# Basic plotting\np1 &lt;- sankeyNetwork(Links = drugs, Nodes = nodes,\n              Source = \"IDsource\", Target = \"IDtarget\",\n              Value = \"value\", NodeID = \"name\") \n              \np1\n\n\n\n\n\n\n\nFigureÂ 1: Basic Sankey Diagram\n\n\n\n\n\n\n1.2 Customizing Colors\nUsing JavaScript to call\nFigureÂ 2 The sankey diagram describes the changes in blood glucose levels of patients before and after the use of a certain drug.\nThe first step is to create a JavaScript object for color mapping. Then, assign a color to each node. Finally, call this object in the colourScale parameter of networkD3.\n\n# Prepare a color scale: assign a specific color to each node\nmy_color &lt;- 'd3.scaleOrdinal() .domain([\"before-normal\", \"before-high\",\"before-low\", \"after-high\", \"after-low\", \"after-normal\"]) .range([\"steelblue\", \"red\" , \"#69b3a2\", \"red\", \"#69b3a2\", \"steelblue\"])'\n\np2_1 &lt;- sankeyNetwork(Links = drugs, Nodes = nodes,\n              Source = \"IDsource\", Target = \"IDtarget\",\n              Value = \"value\", NodeID = \"name\", \n              colourScale=my_color,fontSize=15,nodePadding=20,nodeWidth=25)\np2_1\n\n\n\n\n\n\n\nFigureÂ 2: Setting Single Node Colors\n\n\n\n\nFigureÂ 3 This Sankey diagram shows the changes in blood glucose levels of patients before and after the use of a certain drug. The blue group indicates a change in blood glucose levels greater than 1 mmol/L, while the green group indicates a change less than 1 mmol/L.\n\n# Add a \"group\" column to each link\ndrugs$group &lt;- as.factor( c(\"type_a\",\"type_a\",\"type_b\",\"type_b\",\"type_b\",\"type_b\",\"type_a\",\"type_b\",\"type_b\",\"type_b\",\"type_a\",\"type_a\",\"type_a\",\"type_b\",\"type_a\",\"type_a\",\"type_a\",\"type_a\"))\n\n# Add a \"group\" column to each node. Here, they are all placed in the same group to make them gray\nnodes$group &lt;- as.factor(c(\"my_unique_group\"))\n\n# Assign colors to each group\nmy_color &lt;- 'd3.scaleOrdinal() .domain([\"type_a\", \"type_b\", \"my_unique_group\"]) .range([\"#69b3a2\", \"steelblue\", \"grey\"])'\n\np2_3 &lt;- sankeyNetwork(Links = drugs, Nodes = nodes,\n              Source = \"IDsource\", Target = \"IDtarget\",\n              Value = \"value\", NodeID = \"name\", \n              colourScale=my_color,LinkGroup=\"group\", NodeGroup=\"group\")\np2_3\n\n\n\n\n\n\n\nFigureÂ 3: Setting Link Colors\n\n\n\n\n\n\n\n2. Using the ggalluvial Package\nggalluvial is an extension package of ggplot2. It follows the layered syntax of ggplot2 and is used to create alluvial plots, which are similar to Sankey diagrams but are uniquely determined by the data and a set of parameters.\n\n2.1 Basic Sankey Diagram\nFigureÂ 4 This Sankey diagram shows the changes in blood glucose levels of patients before and after the use of a certain drug\n\n# Basic Sankey Diagram\np4_1 &lt;- ggplot(drug,\n       aes(x = time, stratum = level, alluvium = id,\n           y = value,\n           fill = level, label = level)) +\n  scale_x_discrete(expand = c(.1, .1)) +\n  geom_flow() +\n  geom_stratum(alpha = .5) +\n  geom_text(stat = \"stratum\", size = 3) +\n  theme(legend.position = \"none\") \n\np4_1\n\n\n\n\n\n\n\nFigureÂ 4: Basic Sankey Diagram\n\n\n\n\n\n\n\n2.2 Changing Line Types\nBy changing the curve_type parameter, there are seven options: â€œlinearâ€, â€œcubicâ€, â€œquinticâ€, â€œsineâ€, â€œarctangentâ€, â€œsigmoidâ€, and â€œxsplineâ€.\nFigureÂ 5 This Sankey diagram shows the changes in blood glucose levels of patients before and after the use of a certain drug.\n\n# Linear\np5_1 &lt;- ggplot(drug,\n       aes(x = time, stratum = level, alluvium = id,\n           y = value,\n           fill = level, label = level)) +\n  scale_x_discrete(expand = c(.1, .1)) +\n  geom_alluvium(curve_type = \"linear\")+\n  geom_stratum(alpha = 1) +\n  geom_text(stat = \"stratum\", aes(label = after_stat(stratum))) +\n  theme(legend.position = \"none\") \n\np5_1\n\n\n\n\n\n\n\nFigureÂ 5: Changing Line Types\n\n\n\n\n\nFigureÂ 6 This Sankey diagram shows the changes in blood glucose levels of patients before and after the use of a certain drug.\n\n# Sigmoid\np5_2 &lt;- ggplot(drug,\n       aes(x = time, stratum = level, alluvium = id,\n           y = value,\n           fill = level, label = level)) +\n  scale_x_discrete(expand = c(.1, .1)) +\n  geom_alluvium(curve_type = \"sigmoid\")+\n  geom_stratum(alpha = 1) +\n  geom_text(stat = \"stratum\", aes(label = after_stat(stratum))) +\n  theme(legend.position = \"none\") \n\np5_2\n\n\n\n\n\n\n\nFigureÂ 6: Changing Line Types",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Sankey Diagram"
    ]
  },
  {
    "objectID": "Proportion/Sankey.html#applications",
    "href": "Proportion/Sankey.html#applications",
    "title": "Sankey Diagram",
    "section": "Applications",
    "text": "Applications\n\n\n\n\n\n\nFigureÂ 7: Applications of sankey diagram\n\n\n\nIn ceRNA-related research, such as circRNA-miRNA-mRNA or lncRNA-miRNA-mRNA targeting relationship diagrams, they are generally presented using network diagrams. [1]",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Sankey Diagram"
    ]
  },
  {
    "objectID": "Proportion/Sankey.html#reference",
    "href": "Proportion/Sankey.html#reference",
    "title": "Sankey Diagram",
    "section": "Reference",
    "text": "Reference\n[1] Long J, Bai Y, Yang X, Lin J, Yang X, Wang D, He L, Zheng Y, Zhao H. Construction and comprehensive analysis of a ceRNA network to reveal potential prognostic biomarkers for hepatocellular carcinoma. Cancer Cell Int. 2019 Apr 11;19:90. doi: 10.1186/s12935-019-0817-y. PMID: 31007608; PMCID: PMC6458652.\n[2] The R Graph Gallery â€“ Help and inspiration for R charts (r-graph-gallery.com)\n[3] Gandrud, Christopher, et al.Â networkD3: D3 JavaScript Network Graphs from R. Version 0.4, 2017. https://CRAN.R-project.org/package=networkD3.\n[4] Wickham, H., & FranÃ§ois, R. (2016). dplyr: A Grammar of Data Manipulation [Computer software]. Retrieved from https://CRAN.R-project.org/package=dplyr\n[5] Wickham, H. (2009). ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York. https://ggplot2.tidyverse.org\n[6] Allaire, J. J., & Xie, Y. (2018). webshot: Save Web Content as an Image File [Computer software]. Retrieved from https://CRAN.R-project.org/package=webshot\n[7] Wickham, H., Averick, M., Bryan, J., Chang, W., McGowan, L. D., FranÃ§ois, R., â€¦ Yutani, H. (2019). tidyverse: Easily Install and Load the â€˜Tidyverseâ€™ (Version 1.2.1) [Computer software]. Retrieved from https://CRAN.R-project.org/package=tidyverse\n[8] Wickham, H., Averick, M., Bryan, J., Chang, W., McGowan, L. D., FranÃ§ois, R., â€¦ Yutani, H. (2019). tidyverse: Easily Install and Load the â€˜Tidyverseâ€™ (Version 1.2.1) [Computer software]. Retrieved from https://CRAN.R-project.org/package=tidyverse\n[9] Kassambara, W. (2020). ggsankey: Create Sankey Diagrams with â€˜ggplot2â€™ [Computer software]. Retrieved from https://CRAN.R-project.org/package=ggsankey\n[10] Brunson JC, Read QD. ggalluvial: Alluvial Plots in â€˜ggplot2â€™. R package version 0.12.5. 2023. https://CRAN.R-project.org/package=ggalluvial",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Sankey Diagram"
    ]
  },
  {
    "objectID": "Hiplot/168-streamgraph.html",
    "href": "Hiplot/168-streamgraph.html",
    "title": "Streamgraph",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Streamgraph plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/streamgraph?lang=en",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Streamgraph"
    ]
  },
  {
    "objectID": "Hiplot/168-streamgraph.html#setup",
    "href": "Hiplot/168-streamgraph.html#setup",
    "title": "Streamgraph",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; streamgraph\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"streamgraph\", quietly = TRUE)) {\n  remotes::install_github(\"hrbrmstr/streamgraph\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(streamgraph)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Streamgraph"
    ]
  },
  {
    "objectID": "Hiplot/168-streamgraph.html#data-preparation",
    "href": "Hiplot/168-streamgraph.html#data-preparation",
    "title": "Streamgraph",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/streamgraph/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# convert data structure\ncolnames(data) &lt;- c(\"date\",\"key\",\"value\")\n\n# View data\nhead(data)\n\n  date key  value\n1 1990   a 0.7688\n2 1990   b 0.5782\n3 1990   c 0.8164\n4 1990   d 0.4791\n5 1990   e 0.8793\n6 1990   f 0.4640",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Streamgraph"
    ]
  },
  {
    "objectID": "Hiplot/168-streamgraph.html#visualization",
    "href": "Hiplot/168-streamgraph.html#visualization",
    "title": "Streamgraph",
    "section": "Visualization",
    "text": "Visualization\n\n# Streamgraph\np &lt;- streamgraph(data, key = \"key\", value = \"value\", date = \"date\",\n                 offset = \"silhouette\", interpolate = \"cardinal\",\n                 interactive = F, scale = \"date\") %&gt;% \n  sg_fill_brewer(palette = \"Spectral\")\n\np\n\n\n\n\n\n\n\n\nFigureÂ 1: Streamgraph",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Streamgraph"
    ]
  },
  {
    "objectID": "Hiplot/066-ggdist.html",
    "href": "Hiplot/066-ggdist.html",
    "title": "Dist Plot",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Dist Plot plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/ggdist?lang=en\nThe dist plot is a visual diagram using a confidence distribution.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Dist Plot"
    ]
  },
  {
    "objectID": "Hiplot/066-ggdist.html#setup",
    "href": "Hiplot/066-ggdist.html#setup",
    "title": "Dist Plot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggdist; tidyr; broom; modelr; ggplot2\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggdist\", quietly = TRUE)) {\n  install.packages(\"ggdist\")\n}\nif (!requireNamespace(\"tidyr\", quietly = TRUE)) {\n  install.packages(\"tidyr\")\n}\nif (!requireNamespace(\"broom\", quietly = TRUE)) {\n  install.packages(\"broom\")\n}\nif (!requireNamespace(\"modelr\", quietly = TRUE)) {\n  install.packages(\"modelr\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggdist)\nlibrary(tidyr)\nlibrary(broom)\nlibrary(modelr)\nlibrary(ggplot2)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Dist Plot"
    ]
  },
  {
    "objectID": "Hiplot/066-ggdist.html#data-preparation",
    "href": "Hiplot/066-ggdist.html#data-preparation",
    "title": "Dist Plot",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data are five conditions and their corresponding values.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/ggdist/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\ndata[, 1] &lt;- factor(data[, 1], levels = rev(unique(data[, 1])))\ndata &lt;- tibble(data)\ndata2 = lm(response ~ condition, data = data)\ndata3 &lt;- data_grid(data, condition) %&gt;%\n  augment(data2, newdata = ., se_fit = TRUE)\n\n# View data\nhead(data)\n\n# A tibble: 6 Ã— 2\n  condition response\n  &lt;fct&gt;        &lt;dbl&gt;\n1 A           -0.420\n2 B            1.69 \n3 C            1.37 \n4 D            1.04 \n5 E           -0.144\n6 A           -0.301",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Dist Plot"
    ]
  },
  {
    "objectID": "Hiplot/066-ggdist.html#visualization",
    "href": "Hiplot/066-ggdist.html#visualization",
    "title": "Dist Plot",
    "section": "Visualization",
    "text": "Visualization\n\n# Dist Plot\np &lt;- ggplot(data3, aes_(y = as.name(colnames(data[1])))) +\n  stat_dist_halfeye(aes(dist = \"student_t\", arg1 = df.residual(data2),\n                        arg2 = .fitted, arg3 = .se.fit),\n                    scale = .5) +\n  geom_point(aes_(x = as.name(colnames(data[2]))),\n             data = data, pch = \"|\", size = 2,\n             position = position_nudge(y = -.15)) +\n  ggtitle(\"ggdist Plot\") + \n  xlab(\"response\") + ylab(\"condition\") +\n  theme_ggdist() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Dist Plot\n\n\n\n\n\nThe diagram shows the confidence distribution of the mean under the conditions, and the approximate distribution of the corresponding values under the five conditions can be seen.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Dist Plot"
    ]
  },
  {
    "objectID": "Hiplot/117-map-world2.html",
    "href": "Hiplot/117-map-world2.html",
    "title": "World Map 2",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot World Map 2 plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/map-world2?lang=en",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "World Map 2"
    ]
  },
  {
    "objectID": "Hiplot/117-map-world2.html#setup",
    "href": "Hiplot/117-map-world2.html#setup",
    "title": "World Map 2",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2; RColorBrewer\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(RColorBrewer)",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "World Map 2"
    ]
  },
  {
    "objectID": "Hiplot/117-map-world2.html#data-preparation",
    "href": "Hiplot/117-map-world2.html#data-preparation",
    "title": "World Map 2",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/map-world2/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\ndt_map &lt;- readRDS(url(\"https://download.hiplot.cn/ui/basic/map-world/world.rds\"))\n\n# Convert data structure\ndt_map$Value &lt;- data$death_rate[match(dt_map$ENG_NAME, data$region)]\n\n# View data\nhead(data)\n\n          region death_rate\n1    Afghanistan       13.4\n2        Albania        6.8\n3        Algeria        4.3\n4 American Samoa        5.9\n5        Andorra        7.3\n6         Angola        9.2",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "World Map 2"
    ]
  },
  {
    "objectID": "Hiplot/117-map-world2.html#visualization",
    "href": "Hiplot/117-map-world2.html#visualization",
    "title": "World Map 2",
    "section": "Visualization",
    "text": "Visualization\n\n# World Map 2\np &lt;- ggplot(dt_map) +\n  geom_polygon(aes(x = long, y = lat, group = group, fill = Value),\n               alpha = 0.9, size = 0.5) +\n  geom_path(aes(x = long, y = lat, group = group), color = \"black\", size = 0.2) +\n  coord_fixed() +\n  scale_fill_gradientn(\n    colours = colorRampPalette(rev(brewer.pal(11,\"RdYlBu\")))(500),\n    breaks = seq(round(min(dt_map$Value)), round(max(dt_map$Value)), \n                 round((max(dt_map$Value)-min(dt_map$Value))/7)),\n    name = \"Color Key\",\n    guide = guide_legend(\n      direction = \"vertical\", keyheight = unit(1, units = \"mm\"),\n      keywidth = unit(8, units = \"mm\"),\n      title.position = \"top\", title.hjust = 0.5, label.hjust = 0.5,\n      nrow = 1, byrow = T, reverse = F, label.position = \"bottom\")) +\n  theme(text = element_text(color = \"#3A3F4A\"),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank(),\n        legend.position = \"top\",\n        legend.text = element_text(size = 4 * 1.5, color = \"black\"),\n        legend.title = element_text(size = 5 * 1.5, color = \"black\"),\n        plot.title = element_text(\n          face = \"bold\", size = 5 * 1.5, hjust = 0.5, \n          margin = margin(t = 4, b = 5), color = \"black\"),\n        plot.background = element_rect(fill = \"#FFFFFF\", color = \"#FFFFFF\"),\n        panel.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        legend.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        plot.margin = unit(c(1.5, 1.5, 1.5, 1.5), \"cm\")) +\n  labs(x = NULL, y = NULL, title = \"World Map\")\n\np\n\n\n\n\n\n\n\nFigureÂ 1: World Map 2",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "World Map 2"
    ]
  },
  {
    "objectID": "Hiplot/164-simple-funnel-diagram.html",
    "href": "Hiplot/164-simple-funnel-diagram.html",
    "title": "Simple Funnel Diagram",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Simple Funnel Diagram plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/simple-funnel-diagram?lang=en",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Simple Funnel Diagram"
    ]
  },
  {
    "objectID": "Hiplot/164-simple-funnel-diagram.html#setup",
    "href": "Hiplot/164-simple-funnel-diagram.html#setup",
    "title": "Simple Funnel Diagram",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; magrittr; echarts4r\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"magrittr\", quietly = TRUE)) {\n  install.packages(\"magrittr\")\n}\nif (!requireNamespace(\"echarts4r\", quietly = TRUE)) {\n  install.packages(\"echarts4r\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(magrittr)\nlibrary(echarts4r)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Simple Funnel Diagram"
    ]
  },
  {
    "objectID": "Hiplot/164-simple-funnel-diagram.html#data-preparation",
    "href": "Hiplot/164-simple-funnel-diagram.html#data-preparation",
    "title": "Simple Funnel Diagram",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/simple-funnel-diagram/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# View data\nhead(data)\n\n       key value\n1     view    60\n2    click    30\n3 purchase    20",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Simple Funnel Diagram"
    ]
  },
  {
    "objectID": "Hiplot/164-simple-funnel-diagram.html#visualization",
    "href": "Hiplot/164-simple-funnel-diagram.html#visualization",
    "title": "Simple Funnel Diagram",
    "section": "Visualization",
    "text": "Visualization\n\n# Simple Funnel Diagram\np &lt;- data %&gt;%\n  e_charts() %&gt;%\n  e_funnel(value, key) %&gt;%\n  e_title(\"Funnel\") %&gt;%\n  e_theme(\"macarons\")\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Simple Funnel Diagram",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Simple Funnel Diagram"
    ]
  },
  {
    "objectID": "Hiplot/083-group-dumbbell.html",
    "href": "Hiplot/083-group-dumbbell.html",
    "title": "Group Dumbbell",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Group Dumbbell plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/group-dumbbell?lang=en",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Group Dumbbell"
    ]
  },
  {
    "objectID": "Hiplot/083-group-dumbbell.html#setup",
    "href": "Hiplot/083-group-dumbbell.html#setup",
    "title": "Group Dumbbell",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2; ggalt\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"ggalt\", quietly = TRUE)) {\n  remotes::install_github(\"hrbrmstr/ggalt\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(ggalt)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Group Dumbbell"
    ]
  },
  {
    "objectID": "Hiplot/083-group-dumbbell.html#data-preparation",
    "href": "Hiplot/083-group-dumbbell.html#data-preparation",
    "title": "Group Dumbbell",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/group-dumbbell/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\ndata &lt;- data[order(data[[\"group\"]], data[[\"y1952\"]]),]\ndata[[\"country\"]] &lt;- factor(data[[\"country\"]], levels = data[[\"country\"]])\n\n# View data\nhead(data)\n\n              country  y1952  y2007 group\n13              Haiti 37.579 60.916     A\n2             Bolivia 40.414 65.554     A\n12          Guatemala 42.023 70.259     A\n11        El Salvador 45.262 71.878     A\n9  Dominican Republic 45.928 72.235     A\n10            Ecuador 48.357 74.994     A",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Group Dumbbell"
    ]
  },
  {
    "objectID": "Hiplot/083-group-dumbbell.html#visualization",
    "href": "Hiplot/083-group-dumbbell.html#visualization",
    "title": "Group Dumbbell",
    "section": "Visualization",
    "text": "Visualization\n\n# Group Dumbbell\np &lt;- ggplot(data = data, aes(x = y1952, xend = y2007, y = country, color = group)) +\n  geom_dumbbell(size = 1, size_xend = 2, size_x = 2) +\n  theme_bw()\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Group Dumbbell",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Group Dumbbell"
    ]
  },
  {
    "objectID": "Hiplot/111-map-south-america.html",
    "href": "Hiplot/111-map-south-america.html",
    "title": "South America Map",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot South America Map plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/map-south-america?lang=en",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "South America Map"
    ]
  },
  {
    "objectID": "Hiplot/111-map-south-america.html#setup",
    "href": "Hiplot/111-map-south-america.html#setup",
    "title": "South America Map",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2; RColorBrewer\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(RColorBrewer)",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "South America Map"
    ]
  },
  {
    "objectID": "Hiplot/111-map-south-america.html#data-preparation",
    "href": "Hiplot/111-map-south-america.html#data-preparation",
    "title": "South America Map",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/map-south-america/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\ndt_map &lt;- readRDS(url(\"https://download.hiplot.cn/ui/basic/map-south-america/sa.rds\"))\n\n# Convert data structure\ndt_map$Value &lt;- data$value[match(dt_map$ENG_NAME, data$region)]\n\n# View data\nhead(data)\n\n     region value\n1 Argentina   198\n2   Bolivia   568\n3    Brazil   191\n4     Chile   275\n5  Colombia   901\n6   Ecuador   604",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "South America Map"
    ]
  },
  {
    "objectID": "Hiplot/111-map-south-america.html#visualization",
    "href": "Hiplot/111-map-south-america.html#visualization",
    "title": "South America Map",
    "section": "Visualization",
    "text": "Visualization\n\n# South America Map\np &lt;- ggplot(dt_map) +\n  geom_polygon(aes(x = long, y = lat, group = group, fill = Value),\n               alpha = 0.9, size = 0.5) +\n  geom_path(aes(x = long, y = lat, group = group), color = \"black\", size = 0.2) +\n  coord_fixed() +\n  scale_fill_gradientn(\n    colours = colorRampPalette(rev(brewer.pal(11,\"RdYlBu\")))(500),\n    breaks = seq(min(data$value), max(data$value), \n                 round((max(data$value)-min(data$value))/7)),\n    name = \"Color Key\",\n    guide = guide_legend(\n      direction = \"vertical\", keyheight = unit(1, units = \"mm\"),\n      keywidth = unit(8, units = \"mm\"),\n      title.position = \"top\", title.hjust = 0.5, label.hjust = 0.5,\n      nrow = 1, byrow = T, reverse = F, label.position = \"bottom\")) +\n  theme(text = element_text(color = \"#3A3F4A\"),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank(),\n        legend.position = \"top\",\n        legend.text = element_text(size = 4 * 1.5, color = \"black\"),\n        legend.title = element_text(size = 5 * 1.5, color = \"black\"),\n        plot.title = element_text(\n          face = \"bold\", size = 5 * 1.5, hjust = 0.5, \n          margin = margin(t = 4, b = 5), color = \"black\"),\n        plot.background = element_rect(fill = \"#FFFFFF\", color = \"#FFFFFF\"),\n        panel.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        legend.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        plot.margin = unit(c(1.5, 1.5, 1.5, 1.5), \"cm\")) +\n  labs(x = NULL, y = NULL, title = \"South America Map\")\n\np\n\n\n\n\n\n\n\nFigureÂ 1: South America Map",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "South America Map"
    ]
  },
  {
    "objectID": "Hiplot/020-chord.html",
    "href": "Hiplot/020-chord.html",
    "title": "Chord Plot",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Chord Plot plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/chord?lang=en\nThe complex interaction is visualized in the form of chord graph.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Chord Plot"
    ]
  },
  {
    "objectID": "Hiplot/020-chord.html#setup",
    "href": "Hiplot/020-chord.html#setup",
    "title": "Chord Plot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; circlize; ggplotify\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"circlize\", quietly = TRUE)) {\n  install.packages(\"circlize\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(circlize)\nlibrary(ggplotify)",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Chord Plot"
    ]
  },
  {
    "objectID": "Hiplot/020-chord.html#data-preparation",
    "href": "Hiplot/020-chord.html#data-preparation",
    "title": "Chord Plot",
    "section": "Data Preparation",
    "text": "Data Preparation\nData frame or matrix of interaction of genes with pathways or gene ontologys.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/chord/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# convert data structure\nrow.names(data) &lt;- data[, 1]\ndata &lt;- data[, -1]\ndata &lt;- as.matrix(data)\n\n# View data\nhead(data)\n\n   E1 E2 E3 E4 E5\nS1  4 16 12 18 11\nS2  7 11  2 15 10\nS3  9  2 17 16 11\nS4 14  9 12  3 17\nS5  1  1  7  1 12\nS6 10 18  9 13  9",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Chord Plot"
    ]
  },
  {
    "objectID": "Hiplot/020-chord.html#visualization",
    "href": "Hiplot/020-chord.html#visualization",
    "title": "Chord Plot",
    "section": "Visualization",
    "text": "Visualization\n\n# Chord Plot\nPalette &lt;- c(\"#E64B35FF\",\"#4DBBD5FF\",\"#00A087FF\",\"#3C5488FF\",\"#F39B7FFF\",\n             \"#8491B4FF\",\"#91D1C2FF\",\"#DC0000FF\",\"#7E6148FF\",\"#B09C85FF\")\ngrid.col &lt;- c(Palette, Palette, Palette[1:5])\np &lt;- as.ggplot(function() {\n  chordDiagram(\n    data, grid.col = grid.col, grid.border = NULL, transparency = 0.5,\n    row.col = NULL, column.col = NULL,  order = NULL,\n    directional = 0, # 1, -1, 0, 2\n    direction.type = \"diffHeight\", # diffHeight and arrows\n    diffHeight = convert_height(2, \"mm\"), reduce = 1e-5, xmax = NULL, \n    self.link = 2, symmetric = FALSE, keep.diagonal = FALSE, \n    preAllocateTracks = NULL,\n    annotationTrack = c(\"name\", \"grid\", \"axis\"),\n    annotationTrackHeight = convert_height(c(3, 3), \"mm\"),\n    link.border = NA, link.lwd = par(\"lwd\"), link.lty = par(\"lty\"), \n    link.sort = FALSE, link.decreasing = TRUE, link.largest.ontop = FALSE,\n    link.visible = T, link.rank = NULL, link.overlap = FALSE,\n    scale = F, group = NULL, big.gap = 10, small.gap = 1\n    )\n  })\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Chord Plot",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Chord Plot"
    ]
  },
  {
    "objectID": "Hiplot/006-barplot-errorbar2.html",
    "href": "Hiplot/006-barplot-errorbar2.html",
    "title": "Barplot (errorbar2)",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Barplot (errorbar2) plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/barplot-errorbar2?lang=en\nBar plot with error-lines and groups.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Barplot (errorbar2)"
    ]
  },
  {
    "objectID": "Hiplot/006-barplot-errorbar2.html#setup",
    "href": "Hiplot/006-barplot-errorbar2.html#setup",
    "title": "Barplot (errorbar2)",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2; grafify; ggpubr\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"grafify\", quietly = TRUE)) {\n  install.packages(\"grafify\")\n}\nif (!requireNamespace(\"ggpubr\", quietly = TRUE)) {\n  install.packages(\"ggpubr\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(grafify)\nlibrary(ggpubr)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Barplot (errorbar2)"
    ]
  },
  {
    "objectID": "Hiplot/006-barplot-errorbar2.html#data-preparation",
    "href": "Hiplot/006-barplot-errorbar2.html#data-preparation",
    "title": "Barplot (errorbar2)",
    "section": "Data Preparation",
    "text": "Data Preparation\nData frame:\n&lt;1st-col&gt;: (Numeric) values as Y-axis.\n&lt;2nd-col&gt;: (Numeric or String) classes as X-axis.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/barplot-errorbar2/data.json\")$exampleData[[1]]$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# convert data structure\ndata[, 2] &lt;- factor(data[, 2], levels = unique(data[, 2]))\n\n# View data\nhead(data)\n\n  score   class\n1    60    math\n2    62    math\n3    70 chinese\n4    73 chinese\n5    80 english\n6    85 english",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Barplot (errorbar2)"
    ]
  },
  {
    "objectID": "Hiplot/006-barplot-errorbar2.html#visualization",
    "href": "Hiplot/006-barplot-errorbar2.html#visualization",
    "title": "Barplot (errorbar2)",
    "section": "Visualization",
    "text": "Visualization\n\n# Barplot (errorbar2)\np &lt;- plot_scatterbar_sd(\n  data, ycol = get(colnames(data)[1]), xcol = get(colnames(data)[2]),\n  b_alpha = 1, ewid = 0.2, jitter = 0.1) +\n  stat_compare_means(data = data, aes(data[, 2], data[, 1], fill = data[, 2]),\n                     label = \"p.format\", ref.group = \".all.\", vjust = -2, \n                     method = \"t.test\") +\n  guides(fill=guide_legend(title=colnames(data)[2])) +\n  scale_y_continuous(expand = expansion(mult = c(0, 0.2))) +\n  labs(x=\"class\", y=\"score\") +\n  scale_fill_manual(values = c(\"#E64B35FF\",\"#4DBBD5FF\",\"#00A087FF\",\"#3C5488FF\")) +\n  theme_classic2() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Barplot (errorbar2)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Barplot (errorbar2)"
    ]
  },
  {
    "objectID": "Hiplot/155-risk-plot.html",
    "href": "Hiplot/155-risk-plot.html",
    "title": "Risk Factor Analysis",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Risk Factor Analysis plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/risk-plot?lang=en",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Risk Factor Analysis"
    ]
  },
  {
    "objectID": "Hiplot/155-risk-plot.html#setup",
    "href": "Hiplot/155-risk-plot.html#setup",
    "title": "Risk Factor Analysis",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; survminer; fastStat; cutoff; ggplot2; cowplot\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"survminer\", quietly = TRUE)) {\n  install.packages(\"survminer\")\n}\nif (!requireNamespace(\"fastStat\", quietly = TRUE)) {\n  remotes::install_github(\"yikeshu0611/fastStat\")\n}\nif (!requireNamespace(\"cutoff\", quietly = TRUE)) {\n  install.packages(\"cutoff\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"cowplot\", quietly = TRUE)) {\n  install.packages(\"cowplot\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(survminer)\nlibrary(fastStat)\nlibrary(cutoff)\nlibrary(ggplot2)\nlibrary(cowplot)",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Risk Factor Analysis"
    ]
  },
  {
    "objectID": "Hiplot/155-risk-plot.html#data-preparation",
    "href": "Hiplot/155-risk-plot.html#data-preparation",
    "title": "Risk Factor Analysis",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/risk-plot/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\ndata &lt;- data[order(data[, \"riskscore\"], decreasing = F), ]\ncutoff_point &lt;- median(x = data$riskscore, na.rm = TRUE)\ndata$Group &lt;- ifelse(data$riskscore &gt; cutoff_point, \"High\", \"Low\")\ncut.position &lt;- (1:nrow(data))[data$riskscore == cutoff_point]\nif (length(cut.position) == 0) {\n  cut.position &lt;- which.min(abs(data$riskscore - cutoff_point))\n} else if (length(cut.position) &gt; 1) {\n  cut.position &lt;- cut.position[length(cut.position)]\n}\n## Generate the data.frame required to draw A B graph\ndata2 &lt;- data[, c(\"time\", \"event\", \"riskscore\", \"Group\")]\n\n# View data\nhead(data)\n\n  time event riskscore    TAGLN2       PDPN     TIMP1      EMP3 Group\n1 1014     0 0.8206424 1.0612565 0.04879016 0.1484200 0.1906204   Low\n2  246     1 1.0582599 1.2584610 0.20701417 0.3506569 0.2546422   Low\n3 2283     0 1.1693457 1.2697605 0.00000000 0.2231436 0.3364722   Low\n4 1757     0 1.2274565 1.7209793 0.00000000 0.5822156 0.2231436   Low\n5 3107     1 1.2806984 0.5933268 0.37156356 0.1043600 0.5709795   Low\n6  332     1 1.2891095 1.2892326 0.09531018 0.2070142 0.3987761   Low",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Risk Factor Analysis"
    ]
  },
  {
    "objectID": "Hiplot/155-risk-plot.html#visualization",
    "href": "Hiplot/155-risk-plot.html#visualization",
    "title": "Risk Factor Analysis",
    "section": "Visualization",
    "text": "Visualization\n\n# Risk Factor Analysis\n## Figure A\nfA &lt;- ggplot(data = data2, aes(x = 1:nrow(data2), y = data2$riskscore, \n                               color = Group)) +\n  geom_point(size = 2) +\n  scale_color_manual(name = \"Risk Group\", \n                     values = c(\"Low\" = \"#0B45A5\", \"High\" = \"#E20B0B\")) +\n  geom_vline(xintercept = cut.position, linetype = \"dotted\", size = 1) +\n  theme(panel.grid = element_blank(), panel.background = element_blank(),\n        axis.ticks.x = element_blank(), axis.line.x = element_blank(),\n        axis.text.x = element_blank(), axis.title.x = element_blank(),\n        axis.title.y = element_text(size = 14, vjust = 1, angle = 90),\n        axis.text.y = element_text(size = 11),\n        axis.line.y = element_line(size = 0.5, colour = \"black\"),\n        axis.ticks.y = element_line(size = 0.5, colour = \"black\"),\n        legend.title = element_text(size = 13), \n        legend.text = element_text(size = 12)) +\n  coord_trans() +\n  ylab(\"Risk Score\") +\n  scale_x_continuous(expand = c(0, 3))\n## Figure B\nfB &lt;- ggplot(data = data2, aes(x = 1:nrow(data2), y = data2[, \"time\"],\n             color = factor(ifelse(data2[, \"event\"] == 1, \"Dead\", \"Alive\")))) +\n  geom_point(size = 2) +\n  scale_color_manual(name = \"Status\", values = c(\"Alive\" = \"#0B45A5\", \"Dead\" = \"#E20B0B\")) +\n  geom_vline(xintercept = cut.position, linetype = \"dotted\", size = 1) +\n  theme(panel.grid = element_blank(), panel.background = element_blank(),\n        axis.ticks.x = element_blank(), axis.line.x = element_blank(),\n        axis.text.x = element_blank(), axis.title.x = element_blank(),\n        axis.title.y = element_text(size = 14, vjust = 2, angle = 90),\n        axis.text.y = element_text(size = 11),\n        axis.ticks.y = element_line(size = 0.5),\n        axis.line.y = element_line(size = 0.5, colour = \"black\"),\n        legend.title = element_text(size = 13),\n        legend.text = element_text(size = 12)) +\n  ylab(\"Survival Time\") +\n  coord_trans() +\n  scale_x_continuous(expand = c(0, 3))\n## middle\nmiddle &lt;- ggplot(data2, aes(x = 1:nrow(data2), y = 1)) +\n  geom_tile(aes(fill = data2$Group)) +\n  scale_fill_manual(name = \"Risk Group\", values = c(\"Low\" = \"#0B45A5\", \"High\" = \"#E20B0B\")) +\n  theme(panel.grid = element_blank(), panel.background = element_blank(),\n        axis.line = element_blank(), axis.ticks = element_blank(),\n        axis.text = element_blank(), axis.title = element_blank(),\n        plot.margin = unit(c(0.15, 0, -0.3, 0), \"cm\"),\n        legend.title = element_text(size = 13),\n        legend.text = element_text(size = 12)) +\n  scale_x_continuous(expand = c(0, 3)) +\n  xlab(\"\")\n## Figure C\nheatmap_genes &lt;- c(\"TAGLN2\", \"PDPN\", \"TIMP1\", \"EMP3\")\ndata3 &lt;- data[, heatmap_genes]\nif (length(heatmap_genes) == 1) {\n  data3 &lt;- data.frame(data3)\n  colnames(data3) &lt;- heatmap_genes\n}\n# Normalization\nfor (i in 1:ncol(data3)) {\n  data3[, i] &lt;- (data3[, i] - mean(data3[, i], na.rm = TRUE)) /\n  sd(data3[, i], na.rm = TRUE)\n}\ndata4 &lt;- cbind(id = 1:nrow(data3), data3)\ndata5 &lt;- reshape2::melt(data4, id.vars = \"id\")\nfC &lt;- ggplot(data5, aes(x = id, y = variable, fill = value)) +\n  geom_raster() +\n  theme(panel.grid = element_blank(), panel.background = element_blank(),\n        axis.line = element_blank(), axis.ticks = element_blank(),\n        axis.text.x = element_blank(), axis.title = element_blank(),\n        plot.background = element_blank()) +\n  scale_fill_gradient2(name = \"Expression\", low = \"#0B45A5\", mid = \"#FFFFFF\",\n                       high = \"#E20B0B\") +\n  theme(axis.text = element_text(size = 11)) +\n  theme(legend.title = element_text(size = 13), \n        legend.text = element_text(size = 12)) +\n  scale_x_continuous(expand = c(0, 3))\n\np &lt;- plot_grid(fA, fB, middle, fC, ncol = 1, rel_heights = c(0.1, 0.1, 0.01, 0.15))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Risk Factor Analysis",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Risk Factor Analysis"
    ]
  },
  {
    "objectID": "Hiplot/139-pie-group.html",
    "href": "Hiplot/139-pie-group.html",
    "title": "Pie Group",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Pie Group plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/pie-group?lang=en",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pie Group"
    ]
  },
  {
    "objectID": "Hiplot/139-pie-group.html#setup",
    "href": "Hiplot/139-pie-group.html#setup",
    "title": "Pie Group",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; patchwork; ggplotify; cowplot\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"patchwork\", quietly = TRUE)) {\n  install.packages(\"patchwork\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\nif (!requireNamespace(\"cowplot\", quietly = TRUE)) {\n  install.packages(\"cowplot\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(patchwork)\nlibrary(ggplotify)\nlibrary(cowplot)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pie Group"
    ]
  },
  {
    "objectID": "Hiplot/139-pie-group.html#data-preparation",
    "href": "Hiplot/139-pie-group.html#data-preparation",
    "title": "Pie Group",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/pie-group/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\ndata[,\"genre\"] &lt;- factor(data[,\"genre\"], levels = unique(data[,\"genre\"]))\ndata[,\"mpaa\"] &lt;- factor(data[,\"mpaa\"], levels = unique(data[,\"mpaa\"]))\n\n# View data\nhead(data)\n\n                                               title year length budget rating\n1                          Shawshank Redemption, The 1994    142     25    9.1\n2     Lord of the Rings: The Return of the King, The 2003    251     94    9.0\n3 Lord of the Rings: The Fellowship of the Ring, The 2001    208     93    8.8\n4             Lord of the Rings: The Two Towers, The 2002    223     94    8.8\n5                                       Pulp Fiction 1994    168      8    8.8\n6                                   Schindler's List 1993    195     25    8.8\n   votes  mpaa  genre\n1 149494     R  Drama\n2 103631 PG-13 Action\n3 157608 PG-13 Action\n4 114797 PG-13 Action\n5 132745     R  Drama\n6  97667     R  Drama",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pie Group"
    ]
  },
  {
    "objectID": "Hiplot/139-pie-group.html#visualization",
    "href": "Hiplot/139-pie-group.html#visualization",
    "title": "Pie Group",
    "section": "Visualization",
    "text": "Visualization\n\n# Pie Group\ncol &lt;- c(\"#E64B35FF\",\"#4DBBD5FF\",\"#00A087FF\",\"#3C5488FF\",\"#F39B7FFF\",\"#8491B4FF\",\n         \"#91D1C2FF\",\"#DC0000FF\",\"#7E6148FF\",\"#B09C85FF\")\nplist &lt;- list()\nfor (i in 1:length(unique(data[,\"mpaa\"]))) {\n  data_tmp &lt;- data[data[,\"mpaa\"] == unique(data[,\"mpaa\"])[i],]\n  x &lt;- table(data_tmp[,\"genre\"])\n  ptmp &lt;- as.ggplot(function(){\n    par(oma=c(0,0,0,0))\n    pie(x,\n      labels = sprintf(\"%s\\n(n=%s, %s%%)\", names(x), x,\n        round(x / sum(x) * 100, 0)),\n      col = col,\n      main = paste0(\"mpaa\", \":\", unique(data[,\"mpaa\"])[i]),\n      edges = 200,\n      radius = 0.8,\n      clockwise = F\n    )\n  })\n  plist[[i]] &lt;- ptmp\n}\n\nplot_grid(plotlist = plist, ncol = 2)\n\n\n\n\n\n\n\nFigureÂ 1: Pie Group",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pie Group"
    ]
  },
  {
    "objectID": "Hiplot/136-pcatools.html",
    "href": "Hiplot/136-pcatools.html",
    "title": "PCAtools",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot PCAtools plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/pcatools?lang=en\nPCAtools can reduce the dimensionality of data through principal component analysis, and view principal component related features at a two-dimensional level",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "PCAtools"
    ]
  },
  {
    "objectID": "Hiplot/136-pcatools.html#setup",
    "href": "Hiplot/136-pcatools.html#setup",
    "title": "PCAtools",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; PCAtools; ggplotify; cowplot\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"PCAtools\", quietly = TRUE)) {\n  install.packages('PCAtools', repos = c('https://bioc.r-universe.dev', 'https://cloud.r-project.org'))\n\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\nif (!requireNamespace(\"cowplot\", quietly = TRUE)) {\n  install.packages(\"cowplot\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(PCAtools)\nlibrary(ggplotify)\nlibrary(cowplot)",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "PCAtools"
    ]
  },
  {
    "objectID": "Hiplot/136-pcatools.html#data-preparation",
    "href": "Hiplot/136-pcatools.html#data-preparation",
    "title": "PCAtools",
    "section": "Data Preparation",
    "text": "Data Preparation\n\nData table 1 (numerical matrix):\n\nEach column is a sample, and each row is a feature (such as gene, chip probe).\n\nData sheet 2 (sample information):\n\nThe first column is the sample, and the other columns are the phenotypic characteristics of the sample, which can be used to mark the color and shape of the point and perform correlation analysis with the principal component.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/pcatools/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\ndata2 &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/pcatools/data.json\")$exampleData$textarea[[2]])\ndata2 &lt;- as.data.frame(data2)\n\n# View data\nhead(data[,1:5])\n\n       Probes GSM65752 GSM65753 GSM65755 GSM65757\n1   220050_at 6.566843 5.902831 5.185271 5.474453\n2 213944_x_at 8.722271 9.088407 9.106401 8.900869\n3   215441_at 3.812778 3.852745 3.846690 3.842543\n4 214792_x_at 6.499815 6.731196 5.951202 6.578830\n5 217251_x_at 6.607354 6.555413 6.715821 6.628053\n6   207406_at 3.997302 3.964112 3.836560 3.833057\n\nhead(data2[,1:5])\n\n  Samplename    Study Age Distant.RFS  ER\n1   GSM65752 GSE47561  40           0 ER-\n2   GSM65753 GSE47561  46           0 ER+\n3   GSM65755 GSE47561  41           1 ER+\n4   GSM65757 GSE47561  34           0 ER+\n5   GSM65758 GSE47561  46           1 ER+\n6   GSM65760 GSE47561  57           1 ER+",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "PCAtools"
    ]
  },
  {
    "objectID": "Hiplot/136-pcatools.html#visualization",
    "href": "Hiplot/136-pcatools.html#visualization",
    "title": "PCAtools",
    "section": "Visualization",
    "text": "Visualization\n\n# PCAtools\n## Define the plot function\ncall_pcatools &lt;- function(datTable, sampleInfo,\n                          top_var,\n                          screeplotComponents, screeplotColBar,\n                          pairsplotComponents,\n                          biplotShapeBy, biplotColBy,\n                          plotloadingsComponents,\n                          plotloadingsLowCol,\n                          plotloadingsMidCol,\n                          plotloadingsHighCol,\n                          eigencorplotMetavars,\n                          eigencorplotComponents) {\n  row.names(datTable) &lt;- datTable[, 1]\n  datTable &lt;- datTable[, -1]\n  row.names(sampleInfo) &lt;- sampleInfo[, 1]\n  data3 &lt;&lt;- pca(datTable, metadata = sampleInfo, removeVar = (100 - top_var) / 100)\n\n  for (i in c(\"screeplotComponents\", \"pairsplotComponents\",\n              \"plotloadingsComponents\", \"eigencorplotComponents\")) {\n    if (ncol(data3$rotated) &lt; get(i)) {\n      assign(i, ncol(data3$rotated))\n    }\n  }\n\n  p1 &lt;- PCAtools::screeplot(\n    data3,\n    components = getComponents(data3, 1:screeplotComponents),\n    axisLabSize = 14, titleLabSize = 20,\n    colBar = screeplotColBar,\n    gridlines.major = FALSE, gridlines.minor = FALSE,\n    returnPlot = TRUE\n  )\n\n  params_pairsplot &lt;- list(\n    data3,\n    components = getComponents(data3, c(1:pairsplotComponents)),\n    triangle = TRUE, trianglelabSize = 12,\n    hline = 0, vline = 0,\n    pointSize = 0.8, gridlines.major = FALSE, gridlines.minor = FALSE,\n    title = \"\", plotaxes = FALSE,\n    margingaps = unit(c(0.01, 0.01, 0.01, 0.01), \"cm\"),\n    returnPlot = TRUE,\n    colkey = c(\"#00468BFF\",\"#ED0000FF\"),\n    legendPosition = \"none\"\n  )\n  params_biplot &lt;- list(data3,\n    showLoadings = TRUE,\n    lengthLoadingsArrowsFactor = 1.5,\n    sizeLoadingsNames = 4,\n    colLoadingsNames = \"red4\",\n    # other parameters\n    lab = NULL,\n    hline = 0, vline = c(-25, 0, 25),\n    vlineType = c(\"dotdash\", \"solid\", \"dashed\"),\n    gridlines.major = FALSE, gridlines.minor = FALSE,\n    pointSize = 5,\n    legendLabSize = 16, legendIconSize = 8.0,\n    drawConnectors = FALSE,\n    title = \"PCA bi-plot\",\n    subtitle = \"PC1 versus PC2\",\n    caption = \"27 PCs â‰ˆ 80%\",\n    returnPlot = TRUE,\n    legendPosition = \"bottom\"\n  )\n  if (!is.null(biplotShapeBy) && biplotShapeBy != \"\") {\n    params_biplot$shape &lt;- biplotShapeBy\n    params_pairsplot$shape &lt;- biplotShapeBy\n    t &lt;- params_biplot[[1]]$metadata[,biplotShapeBy]\n    params_biplot[[1]]$metadata[,biplotShapeBy] &lt;- factor(t,\n      levels = t[!duplicated(t)]\n    )\n    params_pairsplot[[1]]$metadata[,biplotShapeBy] &lt;- factor(t,\n      levels = t[!duplicated(t)]\n    )\n  }\n  if (!is.null(biplotColBy) && biplotColBy != \"\") {\n    params_pairsplot$colby &lt;- biplotColBy\n    params_pairsplot$colkey &lt;- c(\"#00468BFF\",\"#ED0000FF\")\n    params_biplot$colby &lt;- biplotColBy\n    params_biplot$colkey &lt;- c(\"#00468BFF\",\"#ED0000FF\")\n    t1 &lt;- params_biplot[[1]]$metadata[,biplotColBy]\n    params_biplot[[1]]$metadata[,biplotColBy] &lt;- factor(t1,\n      levels = t1[!duplicated(t1)]\n    )\n    params_pairsplot[[1]]$metadata[,biplotColBy] &lt;- factor(t1,\n      levels = t1[!duplicated(t1)]\n    )\n  }\n\n  p2 &lt;- do.call(PCAtools::pairsplot, params_pairsplot)\n  p3 &lt;- do.call(PCAtools::biplot, params_biplot)\n\n  p4 &lt;- PCAtools::plotloadings(\n    data3,\n    rangeRetain = 0.01, labSize = 4,\n    components = getComponents(data3, c(1:plotloadingsComponents)),\n    title = \"Loadings plot\", axisLabSize = 12,\n    subtitle = \"PC1, PC2, PC3, PC4, PC5\",\n    caption = \"Top 1% variables\",\n    gridlines.major = FALSE, gridlines.minor = FALSE,\n    shape = 24, shapeSizeRange = c(4, 8),\n    col = c(plotloadingsLowCol, plotloadingsMidCol, plotloadingsHighCol),\n    legendPosition = \"none\",\n    drawConnectors = FALSE,\n    returnPlot = TRUE\n  )\n\n  if (length(eigencorplotMetavars) &gt; 0 && all(eigencorplotMetavars != \"\")) {\n    metavars &lt;- eigencorplotMetavars\n  } else {\n    metavars &lt;- colnames(sampleInfo)[2:ncol(sampleInfo)]\n  }\n  if (length(metavars) == 1 && metavars != colnames(sampleInfo)[1]) {\n    metavars &lt;- c(colnames(sampleInfo)[1], metavars)\n  } else if (length(metavars) == 1 && metavars == colnames(sampleInfo)[1]) {\n    stop('eigencorplotMetavars need &gt;= 2 feature')\n  }\n\n  p5 &lt;- PCAtools::eigencorplot(\n    data3,\n    components = getComponents(data3, 1:eigencorplotComponents),\n    metavars = metavars,\n    cexCorval = 1.0,\n    fontCorval = 2,\n    posLab = \"all\",\n    rotLabX = 45,\n    scale = TRUE,\n    main = \"PC clinical correlates\",\n    cexMain = 1.5,\n    plotRsquared = FALSE,\n    corFUN = \"pearson\",\n    corUSE = \"na.or.complete\",\n    signifSymbols = c(\"****\", \"***\", \"**\", \"*\", \"\"),\n    signifCutpoints = c(0, 0.0001, 0.001, 0.01, 0.05, 1),\n    returnPlot = TRUE\n  )\n\n  p6 &lt;- plot_grid(\n    p1, p2, p3,\n    ncol = 3,\n    labels = c(\"A\", \"B  Pairs plot\", \"C\"),\n    label_fontfamily = \"Arial\",\n    label_fontface = \"bold\",\n    label_size = 22,\n    align = \"h\",\n    rel_widths = c(1.10, 0.80, 1.10)\n  )\n\n  p7 &lt;- plot_grid(\n    p4,\n    as.grob(p5),\n    ncol = 2,\n    labels = c(\"D\", \"E\"),\n    label_fontfamily = \"Arial\",\n    label_fontface = \"bold\",\n    label_size = 22,\n    align = \"h\",\n    rel_widths = c(0.8, 1.2)\n  )\n\n  p &lt;- plot_grid(\n    p6, p7,\n    ncol = 1,\n    rel_heights = c(1.1, 0.9)\n  )\n\n  return(p)\n}\n\n## plot\np &lt;- call_pcatools(\n  datTable = data,\n  sampleInfo = data2,\n  biplotColBy = \"ER\",\n  biplotShapeBy = \"Grade\",\n  eigencorplotMetavars = colnames(data2)[-1],\n  screeplotComponents = 30,\n  pairsplotComponents = 3,\n  plotloadingsComponents = 5,\n  eigencorplotComponents = 10,\n  top_var = 90,\n  screeplotColBar = \"#0085FF\",\n  plotloadingsLowCol = \"#0085FF\",\n  plotloadingsMidCol = \"#FFFFFF\",\n  plotloadingsHighCol = \"#FF0000\"\n)\n\np\n\n\n\n\n\n\n\nFigureÂ 1: PCAtools",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "PCAtools"
    ]
  },
  {
    "objectID": "Hiplot/153-ribbon.html",
    "href": "Hiplot/153-ribbon.html",
    "title": "Ribbon",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Ribbon plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/ribbon?lang=en\nThe ribbon diagram is a pattern similar to a ribbon.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Ribbon"
    ]
  },
  {
    "objectID": "Hiplot/153-ribbon.html#setup",
    "href": "Hiplot/153-ribbon.html#setup",
    "title": "Ribbon",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2; ggthemes\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"ggthemes\", quietly = TRUE)) {\n  install.packages(\"ggthemes\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(ggthemes)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Ribbon"
    ]
  },
  {
    "objectID": "Hiplot/153-ribbon.html#data-preparation",
    "href": "Hiplot/153-ribbon.html#data-preparation",
    "title": "Ribbon",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data are the X-axis values and their corresponding Y-axis values and groups.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/ribbon/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\ncolnames(data) &lt;- c(\"group\", \"xvalue\", \"yvalue1\", \"yvalue2\")\ndata$yvalue &lt;- (data$yvalue1 + data$yvalue2) / 2\n\n# View data\nhead(data)\n\n   group xvalue yvalue1 yvalue2 yvalue\n1 Group1   1900  -0.279  -0.063 -0.171\n2 Group1   1901  -0.271  -0.053 -0.162\n3 Group1   1902  -0.285  -0.069 -0.177\n4 Group1   1903  -0.303  -0.095 -0.199\n5 Group1   1904  -0.328  -0.118 -0.223\n6 Group1   1905  -0.348  -0.134 -0.241",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Ribbon"
    ]
  },
  {
    "objectID": "Hiplot/153-ribbon.html#visualization",
    "href": "Hiplot/153-ribbon.html#visualization",
    "title": "Ribbon",
    "section": "Visualization",
    "text": "Visualization\n\n# Ribbon\np &lt;- ggplot(data, aes(xvalue, yvalue, fill = group)) +\n  geom_ribbon(alpha = 0.2, aes(ymin = yvalue1, ymax = yvalue2)) +\n  geom_line(aes(y = yvalue, color = group), lwd = 1) +\n  geom_line(aes(y = yvalue1, color = group), linetype = \"dotted\") +\n  geom_line(aes(y = yvalue2, color = group), linetype = \"dotted\") +\n  ylab(\"y axis value\") +\n  xlab(\"x axis value\") +\n  ggtitle(\"Ribbon Plot\") +\n  scale_fill_manual(values = c(\"#e04d39\",\"#5bbad6\")) +\n  scale_color_manual(values = c(\"#e04d39\",\"#5bbad6\")) +\n  theme_stata() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n \np\n\n\n\n\n\n\n\nFigureÂ 1: Ribbon\n\n\n\n\n\nEach color represents a different grouping, through which broken lines can be seen the change of each group of data over time.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Ribbon"
    ]
  },
  {
    "objectID": "Hiplot/041-deviation-plot.html",
    "href": "Hiplot/041-deviation-plot.html",
    "title": "Deviation Plot",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Deviation Plot plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/deviation-plot?lang=en\nDeviation plot provides a visual representation of the differences between data points.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Deviation Plot"
    ]
  },
  {
    "objectID": "Hiplot/041-deviation-plot.html#setup",
    "href": "Hiplot/041-deviation-plot.html#setup",
    "title": "Deviation Plot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggpubr\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggpubr\", quietly = TRUE)) {\n  install.packages(\"ggpubr\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggpubr)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Deviation Plot"
    ]
  },
  {
    "objectID": "Hiplot/041-deviation-plot.html#data-preparation",
    "href": "Hiplot/041-deviation-plot.html#data-preparation",
    "title": "Deviation Plot",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/deviation-plot/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# convert data structure\ndata[[\"z_score\"]] &lt;- (data[[\"mpg\"]] - mean(data[[\"mpg\"]])) / sd(data[[\"mpg\"]])\ndata[[\"Group\"]] &lt;- factor(ifelse(data[[\"z_score\"]] &lt; 0, \"low\", \"high\"),\n                          levels = c(\"low\", \"high\")\n                          )\n\n# View data\nhead(data)\n\n   mpg cyl disp  hp drat    wt  qsec vs am gear carb              name\n1 21.0   6  160 110 3.90 2.620 16.46  0  1    4    4         Mazda RX4\n2 21.0   6  160 110 3.90 2.875 17.02  0  1    4    4     Mazda RX4 Wag\n3 22.8   4  108  93 3.85 2.320 18.61  1  1    4    1        Datsun 710\n4 21.4   6  258 110 3.08 3.215 19.44  1  0    3    1    Hornet 4 Drive\n5 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2 Hornet Sportabout\n6 18.1   6  225 105 2.76 3.460 20.22  1  0    3    1           Valiant\n     z_score Group\n1  0.1508848  high\n2  0.1508848  high\n3  0.4495434  high\n4  0.2172534  high\n5 -0.2307345   low\n6 -0.3302874   low",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Deviation Plot"
    ]
  },
  {
    "objectID": "Hiplot/041-deviation-plot.html#visualization",
    "href": "Hiplot/041-deviation-plot.html#visualization",
    "title": "Deviation Plot",
    "section": "Visualization",
    "text": "Visualization\n\n# Deviation Plot\np &lt;- ggbarplot(data,\n    x = \"name\",\n    y = \"z_score\",\n    fill = \"Group\",\n    color = \"white\",\n    sort.val = \"desc\",\n    sort.by.groups = FALSE,\n    x.text.angle = 90,\n    xlab = \"name\",\n    ylab = \"mpg\",\n    rotate = TRUE\n  ) +\n  scale_fill_manual(values = c(\"#e04d39\",\"#5bbad6\")) +\n  theme_bw() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Deviation Plot",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Deviation Plot"
    ]
  },
  {
    "objectID": "Hiplot/028-contour-xy.html",
    "href": "Hiplot/028-contour-xy.html",
    "title": "Contour (XY)",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Contour (XY) plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/contour-xy?lang=en\nContour plot (XY) is a data processing method that reflects data density through contour line.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Contour (XY)"
    ]
  },
  {
    "objectID": "Hiplot/028-contour-xy.html#setup",
    "href": "Hiplot/028-contour-xy.html#setup",
    "title": "Contour (XY)",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2; ggisoband\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"ggisoband\", quietly = TRUE)) {\n  remotes::install_github(\"clauswilke/ggisoband\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(ggisoband)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Contour (XY)"
    ]
  },
  {
    "objectID": "Hiplot/028-contour-xy.html#data-preparation",
    "href": "Hiplot/028-contour-xy.html#data-preparation",
    "title": "Contour (XY)",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data are two variables.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/contour-xy/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# convert data structure\ncolnames(data) &lt;- c(\"xvalue\", \"yvalue\")\n\n# View data\nhead(data)\n\n  xvalue yvalue\n1  2.620    110\n2  2.875    110\n3  2.320     93\n4  3.215    110\n5  3.440    175\n6  3.460    105",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Contour (XY)"
    ]
  },
  {
    "objectID": "Hiplot/028-contour-xy.html#visualization",
    "href": "Hiplot/028-contour-xy.html#visualization",
    "title": "Contour (XY)",
    "section": "Visualization",
    "text": "Visualization\n\n# Contour (XY)\np &lt;- ggplot(data, aes(xvalue, yvalue)) +\n  geom_density_bands(\n    alpha = 1,\n    aes(fill = stat(density)), color = \"gray40\", size = 0.2\n    ) +\n  geom_point(alpha = 1, shape = 21, fill = \"white\") +\n  scale_fill_viridis_c(guide = \"legend\") +\n  ylab(\"value2\") +\n  xlab(\"value1\") +\n  ggtitle(\"Contour-XY Plot\") +\n  theme_bw() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Contour (XY)\n\n\n\n\n\nJust as contour lines in geography represent different heights, different contour lines in contour maps represent different densities. The closer to the center, the smaller contour loop is, and the higher the regional data density is. For example, the data density of yellow area is the highest, while that of blue area is the lowest.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Contour (XY)"
    ]
  },
  {
    "objectID": "Hiplot/178-venn.html",
    "href": "Hiplot/178-venn.html",
    "title": "Venn",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Venn plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/venn?lang=en\nA Venn diagram is a diagramthat shows all possible logical relations between a finite collection of different sets. These diagrams depict elements as points in the plane, and sets as regions inside closed curves. A Venn diagram consists of multiple overlapping closed curves, usually circles, each representing a set. The points inside a curve labelled S represent elements of the set S, while points outside the boundary represent elements not in the set S. This lends to easily read visualizations; for example, the set of all elements that are members of both sets Sand T, S âˆ© T, is represented visually by the area of overlap of the regions S and T. In Venn diagrams the curves are overlapped in every possible way, showing all possible relations between the sets.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Venn"
    ]
  },
  {
    "objectID": "Hiplot/178-venn.html#setup",
    "href": "Hiplot/178-venn.html#setup",
    "title": "Venn",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; VennDiagram; grDevices\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"VennDiagram\", quietly = TRUE)) {\n  install.packages(\"VennDiagram\")\n}\nif (!requireNamespace(\"grDevices\", quietly = TRUE)) {\n  install.packages(\"grDevices\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(VennDiagram)\nlibrary(grDevices)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Venn"
    ]
  },
  {
    "objectID": "Hiplot/178-venn.html#data-preparation",
    "href": "Hiplot/178-venn.html#data-preparation",
    "title": "Venn",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data is a collection of five gene names.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/venn/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# convert data structure\nfor (i in seq_len(ncol(data))) {\n  data[is.na(data[, i]), i] &lt;- \"\"\n}\nraw &lt;- data\ndata &lt;- as.data.frame(raw[raw[, 1] != \"\", 1])\ncolnames(data) &lt;- colnames(raw)[1]\nlist.num &lt;- 1\nfor (i in 2:ncol(raw)) {\n  if (any(!is.na(raw[, i]) & raw[, i] != \"\")) {\n    tmp &lt;- raw[i]\n    tmp &lt;- tmp[tmp[, 1] != \"\", ]\n    tmp &lt;- as.data.frame(tmp)\n    colnames(tmp) &lt;- colnames(raw)[i]\n    assign(paste0(\"data\", i), tmp)\n    list.num &lt;- list.num + 1\n  }\n}\ncolnames(data) &lt;- paste(\"V\", seq_len(ncol(data)), sep = \"\")\ncolnames(data2) &lt;- paste(\"V\", seq_len(ncol(data2)), sep = \"\")\ncolnames(data3) &lt;- paste(\"V\", seq_len(ncol(data3)), sep = \"\")\ncolnames(data4) &lt;- paste(\"V\", seq_len(ncol(data4)), sep = \"\")\ncolnames(data5) &lt;- paste(\"V\", seq_len(ncol(data5)), sep = \"\")\ndata_list &lt;- list(\n  n1 = data$V1, n2 = data2$V1, n3 = data3$V1,\n  n4 = data4$V1, n5 = data5$V1\n)\nnames(data_list) &lt;- colnames(raw)[1:5]\n\n# View data\nhead(data)\n\n       V1\n1   ISG15\n2  TTLL10\n3    HES4\n4  OR4G4P\n5 MND2P28\n6  FAM87B",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Venn"
    ]
  },
  {
    "objectID": "Hiplot/178-venn.html#visualization",
    "href": "Hiplot/178-venn.html#visualization",
    "title": "Venn",
    "section": "Visualization",
    "text": "Visualization\n\n# Venn\ncol &lt;- c(\"#E64B35FF\",\"#4DBBD5FF\",\"#00A087FF\",\"#3C5488FF\",\"#F39B7FFF\")\np &lt;- venn.diagram(\n  data_list, scaled = F, euler.d = F, filename = NULL, col = \"black\",\n  fill = col,\n  cex = c(\n    1.5, 1.5, 1.5, 1.5, 1.5, 1, 0.8, 1, 0.8, 1, 0.8, 1, 0.8,\n    1, 0.8, 1, 0.55, 1, 0.55, 1, 0.55, 1, 0.55, 1, 0.55, 1, 1, 1, 1, 1, 1.5\n  ),\n  cat.col = col, cat.cex = 1,\n  main.fontfamily = \"Arial\", fontfamily = \"Arial\", cat.fontface = \"bold\",\n  cat.fontfamily = \"Arial\", margin = 0.1, main = \"Vene Plot\", alpha = 0.8\n);grid::grid.draw(p)\n\n\n\n\n\n\n\nFigureÂ 1: Venn\n\n\n\n\n\nThe closed curve of 5 colors represents 5 sets, and the number represents the number of overlapping or non-overlapping genes in multiple sets. For example, 8 in the sample figure represents 8 identical gene names in 5 sample sets.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Venn"
    ]
  },
  {
    "objectID": "Hiplot/078-gobubble.html",
    "href": "Hiplot/078-gobubble.html",
    "title": "GOBubble Plot",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot GOBubble Plot plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/gobubble?lang=en\nThe gobubble plot is used to display Z-score coloured bubble plot of terms ordered alternatively by z-score or the negative logarithm of the adjusted p-value.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "GOBubble Plot"
    ]
  },
  {
    "objectID": "Hiplot/078-gobubble.html#setup",
    "href": "Hiplot/078-gobubble.html#setup",
    "title": "GOBubble Plot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; GOplot; ggplotify\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"GOplot\", quietly = TRUE)) {\n  install.packages(\"GOplot\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(GOplot)\nlibrary(ggplotify)",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "GOBubble Plot"
    ]
  },
  {
    "objectID": "Hiplot/078-gobubble.html#data-preparation",
    "href": "Hiplot/078-gobubble.html#data-preparation",
    "title": "GOBubble Plot",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data are the results of GO enrichment with seven columns: category, GO id, GO term, gene count, gene name, logFC, adjust pvalue and zscore.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/gobubble/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\ncolnames(data) &lt;- c(\"category\",\"ID\",\"term\",\"count\",\"genes\",\"logFC\",\"adj_pval\",\"zscore\")\ndata &lt;- data[data$category %in% c(\"BP\",\"CC\",\"MF\"),]\ndata &lt;- data[!is.na(data$adj_pval),]\ndata$adj_pval &lt;- as.numeric(data$adj_pval)\ndata$zscore &lt;- as.numeric(data$zscore)\n\n# View data\nhead(data)\n\n  category         ID              term count  genes      logFC adj_pval\n1       BP GO:0007507 heart development    54   DLC1 -0.9707875 2.17e-06\n2       BP GO:0007507 heart development    54   NRP2 -1.5153173 2.17e-06\n3       BP GO:0007507 heart development    54   NRP1 -1.1412315 2.17e-06\n4       BP GO:0007507 heart development    54   EDN1  1.3813006 2.17e-06\n5       BP GO:0007507 heart development    54 PDLIM3 -0.8876939 2.17e-06\n6       BP GO:0007507 heart development    54   GJA1 -0.8179480 2.17e-06\n      zscore\n1 -0.8164966\n2 -0.8164966\n3 -0.8164966\n4 -0.8164966\n5 -0.8164966\n6 -0.8164966",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "GOBubble Plot"
    ]
  },
  {
    "objectID": "Hiplot/078-gobubble.html#visualization",
    "href": "Hiplot/078-gobubble.html#visualization",
    "title": "GOBubble Plot",
    "section": "Visualization",
    "text": "Visualization\n\n# GOBubble Plot\np &lt;- function () {\n  GOBubble(data, display = \"single\", title = \"GO Enrichment Bubbleplot\",\n           colour = c(\"#FC8D59\",\"#FFFFBF\",\"#99D594\"),\n           labels = 0,  ID = T, table.legend = T, table.col = T, bg.col = F) + \n  theme(plot.title = element_text(hjust = 0.5))\n}\np &lt;- as.ggplot(p)\n\np\n\n\n\n\n\n\n\nFigureÂ 1: GOBubble Plot\n\n\n\n\n\nAs shown in the example figure, the x- axis of the plot represents the z-score. The negative logarithm of the adjusted p-value (corresponding to the significance of the term) is displayed on the y-axis. The area of the plotted circles is proportional to the number of genes assigned to the term. Each circle is coloured according to its category and labeled alternatively with the ID or term name.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "GOBubble Plot"
    ]
  },
  {
    "objectID": "Hiplot/176-umap.html",
    "href": "Hiplot/176-umap.html",
    "title": "UMAP",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot UMAP plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/umap?lang=en\nUMAP is a nonlinear dimensionality reduction algorithm suitable for high-dimensional data reduction to two or three dimensions and visualization. The algorithm can make the t distribution of points with greater similarity closer in the lower dimensional space. For low similarity points, the t distribution is farther away in the low dimensional space.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "UMAP"
    ]
  },
  {
    "objectID": "Hiplot/176-umap.html#setup",
    "href": "Hiplot/176-umap.html#setup",
    "title": "UMAP",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; umap; ggpubr\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"umap\", quietly = TRUE)) {\n  install.packages(\"umap\")\n}\nif (!requireNamespace(\"ggpubr\", quietly = TRUE)) {\n  install.packages(\"ggpubr\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(umap)\nlibrary(ggpubr)",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "UMAP"
    ]
  },
  {
    "objectID": "Hiplot/176-umap.html#data-preparation",
    "href": "Hiplot/176-umap.html#data-preparation",
    "title": "UMAP",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data are the data set (gene name and corresponding gene expression value) and sample information (sample name and grouping).\n\n# Load data\ndata1 &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/umap/data.json\")$exampleData$textarea[[1]])\ndata1 &lt;- as.data.frame(data1)\ndata2 &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/umap/data.json\")$exampleData$textarea[[2]])\ndata2 &lt;- as.data.frame(data2)\n\n# convert data structure\nsample.info &lt;- data2\nrownames(data1) &lt;- data1[, 1]\ndata1 &lt;- as.matrix(data1[, -1])\n## umap\nset.seed(123)\numap_info &lt;- umap(t(data1))\ncolnames(umap_info$layout) &lt;- c(\"UMAP_1\", \"UMAP_2\")\n# handle data\numap_data &lt;- data.frame(\n  sample = colnames(data1),\n  umap_info$layout\n)\ncolorBy &lt;- sample.info[match(colnames(data1), sample.info[, 1]), \"Species\"]\ncolorBy &lt;- factor(colorBy, level = colorBy[!duplicated(colorBy)])\numap_data$colorBy = colorBy\nshapeBy &lt;- NULL\n\n# View data\nhead(data1[,1:5])\n\n              M1  M2  M3  M4  M5\nSepal.Length 5.1 4.9 4.7 4.6 5.0\nSepal.Width  3.5 3.0 3.2 3.1 3.6\nPetal.Length 1.4 1.4 1.3 1.5 1.4\nPetal.Width  0.2 0.2 0.2 0.2 0.2\n\nhead(data2)\n\n  Samples Species\n1      M1  setosa\n2      M2  setosa\n3      M3  setosa\n4      M4  setosa\n5      M5  setosa\n6      M6  setosa",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "UMAP"
    ]
  },
  {
    "objectID": "Hiplot/176-umap.html#visualization",
    "href": "Hiplot/176-umap.html#visualization",
    "title": "UMAP",
    "section": "Visualization",
    "text": "Visualization\n\n# umap\np &lt;- ggscatter(data = umap_data, x = \"UMAP_1\", y = \"UMAP_2\", size = 2, \n               palette = \"lancet\", color = \"colorBy\") +\n  labs(color = \"group\") +\n  ggtitle(\"UMAP Plot\") +\n  theme_classic() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: umap\n\n\n\n\n\nDifferent colors represent different samples, which is the same as PCA (principal component analysis) graphic interpretation. The difference lies in the visualization effect. For dissimilar points in T-SNE, a small distance will generate a large gradient to repel them.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "UMAP"
    ]
  },
  {
    "objectID": "Hiplot/052-extended-scatter.html",
    "href": "Hiplot/052-extended-scatter.html",
    "title": "Extended Scatter",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Extended Scatter plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/extended-scatter?lang=en\nAn extended scatter plot adds marginal plots to the basic scatter plot to provide a more comprehensive view of the data distribution.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Extended Scatter"
    ]
  },
  {
    "objectID": "Hiplot/052-extended-scatter.html#setup",
    "href": "Hiplot/052-extended-scatter.html#setup",
    "title": "Extended Scatter",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2; ggExtra\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"ggExtra\", quietly = TRUE)) {\n  install.packages(\"ggExtra\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(ggExtra)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Extended Scatter"
    ]
  },
  {
    "objectID": "Hiplot/052-extended-scatter.html#data-preparation",
    "href": "Hiplot/052-extended-scatter.html#data-preparation",
    "title": "Extended Scatter",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/extended-scatter/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# View data\nhead(data)\n\n   mpg cyl disp  hp drat    wt  qsec vs am gear carb\n1 21.0   6  160 110 3.90 2.620 16.46  0  1    4    4\n2 21.0   6  160 110 3.90 2.875 17.02  0  1    4    4\n3 22.8   4  108  93 3.85 2.320 18.61  1  1    4    1\n4 21.4   6  258 110 3.08 3.215 19.44  1  0    3    1\n5 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2\n6 18.1   6  225 105 2.76 3.460 20.22  1  0    3    1",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Extended Scatter"
    ]
  },
  {
    "objectID": "Hiplot/052-extended-scatter.html#visualization",
    "href": "Hiplot/052-extended-scatter.html#visualization",
    "title": "Extended Scatter",
    "section": "Visualization",
    "text": "Visualization\n\n# Extended Scatter\np &lt;- ggplot(data, aes(x = wt, y = mpg, color = cyl, size = cyl)) +\n  geom_point() +\n  geom_rug(alpha = 0.2, size = 1.5, col = \"#4f80b3\") +\n  theme(legend.position = \"none\")\n\np &lt;- ggMarginal(\n  p, type = \"densigram\", fill = \"#7054cc\", color = \"#7f0080\",\n  size = 4, bins = 30)\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Extended Scatter",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Extended Scatter"
    ]
  },
  {
    "objectID": "Hiplot/080-grdotplot.html",
    "href": "Hiplot/080-grdotplot.html",
    "title": "Group Rank Dotplot",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Group Rank Dotplot plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/grdotplot?lang=en\nValues distribution for different groups.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Group Rank Dotplot"
    ]
  },
  {
    "objectID": "Hiplot/080-grdotplot.html#setup",
    "href": "Hiplot/080-grdotplot.html#setup",
    "title": "Group Rank Dotplot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; sigminer; ggplot2\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"sigminer\", quietly = TRUE)) {\n  remotes::install_github(\"ShixiangWang/sigminer\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(sigminer)\nlibrary(ggplot2)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Group Rank Dotplot"
    ]
  },
  {
    "objectID": "Hiplot/080-grdotplot.html#data-preparation",
    "href": "Hiplot/080-grdotplot.html#data-preparation",
    "title": "Group Rank Dotplot",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/grdotplot/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# View data\nhead(data)\n\n  gvar       dvar\n1    A  0.4871212\n2    A -0.1370275\n3    A  0.1717455\n4    A -0.9447939\n5    A -1.2876203\n6    A  1.4077657",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Group Rank Dotplot"
    ]
  },
  {
    "objectID": "Hiplot/080-grdotplot.html#visualization",
    "href": "Hiplot/080-grdotplot.html#visualization",
    "title": "Group Rank Dotplot",
    "section": "Visualization",
    "text": "Visualization\n\n# Group Rank Dotplot\np &lt;- show_group_distribution(data, gvar = \"gvar\",  dvar = \"dvar\", \n                             order_by_fun = F)\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Group Rank Dotplot",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Group Rank Dotplot"
    ]
  },
  {
    "objectID": "Hiplot/123-mosaic.html",
    "href": "Hiplot/123-mosaic.html",
    "title": "Mosaic Ratio Plot",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Mosaic Ratio Plot plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/mosaic?lang=en\nUse mosaic blocks to show data proportions.",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Mosaic Ratio Plot"
    ]
  },
  {
    "objectID": "Hiplot/123-mosaic.html#setup",
    "href": "Hiplot/123-mosaic.html#setup",
    "title": "Mosaic Ratio Plot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; vcd; DescTools; ggplotify\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"vcd\", quietly = TRUE)) {\n  install.packages(\"vcd\")\n}\nif (!requireNamespace(\"DescTools\", quietly = TRUE)) {\n  install.packages(\"DescTools\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(vcd)\nlibrary(DescTools)\nlibrary(ggplotify)",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Mosaic Ratio Plot"
    ]
  },
  {
    "objectID": "Hiplot/123-mosaic.html#data-preparation",
    "href": "Hiplot/123-mosaic.html#data-preparation",
    "title": "Mosaic Ratio Plot",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/mosaic/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\ntbl &lt;- xtabs(~ Survived + PassengerClass + Gender, data)\n\n# View data\nhead(data)\n\n  PassengerId Survived PassengerClass\n1           1        0              3\n2           2        1              1\n3           3        1              3\n4           4        1              1\n5           5        0              3\n6           6        0              3\n                                                 Name Gender Age SibSp Parch\n1                             Braund, Mr. Owen Harris   Male  22     1     0\n2 Cumings, Mrs. John Bradley (Florence Briggs Thayer) Female  38     1     0\n3                              Heikkinen, Miss. Laina Female  26     0     0\n4        Futrelle, Mrs. Jacques Heath (Lily May Peel) Female  35     1     0\n5                            Allen, Mr. William Henry   Male  35     0     0\n6                                    Moran, Mr. James   Male  NA     0     0\n            Ticket    Fare Cabin Embarked\n1        A/5 21171  7.2500  &lt;NA&gt;        S\n2         PC 17599 71.2833   C85        C\n3 STON/O2. 3101282  7.9250  &lt;NA&gt;        S\n4           113803 53.1000  C123        S\n5           373450  8.0500  &lt;NA&gt;        S\n6           330877  8.4583  &lt;NA&gt;        Q",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Mosaic Ratio Plot"
    ]
  },
  {
    "objectID": "Hiplot/123-mosaic.html#visualization",
    "href": "Hiplot/123-mosaic.html#visualization",
    "title": "Mosaic Ratio Plot",
    "section": "Visualization",
    "text": "Visualization\n\n# Mosaic Ratio Plot\np &lt;- as.ggplot(function() {\n  mosaic(tbl, shade = TRUE, legend = TRUE, main = \"Mosaic Ratio Plot\",\n         gp = shading_binary(tbl, col = c(\"#3B4992FF\",\"#EE0000FF\")))\n})\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Mosaic Ratio Plot",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Mosaic Ratio Plot"
    ]
  },
  {
    "objectID": "Hiplot/026-connected-scatterplot.html",
    "href": "Hiplot/026-connected-scatterplot.html",
    "title": "Connected Scatterplot",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Connected Scatterplot plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/connected-scatterplot?lang=en\nConnected scatterplot",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Connected Scatterplot"
    ]
  },
  {
    "objectID": "Hiplot/026-connected-scatterplot.html#setup",
    "href": "Hiplot/026-connected-scatterplot.html#setup",
    "title": "Connected Scatterplot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2; dplyr; ggrepel\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"ggrepel\", quietly = TRUE)) {\n  install.packages(\"ggrepel\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(ggrepel)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Connected Scatterplot"
    ]
  },
  {
    "objectID": "Hiplot/026-connected-scatterplot.html#data-preparation",
    "href": "Hiplot/026-connected-scatterplot.html#data-preparation",
    "title": "Connected Scatterplot",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/connected-scatterplot/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# View data\nhead(data)\n\n  year Alice Anna\n1 1991   724 7118\n2 1992   686 6846\n3 1993   684 6808\n4 1994   595 7523\n5 1995   579 8564\n6 1996   593 8565",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Connected Scatterplot"
    ]
  },
  {
    "objectID": "Hiplot/026-connected-scatterplot.html#visualization",
    "href": "Hiplot/026-connected-scatterplot.html#visualization",
    "title": "Connected Scatterplot",
    "section": "Visualization",
    "text": "Visualization\n\n# Connected Scatterplot\nconnected_scatterplot &lt;- function(data, x, y, label, label_ratio, line_color, arrow_size, label_size) {\n\n  draw_data &lt;- data.frame(\n    x = data[[x]],\n    y = data[[y]],\n    label = data[[label]]\n  )\n\n  add_label_data &lt;- draw_data %&gt;% sample_frac(label_ratio)\n  rm(data)\n\n  p &lt;- ggplot(draw_data, aes(x = x, y = y, label = label)) +\n    geom_point(color = line_color) +\n    geom_text_repel(data = add_label_data, size = label_size) +\n    geom_segment(\n      color = line_color,\n      aes(\n        xend = c(tail(x, n = -1), NA),\n        yend = c(tail(y, n = -1), NA)\n      ),\n      arrow = arrow(length = unit(arrow_size, \"mm\"))\n    )\n\n  return(p)\n}\n\np &lt;- connected_scatterplot(\n  data = if (exists(\"data\") && is.data.frame(data)) data else \"\",\n  x = \"Alice\",\n  y = \"Anna\",\n  label = \"year\",\n  label_ratio = 0.5,\n  line_color = \"#1A237E\",\n  arrow_size = 2,\n  label_size = 2.5\n) +\n  theme_bw() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Connected Scatterplot",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Connected Scatterplot"
    ]
  },
  {
    "objectID": "Hiplot/098-map-china-city.html",
    "href": "Hiplot/098-map-china-city.html",
    "title": "China Map (City)",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot China Map (City) plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/map-china-city?lang=en",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "China Map (City)"
    ]
  },
  {
    "objectID": "Hiplot/098-map-china-city.html#setup",
    "href": "Hiplot/098-map-china-city.html#setup",
    "title": "China Map (City)",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2; RColorBrewer\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(RColorBrewer)",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "China Map (City)"
    ]
  },
  {
    "objectID": "Hiplot/098-map-china-city.html#data-preparation",
    "href": "Hiplot/098-map-china-city.html#data-preparation",
    "title": "China Map (City)",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/map-china-city/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\ndt_map &lt;- readRDS(url(\"https://download.hiplot.cn/ui/basic/map-china-city/china.city.rds\"))\n\n# Convert data structure\ndt_map$Value &lt;- data$value[match(dt_map$city, data$name)]\n\n# View data\nhead(data)\n\n      name value\n1   åŒ—äº¬å¸‚   756\n2   å¤©æ´¥å¸‚   321\n3 çŸ³å®¶åº„å¸‚   232\n4   å”å±±å¸‚   467\n5 ç§¦çš‡å²›å¸‚   549\n6   é‚¯éƒ¸å¸‚   226",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "China Map (City)"
    ]
  },
  {
    "objectID": "Hiplot/098-map-china-city.html#visualization",
    "href": "Hiplot/098-map-china-city.html#visualization",
    "title": "China Map (City)",
    "section": "Visualization",
    "text": "Visualization\n\n# China Map (City)\np &lt;- ggplot(dt_map) +\n  geom_polygon(aes(x = long, y = lat, group = group, fill = Value),\n               alpha = 0.9, size = 0.5) +\n  geom_path(aes(x = long, y = lat, group = group), color = \"black\", size = 0.2) +\n  coord_fixed() +\n  scale_fill_gradientn(\n    colours = colorRampPalette(rev(brewer.pal(11,\"RdYlBu\")))(500),\n    breaks = seq(min(data$value), max(data$value), \n                 round((max(data$value)-min(data$value))/7)),\n    name = \"\",\n    guide = guide_legend(\n      direction = \"vertical\", keyheight = unit(1, units = \"mm\"),\n      keywidth = unit(8, units = \"mm\"),\n      title.position = \"top\", title.hjust = 0.5, label.hjust = 0.5,\n      nrow = 1, byrow = T, reverse = F, label.position = \"bottom\")) +\n  theme(text = element_text(color = \"#3A3F4A\"),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank(),\n        legend.position = \"top\",\n        legend.text = element_text(size = 4 * 1.5, color = \"black\"),\n        legend.title = element_text(size = 5 * 1.5, color = \"black\"),\n        plot.title = element_text(\n          face = \"bold\", size = 5 * 1.5, hjust = 0.5, \n          margin = margin(t = 4, b = 5), color = \"black\"),\n        plot.background = element_rect(fill = \"#FFFFFF\", color = \"#FFFFFF\"),\n        panel.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        legend.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        plot.margin = unit(c(1.5, 1.5, 1.5, 1.5), \"cm\")) +\n  labs(x = NULL, y = NULL, title = \"China City Map\")\n\np\n\n\n\n\n\n\n\nFigureÂ 1: China Map (City)",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "China Map (City)"
    ]
  },
  {
    "objectID": "Hiplot/187-pca.html",
    "href": "Hiplot/187-pca.html",
    "title": "PCA",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot PCA plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/pca?lang=en\nPrincipal component analysis (PCA) is a data processing method with â€œdimension reductionâ€ as the core, replacing multi-index data with a few comprehensive indicators (PCA), and restoring the most essential characteristics of data.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "PCA"
    ]
  },
  {
    "objectID": "Hiplot/187-pca.html#setup",
    "href": "Hiplot/187-pca.html#setup",
    "title": "PCA",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; gmodels, ggpubr, ggplot2\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"gmodels\", quietly = TRUE)) {\n  install.packages(\"gmodels\")\n}\nif (!requireNamespace(\"ggpubr\", quietly = TRUE)) {\n  install.packages(\"ggpubr\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(gmodels)\nlibrary(ggpubr)\nlibrary(ggplot2)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "PCA"
    ]
  },
  {
    "objectID": "Hiplot/187-pca.html#data-preparation",
    "href": "Hiplot/187-pca.html#data-preparation",
    "title": "PCA",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data are set (gene name and corresponding gene expression value) and sample information (sample name and grouping).\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/pca/data.json\")$exampleData[[1]]$textarea[[1]])\ndata &lt;- as.data.frame(data)\ngroup &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/pca/data.json\")$exampleData[[1]]$textarea[[2]])\ngroup &lt;- as.data.frame(group)\n\n# Convert data structure\nrownames(data) &lt;- data[, 1]\ndata &lt;- as.matrix(data[, -1])\npca_info &lt;- fast.prcomp(data)\n## Create configuration\nconf &lt;- list(\n  dataArg = list(\n    list(list(value = \"group\")),  # Color by group\n    list(list(value = \"\"))         # No shape group\n  ),\n  general = list(\n    title = \"Principal Component Analysis\",\n    palette = \"Set1\"\n  )\n)\n## Perform PCA - Note: data must be transposed because PCA analyzes samples (columns)\npca_info &lt;- prcomp(t(data), scale. = TRUE)\n## Prepare plot data\naxis &lt;- sapply(conf$dataArg[[1]], function(x) x$value)\n## Process color grouping\nif (is.null(axis[1]) || axis[1] == \"\") {\n  colorBy &lt;- rep('ALL', ncol(data))\n} else {\n  ## Ensure sample order matches\n  colorBy &lt;- group[match(colnames(data), group$sample), axis[1]]\n}\ncolorBy &lt;- factor(colorBy, levels = unique(colorBy))\n## Create PCA data frame\npca_data &lt;- data.frame(\n  sample = rownames(pca_info$x),\n  PC1 = pca_info$x[, 1],\n  PC2 = pca_info$x[, 2],\n  colorBy = colorBy\n)\n## Calculate explained variance\nvariance_explained &lt;- round(pca_info$sdev^2 / sum(pca_info$sdev^2) * 100, 1)\n\n# View data\nstr(data)\n\n num [1:9, 1:6] 6.6 5.76 9.56 8.4 8.42 ...\n - attr(*, \"dimnames\")=List of 2\n  ..$ : chr [1:9] \"GBP4\" \"BCAT1\" \"CMPK2\" \"STOX2\" ...\n  ..$ : chr [1:6] \"M1\" \"M2\" \"M3\" \"M8\" ...\n\nstr(group)\n\n'data.frame':   6 obs. of  2 variables:\n $ sample: chr  \"M1\" \"M2\" \"M3\" \"M8\" ...\n $ group : chr  \"G1\" \"G1\" \"G1\" \"G2\" ...\n\nhead(pca_data)\n\n    sample        PC1         PC2 colorBy\nM1      M1  0.8626164  2.17168331      G1\nM2      M2  2.1114348  0.50696347      G1\nM3      M3  2.9706882 -1.81112892      G1\nM8      M8 -3.0779404 -0.85045239      G2\nM9      M9 -2.5038211  0.08748266      G2\nM10    M10 -0.3629779 -0.10454813      G2",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "PCA"
    ]
  },
  {
    "objectID": "Hiplot/187-pca.html#visualization",
    "href": "Hiplot/187-pca.html#visualization",
    "title": "PCA",
    "section": "Visualization",
    "text": "Visualization\n\n# PCA\np &lt;- ggplot(pca_data, aes(x = PC1, y = PC2, color = colorBy)) +\n  geom_point(size = 4, alpha = 0.8) +\n  geom_hline(yintercept = 0, linetype = \"dashed\", color = \"gray70\") +\n  geom_vline(xintercept = 0, linetype = \"dashed\", color = \"gray70\") +\n  stat_ellipse(level = 0.95, show.legend = FALSE) +\n  ggtitle(conf$general$title) +\n  labs(\n    x = paste0(\"PC1 (\", variance_explained[1], \"%)\"),\n    y = paste0(\"PC2 (\", variance_explained[2], \"%)\"),\n    color = axis[1]\n  ) +\n  \n  # Custom color scheme\n  scale_color_brewer(palette = conf$general$palette) +\n  \n  # Add sample labels\n  geom_text(aes(label = sample), \n            hjust = 0.5, vjust = -1, size = 3.5, show.legend = FALSE) +\n  \n  # Theme settings\n  theme_bw(base_size = 12) +\n  theme(\n    plot.title = element_text(hjust = 0.5, face = \"bold\", size = 16),\n    axis.title = element_text(size = 14, face = \"bold\"),\n    axis.text = element_text(size = 12),\n    legend.title = element_text(size = 12, face = \"bold\"),\n    legend.text = element_text(size = 11),\n    legend.position = \"right\",\n    panel.grid.major = element_line(color = \"grey90\", linewidth = 0.3),\n    panel.grid.minor = element_blank(),\n    panel.border = element_rect(fill = NA, color = \"grey50\", linewidth = 0.5),\n    aspect.ratio = 1\n  )\n\n# Display plot\np\n\nToo few points to calculate an ellipse\nToo few points to calculate an ellipse\n\n\nWarning: Removed 2 rows containing missing values or values outside the scale range\n(`geom_path()`).\n\n\n\n\n\nPCA\n\n\n\n\nDifferent colors represent different samples, which can explain the relationship between principal components and original variables. For example, M1 has a greater contribution to PC1, while M8 has a greater negative correlation with PC1.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "PCA"
    ]
  },
  {
    "objectID": "Hiplot/094-line-regression.html",
    "href": "Hiplot/094-line-regression.html",
    "title": "Line Regression",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Line Regression plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/line-regression?lang=en\nLinear regression is a regression method for linear modeling of the relationship between independent variables and dependent variables.If there is only one independent variable, it is called simple regression, and if there is more than one independent variable, it is called multiple regression.",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Line Regression"
    ]
  },
  {
    "objectID": "Hiplot/094-line-regression.html#setup",
    "href": "Hiplot/094-line-regression.html#setup",
    "title": "Line Regression",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggrepel; ggplot2\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggrepel\", quietly = TRUE)) {\n  install.packages(\"ggrepel\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggrepel)\nlibrary(ggplot2)",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Line Regression"
    ]
  },
  {
    "objectID": "Hiplot/094-line-regression.html#data-preparation",
    "href": "Hiplot/094-line-regression.html#data-preparation",
    "title": "Line Regression",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data are independent variables, dependent variables and groups.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/line-regression/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\ndata$group &lt;- factor(data$group, levels = unique(data$group))\n\n# View data\nhead(data)\n\n  value1 value2 group\n1   36.8  29.44    G1\n2   54.0  43.20    G1\n3   26.0  26.00    G1\n4   39.0  31.20    G1\n5   33.0  29.70    G1\n6   29.0  34.80    G1",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Line Regression"
    ]
  },
  {
    "objectID": "Hiplot/094-line-regression.html#visualization",
    "href": "Hiplot/094-line-regression.html#visualization",
    "title": "Line Regression",
    "section": "Visualization",
    "text": "Visualization\n\n# Line Regression\n## Defining the equation\nequation &lt;- function(x, add_p = FALSE) {\n  xs &lt;- summary(x)\n  lm_coef &lt;- list(\n    a = as.numeric(round(coef(x)[1], digits = 2)),\n    b = as.numeric(round(coef(x)[2], digits = 2)),\n    r2 = round(xs$r.squared, digits = 2),\n    pval = xs$coef[2, 4] \n  )\n  if (add_p) {\n    lm_eq &lt;- substitute(italic(y) == a + b %.% italic(x) * \",\" ~ ~\n  italic(R)^2 ~ \"=\" ~ r2 * \",\" ~ ~ italic(p) ~ \"=\" ~ pval, lm_coef)\n  } else {\n    lm_eq &lt;- substitute(italic(y) == a + b %.% italic(x) * \",\" ~ ~\n  italic(R)^2 ~ \"=\" ~ r2, lm_coef)\n  }\n  as.expression(lm_eq)\n}\n## Plot\np &lt;- ggplot(data, aes(x = value1, y = value2, colour = group)) +\n  geom_point(show.legend = TRUE) +\n  geom_smooth(method = \"lm\", se = T, show.legend = F) +\n  geom_rug(sides = \"bl\", size = 1, show.legend = F) +\n  scale_color_manual(values = c(\"#00468BFF\",\"#ED0000FF\")) +\n  ggtitle(\"Line Reguression Plot\") +\n  theme_bw() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12, hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n  \n## Add annotations for each group using ggrepel\nrepels &lt;- rep(\"\", nrow(data))\nfor (g in unique(data$group)) {\n  fit &lt;- lm(value2 ~ value1, data = data[data$group == g, ])\n  v &lt;- max(data[data$group == g, \"value2\"])\n  repels[which(data$value2 == v)[1]] &lt;- equation(fit, add_p = F)\n}\np &lt;- p + geom_text_repel(\n  data = data,\n  label = repels,\n  size = 4,\n  force = 5,\n  label.padding = 5,\n  na.rm = TRUE,\n  min.segment.length = 100,\n  show.legend = FALSE,\n  nudge_x = 0,\n  nudge_y = 0\n  )\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Line Regression\n\n\n\nDifferent colors represent different groups, and linear regression equations can be added. The closer R squared is to 1, the closer the fitted curve is to the actual curve.",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Line Regression"
    ]
  },
  {
    "objectID": "Hiplot/116-map-world.html",
    "href": "Hiplot/116-map-world.html",
    "title": "World Map",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot World Map plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/map-world?lang=en",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "World Map"
    ]
  },
  {
    "objectID": "Hiplot/116-map-world.html#setup",
    "href": "Hiplot/116-map-world.html#setup",
    "title": "World Map",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2; RColorBrewer\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(RColorBrewer)",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "World Map"
    ]
  },
  {
    "objectID": "Hiplot/116-map-world.html#data-preparation",
    "href": "Hiplot/116-map-world.html#data-preparation",
    "title": "World Map",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/map-world/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\ndt_map &lt;- readRDS(url(\"https://download.hiplot.cn/ui/basic/map-world/world.rds\"))\n\n# Convert data structure\ndt_map$Value &lt;- data$death_rate[match(dt_map$ENG_NAME, data$region)]\n\n# View data\nhead(data)\n\n          region death_rate\n1    Afghanistan       13.4\n2        Albania        6.8\n3        Algeria        4.3\n4 American Samoa        5.9\n5        Andorra        7.3\n6         Angola        9.2",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "World Map"
    ]
  },
  {
    "objectID": "Hiplot/116-map-world.html#visualization",
    "href": "Hiplot/116-map-world.html#visualization",
    "title": "World Map",
    "section": "Visualization",
    "text": "Visualization\n\n# World Map\np &lt;- ggplot(dt_map) +\n  geom_polygon(aes(x = long, y = lat, group = group, fill = Value),\n               alpha = 0.9, size = 0.5) +\n  geom_path(aes(x = long, y = lat, group = group), \n            color = \"black\", size = 0.2) +\n  coord_fixed() +\n  scale_fill_gradientn(\n    colours = colorRampPalette(rev(brewer.pal(11,\"RdYlBu\")))(500),\n    na.value = \"grey10\",\n    limits = c(0, max(dt_map$Value) * 1.2)) +\n    ggtitle(\"World Map Plot\") +\n  theme_minimal() +\n  theme(plot.title = element_text(hjust = 0.5),\n        legend.position = \"bottom\", legend.direction = \"horizontal\")\n\np\n\n\n\n\n\n\n\nFigureÂ 1: World Map",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "World Map"
    ]
  },
  {
    "objectID": "Hiplot/093-line-errorbar.html",
    "href": "Hiplot/093-line-errorbar.html",
    "title": "Line (errorbar)",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Line (errorbar) plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/line-errorbar?lang=en\nThe error line mainly indicates the error range of each data point and shows the potential error or uncertainty relative to each data in the series.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Line (errorbar)"
    ]
  },
  {
    "objectID": "Hiplot/093-line-errorbar.html#setup",
    "href": "Hiplot/093-line-errorbar.html#setup",
    "title": "Line (errorbar)",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggpubr\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggpubr\", quietly = TRUE)) {\n  install.packages(\"ggpubr\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggpubr)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Line (errorbar)"
    ]
  },
  {
    "objectID": "Hiplot/093-line-errorbar.html#data-preparation",
    "href": "Hiplot/093-line-errorbar.html#data-preparation",
    "title": "Line (errorbar)",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data are two groups and their corresponding values.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/line-errorbar/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\ndata[, 3] &lt;- factor(data[, 3], levels = unique(data[, 3]))\n\n# View data\nhead(data)\n\n  Value Group2 Group1\n1   4.2 treat1    low\n2  11.5 treat1    low\n3   7.3 treat1    low\n4   5.8 treat1    low\n5   6.4 treat1    low\n6  10.0 treat1    low",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Line (errorbar)"
    ]
  },
  {
    "objectID": "Hiplot/093-line-errorbar.html#visualization",
    "href": "Hiplot/093-line-errorbar.html#visualization",
    "title": "Line (errorbar)",
    "section": "Visualization",
    "text": "Visualization\n\n# Line (errorbar)\np &lt;- ggline(\n  data, x = \"Group1\", y = \"Value\", color = \"Group2\",\n  add = \"mean_se\", title = \"Line plot with errorbar\", palette = \"npg\") +\n  stat_compare_means(aes_(group = as.name(\"Group2\"))) +\n  theme_bw() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12, hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Line (errorbar)\n\n\n\n\n\nThe red line in low type represents the maximum value of the low type in treat1, the red line represents the minimum value of the low type in treat1, and so on. Conduct rank-sum test on treat1 and treat2 according to low,mid and high types respectively, and display p-value at the top of the figure.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Line (errorbar)"
    ]
  },
  {
    "objectID": "Hiplot/015-boxplot.html",
    "href": "Hiplot/015-boxplot.html",
    "title": "Boxplot",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Boxplot plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/boxplot?lang=en\nThe box plot is a method of visualizing the distribution characteristics of a set of data by means of a quartile graph.",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Boxplot"
    ]
  },
  {
    "objectID": "Hiplot/015-boxplot.html#setup",
    "href": "Hiplot/015-boxplot.html#setup",
    "title": "Boxplot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggpubr; ggthemes\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggpubr\", quietly = TRUE)) {\n  install.packages(\"ggpubr\")\n}\nif (!requireNamespace(\"ggthemes\", quietly = TRUE)) {\n  install.packages(\"ggthemes\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggpubr)\nlibrary(ggthemes)",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Boxplot"
    ]
  },
  {
    "objectID": "Hiplot/015-boxplot.html#data-preparation",
    "href": "Hiplot/015-boxplot.html#data-preparation",
    "title": "Boxplot",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data is data set (data on treatment outcomes of different treatment regimens).\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/boxplot/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# convert data structure\ngroups &lt;- unique(data[, 2])\nmy_comparisons &lt;- combn(groups, 2, simplify = FALSE)\nmy_comparisons &lt;- lapply(my_comparisons, as.character)\n\n# View data\nhead(data)\n\n  Value Group1 Group2\n1   4.2    low treat1\n2  11.5    low treat1\n3   7.3    low treat1\n4   5.8    low treat1\n5   6.4    low treat1\n6  10.0    low treat1",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Boxplot"
    ]
  },
  {
    "objectID": "Hiplot/015-boxplot.html#visualization",
    "href": "Hiplot/015-boxplot.html#visualization",
    "title": "Boxplot",
    "section": "Visualization",
    "text": "Visualization\n\n# Boxplot\np &lt;- ggboxplot(data, x = \"Group1\", y = \"Value\", notch = F, facet.by = \"Group2\",\n               add = \"point\", color = \"Group1\", xlab = \"Group2\", ylab = \"Value\",\n               palette = c(\"#e04d39\",\"#5bbad6\",\"#1e9f86\"),\n               title = \"Box Plot\") +\n  stat_compare_means(comparisons = my_comparisons, label = \"p.format\", \n                     method = \"t.test\") +\n  scale_y_continuous(expand = expansion(mult = c(0.1, 0.1))) +\n  theme_stata() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Boxplot\n\n\n\n\n\nThe abscissa represents several different sets of data, and the ordinate represents the quartile of each set of data respectively. The upper, middle and lower horizontal lines of the box represent the upper, median and lower quartile respectively; The values represented by the upper and lower line segments respectively exponential the maximum and minimum values of the data, and the points outside the box represent outliers. The above figure indicates the P value between two variables. It can be considered that in treatment plan 1, there is a significant difference in efficacy between the middle-dose group and the low-dose group, and so on.",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Boxplot"
    ]
  },
  {
    "objectID": "Hiplot/131-nomogram.html",
    "href": "Hiplot/131-nomogram.html",
    "title": "Nomogram",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Nomogram plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/nomogram?lang=en\nNomogram is often used to evaluate the prognosis of oncology and medicine, and can visualize the results of logistic regression or Cox regression.",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Nomogram"
    ]
  },
  {
    "objectID": "Hiplot/131-nomogram.html#setup",
    "href": "Hiplot/131-nomogram.html#setup",
    "title": "Nomogram",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; survival; rms; ggplotify\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"survival\", quietly = TRUE)) {\n  install.packages(\"survival\")\n}\nif (!requireNamespace(\"rms\", quietly = TRUE)) {\n  install.packages(\"rms\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(survival)\nlibrary(rms)\nlibrary(ggplotify)",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Nomogram"
    ]
  },
  {
    "objectID": "Hiplot/131-nomogram.html#data-preparation",
    "href": "Hiplot/131-nomogram.html#data-preparation",
    "title": "Nomogram",
    "section": "Data Preparation",
    "text": "Data Preparation\nSurvival data frame with time, which sex and status are presented by number such as 0,1 according to example data.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/nomogram/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\ndd &lt;- datadist(data)\noptions(datadist = \"dd\")\n## Build COX model and run nomogram\ncox_res &lt;- psm(\n  data = data,\n  as.formula(paste(\n    sprintf(\"Surv(%s, %s) ~ \", colnames(data)[1], colnames(data)[2]),\n    paste(colnames(data)[3:length(colnames(data))],\n      collapse = \"+\"\n    )\n  )),\n  # Surv(time, status) ~ age + sex + ph.ecog + ph.karno + pat.karno,\n  dist = \"lognormal\"\n)\n## Build survival probability function\nsurv &lt;- Survival(cox_res)\n## Build quantile survival time function\nmed &lt;- Quantile(cox_res)\n\ncox_nomo &lt;- nomogram(\n  cox_res,\n  fun = list(function(x) surv(365, x), function(x) surv(1095, x),\n             function(x) surv(1825, x), function(x) med(lp = x)),\n  funlabel = c(\"1-year Survival Probability\",\n               \"3-year Survival Probability\",\n               \"5-year Survival Probability\",\n               \"Median Survival Time\"),\n  maxscale = 100\n)\n\n# View data\nhead(data)\n\n  time status age sex ph.ecog ph.karno pat.karno meal.cal wt.loss\n1  306      2  74   1       1       90       100     1175      NA\n2  455      2  68   1       0       90        90     1225      15\n3 1010      1  56   1       0       90        90       NA      15\n4  210      2  57   1       1       90        60     1150      11\n5  883      2  60   1       0      100        90       NA       0\n6 1022      1  74   1       1       50        80      513       0",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Nomogram"
    ]
  },
  {
    "objectID": "Hiplot/131-nomogram.html#visualization",
    "href": "Hiplot/131-nomogram.html#visualization",
    "title": "Nomogram",
    "section": "Visualization",
    "text": "Visualization\n\n# Nomogram\np &lt;- as.ggplot(function() {\n  plot(cox_nomo, scale = 1)\n  title(main = \"Nomogram (COX)\")\n})\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Nomogram",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Nomogram"
    ]
  },
  {
    "objectID": "Hiplot/103-map-france-town.html",
    "href": "Hiplot/103-map-france-town.html",
    "title": "France Map (Town)",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot France Map (Town) plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/map-france-town?lang=en",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "France Map (Town)"
    ]
  },
  {
    "objectID": "Hiplot/103-map-france-town.html#setup",
    "href": "Hiplot/103-map-france-town.html#setup",
    "title": "France Map (Town)",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2; RColorBrewer\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(RColorBrewer)",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "France Map (Town)"
    ]
  },
  {
    "objectID": "Hiplot/103-map-france-town.html#data-preparation",
    "href": "Hiplot/103-map-france-town.html#data-preparation",
    "title": "France Map (Town)",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/map-france-town/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\ndt_map &lt;- readRDS(url(\"https://download.hiplot.cn/ui/basic/map-france-town/france_town.rds\"))\n\n# Convert data structure\ndt_map$Value &lt;- data$value[match(dt_map$ENG_NAME, data$name)]\n\n# View data\nhead(data)\n\n                   name value\n1           Bischwiller   669\n2              Haguenau   935\n3 Niederbronn-les-Bains   356\n4              Molsheim   199\n5               Rosheim   971\n6                Saales   532",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "France Map (Town)"
    ]
  },
  {
    "objectID": "Hiplot/103-map-france-town.html#visualization",
    "href": "Hiplot/103-map-france-town.html#visualization",
    "title": "France Map (Town)",
    "section": "Visualization",
    "text": "Visualization\n\n# France Map (Town)\np &lt;- ggplot(dt_map) +\n  geom_polygon(aes(x = long, y = lat, group = group, fill = Value),\n               alpha = 0.9, size = 0.5) +\n  geom_path(aes(x = long, y = lat, group = group), color = \"black\", size = 0.2) +\n  coord_fixed() +\n  scale_fill_gradientn(\n    colours = colorRampPalette(rev(brewer.pal(11,\"RdYlBu\")))(500),\n    breaks = seq(min(data$value), max(data$value), \n                 round((max(data$value)-min(data$value))/7)),\n    name = \"Color Key\",\n    guide = guide_legend(\n      direction = \"vertical\", keyheight = unit(1, units = \"mm\"),\n      keywidth = unit(8, units = \"mm\"),\n      title.position = \"top\", title.hjust = 0.5, label.hjust = 0.5,\n      nrow = 1, byrow = T, reverse = F, label.position = \"bottom\")) +\n  theme(text = element_text(color = \"#3A3F4A\"),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank(),\n        legend.position = \"top\",\n        legend.text = element_text(size = 4 * 1.5, color = \"black\"),\n        legend.title = element_text(size = 5 * 1.5, color = \"black\"),\n        plot.title = element_text(\n          face = \"bold\", size = 5 * 1.5, hjust = 0.5, \n          margin = margin(t = 4, b = 5), color = \"black\"),\n        plot.background = element_rect(fill = \"#FFFFFF\", color = \"#FFFFFF\"),\n        panel.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        legend.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        plot.margin = unit(c(1.5, 1.5, 1.5, 1.5), \"cm\")) +\n  labs(x = NULL, y = NULL, title = \"France Map\")\n\np\n\n\n\n\n\n\n\nFigureÂ 1: France Map (Town)",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "France Map (Town)"
    ]
  },
  {
    "objectID": "Hiplot/174-tricolor-histogram.html",
    "href": "Hiplot/174-tricolor-histogram.html",
    "title": "Tricolor Histogram",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Tricolor Histogram plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/tricolor-histogram?lang=en\nThe tricolored histogram divides the histogram into three regions: low-value zone, middle-value zone, and high-value zone, using three different colors.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Tricolor Histogram"
    ]
  },
  {
    "objectID": "Hiplot/174-tricolor-histogram.html#setup",
    "href": "Hiplot/174-tricolor-histogram.html#setup",
    "title": "Tricolor Histogram",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Tricolor Histogram"
    ]
  },
  {
    "objectID": "Hiplot/174-tricolor-histogram.html#data-preparation",
    "href": "Hiplot/174-tricolor-histogram.html#data-preparation",
    "title": "Tricolor Histogram",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/tricolor-histogram/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# convert data structure\ndata$draw_color &lt;- ifelse(data$value &lt; 5, \"#F44336\",\n                          ifelse(data$value &gt; 7, \"#006064\", \"#3F51B5\")\n)\n\n# View data\nhead(data)\n\n    values draw_color\n1 6.063364    #3F51B5\n2 4.354496    #F44336\n3 5.569931    #3F51B5\n4 5.602465    #3F51B5\n5 6.831472    #3F51B5\n6 6.055604    #3F51B5",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Tricolor Histogram"
    ]
  },
  {
    "objectID": "Hiplot/174-tricolor-histogram.html#visualization",
    "href": "Hiplot/174-tricolor-histogram.html#visualization",
    "title": "Tricolor Histogram",
    "section": "Visualization",
    "text": "Visualization\n\n# Tricolor Histogram\np &lt;- ggplot(data, aes(x = values, fill = draw_color)) +\n  geom_histogram(alpha = 0.5, binwidth = 0.05, position = \"identity\") +\n    scale_fill_manual(values = c(\"#3F51B5\", \"#006064\", \"#F44336\")) +\n  theme_bw()\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Tricolor Histogram",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Tricolor Histogram"
    ]
  },
  {
    "objectID": "Hiplot/138-pie-3d.html",
    "href": "Hiplot/138-pie-3d.html",
    "title": "3D Pie",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot 3D Pie plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/pie-3d?lang=en\nThe 3D pie chart is a pie chart that has a 3D appearance.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "PCAtools"
    ]
  },
  {
    "objectID": "Hiplot/138-pie-3d.html#setup",
    "href": "Hiplot/138-pie-3d.html#setup",
    "title": "3D Pie",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; plotrix; ggplotify\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"plotrix\", quietly = TRUE)) {\n  install.packages(\"plotrix\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(plotrix)\nlibrary(ggplotify)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "PCAtools"
    ]
  },
  {
    "objectID": "Hiplot/138-pie-3d.html#data-preparation",
    "href": "Hiplot/138-pie-3d.html#data-preparation",
    "title": "3D Pie",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data are different groups and their data.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/pie-3d/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\ncolnames(data) &lt;- c(\"Group\", \"Value\")\ndata$Value &lt;- as.numeric(data$Value)\ndata &lt;- data[data$Value != 0,]\n\n# View data\nhead(data)\n\n   Group Value\n1 Group1    13\n2 Group2    34\n3 Group3    21\n4 Group4    43",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "PCAtools"
    ]
  },
  {
    "objectID": "Hiplot/138-pie-3d.html#visualization",
    "href": "Hiplot/138-pie-3d.html#visualization",
    "title": "3D Pie",
    "section": "Visualization",
    "text": "Visualization\n\n# 3D Pie\npie3D(data$Value, radius = 0.8, height = 0.05, theta = 0.8,\n      labels = paste(data$Group, \"\\n(n=\", data$Value, \", \",\n                     round(data$Value / sum(data$Value) * 100, 2), \"%)\",\n                     sep = \"\"),\n      explode = 0.1, main = \"\", labelcex = 1, shade = 0.4, labelcol = \"black\",\n      col = c(\"#E64B35FF\",\"#4DBBD5FF\",\"#00A087FF\",\"#3C5488FF\"))\n\n\n\n\n\n\n\nFigureÂ 1: 3D Pie\n\n\n\n\n\nThe figure shows more aesthetically the number of samples in groups 1 to 4 and the proportion corresponding to the number of samples in the 3D form. The number of samples in one group is 13, accounting for 11.71%; the number of samples in two groups is 34, accounting for 30.63%; the number of samples in three groups is 21, accounting for 18.92%; and the number of samples in four groups is 43, accounting for 38.74%.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "PCAtools"
    ]
  },
  {
    "objectID": "Hiplot/055-fishplot.html",
    "href": "Hiplot/055-fishplot.html",
    "title": "Fishplot",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Fishplot plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/fishplot?lang=en\nClone evolution analysis",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Fishplot"
    ]
  },
  {
    "objectID": "Hiplot/055-fishplot.html#setup",
    "href": "Hiplot/055-fishplot.html#setup",
    "title": "Fishplot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; fishplot\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"fishplot\", quietly = TRUE)) {\n  remotes::install_github(\"chrisamiller/fishplot\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(fishplot)",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Fishplot"
    ]
  },
  {
    "objectID": "Hiplot/055-fishplot.html#data-preparation",
    "href": "Hiplot/055-fishplot.html#data-preparation",
    "title": "Fishplot",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/fishplot/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# View data\nhead(data)\n\n  timepoints parents sample.name event1 event2 event3 event4\n1          0       0     Sample1    100      2      2     98\n2         30       1     Sample1     45      0      0      0\n3         75       1     Sample1      0      0      2     95\n4        150       3     Sample1      0      0      1     40\n\n\n\ntimepoints: specifying the timepoints for each column of the matrix\nparents: specifying parental relationships between clones\nsamplename: samplename (support multiple samples)\nother: a numeric matrix containing tumor fraction estimates for all clones at all timepoints",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Fishplot"
    ]
  },
  {
    "objectID": "Hiplot/055-fishplot.html#visualization",
    "href": "Hiplot/055-fishplot.html#visualization",
    "title": "Fishplot",
    "section": "Visualization",
    "text": "Visualization\n\n## Create a fish object\nfish = createFishObject(as.matrix(data[,4:7]), parents=data$parents, \n                        timepoints=data$timepoints, \n                        col = c(\"#888888\",\"#e8130c\",\"#f8150d\",\"#55158f\"))\n## Calculate the layout of the drawing\nfish = layoutClones(fish)\n## Draw the plot, using the splining method (recommended), and providing both timepoints to label and a plot title\nfishPlot(fish,shape=\"spline\", title.btm=\"Sample1\", title = \"Fishplot\",\n         cex.title=1, vlines=c(0,30,75,150), \n         vlab=c(\"Day 0\",\"Day 30\",\"Day 75\",\"Day 150\"))\n\n\n\n\n\n\n\nFigureÂ 1: Fishplot",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Fishplot"
    ]
  },
  {
    "objectID": "Hiplot/040-density.html",
    "href": "Hiplot/040-density.html",
    "title": "Density",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Density plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/density?lang=en\nThe kernel density map is a graph used to observe the distribution of continuous variables.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Density"
    ]
  },
  {
    "objectID": "Hiplot/040-density.html#setup",
    "href": "Hiplot/040-density.html#setup",
    "title": "Density",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2; ggthemes\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"ggthemes\", quietly = TRUE)) {\n  install.packages(\"ggthemes\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(ggthemes)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Density"
    ]
  },
  {
    "objectID": "Hiplot/040-density.html#data-preparation",
    "href": "Hiplot/040-density.html#data-preparation",
    "title": "Density",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/density/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# convert data structure\ndata[,2] &lt;- factor(data[,2], levels = unique(data[,2]))\n\n# View data\nhead(data)\n\n  Value Group2\n1   4.2 treat1\n2  11.5 treat1\n3   7.3 treat1\n4   5.8 treat1\n5   6.4 treat1\n6  10.0 treat1",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Density"
    ]
  },
  {
    "objectID": "Hiplot/040-density.html#visualization",
    "href": "Hiplot/040-density.html#visualization",
    "title": "Density",
    "section": "Visualization",
    "text": "Visualization\n\n# Density\ndata[\"group_add_by_code\"] &lt;- \"g1\"\n\np &lt;- ggplot(data, aes_(as.name(colnames(data[1])))) +\n  geom_density(col = \"white\", alpha = 0.85,\n               aes_(fill = as.name(colnames(data[2])))) +\n  ggtitle(\"\") +\n  scale_fill_manual(values = c(\"#e04d39\",\"#5bbad6\")) +\n  theme_stata() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Density",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Density"
    ]
  },
  {
    "objectID": "Hiplot/063-ggbarstats.html",
    "href": "Hiplot/063-ggbarstats.html",
    "title": "Barstats",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Barstats plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/ggbarstats?lang=en",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Barstats"
    ]
  },
  {
    "objectID": "Hiplot/063-ggbarstats.html#setup",
    "href": "Hiplot/063-ggbarstats.html#setup",
    "title": "Barstats",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggstatsplot; ggplot2; cowplot\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggstatsplot\", quietly = TRUE)) {\n  install.packages(\"ggstatsplot\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"cowplot\", quietly = TRUE)) {\n  install.packages(\"cowplot\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggstatsplot)\nlibrary(ggplot2)\nlibrary(cowplot)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Barstats"
    ]
  },
  {
    "objectID": "Hiplot/063-ggbarstats.html#data-preparation",
    "href": "Hiplot/063-ggbarstats.html#data-preparation",
    "title": "Barstats",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/ggbarstats/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\naxis &lt;- c(\"relig\", \"partyid\", \"race\")\ndata[, axis[1]] &lt;- factor(data[, axis[1]], levels = rev(unique(data[, axis[1]])))\ndata[, axis[2]] &lt;- factor(data[, axis[2]], levels = unique(data[, axis[2]]))\ndata[, axis[3]] &lt;- factor(data[, axis[3]], levels = unique(data[, axis[3]]))\n\n# View data\nhead(data)\n\n  year       marital age  race        rincome            partyid      relig\n1 2000 Never married  26 White  $8000 to 9999       Ind,near rep Protestant\n2 2000      Divorced  48 White  $8000 to 9999 Not str republican Protestant\n3 2000       Widowed  67 White Not applicable        Independent Protestant\n4 2000      Divorced  25 White Not applicable   Not str democrat       None\n5 2000       Married  25 White $20000 - 24999    Strong democrat Protestant\n6 2000      Divorced  44 White  $7000 to 7999       Ind,near dem Protestant\n              denom tvhours\n1  Southern baptist      12\n2  Baptist-dk which      NA\n3   No denomination       2\n4    Not applicable       1\n5  Southern baptist      NA\n6 Lutheran-mo synod      NA",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Barstats"
    ]
  },
  {
    "objectID": "Hiplot/063-ggbarstats.html#visualization",
    "href": "Hiplot/063-ggbarstats.html#visualization",
    "title": "Barstats",
    "section": "Visualization",
    "text": "Visualization\n\n# Barstats\ng &lt;- unique(data[,axis[3]])\nplist &lt;- list()\nfor (i in 1:length(g)) {\n  fil &lt;- data[,axis[3]] == g[i]\n  plist[[i]] &lt;- ggbarstats(\n    data = data[fil,], x = relig, y = partyid,\n    plotgrid.args = list(ncol = 1), paired = F, k = 2) +\n    scale_fill_manual(values = c(\"#00468BFF\",\"#ED0000FF\",\"#42B540FF\"))\n}\np &lt;- plot_grid(plotlist = plist, ncol = 1)\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Barstats",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Barstats"
    ]
  },
  {
    "objectID": "Hiplot/146-pyramid-stack.html",
    "href": "Hiplot/146-pyramid-stack.html",
    "title": "Pyramid Stack",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Pyramid Stack plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/pyramid-stack?lang=en\nThe pyramid stack is a pyramid-like figure that distributes data on both sides of a central axis.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pyramid Stack"
    ]
  },
  {
    "objectID": "Hiplot/146-pyramid-stack.html#setup",
    "href": "Hiplot/146-pyramid-stack.html#setup",
    "title": "Pyramid Stack",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2; ggthemes; dplyr\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"ggthemes\", quietly = TRUE)) {\n  install.packages(\"ggthemes\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(ggthemes)\nlibrary(dplyr)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pyramid Stack"
    ]
  },
  {
    "objectID": "Hiplot/146-pyramid-stack.html#data-preparation",
    "href": "Hiplot/146-pyramid-stack.html#data-preparation",
    "title": "Pyramid Stack",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/pyramid-stack/data.json\")$exampleData[[1]]$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\ndata[,3] &lt;- factor(data[,3], levels = unique(data[,3]))\ndata[,1] &lt;- factor(data[,1], levels = unique(data[,1]))\n\n# View data\nhead(data)\n\n    age gender year       pop\n1   0-4   male 1950 171.85124\n2   5-9   male 1950 137.99242\n3 10-14   male 1950 133.27428\n4 15-19   male 1950 121.69274\n5 20-24   male 1950 112.39438\n6 25-29   male 1950  96.59408",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pyramid Stack"
    ]
  },
  {
    "objectID": "Hiplot/146-pyramid-stack.html#visualization",
    "href": "Hiplot/146-pyramid-stack.html#visualization",
    "title": "Pyramid Stack",
    "section": "Visualization",
    "text": "Visualization\n\n# Pyramid Stack\np &lt;- ggplot(data = data, aes(x = age, y = pop, fill = year)) +\n  geom_bar(data = data %&gt;% filter(gender == \"female\") %&gt;% arrange(rev(year)),\n           stat = \"identity\", position = \"identity\") +\n  geom_bar(data = data %&gt;% filter(gender == \"male\") %&gt;% arrange(rev(year)),\n           stat = \"identity\", position = \"identity\", mapping = aes(y = -pop)) +\n  coord_flip() +\n  geom_hline(yintercept = 0) +\n  scale_fill_economist() +\n  scale_fill_manual(values = c(\"#e04d39\",\"#5bbad6\",\"#1e9f86\")) +\n  labs(y = \"pop | male (left) - female (right)\", x= \"\") +\n  theme_economist(horizontal = FALSE) +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"top\",\n        legend.direction = \"horizontal\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10),\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank())\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Pyramid Stack",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pyramid Stack"
    ]
  },
  {
    "objectID": "Hiplot/108-map-north-america.html",
    "href": "Hiplot/108-map-north-america.html",
    "title": "North America Map",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot North America Map plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/map-north-america?lang=en",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "North America Map"
    ]
  },
  {
    "objectID": "Hiplot/108-map-north-america.html#setup",
    "href": "Hiplot/108-map-north-america.html#setup",
    "title": "North America Map",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2; RColorBrewer\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(RColorBrewer)",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "North America Map"
    ]
  },
  {
    "objectID": "Hiplot/108-map-north-america.html#data-preparation",
    "href": "Hiplot/108-map-north-america.html#data-preparation",
    "title": "North America Map",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/map-north-america/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\ndt_map &lt;- readRDS(url(\"https://download.hiplot.cn/ui/basic/map-north-america/na.rds\"))\n\n# Convert data structure\ndt_map$Value &lt;- data$value[match(dt_map$ENG_NAME, data$region)]\n\n# View data\nhead(data)\n\n             region value\n1 ANTIGUA & BARBUDA   918\n2     Anguilla (UK)    95\n3          BARBADOS   878\n4            BELIZE   874\n5      Bermuda (UK)   159\n6            CANADA   118",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "North America Map"
    ]
  },
  {
    "objectID": "Hiplot/108-map-north-america.html#visualization",
    "href": "Hiplot/108-map-north-america.html#visualization",
    "title": "North America Map",
    "section": "Visualization",
    "text": "Visualization\n\n# North America Map\np &lt;- ggplot(dt_map) +\n  geom_polygon(aes(x = long, y = lat, group = group, fill = Value),\n               alpha = 0.9, size = 0.5) +\n  geom_path(aes(x = long, y = lat, group = group), color = \"black\", size = 0.2) +\n  coord_fixed() +\n  scale_fill_gradientn(\n    colours = colorRampPalette(rev(brewer.pal(11,\"RdYlBu\")))(500),\n    breaks = seq(min(data$value), max(data$value), \n                 round((max(data$value)-min(data$value))/7)),\n    name = \"Color Key\",\n    guide = guide_legend(\n      direction = \"vertical\", keyheight = unit(1, units = \"mm\"),\n      keywidth = unit(8, units = \"mm\"),\n      title.position = \"top\", title.hjust = 0.5, label.hjust = 0.5,\n      nrow = 1, byrow = T, reverse = F, label.position = \"bottom\")) +\n  theme(text = element_text(color = \"#3A3F4A\"),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank(),\n        legend.position = \"top\",\n        legend.text = element_text(size = 4 * 1.5, color = \"black\"),\n        legend.title = element_text(size = 5 * 1.5, color = \"black\"),\n        plot.title = element_text(\n          face = \"bold\", size = 5 * 1.5, hjust = 0.5, \n          margin = margin(t = 4, b = 5), color = \"black\"),\n        plot.background = element_rect(fill = \"#FFFFFF\", color = \"#FFFFFF\"),\n        panel.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        legend.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        plot.margin = unit(c(1.5, 1.5, 1.5, 1.5), \"cm\")) +\n  labs(x = NULL, y = NULL, title = \"North America Map\")\n\np\n\n\n\n\n\n\n\nFigureÂ 1: North America Map",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "North America Map"
    ]
  },
  {
    "objectID": "Hiplot/096-map-africa.html",
    "href": "Hiplot/096-map-africa.html",
    "title": "Africa Map",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Africa Map plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/map-africa?lang=en",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Africa Map"
    ]
  },
  {
    "objectID": "Hiplot/096-map-africa.html#setup",
    "href": "Hiplot/096-map-africa.html#setup",
    "title": "Africa Map",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2; RColorBrewer\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(RColorBrewer)",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Africa Map"
    ]
  },
  {
    "objectID": "Hiplot/096-map-africa.html#data-preparation",
    "href": "Hiplot/096-map-africa.html#data-preparation",
    "title": "Africa Map",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/map-africa/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\ndt_map &lt;- readRDS(url(\"https://download.hiplot.cn/ui/basic/map-africa/afr.rds\"))\n\n# Convert data structure\ndt_map$Value &lt;- data$value[match(dt_map$ADM0_NAME, data$region)]\n\n# View data\nhead(data)\n\n        region value\n1        Sudan   258\n2       Angola   911\n3        Benin   318\n4     Botswana   759\n5 Burkina Faso   983\n6     Cameroon   618",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Africa Map"
    ]
  },
  {
    "objectID": "Hiplot/096-map-africa.html#visualization",
    "href": "Hiplot/096-map-africa.html#visualization",
    "title": "Africa Map",
    "section": "Visualization",
    "text": "Visualization\n\n# Africa Map\np &lt;- ggplot(dt_map) +\n  geom_polygon(aes(x = long, y = lat, group = group, fill = Value),\n               alpha = 0.9, size = 0.5) +\n  geom_path(aes(x = long, y = lat, group = group), color = \"black\", size = 0.2) +\n  coord_fixed() +\n  scale_fill_gradientn(\n    colours = colorRampPalette(rev(brewer.pal(11,\"RdYlBu\")))(500),\n    breaks = seq(9, 985, 139),\n    name = \"Color Key\",\n    guide = guide_legend(\n      direction = \"vertical\", keyheight = unit(1, units = \"mm\"),\n      keywidth = unit(8, units = \"mm\"),\n      title.position = \"top\", title.hjust = 0.5, label.hjust = 0.5,\n      nrow = 1, byrow = T, reverse = F, label.position = \"bottom\")) +\n  theme(text = element_text(color = \"#3A3F4A\"),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank(),\n        legend.position = \"top\",\n        legend.text = element_text(size = 4 * 1.5, color = \"black\"),\n        legend.title = element_text(size = 5 * 1.5, color = \"black\"),\n        plot.title = element_text(\n          face = \"bold\", size = 5 * 1.5, hjust = 0.5, \n          margin = margin(t = 4, b = 5), color = \"black\"),\n        plot.background = element_rect(fill = \"#FFFFFF\", color = \"#FFFFFF\"),\n        panel.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        legend.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        plot.margin = unit(c(1.5, 1.5, 1.5, 1.5), \"cm\")) +\n  labs(x = NULL, y = NULL, title = \"Africa Map\")\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Africa Map",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Africa Map"
    ]
  },
  {
    "objectID": "Hiplot/048-dumbbell.html",
    "href": "Hiplot/048-dumbbell.html",
    "title": "Dumbbell Chart",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Dumbbell Chart plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/dumbbell?lang=en\nDumbbell Chart can display the data change.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Dumbbell Chart"
    ]
  },
  {
    "objectID": "Hiplot/048-dumbbell.html#setup",
    "href": "Hiplot/048-dumbbell.html#setup",
    "title": "Dumbbell Chart",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2; ggalt\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"ggalt\", quietly = TRUE)) {\n  remotes::install_github(\"hrbrmstr/ggalt\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(ggalt)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Dumbbell Chart"
    ]
  },
  {
    "objectID": "Hiplot/048-dumbbell.html#data-preparation",
    "href": "Hiplot/048-dumbbell.html#data-preparation",
    "title": "Dumbbell Chart",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/dumbbell/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# View data\nhead(data)\n\n    country  y1952  y2007\n1 Argentina 62.485 75.320\n2   Bolivia 40.414 65.554\n3    Brazil 50.917 72.390\n4    Canada 68.750 80.653\n5     Chile 54.745 78.553\n6  Colombia 50.643 72.889",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Dumbbell Chart"
    ]
  },
  {
    "objectID": "Hiplot/048-dumbbell.html#visualization",
    "href": "Hiplot/048-dumbbell.html#visualization",
    "title": "Dumbbell Chart",
    "section": "Visualization",
    "text": "Visualization\n\n# Dumbbell Chart\ncolors &lt;- c(\"#3B4992FF\",\"#EE0000FF\")\np &lt;- ggplot(data, aes(y = reorder(country, y1952), x = y1952, xend = y2007)) +\n  geom_dumbbell(size = 1, size_x = 3,  size_xend = 3, colour = \"#AFAFAF\",  \n                colour_x = colors[1],  colour_xend = colors[2]) +\n  labs(title = \"Dummbbell Chart\", x = \"Life Expectancy (years)\",\n       y = \"country\") +\n  theme_minimal() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Dumbbell Chart",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Dumbbell Chart"
    ]
  },
  {
    "objectID": "Hiplot/045-donut.html",
    "href": "Hiplot/045-donut.html",
    "title": "Donut",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Donut plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/donut?lang=en\nThe donut is a variant of the pie chart, with a blank center allowing for additional information about the data as a whole to be included. Doughnut charts are similar to pie charts in that their aim is to illustrate proportions.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Donut"
    ]
  },
  {
    "objectID": "Hiplot/045-donut.html#setup",
    "href": "Hiplot/045-donut.html#setup",
    "title": "Donut",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Donut"
    ]
  },
  {
    "objectID": "Hiplot/045-donut.html#data-preparation",
    "href": "Hiplot/045-donut.html#data-preparation",
    "title": "Donut",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data are different groups and their data.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/donut/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# convert data structure\ndata$fraction &lt;- data[, 2] / sum(data[, 2])\ndata$ymax &lt;- cumsum(data$fraction)\ndata$ymin &lt;- c(0, head(data$ymax, n = -1))\ndata$labelPosition &lt;- (data$ymax + data$ymin) / 2\ndata$label &lt;- paste0(data[, 1], \"\\n\",\n  \"(\", data[, 2], \", \", sprintf(\"%2.2f%%\", 100 * data[, 2] / sum(data[, 2])), \")\",\n  sep = \"\"\n)\n\n# View data\nhead(data)\n\n   group value  fraction      ymax      ymin labelPosition                label\n1 Group1    13 0.1171171 0.1171171 0.0000000    0.05855856 Group1\\n(13, 11.71%)\n2 Group2    34 0.3063063 0.4234234 0.1171171    0.27027027 Group2\\n(34, 30.63%)\n3 Group3    21 0.1891892 0.6126126 0.4234234    0.51801802 Group3\\n(21, 18.92%)\n4 Group4    43 0.3873874 1.0000000 0.6126126    0.80630631 Group4\\n(43, 38.74%)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Donut"
    ]
  },
  {
    "objectID": "Hiplot/045-donut.html#visualization",
    "href": "Hiplot/045-donut.html#visualization",
    "title": "Donut",
    "section": "Visualization",
    "text": "Visualization\n\n# Donut\np &lt;- ggplot(data, aes_(ymax = as.name(\"ymax\"), ymin = as.name(\"ymin\"), \n                       xmax = 4, xmin = 3, fill = as.name(colnames(data)[1]))) +\n  geom_rect() +\n  geom_text(x = 5 + (4 - 5) / 3,\n            aes(y = labelPosition, label = label), size = 4) +\n  coord_polar(theta = \"y\") +\n  xlim(c(2, 5)) +\n  scale_fill_manual(values = c(\"#00468BCC\",\"#ED0000CC\",\"#42B540CC\",\"#0099B4CC\")) +\n  ggtitle(\"Donut Plot\") +\n  theme_void() +\n  theme(plot.title = element_text(hjust = 0.5),\n        legend.position = \"none\")\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Donut\n\n\n\n\n\nDifferent colors represent different groups and different areas represent data and proportion.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Donut"
    ]
  },
  {
    "objectID": "Hiplot/095-line.html",
    "href": "Hiplot/095-line.html",
    "title": "Line",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Line plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/line?lang=en\nThe line chart is a statistical chart that USES a linear or logarithmic scale to draw data in a two - or three-dimensional view to show the data set or track the characteristics of the data over time.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Line"
    ]
  },
  {
    "objectID": "Hiplot/095-line.html#setup",
    "href": "Hiplot/095-line.html#setup",
    "title": "Line",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2; ggthemes\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"ggthemes\", quietly = TRUE)) {\n  install.packages(\"ggthemes\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(ggthemes)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Line"
    ]
  },
  {
    "objectID": "Hiplot/095-line.html#data-preparation",
    "href": "Hiplot/095-line.html#data-preparation",
    "title": "Line",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data are the horizontal axis values and their corresponding vertical axis values and groups.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/line/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\ndata[,3] &lt;- factor(data[,3], levels = unique(data[,3]))\n\n# View data\nhead(data)\n\n  Value1 Value2  Group\n1      1      1 treat1\n2      2      4 treat1\n3      3      9 treat1\n4      4     16 treat1\n5      5     25 treat1\n6      6     36 treat1",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Line"
    ]
  },
  {
    "objectID": "Hiplot/095-line.html#visualization",
    "href": "Hiplot/095-line.html#visualization",
    "title": "Line",
    "section": "Visualization",
    "text": "Visualization\n\n# Line\np &lt;- ggplot(data, aes(x = Value1, y = Value2)) +\n  geom_line(alpha = 1, aes(color = Group, linetype = Group)) +\n  geom_point(aes(color = Group, shape = Group)) +\n  ggtitle(\"Line Regression Plot\") +\n  scale_fill_manual(values = c(\"#e04d39\",\"#5bbad6\")) +\n  theme_stata() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Line\n\n\n\n\n\nThe diagram shows that value1 is positively correlated with Value2 in treatment plan 1, while Value1 is negatively correlated with Value2 in treatment plan 2.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Line"
    ]
  },
  {
    "objectID": "Hiplot/113-map-uk.html",
    "href": "Hiplot/113-map-uk.html",
    "title": "UK Map",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot UK Map plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/map-uk?lang=en",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "South America Map"
    ]
  },
  {
    "objectID": "Hiplot/113-map-uk.html#setup",
    "href": "Hiplot/113-map-uk.html#setup",
    "title": "UK Map",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2; RColorBrewer\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(RColorBrewer)",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "South America Map"
    ]
  },
  {
    "objectID": "Hiplot/113-map-uk.html#data-preparation",
    "href": "Hiplot/113-map-uk.html#data-preparation",
    "title": "UK Map",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/map-uk/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\ndt_map &lt;- readRDS(url(\"https://download.hiplot.cn/ui/basic/map-uk/uk.rds\"))\n\n# Convert data structure\ndt_map$Value &lt;- data$value[match(dt_map$name, data$name)]\n\n# View data\nhead(data)\n\n              name value\n1 Northern Ireland   691\n2         Scotland   455\n3          England   530\n4            Wales   767",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "South America Map"
    ]
  },
  {
    "objectID": "Hiplot/113-map-uk.html#visualization",
    "href": "Hiplot/113-map-uk.html#visualization",
    "title": "UK Map",
    "section": "Visualization",
    "text": "Visualization\n\n# UK Map\np &lt;- ggplot(dt_map) +\n  geom_polygon(aes(x = long, y = lat, group = group, fill = Value),\n               alpha = 0.9, size = 0.5) +\n  geom_path(aes(x = long, y = lat, group = group), color = \"black\", size = 0.2) +\n  coord_fixed() +\n  scale_fill_gradientn(\n    colours = colorRampPalette(rev(brewer.pal(11,\"RdYlBu\")))(500),\n    breaks = seq(min(data$value), max(data$value), \n                 round((max(data$value)-min(data$value))/7)),\n    name = \"Color Key\",\n    guide = guide_legend(\n      direction = \"vertical\", keyheight = unit(1, units = \"mm\"),\n      keywidth = unit(8, units = \"mm\"),\n      title.position = \"top\", title.hjust = 0.5, label.hjust = 0.5,\n      nrow = 1, byrow = T, reverse = F, label.position = \"bottom\")) +\n  theme(text = element_text(color = \"#3A3F4A\"),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank(),\n        legend.position = \"top\",\n        legend.text = element_text(size = 4 * 1.5, color = \"black\"),\n        legend.title = element_text(size = 5 * 1.5, color = \"black\"),\n        plot.title = element_text(\n          face = \"bold\", size = 5 * 1.5, hjust = 0.5, \n          margin = margin(t = 4, b = 5), color = \"black\"),\n        plot.background = element_rect(fill = \"#FFFFFF\", color = \"#FFFFFF\"),\n        panel.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        legend.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        plot.margin = unit(c(1.5, 1.5, 1.5, 1.5), \"cm\")) +\n  labs(x = NULL, y = NULL, title = \"UK Map\")\n\np\n\n\n\n\n\n\n\nFigureÂ 1: UK Map",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "South America Map"
    ]
  },
  {
    "objectID": "Hiplot/114-map-usa-county.html",
    "href": "Hiplot/114-map-usa-county.html",
    "title": "USA Map (County)",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot USA Map (County) plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/map-usa-county?lang=en",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Oceania/Antarc Map"
    ]
  },
  {
    "objectID": "Hiplot/114-map-usa-county.html#setup",
    "href": "Hiplot/114-map-usa-county.html#setup",
    "title": "USA Map (County)",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2; RColorBrewer\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(RColorBrewer)",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Oceania/Antarc Map"
    ]
  },
  {
    "objectID": "Hiplot/114-map-usa-county.html#data-preparation",
    "href": "Hiplot/114-map-usa-county.html#data-preparation",
    "title": "USA Map (County)",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/map-usa-county/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\ndt_map &lt;- readRDS(url(\"https://download.hiplot.cn/ui/basic/map-usa-county/usa.county.rds\"))\n\n# Convert data structure\ndt_map$Value &lt;- data$value[match(dt_map$county, data$name)]\n\n# View data\nhead(data)\n\n               name value\n1 Lake of the Woods   167\n2             Ferry   801\n3           Stevens   785\n4          Okanogan   783\n5      Pend Oreille   796\n6          Boundary   126",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Oceania/Antarc Map"
    ]
  },
  {
    "objectID": "Hiplot/114-map-usa-county.html#visualization",
    "href": "Hiplot/114-map-usa-county.html#visualization",
    "title": "USA Map (County)",
    "section": "Visualization",
    "text": "Visualization\n\n# USA Map (County)\np &lt;- ggplot(dt_map) +\n  geom_polygon(aes(x = long, y = lat, group = group, fill = Value),\n               alpha = 0.9, size = 0.5) +\n  geom_path(aes(x = long, y = lat, group = group), color = \"black\", size = 0.2) +\n  coord_fixed() +\n  scale_fill_gradientn(\n    colours = colorRampPalette(rev(brewer.pal(11,\"RdYlBu\")))(500),\n    breaks = seq(min(data$value), max(data$value), \n                 round((max(data$value)-min(data$value))/7)),\n    name = \"Color Key\",\n    guide = guide_legend(\n      direction = \"vertical\", keyheight = unit(1, units = \"mm\"),\n      keywidth = unit(8, units = \"mm\"),\n      title.position = \"top\", title.hjust = 0.5, label.hjust = 0.5,\n      nrow = 1, byrow = T, reverse = F, label.position = \"bottom\")) +\n  theme(text = element_text(color = \"#3A3F4A\"),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank(),\n        legend.position = \"top\",\n        legend.text = element_text(size = 4 * 1.5, color = \"black\"),\n        legend.title = element_text(size = 5 * 1.5, color = \"black\"),\n        plot.title = element_text(\n          face = \"bold\", size = 5 * 1.5, hjust = 0.5, \n          margin = margin(t = 4, b = 5), color = \"black\"),\n        plot.background = element_rect(fill = \"#FFFFFF\", color = \"#FFFFFF\"),\n        panel.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        legend.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        plot.margin = unit(c(1.5, 1.5, 1.5, 1.5), \"cm\")) +\n  labs(x = NULL, y = NULL, title = \"USA County Map\")\n\np\n\n\n\n\n\n\n\nFigureÂ 1: USA Map (County)",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Oceania/Antarc Map"
    ]
  },
  {
    "objectID": "Hiplot/065-ggdag.html",
    "href": "Hiplot/065-ggdag.html",
    "title": "Directed Acyclic Graphs",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Directed Acyclic Graphs plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/ggdag?lang=en\nVisualizing directed acyclic graphs.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Directed Acyclic Graphs"
    ]
  },
  {
    "objectID": "Hiplot/065-ggdag.html#setup",
    "href": "Hiplot/065-ggdag.html#setup",
    "title": "Directed Acyclic Graphs",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: ggdag\n\n\n# Install packages\nif (!requireNamespace(\"ggdag\", quietly = TRUE)) {\n  install.packages(\"ggdag\")\n}\n\n# Load packages\nlibrary(ggdag)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Directed Acyclic Graphs"
    ]
  },
  {
    "objectID": "Hiplot/065-ggdag.html#data-preparation",
    "href": "Hiplot/065-ggdag.html#data-preparation",
    "title": "Directed Acyclic Graphs",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ntidy_ggdag &lt;- dagify(\n  y ~ x + z2 + w2 + w1,\n  x ~ z1 + w1 + w2,\n  z1 ~ w1 + v,\n  z2 ~ w2 + v,\n  w1 ~ ~w2, # bidirected path\n  exposure = \"x\",\n  outcome = \"y\") %&gt;%\n  tidy_dagitty()\n\n# View data\nhead(tidy_ggdag)\n\n$data\n# A tibble: 13 Ã— 8\n   name       x       y direction to      xend   yend circular\n   &lt;chr&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;fct&gt;     &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;lgl&gt;   \n 1 v     -1.51   0.0360 -&gt;        z1    -0.480  1.01  FALSE   \n 2 v     -1.51   0.0360 -&gt;        z2    -0.544 -0.993 FALSE   \n 3 w1     0.343  0.474  -&gt;        x      0.964  0.553 FALSE   \n 4 w1     0.343  0.474  -&gt;        y      0.305 -0.463 FALSE   \n 5 w1     0.343  0.474  -&gt;        z1    -0.480  1.01  FALSE   \n 6 w1     0.343  0.474  &lt;-&gt;       w2     0.918 -0.616 FALSE   \n 7 w2     0.918 -0.616  -&gt;        x      0.964  0.553 FALSE   \n 8 w2     0.918 -0.616  -&gt;        y      0.305 -0.463 FALSE   \n 9 w2     0.918 -0.616  -&gt;        z2    -0.544 -0.993 FALSE   \n10 x      0.964  0.553  -&gt;        y      0.305 -0.463 FALSE   \n11 y      0.305 -0.463  &lt;NA&gt;      &lt;NA&gt;  NA     NA     FALSE   \n12 z1    -0.480  1.01   -&gt;        x      0.964  0.553 FALSE   \n13 z2    -0.544 -0.993  -&gt;        y      0.305 -0.463 FALSE   \n\n$dag\ndag {\nv\nw1\nw2\nx [exposure]\ny [outcome]\nz1\nz2\nv -&gt; z1\nv -&gt; z2\nw1 -&gt; x\nw1 -&gt; y\nw1 -&gt; z1\nw1 &lt;-&gt; w2\nw2 -&gt; x\nw2 -&gt; y\nw2 -&gt; z2\nx -&gt; y\nz1 -&gt; x\nz2 -&gt; y\n}",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Directed Acyclic Graphs"
    ]
  },
  {
    "objectID": "Hiplot/065-ggdag.html#visualization",
    "href": "Hiplot/065-ggdag.html#visualization",
    "title": "Directed Acyclic Graphs",
    "section": "Visualization",
    "text": "Visualization\n\n# Directed Acyclic Graphs\np &lt;- ggdag(tidy_ggdag) +\n  theme_dag() \n\np\n\n\n\n\n\n\n\nFigureÂ 1: Directed Acyclic Graphs",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Directed Acyclic Graphs"
    ]
  },
  {
    "objectID": "Hiplot/130-nomogram-logistic.html",
    "href": "Hiplot/130-nomogram-logistic.html",
    "title": "Nomogram (Logistic)",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Nomogram (Logistic) plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/nomogram-logistic?lang=en",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Nomogram (Logistic)"
    ]
  },
  {
    "objectID": "Hiplot/130-nomogram-logistic.html#setup",
    "href": "Hiplot/130-nomogram-logistic.html#setup",
    "title": "Nomogram (Logistic)",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; rms; ggplotify\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"rms\", quietly = TRUE)) {\n  install.packages(\"rms\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(rms)\nlibrary(ggplotify)",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Nomogram (Logistic)"
    ]
  },
  {
    "objectID": "Hiplot/130-nomogram-logistic.html#data-preparation",
    "href": "Hiplot/130-nomogram-logistic.html#data-preparation",
    "title": "Nomogram (Logistic)",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/nomogram-logistic/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\ndd &lt;- datadist(data)\noptions(datadist = \"dd\")\n## Build Logistic model and run nomogram\nlogistic_res &lt;- lrm(data=data, as.formula(paste(\n    colnames(data)[1], \" ~ \",\n    paste(colnames(data)[2:length(colnames(data))],\n      collapse = \"+\"\n    )\n  ))\n)\nlogistic_nomo &lt;- nomogram(logistic_res, maxscale = 100,\n  fun= function(x)1/(1+exp(-x)), lp=F, funlabel=\"Dead Risk\",\n  fun.at=c(.001,.01,.05,seq(.1,.9,by=.1),.95,.99,.999)\n)\n\n# View data\nhead(data)\n\n  status age sex ph.ecog ph.karno pat.karno meal.cal wt.loss\n1      2  74   1       1       90       100     1175      NA\n2      2  68   1       0       90        90     1225      15\n3      1  56   1       0       90        90       NA      15\n4      2  57   1       1       90        60     1150      11\n5      2  60   1       0      100        90       NA       0\n6      1  74   1       1       50        80      513       0",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Nomogram (Logistic)"
    ]
  },
  {
    "objectID": "Hiplot/130-nomogram-logistic.html#visualization",
    "href": "Hiplot/130-nomogram-logistic.html#visualization",
    "title": "Nomogram (Logistic)",
    "section": "Visualization",
    "text": "Visualization\n\n# Nomogram (Logistic)\np &lt;- as.ggplot(function() {\n  plot(logistic_nomo,\n    scale = 1\n  )\n  title(main = \"Nomogram (Logistic)\")\n})\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Nomogram (Logistic)",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Nomogram (Logistic)"
    ]
  },
  {
    "objectID": "Hiplot/046-dotchart.html",
    "href": "Hiplot/046-dotchart.html",
    "title": "Dotchart",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Dotchart plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/dotchart?lang=en\nSliding bead chart is a graph of beads sliding on a column. It is the superposition of bar chart and scatter chart.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Dotchart"
    ]
  },
  {
    "objectID": "Hiplot/046-dotchart.html#setup",
    "href": "Hiplot/046-dotchart.html#setup",
    "title": "Dotchart",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggpubr\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggpubr\", quietly = TRUE)) {\n  install.packages(\"ggpubr\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggpubr)",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Dotchart"
    ]
  },
  {
    "objectID": "Hiplot/046-dotchart.html#data-preparation",
    "href": "Hiplot/046-dotchart.html#data-preparation",
    "title": "Dotchart",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data are gene names and their corresponding gene expression values and groups.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/dotchart/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# View data\nhead(data)\n\n      Name Value  Group\n1     BMP2  18.7 Group1\n2     XIST  14.3 Group1\n3 C19orf38  16.4 Group1\n4    PDZD3  17.3 Group1\n5   MAPRE2  15.2 Group1\n6     IRF4  10.4 Group1",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Dotchart"
    ]
  },
  {
    "objectID": "Hiplot/046-dotchart.html#visualization",
    "href": "Hiplot/046-dotchart.html#visualization",
    "title": "Dotchart",
    "section": "Visualization",
    "text": "Visualization\n\n# Dotchart\np &lt;- ggdotchart(data, x = \"Name\", y = \"Value\", group = \"Group\", color = \"Group\",\n                rotate = T, sorting = \"descending\",\n                y.text.col = F, add = \"segments\", dot.size = 2) +\n  xlab(\"Name\") +\n  ylab(\"Value\") +\n  ggtitle(\"DotChart Plot\") +\n  scale_color_manual(values = c(\"#e04d39\",\"#5bbad6\",\"#1e9f86\")) +\n  theme_classic() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Dotchart\n\n\n\n\n\nEach color represents a different grouping, so that the differences in gene expression values can be intuitively understood.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Dotchart"
    ]
  },
  {
    "objectID": "Hiplot/169-survival.html",
    "href": "Hiplot/169-survival.html",
    "title": "Survival Analysis",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Survival Analysis plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/survival?lang=en\nThe survivorship curve is a graph showing the number or proportion of individuals surviving to each age for a given species or group (e.g.Â males or females).",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Survival Analysis"
    ]
  },
  {
    "objectID": "Hiplot/169-survival.html#setup",
    "href": "Hiplot/169-survival.html#setup",
    "title": "Survival Analysis",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; survminer; survival; ggplotify\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"survminer\", quietly = TRUE)) {\n  install.packages(\"survminer\")\n}\nif (!requireNamespace(\"survival\", quietly = TRUE)) {\n  install.packages(\"survival\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(survminer)\nlibrary(survival)\nlibrary(ggplotify)",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Survival Analysis"
    ]
  },
  {
    "objectID": "Hiplot/169-survival.html#data-preparation",
    "href": "Hiplot/169-survival.html#data-preparation",
    "title": "Survival Analysis",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data are point-in-time, status and groups.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/survival/data.json\")$exampleData[[1]]$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# convert data structure\ncolnames(data) &lt;- c(\"Time\", \"Status\", \"Group\")\ndata[,1] &lt;- as.numeric(data[,1])\nfit &lt;- survfit(Surv(Time, Status == 1) ~ Group, data = data)\ndata &lt;- data[data[,1] &lt; 1100,]\n\n# View data\nhead(data)\n\n  Time Status Group\n1  306      1    G1\n2  455      1    G1\n3 1010      0    G1\n4  210      1    G1\n5  883      1    G1\n6 1022      0    G1",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Survival Analysis"
    ]
  },
  {
    "objectID": "Hiplot/169-survival.html#visualization",
    "href": "Hiplot/169-survival.html#visualization",
    "title": "Survival Analysis",
    "section": "Visualization",
    "text": "Visualization\n\n# Survival Analysis\np &lt;- ggsurvplot(\n  fit, data = data, risk.table = T, pval = T, conf.int = T, fun = \"pct\", \n  size = 0.5, xlab = \"Time\", ylab = \"Survival probability\",\n  ggtheme = theme_bw(), risk.table.y.text.col = TRUE,\n  risk.table.height = 0.25, risk.table.y.text = T,\n  ncensor.plot = T, ncensor.plot.height = 0.25,\n  conf.int.style = \"ribbon\", surv.median.line = \"hv\",\n  palette = c(\"#00468BFF\", \"#ED0000FF\"),\n  xlim = c(0, 1100), ylim = c(0, 100),\n  break.x.by = 150)\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Survival Analysis\n\n\n\n\n\nThe horizontal axis represents time and the vertical axis represents the probability of survival. The blue curve represents the survivolship curve of G1 group and the red curve represents the survivolship curve of G2 group. After logrank test, p value =0.0013&lt;0.05 indicates that difference in survival status between the two groups could not be explained by sampling error, and the grouping factor is the reason for the difference in survival rate between the two curves. This graph shows that overall survival is better in G2 than in G1.",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Survival Analysis"
    ]
  },
  {
    "objectID": "Hiplot/033-corrplot.html",
    "href": "Hiplot/033-corrplot.html",
    "title": "Corrplot",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Corrplot plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/corrplot?lang=en\nThe correlation heat map is a graph that analyzes the correlation between two or more variables.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Corrplot"
    ]
  },
  {
    "objectID": "Hiplot/033-corrplot.html#setup",
    "href": "Hiplot/033-corrplot.html#setup",
    "title": "Corrplot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; corrplot; ggcorrplot; ggplotify\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"corrplot\", quietly = TRUE)) {\n  install.packages(\"corrplot\")\n}\nif (!requireNamespace(\"ggcorrplot\", quietly = TRUE)) {\n  install.packages(\"ggcorrplot\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(corrplot)\nlibrary(ggcorrplot)\nlibrary(ggplotify)",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Corrplot"
    ]
  },
  {
    "objectID": "Hiplot/033-corrplot.html#data-preparation",
    "href": "Hiplot/033-corrplot.html#data-preparation",
    "title": "Corrplot",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data are the gene names and the expression of each sample.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/corrplot/data.json\")$exampleData[[1]]$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# convert data structure\ndata &lt;- data[!is.na(data[, 1]), ]\nidx &lt;- duplicated(data[, 1])\ndata[idx, 1] &lt;- paste0(data[idx, 1], \"--dup-\", cumsum(idx)[idx])\nrownames(data) &lt;- data[, 1]\ndata &lt;- data[, -1]\nstr2num_df &lt;- function(x) {\n  final &lt;- NULL\n  for (i in seq_len(ncol(x))) {\n    final &lt;- cbind(final, as.numeric(x[, i]))\n  }\n  colnames(final) &lt;- colnames(x)\n  return(final)\n}\ntmp &lt;- str2num_df(t(data))\ncorr &lt;- round(cor(tmp, use = \"na.or.complete\", method = \"pearson\"), 3)\np_mat &lt;- round(cor_pmat(tmp, method = \"pearson\"), 3)\n\n# View data\nhead(data)\n\n             M1       M2       M3       M4       M5       M6        M7       M8\nRGL4   8.454808 8.019389 8.990836 9.718631 7.908075 4.147051  4.985084 4.576711\nMPP7   8.690520 8.630346 7.080873 9.838476 8.271824 5.179200  5.200868 3.266993\nUGCG   8.648366 8.600555 9.431046 7.923021 8.309214 4.902510  5.750804 4.492856\nCYSTM1 8.628884 9.238677 8.487243 8.958537 7.357109 4.541605  6.370533 4.246651\nANXA2  4.983769 6.748022 6.220791 4.719403 3.284346 8.089850 10.637472 7.214912\nENDOD1 5.551640 5.406465 4.663785 3.550765 4.103507 8.393991  9.538503 9.069923\n             M9      M10\nRGL4   4.930349 4.293700\nMPP7   5.565226 4.300309\nUGCG   4.659987 3.306275\nCYSTM1 4.745769 3.449627\nANXA2  9.002710 5.123359\nENDOD1 8.639664 7.106392",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Corrplot"
    ]
  },
  {
    "objectID": "Hiplot/033-corrplot.html#visualization",
    "href": "Hiplot/033-corrplot.html#visualization",
    "title": "Corrplot",
    "section": "Visualization",
    "text": "Visualization\n\n# Corrplot\np &lt;- as.ggplot(function(){\n  corrplot(\n    corr, \n    method = \"circle\", \n    type = \"upper\",\n    tl.col = \"black\", \n    diag = F,\n    col = colorRampPalette(c(\"#4477AA\", \"#FFFFFF\", \"#BB4444\"))(200),\n    order = \"hclust\",\n    hclust.method = \"ward.D2\")\n  }) +\n  xlab(\"\") + ylab(\"\") +\n  ggtitle(\"Cor Heatmap Plot\") +\n  theme_void() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_blank(), axis.text.y = element_blank(),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\np\n\n\n\n\n\n\n\nFigureÂ 1: Corrplot\n\n\n\n\n\nRed indicates positive correlation between two genes, blue indicates negative correlation between two genes, and the number in each cell indicates correlation coefficient.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Corrplot"
    ]
  },
  {
    "objectID": "Hiplot/084-group-line.html",
    "href": "Hiplot/084-group-line.html",
    "title": "Group Line",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Group Line plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/group-line?lang=en",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Group Line"
    ]
  },
  {
    "objectID": "Hiplot/084-group-line.html#setup",
    "href": "Hiplot/084-group-line.html#setup",
    "title": "Group Line",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Group Line"
    ]
  },
  {
    "objectID": "Hiplot/084-group-line.html#data-preparation",
    "href": "Hiplot/084-group-line.html#data-preparation",
    "title": "Group Line",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/group-line/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# View data\nhead(data)\n\n  x        y names groups\n1 1 2.253573    L1      A\n2 2 2.231082    L1      A\n3 3 1.740380    L1      A\n4 4 2.255786    L1      A\n5 5 2.429561    L1      A\n6 6 1.951557    L1      A",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Group Line"
    ]
  },
  {
    "objectID": "Hiplot/084-group-line.html#visualization",
    "href": "Hiplot/084-group-line.html#visualization",
    "title": "Group Line",
    "section": "Visualization",
    "text": "Visualization\n\n# Group Line\np &lt;- ggplot(data, aes(x = x, y = y, group = names, color = groups)) +\n  geom_line() +\n  geom_point() +\n  scale_color_manual(values = c(\"#e04d39\",\"#5bbad6\")) +\n  theme_bw()\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Group Line",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Group Line"
    ]
  },
  {
    "objectID": "Hiplot/062-gene-trend.html",
    "href": "Hiplot/062-gene-trend.html",
    "title": "Gene Cluster Trend",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Gene Cluster Trend plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/gene-trend?lang=en\nThe gene cluster trend is used to display different gene expression trend with multiple lines showing the similar expression patterns in each cluster.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Gene Cluster Trend"
    ]
  },
  {
    "objectID": "Hiplot/062-gene-trend.html#setup",
    "href": "Hiplot/062-gene-trend.html#setup",
    "title": "Gene Cluster Trend",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; Mfuzz; ggplotify; RColorBrewer\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"Mfuzz\", quietly = TRUE)) {\n  remotes::install_github(\"MatthiasFutschik/Mfuzz\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(Mfuzz)\nlibrary(ggplotify)\nlibrary(RColorBrewer)",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Gene Cluster Trend"
    ]
  },
  {
    "objectID": "Hiplot/062-gene-trend.html#data-preparation",
    "href": "Hiplot/062-gene-trend.html#data-preparation",
    "title": "Gene Cluster Trend",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data are a gene expression matrix with each row represent a gene and each column represent a time-point sample.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/gene-trend/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\n## Convert a gene expression matrix to an ExpressionSet object\nrow.names(data) &lt;- data[,1]\ndata &lt;- data[,-1]\ndata &lt;- as.matrix(data)\neset &lt;- new(\"ExpressionSet\", exprs = data)\n## Filter genes with more than 25% missing values\neset &lt;- filter.NA(eset, thres=0.25)\n\n0 genes excluded.\n\n## Remove genes with small differences between samples based on standard deviation\neset &lt;- filter.std(eset, min.std=0, visu = F)\n\n0 genes excluded.\n\n## Data Standardization\neset &lt;- standardise(eset)\n## Set the number of clusters\nc &lt;- 6\n## Evaluate the optimal m value\nm &lt;- mestimate(eset)\n## Perform mfuzz clustering\ncl &lt;- mfuzz(eset, c = c, m = m)\n\n# View data\nhead(data)\n\n           Time1      Time2       Time3\nGene1  0.1774993  1.6563226 -1.15259948\nGene2 -0.5037254 -0.5207024  0.46416071\nGene3  0.1050310  0.6079246  0.72893247\nGene4 -1.1791537  0.4340085  0.41061745\nGene5  0.8368975 -0.7047414 -1.46114720\nGene6  0.2611762  0.1351524 -0.01890809",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Gene Cluster Trend"
    ]
  },
  {
    "objectID": "Hiplot/062-gene-trend.html#visualization",
    "href": "Hiplot/062-gene-trend.html#visualization",
    "title": "Gene Cluster Trend",
    "section": "Visualization",
    "text": "Visualization\n\n# Gene Cluster Trend\np &lt;- as.ggplot(function(){\n  mfuzz.plot2(\n  eset,\n  cl,\n  xlab = \"Time\",\n  ylab = \"Expression changes\",\n  mfrow = c(2,(c/2+0.5)),\n  colo = \"fancy\",\n  centre = T,\n  centre.col = \"red\",\n  time.labels = colnames(eset),\n  x11=F)\n  })\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Gene Cluster Trend\n\n\n\n\n\nAs shown in the example figure, the genes are clustered into different groups, with each group showing similar expression patterns across different time-points. The average expression trend is highlighted in each cluster.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Gene Cluster Trend"
    ]
  },
  {
    "objectID": "Hiplot/060-gene-density.html",
    "href": "Hiplot/060-gene-density.html",
    "title": "Gene Density",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Gene Density plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/gene-density?lang=en\nChrosome data visualization.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Gene Density"
    ]
  },
  {
    "objectID": "Hiplot/060-gene-density.html#setup",
    "href": "Hiplot/060-gene-density.html#setup",
    "title": "Gene Density",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; circlize; ComplexHeatmap; gtrellis; tidyverse; ggplotify; RColorBrewer\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"circlize\", quietly = TRUE)) {\n  install.packages(\"circlize\")\n}\nif (!requireNamespace(\"ComplexHeatmap\", quietly = TRUE)) {\n  BiocManager::install(\"ComplexHeatmap\")\n}\nif (!requireNamespace(\"gtrellis\", quietly = TRUE)) {\n  remotes::install_github(\"jokergoo/gtrellis\")\n}\nif (!requireNamespace(\"tidyverse\", quietly = TRUE)) {\n  install.packages(\"tidyverse\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(circlize)\nlibrary(ComplexHeatmap)\nlibrary(gtrellis)\nlibrary(tidyverse)\nlibrary(ggplotify)\nlibrary(RColorBrewer)",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Gene Density"
    ]
  },
  {
    "objectID": "Hiplot/060-gene-density.html#data-preparation",
    "href": "Hiplot/060-gene-density.html#data-preparation",
    "title": "Gene Density",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata1 &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/gene-density/data.json\")$exampleData$textarea[[1]])\ndata1 &lt;- as.data.frame(data1)\ndata2 &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/gene-density/data.json\")$exampleData$textarea[[2]])\ndata2 &lt;- as.data.frame(data2)\n\n# Convert data structure\nchrNum &lt;- str_replace(unique(data1$chr), \"Chr|chr\", \"\")\ndata1$chr &lt;- factor(data1$chr, levels = paste0(\"Chr\", chrNum))\ndata2$chr &lt;- factor(data2$chr, levels = paste0(\"Chr\", chrNum))\n# Set window to calculate gene density\nwindows &lt;- 100 * 1000 # default:100kb window size\ngene_density &lt;- genomicDensity(data2, window.size = windows)\ngene_density$chr &lt;- factor(gene_density$chr,\n  levels =  paste0(\"Chr\", chrNum)\n)\n\n# View data\nhead(data1)\n\n    chr start      end\n1  Chr5     0 29958434\n2  Chr8     0 28443022\n3  Chr9     0 23012720\n4 Chr10     0 23207287\n5 Chr12     0 27531856\n\nhead(data2)\n\n    chr start   end\n1 Chr10 38648 40060\n2 Chr10 45941 58338\n3 Chr10 67119 72971\n4 Chr10 75410 76305\n5 Chr10 80964 82250\n6 Chr10 94798 97746",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Gene Density"
    ]
  },
  {
    "objectID": "Hiplot/060-gene-density.html#visualization",
    "href": "Hiplot/060-gene-density.html#visualization",
    "title": "Gene Density",
    "section": "Visualization",
    "text": "Visualization\n\n# Set the palettes\npalettes &lt;- c(\"#B2182B\",\"#EF8A62\",\"#FDDBC7\",\"#D1E5F0\",\"#67A9CF\",\"#2166AC\")\ncol_fun &lt;- colorRamp2(\n  seq(0, max(gene_density[[4]]), length = 6), rev(palettes)\n  )\ncm &lt;- ColorMapping(col_fun = col_fun)\n# Set the Legend\nlgd &lt;- color_mapping_legend(\n  cm, plot = F, title = \"density\", color_bar = \"continuous\"\n  )\n# Plot\np &lt;- as.ggplot(function() {\n  gtrellis_layout(\n    data1, n_track = 2, ncol = 1, byrow = FALSE,\n    track_axis = FALSE, add_name_track = FALSE,\n    xpadding = c(0.1, 0), gap = unit(1, \"mm\"),\n    track_height = unit.c(unit(1, \"null\"), unit(4, \"mm\")),\n    track_ylim = c(0, max(gene_density[[4]]), 0, 1),\n    border = FALSE, asist_ticks = FALSE,\n    legend = lgd\n    )\n  # Add gene area map track\n  add_lines_track(gene_density, gene_density[[4]],\n                  area = TRUE, gp = gpar(fill = \"pink\"))\n  # Add gene density heatmap track\n  add_heatmap_track(gene_density, gene_density[[4]], fill = col_fun)\n  add_track(track = 2, clip = FALSE, panel_fun = function(gr) {\n    chr &lt;- get_cell_meta_data(\"name\")\n    if (chr == paste(\"Chr\", length(chrNum), sep = \"\")) {\n      grid.lines(get_cell_meta_data(\"xlim\"), unit(c(0, 0), \"npc\"),\n                 default.units = \"native\")\n      }\n    grid.text(chr, x = 0.01, y = 0.38, just = c(\"left\", \"bottom\"))\n    })\n  circos.clear()\n  })\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Gene Density",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Gene Density"
    ]
  },
  {
    "objectID": "Hiplot/148-qqplot.html",
    "href": "Hiplot/148-qqplot.html",
    "title": "QQ Plot",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot QQ Plot plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/qqplot?lang=en\nVerify whether a set of data comes from a certain distribution or whether two sets of data come from the same (family) distribution.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "QQ Plot"
    ]
  },
  {
    "objectID": "Hiplot/148-qqplot.html#setup",
    "href": "Hiplot/148-qqplot.html#setup",
    "title": "QQ Plot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; grafify\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"grafify\", quietly = TRUE)) {\n  install.packages(\"grafify\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(grafify)",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "QQ Plot"
    ]
  },
  {
    "objectID": "Hiplot/148-qqplot.html#data-preparation",
    "href": "Hiplot/148-qqplot.html#data-preparation",
    "title": "QQ Plot",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/qqplot/data.json\")$exampleData[[1]]$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\ndata[, \"Genotype\"] &lt;- factor(data[, \"Genotype\"], levels = unique(data[, \"Genotype\"]))\n\n# View data\nhead(data)\n\n  Genotype Cytokine Experiment facet\n1       WT 1.312322     Exp_ 1     A\n2       WT 2.171466     Exp_ 2     A\n3       WT 1.497610     Exp_ 3     A\n4       WT 1.088861     Exp_ 4     A\n5       WT 1.270528     Exp_ 5     A\n6       WT 3.012708     Exp_ 6     A",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "QQ Plot"
    ]
  },
  {
    "objectID": "Hiplot/148-qqplot.html#visualization",
    "href": "Hiplot/148-qqplot.html#visualization",
    "title": "QQ Plot",
    "section": "Visualization",
    "text": "Visualization\n\n# QQ Plot\np &lt;- plot_qqline(data = data, ycol = Cytokine, group = Genotype,\n                 symsize = 2, symthick = 0.5, s_alpha = 1) +\n  ggtitle(\"QQplot without facet\") +\n  xlab(\"theoretical\") + ylab(\"sample\") + \n  guides(fill = guide_legend(title = \"Genotype\")) +\n  scale_color_manual(values = c(\"#E69F00\",\"#4DB1DC\")) +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: QQ Plot",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "QQ Plot"
    ]
  },
  {
    "objectID": "Hiplot/173-treemap.html",
    "href": "Hiplot/173-treemap.html",
    "title": "Treemap",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Treemap plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/treemap?lang=en\nTree map is a kind of tree structure diagram that graphical form to represent hierarchy structure.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Treemap"
    ]
  },
  {
    "objectID": "Hiplot/173-treemap.html#setup",
    "href": "Hiplot/173-treemap.html#setup",
    "title": "Treemap",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; treemap\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"treemap\", quietly = TRUE)) {\n  install.packages(\"treemap\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(treemap)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Treemap"
    ]
  },
  {
    "objectID": "Hiplot/173-treemap.html#data-preparation",
    "href": "Hiplot/173-treemap.html#data-preparation",
    "title": "Treemap",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data are different groups and their data.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/treemap/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# View data\nhead(data)\n\n   group value\n1 Group1    13\n2 Group2    34\n3 Group3    21\n4 Group4    43",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Treemap"
    ]
  },
  {
    "objectID": "Hiplot/173-treemap.html#visualization",
    "href": "Hiplot/173-treemap.html#visualization",
    "title": "Treemap",
    "section": "Visualization",
    "text": "Visualization\n\n# Treemap\ntreemap(data, index = colnames(data)[1], vSize = colnames(data)[2],\n        vColor = colnames(data)[1], type = \"index\", title = \"\", \n        algorithm = \"pivotSize\", sortID = colnames(data)[1], border.lwds = 1,\n        fontcolor.labels = \"#000000\", inflate.labels = F, overlap.labels = 0.5,\n        fontfamily.title = \"Arial\", fontfamily.legend = \"Arial\",\n        fontfamily.labels = \"Arial\", \n        palette = c(\"#E64B35FF\",\"#4DBBD5FF\",\"#00A087FF\",\"#3C5488FF\",\"#F39B7FFF\"), \n        aspRatio = 6 / 6)\n\n\n\n\n\n\n\nFigureÂ 1: Treemap\n\n\n\n\n\nDifferent colors represent different groups and different areas represent data and proportion.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Treemap"
    ]
  },
  {
    "objectID": "Hiplot/008-barplot-gradient.html",
    "href": "Hiplot/008-barplot-gradient.html",
    "title": "Barplot Gradient",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Barplot Gradient plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/barplot-gradient?lang=en\nIt is similar to the bubble chart, but on the basis of the histogram, a color gradient rectangle is used to simultaneously display the visualization of two variables.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Barplot Gradient"
    ]
  },
  {
    "objectID": "Hiplot/008-barplot-gradient.html#setup",
    "href": "Hiplot/008-barplot-gradient.html#setup",
    "title": "Barplot Gradient",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2; stringr\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"stringr\", quietly = TRUE)) {\n  install.packages(\"stringr\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(stringr)",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Barplot Gradient"
    ]
  },
  {
    "objectID": "Hiplot/008-barplot-gradient.html#data-preparation",
    "href": "Hiplot/008-barplot-gradient.html#data-preparation",
    "title": "Barplot Gradient",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe first column is Go Term (Go language code), the second column is the number of genes, and the third column is pvalue.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/barplot-gradient/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# convert data structure\ndata[, 1] &lt;- str_to_sentence(str_remove(data[, 1], pattern = \"\\\\w+:\\\\d+\\\\W\"))\ntopnum &lt;- 7\ndata &lt;- data[1:topnum, ]\ndata[, 1] &lt;- factor(data[, 1], level = rev(unique(data[, 1])))\n\n# View data\nhead(data)\n\n                               Term Count   PValue\n1                   Immune response    20 9.61e-08\n2     Defense response to bacterium    11 3.02e-06\n3                   Cell chemotaxis     8 5.14e-06\n4                     Cell adhesion    17 2.73e-05\n5             Complement activation     8 3.56e-05\n6 Extracellular matrix organization    11 4.23e-05",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Barplot Gradient"
    ]
  },
  {
    "objectID": "Hiplot/008-barplot-gradient.html#visualization",
    "href": "Hiplot/008-barplot-gradient.html#visualization",
    "title": "Barplot Gradient",
    "section": "Visualization",
    "text": "Visualization\n\n# Barplot Gradient\np &lt;- ggplot(data, aes(x = Term, y = Count, fill = -log10(PValue))) +\n  geom_bar(stat = \"identity\") +\n  ggtitle(\"GO BarPlot\") +\n  scale_fill_continuous(low = \"#00438E\", high = \"#E43535\") +\n  scale_x_discrete(labels = function(x) {str_wrap(x, width = 65)}) +\n  labs(fill = \"-log10 (PValue)\", y = \"Term\", x = \"Count\") +\n  coord_flip() +\n  theme_bw() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Barplot Gradient\n\n\n\n\n\nAs shown in the figure, blue is a low pvalue color, and red is a high pvalue color. As the pvalue increases, the color changes from blue to red. The abscissa indicates the number of genes.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Barplot Gradient"
    ]
  },
  {
    "objectID": "Hiplot/154-ridge.html",
    "href": "Hiplot/154-ridge.html",
    "title": "Ridge",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Ridge plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/ridge?lang=en\nThe ridge map is a graph that connects points and forms a ridge.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Ridge"
    ]
  },
  {
    "objectID": "Hiplot/154-ridge.html#setup",
    "href": "Hiplot/154-ridge.html#setup",
    "title": "Ridge",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggridges; ggplot2; ggthemes\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggridges\", quietly = TRUE)) {\n  install.packages(\"ggridges\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"ggthemes\", quietly = TRUE)) {\n  install.packages(\"ggthemes\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggridges)\nlibrary(ggplot2)\nlibrary(ggthemes)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Ridge"
    ]
  },
  {
    "objectID": "Hiplot/154-ridge.html#data-preparation",
    "href": "Hiplot/154-ridge.html#data-preparation",
    "title": "Ridge",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data are three groups and their corresponding values.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/ridge/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\ndata$group &lt;- factor(data$group, levels = unique(data$group)[length(unique(data$group)):1])\n\n# View data\nhead(data)\n\n  value group\n1   5.1    G1\n2   4.9    G1\n3   4.7    G1\n4   4.6    G1\n5   5.0    G1\n6   5.4    G1",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Ridge"
    ]
  },
  {
    "objectID": "Hiplot/154-ridge.html#visualization",
    "href": "Hiplot/154-ridge.html#visualization",
    "title": "Ridge",
    "section": "Visualization",
    "text": "Visualization\n\n# Ridge\np &lt;- ggplot(data, aes(x = value, y = group, fill = group, col = group)) +\n  geom_density_ridges(scale = 5, alpha = 0.8) +\n  labs(x = \"value\", y = \"group\") +\n  theme(plot.title = element_text(hjust = 0.5),\n        legend.position = \"none\") +\n  ggtitle(\"Ridge Plot\") +\n  guides(color = guide_legend(reverse = TRUE),\n         fill = guide_legend(reverse = TRUE)) +\n  scale_fill_manual(values = c(\"#e04d39\",\"#5bbad6\",\"#1e9f86\")) +\n  scale_color_manual(values = c(\"#e04d39\",\"#5bbad6\",\"#1e9f86\")) +\n  theme_stata() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Ridge\n\n\n\n\n\nDifferent colors represent different groups, and the approximate degree of data can be observed.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Ridge"
    ]
  },
  {
    "objectID": "Hiplot/069-ggpiestats-group.html",
    "href": "Hiplot/069-ggpiestats-group.html",
    "title": "Piestats Group",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Piestats Group plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/ggpiestats-group?lang=en",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Piestats Group"
    ]
  },
  {
    "objectID": "Hiplot/069-ggpiestats-group.html#setup",
    "href": "Hiplot/069-ggpiestats-group.html#setup",
    "title": "Piestats Group",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggstatsplot; ggplot2; cowplot\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggstatsplot\", quietly = TRUE)) {\n  install.packages(\"ggstatsplot\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"cowplot\", quietly = TRUE)) {\n  install.packages(\"cowplot\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggstatsplot)\nlibrary(ggplot2)\nlibrary(cowplot)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Piestats Group"
    ]
  },
  {
    "objectID": "Hiplot/069-ggpiestats-group.html#data-preparation",
    "href": "Hiplot/069-ggpiestats-group.html#data-preparation",
    "title": "Piestats Group",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/ggpiestats-group/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\naxis &lt;- c(\"genre\", \"mpaa\")\ndata[, axis[1]] &lt;- factor(data[, axis[1]], levels = unique(data[, axis[1]]))\ndata[, axis[2]] &lt;- factor(data[, axis[2]], levels = unique(data[, axis[2]]))\n\n# View data\nhead(data)\n\n                                               title year length budget rating\n1                          Shawshank Redemption, The 1994    142     25    9.1\n2     Lord of the Rings: The Return of the King, The 2003    251     94    9.0\n3 Lord of the Rings: The Fellowship of the Ring, The 2001    208     93    8.8\n4             Lord of the Rings: The Two Towers, The 2002    223     94    8.8\n5                                       Pulp Fiction 1994    168      8    8.8\n6                                   Schindler's List 1993    195     25    8.8\n   votes  mpaa  genre\n1 149494     R  Drama\n2 103631 PG-13 Action\n3 157608 PG-13 Action\n4 114797 PG-13 Action\n5 132745     R  Drama\n6  97667     R  Drama",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Piestats Group"
    ]
  },
  {
    "objectID": "Hiplot/069-ggpiestats-group.html#visualization",
    "href": "Hiplot/069-ggpiestats-group.html#visualization",
    "title": "Piestats Group",
    "section": "Visualization",
    "text": "Visualization\n\n# Piestats Group\ng &lt;- unique(data[,axis[2]])\nplist &lt;- list()\nfor (i in 1:length(g)) {\n  fil &lt;- data[,axis[2]] == g[i]\n  plist[[i]] &lt;- \n    ggpiestats(\n      data = data[fil,], x = genre, \n      title= paste('', axis[2], g[i], sep = ':'),\n      plotgrid.args = list(ncol = 3),\n      label.repel = TRUE,\n      k = 2\n    ) +\n    scale_fill_manual(values = c(\"#3B4992FF\",\"#EE0000FF\",\"#008B45FF\",\"#631879FF\",\n                                 \"#008280FF\",\"#BB0021FF\",\"#5F559BFF\",\"#A20056FF\",\n                                 \"#808180FF\"))\n}\n\nplot_grid(plotlist = plist, ncol = 3)\n\n\n\n\n\n\n\nFigureÂ 1: Piestats Group",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Piestats Group"
    ]
  },
  {
    "objectID": "Hiplot/150-radar.html",
    "href": "Hiplot/150-radar.html",
    "title": "Radar",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Radar plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/radar?lang=en\nRadar chart displays multivariable data in the form of two-dimensional charts representing three or more quantitative variables on the axis starting from the same point, so as to visually express the comparison of a research object in multiple parameters.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Radar"
    ]
  },
  {
    "objectID": "Hiplot/150-radar.html#setup",
    "href": "Hiplot/150-radar.html#setup",
    "title": "Radar",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggradar; dplyr; scales; tibble; ggplot2\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggradar\", quietly = TRUE)) {\n  remotes::install_github(\"ricardo-bion/ggradar\", dependencies = TRUE)\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"scales\", quietly = TRUE)) {\n  install.packages(\"scales\")\n}\nif (!requireNamespace(\"tibble\", quietly = TRUE)) {\n  install.packages(\"tibble\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggradar)\nlibrary(dplyr)\nlibrary(scales)\nlibrary(tibble)\nlibrary(ggplot2)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Radar"
    ]
  },
  {
    "objectID": "Hiplot/150-radar.html#data-preparation",
    "href": "Hiplot/150-radar.html#data-preparation",
    "title": "Radar",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data is data set (expression levels of 5 genes in 4 diseases).\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/radar/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\ndata &lt;- as.data.frame(t(data))\ncolnames(data) &lt;- data[1, ]\ndata &lt;- data[-1, ]\nfor (i in seq_len(ncol(data))) {\n  data[, i] &lt;- as.numeric(data[, i])\n}\ndata_radar &lt;- data %&gt;%\n  rownames_to_column(var = \"sample\")\ndata_radar &lt;- data_radar %&gt;% mutate_at(vars(-sample), rescale)\n\n# View data\nhead(data)\n\n   value1 value2 value3 value4 value5\nS1      6    160    110   3.90  2.620\nS2      6    160    110   3.90  2.875\nS3      4    108     93   3.85  2.320\nS4      6    258    110   3.08  3.215",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Radar"
    ]
  },
  {
    "objectID": "Hiplot/150-radar.html#visualization",
    "href": "Hiplot/150-radar.html#visualization",
    "title": "Radar",
    "section": "Visualization",
    "text": "Visualization\n\n# Radar\np &lt;- ggradar(data_radar, gridline.max.linetype = 1, group.point.size = 4,\n             group.line.width = 1, font.radar = \"Arial\", fill.alpha = 0.5,\n             gridline.min.colour = \"grey\", gridline.mid.colour = \"#007A87\",\n             gridline.max.colour = \"grey\") +\n  ggtitle(\"Radar Plot\") +\n  scale_color_manual(values = c(\"#E64B35FF\",\"#4DBBD5FF\",\"#00A087FF\",\"#3C5488FF\")) +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_blank(),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_blank(),\n        axis.title.y=element_blank(),\n        axis.ticks.y=element_blank(),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n \np\n\n\n\n\n\n\n\nFigureÂ 1: Radar\n\n\n\n\n\nEach color of the radar map represents a disease, and the position of each point represents different gene expression. The higher the gene expression value, the farther away it is from the center of the circle, and vice versa.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Radar"
    ]
  },
  {
    "objectID": "Hiplot/004-barplot-color-group.html",
    "href": "Hiplot/004-barplot-color-group.html",
    "title": "Barplot Color Group",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Barplot Color Group plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/barplot-color-group?lang=en\nThe color group barplot can be used to display data values in groups, and to label different colors in sequence.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Barplot Color Group"
    ]
  },
  {
    "objectID": "Hiplot/004-barplot-color-group.html#setup",
    "href": "Hiplot/004-barplot-color-group.html#setup",
    "title": "Barplot Color Group",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2; stringr\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"stringr\", quietly = TRUE)) {\n  install.packages(\"stringr\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(stringr)",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Barplot Color Group"
    ]
  },
  {
    "objectID": "Hiplot/004-barplot-color-group.html#data-preparation",
    "href": "Hiplot/004-barplot-color-group.html#data-preparation",
    "title": "Barplot Color Group",
    "section": "Data Preparation",
    "text": "Data Preparation\nData table (three columns):\nTerm | Entry name, such as GO/KEGG channel name\nCount | The numerical size of the entry, such as the number of genes enriched in a pathway\nType | Category to which this channel belongs: such as BP/MF/CC/KEGG\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/barplot-color-group/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# convert data structure\ncolnames(data) &lt;- c(\"term\", \"count\", \"type\")\ndata[,\"term\"] &lt;- str_to_sentence(str_remove(data[,\"term\"], pattern = \"\\\\w+:\\\\d+\\\\W\"))\ndata[,\"term\"] &lt;- factor(data[,\"term\"], \n                        levels =  data[,\"term\"][length(data[,\"term\"]):1])\ndata[,\"type\"] &lt;- factor(data[,\"type\"], \n                        levels = data[!duplicated(data[,\"type\"]), \"type\"])\n\n# View data\ndata\n\n                                                  term count type\n1                                      Immune response    20   BP\n2                        Defense response to bacterium    11   BP\n3                                      Cell chemotaxis     8   BP\n4                                        Cell adhesion    17   BP\n5                                Complement activation     8   BP\n6                  Cytokine-mediated signaling pathway     8   MF\n7                             Phagocytosis, engulfment     5   MF\n8              Negative regulation of jak-stat cascade     5   MF\n9                             Epoxygenase p450 pathway     4   MF\n10                Chemokine-mediated signaling pathway     6   MF\n11  Negative regulation of leukocyte apoptotic process     3   MF\n12                   B cell receptor signaling pathway     5   MF\n13          Cellular response to tumor necrosis factor     6   CC\n14                   Positive regulation of chemotaxis     3   CC\n15                 Positive regulation of angiogenesis     6   CC\n16                        Collagen fibril organization     4   CC\n17 Positive regulation of homotypic cell-cell adhesion    20 KEGG\n18              Regulation of cell projection assembly    14 KEGG\n19                 Prostate epithelial cord elongation    10 KEGG\n20                         Bile acid catabolic process     8 KEGG\n21                           Cellular response to drug     7 KEGG\n22                 Glycosaminoglycan metabolic process     4 KEGG",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Barplot Color Group"
    ]
  },
  {
    "objectID": "Hiplot/004-barplot-color-group.html#visualization",
    "href": "Hiplot/004-barplot-color-group.html#visualization",
    "title": "Barplot Color Group",
    "section": "Visualization",
    "text": "Visualization\n\n# Barplot Color Group\np &lt;- ggplot(data = data, aes(x = term, y = count, fill = type)) +\n  geom_bar(stat = \"identity\", width = 0.8) + \n  theme_bw() +\n  xlab(\"Count\") +\n  ylab(\"Term\") +\n  guides(fill = guide_legend(title=\"Type\")) +\n  ggtitle(\"Barplot Color Group\") + \n  coord_flip() +\n  theme_classic() +\n  scale_fill_manual(values = c(\"#E64B35FF\",\"#4DBBD5FF\",\"#00A087FF\",\"#3C5488FF\")) +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Barplot Color Group\n\n\n\n\n\nThis plot visualizes the results of GO/KEGG pathway enrichment analysis.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Barplot Color Group"
    ]
  },
  {
    "objectID": "Hiplot/179-venn2.html",
    "href": "Hiplot/179-venn2.html",
    "title": "Venn2",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Venn2 plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/venn2?lang=en\nA Venn diagram is a diagramthat shows all possible logical relations between a finite collection of different sets. These diagrams depict elements as points in the plane, and sets as regions inside closed curves. A Venn diagram consists of multiple overlapping closed curves, usually circles, each representing a set. The points inside a curve labelled S represent elements of the set S, while points outside the boundary represent elements not in the set S. This lends to easily read visualizations; for example, the set of all elements that are members of both sets Sand T, S âˆ© T, is represented visually by the area of overlap of the regions S and T. In Venn diagrams the curves are overlapped in every possible way, showing all possible relations between the sets.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Venn2"
    ]
  },
  {
    "objectID": "Hiplot/179-venn2.html#setup",
    "href": "Hiplot/179-venn2.html#setup",
    "title": "Venn2",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; venn\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"venn\", quietly = TRUE)) {\n  install.packages(\"venn\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(venn)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Venn2"
    ]
  },
  {
    "objectID": "Hiplot/179-venn2.html#data-preparation",
    "href": "Hiplot/179-venn2.html#data-preparation",
    "title": "Venn2",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data is a collection of five gene names.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/venn2/data.json\")$exampleData[[1]]$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# convert data structure\ndata_venn &lt;- as.list(data)\ndata_venn &lt;- lapply(data_venn, function(x) {\n  x[is.na(x)] &lt;- \"\"\n  x &lt;- x[x != \"\"]\n  return(x)\n})\n\n# View data\nhead(data)\n\n     Set1      Set2     Set3      Set4    Set5\n1   ISG15      HES5     DVL1   MATP6P1 FAM132A\n2  TTLL10  AURKAIP1 ARHGEF16   MIR551A    AGRN\n3    HES4 LINC00982   OR4F16  C1orf222 WBP1LP6\n4  OR4G4P    FAM87B      SKI   MIR200B  KLHL17\n5 MND2P28       SKI   WASH7P LINC00115  FAM41C\n6  FAM87B     GABRD    MEGF6    ATAD3B   PANK4",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Venn2"
    ]
  },
  {
    "objectID": "Hiplot/179-venn2.html#visualization",
    "href": "Hiplot/179-venn2.html#visualization",
    "title": "Venn2",
    "section": "Visualization",
    "text": "Visualization\n\n# Venn2\ncol &lt;- c(\"#E64B35FF\",\"#4DBBD5FF\",\"#00A087FF\",\"#3C5488FF\",\"#F39B7FFF\")\nvenn(x=data_venn, opacity=0.8, ggplot=F, ilabels = TRUE, zcolor=col, box=F)\ntitle(main = \"Vene Plot (5 sets)\", line = -1)\n\n\n\n\n\n\n\nFigureÂ 1: Venn2\n\n\n\n\n\nThe closed curve of 5 colors represents 5 sets, and the number represents the number of overlapping or non-overlapping genes in multiple sets. For example, 8 in the sample figure represents 8 identical gene names in 5 sample sets.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Venn2"
    ]
  },
  {
    "objectID": "Hiplot/081-group-bubble.html",
    "href": "Hiplot/081-group-bubble.html",
    "title": "Group Bubble",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Group Bubble plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/group-bubble?lang=en",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Group Bubble"
    ]
  },
  {
    "objectID": "Hiplot/081-group-bubble.html#setup",
    "href": "Hiplot/081-group-bubble.html#setup",
    "title": "Group Bubble",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Group Bubble"
    ]
  },
  {
    "objectID": "Hiplot/081-group-bubble.html#data-preparation",
    "href": "Hiplot/081-group-bubble.html#data-preparation",
    "title": "Group Bubble",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/group-bubble/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# View data\nhead(data)\n\n  Sepal.Length Sepal.Width Petal.Length Petal.Width Species\n1          5.1         3.5          1.4         0.2  setosa\n2          4.9         3.0          1.4         0.2  setosa\n3          4.7         3.2          1.3         0.2  setosa\n4          4.6         3.1          1.5         0.2  setosa\n5          5.0         3.6          1.4         0.2  setosa\n6          5.4         3.9          1.7         0.4  setosa",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Group Bubble"
    ]
  },
  {
    "objectID": "Hiplot/081-group-bubble.html#visualization",
    "href": "Hiplot/081-group-bubble.html#visualization",
    "title": "Group Bubble",
    "section": "Visualization",
    "text": "Visualization\n\n# Group Bubble\np &lt;- ggplot(data = data, aes(x = Sepal.Length, y = Sepal.Width, \n                             size = Petal.Width, color = Species)) +\n  geom_point(alpha = 0.7) +\n  scale_size(range = c(1, 4)) +\n  scale_color_manual(values = c(\"#e04d39\",\"#5bbad6\",\"#1e9f86\")) +\n  theme_bw()\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Group Bubble",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Group Bubble"
    ]
  },
  {
    "objectID": "Hiplot/057-funnel-plot-metafor.html",
    "href": "Hiplot/057-funnel-plot-metafor.html",
    "title": "Funnel Plot (metafor)",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Funnel Plot (metafor) plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/funnel-plot-metafor?lang=en\nCan be used to show potential bias factors in Meta-analysis.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Funnel Plot (metafor)"
    ]
  },
  {
    "objectID": "Hiplot/057-funnel-plot-metafor.html#setup",
    "href": "Hiplot/057-funnel-plot-metafor.html#setup",
    "title": "Funnel Plot (metafor)",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; metafor; ggplotify\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"metafor\", quietly = TRUE)) {\n  install.packages(\"metafor\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(metafor)\nlibrary(ggplotify)",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Funnel Plot (metafor)"
    ]
  },
  {
    "objectID": "Hiplot/057-funnel-plot-metafor.html#data-preparation",
    "href": "Hiplot/057-funnel-plot-metafor.html#data-preparation",
    "title": "Funnel Plot (metafor)",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/funnel-plot-metafor/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\ndata2 &lt;- escalc(ri=ri, ni=ni, data = data, measure=\"ZCOR\")\nres &lt;- rma(yi, vi, data = data2)\n\n# View data\nhead(data)\n\n              authors year  ni    ri controls          design   a_measure\n1     Axelsson et al. 2009 109 0.187     none cross-sectional self-report\n2     Axelsson et al. 2011 749 0.162     none cross-sectional self-report\n3        Bruce et al. 2010  55 0.340     none     prospective       other\n4  Christensen et al. 1999 107 0.320     none cross-sectional self-report\n5 Christensen & Smith 1995  72 0.270     none     prospective       other\n6        Cohen et al. 2004  65 0.000     none     prospective       other\n  c_measure meanage quality\n1     other   22.00       1\n2       NEO   53.59       1\n3       NEO   43.36       2\n4     other   41.70       1\n5       NEO   46.39       2\n6       NEO   41.20       2",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Funnel Plot (metafor)"
    ]
  },
  {
    "objectID": "Hiplot/057-funnel-plot-metafor.html#visualization",
    "href": "Hiplot/057-funnel-plot-metafor.html#visualization",
    "title": "Funnel Plot (metafor)",
    "section": "Visualization",
    "text": "Visualization\n\n# Funnel Plot\np &lt;- as.ggplot(function(){\n  funnel(x = res, main = \"Funnel Plot (metafor)\",\n         level = c(90, 95, 99), shade = c(\"white\",\"#a90e07\",\"#d23e0b\"), refline = 0)\n  })\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Funnel Plot",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Funnel Plot (metafor)"
    ]
  },
  {
    "objectID": "Hiplot/011-beanplot.html",
    "href": "Hiplot/011-beanplot.html",
    "title": "Beanplot",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Beanplot plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/beanplot?lang=en\nThe beanplot is a method of visualizing the distribution characteristics.",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Beanplot"
    ]
  },
  {
    "objectID": "Hiplot/011-beanplot.html#setup",
    "href": "Hiplot/011-beanplot.html#setup",
    "title": "Beanplot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplotify; beanplot\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\nif (!requireNamespace(\"beanplot\", quietly = TRUE)) {\n  install.packages(\"beanplot\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplotify)\nlibrary(beanplot)",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Beanplot"
    ]
  },
  {
    "objectID": "Hiplot/011-beanplot.html#data-preparation",
    "href": "Hiplot/011-beanplot.html#data-preparation",
    "title": "Beanplot",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data is data set (data on treatment outcomes of different treatment regimens).\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/beanplot/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# convert data structure\nGroupOrder &lt;- as.numeric(factor(data[, 2], levels = unique(data[, 2])))\ndata[, 2] &lt;- paste0(data[,2], \" \", as.numeric(factor(data[, 3])))\ndata &lt;- cbind(data, GroupOrder)\n\n# View data\nhead(data)\n\n     Y     X  Group GroupOrder\n1  4.2 low 1 treat1          1\n2 11.5 low 1 treat1          1\n3  7.3 low 1 treat1          1\n4  5.8 low 1 treat1          1\n5  6.4 low 1 treat1          1\n6 10.0 low 1 treat1          1",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Beanplot"
    ]
  },
  {
    "objectID": "Hiplot/011-beanplot.html#visualization",
    "href": "Hiplot/011-beanplot.html#visualization",
    "title": "Beanplot",
    "section": "Visualization",
    "text": "Visualization\n\n# Beanplot\np &lt;- as.ggplot(function() {\n  beanplot(Y ~ reorder(X, GroupOrder, mean), data = data, ll = 0.04,\n           main = \"Bean Plot\", ylab = \"Y\", xlab = \"X\", side = \"both\",\n           border = NA, horizontal = F, \n           col = list(c(\"#2b70c4\", \"#2b70c4\"),c(\"#e9c216\", \"#e9c216\")),\n           beanlines = \"mean\", overallline = \"mean\", kernel = \"gaussian\")\n  \n  legend(\"bottomright\", fill = c(\"#2b70c4\", \"#e9c216\"),\n         legend = levels(factor(data[, 3])))\n})\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Beanplot",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Beanplot"
    ]
  },
  {
    "objectID": "Hiplot/021-circle-packing.html",
    "href": "Hiplot/021-circle-packing.html",
    "title": "Circle Packing",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Circle Packing plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/circle-packing?lang=en\nCircle packing is a visualization method used to display the differences in quantity among different categories.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Circle Packing"
    ]
  },
  {
    "objectID": "Hiplot/021-circle-packing.html#setup",
    "href": "Hiplot/021-circle-packing.html#setup",
    "title": "Circle Packing",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; packcircles; ggplot2; viridis\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"packcircles\", quietly = TRUE)) {\n  install.packages(\"packcircles\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"viridis\", quietly = TRUE)) {\n  install.packages(\"viridis\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(packcircles)\nlibrary(ggplot2)\nlibrary(viridis)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Circle Packing"
    ]
  },
  {
    "objectID": "Hiplot/021-circle-packing.html#data-preparation",
    "href": "Hiplot/021-circle-packing.html#data-preparation",
    "title": "Circle Packing",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/circle-packing/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# convert data structure\npacking &lt;- circleProgressiveLayout(data[[\"v\"]], sizetype = \"area\")\ndata &lt;- cbind(data, packing)\ndat_gg &lt;- circleLayoutVertices(packing, npoints = 50)\ncolors &lt;- c(\"#E57164\",\"#F8ECA7\",\"#9389C1\",\"#3F9C78\",\"#769F8D\",\"#E5F9A9\",\"#7CE9A4\",\n            \"#CE9FCA\",\"#78F197\",\"#8BB085\",\"#D88880\",\"#A6E4C3\",\"#F7F6B1\",\"#C5E69A\",\n            \"#F45FDE\",\"#5CF371\",\"#9259CF\",\"#2B6D9B\",\"#F3C096\",\"#EEADBE\")\ndat_gg$value &lt;- rep(colors, each = 51)\n\n# View data\nhead(data)\n\n  g   v           x          y   radius\n1 A 100  -5.6418958  0.0000000 5.641896\n2 B 120   6.1803872  0.0000000 6.180387\n3 C  80  -0.2298516 -9.2166458 5.046265\n4 D  10  -6.7961670 -7.3357638 1.784124\n5 E  60 -12.9322538 -6.8624061 4.370194\n6 F  30 -14.3618753  0.4597221 3.090194",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Circle Packing"
    ]
  },
  {
    "objectID": "Hiplot/021-circle-packing.html#visualization",
    "href": "Hiplot/021-circle-packing.html#visualization",
    "title": "Circle Packing",
    "section": "Visualization",
    "text": "Visualization\n\n# Circle Packing\np &lt;- ggplot() +\n  geom_polygon(data = dat_gg, aes(x, y, group = id, fill = value), colour = \"black\", alpha = 0.4) +\n  scale_fill_manual(values = magma(nrow(data))) +\n  theme_void() +\n  theme(legend.position = \"none\") +\n  coord_equal() +\n  scale_size_continuous(range = c(2.3, 4.5)) +\n  geom_text(data = data, aes(x, y, size = v, label = g), vjust = 0) +\n  geom_text(data = data, aes(x, y, label = v, size = v), vjust = 1.2)\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Circle Packing",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Circle Packing"
    ]
  },
  {
    "objectID": "Hiplot/012-beeswarm.html",
    "href": "Hiplot/012-beeswarm.html",
    "title": "Beeswarm",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Beeswarm plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/beeswarm?lang=en\nThe beeswarm is a noninterference scatter plot which is similar to a bee colony.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Beeswarm"
    ]
  },
  {
    "objectID": "Hiplot/012-beeswarm.html#setup",
    "href": "Hiplot/012-beeswarm.html#setup",
    "title": "Beeswarm",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggbeeswarm; ggthemes\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggbeeswarm\", quietly = TRUE)) {\n  install.packages(\"ggbeeswarm\")\n}\nif (!requireNamespace(\"ggthemes\", quietly = TRUE)) {\n  install.packages(\"ggthemes\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggbeeswarm)\nlibrary(ggthemes)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Beeswarm"
    ]
  },
  {
    "objectID": "Hiplot/012-beeswarm.html#data-preparation",
    "href": "Hiplot/012-beeswarm.html#data-preparation",
    "title": "Beeswarm",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data are different groups and their data.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/beeswarm/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# convert data structure\ndata[, 1] &lt;- factor(data[, 1], levels = unique(data[, 1]))\ncolnames(data) &lt;- c(\"Group\", \"y\")\n\n# View data\nhead(data)\n\n  Group   y\n1    G1 5.1\n2    G1 4.9\n3    G1 4.7\n4    G1 4.6\n5    G1 5.0\n6    G1 5.4",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Beeswarm"
    ]
  },
  {
    "objectID": "Hiplot/012-beeswarm.html#visualization",
    "href": "Hiplot/012-beeswarm.html#visualization",
    "title": "Beeswarm",
    "section": "Visualization",
    "text": "Visualization\n\n# Beeswarm\np &lt;- ggplot(data, aes(Group, y, color = Group)) +\n  geom_beeswarm(alpha = 1, size = 0.8) +\n  labs(x = NULL, y = \"value\") +\n  ggtitle(\"BeeSwarm Plot\") +\n  scale_color_manual(values = c(\"#e04d39\",\"#5bbad6\",\"#1e9f86\")) +\n  theme_stata() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Beeswarm\n\n\n\n\n\nDifferent colors represent different groups, and dots represent data.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Beeswarm"
    ]
  },
  {
    "objectID": "Hiplot/119-meta-bin.html",
    "href": "Hiplot/119-meta-bin.html",
    "title": "Meta-analysis of Binary Data",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Meta-analysis of Binary Data plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/meta-bin?lang=en",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Meta-analysis of Binary Data"
    ]
  },
  {
    "objectID": "Hiplot/119-meta-bin.html#setup",
    "href": "Hiplot/119-meta-bin.html#setup",
    "title": "Meta-analysis of Binary Data",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; meta; ggplotify\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"meta\", quietly = TRUE)) {\n  install.packages(\"meta\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(meta)\nlibrary(ggplotify)",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Meta-analysis of Binary Data"
    ]
  },
  {
    "objectID": "Hiplot/119-meta-bin.html#data-preparation",
    "href": "Hiplot/119-meta-bin.html#data-preparation",
    "title": "Meta-analysis of Binary Data",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/meta-bin/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\nm1 &lt;- metabin(ev.exp, n.exp, ev.cont, n.cont, studlab = Study, data = data)\n\n# View data\nhead(data)\n\n       Study ev.exp n.exp ev.cont n.cont\n1   Fletcher      1    12       4     11\n2      Dewar      4    21       7     21\n3 Lippschutz      6    43       7     41\n4 European_1     20    83      15     84\n5 European_2     69   373      94    357",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Meta-analysis of Binary Data"
    ]
  },
  {
    "objectID": "Hiplot/119-meta-bin.html#visualization",
    "href": "Hiplot/119-meta-bin.html#visualization",
    "title": "Meta-analysis of Binary Data",
    "section": "Visualization",
    "text": "Visualization\n\n# Meta-analysis of Binary Data\np &lt;- as.ggplot(function(){\n  meta::forest(m1, layout = \"meta\")\n  })\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Meta-analysis of Binary Data",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Meta-analysis of Binary Data"
    ]
  },
  {
    "objectID": "Hiplot/058-funnel-plot.html",
    "href": "Hiplot/058-funnel-plot.html",
    "title": "Funnel Plot",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Funnel Plot plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/funnel-plot?lang=en\nCan be used to show potential bias factors in Meta-analysis.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Funnel Plot"
    ]
  },
  {
    "objectID": "Hiplot/058-funnel-plot.html#setup",
    "href": "Hiplot/058-funnel-plot.html#setup",
    "title": "Funnel Plot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; FunnelPlotR; gridExtra\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"FunnelPlotR\", quietly = TRUE)) {\n  install.packages(\"FunnelPlotR\")\n}\nif (!requireNamespace(\"gridExtra\", quietly = TRUE)) {\n  install.packages(\"gridExtra\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(FunnelPlotR)\nlibrary(gridExtra)",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Funnel Plot"
    ]
  },
  {
    "objectID": "Hiplot/058-funnel-plot.html#data-preparation",
    "href": "Hiplot/058-funnel-plot.html#data-preparation",
    "title": "Funnel Plot",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/funnel-plot/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# View data\nhead(data)\n\n  los hmo white died age80 type type1 type2 type3 provnum     prds\n1   4   0     1    0     0    1     1     0     0   30001 9.667315\n2   9   1     1    0     0    1     1     0     0   30001 8.956472\n3   3   1     1    1     1    1     1     0     0   30001 6.856678\n4   9   0     1    0     0    1     1     0     0   30001 9.667315\n5   1   0     1    1     1    1     1     0     0   30001 7.400868\n6   4   0     1    1     0    1     1     0     0   30001 7.561051",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Funnel Plot"
    ]
  },
  {
    "objectID": "Hiplot/058-funnel-plot.html#visualization",
    "href": "Hiplot/058-funnel-plot.html#visualization",
    "title": "Funnel Plot",
    "section": "Visualization",
    "text": "Visualization\n\n# Funnel Plot\np &lt;- funnel_plot(\n  data, numerator = los, denominator = prds,  group = provnum, data_type = \"SR\",\n  limit = 99, label = \"outlier\", sr_method = \"SHMI\", trim_by=0.1, \n  title = \"Funnel Plot\", x_range = \"auto\", y_range = \"auto\"\n  )\n\np\n\nA funnel plot object with 54 points of which 9 are outliers. \nPlot is adjusted for overdispersion. \n\n\n\n\n\n\n\n\nFigureÂ 1: Funnel Plot",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Funnel Plot"
    ]
  },
  {
    "objectID": "Hiplot/149-r-code-flow.html",
    "href": "Hiplot/149-r-code-flow.html",
    "title": "R Script Flow",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot R Script Flow plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/r-code-flow?lang=en\nR script flow can realize the visual window of if, else and other logic functions.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "R Script Flow"
    ]
  },
  {
    "objectID": "Hiplot/149-r-code-flow.html#setup",
    "href": "Hiplot/149-r-code-flow.html#setup",
    "title": "R Script Flow",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: flow\n\n\n# Install packages\nif (!requireNamespace(\"flow\", quietly = TRUE)) {\n  install.packages(\"flow\")\n}\n\n# Load packages\nlibrary(flow)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "R Script Flow"
    ]
  },
  {
    "objectID": "Hiplot/149-r-code-flow.html#data-preparation",
    "href": "Hiplot/149-r-code-flow.html#data-preparation",
    "title": "R Script Flow",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data are if, else function code of R.\n\n# Load data\ncode &lt;- function(){\n  if (x &lt; 10) {\n    a &lt;- 1\n  } else {\n    a &lt;- 2\n  }\n  if (a == 2) {\n    c &lt;- d\n  } else {\n    d &lt;- a\n  }\n}",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "R Script Flow"
    ]
  },
  {
    "objectID": "Hiplot/149-r-code-flow.html#visualization",
    "href": "Hiplot/149-r-code-flow.html#visualization",
    "title": "R Script Flow",
    "section": "Visualization",
    "text": "Visualization\n\n# R Script Flow\np &lt;- flow_view(code)\n\np\n\n\n\n\n\n\n\nFigureÂ 1: R Script Flow\n\n\n\nThe graph shows that if the variable x&lt;10, a =1, if the variable x&gt;10, a = 2;If a is equal to 2, then c is equal to d, if a is not equal to 2, then d is equal to a.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "R Script Flow"
    ]
  },
  {
    "objectID": "Hiplot/089-interval-area-chart.html",
    "href": "Hiplot/089-interval-area-chart.html",
    "title": "Interval Area Chart",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Interval Area Chart plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/interval-area-chart?lang=en",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Interval Area Chart"
    ]
  },
  {
    "objectID": "Hiplot/089-interval-area-chart.html#setup",
    "href": "Hiplot/089-interval-area-chart.html#setup",
    "title": "Interval Area Chart",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Interval Area Chart"
    ]
  },
  {
    "objectID": "Hiplot/089-interval-area-chart.html#data-preparation",
    "href": "Hiplot/089-interval-area-chart.html#data-preparation",
    "title": "Interval Area Chart",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe case data consists of the highest and lowest temperatures for each of the twelve months in a year, along with the corresponding abbreviated month names. Based on the case data, temperature intervals and average temperature lines have been plotted for each month.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/interval-area-chart/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\ndata[[\"month\"]] &lt;- factor(data[[\"month\"]], levels = data[[\"month\"]])\n\n# View data\nhead(data)\n\n  month min_temperature max_temperature mean\n1   Jan              15              20   16\n2   Feb              17              25   20\n3   Mar              20              26   23\n4   Apr              25              30   27\n5   May              30              35   32\n6   Jun              32              35   34",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Interval Area Chart"
    ]
  },
  {
    "objectID": "Hiplot/089-interval-area-chart.html#visualization",
    "href": "Hiplot/089-interval-area-chart.html#visualization",
    "title": "Interval Area Chart",
    "section": "Visualization",
    "text": "Visualization\n\n# Interval Area Chart\np &lt;- ggplot(data, aes(x = month, group = 1)) +\n  geom_line(aes(y = max_temperature), size = 1.2, color = \"#EA3323\", \n            linetype = \"solid\") +\n  geom_line(aes(y = min_temperature), size = 1.2, color = \"#0000F5\", \n            linetype = \"solid\") +\n  geom_line(aes(x = month, y = mean), size = 1.2, color = \"#BEBEBE\", \n            linetype = \"dashed\") +\n  geom_ribbon(aes(ymin = min_temperature, ymax = max_temperature), \n              fill = \"#F2F2F2\", alpha = 0.5) +\n  geom_text(aes(x = month, y = max_temperature + 1, label = max_temperature),\n            color = \"#EA3323\", size = 2.5, vjust = -0.5, hjust = 0) +\n  geom_text(aes(x = month, y = min_temperature - 1, label = min_temperature),\n            color = \"#0000F5\", size = 2.5, vjust = 1.5, hjust = 0) +\n  geom_text(aes(x = month, y = mean, label = mean),\n            color = \"#BEBEBE\", size = 2.5, vjust = 1.5, hjust = 0) +\n  labs(title = \"Temperature\", x = \"Month\", y = \"Temperature\") +\n  scale_color_manual(values = c(max = \"#EA3323\", min = \"#0000F5\")) +\n  theme_bw() +\n  theme(plot.title = element_text(hjust = 0.5))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Interval Area Chart",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Interval Area Chart"
    ]
  },
  {
    "objectID": "Hiplot/118-matrix-bubble.html",
    "href": "Hiplot/118-matrix-bubble.html",
    "title": "Matrix Bubble",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Matrix Bubble plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/matrix-bubble?lang=en\nThe color matrix bubble is used to visualize the expression matrix data of multiple genes (rows) in various cells (columns).",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Matrix Bubble"
    ]
  },
  {
    "objectID": "Hiplot/118-matrix-bubble.html#setup",
    "href": "Hiplot/118-matrix-bubble.html#setup",
    "title": "Matrix Bubble",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggalluvial; ggplot2\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggalluvial\", quietly = TRUE)) {\n  install.packages(\"ggalluvial\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggalluvial)\nlibrary(ggplot2)",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Matrix Bubble"
    ]
  },
  {
    "objectID": "Hiplot/118-matrix-bubble.html#data-preparation",
    "href": "Hiplot/118-matrix-bubble.html#data-preparation",
    "title": "Matrix Bubble",
    "section": "Data Preparation",
    "text": "Data Preparation\nData Structureï¼š\n\n&lt;1st-col&gt;: (String) cell sample name as X axis\n&lt;2nd-col&gt;: (String) gene name as the Y axis\n&lt;3rd-col&gt;: (Numeric) gene expression\n&lt;4rd-col&gt;: (Numeric) groups\n\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/matrix-bubble/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\ndata[, 1] &lt;- factor(data[, 1], levels = unique(data[, 1]))\ndata[, 2] &lt;- factor(data[, 2], levels = unique(data[, 2]))\n\n# View data\nhead(data)\n\n      x     y value  group\n1 cell1 gene1     1 groupC\n2 cell1 gene2     5 groupC\n3 cell1 gene3    10 groupC\n4 cell1 gene4    15 groupC\n5 cell1 gene5    20 groupC\n6 cell1 gene6    25 groupC",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Matrix Bubble"
    ]
  },
  {
    "objectID": "Hiplot/118-matrix-bubble.html#visualization",
    "href": "Hiplot/118-matrix-bubble.html#visualization",
    "title": "Matrix Bubble",
    "section": "Visualization",
    "text": "Visualization\n\n# Matrix Bubble\np &lt;- ggplot(data = data, aes(x = x, y = y, size = value, color = y)) +\n  geom_point(alpha = 1) +\n  labs(title = \"Matrix Bubble\") +\n  guides(color = FALSE) +\n  theme(panel.background = element_blank(),\n        panel.grid.major = element_line(colour = \"gray\"),\n        strip.background = element_blank(),\n        panel.border = element_rect(colour = \"black\", fill = NA),\n        panel.spacing = unit(0, \"lines\"),\n        plot.title = element_text(size = 12, hjust = 0.5),\n        text = element_text(family = \"Arial\"),\n        legend.title = element_text(size = 10),\n        axis.text.x = element_text(angle=0, hjust=0.5, vjust=1)) +\n  facet_grid(~group, scales = 'fixed', margins = F) +\n  scale_color_manual(values = c(\n    \"#3B4992FF\",\"#EE0000FF\",\"#008B45FF\",\"#631879FF\",\"#008280FF\",\"#BB0021FF\",\n    \"#5F559BFF\",\"#A20056FF\",\"#808180FF\",\"#1B1919FF\"))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Matrix Bubble",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Matrix Bubble"
    ]
  },
  {
    "objectID": "Hiplot/161-scatter.html",
    "href": "Hiplot/161-scatter.html",
    "title": "Scatter",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Scatter plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/scatter?lang=en\nTwo groups of data are used to form multiple coordinate points. By observing the distribution of coordinate points, it can judge whether there is correlation between variables or summarize the data processing mode of coordinate point distribution.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Scatter"
    ]
  },
  {
    "objectID": "Hiplot/161-scatter.html#setup",
    "href": "Hiplot/161-scatter.html#setup",
    "title": "Scatter",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Scatter"
    ]
  },
  {
    "objectID": "Hiplot/161-scatter.html#data-preparation",
    "href": "Hiplot/161-scatter.html#data-preparation",
    "title": "Scatter",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data are the horizontal axis values and their corresponding vertical axis values and groups.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/scatter/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# View data\nhead(data)\n\n  Value1 Value2  Group\n1      1      1 treat1\n2      2      4 treat1\n3      3      9 treat1\n4      4     16 treat1\n5      5     25 treat1\n6      6     36 treat1",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Scatter"
    ]
  },
  {
    "objectID": "Hiplot/161-scatter.html#visualization",
    "href": "Hiplot/161-scatter.html#visualization",
    "title": "Scatter",
    "section": "Visualization",
    "text": "Visualization\n\n# Scatter\np &lt;- ggplot(data, aes(x = Value1, y = Value2)) +\n  geom_point(size = 1, alpha = 1, aes(color = Group, shape = Group)) +\n  ggtitle(\"Scatter Plot\") +\n  scale_color_manual(values = c(\"#00468BFF\", \"#ED0000FF\")) +\n  theme_bw() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Scatter\n\n\n\n\n\nValue1 represents the horizontal axis and Value2 represents the vertical axis. The diagram shows that Value1 and Value2 in treatment plan 1 are positively correlated: that is, when Value1 becomes larger, Value2 will become larger; In treatment plan 2, two variables are negatively correlated: that is, when Value1 becomes larger, Value2 becomes smaller.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Scatter"
    ]
  },
  {
    "objectID": "Hiplot/036-d3-wordcloud.html",
    "href": "Hiplot/036-d3-wordcloud.html",
    "title": "D3 Wordcloud",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot D3 Wordcloud plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/d3-wordcloud?lang=en\nDisplay the wordcloudã€‚",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "D3 Wordcloud"
    ]
  },
  {
    "objectID": "Hiplot/036-d3-wordcloud.html#setup",
    "href": "Hiplot/036-d3-wordcloud.html#setup",
    "title": "D3 Wordcloud",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; d3wordcloud\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"d3wordcloud\", quietly = TRUE)) {\n  remotes::install_github(\"jbkunst/d3wordcloud\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(d3wordcloud)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "D3 Wordcloud"
    ]
  },
  {
    "objectID": "Hiplot/036-d3-wordcloud.html#data-preparation",
    "href": "Hiplot/036-d3-wordcloud.html#data-preparation",
    "title": "D3 Wordcloud",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/d3-wordcloud/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# convert data structure\nrow.names(data) &lt;- data[, 1]\n\n# View data\nhead(data)\n\n         word freq\noil       oil   85\nsaid     said   73\nprices prices   48\nopec     opec   42\nmln       mln   31\nthe       the   26",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "D3 Wordcloud"
    ]
  },
  {
    "objectID": "Hiplot/036-d3-wordcloud.html#visualization",
    "href": "Hiplot/036-d3-wordcloud.html#visualization",
    "title": "D3 Wordcloud",
    "section": "Visualization",
    "text": "Visualization\n\n# D3 Wordcloud\np &lt;- d3wordcloud(\n  words = data[, 1], \n  freqs = data[, 2],\n  padding = 0,\n  rotate.min = 0,\n  rotate.max = 0,\n  size.scale = \"linear\",\n  color.scale = \"linear\",\n  spiral = \"archimedean\",\n  font = \"Arial\",\n  rangesizefont = c(10, 90)\n)\n\np\n\n\n\n\n\n\n\nFigureÂ 1: D3 Wordcloud",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "D3 Wordcloud"
    ]
  },
  {
    "objectID": "Hiplot/056-flowerplot.html",
    "href": "Hiplot/056-flowerplot.html",
    "title": "Flower plot",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Flower plot plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/flowerplot?lang=en\nFlower plot with multiple sets.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Flower plot"
    ]
  },
  {
    "objectID": "Hiplot/056-flowerplot.html#setup",
    "href": "Hiplot/056-flowerplot.html#setup",
    "title": "Flower plot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; flowerplot; ggplotify\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"flowerplot\", quietly = TRUE)) {\n  remotes::install_github(\"dongwei1220/flowerplot\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(flowerplot)\nlibrary(ggplotify)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Flower plot"
    ]
  },
  {
    "objectID": "Hiplot/056-flowerplot.html#data-preparation",
    "href": "Hiplot/056-flowerplot.html#data-preparation",
    "title": "Flower plot",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/flowerplot/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# View data\nhead(data)\n\n     Set1   Set2  Set3  Set4   Set5    Set6   Set7     Set8\n1   ZMIZ1  ADCY5  TNS1  TNS1   TNS1   ZMIZ1 SORBS1     RGS3\n2    TNS1  ACTN4 ZMIZ1 ZMIZ1  ZMIZ1    TNS1   TNS1    FHOD3\n3   CASZ1 SORBS1  RXRA  RXRA TSPAN9   CASZ1  ZMIZ1 PPARGC1B\n4    NFIC   TNS1 AHDC1 NCOR2   MIDN    NFIC  RBM20     NNMT\n5 CACNA1C  ZMIZ1 ACTN4  MIDN  NCOR2 CACNA1C TSPAN9   SORBS2\n6   AHDC1  RBM20  MIDN AHDC1  AHDC1   AHDC1  SYNPO   FAM53B",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Flower plot"
    ]
  },
  {
    "objectID": "Hiplot/056-flowerplot.html#visualization",
    "href": "Hiplot/056-flowerplot.html#visualization",
    "title": "Flower plot",
    "section": "Visualization",
    "text": "Visualization\n\n# Flower plot\np &lt;- as.ggplot(function(){\n  flowerplot(\n    flower_dat = data,\n    angle = 90,\n    a = 0.5,\n    b = 2,\n    r = 1,\n    ellipse_col = \"RdBu\",\n    circle_col = \"#FFFFFF\",\n    label_text_cex = 1\n  )})\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Flower plot",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Flower plot"
    ]
  },
  {
    "objectID": "Hiplot/010-barplot.html",
    "href": "Hiplot/010-barplot.html",
    "title": "Barplot",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Barplot plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/barplot?lang=en\nBar charts are used to display category data with rectangular bars whose height or length is proportional to the value they represent. Bar charts can be drawn vertically or horizontally. The bar chart shows the comparison between the discrete categories. One axis of the chart shows the specific categories to be compared, and the other axis represents the measurements. Some bar charts show bars that can also show the values of multiple measurement variables.",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Barplot"
    ]
  },
  {
    "objectID": "Hiplot/010-barplot.html#setup",
    "href": "Hiplot/010-barplot.html#setup",
    "title": "Barplot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2; ggthemes\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"ggthemes\", quietly = TRUE)) {\n  install.packages(\"ggthemes\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(ggthemes)",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Barplot"
    ]
  },
  {
    "objectID": "Hiplot/010-barplot.html#data-preparation",
    "href": "Hiplot/010-barplot.html#data-preparation",
    "title": "Barplot",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data are efficacy data of different doses of drugs in different treatment regimens.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/barplot/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# convert data structure\ndata[, 2] &lt;- factor(data[, 2], levels = unique(data[, 2]))\ndata[, 3] &lt;- factor(data[, 3], levels = unique(data[, 3]))\n\n# View data\nhead(data)\n\n  value  treat dose\n1    13 Group1 high\n2    34 Group2 high\n3    21 Group3 high\n4    43 Group4 high\n5    25 Group1  mid\n6     8 Group2  mid",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Barplot"
    ]
  },
  {
    "objectID": "Hiplot/010-barplot.html#visualization",
    "href": "Hiplot/010-barplot.html#visualization",
    "title": "Barplot",
    "section": "Visualization",
    "text": "Visualization\n\n# Barplot\np &lt;- ggplot(data, aes(x = dose, y = value, fill = treat)) +\n  geom_bar(position = position_dodge(0.9), stat = \"identity\") +\n  ggtitle(\"Bar Plot\") +\n  geom_text(aes(label = value), position = position_dodge(0.9), vjust = 1.5, color = \"white\", size = 3.5) +\n  scale_fill_manual(values = c(\"#e04d39\",\"#5bbad6\",\"#1e9f86\",\"#3c5488ff\")) +\n  theme_stata() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Barplot\n\n\n\n\n\nThe bar chart shows the different effects of low, medium, and high doses in different treatment groups (groups 1 to 4). Group 1 had the best effect with medium dose treatment, group 2 had the best effect with high dose treatment, group 3 had no significant difference with dose treatment, and group 4 had the best effect with high dose treatment.",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Barplot"
    ]
  },
  {
    "objectID": "Hiplot/125-multiple-histograms.html",
    "href": "Hiplot/125-multiple-histograms.html",
    "title": "Multiple Histograms",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Multiple Histograms plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/multiple-histograms?lang=en\nMultiple histograms are plotted on the same graph to compare differences between multiple sets of data.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Multiple Histograms"
    ]
  },
  {
    "objectID": "Hiplot/125-multiple-histograms.html#setup",
    "href": "Hiplot/125-multiple-histograms.html#setup",
    "title": "Multiple Histograms",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Multiple Histograms"
    ]
  },
  {
    "objectID": "Hiplot/125-multiple-histograms.html#data-preparation",
    "href": "Hiplot/125-multiple-histograms.html#data-preparation",
    "title": "Multiple Histograms",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/multiple-histograms/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# View data\nhead(data)\n\n  type    value\n1   v1 3.059937\n2   v1 1.907186\n3   v1 4.278629\n4   v1 3.834794\n5   v1 5.493830\n6   v1 1.380032",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Multiple Histograms"
    ]
  },
  {
    "objectID": "Hiplot/125-multiple-histograms.html#visualization",
    "href": "Hiplot/125-multiple-histograms.html#visualization",
    "title": "Multiple Histograms",
    "section": "Visualization",
    "text": "Visualization\n\n# Multiple Histograms\np &lt;- ggplot(data, aes(x = value, fill = type)) +\n  geom_histogram(color = \"black\", alpha = 0.5, \n                 position = \"identity\", binwidth = 0.3) +\n  scale_fill_manual(values = c(\"#BC3C29FF\",\"#0072B5FF\")) +\n  theme_bw()\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Multiple Histograms",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Multiple Histograms"
    ]
  },
  {
    "objectID": "Hiplot/134-parliament.html",
    "href": "Hiplot/134-parliament.html",
    "title": "Parliament",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Parliament plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/parliament?lang=en\nThe parliamentary chart is a data processing method that looks like a parliamentary seat, with points representing a data set to show the share ratio of each group more flexibly.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Parliament"
    ]
  },
  {
    "objectID": "Hiplot/134-parliament.html#setup",
    "href": "Hiplot/134-parliament.html#setup",
    "title": "Parliament",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggpol; ggplot2\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggpol\", quietly = TRUE)) {\n  install.packages(\"ggpol\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggpol)\nlibrary(ggplot2)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Parliament"
    ]
  },
  {
    "objectID": "Hiplot/134-parliament.html#data-preparation",
    "href": "Hiplot/134-parliament.html#data-preparation",
    "title": "Parliament",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data are groups and their corresponding values.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/parliament/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# View data\nhead(data)\n\n  group value\n1    G1   200\n2    G2    46\n3    G3    92\n4    G4    80\n5    G5   150",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Parliament"
    ]
  },
  {
    "objectID": "Hiplot/134-parliament.html#visualization",
    "href": "Hiplot/134-parliament.html#visualization",
    "title": "Parliament",
    "section": "Visualization",
    "text": "Visualization\n\n# Parliament\np &lt;- ggplot(data) +\n  geom_parliament(alpha = 1, aes(seats = value, fill = group), color = \"black\") +\n  coord_fixed() +\n  scale_fill_discrete(name = \"group\", labels = unique(data$group)) +\n  scale_fill_manual(values = c(\"#E64B35FF\",\"#4DBBD5FF\",\"#00A087FF\",\"#3C5488FF\",\n                                \"#F39B7FFF\")) +\n  ggtitle(\"Parliament Plot\") +\n  theme_void() +\n  theme(legend.position = \"bottom\",\n        plot.title = element_text(hjust = 0.5))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Parliament\n\n\n\n\n\nDifferent colors represent different groups, and each dot represents one data point. Itâ€™s a semicircle of points, the smallest fraction of which can be represented by a single point in a parliamentary diagram.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Parliament"
    ]
  },
  {
    "objectID": "Hiplot/109-map-oceania-antarc.html",
    "href": "Hiplot/109-map-oceania-antarc.html",
    "title": "Oceania/Antarc Map",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Oceania/Antarc Map plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/map-oceania-antarc?lang=en",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Oceania/Antarc Map"
    ]
  },
  {
    "objectID": "Hiplot/109-map-oceania-antarc.html#setup",
    "href": "Hiplot/109-map-oceania-antarc.html#setup",
    "title": "Oceania/Antarc Map",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2; RColorBrewer\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(RColorBrewer)",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Oceania/Antarc Map"
    ]
  },
  {
    "objectID": "Hiplot/109-map-oceania-antarc.html#data-preparation",
    "href": "Hiplot/109-map-oceania-antarc.html#data-preparation",
    "title": "Oceania/Antarc Map",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/map-oceania-antarc/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\ndt_map &lt;- readRDS(url(\"https://download.hiplot.cn/ui/basic/map-oceania-antarc/oca.rds\"))\n\n# Convert data structure\ndt_map$Value &lt;- data$value[match(dt_map$ENG_NAME, data$region)]\n\n# View data\nhead(data)\n\n                      region value\n1        American Samoa (US)   672\n2                 Antarctica     3\n3    Pacific Is Refuges (US)   320\n4 Cook Islands (NEW ZEALAND)   740\n5                       FIJI   303\n6  French Polynesia (FRANCE)   879",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Oceania/Antarc Map"
    ]
  },
  {
    "objectID": "Hiplot/109-map-oceania-antarc.html#visualization",
    "href": "Hiplot/109-map-oceania-antarc.html#visualization",
    "title": "Oceania/Antarc Map",
    "section": "Visualization",
    "text": "Visualization\n\n# Oceania/Antarc Map\np &lt;- ggplot(dt_map) +\n  geom_polygon(aes(x = long, y = lat, group = group, fill = Value),\n               alpha = 0.9, size = 0.5) +\n  geom_path(aes(x = long, y = lat, group = group), color = \"black\", size = 0.2) +\n  coord_fixed() +\n  scale_fill_gradientn(\n    colours = colorRampPalette(rev(brewer.pal(11,\"RdYlBu\")))(500),\n    breaks = seq(min(data$value), max(data$value), \n                 round((max(data$value)-min(data$value))/7)),\n    name = \"Color Key\",\n    guide = guide_legend(\n      direction = \"vertical\", keyheight = unit(1, units = \"mm\"),\n      keywidth = unit(8, units = \"mm\"),\n      title.position = \"top\", title.hjust = 0.5, label.hjust = 0.5,\n      nrow = 1, byrow = T, reverse = F, label.position = \"bottom\")) +\n  theme(text = element_text(color = \"#3A3F4A\"),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank(),\n        legend.position = \"top\",\n        legend.text = element_text(size = 4 * 1.5, color = \"black\"),\n        legend.title = element_text(size = 5 * 1.5, color = \"black\"),\n        plot.title = element_text(\n          face = \"bold\", size = 5 * 1.5, hjust = 0.5, \n          margin = margin(t = 4, b = 5), color = \"black\"),\n        plot.background = element_rect(fill = \"#FFFFFF\", color = \"#FFFFFF\"),\n        panel.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        legend.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        plot.margin = unit(c(1.5, 1.5, 1.5, 1.5), \"cm\")) +\n  labs(x = NULL, y = NULL, title = \"Oceania/Antarc Map\")\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Oceania/Antarc Map",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Oceania/Antarc Map"
    ]
  },
  {
    "objectID": "Hiplot/133-pareto-chart.html",
    "href": "Hiplot/133-pareto-chart.html",
    "title": "Pareto Chart",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Pareto Chart plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/pareto-chart?lang=en",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pareto Chart"
    ]
  },
  {
    "objectID": "Hiplot/133-pareto-chart.html#setup",
    "href": "Hiplot/133-pareto-chart.html#setup",
    "title": "Pareto Chart",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pareto Chart"
    ]
  },
  {
    "objectID": "Hiplot/133-pareto-chart.html#data-preparation",
    "href": "Hiplot/133-pareto-chart.html#data-preparation",
    "title": "Pareto Chart",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe case data represents the sales data of a product on multiple platforms. The plugin will automatically plot a bar chart with sales data in descending order and simultaneously calculate the cumulative sales to draw the cumulative line chart.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/pareto-chart/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\ndata &lt;- data[order(-data[[\"sales\"]]), ]\ndata[[\"channel\"]] &lt;- factor(data[[\"channel\"]], levels = data[[\"channel\"]])\n## Calculate percentage number\ndata$accumulating &lt;- cumsum(data[[\"sales\"]])\nmax_y &lt;- max(data[[\"sales\"]])\ncal_num &lt;- sum(data[[\"sales\"]]) / max_y\ndata$accumulating &lt;- data$accumulating / cal_num\n\n# View data\nhead(data)\n\n    channel sales accumulating\n2        JD   500     132.9787\n5     Tmall   400     239.3617\n4 Pinduoduo   300     319.1489\n3    Amazon   230     380.3191\n6    Shopee   200     433.5106\n1    TaoBao   100     460.1064",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pareto Chart"
    ]
  },
  {
    "objectID": "Hiplot/133-pareto-chart.html#visualization",
    "href": "Hiplot/133-pareto-chart.html#visualization",
    "title": "Pareto Chart",
    "section": "Visualization",
    "text": "Visualization\n\n# Pareto Chart\np &lt;- ggplot(data, aes(x = channel, y = sales, fill = channel)) +\n  geom_bar(stat = \"identity\") +\n  geom_line(aes(y = accumulating), group = 1) +\n  geom_point(aes(y = accumulating), show.legend = FALSE) +\n  scale_y_continuous(sec.axis = sec_axis(trans = ~ . / max_y * 100, name = \"Percentage\")) +\n  scale_fill_manual(values = c(\"#E64B35FF\",\"#4DBBD5FF\",\"#00A087FF\",\"#3C5488FF\",\n                               \"#F39B7FFF\",\"#8491B4FF\",\"#91D1C2FF\",\"#DC0000FF\")) +\n  theme_bw()\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Pareto Chart",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pareto Chart"
    ]
  },
  {
    "objectID": "Hiplot/019-chi-square-fisher.html",
    "href": "Hiplot/019-chi-square-fisher.html",
    "title": "Chi-square-fisher Test",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Chi-square-fisher Test plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/chi-square-fisher?lang=en\nChi-square and Fisher test can be used to test the frequency difference of categorical variables. The tool will automatically select the statistical method of Chi-square and Fisher exact test.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Chi-square-fisher Test"
    ]
  },
  {
    "objectID": "Hiplot/019-chi-square-fisher.html#setup",
    "href": "Hiplot/019-chi-square-fisher.html#setup",
    "title": "Chi-square-fisher Test",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2; visdat; aplot\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"visdat\", quietly = TRUE)) {\n  install.packages(\"visdat\")\n}\nif (!requireNamespace(\"aplot\", quietly = TRUE)) {\n  install.packages(\"aplot\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(visdat)\nlibrary(aplot)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Chi-square-fisher Test"
    ]
  },
  {
    "objectID": "Hiplot/019-chi-square-fisher.html#data-preparation",
    "href": "Hiplot/019-chi-square-fisher.html#data-preparation",
    "title": "Chi-square-fisher Test",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe data table supports two formats: contingency table (example 1) and single-row record table (example 2)\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/chi-square-fisher/data.json\")$exampleData[[1]]$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# convert data structure\nrownames(data) &lt;- data[,1]\ndata &lt;- data[,-1]\ncb &lt;- combn(nrow(data), 2)\nfinal &lt;- data.frame()\nfor (i in 1:ncol(cb)) {\n  tmp &lt;- data[cb[,i],]\n  groups &lt;- paste0(rownames(data)[cb[,i]], collapse = \" | \")\n  \n  res &lt;- tryCatch({\n    chisq.test(tmp)\n    }, warning = function(w) {\n      tryCatch({fisher.test(tmp)}, error = function(e) {\n        return(fisher.test(tmp, simulate.p.value = TRUE))\n        })\n  })\n  val_percent &lt;- apply(tmp, 1, function(x) {\n    sprintf(\"%s (%s%%)\", x, round(x / sum(x), 2) * 100)\n  })\n  val_percent1 &lt;- paste0(colnames(tmp), \":\", val_percent[,1])\n  val_percent1 &lt;- paste0(val_percent1, collapse = \" | \")\n  val_percent2 &lt;- paste0(colnames(tmp), \":\", val_percent[,2])\n  val_percent2 &lt;- paste0(val_percent2, collapse = \" | \")\n  tmp &lt;- data.frame(\n    groups = groups,\n    val_percent_left = val_percent1,\n    val_percent_right = val_percent2,\n    statistic = ifelse(is.null(res$statistic), NA,\n      as.numeric(res$statistic)),\n    pvalue = as.numeric(res$p.value),\n    method = res$method\n  )\n  final &lt;- rbind(final, tmp)\n}\nfinal &lt;- as.data.frame(final)\nfinal$pvalue &lt; as.numeric(final$pvalue)\n\n [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n\nfinal$statistic &lt; as.numeric(final$statistic)\n\n [1] FALSE FALSE FALSE    NA FALSE FALSE    NA FALSE    NA    NA\n\n# View data\nhead(final)\n\n  groups                        val_percent_left\n1  A | B L:401 (48%) | M:216 (26%) | H:221 (26%)\n2  A | C L:401 (48%) | M:216 (26%) | H:221 (26%)\n3  A | D L:401 (48%) | M:216 (26%) | H:221 (26%)\n4  A | E L:401 (48%) | M:216 (26%) | H:221 (26%)\n5  B | C L:254 (37%) | M:259 (38%) | H:169 (25%)\n6  B | D L:254 (37%) | M:259 (38%) | H:169 (25%)\n                        val_percent_right    statistic       pvalue\n1 L:254 (37%) | M:259 (38%) | H:169 (25%) 2.810229e+01 7.900708e-07\n2 L:400 (48%) | M:215 (26%) | H:220 (26%) 4.566425e-04 9.997717e-01\n3 L:252 (38%) | M:251 (38%) | H:162 (24%) 2.614390e+01 2.103411e-06\n4       L:3 (23%) | M:5 (38%) | H:5 (38%)           NA 1.633146e-01\n5 L:400 (48%) | M:215 (26%) | H:220 (26%) 2.821998e+01 7.449197e-07\n6 L:252 (38%) | M:251 (38%) | H:162 (24%) 6.689139e-02 9.671074e-01\n                              method\n1         Pearson's Chi-squared test\n2         Pearson's Chi-squared test\n3         Pearson's Chi-squared test\n4 Fisher's Exact Test for Count Data\n5         Pearson's Chi-squared test\n6         Pearson's Chi-squared test",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Chi-square-fisher Test"
    ]
  },
  {
    "objectID": "Hiplot/019-chi-square-fisher.html#visualization",
    "href": "Hiplot/019-chi-square-fisher.html#visualization",
    "title": "Chi-square-fisher Test",
    "section": "Visualization",
    "text": "Visualization\n\n# Chi-square-fisher Test\np1 &lt;- vis_value(final[\"statistic\"]) + \n  scale_fill_gradientn(colours = c(\"#3362ab\",\"#87b7d7\",\"#e8e0db\",\"#eea07d\",\"#ad1c2e\"))\n\np2 &lt;- vis_expect(final[\"pvalue\"], ~.x &lt; 0.05) +\n  scale_fill_manual(values = c(\"#1c438a\",\"#e7120c\"))\n\np &lt;- p1+p2\np\n\n\n\n\n\n\n\nFigureÂ 1: Chi-square-fisher Test",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Chi-square-fisher Test"
    ]
  },
  {
    "objectID": "Hiplot/091-likert.html",
    "href": "Hiplot/091-likert.html",
    "title": "Likert Plot",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Likert Plot plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/likert?lang=en\nDescriptive statistical analysis of Likert scale data.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Likert Plot"
    ]
  },
  {
    "objectID": "Hiplot/091-likert.html#setup",
    "href": "Hiplot/091-likert.html#setup",
    "title": "Likert Plot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplotify; likert\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\nif (!requireNamespace(\"likert\", quietly = TRUE)) {\n  install.packages(\"likert\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplotify)\nlibrary(likert)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Likert Plot"
    ]
  },
  {
    "objectID": "Hiplot/091-likert.html#data-preparation",
    "href": "Hiplot/091-likert.html#data-preparation",
    "title": "Likert Plot",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/likert/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\nlevs &lt;- unique(unlist(data))\nfor (i in 1:ncol(data)) {\n  data[,i] &lt;- factor(data[, i], levels = levs)\n}\n\n# View data\nhead(data)\n\n            ST24Q01           ST24Q02        ST24Q03           ST24Q04\n1 Strongly disagree    Strongly agree          Agree Strongly disagree\n2          Disagree    Strongly agree Strongly agree Strongly disagree\n3          Disagree          Disagree       Disagree             Agree\n4          Disagree          Disagree       Disagree          Disagree\n5          Disagree             Agree       Disagree Strongly disagree\n6             Agree Strongly disagree          Agree Strongly disagree\n            ST24Q05           ST24Q06        ST24Q07           ST24Q08\n1             Agree Strongly disagree          Agree          Disagree\n2    Strongly agree Strongly disagree          Agree          Disagree\n3          Disagree          Disagree       Disagree          Disagree\n4          Disagree Strongly disagree       Disagree          Disagree\n5             Agree Strongly disagree Strongly agree Strongly disagree\n6 Strongly disagree          Disagree       Disagree             Agree\n            ST24Q09           ST24Q10           ST24Q11\n1 Strongly disagree             Agree             Agree\n2 Strongly disagree             Agree             Agree\n3          Disagree          Disagree          Disagree\n4 Strongly disagree          Disagree          Disagree\n5 Strongly disagree Strongly disagree             Agree\n6          Disagree             Agree Strongly disagree",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Likert Plot"
    ]
  },
  {
    "objectID": "Hiplot/091-likert.html#visualization",
    "href": "Hiplot/091-likert.html#visualization",
    "title": "Likert Plot",
    "section": "Visualization",
    "text": "Visualization\n\n# Likert Plot\npobj &lt;- likert(data)\ncolrs &lt;- c(\"#3B4992FF\",\"#EE0000FF\")\np &lt;- as.ggplot(plot(pobj, type = \"bar\", \n                    low.color = colrs[1], high.color = colrs[2], wrap = 50))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Likert Plot",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Likert Plot"
    ]
  },
  {
    "objectID": "Hiplot/074-ggseqlogo.html",
    "href": "Hiplot/074-ggseqlogo.html",
    "title": "Seqlogo",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Seqlogo plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/ggseqlogo?lang=en\nThe sequence LOGO is a graphic that describes a sequence pattern of binding sites.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Seqlogo"
    ]
  },
  {
    "objectID": "Hiplot/074-ggseqlogo.html#setup",
    "href": "Hiplot/074-ggseqlogo.html#setup",
    "title": "Seqlogo",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggseqlogo; ggplot2\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggseqlogo\", quietly = TRUE)) {\n  install.packages(\"ggseqlogo\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggseqlogo)\nlibrary(ggplot2)",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Seqlogo"
    ]
  },
  {
    "objectID": "Hiplot/074-ggseqlogo.html#data-preparation",
    "href": "Hiplot/074-ggseqlogo.html#data-preparation",
    "title": "Seqlogo",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data is the Sequence of binding sites for multiple transcription factors on multiple genes.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/ggseqlogo/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\ndata &lt;- data[, !sapply(data, function(x) {all(is.na(x))})]\ndata &lt;- as.list(data)\ndata &lt;- lapply(data, function(x) {return(x[!is.na(x)])})\n\n# View data\nstr(data[1:5])\n\nList of 5\n $ MA0001.1: chr [1:97] \"CCATATATAG\" \"CCATATATAG\" \"CCATAAATAG\" \"CCATAAATAG\" ...\n $ MA0002.1: chr [1:26] \"AATTGTGGTTA\" \"ATCTGTGGTTA\" \"AATTGTGGTAA\" \"TTCTGCGGTTA\" ...\n $ MA0004.1: chr [1:20] \"CACGTG\" \"CACGTG\" \"CACGTG\" \"CACGTG\" ...\n $ MA0005.1: chr [1:90] \"CCTAATTGGGC\" \"CCTAATTTGGC\" \"CCTAATCGGGC\" \"CCTAATCGGGC\" ...\n $ MA0006.1: chr [1:24] \"CGCGTG\" \"CGCGTG\" \"CGCGTG\" \"CGCGTG\" ...",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Seqlogo"
    ]
  },
  {
    "objectID": "Hiplot/074-ggseqlogo.html#visualization",
    "href": "Hiplot/074-ggseqlogo.html#visualization",
    "title": "Seqlogo",
    "section": "Visualization",
    "text": "Visualization\n\n# Seqlogo\np &lt;- ggseqlogo(\n  data,\n  ncol = 4,\n  col_scheme = \"nucleotide\",\n  seq_type = \"dna\",\n  method = \"bits\") + \n  theme(plot.title = element_text(hjust = 0.5))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Seqlogo\n\n\n\n\n\nA sequence of binding sites was displayed in a column of the chart by means of BITS calculation, which could clearly observe the large proportion of bases of different sequences.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Seqlogo"
    ]
  },
  {
    "objectID": "Hiplot/075-ggwithinstats.html",
    "href": "Hiplot/075-ggwithinstats.html",
    "title": "Complex-Violin",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Complex-Violin plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/ggwithinstats?lang=en",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Complex-Violin"
    ]
  },
  {
    "objectID": "Hiplot/075-ggwithinstats.html#setup",
    "href": "Hiplot/075-ggwithinstats.html#setup",
    "title": "Complex-Violin",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggstatsplot; ggplot2; cowplot\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggstatsplot\", quietly = TRUE)) {\n  install.packages(\"ggstatsplot\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"cowplot\", quietly = TRUE)) {\n  install.packages(\"cowplot\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggstatsplot)\nlibrary(ggplot2)\nlibrary(cowplot)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Complex-Violin"
    ]
  },
  {
    "objectID": "Hiplot/075-ggwithinstats.html#data-preparation",
    "href": "Hiplot/075-ggwithinstats.html#data-preparation",
    "title": "Complex-Violin",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/ggwithinstats/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\naxis &lt;- c(\"condition\", \"desire\", \"region\")\ndata[, axis[1]] &lt;- factor(data[, axis[1]], levels = unique(data[, axis[1]]))\ndata[, axis[3]] &lt;- factor(data[, axis[3]], levels = unique(data[, axis[3]]))\n\n# View data\nstr(data)\n\n'data.frame':   172 obs. of  6 variables:\n $ subject  : int  1 2 3 4 5 6 7 8 9 11 ...\n $ gender   : chr  \"Female\" \"Female\" \"Female\" \"Female\" ...\n $ region   : Factor w/ 2 levels \"North America\",..: 1 1 2 1 1 2 1 1 1 1 ...\n $ education: chr  \"some\" \"advance\" \"college\" \"college\" ...\n $ condition: Factor w/ 2 levels \"LDLF\",\"LDHF\": 1 1 1 1 1 1 1 1 1 1 ...\n $ desire   : num  6 10 5 6 3 2 10 10 9.5 0 ...",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Complex-Violin"
    ]
  },
  {
    "objectID": "Hiplot/075-ggwithinstats.html#visualization",
    "href": "Hiplot/075-ggwithinstats.html#visualization",
    "title": "Complex-Violin",
    "section": "Visualization",
    "text": "Visualization\n\n# Complex-Violin\ng &lt;- unique(data[,axis[3]])\nplist &lt;- list()\nfor (i in 1:length(g)) {\n  fil &lt;- data[,axis[3]] == g[i]\n  plist[[i]] &lt;- ggwithinstats(\n    data = data[fil,], x = condition, y = desire,\n    title= paste('', axis[3], g[i], sep = ':'),\n    p.adjust.method = \"holm\",\n    plot.type = \"boxviolin\",\n    pairwise.comparisons = T,\n    pairwise.display = \"significant\",\n    effsize.type = \"unbiased\",\n    notch = T,\n    type = \"parametric\",\n    k = 2,\n    plotgrid.args = list(ncol = 2)\n  ) +\n    scale_color_manual(values = c(\"#3B4992FF\",\"#EE0000FF\"))\n}\n\nplot_grid(plotlist = plist, ncol = 2)\n\n\n\n\n\n\n\nFigureÂ 1: Complex-Violin",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Complex-Violin"
    ]
  },
  {
    "objectID": "Hiplot/100-map-china.html",
    "href": "Hiplot/100-map-china.html",
    "title": "China Map",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot China Map plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/map-china?lang=en",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "China Map"
    ]
  },
  {
    "objectID": "Hiplot/100-map-china.html#setup",
    "href": "Hiplot/100-map-china.html#setup",
    "title": "China Map",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2; RColorBrewer\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(RColorBrewer)",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "China Map"
    ]
  },
  {
    "objectID": "Hiplot/100-map-china.html#data-preparation",
    "href": "Hiplot/100-map-china.html#data-preparation",
    "title": "China Map",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/map-china/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\ndt_map &lt;- readRDS(url(\"https://download.hiplot.cn/ui/basic/map-china/china.rds\"))\n\n# Convert data structure\ndt_map$Value &lt;- data$value[match(dt_map$FCNAME, data$name)]\n\n# View data\nhead(data)\n\n    name value\n1 å®‰å¾½çœ  6118\n2 ç¦å»ºçœ  3581\n3 ç”˜è‚ƒçœ  2617\n4 å¹¿ä¸œçœ  9449\n5 è´µå·çœ  3762\n6 æµ·å—çœ   845",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "China Map"
    ]
  },
  {
    "objectID": "Hiplot/100-map-china.html#visualization",
    "href": "Hiplot/100-map-china.html#visualization",
    "title": "China Map",
    "section": "Visualization",
    "text": "Visualization\n\n# China Map\np &lt;- ggplot(dt_map, aes(x = long, y = lat, group = group, fill = Value)) +\n  labs(fill = \"Value\") +\n  geom_polygon() +\n  geom_path() +\n  coord_fixed() +\n  scale_fill_gradientn(\n    colours = colorRampPalette(rev(brewer.pal(11,\"RdYlBu\")))(500),\n    na.value = \"grey10\",\n    limits = c(0, max(dt_map$Value) * 1.2)) +\n    ggtitle(\"China Map Plot\") +\n  theme_minimal()\n\np\n\n\n\n\n\n\n\nFigureÂ 1: China Map",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "China Map"
    ]
  },
  {
    "objectID": "Hiplot/047-dual-y-axis.html",
    "href": "Hiplot/047-dual-y-axis.html",
    "title": "Dual Y Axis Chart",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Dual Y Axis Chart plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/dual-y-axis?lang=en\nThe dual Y-axis graph can put two groups of data with larger orders of magnitude in the same graph for display.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Dual Y Axis Chart"
    ]
  },
  {
    "objectID": "Hiplot/047-dual-y-axis.html#setup",
    "href": "Hiplot/047-dual-y-axis.html#setup",
    "title": "Dual Y Axis Chart",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Dual Y Axis Chart"
    ]
  },
  {
    "objectID": "Hiplot/047-dual-y-axis.html#data-preparation",
    "href": "Hiplot/047-dual-y-axis.html#data-preparation",
    "title": "Dual Y Axis Chart",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data is divided into three columns, the first column is the value of the x-axis, the second column is the value of the left Y-axis, and the third column is the value of the right Y-axis.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/dual-y-axis/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# View data\nhead(data)\n\n  x     data1     data2\n1 1 0.6105444 1000.5383\n2 2 0.9961953  981.0398\n3 3 0.6314076  961.0601\n4 4 0.8651855  941.2540\n5 5 0.8169382  922.3971\n6 6 0.1877025  903.3067",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Dual Y Axis Chart"
    ]
  },
  {
    "objectID": "Hiplot/047-dual-y-axis.html#visualization",
    "href": "Hiplot/047-dual-y-axis.html#visualization",
    "title": "Dual Y Axis Chart",
    "section": "Visualization",
    "text": "Visualization\n\n# Dual Y Axis Chart\np &lt;- ggplot(data, aes(x = x)) +\n  geom_line(aes(y = data[, 2]), size = 1, color = \"#D72C15\") +\n  geom_line(aes(y = data[, 3] / as.numeric(10)), size = 1, color = \"#02657B\") +\n  scale_y_continuous(\n    name = colnames(data)[2],\n    sec.axis = sec_axis(~ . * as.numeric(10), name = colnames(data)[3])) +\n  ggtitle(\"Dual Y Axis Chart\") + xlab(\"x\") +\n  theme_bw() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Dual Y Axis Chart\n\n\n\n\n\nInterpretation of case statistics graphics In the case data, the Y-axis scale on the left is in the range of 0-100, while the Y-axis scale on the right is 0-1000.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Dual Y Axis Chart"
    ]
  },
  {
    "objectID": "Hiplot/104-map-france.html",
    "href": "Hiplot/104-map-france.html",
    "title": "France Map",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot France Map plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/map-france?lang=en",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "France Map"
    ]
  },
  {
    "objectID": "Hiplot/104-map-france.html#setup",
    "href": "Hiplot/104-map-france.html#setup",
    "title": "France Map",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2; RColorBrewer\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(RColorBrewer)",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "France Map"
    ]
  },
  {
    "objectID": "Hiplot/104-map-france.html#data-preparation",
    "href": "Hiplot/104-map-france.html#data-preparation",
    "title": "France Map",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/map-france/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\ndt_map &lt;- readRDS(url(\"https://download.hiplot.cn/ui/basic/map-france/france.rds\"))\n\n# Convert data structure\ndt_map$Value &lt;- data$value[match(dt_map$ENG_NAME, data$name)]\n\n# View data\nhead(data)\n\n            name value\n1       Bas-Rhin   338\n2      Haut-Rhin   353\n3       Dordogne   168\n4        Gironde   158\n5         Landes   221\n6 Lot-et-Garonne   658",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "France Map"
    ]
  },
  {
    "objectID": "Hiplot/104-map-france.html#visualization",
    "href": "Hiplot/104-map-france.html#visualization",
    "title": "France Map",
    "section": "Visualization",
    "text": "Visualization\n\n# France Map\np &lt;- ggplot(dt_map) +\n  geom_polygon(aes(x = long, y = lat, group = group, fill = Value),\n               alpha = 0.9, size = 0.5) +\n  geom_path(aes(x = long, y = lat, group = group), color = \"black\", size = 0.2) +\n  coord_fixed() +\n  scale_fill_gradientn(\n    colours = colorRampPalette(rev(brewer.pal(11,\"RdYlBu\")))(500),\n    breaks = seq(min(data$value), max(data$value), \n                 round((max(data$value)-min(data$value))/7)),\n    name = \"Color Key\",\n    guide = guide_legend(\n      direction = \"vertical\", keyheight = unit(1, units = \"mm\"),\n      keywidth = unit(8, units = \"mm\"),\n      title.position = \"top\", title.hjust = 0.5, label.hjust = 0.5,\n      nrow = 1, byrow = T, reverse = F, label.position = \"bottom\")) +\n  theme(text = element_text(color = \"#3A3F4A\"),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank(),\n        legend.position = \"top\",\n        legend.text = element_text(size = 4 * 1.5, color = \"black\"),\n        legend.title = element_text(size = 5 * 1.5, color = \"black\"),\n        plot.title = element_text(\n          face = \"bold\", size = 5 * 1.5, hjust = 0.5, \n          margin = margin(t = 4, b = 5), color = \"black\"),\n        plot.background = element_rect(fill = \"#FFFFFF\", color = \"#FFFFFF\"),\n        panel.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        legend.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        plot.margin = unit(c(1.5, 1.5, 1.5, 1.5), \"cm\")) +\n  labs(x = NULL, y = NULL, title = \"France Map\")\n\np\n\n\n\n\n\n\n\nFigureÂ 1: France Map",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "France Map"
    ]
  },
  {
    "objectID": "Hiplot/160-scatter-gradient.html",
    "href": "Hiplot/160-scatter-gradient.html",
    "title": "Gradient Scatter",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Gradient Scatter plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/scatter-gradient?lang=en\nTwo-dimensional spatial scatter to demonstrate multi-numerical variable relationships.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Gradient Scatter"
    ]
  },
  {
    "objectID": "Hiplot/160-scatter-gradient.html#setup",
    "href": "Hiplot/160-scatter-gradient.html#setup",
    "title": "Gradient Scatter",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; grafify; ggplot2\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"grafify\", quietly = TRUE)) {\n  install.packages(\"grafify\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(grafify)\nlibrary(ggplot2)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Gradient Scatter"
    ]
  },
  {
    "objectID": "Hiplot/160-scatter-gradient.html#data-preparation",
    "href": "Hiplot/160-scatter-gradient.html#data-preparation",
    "title": "Gradient Scatter",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/scatter-gradient/data.json\")$exampleData[[1]]$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# View data\nhead(data)\n\n                car  mpg cyl disp  hp drat    wt  qsec vs am gear carb\n1         Mazda RX4 21.0   6  160 110 3.90 2.620 16.46  0  1    4    4\n2     Mazda RX4 Wag 21.0   6  160 110 3.90 2.875 17.02  0  1    4    4\n3        Datsun 710 22.8   4  108  93 3.85 2.320 18.61  1  1    4    1\n4    Hornet 4 Drive 21.4   6  258 110 3.08 3.215 19.44  1  0    3    1\n5 Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2\n6           Valiant 18.1   6  225 105 2.76 3.460 20.22  1  0    3    1",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Gradient Scatter"
    ]
  },
  {
    "objectID": "Hiplot/160-scatter-gradient.html#visualization",
    "href": "Hiplot/160-scatter-gradient.html#visualization",
    "title": "Gradient Scatter",
    "section": "Visualization",
    "text": "Visualization\n\n# Gradient Scatter\np &lt;- ggplot(data, aes(x = mpg, y = disp)) + \n  geom_point(aes(fill = gear), size = 5, alpha = 1, shape = 21, stroke = 0.5) +\n  labs(fill = \"gear\", color = \"gear\") +\n  theme_classic(base_size = 10) +\n  theme(strip.background = element_blank()) +\n  guides(x = guide_axis(angle = 0)) +\n  scale_fill_gradient(low = \"#00438E\", high = \"#E43535\") +\n  scale_color_gradient(low = \"#00438E\", high = \"#E43535\") + \n  guides(fill = guide_legend(title = \"gear\"),\n         size = guide_legend(title = \"gear\")) +\n  ggtitle(\"Scatter-gradient Plot\") +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Gradient Scatter",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Gradient Scatter"
    ]
  },
  {
    "objectID": "Hiplot/024-circular-pie-chart.html",
    "href": "Hiplot/024-circular-pie-chart.html",
    "title": "Circular Pie Chart",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Circular Pie Chart plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/circular-pie-chart?lang=en\nAnother form of the pie chart.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Circular Pie Chart"
    ]
  },
  {
    "objectID": "Hiplot/024-circular-pie-chart.html#setup",
    "href": "Hiplot/024-circular-pie-chart.html#setup",
    "title": "Circular Pie Chart",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Circular Pie Chart"
    ]
  },
  {
    "objectID": "Hiplot/024-circular-pie-chart.html#data-preparation",
    "href": "Hiplot/024-circular-pie-chart.html#data-preparation",
    "title": "Circular Pie Chart",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/circular-pie-chart/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# convert data structure\ndata$draw_percent &lt;- data[[\"values\"]] / sum(data[[\"values\"]]) * 100\ndata$draw_class &lt;- 1\ndata2 &lt;- data\ndata2[[\"values\"]] &lt;- 0\ndata2$draw_class &lt;- 0\ndata &lt;- rbind(data, data2)\nfiltered_data &lt;- data[data[[\"values\"]] &gt; 0,]\n\n# View data\nhead(data)\n\n  labels values draw_percent draw_class\n1      A     20    16.666667          1\n2      B     30    25.000000          1\n3      C     15    12.500000          1\n4      D     10     8.333333          1\n5      E     45    37.500000          1\n6      A      0    16.666667          0",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Circular Pie Chart"
    ]
  },
  {
    "objectID": "Hiplot/024-circular-pie-chart.html#visualization",
    "href": "Hiplot/024-circular-pie-chart.html#visualization",
    "title": "Circular Pie Chart",
    "section": "Visualization",
    "text": "Visualization\n\n# Circular Pie Chart\np &lt;- ggplot(data, aes(x = draw_class, y = values, fill = labels)) +\n  geom_bar(position = \"stack\", stat = \"identity\", width = 0.7) +\n  geom_text(data = filtered_data, aes(label = sprintf(\"%.2f%%\", draw_percent)),\n            position = position_stack(vjust = 0.5), size = 3) +\n  coord_polar(theta = \"y\") +\n  xlab(\"\") +\n  ylab(\"Pie Chart\") +\n  scale_fill_manual(values = c(\"#e64b35ff\",\"#4dbbd5ff\",\"#00a087ff\",\"#3c5488ff\",\"#f39b7fff\")) +\n  theme_minimal() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(color = \"black\"),\n        axis.text.y = element_blank(),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10),\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank())\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Circular Pie Chart",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Circular Pie Chart"
    ]
  },
  {
    "objectID": "Hiplot/141-pie.html",
    "href": "Hiplot/141-pie.html",
    "title": "Pie",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Pie plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/pie?lang=en\nThe pie chart is a statistical chart that shows the proportion of each part by dividing a circle into sections.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pie"
    ]
  },
  {
    "objectID": "Hiplot/141-pie.html#setup",
    "href": "Hiplot/141-pie.html#setup",
    "title": "Pie",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2; dplyr\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(dplyr)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pie"
    ]
  },
  {
    "objectID": "Hiplot/141-pie.html#data-preparation",
    "href": "Hiplot/141-pie.html#data-preparation",
    "title": "Pie",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data are different groups and their data.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/pie/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n\n# Convert data structure\ncolnames(data) &lt;- c(\"Group\", \"Value\")\ndata &lt;- data %&gt;%\n  arrange(desc(Group)) %&gt;%\n  mutate(prop = Value / sum(data$Value) * 100) %&gt;%\n  mutate(ypos = Value / length(unique(Group)) +\n           c(0, cumsum(Value)[-length(Value)]) + 5)\n\n# View data\nhead(data)\n\n   Group Value     prop   ypos\n1 Group4    43 38.73874  15.75\n2 Group3    21 18.91892  53.25\n3 Group2    34 30.63063  77.50\n4 Group1    13 11.71171 106.25",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pie"
    ]
  },
  {
    "objectID": "Hiplot/141-pie.html#visualization",
    "href": "Hiplot/141-pie.html#visualization",
    "title": "Pie",
    "section": "Visualization",
    "text": "Visualization\n\n# Pie\np &lt;- ggplot(data, aes(x = \"\", y = Value, fill = Group)) +\n  geom_col(width = 1) +\n  geom_bar(stat = \"identity\", width = 1, color = \"white\") +\n  geom_text(aes(y = ypos, \n                label = sprintf(\"%s\\n(n=%s, %s%%)\", Group, Value,\n                                round(Value / sum(data$Value) * 100, 2))), \n            color = \"white\", fontface = \"bold\") +\n  coord_polar(theta = \"y\", start = 0, direction = -1) +\n  guides(fill = guide_legend(title = \"Group\")) +\n  scale_fill_discrete(\n    breaks = data$Group,\n    labels = paste(data$Group,\" (\", round(data$Value / sum(data$Value) * 100, 2),\n                   \"%)\", sep = \"\")) +\n  scale_fill_manual(values = c(\"#00468BFF\",\"#ED0000FF\",\"#42B540FF\",\"#0099B4FF\")) +\n  ggtitle(\"Pie Plot\") + \n  theme_minimal() +\n  theme(\n    axis.title.x = element_blank(),\n    axis.title.y = element_blank(),\n    axis.text.x = element_blank(),\n    axis.text.y = element_blank(),\n    panel.border = element_blank(),\n    panel.grid = element_blank(),\n    axis.ticks = element_blank(),\n    plot.title = element_text(size = 14, face = \"bold\",\n                              hjust = 0.5, vjust = -1),\n    legend.position = \"none\"\n  )\n    \n  \np\n\n\n\n\n\n\n\nFigureÂ 1: Pie\n\n\n\n\n\nIn a circle graph, the arc length of each slice (the arc length of its center Angle and the region corresponding to its center Angle) is proportional to the number represented. The pie chart shows the number of samples for the 1 to 4 components and the corresponding proportions. The number of samples in one group is 13, accounting for 11.71%; the number of samples in two groups is 34, accounting for 30.63%; the number of samples in three groups is 21, accounting for 18.92%; and the number of samples in four groups is 43, accounting for 38.74%.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pie"
    ]
  },
  {
    "objectID": "Hiplot/035-custom-icon-scatter.html",
    "href": "Hiplot/035-custom-icon-scatter.html",
    "title": "Custom Icon Scatter",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Custom Icon Scatter plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/custom-icon-scatter?lang=en\nA scatter plot with customizable icons.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Custom Icon Scatter"
    ]
  },
  {
    "objectID": "Hiplot/035-custom-icon-scatter.html#setup",
    "href": "Hiplot/035-custom-icon-scatter.html#setup",
    "title": "Custom Icon Scatter",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; echarts4r; echarts4r.assets\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"echarts4r\", quietly = TRUE)) {\n  install.packages(\"echarts4r\")\n}\nif (!requireNamespace(\"echarts4r.assets\", quietly = TRUE)) {\n  remotes::install_github(\"JohnCoene/echarts4r.assets\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(echarts4r)\nlibrary(echarts4r.assets)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Custom Icon Scatter"
    ]
  },
  {
    "objectID": "Hiplot/035-custom-icon-scatter.html#data-preparation",
    "href": "Hiplot/035-custom-icon-scatter.html#data-preparation",
    "title": "Custom Icon Scatter",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/custom-icon-scatter/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# convert data structure\ndraw_data &lt;- data.frame(\n  x = data[[\"mpg\"]],\n  y = data[[\"wt\"]],\n  size = data[[\"qsec\"]]\n  )\nrm(data)\n\n# View data\nhead(draw_data)\n\n     x     y  size\n1 21.0 2.620 16.46\n2 21.0 2.875 17.02\n3 22.8 2.320 18.61\n4 21.4 3.215 19.44\n5 18.7 3.440 17.02\n6 18.1 3.460 20.22",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Custom Icon Scatter"
    ]
  },
  {
    "objectID": "Hiplot/035-custom-icon-scatter.html#visualization",
    "href": "Hiplot/035-custom-icon-scatter.html#visualization",
    "title": "Custom Icon Scatter",
    "section": "Visualization",
    "text": "Visualization\n\n# Custom Icon Scatter\np &lt;- draw_data |&gt;\n  e_charts(x) |&gt;\n  e_scatter(\n    y,\n    size,\n    symbol = ea_icons(\"warning\"),\n    name = \"warning\"\n    )\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Custom Icon Scatter",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Custom Icon Scatter"
    ]
  },
  {
    "objectID": "Hiplot/038-density-hist-mirror.html",
    "href": "Hiplot/038-density-hist-mirror.html",
    "title": "Mirror Density & Histogram",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Mirror Density & Histogram plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/density-hist-mirror?lang=en\nThe mirror density & histogram is a graph used to observe the distribution of continuous variables in two side view: top and bottom.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Mirror Density & Histogram"
    ]
  },
  {
    "objectID": "Hiplot/038-density-hist-mirror.html#setup",
    "href": "Hiplot/038-density-hist-mirror.html#setup",
    "title": "Mirror Density & Histogram",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2; ggthemes\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"ggthemes\", quietly = TRUE)) {\n  install.packages(\"ggthemes\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(ggthemes)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Mirror Density & Histogram"
    ]
  },
  {
    "objectID": "Hiplot/038-density-hist-mirror.html#data-preparation",
    "href": "Hiplot/038-density-hist-mirror.html#data-preparation",
    "title": "Mirror Density & Histogram",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/density-hist-mirror/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# convert data structure\nsides &lt;- data[1,]\ndata &lt;- data[-1,]\nfor (i in 1:ncol(data)) {\n  data[,i] &lt;- as.numeric(data[,i])\n}\n\n# View data\nhead(data)\n\n         var1     var2     var3     var4     var5     var6\n2  0.54659146 1.575592 1.508968 2.504824 5.540246 6.198931\n3 -0.64052340 5.275076 1.498841 4.436792 4.987390 5.194154\n4  1.03196438 2.561983 4.018349 3.506171 5.030395 6.570980\n5  0.09518815 1.802874 2.057855 2.789252 4.797252 7.545844\n6  0.89147721 2.627927 2.218567 4.581939 4.791792 5.468657\n7  0.61786781 3.574565 2.051910 4.929031 5.830516 6.105716",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Mirror Density & Histogram"
    ]
  },
  {
    "objectID": "Hiplot/038-density-hist-mirror.html#visualization",
    "href": "Hiplot/038-density-hist-mirror.html#visualization",
    "title": "Mirror Density & Histogram",
    "section": "Visualization",
    "text": "Visualization\n\n1. Mirror Density\n\n# Mirror Density\np &lt;- ggplot(data, aes(x=x))\ncolrs &lt;- c(\"#e64b35ff\",\"#4dbbd5ff\",\"#00a087ff\",\"#3c5488ff\",\"#f39b7fff\",\"#8491b4ff\")\ncolrs2 &lt;- colnames(data)\nfor (i in seq_len(length(sides))) {\n  eval(parse(\n    text = sprintf(\"p &lt;- p + geom_density(aes(x = %s, y = %s..density.., color = '%s', fill = '%s'), kernel = '%s')\", \n                   colnames(data)[i], ifelse(sides[i] == \"top\", \"\", \"-\"), colnames(data)[i],\n                   colnames(data)[i], \"gaussian\")\n    ))\n  names(colrs)[i] &lt;- colnames(data)[i]\n  names(colrs2)[i] &lt;- colrs[i]\n}\np &lt;- p + \n  ggtitle(\"\") +\n  scale_fill_manual(values=colrs, name=\"Densities\") +\n  scale_color_manual(values=colrs, name=\"Densities\") +\n  theme_stata() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Mirror Density\n\n\n\n\n\n\n\n2. Mirror Histogram\n\n# Mirror Histogram\np &lt;- ggplot(data, aes(x=x))\ncolrs &lt;- c(\"#e64b35ff\",\"#4dbbd5ff\",\"#00a087ff\",\"#3c5488ff\",\"#f39b7fff\",\"#8491b4ff\")\ncolrs2 &lt;- colnames(data)\nfor (i in seq_len(length(sides))) {\n  eval(parse(\n    text = sprintf(\"p &lt;- p + geom_histogram(aes(x = %s, y = %s..density.., color = '%s', fill = '%s'), bins = %s)\", \n                   colnames(data)[i], ifelse(sides[i] == \"top\", \"\", \"-\"),\n                   colnames(data)[i], colnames(data)[i], 35)))\n  names(colrs)[i] &lt;- colnames(data)[i]\n  names(colrs2)[i] &lt;- colrs[i]\n}\np &lt;- p + \n  ggtitle(\"\") +\n  scale_fill_manual(values=colrs, name=\"Densities\") +\n  scale_color_manual(values=colrs, name=\"Densities\") +\n  theme_stata() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 2: Mirror Histogram",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Mirror Density & Histogram"
    ]
  },
  {
    "objectID": "Hiplot/112-map-uk-city.html",
    "href": "Hiplot/112-map-uk-city.html",
    "title": "UK Map (City)",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot UK Map (City) plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/map-uk-city?lang=en",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Oceania/Antarc Map"
    ]
  },
  {
    "objectID": "Hiplot/112-map-uk-city.html#setup",
    "href": "Hiplot/112-map-uk-city.html#setup",
    "title": "UK Map (City)",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2; RColorBrewer\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(RColorBrewer)",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Oceania/Antarc Map"
    ]
  },
  {
    "objectID": "Hiplot/112-map-uk-city.html#data-preparation",
    "href": "Hiplot/112-map-uk-city.html#data-preparation",
    "title": "UK Map (City)",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/map-uk-city/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\ndt_map &lt;- readRDS(url(\"https://download.hiplot.cn/ui/basic/map-uk-city/uk_city.rds\"))\n\n# Convert data structure\ndt_map$Value &lt;- data$value[match(dt_map$ENG_NAME, data$name)]\n\n# View data\nhead(data)\n\n               name value\n1 Rhondda Cynon Taf   503\n2       Eilean Siar   221\n3          Bridgend   993\n4           Lincoln   798\n5     Richmondshire   169\n6           Ashford   653",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Oceania/Antarc Map"
    ]
  },
  {
    "objectID": "Hiplot/112-map-uk-city.html#visualization",
    "href": "Hiplot/112-map-uk-city.html#visualization",
    "title": "UK Map (City)",
    "section": "Visualization",
    "text": "Visualization\n\n# UK Map (City)\np &lt;- ggplot(dt_map) +\n  geom_polygon(aes(x = long, y = lat, group = group, fill = Value),\n               alpha = 0.9, size = 0.5) +\n  geom_path(aes(x = long, y = lat, group = group), color = \"black\", size = 0.2) +\n  coord_fixed() +\n  scale_fill_gradientn(\n    colours = colorRampPalette(rev(brewer.pal(11,\"RdYlBu\")))(500),\n    breaks = seq(min(data$value), max(data$value), \n                 round((max(data$value)-min(data$value))/7)),\n    name = \"Color Key\",\n    guide = guide_legend(\n      direction = \"vertical\", keyheight = unit(1, units = \"mm\"),\n      keywidth = unit(8, units = \"mm\"),\n      title.position = \"top\", title.hjust = 0.5, label.hjust = 0.5,\n      nrow = 1, byrow = T, reverse = F, label.position = \"bottom\")) +\n  theme(text = element_text(color = \"#3A3F4A\"),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank(),\n        legend.position = \"top\",\n        legend.text = element_text(size = 4 * 1.5, color = \"black\"),\n        legend.title = element_text(size = 5 * 1.5, color = \"black\"),\n        plot.title = element_text(\n          face = \"bold\", size = 5 * 1.5, hjust = 0.5, \n          margin = margin(t = 4, b = 5), color = \"black\"),\n        plot.background = element_rect(fill = \"#FFFFFF\", color = \"#FFFFFF\"),\n        panel.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        legend.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        plot.margin = unit(c(1.5, 1.5, 1.5, 1.5), \"cm\")) +\n  labs(x = NULL, y = NULL, title = \"UK Map\")\n\np\n\n\n\n\n\n\n\nFigureÂ 1: UK Map (City)",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Oceania/Antarc Map"
    ]
  },
  {
    "objectID": "Omics/NetworkPlot.html",
    "href": "Omics/NetworkPlot.html",
    "title": "Network Plot",
    "section": "",
    "text": "In microbiome research, it is crucial to understand the interactions between microorganisms. Network analysis is a powerful method that can help us visualize and quantify these complex relationships. Next, we will introduce the network operation and annotation functions of the MetaNet package, which can make our network analysis more in-depth and intuitive.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "NetworkPlot"
    ]
  },
  {
    "objectID": "Omics/NetworkPlot.html#example",
    "href": "Omics/NetworkPlot.html#example",
    "title": "Network Plot",
    "section": "Example",
    "text": "Example",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "NetworkPlot"
    ]
  },
  {
    "objectID": "Omics/NetworkPlot.html#setup",
    "href": "Omics/NetworkPlot.html#setup",
    "title": "Network Plot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: MetaNet; pcutils; igraph; dplyr\n\n\n# Installing necessary packages\nif (!requireNamespace(\"MetaNet\", quietly = TRUE)) {\n  install.packages(\"MetaNet\")\n}\nif (!requireNamespace(\"pcutils\", quietly = TRUE)) {\n  install.packages(\"pcutils\")\n}\nif (!requireNamespace(\"igraph\", quietly = TRUE)) {\n  install.packages(\"igraph\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\n\n# Load packages\nlibrary(MetaNet)\nlibrary(pcutils)\nlibrary(igraph)\nlibrary(dplyr)",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "NetworkPlot"
    ]
  },
  {
    "objectID": "Omics/NetworkPlot.html#data-preparation",
    "href": "Omics/NetworkPlot.html#data-preparation",
    "title": "Network Plot",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n1. Load data\n\nThe data uses the otutab dataset in pcutils\nMetaNet is an R package for comprehensive network analysis of omics data\nThe c_net_calculate() function is used to quickly calculate the correlation between variables\nThe c_net_build() function is used to build the network\n\n\ndata(otutab, package = \"pcutils\")\nt(otutab) -&gt; totu\nc_net_calculate(totu, method = \"spearman\") -&gt; corr\nc_net_build(corr, r_threshold = 0.6, p_threshold = 0.05, delete_single = T) -&gt; co_net\nclass(co_net) \n\n[1] \"metanet\" \"igraph\" \n\n\n\n\n2. Get network properties\nAfter building a network with MetaNet, you get a classification object, which comes from igraph. This means that you can use MetaNetâ€™s proprietary functions and igraphâ€™s general functions at the same time. Next, learn how to get basic information about the network:\n\n# Get overall network properties\nget_n(co_net)\n\n  n_type\n1 single\n\n# View node properties\nget_v(co_net) %&gt;% head(5)\n\n                          name  v_group  v_class size\n1 s__un_f__Thermomonosporaceae v_group1 v_class1    4\n2        s__Pelomonas_puraquae v_group1 v_class1    4\n3     s__Rhizobacter_bergeniae v_group1 v_class1    4\n4     s__Flavobacterium_terrae v_group1 v_class1    4\n5         s__un_g__Rhizobacter v_group1 v_class1    4\n                         label  shape   color\n1 s__un_f__Thermomonosporaceae circle #a6bce3\n2        s__Pelomonas_puraquae circle #a6bce3\n3     s__Rhizobacter_bergeniae circle #a6bce3\n4     s__Flavobacterium_terrae circle #a6bce3\n5         s__un_g__Rhizobacter circle #a6bce3\n\n# View edge properties\nget_e(co_net) %&gt;% head(5)\n\n  id                         from                            to    weight\n1  1 s__un_f__Thermomonosporaceae     s__Actinocorallia_herbida 0.6759546\n2  2 s__un_f__Thermomonosporaceae       s__Kribbella_catacumbae 0.6742386\n3  3 s__un_f__Thermomonosporaceae       s__Kineosporia_rhamnosa 0.7378741\n4  4 s__un_f__Thermomonosporaceae   s__un_f__Micromonosporaceae 0.6236449\n5  5 s__un_f__Thermomonosporaceae s__Flavobacterium_saliperosum 0.6045747\n        cor      p.value   e_type     width   color  e_class lty\n1 0.6759546 0.0020739524 positive 0.6759546 #48A4F0 e_class1   1\n2 0.6742386 0.0021502138 positive 0.6742386 #48A4F0 e_class1   1\n3 0.7378741 0.0004730567 positive 0.7378741 #48A4F0 e_class1   1\n4 0.6236449 0.0056818984 positive 0.6236449 #48A4F0 e_class1   1\n5 0.6045747 0.0078660171 positive 0.6045747 #48A4F0 e_class1   1\n\n\nThe data frames returned by these functions contain the most basic key information of multi-omics biological networks, such as node name, grouping, size, edge weight, etc. MetaNet has set some internal attributes (such as v_group, v_class, e_type, etc.) when building the network, which will affect subsequent analysis and visualization.\n\n\n3. Adding biological meaning to networks\nIn microbiome research, network structure alone is not enough, we need to integrate biological information such as taxonomy and abundance. MetaNet provides flexible annotation functions:\n\n# Adding classification information to a node\nc_net_annotate(co_net, taxonomy[\"Phylum\"], mode = \"v\") -&gt; co_net1\nanno &lt;- data.frame(\"from\" = \"s__un_f__Thermomonosporaceae\", \n                   \"to\" = \"s__Actinocorallia_herbida\", new_atr = \"new\")\nc_net_annotate(co_net, anno, mode = \"e\") -&gt; co_net1\n\nIn MetaNet, a c_net_set() function is provided, which can add multiple annotation tables at the same time and specify which columns are used to set node size, color and other attributes:\n\nAbundance_df &lt;- data.frame(\"Abundance\" = colSums(totu))\nco_net1 &lt;- c_net_set(co_net, taxonomy[\"Phylum\"], Abundance_df)\nco_net1 &lt;- co_net\nV(co_net1)$new_attri &lt;- seq_len(length(co_net1))\nE(co_net1)$new_attri &lt;- \"new attribute\"\nget_e(co_net1) %&gt;% head(5)\n\n  id                         from                            to    weight\n1  1 s__un_f__Thermomonosporaceae     s__Actinocorallia_herbida 0.6759546\n2  2 s__un_f__Thermomonosporaceae       s__Kribbella_catacumbae 0.6742386\n3  3 s__un_f__Thermomonosporaceae       s__Kineosporia_rhamnosa 0.7378741\n4  4 s__un_f__Thermomonosporaceae   s__un_f__Micromonosporaceae 0.6236449\n5  5 s__un_f__Thermomonosporaceae s__Flavobacterium_saliperosum 0.6045747\n        cor      p.value   e_type     width   color  e_class lty     new_attri\n1 0.6759546 0.0020739524 positive 0.6759546 #48A4F0 e_class1   1 new attribute\n2 0.6742386 0.0021502138 positive 0.6742386 #48A4F0 e_class1   1 new attribute\n3 0.7378741 0.0004730567 positive 0.7378741 #48A4F0 e_class1   1 new attribute\n4 0.6236449 0.0056818984 positive 0.6236449 #48A4F0 e_class1   1 new attribute\n5 0.6045747 0.0078660171 positive 0.6045747 #48A4F0 e_class1   1 new attribute\n\n\nIn this way, a network information with both statistical significance and biological background can be obtained.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "NetworkPlot"
    ]
  },
  {
    "objectID": "Omics/NetworkPlot.html#visualization",
    "href": "Omics/NetworkPlot.html#visualization",
    "title": "Network Plot",
    "section": "Visualization",
    "text": "Visualization\n\n1. Build network\nSimple multi-omics network: contains information of microbiome, metabolome, transcriptome, etc.\n\n# Basic Network\ndata(\"multi_test\", package = \"MetaNet\")\ndata(\"c_net\", package = \"MetaNet\")\nmulti1 &lt;- multi_net_build(list(Microbiome = micro, Metabolome = metab, Transcriptome = transc))\nplot(multi1)\n\n\n\n\nBasic Network\n\n\n\n\n\n\n2. Add annotation\n\n# Set the node class\nmulti1_with_anno &lt;- c_net_set(multi1, \n                              micro_g, metab_g, \n                              transc_g, \n                              vertex_class = c(\"Phylum\", \"kingdom\", \"type\"))\n\n# Set the node size\nmulti1_with_anno &lt;- c_net_set(multi1_with_anno,\n                              data.frame(\"Abundance1\" = colSums(micro)),\n                              data.frame(\"Abundance2\" = colSums(metab)),\n                              data.frame(\"Abundance3\" = colSums(transc)),\n                              vertex_size = paste0(\"Abundance\", 1:3))\n\nplot(multi1_with_anno)\n\n\n\n\nAdd annotation\n\n\n\n\n\n\n3. Filter subnetwork\n\n# Filter subnetwork\ndata(\"multi_net\", package = \"MetaNet\")\nmulti2 &lt;- c_net_filter(multi1_with_anno, v_group %in% \n                         c(\"Microbiome\", \"Metabolome\")) %&gt;%\n  c_net_filter(., e_class == \"intra\", mode = \"e\")\n\nplot(multi2, lty_legend = T, main = \"Sub-network\") \n\n\n\n\nFilter subnetwork\n\n\n\n\n\n\n4. Merge Network\n\n# Network1\ndata(\"c_net\")\nplot(co_net)\n\n\n\n\nNetwork1\n\n\n\n\n\n# Network2\ndata(\"c_net\")\nplot(co_net2)\n\n\n\n\nNetwork2\n\n\n\n\n\n# Merge Network\nco_net_union &lt;- c_net_union(co_net, co_net2)\nplot(co_net_union)\n\n\n\n\nMerge Network\n\n\n\n\nThe MetaNet package provides a comprehensive set of tools for microbial network analysis, from basic network construction to advanced annotation and visualization. By flexibly using these functions, we can extract meaningful biological patterns from complex microbiome data and provide new perspectives for understanding the structure and function of microbial communities.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "NetworkPlot"
    ]
  },
  {
    "objectID": "Omics/NetworkPlot.html#reference",
    "href": "Omics/NetworkPlot.html#reference",
    "title": "Network Plot",
    "section": "Reference",
    "text": "Reference\n[1] K. Contrepois, S. Wu, K. J. Moneghetti, D. Hornburg, et al., [Molecular Choreography of Acute Exercise (https://doi.org/10.1016/j.cell.2020.04.043). Cell. 181, 1112â€“1130.e16 (2020).\n[2] Y. Deng, Y. Jiang, Y. Yang, Z. He, et al., Molecular ecological network analyses. BMC bioinformatics (2012), doi:10.1186/1471-2105-13-113.\n[3] K. Faust, J. Raes, Microbial interactions: From networks to models. Nature Reviews Microbiology (2012), doi:10.1038/nrmicro2832.\n[4] Chen Peng (2025). MetaNet: Network Analysis for Omics Data. R package",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "NetworkPlot"
    ]
  },
  {
    "objectID": "Omics/SankeyBubblePlot.html#setup",
    "href": "Omics/SankeyBubblePlot.html#setup",
    "title": "Sankey Bubble plot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: tidyverse; readr; ggalluvial; patchwork\n\n\n# Installing necessary packages\nif (!requireNamespace(\"tidyverse\", quietly = TRUE)) {\n  install.packages(\"tidyverse\")\n}\nif (!requireNamespace(\"readr\", quietly = TRUE)) {\n  install.packages(\"readr\")\n}\nif (!requireNamespace(\"ggalluvial\", quietly = TRUE)) {\n  install.packages(\"ggalluvial\")\n}\nif (!requireNamespace(\"patchwork\", quietly = TRUE)) {\n  install.packages(\"patchwork\")\n}\n\n# Load packages\nlibrary(tidyverse)\nlibrary(readr)\nlibrary(ggalluvial)\nlibrary(patchwork)",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "SankeyBubblePlot"
    ]
  },
  {
    "objectID": "Omics/SankeyBubblePlot.html#data-preparation",
    "href": "Omics/SankeyBubblePlot.html#data-preparation",
    "title": "Sankey Bubble plot",
    "section": "Data Preparation",
    "text": "Data Preparation\nWe imported pathway enrichment data from DAVID for network pharmacology annotation analysis.\n\n# Load data\ndata &lt;- read_tsv(\"files/DAVID.txt\")\n\n# Add a new categorical column\nget_category &lt;- function(cat) {\n  if (grepl(\"BP\", cat)) return(\"BP\")\n  if (grepl(\"MF\", cat)) return(\"MF\")\n  if (grepl(\"CC\", cat)) return(\"CC\")\n  if (grepl(\"KEGG\", cat)) return(\"KEGG\")\n  return(NA)\n}\ndata$MainCategory &lt;- sapply(data$Category, get_category)\n\n# Remove SMART and NA\ndata2 &lt;- data %&gt;%\n  filter(!grepl(\"SMART\", Category)) %&gt;%\n  filter(!is.na(MainCategory))\n\n# Sort each category and take the top 10\ntopN &lt;- function(data, n=10) {\n  data %&gt;%\n  arrange(desc(Count), PValue) %&gt;%\n  head(n)\n}\nresult &lt;- data2 %&gt;%\n  group_by(MainCategory) %&gt;%\n  group_modify(~topN(.x, 10)) %&gt;%\n  ungroup()\n\n# KEGG pathway annotation\nresult &lt;- result %&gt;%\n  mutate(\n    Source = ifelse(MainCategory == \"KEGG\", \"KEGG\", \"GO\"),\n    KEGG_Group = case_when(\n      MainCategory == \"KEGG\" & str_detect(Term,\"Neuro|synapse|neurodegeneration|Alzheimer|Parkinson|Prion\") ~ \"Nervous system\",\n      MainCategory == \"KEGG\" & str_detect(Term, \"Cytokine|inflammatory\") ~ \"Immune system\",\n      MainCategory == \"KEGG\" & str_detect(Term, \"Lipid|atherosclerosis\") ~ \"Lipid metabolism\",\n      MainCategory == \"KEGG\" ~ \"Other KEGG\",\n      TRUE ~ NA_character_\n      ),\n    GO_Group = ifelse(MainCategory != \"KEGG\", MainCategory, NA)\n    )\nalluvial_data &lt;- result %&gt;%\n  mutate(\n    Term = str_replace(Term, \"^GO:\\\\d+~\", \"\"), # Remove GO number\n    Term = str_replace(Term, \"^hsa\\\\d+:?\", \"\") # Remove KEGG number\n    )\n\n# GO Section\ngo_links &lt;- result %&gt;%\n  filter(Source == \"GO\") %&gt;%\n  transmute(\n    Source = Source,\n    Group = GO_Group,\n    Term = Term,\n    Count = Count\n    )\n\n# KEGG Section\nkegg_links &lt;- result %&gt;%\n  filter(Source == \"KEGG\") %&gt;%\n  transmute(\n    Source = Source,\n    Group = KEGG_Group,\n    Term = Term,\n    Count = Count\n    )\n\n# Generate Sankey diagram data\nalluvial_data &lt;- result %&gt;%\n  mutate(Group = ifelse(Source == \"KEGG\", KEGG_Group, GO_Group)) %&gt;%\n  select(Source, Group, Term, Count, FDR, FoldEnrichment, MainCategory)\n\n# Ensure character type\nalluvial_data$Source &lt;- as.character(alluvial_data$Source)\nalluvial_data$Group &lt;- as.character(alluvial_data$Group)\nalluvial_data$Term &lt;- as.character(alluvial_data$Term)\n\n# Bind\nalluvial_data &lt;- bind_rows(go_links, kegg_links)\n\n# Arrange the term column in ascending order of count value, and ensure that the bubble chart and Sankey chart are in the same order\nterm_levels &lt;- alluvial_data %&gt;%\n  arrange(Source, Group, desc(Count)) %&gt;%\n  pull(Term) %&gt;%\n  unique()\nalluvial_data$Term &lt;- factor(alluvial_data$Term, levels = term_levels)\n\n# View data structure\nhead(alluvial_data, 5)\n\n# A tibble: 5 Ã— 4\n  Source Group Term                                                        Count\n  &lt;chr&gt;  &lt;chr&gt; &lt;fct&gt;                                                       &lt;dbl&gt;\n1 GO     BP    GO:0010628~positive regulation of gene expression              12\n2 GO     BP    GO:0045944~positive regulation of transcription by RNA polâ€¦    11\n3 GO     BP    GO:0007187~G protein-coupled receptor signaling pathway, câ€¦    10\n4 GO     BP    GO:0007268~chemical synaptic transmission                      10\n5 GO     BP    GO:0006954~inflammatory response                               10",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "SankeyBubblePlot"
    ]
  },
  {
    "objectID": "Omics/SankeyBubblePlot.html#visualization",
    "href": "Omics/SankeyBubblePlot.html#visualization",
    "title": "Sankey Bubble plot",
    "section": "Visualization",
    "text": "Visualization\n\n1. Sankey Diagram\n\n# Sankey diagram (the Term column does not display labels)\n\n# Ensure Group is of character type and does not contain NA\nalluvial_data$Group &lt;- as.character(alluvial_data$Group)\nalluvial_data$Group[is.na(alluvial_data$Group)] &lt;- \"Other\"\n# Calculate the total Count of each Group\ngroup_order &lt;- alluvial_data %&gt;%\n  group_by(Group) %&gt;%\n  summarise(group_count = sum(Count, na.rm = TRUE)) %&gt;%\n  arrange(desc(group_count)) %&gt;%\n  pull(Group)\n# Set group to an ordered factor\nalluvial_data$Group &lt;- factor(alluvial_data$Group, levels = group_order)\n# Sort the Term column and set term as an ordered factor\nterm_order &lt;- alluvial_data %&gt;%\n  group_by(Term) %&gt;%\n  summarise(total_count = sum(Count, na.rm = TRUE)) %&gt;%\n  arrange(desc(total_count)) %&gt;%\n  pull(Term)\nalluvial_data$Term &lt;- factor(alluvial_data$Term, levels = term_order)\n# Retrieve the ordered labels of the group\ngroup_labels &lt;- levels(alluvial_data$Group)\ngroup_labels &lt;- c(\"BP\", \"MF\", \"CC\", \"Nervous system\", \"Immune system\", \"Lipid metabolism\", \"Other KEGG\")\nterm_labels &lt;- levels(alluvial_data$Term)\n\np1 &lt;- ggplot(\n  alluvial_data,\n  aes(axis1 = Source, axis2 = Group, axis3 = Term, y = 1)) +\n  geom_alluvium(aes(fill = Group), width = 1/12, alpha = 0.8) +\n  geom_stratum(width = 1/12, fill = \"grey\", color = \"black\") +\n  scale_fill_manual(values = c(\n    \"BP\" = \"#33ad37\",\"MF\" = \"#f2c867\",\"CC\" = \"#d45327\", \n    \"Nervous system\" = \"#2eb6aa\", \"Immune system\" = \"#3e4999\", \n    \"Lipid metabolism\" = \"#4fc1e4\", \"Other KEGG\" = \"#e0c4ce\")) +\n  geom_text(stat = \"stratum\", aes(label = ifelse(\n    after_stat(stratum) %in% group_labels, after_stat(stratum),\n    ifelse(after_stat(stratum) %in% term_labels, after_stat(stratum), \"\")\n    )), size = 3) +\n  scale_x_discrete(\n    limits = c(\"Source\", \"Group\", \"Term\"),\n    labels = c(\"Source\", \"Group\", \"term\"), expand = c(.05, .05)) +\n  labs(title = NULL, y = NULL, x = NULL) +\n  theme_minimal(base_size = 12) +\n  theme(\n    axis.title.x = element_blank(),\n    axis.text.x = element_text(size = 10),\n    axis.text.y = element_blank(),\n    axis.ticks.y = element_blank(),\n    plot.margin = margin(5, 5, 5, 5), # This is consistent with p2\n    panel.grid = element_blank()\n    ) +\n  guides(fill = \"none\")\n\np1\n\n\n\n\n\n\n\nFigureÂ 1: Sankey Diagram\n\n\n\n\n\n\n\n2. Bubble Plot\n\n# Bubble plot (Term label only on the right)\n# Prepare term_levels first, making sure the order is consistent with the y-axis\nterm_levels &lt;- levels(alluvial_data$Term)\n# Generate bubble plot data\nalluvial_data &lt;- result %&gt;%\n  mutate(Group = ifelse(Source == \"KEGG\", KEGG_Group, GO_Group)) %&gt;%\n  select(Source, Group, Term, Count, FDR, FoldEnrichment, MainCategory)\n\np2 &lt;- ggplot(alluvial_data, aes(x = log2(FoldEnrichment), y = Term)) +\n  # Segment: from x = min_x - offset to x = log2(FoldEnrichment)\n  geom_segment(aes(\n    x = min(log2(FoldEnrichment), na.rm = TRUE) - 0.5,\n    xend = log2(FoldEnrichment),\n    y = Term, yend = Term),\n    linetype = \"dashed\", color = \"grey50\") +\n  # Left label\n  geom_text(aes(\n    x = min(log2(FoldEnrichment), na.rm = TRUE) - 0.2,\n    label = Term\n    ), hjust = 1, size = 3) +\n  # Bubble\n  geom_point(aes(size = Count, color = -log10(FDR))) +\n  scale_y_discrete(limits = rev(term_levels), position = \"right\") +\n  scale_color_gradient(low = \"#4659a7\", high = \"#de4f30\") +\n  labs(title = NULL, x = \"log2(FoldEnrichment)\", y = NULL, color = \"-log10(FDR)\") +\n  theme_minimal() +\n  theme(\n    axis.text.y.left = element_blank(),\n    axis.text.y.right = element_blank(), # No label is displayed on the right\n    axis.title.y = element_blank(),\n    plot.margin = margin(5, 5, 5, 0),\n    panel.grid.major.y = element_blank()\n    )\n\np2\n\n\n\n\n\n\n\nFigureÂ 2: Bubble Plot\n\n\n\n\n\n\n\n3. Combine\n\ncombined_plot &lt;- p1 + p2 + plot_layout(widths = c(1.5, 2), guides = \"collect\")\nprint(combined_plot)\n\n\n\n\n\n\n\nFigureÂ 3: Combine",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "SankeyBubblePlot"
    ]
  },
  {
    "objectID": "Omics/GeneStructurePlot.html",
    "href": "Omics/GeneStructurePlot.html",
    "title": "Gene Structure Plot",
    "section": "",
    "text": "In biology, especially in molecular biology research, analyzing the expression and regulation patterns of genes has always been a research focus. In this process, it is inevitable that there will be a need to draw the structure of a gene or the upstream and downstream relationships. Therefore, this tutorial will summarize some common gene structure drawing methods based on the R package gggenes.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "GeneStructurePlot"
    ]
  },
  {
    "objectID": "Omics/GeneStructurePlot.html#example",
    "href": "Omics/GeneStructurePlot.html#example",
    "title": "Gene Structure Plot",
    "section": "Example",
    "text": "Example",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "GeneStructurePlot"
    ]
  },
  {
    "objectID": "Omics/GeneStructurePlot.html#setup",
    "href": "Omics/GeneStructurePlot.html#setup",
    "title": "Gene Structure Plot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: tidyverse; gggenes; ggtree\n\n\n# Installing necessary packages\nif (!requireNamespace(\"tidyverse\", quietly = TRUE)) {\n  install.packages(\"tidyverse\")\n}\nif (!requireNamespace(\"gggenes\", quietly = TRUE)) {\n  install.packages(\"gggenes\")\n}\nif (!requireNamespace(\"ggtree\", quietly = TRUE)) {\n  install.packages(\"ggtree\")\n}\n\n# Load packages\nlibrary(tidyverse)\nlibrary(gggenes)\nlibrary(ggtree)",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "GeneStructurePlot"
    ]
  },
  {
    "objectID": "Omics/GeneStructurePlot.html#data-preparation",
    "href": "Omics/GeneStructurePlot.html#data-preparation",
    "title": "Gene Structure Plot",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe data uses the example_genes dataset, example_subgenes dataset, and example_features dataset that come with gggenes, which record the location information of genes, the location information of gene substructures, and the location information of marker points on genes, respectively.\nexample_genes is a data frame, which contains a column recording chromosome or chain information as the vertical coordinate, a column recording gene or sequence ID as the mapping index of the dye, two columns recording the start and end positions of the gene, and a column recording the gene direction. Each row is a gene. The following table is an example of the data of example_genes:\n\nhead(example_genes)\n\n  molecule gene start   end  strand orientation\n1  Genome1 genA 15389 17299 reverse           1\n2  Genome1 genB 17301 18161 forward           0\n3  Genome1 genC 18176 18640 reverse           1\n4  Genome1 genD 18641 18985 forward           0\n5  Genome1 genE 18999 20078 reverse           1\n6  Genome1 genF 20086 20451 forward           1\n\n\nexample_subgenes needs to contain all the columns of example_genes, and needs to contain an additional column to record the gene substructure ID, two columns to record the start and end positions of the gene substructure, and each row is a gene substructure. The following table is an example of the data of example_subgenes:\n\nhead(example_subgenes)\n\n  molecule gene  start    end  strand subgene   from     to orientation\n1  Genome5 genA 405113 407035 forward  genA-1 405774 406538           0\n2  Genome5 genB 407035 407916 forward  genB-1 407458 407897           0\n3  Genome5 genC 407927 408394 forward  genC-1 407942 408158           0\n4  Genome5 genC 407927 408394 forward  genC-2 408186 408209           0\n5  Genome5 genC 407927 408394 forward  genC-3 408233 408257           0\n6  Genome5 genF 409836 410315 forward  genF-1 409938 410016           0\n\n\nexample_features needs to contain a column for recording chromosome or chain information, a column for recording marker name, a column for recording marker type, a column for recording marker position, and a column for recording marker direction. Each line is a marker. The following table is an example of example_features data:\n\nhead(example_features)\n\n  molecule name             type position forward\n1  Genome1 tss9              tss    22988      NA\n2  Genome1  rs4 restriction site    18641      NA\n3  Genome1 ori5              ori    18174      NA\n4  Genome2  rs0 restriction site    12256      NA\n5  Genome2  rs1 restriction site    14076      NA\n6  Genome2 ori1              ori    13355   FALSE",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "GeneStructurePlot"
    ]
  },
  {
    "objectID": "Omics/GeneStructurePlot.html#visualization",
    "href": "Omics/GeneStructurePlot.html#visualization",
    "title": "Gene Structure Plot",
    "section": "Visualization",
    "text": "Visualization\n\n1. Gene structure plot basics\nAs an extension of ggplot2, gggenes consists of a main function geom_gene_arrow and several secondary functions. First, the basic usage of gggenes is introduced:\n\n1.1 Plotting the relative positions of a series of genes\n\n# Plotting the relative positions of a series of genes\nggplot(example_genes, aes(xmin = start, xmax = end, y = molecule)) +\n    geom_gene_arrow() +\n    facet_wrap(~ molecule, scales = \"free\", ncol = 1)  # gggenes is usually used with the facet_wrap function for faceting. It should be noted that if the drawing interface is too small, an error message will be displayed: \"Viewport has zero dimension(s)\". Just enlarge the drawing window or set a larger interface.\n\n\n\n\n\n\n\nFigureÂ 1: Plotting the relative positions of a series of genes\n\n\n\n\n\n\n\n1.2 Plot a set of genes\nIf you are interested in the structure of the gene itself rather than its location, you can use the gene ID as the vertical axis:\n\n# Plot a set of genes\ndf &lt;- subset(example_genes, molecule == \"Genome4\")\ndf$end &lt;- df$end-df$start\ndf$start &lt;- 1\nggplot(df, aes(xmin = start, xmax = end, y = gene)) +\n    geom_gene_arrow()\n\n\n\n\n\n\n\nFigureÂ 2: Plot a set of genes\n\n\n\n\n\n\n\n1.3 Plot gene substructure\nSometimes we may focus on more detailed structures of genes, such as CDS positions or special motif positions, etc. In this case, we need another extended function geom_subgene_arrow provided by gggenes to complete it. It should be noted that although example_subgenes can also be used as the input of geom_gene_arrow, since each row in the data will create an outline image of a gene, it is not recommended to do so when a gene contains multiple substructures. The recommended method is to separate the gene information and substructure information into two data frames. The usage is as follows:\n\n# Plot gene substructure\nggplot(example_genes, aes(xmin = start, xmax = end, y = molecule)) +\n    facet_wrap(~ molecule, scales = \"free\", ncol = 1) +\n    geom_gene_arrow(fill = \"white\") +\n    geom_subgene_arrow(data = example_subgenes,\n                       aes(fill = gene, xsubmin = from, xsubmax = to),\n                       color=\"black\", alpha=.7)\n\n\n\n\n\n\n\nFigureÂ 3: Plot gene substructure\n\n\n\n\n\n\n\n1.4 Plot gene markers\nSometimes we may focus on a particular point on a gene or sequence, such as a restriction site or a promoter site. Unlike genes or their substructures, markers are often one or a limited number of bases. In this case, it is not suitable to use the arrow drawing method. The geom_feature and geom_feature_label extension functions can complete this labeling task well:\n\n# Plot gene markers\nggplot(example_genes, aes(xmin = start, xmax = end, y = molecule)) +\n    facet_wrap(~ molecule, scales = \"free\", ncol = 1) +\n    geom_gene_arrow(fill = \"white\")+\n    geom_feature(\n        data = example_features,\n        aes(x = position, y = molecule, forward = forward)\n    ) +\n    geom_feature_label(\n        data = example_features,\n        aes(x = position, y = molecule, label = name, forward = forward),\n        feature_height = unit(4, \"mm\"), # When the marker point cannot be displayed normally, you can set this parameter to adjust the marker label height.\n        label_height = unit(3, \"mm\") # When the size of the marker label is not appropriate, you can set this parameter to adjust the size of the marker label.\n    ) +\n    theme_genes() # This topic will be mentioned below\n\n\n\n\n\n\n\nFigureÂ 4: Plot gene markers\n\n\n\n\n\n\n\n1.5 With evolutionary trees and plots\nWe may be interested in the genetic differences between different species or varieties in a certain chromosome region. At this time, we can combine the evolutionary tree with the gene structure diagram. In addition to using the puzzle method, the R package ggtree also provides an interface for combining the two: First, we need to obtain a tree structure. Here, we directly use the gggenes data set to construct a tree. When actually using it, just read a tree file. Generate an evolutionary tree based on the gene structure. It is not necessary to generate it for actual use:\n\nget_genes &lt;- function(data, genome) {\n    filter(data, molecule == genome) %&gt;% pull(gene)\n}\n\ng &lt;- unique(example_genes[,1])\nn &lt;- length(g)\nd &lt;- matrix(nrow = n, ncol = n)\nrownames(d) &lt;- colnames(d) &lt;- g\ngenes &lt;- lapply(g, get_genes, data = example_genes)\n\nfor (i in 1:n) {\n    for (j in 1:i) {\n        jaccard_sim &lt;- length(intersect(genes[[i]], genes[[j]])) / \n            length(union(genes[[i]], genes[[j]]))\n        d[j, i] &lt;- d[i, j] &lt;- 1 - jaccard_sim\n    }\n}\ntree &lt;- ape::bionj(d) \n\nWhen drawing, use the ggtree function, specify the gene structure data in geom_facet, and specify geom = geom_motif panel = 'Alignment'. The on parameter is used to specify the gene name to be aligned (it must be common to all species. If not, I donâ€™t know how to set it for the time being). The coordinate mapping parameters are xmin and xmax. It should be noted that the chromosome ID used as the vertical axis above (here can be the name of different species) must be in the first column of the data frame. ggtree will determine the vertical axis position of the gene structure by comparing the branch labels of the tree and the first column of the gene structure. The drawing code is as follows:\n\n# With evolutionary trees and plots\nggtree(tree, branch.length='none') + \n    geom_tiplab() + xlim_tree(5.5) + \n    geom_facet(data = example_genes,\n               geom = geom_motif,\n               mapping = aes(xmin = start, xmax = end, fill = gene), \n               panel = 'Alignment',on = 'genE', \n               label = 'gene', align = 'left') +\n    scale_fill_brewer(palette = \"Set3\") +  #ä¿®æ”¹é…è‰²çš„æ–¹æ³•ä¸‹é¢ä¼šæåˆ°\n    scale_x_continuous(expand=c(0,0)) +\n    theme(strip.text=element_blank())\n\n\n\n\n\n\n\nFigureÂ 5: With evolutionary trees and plots\n\n\n\n\n\n\n\n\n2. Beautification\n\n2.1 theme_genes\nIn gggenes, there is an image theme called theme_genes that is very suitable for drawing gene structure:\n\n# theme_genes\nggplot(example_genes, aes(xmin = start, xmax = end, y = molecule)) +\n    geom_gene_arrow() +\n    facet_wrap(~ molecule, scales = \"free\", ncol = 1) +\n    theme_genes() \n\n\n\n\n\n\n\nFigureÂ 6: theme_genes\n\n\n\n\n\n\n\n2.2 Modify Color\nAdd colors to different genes (the same goes for substructures, so I wonâ€™t go into details):\n\n# Modify Color\nggplot(example_genes, aes(xmin = start, xmax = end, y = molecule, fill=gene)) +\n    geom_gene_arrow() +\n    facet_wrap(~ molecule, scales = \"free\", ncol = 1) +\n    theme_genes()\n\n\n\n\n\n\n\nFigureÂ 7: Modify Color\n\n\n\n\n\nTo change the color scheme, you can use the palette or set it manually:\n\n# Modify Color\nggplot(example_genes, aes(xmin = start, xmax = end, y = molecule, fill = gene)) +\n    geom_gene_arrow() +\n    facet_wrap(~ molecule, scales = \"free\", ncol = 1) +\n    scale_fill_brewer(palette = \"Set3\") +\n    theme_genes()\n\n\n\n\n\n\n\nFigureÂ 8: Modify Color\n\n\n\n\n\nCustom color scheme:\n\n# Modify Color\nggplot(example_genes, aes(xmin = start, xmax = end, y = molecule, fill = gene)) +\n    geom_gene_arrow() +\n    facet_wrap(~ molecule, scales = \"free\", ncol = 1) +\n    scale_fill_manual(values=c(\"genA\"=\"#266CAF\",\n                               \"genB\"=\"#BF3237\",\n                               \"genC\"=\"#54AC78\",\n                               \"genD\"=\"#FBD75F\")) +\n    theme_genes()\n\n\n\n\n\n\n\nFigureÂ 9: Modify Color\n\n\n\n\n\n\n\n2.3 Add gene labels\nTo add gene labels, you need to use the geom_gene_label extension function, which only requires an additional label mapping to be defined.\n\n# Add gene labels\nggplot(example_genes, aes(xmin = start, xmax = end, y = molecule, fill = gene)) +\n    geom_gene_arrow() +\n    geom_gene_label(aes(label = gene),align = \"left\") +\n    facet_wrap(~ molecule, scales = \"free\", ncol = 1) +\n    scale_fill_brewer(palette = \"Set3\") +\n    theme_genes()\n\n\n\n\n\n\n\nFigureÂ 10: Add gene labels\n\n\n\n\n\n\n\n2.4 Modify gene arrow shape\nTo modify the arrowhead properties, you need to use two parameters in geom_gene_arrow: arrowhead_height and arrowhead_width, which define the height and width of the arrowhead respectively.\n\n# Modify gene arrow shape\nggplot(example_genes, aes(xmin = start, xmax = end, y = molecule, fill = gene)) +\n    geom_gene_arrow(arrowhead_height = unit(3, \"mm\"), arrowhead_width = unit(1, \"mm\")) +\n    facet_wrap(~ molecule, scales = \"free\", ncol = 1) +\n    scale_fill_brewer(palette = \"Set3\") +\n    theme_genes()\n\n\n\n\n\n\n\nFigureÂ 11: Modify gene arrow shape\n\n\n\n\n\n\n\n2.5 Modify the direction of genes\nTo modify the gene direction, you generally need to set the forward mapping. The content of the mapping column must be a value that can be converted into a Boolean value, such as: 0/1, T/F, TRUE/FALSE, â€œTrueâ€/â€œFalseâ€, etc. You can use the as.logical function to judge for yourself. If there is no setting, the gene arrow points to the direction of xmax by default. When the forward mapping is set, the gene with a Boolean value of TRUE points to the direction of xmax, and the gene with a Boolean value of FALSE points to the direction of xmin. Therefore, if xmin and xmax in your data are directional, you can also not perform forward mapping.\n\n# Modify the direction of genes\nggplot(example_genes, aes(xmin = start, xmax = end, y = molecule, fill = gene, forward = orientation)) +\n    geom_gene_arrow() +\n    facet_wrap(~ molecule, scales = \"free\", ncol = 1) +\n    scale_fill_brewer(palette = \"Set3\") +\n    theme_genes()\n\n\n\n\n\n\n\nFigureÂ 12: Modify the direction of genes",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "GeneStructurePlot"
    ]
  },
  {
    "objectID": "Omics/GeneStructurePlot.html#application",
    "href": "Omics/GeneStructurePlot.html#application",
    "title": "Gene Structure Plot",
    "section": "Application",
    "text": "Application\n\n\n\n\n\n\nFigureÂ 13: Applications of Gene Structure Plot\n\n\n\nThe figure shows the loss and differentiation model of NLR genes in plants during evolution. [1]ã€‚",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "GeneStructurePlot"
    ]
  },
  {
    "objectID": "Omics/GeneStructurePlot.html#reference",
    "href": "Omics/GeneStructurePlot.html#reference",
    "title": "Gene Structure Plot",
    "section": "Reference",
    "text": "Reference\n[1] Guo BC, Zhang YR, Liu ZG, Li XC, Yu Z, Ping BY, Sun YQ, van den Burg H, Ma FW, Zhao T. Deciphering Plant NLR Genomic Evolution: Synteny-Informed Classification Unveils Insights into TNL Gene Loss. Mol Biol Evol. 2025 Feb 3;42(2):msaf015. doi: 10.1093/molbev/msaf015. PMID: 39835721; PMCID: PMC11789945.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "GeneStructurePlot"
    ]
  },
  {
    "objectID": "Omics/VolcanoPlot.html",
    "href": "Omics/VolcanoPlot.html",
    "title": "Volcano Plot",
    "section": "",
    "text": "The volcano plot is used to compare the two groups and obtain the up-regulation/down-regulation between the two groups. The screening basis is the p value and FC value, which are converted to -logP value and log2(FC) value. The imported data can be the OTU table or ASV table of the microbiome, the table of transcriptome gene expression, or the features table of metabolomics and other multi-omics data.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "VolcanoPlot"
    ]
  },
  {
    "objectID": "Omics/VolcanoPlot.html#example",
    "href": "Omics/VolcanoPlot.html#example",
    "title": "Volcano Plot",
    "section": "Example",
    "text": "Example",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "VolcanoPlot"
    ]
  },
  {
    "objectID": "Omics/VolcanoPlot.html#setup",
    "href": "Omics/VolcanoPlot.html#setup",
    "title": "Volcano Plot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: tidyverse; readxl; ggrepel\n\n\n# Installing necessary packages\nif (!requireNamespace(\"tidyverse\", quietly = TRUE)) {\n  install.packages(\"tidyverse\")\n}\nif (!requireNamespace(\"readxl\", quietly = TRUE)) {\n  install.packages(\"readxl\")\n}\nif (!requireNamespace(\"ggrepel\", quietly = TRUE)) {\n  install.packages(\"ggrepel\")\n}\n\n# Load packages\nlibrary(tidyverse)\nlibrary(readxl)\nlibrary(ggrepel)",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "VolcanoPlot"
    ]
  },
  {
    "objectID": "Omics/VolcanoPlot.html#data-preparation",
    "href": "Omics/VolcanoPlot.html#data-preparation",
    "title": "Volcano Plot",
    "section": "Data Preparation",
    "text": "Data Preparation\nWe import the volcano plot example data from omicshare.\n\n# Load excel data\ndata &lt;- read_excel(\"files/volcano.eg.xlsx\")\n\n# Rename column names (handle special characters)\ndata &lt;- data %&gt;%\n  rename(log2FC = \"log2 Ratio(WT0/LOG)\", Pvalue = \"Pvalue\")\n# Handle the case where the p-value is 0 (avoid calculating -Inf)\ndata &lt;- data %&gt;%\n  mutate(log10P = -log10(Pvalue + 1e-300)) # Make sure to handle the case where P=0\n# Convert to numeric type and handle values that fail to convert (such as invalid characters)\ndata &lt;- data %&gt;%\n  mutate(\n    log2FC = as.numeric(log2FC) # Values that fail the conversion become NA\n  )\n\n# Find the original value that caused the conversion to fail\ndata %&gt;%\n  filter(is.na(log2FC)) %&gt;%\n  select(log2FC) # View the raw log2FC values for these lines\n\n# A tibble: 0 Ã— 1\n# â„¹ 1 variable: log2FC &lt;dbl&gt;\n\n# Repair the data as needed (e.g. replace or remove outliers)\n# Example: Replace \"Inf\" with an actual value or filter out\ndata &lt;- data %&gt;%\n  mutate(\n    log2FC = ifelse(log2FC == \"Inf\", 100, log2FC), # Adjust according to needs\n    log2FC = as.numeric(log2FC)\n    ) %&gt;%\n  filter(!is.na(log2FC)) # Delete the rows that cannot be repaired\n\n# Defining significance (satisfying both P value &lt; 0.05 and |log2FC| &gt; 1)\n# Define significance categories (upregulated, downregulated, not significant)\ndata &lt;- data %&gt;%\n  mutate(\n    significant = case_when(\n      Pvalue &lt; 0.05 & log2FC &gt; 2 ~ \"Upregulated\", # Up (red)\n      Pvalue &lt; 0.05 & log2FC &lt; -2 ~ \"Downregulated\", # Down (green)\n      TRUE ~ \"Not significant\" # Not significant (grey)\n    )\n  )\n\n# View data structure\nhead(data, 5)\n\n# A tibble: 5 Ã— 10\n  GeneID         LOG_count WT0_count LOG_rpkm WT0_rpkm  log2FC    Pvalue     FDR\n  &lt;chr&gt;              &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;\n1 Unigene0000003     17243     17525   932.     942.    0.0168   5.15e-1 6.73e-1\n2 Unigene0000004        65       101     4.12     6.37  0.629    6.64e-3 1.79e-2\n3 Unigene0000005       909       984    36.9     39.7   0.108    1.26e-1 2.25e-1\n4 Unigene0000006      1376      1082    74.7     58.5  -0.353    1.17e-8 6.86e-8\n5 Unigene0000007       121        73    15.7      9.42 -0.736    7.42e-4 2.45e-3\n# â„¹ 2 more variables: significant &lt;chr&gt;, log10P &lt;dbl&gt;",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "VolcanoPlot"
    ]
  },
  {
    "objectID": "Omics/VolcanoPlot.html#visualization",
    "href": "Omics/VolcanoPlot.html#visualization",
    "title": "Volcano Plot",
    "section": "Visualization",
    "text": "Visualization\n\n1. Basic volcano plot\n\n# Basic volcano plot\np &lt;- \n  ggplot(data, aes(x = log2FC, y = -log10(Pvalue))) + # Plot preliminary volcano\n  # Plot scatter points, colored by significant categories\n  geom_point(aes(color = significant), alpha = 0.6, size = 1.5) + \n  # Set color mapping (up: red, down: green, no significant: gray)\n  scale_color_manual(\n    values = c(\"Upregulated\" = \"red\", \"Downregulated\" = \"green\", \"Not significant\" = \"gray\"),\n    name = \"Significance\" # Legend Title\n    ) +\n  # Adding a filter threshold line\n  geom_vline(xintercept = c(-2, 2), linetype = \"dashed\", color = \"green\", linewidth = 0.5) + # log2FC threshold line\n  geom_hline(yintercept = -log10(0.05), linetype = \"dashed\", color = \"blue\", linewidth = 0.5) + # p-value threshold line\n  # Adjust axes and titles\n  labs(x = \"log2(Fold Change)\", y = \"-log10(P-value)\",\n       title = \"Volcano Plot with Thresholds\") +\n  theme_minimal() +\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"), # Title centered bold\n        legend.position = \"right\") # Legend position\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Basic volcano plot\n\n\n\n\n\n\n\n2. Labeled volcano plot\n\n# Add Label\n# Step 1: Screening genes to be annotated\nlabel_data &lt;- data %&gt;%\n  filter(Pvalue &lt; 0.05) %&gt;% # Screening of significant genes\n  group_by(significant) %&gt;% # Group by up and down\n  top_n(10, abs(log2FC)) %&gt;% # Take the 10 with the largest absolute values of log2FC\n  ungroup()\n# Step 2: Define label colors (light red and light green)\nlabel_colors &lt;- c(\n  \"Upregulated\" = \"#FF9999\",\n  \"Downregulated\" = \"#99FF99\"\n  )\n# Step 3: Draw a labeled volcano plot\np &lt;- \n  ggplot(data, aes(x = log2FC, y = -log10(Pvalue))) +\n  geom_point(aes(color = significant), alpha = 0.6, size = 1.5) +\n  # Add gene tags (only target genes are marked)\n  geom_text_repel(\n    data = label_data,\n    aes(label = GeneID, color = significant), # Assume that the gene name column is named OTU ID\n    size = 3,\n    box.padding = 0.5, # Label padding\n    max.overlaps = 50, # Maximum overlap allowed\n    segment.color = \"grey50\", # Connection line color\n    show.legend = FALSE\n    ) +\n  # Set color mapping (original color + label color)\n  scale_color_manual(\n    values = c(\"Upregulated\" = \"red\", \"Downregulated\" = \"green\", \"Not significant\" = \"gray\"),\n    guide = guide_legend(override.aes = list(\n      color = c(\"red\", \"green\", \"gray\"), # Legend color remains original\n      label = \"\" # No text is displayed in the legend\n      ))) +\n  # Control label color (light red and light green)\n  scale_color_manual(\n    values = label_colors,\n    guide = \"none\" # Hide additional legend\n    ) +\n  # Keep the original threshold line and title\n  geom_vline(xintercept = c(-2, 2), linetype = \"dashed\", color = \"black\") +\n  geom_hline(yintercept = -log10(0.05), linetype = \"dashed\", color = \"black\") +\n  labs(title = \"Volcano Plot with Top 20 Labels\") +\n  theme_minimal()\n\np\n\n\n\n\n\n\n\nFigureÂ 2: Labeled volcano plot",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "VolcanoPlot"
    ]
  },
  {
    "objectID": "Omics/ChromosomePlot.html",
    "href": "Omics/ChromosomePlot.html",
    "title": "Chromosome Plot",
    "section": "",
    "text": "An chromosome plot (ideogram) is a graphical tool used to visualize chromosome structure and various genomic features on chromosomes. It typically represents each chromosome individually, drawing the length and structures such as the centromere to scale. Additionally, it can annotate multiple types of information on the chromosomes, including gene density, genetic variations, expression levels, repetitive sequences, and functional markers.\nChromosome plot can take linear or circular forms (such as Circos plots). Among these, linear ideograms are more suitable for displaying the linear structure of chromosomes and local data variations, making them particularly useful for studies such as genome-wide scans, population comparisons, and genetic mapping. Their visual representation not only facilitates an intuitive understanding of data distribution along chromosomes but also allows for the overlay of multiple layers of information, such as heatmaps, markers, lines, and color blocks.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "ChromosomePlot"
    ]
  },
  {
    "objectID": "Omics/ChromosomePlot.html#example",
    "href": "Omics/ChromosomePlot.html#example",
    "title": "Chromosome Plot",
    "section": "Example",
    "text": "Example\n\n\n\n\n\nThe image shows a chromosome ideogram with dual-line labels, plotted using the built-in Liriodendron data from the RIdeogram package. Each chromosome is drawn to scale, with the color in the center representing genomic heatmap data (here, Fst values reflecting the degree of population differentiation). The upper and lower lines on both sides represent the Pi values (nucleotide diversity) of two populations (CE and CW) across different chromosomal regions.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "ChromosomePlot"
    ]
  },
  {
    "objectID": "Omics/ChromosomePlot.html#setup",
    "href": "Omics/ChromosomePlot.html#setup",
    "title": "Chromosome Plot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: RIdeogram\n\n\n# Install packages\nif (!requireNamespace(\"RIdeogram\", quietly = TRUE)) {\n  install.packages(\"RIdeogram\")\n}\n\n# Load packages\nlibrary(RIdeogram)",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "ChromosomePlot"
    ]
  },
  {
    "objectID": "Omics/ChromosomePlot.html#data-preparation",
    "href": "Omics/ChromosomePlot.html#data-preparation",
    "title": "Chromosome Plot",
    "section": "Data Preparation",
    "text": "Data Preparation\nUse the built-in data from the RIDeogram package.\n\ndata(human_karyotype, package=\"RIdeogram\")\ndata(gene_density, package=\"RIdeogram\")\ndata(Random_RNAs_500, package=\"RIdeogram\")\n\nYou can use the head() function to view the basic format of each data:\n\nhead(human_karyotype)\n\n  Chr Start       End  CE_start    CE_end\n1   1     0 248956422 122026459 124932724\n2   2     0 242193529  92188145  94090557\n3   3     0 198295559  90772458  93655574\n4   4     0 190214555  49712061  51743951\n5   5     0 181538259  46485900  50059807\n6   6     0 170805979  58553888  59829934\n\n\nhuman_karyotype karyotype data contains five columns: the first column is the chromosome ID, the second and third columns are the chromosome start and end positions, and the fourth and fifth columns are the centromere start and end positions. Note: If there is no centromere information, only the first three columns can be retained.\n\nhead(gene_density)\n\n  Chr   Start     End Value\n1   1       1 1000000    65\n2   1 1000001 2000000    76\n3   1 2000001 3000000    35\n4   1 3000001 4000000    30\n5   1 4000001 5000000    10\n6   1 5000001 6000000    10\n\n\ngene_density data is used to draw heat maps. It contains chromosome ID, start and end positions. The fourth column is a numerical value (such as the number of genes, SNP density, etc.) used for heat mapping on chromosomes.\n\nhead(Random_RNAs_500)\n\n   Type    Shape Chr    Start      End  color\n1  tRNA   circle   6 69204486 69204568 6a3d9a\n2  rRNA      box   3 68882967 68883091 33a02c\n3  rRNA      box   5 55777469 55777587 33a02c\n4  rRNA      box  21 25202207 25202315 33a02c\n5 miRNA triangle   1 86357632 86357687 ff7f00\n6 miRNA triangle  11 74399237 74399333 ff7f00\n\n\nRandom_RNAs_500 data is label information (track), with six columns including: label type (such as tRNA, rRNA, miRNA, etc.), shape (optional: circle, box or triangle), chromosome, start and end positions, and label color.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "ChromosomePlot"
    ]
  },
  {
    "objectID": "Omics/ChromosomePlot.html#visualization",
    "href": "Omics/ChromosomePlot.html#visualization",
    "title": "Chromosome Plot",
    "section": "Visualization",
    "text": "Visualization\n\n1. Basic Chromosome Plot\nAfter running, you can find an SVG file and a PNG file in the working directory.\n\n# Basic Chromosome Plot\nideogram(karyotype = human_karyotype)\nconvertSVG(\"chromosome.svg\", device = \"png\")\n\n\n\n\n\n\n\nFigureÂ 1: Basic Chromosome Plot\n\n\n\n\n\n2. Chromosome plot with heatmap\nUse the overlaid parameter to map the whole genome data onto the chromosome map, visualizing the gene density of the entire human genome.\n\n# Chromosome plot with heatmap\nideogram(karyotype = human_karyotype, overlaid = gene_density)\nconvertSVG(\"chromosome.svg\", device = \"png\")\n\n\n\n\n\n\n\nFigureÂ 2: Chromosome plot with heatmap\n\n\n\n\n\n3. Track Label\nMap some genome-wide data as tracks on the side of the chromosome map.\n\n# Track Label\nideogram(karyotype = human_karyotype, label = Random_RNAs_500, label_type = \"marker\")\nconvertSVG(\"chromosome.svg\", device = \"png\")\n\n\n\n\n\n\n\nFigureÂ 3: Track Label\n\n\n\n\n\n4. Plot heatmap and trajectory labels simultaneously\nSimultaneously map the overlaid heatmap and track labels on chromosome representations.\n\n# Plot heatmap and trajectory labels simultaneously\nideogram(karyotype = human_karyotype, overlaid = gene_density, label = Random_RNAs_500, label_type = \"marker\")\nconvertSVG(\"chromosome.svg\", device = \"png\")\n\n\n\n\n\n\n\nFigureÂ 4: Plot heatmap and trajectory labels simultaneously\n\n\n\n\n\n5. Custom heatmap colors\nTo change the colors of the heatmap, modify the colorset1 parameter (default is colorset1 = c(\"#4575b4\", \"#ffffbf\", \"#d73027\")). You can use built-in color names, colors(), or hexadecimal color codes in the format \"#rrggbb\" or \"#rrggbbaa\".\n\n# Custom heatmap colors\nideogram(karyotype = human_karyotype, overlaid = gene_density, label = Random_RNAs_500, label_type = \"marker\", colorset1 = c(\"#fc8d59\", \"#ffffbf\", \"#91bfdb\"))\nconvertSVG(\"chromosome.svg\", device = \"png\")\n\n\n\n\n\n\n\nFigureÂ 5: Custom heatmap colors\n\n\n\n\n\n6. Chromosome plot without centromere information\nIf the species under study lacks clear centromere location information, a chromosome map can still be drawn. In this case, the karyotype file only needs to contain three columns: chromosome number, start position, and end position. The fourth and fifth columns containing the centromere start and end coordinates are unnecessary.\nTo simulate this situation, the last two columns of the human_karyotype data frame included with RIdeogram can be deleted:\n\n# Chromosome plot without centromere information\nhuman_karyotype &lt;- human_karyotype[,1:3]\nideogram(karyotype = human_karyotype, overlaid = gene_density, label = Random_RNAs_500, label_type = \"marker\")\nconvertSVG(\"chromosome.svg\", device = \"png\")\n\n\n\n\n\n\n\nFigureÂ 6: Chromosome plot without centromere information\n\n\n\nEven if centromere information is missing, RIdeogram can still be plotted, but the centromere region will not be marked in the plot.\n\n\n7. Width setting when only part of the chromosome is used\nIn some cases, such as analyzing only a subset of chromosomes (e.g., the first 10 chromosomes), the default plot width may appear too scattered or leave too much white space. In this case, it is recommended to optimize the plot layout by adjusting the width parameter.\nTo simulate this situation, you can retain the first 10 chromosomes from the human_karyotype data and compare the results of plotting with the default width and the adjusted width:\nBefore modification:\n\n# Before modification:\nhuman_karyotype &lt;- human_karyotype[1:10,]\nideogram(karyotype = human_karyotype, overlaid = gene_density, label = Random_RNAs_500, label_type = \"marker\")\nconvertSVG(\"chromosome.svg\", device = \"png\")\n\n\n\n\n\n\n\nFigureÂ 7: Before modification:\n\n\n\nAfter modification:\n\n# After modification\nhuman_karyotype &lt;- human_karyotype[1:10,]\nideogram(karyotype = human_karyotype, overlaid = gene_density, label = Random_RNAs_500, label_type = \"marker\", width = 100)\nconvertSVG(\"chromosome.svg\", device = \"png\")\n\n\n\n\n\n\n\nFigureÂ 8: After modification\n\n\n\n\n\n8. Adjust the legend position\nIf you wish to reposition the legend, you can do so by modifying the Lx and Ly parameters. These parameters control the position of the legendâ€™s top-left corner relative to the image edge. The default values are Lx = 160 and Ly = 35, respectively.\n\nLx: The distance from the top-left corner of the legend to the left edge of the image.\nLy: The distance from the top-left corner of the legend to the top edge of the image.\n\nBy adjusting these parameters, you can prevent the legend from overlapping the main image or position it more appropriately for your layout.\n\n# Adjust the legend position\nideogram(karyotype = human_karyotype, overlaid = gene_density, label = Random_RNAs_500, label_type = \"marker\", width = 100, Lx = 80, Ly = 25)\nconvertSVG(\"chromosome.svg\", device = \"png\")\n\n\n\n\n\n\n\nFigureÂ 9: Adjust the legend position\n\n\n\n\n\n9. Different label types\nRIdeogram supports multiple label types, and you can choose different ways to display data according to your visualization needs. Currently supported label types include:\n\n\"marker\" (marker point)\n\"heatmap\" (heat map)\n\"line\" (polyline)\n\"polygon\" (polygon)\n\n\n9.1 Heatmap Label\n\n# Heatmap Label\ndata(human_karyotype, package=\"RIdeogram\")\nideogram(karyotype = human_karyotype, overlaid = gene_density, label = LTR_density, label_type = \"heatmap\", colorset1 = c(\"#f7f7f7\", \"#e34a33\"), colorset2 = c(\"#f7f7f7\", \"#2c7fb8\"))\nconvertSVG(\"chromosome.svg\", device = \"png\")\n\n\n\n\n\n\n\nFigureÂ 10: Heatmap Label\n\n\n\nThis graph uses human chromosome data built into RIdeogram to show the distribution of two features (gene density and LTR element density) across chromosomes. Different color shades represent different ranges of values, helping to visualize density differences across regions of the genome.\n\n\n9.2 Single line label\n\n# Single line label\ndata(liriodendron_karyotype, package=\"RIdeogram\")\ndata(Fst_between_CE_and_CW, package=\"RIdeogram\")\ndata(Pi_for_CE, package=\"RIdeogram\")\nideogram(karyotype = liriodendron_karyotype, overlaid = Fst_between_CE_and_CW, label = Pi_for_CE, label_type = \"line\", colorset1 = c(\"#e5f5f9\", \"#99d8c9\", \"#2ca25f\"))\nconvertSVG(\"chromosome.svg\", device = \"png\")\n\n\n\n\n\n\n\nFigureÂ 11: Single line label\n\n\n\nThis figure shows the continuous change trend of a single indicator (Pi value) on the chromosome. The fluctuation of the broken line can intuitively reflect the distribution pattern of genetic diversity in different segments.\n\n\n9.3 Double line label\n\n# Double line label\ndata(liriodendron_karyotype, package=\"RIdeogram\")\ndata(Fst_between_CE_and_CW, package=\"RIdeogram\")\ndata(Pi_for_CE_and_CW, package=\"RIdeogram\")\nideogram(karyotype = liriodendron_karyotype, overlaid = Fst_between_CE_and_CW, label = Pi_for_CE_and_CW, label_type = \"line\", colorset1 = c(\"#e5f5f9\", \"#99d8c9\", \"#2ca25f\"))\nconvertSVG(\"chromosome.svg\", device = \"png\")\n\n\n\n\n\n\n\nFigureÂ 12: Double line label\n\n\n\nThis figure shows the comparison of Pi values of two populations (CE and CW) on chromosomes. The double-line parallel depiction helps to discover the differences in diversity between the two groups in certain chromosome segments.\n\n\n9.4 Single polygon label\n\n# Single polygon label\ndata(liriodendron_karyotype, package=\"RIdeogram\")\ndata(Fst_between_CE_and_CW, package=\"RIdeogram\")\ndata(Pi_for_CE, package=\"RIdeogram\")\nideogram(karyotype = liriodendron_karyotype, overlaid = Fst_between_CE_and_CW, label = Pi_for_CE, label_type = \"polygon\", colorset1 = c(\"#e5f5f9\", \"#99d8c9\", \"#2ca25f\"))\nconvertSVG(\"chromosome.svg\", device = \"png\")\n\n\n\n\n\n\n\nFigureÂ 13: Single polygon label\n\n\n\nThis graph displays the variation of a single indicator in polygonal form. The change in area more significantly reflects the size of the value, making it suitable for emphasizing local significant areas.\n\n\n9.5 Double polygon label\n\n# Double polygon label\ndata(liriodendron_karyotype, package=\"RIdeogram\") \ndata(Fst_between_CE_and_CW, package=\"RIdeogram\") \ndata(Pi_for_CE_and_CW, package=\"RIdeogram\") \nideogram(karyotype = liriodendron_karyotype, overlaid = Fst_between_CE_and_CW, label = Pi_for_CE_and_CW, label_type = \"polygon\", colorset1 = c(\"#e5f5f9\", \"#99d8c9\", \"#2ca25f\"))\nconvertSVG(\"chromosome.svg\", device = \"png\")\n\n\n\n\n\n\n\nFigureÂ 14: Double polygon label\n\n\n\nThe second polygon label is automatically offset horizontally by 0.2 chromosome widths to improve readability. This graph uses two sets of polygons to simultaneously display the differences in metrics between the two populations on the chromosome. The overlapping areas or spacing allow for intuitive comparison of the numerical distribution and trends of each segment.\n\n\n\n10. Output image files in different formats\nIn addition to the png format, other formats can also be generated using the device parameter:\n\nconvertSVG(\"chromosome.svg\", device = \"tiff\", dpi = 600)\n\nWithout device, there are some quick functions to convert SVG images to other formats:\n\nsvg2png(\"chromosome.svg\")\nsvg2pdf(\"chromosome.svg\")\nsvg2jpg(\"chromosome.svg\")\nsvg2tiff(\"chromosome.svg\")",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "ChromosomePlot"
    ]
  },
  {
    "objectID": "Omics/ChromosomePlot.html#application",
    "href": "Omics/ChromosomePlot.html#application",
    "title": "Chromosome Plot",
    "section": "Application",
    "text": "Application\n\n\n\n\n\n\nFigureÂ 15: iMapper maps and analyzes insertion site sequence data\n\n\n\n\n\n\n\n\n\nFigureÂ 16: Schematic diagram of the combined domains inferred by IsoPlotter and mapped onto chromosomes",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "ChromosomePlot"
    ]
  },
  {
    "objectID": "Omics/ChromosomePlot.html#reference",
    "href": "Omics/ChromosomePlot.html#reference",
    "title": "Chromosome Plot",
    "section": "Reference",
    "text": "Reference\n[1] RIdeogram: drawing SVG graphics to visualize and map genome-wide data on idiograms https://cran.r-project.org/web/packages/RIdeogram/vignettes/RIdeogram.html [2] Hao Z, Lv D, Ge Y, Shi J, Weijers D, Yu G, Chen J. 2020. RIdeogram: drawing SVG graphics to visualize and map genome-wide data on the idiograms. PeerJ Comput. Sci. 6:e251 http://doi.org/10.7717/peerj-cs.251",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "ChromosomePlot"
    ]
  },
  {
    "objectID": "Omics/KeggPathwayPlot.html",
    "href": "Omics/KeggPathwayPlot.html",
    "title": "KEGG Pathway Plot",
    "section": "",
    "text": "Graphviz view showing a classical signaling pathway (hsa04110 Cell cycle) containing gene data; (b) KEGG view showing a metabolic pathway (hsa00640 Propanoate metabolism) containing discrete gene data and continuous metabolite data.\n\nThe images and R packages are from the article by Luo et al.Â [1]",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "KeggPathwayPlot"
    ]
  },
  {
    "objectID": "Omics/KeggPathwayPlot.html#example",
    "href": "Omics/KeggPathwayPlot.html#example",
    "title": "KEGG Pathway Plot",
    "section": "",
    "text": "Graphviz view showing a classical signaling pathway (hsa04110 Cell cycle) containing gene data; (b) KEGG view showing a metabolic pathway (hsa00640 Propanoate metabolism) containing discrete gene data and continuous metabolite data.\n\nThe images and R packages are from the article by Luo et al.Â [1]",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "KeggPathwayPlot"
    ]
  },
  {
    "objectID": "Omics/KeggPathwayPlot.html#setup",
    "href": "Omics/KeggPathwayPlot.html#setup",
    "title": "KEGG Pathway Plot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: pathview, dbplyr\n\n\n# Installing packages\nif (!requireNamespace(\"pathview\", quietly = TRUE)) {\n  remotes::install_github(\"datapplab/pathview\")\n}\nif (!requireNamespace(\"dbplyr\", quietly = TRUE)) {\n  install.packages(\"dbplyr\")\n}\n\n# Load packages\nlibrary(pathview)\nlibrary(dbplyr)",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "KeggPathwayPlot"
    ]
  },
  {
    "objectID": "Omics/KeggPathwayPlot.html#data-preparation",
    "href": "Omics/KeggPathwayPlot.html#data-preparation",
    "title": "KEGG Pathway Plot",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe example data is a gene expression matrix: the ENTREZ IDs of behavioral genes are listed as sample names, and the expression data is normalized. This can be any numerical data type, such as fold change, p-value, etc., depending on your needs.\n\ndata(\"gse16873.d\")\nhead(gse16873.d)\n\n               DCIS_1      DCIS_2       DCIS_3      DCIS_4       DCIS_5\n10000     -0.30764480 -0.14722769 -0.023784808 -0.07056193 -0.001323087\n10001      0.41586805 -0.33477259 -0.513136907 -0.16653712  0.111122223\n10002      0.19854925  0.03789588  0.341865341 -0.08527420  0.767559264\n10003     -0.23155297 -0.09659311 -0.104727283 -0.04801404 -0.208056443\n100048912 -0.04490724 -0.05203146  0.036390376  0.04807823  0.027205816\n10004     -0.08756237 -0.05027725  0.001821133  0.03023835  0.008034394\n               DCIS_6\n10000     -0.15026813\n10001      0.13400734\n10002      0.15828609\n10003      0.03344448\n100048912  0.05444739\n10004     -0.06860749\n\ngene_data &lt;- as.data.frame(gse16873.d)\nhead(gene_data)\n\n               DCIS_1      DCIS_2       DCIS_3      DCIS_4       DCIS_5\n10000     -0.30764480 -0.14722769 -0.023784808 -0.07056193 -0.001323087\n10001      0.41586805 -0.33477259 -0.513136907 -0.16653712  0.111122223\n10002      0.19854925  0.03789588  0.341865341 -0.08527420  0.767559264\n10003     -0.23155297 -0.09659311 -0.104727283 -0.04801404 -0.208056443\n100048912 -0.04490724 -0.05203146  0.036390376  0.04807823  0.027205816\n10004     -0.08756237 -0.05027725  0.001821133  0.03023835  0.008034394\n               DCIS_6\n10000     -0.15026813\n10001      0.13400734\n10002      0.15828609\n10003      0.03344448\n100048912  0.05444739\n10004     -0.06860749",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "KeggPathwayPlot"
    ]
  },
  {
    "objectID": "Omics/KeggPathwayPlot.html#visualization",
    "href": "Omics/KeggPathwayPlot.html#visualization",
    "title": "KEGG Pathway Plot",
    "section": "Visualization",
    "text": "Visualization\n\n1. Basic Plot\nObserve the cell cycle signaling pathway diagram of a single sample (DCIS_1) (KEGG ID: 04110).\n\n1.1 KEGG View\nWhen kegg.native = TRUE is set, the output pathway diagram is drawn based on the original KEGG view. The output image is automatically saved in the current directory.\n\np1 &lt;- pathview(gene.data = gse16873.d[, 1], # Input gene matrix\n               pathway.id = \"04110\", # Pathway ID\n               species = \"hsa\", # Species: Human\n               out.suffix = \"gse16873_KEGG\", # Output file suffix\n               kegg.native = T, # Output in original KEGG view\n               same.layer = T # Drawing a single layer\n               )\np1\n\n\n\n\n\n\n\nFigureÂ 1: KEGG View\n\n\n\nTo better understand kegg.native = TRUE, letâ€™s compare it with the Cell cycle pathway map on the KEGG official website (https://www.kegg.jp/pathway/map04110)\n\n\n\n\n\n\nFigureÂ 2: Cell cycle pathway diagram on the KEGG official website\n\n\n\nItâ€™s easy to see that the resulting graph weâ€™ve output is based on the pathway diagram provided on the official website, visualizing the differential expression of pathway genes across the study samples. However, when kegg.native = FALSE is used instead, the Graphviz engine is used to generate the graph, and the output is a vector graph in PDF format, which will be discussed later.\nNext, letâ€™s examine the structure of the pathview functionâ€™s output, p1 . Itâ€™s a list of length 2, containing the data we need for our graph.\n\n\n\n\n\n\nTip\n\n\n\n\nplot.data.gene (data.frame): stores the gene data used for plotting.\nplot.data.cpd (data.frame): stores the compound data used for plotting.\nkegg.names: the KEGG-formatted IDs of the genes/compounds mapped to the node (i.e., Entrez Gene IDs or KEGG Compound Accessions).\nlabels: the names of the genes/compounds mapped to the node.\nall.mapped: the IDs of all genes/compounds mapped to the node.\ntype: the node type (â€œgeneâ€, â€œenzymeâ€, â€œcompoundâ€, â€œhomologâ€)\nx: the x-coordinate in the original KEGG pathway graph.\ny: the y-coordinate in the original KEGG pathway graph.\nwidth: the width of the node in the original KEGG pathway graph.\nheight: the height of the node in the original KEGG pathway graph.\nmol.data: Data for the gene/compound mapped to the node (corresponding to the input data gene.data)\nmol.data: Color codes for the gene/compound mapped to the node\n\n\n\n\n\n1.2 Graphviz View\nAfter introducing the output of images in KEGG native form (kegg.native = TRUE), letâ€™s take a look at the image format of the graph output using Graphviz (kegg.native = FALSE).\n\np2 &lt;- pathview(gene.data = gse16873.d[, 1], \n               pathway.id = \"04110\", \n               species = \"hsa\", \n               out.suffix = \"gse16873_Graph\", \n               kegg.native = F ,# Output in Graphviz format\n               same.layer = T # Drawing a single layer\n               )\np2\n\n\n\n\n\n\n\nFigureÂ 3: Graphviz View\n\n\n\nThe KEGG native format preserves all pathway metadata, including spatial and temporal information, tissue/cell types, inputs, outputs, and connections, which is crucial for readability and interpretation of pathway biology. The Graphviz view, however, is a vector PDF format, providing greater control over node and edge properties and a better visualization of pathway topology, allowing for further enhancement using, for example, Adobe illustrations.\nIn pathway diagrams exported in Graphviz format, the same.layer parameter has a different meaning than in the KEGG native format. It now describes the layer relationship between the legend and the pathway diagram. When same.layer = TRUE, the legend and pathway diagram appear on the same layer, and the legend only describes edge types, omitting node types.\nWhen same.layer = FALSE, the legend and pathway diagram appear on separate layers, describing both edge and node types.\n\np3 &lt;- pathview(gene.data = gse16873.d[, 1], \n               pathway.id = \"04110\", \n               species = \"hsa\", \n               out.suffix = \"gse16873_Graph\", \n               kegg.native = F ,# Output in Graphviz format\n               same.layer = T # Drawing a single layer\n               )\np3\n\n\n\n\n\n\n\nFigureÂ 4: Same-layer settings\n\n\n\n\n\n\n2. Graphics Adjustment\nConsidering that many parameters that change the graphic style only take effect when kegg.native = FALSE, we will also draw based on this in most cases.\n\n2.1 Node style adjustment\n\np4 &lt;- pathview(gene.data = gse16873.d[, 1],\n               pathway.id = \"04110\", \n               species = \"hsa\", \n               out.suffix = \"gse16873_node\", \n               kegg.native = F ,\n               same.layer = F ,\n               low = '#4575B4', \n               mid = '#F7F7BD', \n               high = '#D73027', \n               cex = 0.5 , # Font size\n               afactor = 1.6 , # Node size\n               limit = list( gene = 2 ) # Legend upper and lower limits\n               )\np4\n\n\n\n\n\n\n\nFigureÂ 5: Node style adjustment\n\n\n\n\n\n2.2 Node splitting and expansion\nSplitting a node group into individual nodes can be controlled by setting the split.group parameter. Setting expand.node can expand a multi-gene node into a single gene.\nSplit a node group (split.group = TRUE):\n\np5 &lt;- pathview(gene.data = gse16873.d[, 1],\n               pathway.id = \"04110\", \n               species = \"hsa\", \n               out.suffix = \"gse16873_split\", \n               kegg.native = F ,\n               same.layer = F ,\n               split.group = T # TRUE\n               ) \n\np5\n\n\n\n\n\n\n\nFigureÂ 6: Node splitting and expansion\n\n\n\nMulti-gene nodes are expanded to single genes: (split.group = TRUE & expand.node = TRUE):\n\np6 &lt;- pathview(gene.data = gse16873.d[, 1],\n               pathway.id = \"04110\", \n               species = \"hsa\", \n               out.suffix = \"gse16873_expand\", \n               kegg.native = F ,\n               same.layer = F ,\n               split.group = T,\n               expand.node = T # TRUE\n               ) \n\nunique(p6$plot.data.gene$kegg.names) %&gt;% length()\n# [1] 88\nunique(p7$plot.data.gene$kegg.names) %&gt;% length()\n# [1] 158\n\n# The extra nodes are the extensions of the original multi-gene nodes\nsetdiff(unique(B),intersect(A,B))\n\nThen we found that the lines became so complicated that the nodes and relationships between nodes that we were focusing on were lost.\n\n\n\n\n\n\nFigureÂ 7: Multi-gene nodes are expanded to single genes\n\n\n\n\n\n2.3 Multiple groups of samples\nThe above example plots the pathway diagram for a single sample. To compare pathway changes across two or more samples, set multi.state = TRUE. This allows you to combine data from multiple samples into a single pathway diagram. In this case, each node will be split into multiple segments, one for each sample.\n\np8 &lt;- pathview(gene.data = gse16873.d[, 1:3], # Multiple groups of samples\n               pathway.id = \"04110\", \n               species = \"hsa\", \n               out.suffix = \"gse16873_samples\", \n               kegg.native = F ,\n               same.layer = F ,\n               multi.state = T # \n               )\n\nThe effect is that the node is divided into multiple segments corresponding to the number of samples, and one sample corresponds to one color block.\n\n\n\n\n\n\nFigureÂ 8: Multiple groups of samples\n\n\n\n\n\n2.4 Pathway diagram of the compound\nCompound data\nPreviously, we only introduced pathway visualization of gene data. If you are only working with compound data, it is actually the same as gene data. You only need to change gene.data to cpd.data.\n\n# Simulate compound data for 6 samples\ndata(\"cpd.simtypes\")\ncpd_data &lt;- sim.mol.data(mol.type=\"cpd\", nmol=3000)\ncpd_data2 &lt;- matrix(sample(cpd_data,18000,replace = T), ncol = 6)\nrownames(cpd_data2) = names(cpd_data)\ncolnames(cpd_data2) = colnames(gene_data)\nhead(cpd_data2)\n\nKEGG View\n\np9 &lt;- pathview(cpd.data = cpd_data2, # Compound data\n               pathway.id = \"00640\", # \n               species = \"hsa\", \n               out.suffix = \"gse16873_KEGG_cpd\", \n               kegg.native = T , # KEGG View\n               same.layer = F  \n               ) \n\n\n\n\n\n\n\nFigureÂ 9: KEGG View\n\n\n\nGraphviz View\n\np10 &lt;- pathview(cpd.data = cpd_data, # Compound data\n               pathway.id = \"00640\", \n               species = \"hsa\", \n               out.suffix = \"gse16873_Graphviz_cpd\", \n               kegg.native = F , # Graphviz View\"\n               same.layer = F  ,\n               cpd.lab.offset = -1.0 # Compound label position\n               ) \n\n\n\n\n\n\n\nFigureÂ 10: Graphviz Viewâ€\n\n\n\nCompound and gene dataæ®\nNext we illustrate the case of plotting gene and compound data simultaneously:\nKEGG View\n\np11 &lt;- pathview(gene.data = gene_data[,1:4], # Gene data\n               cpd.data = cpd_data2[,1:2], # Compound data\n               pathway.id = \"00640\", \n               species = \"hsa\", \n               out.suffix = \"gse16873_KEGG_gene_cpd\", \n               kegg.native = T , # KEGG View\n               same.layer = F  ,\n               cpd.lab.offset = -1.0 ,\n               key.pos = 'bottomright',\n               match.data = F, # Not match sample\n               multi.state = T ,\n               bins = list(gene = 8, cpd = 8), # Change the number of legend color blocks\n               low = list(gene = \"#6495ED\", cpd = \"#006400\"),\n               mid = list(gene = \"#F7F7BD\", cpd = \"#F7F7BD\"), \n               high = list(gene = \"#D73027\", cpd =\"#FFD700\")\n               ) \n\n\n\n\n\n\n\nFigureÂ 11: KEGG View\n\n\n\nGraphviz View\n\np12 &lt;- pathview(gene.data = gene_data[,1:4], # Gene data\n               cpd.data = cpd_data2[,1:2], # Compound data\n               pathway.id = \"00640\", \n               species = \"hsa\", \n               out.suffix = \"gse16873_Graphviz_gene_cpd\", \n               kegg.native = F , # Graphviz View\n               same.layer = F  ,\n               cpd.lab.offset = -1.0 ,\n               key.pos = 'topright',\n               match.data = F, # Not match sample\n               multi.state = T ,\n               bins = list(gene = 10, cpd = 10), # Change the number of legend color blocks\n               low = list(gene = \"#6495ED\", cpd = \"#006400\"),\n               mid = list(gene = \"#F7F7BD\", cpd = \"#F7F7BD\"), \n               high = list(gene = \"#D73027\", cpd =\"#FFD700\")\n               ) \n\n\n\n\n\n\n\nFigureÂ 12: Graphviz View\n\n\n\nWhen the gene and cpd data have different sample numbers, the parameter match.data = FALSE should be set. If match.data = TRUE is set, the data with fewer samples will generate a column of NAs to match the sample numbers. NA data is transparent by default, but the color can be set using na.col.\n\np13 &lt;- pathview(gene.data = gene_data[,1:4],\n               cpd.data = cpd_data2[,1:2], \n               pathway.id = \"00640\", \n               species = \"hsa\", \n               out.suffix = \"gse16873_Graphviz_gene_cpd_match\", \n               kegg.native = F , # Graphviz View\n               same.layer = F  ,\n               cpd.lab.offset = -1.0 ,\n               key.pos = 'topright',\n               match.data = T, # Matching number of samples: Add 2 columns of NA for cpd\n               multi.state = T , \n               bins = list(gene = 10, cpd = 10),\n               na.col = 'transparent' , # NA data color setting\n               low = list(gene = \"#6495ED\", cpd = \"#006400\"),\n               mid = list(gene = \"#F7F7BD\", cpd = \"#F7F7BD\"), \n               high = list(gene = \"#D73027\", cpd =\"#FFD700\")\n               ) \n\nYou can see that only half of the compound node is colored because the other half is NA and is transparent and colorless by default.\n\n\n\n\n\n\nFigureÂ 13: Set Color\n\n\n\n\n\n2.5 Discrete data\nIf our input data is not a continuous variable like in the example above, but rather a categorical variable such as high/low (which can be replaced by 1/0) or the names of significantly differentially expressed genes, we need to set the discrete parameter to plot a pathway view of the discrete variable.\nHere, we treat the gene data as a discrete variable of 1/0 and the compound as a continuous variable.\n\n# Obtaining genetic data (discrete variables)\ndata(\"gse16873.d\")\ngene_data &lt;- gse16873.d\ncolnames(gene_data)\ngene_data2 &lt;- apply(gene_data, 2, function(x){\n  ifelse(x &gt; mean(x), 1 , 0 )\n}) %&gt;% as.data.frame()\nstr(gene_data2)\n\n\np14 &lt;- pathview(gene.data = gene_data2[,1:4], # Discrete variables\n               cpd.data = cpd_data2[,1:2], # Continuous variables\n               pathway.id = \"00640\", \n               species = \"hsa\", \n               out.suffix = \"gse16873_KEGG_gene_cpd_discrete\", \n               kegg.native = T , # KEGG View\n               same.layer = F  ,\n               cpd.lab.offset = -1.0 ,\n               key.pos = 'topright',\n               match.data = F, \n               multi.state = T ,\n               bins = list(gene = 1, cpd = 6), \n               low = list(gene = \"#F7F7BD\", cpd = \"#006400\"),\n               mid = list(gene = \"#F7F7BD\", cpd = \"#F7F7BD\"), \n               high = list(gene = \"#D73027\", cpd =\"#FFD700\"),\n               discrete = list(gene = T, cpd = F) ,# Discrete data is T\n               limit = list(gene = 1, cpd = c(-1,1)) ,\n               both.dirs = list(gene = F, cpd = T) # gene is one-way data\n               ) \n\n\n\n\n\n\n\nFigureÂ 14: Discrete data1\n\n\n\n\np15 &lt;- pathview(gene.data = gene_data[,1:4], # Discrete variables\n               cpd.data = cpd_data2[,1:2], # Continuous variables\n               pathway.id = \"00640\", \n               species = \"hsa\", \n               out.suffix = \"gse16873_Graphviz_gene_cpd_discrete\",\n               kegg.native = F , # Graphviz View\n               same.layer = F  ,\n               cpd.lab.offset = -1.0 ,\n               key.pos = 'topright',\n               match.data = F, \n               multi.state = T , \n               bins = list(gene = 1, cpd = 6), \n               low = list(gene = \"#F7F7BD\", cpd = \"#006400\"),\n               mid = list(gene = \"#F7F7BD\", cpd = \"#F7F7BD\"), \n               high = list(gene = \"#D73027\", cpd =\"#FFD700\"),\n               discrete = list(gene = T, cpd = F) ,# Discrete data is T\n               limit = list(gene = 1, cpd = c(-1,1)),\n               both.dirs = list(gene = F, cpd = T) # gene.data is one-way data\n               ) \n\n\n\n\n\n\n\nFigureÂ 15: Discrete data2",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "KeggPathwayPlot"
    ]
  },
  {
    "objectID": "Omics/KeggPathwayPlot.html#application",
    "href": "Omics/KeggPathwayPlot.html#application",
    "title": "KEGG Pathway Plot",
    "section": "Application",
    "text": "Application\n\n\n\n\n\n\nFigureÂ 16: Application of KEGG Pathway Plot\n\n\n\nThis figure illustrates key KEGG pathways: MAPK signaling pathway and cellular senescence signaling pathway. The red nodes represent upregulated DEGs in cingulin b-MO mutants, the green marked node represents downregulated DEGs in cingulin b-MO mutants, and the blue marked node represents overlapping targets between Control-MO and cingulin b-MO embryos. The analysis is conducted from three independent experiments in different groups, and each group has 30 embryos. [2]",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "KeggPathwayPlot"
    ]
  },
  {
    "objectID": "Omics/KeggPathwayPlot.html#reference",
    "href": "Omics/KeggPathwayPlot.html#reference",
    "title": "KEGG Pathway Plot",
    "section": "Reference",
    "text": "Reference\n[1] Luo, W., & Brouwer, C. (2013). Pathview: an R/Bioconductor package for pathway-based data integration and visualization. Bioinformatics (Oxford, England), 29(14), 1830â€“1831. https://doi.org/10.1093/bioinformatics/btt285IF: 4.4 B3.\n[2] Lu Y, Tang D, Zheng Z, et al.Â Cingulin b Is Required for Zebrafish Lateral Line Development Through Regulation of Mitogen-Activated Protein Kinase and Cellular Senescence Signaling Pathways. Front Mol Neurosci. 2022;15:844668. Published 2022 May 5. doi:10.3389/fnmol.2022.844668.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "KeggPathwayPlot"
    ]
  },
  {
    "objectID": "Omics/MultiVolcanoPlot.html",
    "href": "Omics/MultiVolcanoPlot.html",
    "title": "Multiple Volcano Plot",
    "section": "",
    "text": "Multiple Volcano Plot is a graph used for differential expression analysis of high-throughput data (such as transcriptomes and proteomes). Compared with the traditional volcano plot, the multi-group volcano plot can display the results of multiple groups at the same time, making it easier to compare the consistency or specificity of differential features horizontally.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "MultiVolcanoPlot"
    ]
  },
  {
    "objectID": "Omics/MultiVolcanoPlot.html#example",
    "href": "Omics/MultiVolcanoPlot.html#example",
    "title": "Multiple Volcano Plot",
    "section": "Example",
    "text": "Example\n\n\n\n\n\nThis Multiple Volcano Plot shows the differential gene expression patterns of multiple cell clusters in single-cell sequencing data. The blocks of different colors on the X-axis represent different cell clusters, and the scattered points inside the blocks represent differential genes. The geom_jitter function is used to add a jitter effect to the scattered points to avoid overlapping data points. The Y-axis represents the difference fold (Average log2FoldChange, red scattered points represent up-regulated genes with log2FC&gt;0, blue scattered points represent down-regulated genes with log2FC&lt;0, and the top5 differential genes are marked with text. The multi-group volcano plot not only highlights the specific differential genes of each cell cluster (such as marker genes for specific cell types), but also can intuitively identify the key regulatory molecules shared across cell clusters.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "MultiVolcanoPlot"
    ]
  },
  {
    "objectID": "Omics/MultiVolcanoPlot.html#setup",
    "href": "Omics/MultiVolcanoPlot.html#setup",
    "title": "Multiple Volcano Plot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming Language: R\nDependencies: scRNAtoolVis; corrplot\n\n\n# Installing necessary packages\nif (!requireNamespace(\"scRNAtoolVis\", quietly = TRUE)) {\n  remotes::install_github('junjunlab/scRNAtoolVis')\n}\nif (!requireNamespace(\"corrplot\", quietly = TRUE)) {\n  install.packages(\"corrplot\")\n}\n\n# Load packages\nlibrary(scRNAtoolVis)\nlibrary(corrplot)",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "MultiVolcanoPlot"
    ]
  },
  {
    "objectID": "Omics/MultiVolcanoPlot.html#data-preparation",
    "href": "Omics/MultiVolcanoPlot.html#data-preparation",
    "title": "Multiple Volcano Plot",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe data uses the pbmc.markers single-cell sequencing differentially expressed gene dataset provided by the scRNAtoolVis package.\n\n# Load data\ndata('pbmc.markers')\n# View data\nhead(pbmc.markers)\n\n              p_val avg_log2FC pct.1 pct.2     p_val_adj     cluster  gene\nRPS12 2.008629e-140  0.7256738 1.000 0.991 2.754633e-136 Naive CD4 T RPS12\nRPS27 2.624075e-140  0.7242847 0.999 0.992 3.598656e-136 Naive CD4 T RPS27\nRPS6  1.280169e-138  0.6742630 1.000 0.995 1.755623e-134 Naive CD4 T  RPS6\nRPL32 4.358823e-135  0.6121027 0.999 0.995 5.977689e-131 Naive CD4 T RPL32\nRPS14 3.618793e-128  0.6179756 1.000 0.994 4.962812e-124 Naive CD4 T RPS14\nCYBA  1.090337e-124 -1.5739355 0.661 0.914 1.495288e-120 Naive CD4 T  CYBA\n\n\nNote: The dataset should include at least the following five columns: p_val, avg_log2FC, p_val_adj, cluster, and gene. The column names cannot be changed, but the order of the columns can be changed. The names of the grouping blocks shown in the plot are the names in the cluster column content.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "MultiVolcanoPlot"
    ]
  },
  {
    "objectID": "Omics/MultiVolcanoPlot.html#visualization",
    "href": "Omics/MultiVolcanoPlot.html#visualization",
    "title": "Multiple Volcano Plot",
    "section": "Visualization",
    "text": "Visualization\n\n1. Basic Plot\nMultiple volcano plots can be drawn using the jjVolcano function provided in the scRNAtoolVis package.\n\n# Basic Multiple Volcano Plot\np &lt;- jjVolcano(\n  diffData = pbmc.markers,\n  topGeneN = 5,\n  log2FC.cutoff = 0.5,\n  col.type = \"updown\",\n  aesCol = c('#0099CC','#CC3333'),\n  tile.col = corrplot::COL2('PuOr', 15)[4:12],\n  cluster.order = rev(unique(pbmc.markers$cluster)),\n  size  = 3.5,\n  fontface = 'italic'\n  )\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Basic Multiple Volcano Plot\n\n\n\n\n\nFigure 1 plots the up-regulated and down-regulated differentially expressed genes in the nine single-cell populations.\n\n\n\n\n\n\nTip\n\n\n\nKey Parameters: \n\ndiffData: The input differential gene table, the data structure is shown in pbmc.markers.\nmyMarkers: Customize the genes to display text labels, for example: myMarkers = c('PPBP', 'PF4') customizes the text labels for two genes.\n\n\n\n\n# Set myMarkers = c('PPBP', 'PF4')\np &lt;- jjVolcano(\n  diffData = pbmc.markers,\n  myMarkers = c('PPBP', 'PF4'),\n  log2FC.cutoff = 0.5,\n  col.type = \"updown\",\n  aesCol = c('#0099CC','#CC3333'),\n  tile.col = corrplot::COL2('PuOr', 15)[4:12],\n  cluster.order = rev(unique(pbmc.markers$cluster)),\n  size  = 3.5,\n  fontface = 'italic',\n  legend.position = c(0.7,0.9)\n  )\n\np\n\n\n\n\n\n\n\nFigureÂ 2: Key Parametersï¼šmyMarkers\n\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nKey Parameters: \n\ntopGeneN: How many top gene text labels are displayed? In the example of Figure 1, topGeneN = 5 displays the text labels of the top 5 up-regulated and down-regulated genes in each cluster. The topGeneN and myMarkers parameters cannot be used at the same time.\nlog2FC.cutoff: Set the threshold of log2FoldChange, which determines the upper and lower boundaries of the grouping box.\n\n\n\n\n# Set log2FC.cutoff=0.5\np1 &lt;- jjVolcano(\n  diffData = pbmc.markers,\n  topGeneN = 0,\n  log2FC.cutoff = 0.5,\n  col.type = \"updown\",\n  aesCol = c('#0099CC','#CC3333'),\n  tile.col = corrplot::COL2('PuOr', 15)[4:12],\n  cluster.order = rev(unique(pbmc.markers$cluster)),\n  size  = 3.5,\n  fontface = 'italic',\n  legend.position = c(0.7,0.9)\n  )\n\n# Set log2FC.cutoff=2.5\np2 &lt;- jjVolcano(\n  diffData = pbmc.markers,\n  topGeneN = 0,\n  log2FC.cutoff = 2.5,\n  col.type = \"updown\",\n  aesCol = c('#0099CC','#CC3333'),\n  tile.col = corrplot::COL2('PuOr', 15)[4:12],\n  cluster.order = rev(unique(pbmc.markers$cluster)),\n  size  = 3.5,\n  fontface = 'italic',\n  legend.position = c(0.7,0.9)\n  )\n\np1 + p2\n\n\n\n\n\n\n\nFigureÂ 3: Key Parametersï¼šlog2FC.cutoff\n\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nKey Parameters: \n\ncol.type: Scatter point color grouping method, Figure 1 example is grouped by â€œupdownâ€, and can also be grouped by â€œadjustPâ€.\n\n\n\n\n# Set col.type=\"adjustP\"\np &lt;- jjVolcano(\n  diffData = pbmc.markers,\n  topGeneN = 5,\n  log2FC.cutoff = 0.5,\n  col.type = \"adjustP\",\n  aesCol = c('#0099CC','#CC3333'),\n  tile.col = corrplot::COL2('PuOr', 15)[4:12],\n  cluster.order = rev(unique(pbmc.markers$cluster)),\n  size  = 3.5,\n  fontface = 'italic',\n  legend.position = c(0.7,0.9)\n  )\n\np\n\n\n\n\n\n\n\nFigureÂ 4: Key Parametersï¼šcol.type\n\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nKey Parameters: \n\naesColï¼šSet the color of the scatter points.\ntile.colï¼šSet the color of the grouped blocks.\ncluster.orderï¼šSets the order of grouping blocks.\nsizeï¼šSet the font size for gene text labels.\nfontfaceï¼šSet the font style for gene text labels.\nlegend.positionï¼šSet the position of the legend.\n\n\n\n\n\n2. Direction of rotation\nUse the flip parameter in the jjVolcano function to rotate the orientation of the heatmap.\n\n# Horizontal multiple volcano plot\np &lt;- \n  jjVolcano(\n    diffData = pbmc.markers,\n    tile.col = corrplot::COL2('PiYG', 15)[4:12],\n    size  = 3.5,\n    fontface = 'italic',\n    legend.position = c(0.8,0.2),\n    flip = T)\n\np\n\n\n\n\n\n\n\nFigureÂ 5: Key Parametersï¼šflip\n\n\n\n\n\nFigure 5. Multiple volcano plots are rotated to horizontal orientation by setting the parameter flip = T.\n\n\n3. Polar Coordinates\n\n# Polar coordinates Multiple volcano plot\np &lt;- jjVolcano(\n  diffData = pbmc.markers,\n  tile.col = corrplot::COL2('RdBu', 15)[4:12],\n  size  = 3.5,\n  fontface = 'italic',\n  polar = T)\n\np\n\n\n\n\n\n\n\nFigureÂ 6: Key Parametersï¼špolar\n\n\n\n\n\nFigure 6 Convert multiple volcano plots to polar coordinates by setting the parameter polar = T.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "MultiVolcanoPlot"
    ]
  },
  {
    "objectID": "Omics/MultiVolcanoPlot.html#applications",
    "href": "Omics/MultiVolcanoPlot.html#applications",
    "title": "Multiple Volcano Plot",
    "section": "Applications",
    "text": "Applications\n\n\n\n\n\n\nFigureÂ 7: Applications of Multiple Volcano Plot\n\n\n\nFigure 7H shows the differential gene expression analysis of up- and down-regulated genes in all ten single-cell clusters. Adjusted P values &lt; 0.01 are indicated in red, while adjusted P values â‰¥ 0.01 are indicated in black. [1]ã€‚",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "MultiVolcanoPlot"
    ]
  },
  {
    "objectID": "Omics/MultiVolcanoPlot.html#reference",
    "href": "Omics/MultiVolcanoPlot.html#reference",
    "title": "Multiple Volcano Plot",
    "section": "Reference",
    "text": "Reference\n[1] Asp M, Giacomello S, Larsson L, et al.Â A Spatiotemporal Organ-Wide Gene Expression and Cell Atlas of the Developing Human Heart. Cell. 2019;179(7):1647-1660.e19. doi:10.1016/j.cell.2019.11.025.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "MultiVolcanoPlot"
    ]
  },
  {
    "objectID": "Correlation/Scatter.html",
    "href": "Correlation/Scatter.html",
    "title": "Scatter Plot",
    "section": "",
    "text": "A scatter plot is a basic visualization chart used to represent the general trend of the dependent variable changing with the independent variable.",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Scatter Plot"
    ]
  },
  {
    "objectID": "Correlation/Scatter.html#example",
    "href": "Correlation/Scatter.html#example",
    "title": "Scatter Plot",
    "section": "Example",
    "text": "Example\n\n\n\n\n\nThe basic scatter plot above can intuitively show the general trend of the dependent variable y changing with the independent variable x. It can be seen that y generally increases with the increase of x.",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Scatter Plot"
    ]
  },
  {
    "objectID": "Correlation/Scatter.html#setup",
    "href": "Correlation/Scatter.html#setup",
    "title": "Scatter Plot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming Language: R\nDependencies: ggplot2, ggpmisc, ggpubr, ggExtra, geomtextpath, plotly, dplyr\n\n\n# Install packages\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"ggpmisc\", quietly = TRUE)) {\n  install.packages(\"ggpmisc\")\n}\nif (!requireNamespace(\"ggpubr\", quietly = TRUE)) {\n  install.packages(\"ggpubr\")\n}\nif (!requireNamespace(\"ggExtra\", quietly = TRUE)) {\n  install.packages(\"ggExtra\")\n}\nif (!requireNamespace(\"geomtextpath\", quietly = TRUE)) {\n  install.packages(\"geomtextpath\")\n}\nif (!requireNamespace(\"plotly\", quietly = TRUE)) {\n  install.packages(\"plotly\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\n\n# Load packages\nlibrary(ggpmisc)\nlibrary(ggplot2)\nlibrary(ggpubr)\nlibrary(ggExtra)\nlibrary(geomtextpath)\nlibrary(plotly)\nlibrary(dplyr)",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Scatter Plot"
    ]
  },
  {
    "objectID": "Correlation/Scatter.html#data-preparation",
    "href": "Correlation/Scatter.html#data-preparation",
    "title": "Scatter Plot",
    "section": "Data Preparation",
    "text": "Data Preparation\nUsing Râ€™s built-in dataset iris and the NCBI GSE243555 dataset\n\n# 1.Load iris data\ndata &lt;- iris\n\n# 2.Load gene expression data (first two rows)\ndata_counts &lt;- read.csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/GSE243555_all_genes_with_counts.txt\", sep = \"\\t\", header = TRUE, nrows = 10) \n\naxis_names &lt;- data_counts[c(1, 2), 1]        # Save names\ndata_counts &lt;- data_counts %&gt;%      \n  select(-1) %&gt;%               # Remove first column\n  slice(1:2) %&gt;%               # remain the first two rows\n  t()  %&gt;%                     # Transpose\n  as.data.frame() %&gt;%\n  setNames(c(\"V1\", \"V2\"))      # Set column names\n\nhead(data_counts)\n\n                           V1  V2\nMCF7.HG..1.              2905 178\nMCF7.HG..LG..2.          2496 161\nADIPO.HG..2.             1802 184\nADIPO.HG..LG..2.         1400 174\nMCF7...ADIPO..HG..2.     2180 154\nMCF7...ADIPO..HG..LG..2. 2123 118",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Scatter Plot"
    ]
  },
  {
    "objectID": "Correlation/Scatter.html#visualization",
    "href": "Correlation/Scatter.html#visualization",
    "title": "Scatter Plot",
    "section": "Visualization",
    "text": "Visualization\n\n1. Basic Plotting\nFigureÂ 1 is a basic scatter plot, which can be drawn by calling geom_point().\n\n# Basic plotting\np &lt;- ggplot(data, aes(x = Sepal.Width, y = Sepal.Length)) +\n  geom_point()\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Basic Plotting\n\n\n\n\n\n\n\n2. Set Point Style\nFigureÂ 2 has changed the shape, size, and color style of the points based on the basic scatter plot.\n\n# Set the shape, size, and color parameters in `geom_point`\np &lt;- ggplot(data, aes(x = Sepal.Width, y = Sepal.Length)) +\n  geom_point(shape = 17, size = 1.5, color = \"blue\")\n\np\n\n\n\n\n\n\n\nFigureÂ 2: Set Point Style\n\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nKey Parameters: shape\nshape is the shape of the point, with optional values ranging from 0 to 25, and the specific shapes are shown in the following figure:\n\n\n\n\n\n\n\n\n\n3. Multi-class Data Plotting, Change Legend Position\n\nMulti-class Data Plotting\nFigureÂ 3 uses color=Species to map the species variable to the color feature, giving different species different colors.\n\n# Multi-class data plotting\np_multi &lt;- ggplot(data, aes(x = Sepal.Width, y = Sepal.Length, color = Species)) +\n  geom_point(shape = 16, size = 1.5)\n\np_multi\n\n\n\n\n\n\n\nFigureÂ 3: Multi-class Data Plotting\n\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nKey Parameters: color=Species\nHere, the Species variable is mapped to the color feature, with different Species groups having different color. You can also map variables to multiple features, such as alpha=Species (mapping the species variable to the transparency feature, meaning the three types of data points will have different transparencies), shape=Species (mapping the species variable to the shape variable), and so on.\n\n\n\n\nMap Categorical Variables to other Features\nFigureÂ 4 maps the species variable to both color and shape, with different species having different colors and shapes.\n\n## Map categorical variables to other features\np_multi &lt;- ggplot(data, aes(\n  x = Sepal.Width, y = Sepal.Length,\n  color = Species, shape = Species\n)) +\n  geom_point()\n\np_multi\n\n\n\n\n\n\n\nFigureÂ 4: Map Categorical Variables to other Features\n\n\n\n\n\n\n\nChange Legend Position\nFigureÂ 5 places the legend in the blank space of the chart, making it more aesthetically pleasing.\n\n## Map categorical variables to other features\np_multi &lt;- ggplot(data, aes(\n  x = Sepal.Width, y = Sepal.Length,\n  color = Species, shape = Species\n)) +\n  geom_point() +\n  # use `theme()` to change the legend position\n  theme(legend.position = \"inside\", legend.position.inside = c(0.87, 0.8))\n\np_multi\n\n\n\n\n\n\n\nFigureÂ 5: Change Legend Position\n\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nKey Parameters: theme\nlegend.positionï¼š\nSet the position of the legend, with options including â€œnoneâ€, â€œleftâ€, â€œrightâ€, â€œbottomâ€, â€œtopâ€, â€œinsideâ€.\nlegend.position.insideï¼š\nThe legend.position=\"inside\" is effective only when it is set. The general form is legend.position.inside=c(x,y), where x and y are numerical values, both ranging from 0 to 1. The larger the x value, the more the legend is positioned to the right; the larger the y value, the higher the legend is positioned. Adjustments can be made according to the actual blank space.\n\n\n\n\n\n4. Add Point Labels\n\ngeom_text() for Point Labels\nFigureÂ 6 uses geom_text() to draw point labels.\n\n# Basic plotting and point labels\n# To ensure that the points do not overlap, only the data with the species \"setosa\" was selected for plotting\np &lt;- ggplot(data = data[data$Species == \"setosa\", ], aes(x = Sepal.Width, y = Sepal.Length)) +\n  geom_point(shape = 16, size = 1.5, color = \"blue\") +\n  geom_text(\n    label = rownames(data[data$Species == \"setosa\", ]),\n    nudge_x = 0.03, nudge_y = -0.04,\n    check_overlap = T\n  )\n\np\n\n\n\n\n\n\n\nFigureÂ 6: geom_text() for Point Labels\n\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nKey Parameters: geom_text\nlabel:\nThe label content displayed on the chart can be column names or other features.\nnudge_x,nudge_y:\nCentered on each point, nudge_x and nudge_y represent the deviation from this center point, and adjustments are made to place the labels in the optimal position.\ncheck_overlapï¼š\nA boolean value, when true, will avoid overlap, but some point labels may not be displayed; when false, it will not check if the points overlap.\n\n\n\n\ngeom_label() for Point Labels\nFigureÂ 7 uses geom_label() to draw point labels.\n\n# `geom_label` can also be used to draw point labels, and the parameters can remain unchanged.\np &lt;- ggplot(data = data[data$Species == \"setosa\", ], aes(x = Sepal.Width, y = Sepal.Length)) +\n  geom_point(shape = 16, size = 1.5, color = \"blue\") +\n  geom_label(\n    label = rownames(data[data$Species == \"setosa\", ]),\n    nudge_x = 0.025, nudge_y = -0.04, size = 2.5\n  )\n\np\n\n\n\n\n\n\n\nFigureÂ 7: geom_label() for Point Labels\n\n\n\n\n\n\n\n\n5. Regression Curve and Regression Equation/Correlation Coefficient\n\nDraw Regression Curve\nFigureÂ 8 introduces a regression curve using geom_smooth(), which is a common form in articles.\n\n# Draw regression curve\np &lt;- ggplot(data_counts, aes(x = V1, y = V2)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", formula = y ~ x, se = T, color = \"red\")\n\np\n\n\n\n\n\n\n\nFigureÂ 8: Draw Regression Curve\n\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nKey Parameters: geom_smooth\nmethod:\nThe method for drawing the regression curve can be chosen, with the default method=NULL. Options include â€œlmâ€, â€œglmâ€, â€œgamâ€, â€œloessâ€, or a custom function.\nformula:\nThe formula used for drawing the regression curve can be chosen, with the default formula=NULL. Options include y ~ x, y ~ poly(x, 2), y ~ log(x), etc.\nse:\nThe Boolean value, where TRUE indicates displaying the confidence interval, with the default se = TRUE.\n\n\n\n\nAdd Regression Equation\nFigureÂ 9 has annotated the regression equation, R-squared, p-value, and other information in the upper left corner.\n\n# Draw regression curve\np &lt;- ggplot(data_counts, aes(x = V1, y = V2)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", formula = y ~ x, se = T, color = \"red\") +\n  # Add the regression equation, eq: equation, R2: R-squared, P: p-value\n  stat_poly_eq(use_label(\"eq\", \"R2.CI\", \"P\"), formula = y ~ x, size = 4, method = \"lm\")\n\np\n\n\n\n\n\n\n\nFigureÂ 9: Add Regression Equation\n\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nKey Parameters: use_label\nThe types of labels to be added, â€œeqâ€, â€œR2â€, â€œPâ€ represent the equation of the regression equation, the R-squared value, and the p-value, respectively. There are also other optional values such as â€œR2.CIâ€ (displaying the 95% confidence interval) and â€œmethodâ€ (displaying the method).\n\n\n\n\nAdjust the Position of the Regression Equation Label\nFigureÂ 10 used the label.y and label.x parameters to adjust the label position as needed.\n\n## Adjust the label to a suitable position\np &lt;- ggplot(data_counts, aes(x = V1, y = V2)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", formula = y ~ x, se = T, color = \"red\") +\n  stat_poly_eq(use_label(\"eq\"),\n    formula = y ~ x, size = 4, method = \"lm\",\n    label.y = 0.45, label.x = 0.5, angle = -5\n  )\n\np\n\n\n\n\n\n\n\nFigureÂ 10: Adjust the Position of the Regression Equation Label\n\n\n\n\n\n\n\nPlotting Multi-class Data with Regression Equations\nFigureÂ 11 uses multiple types of data for plotting and adds regression curves and their labels.\n\n# Multi-class plotting with regression equations\np_multi &lt;- ggplot(data, aes(x = Sepal.Width, y = Sepal.Length, color = Species, shape = Species)) +\n  geom_point(size = 1.5) +\n  scale_colour_manual(values = c(\"setosa\" = \"purple\", \"versicolor\" = \"blue\", \"virginica\" = \"pink\")) +\n  theme(legend.position = \"inside\", legend.position.inside = c(0.87, 0.8)) +      # Set the legend position\n  geom_smooth(method = \"lm\", formula = y ~ x, se = T) +\n  stat_poly_eq(use_label(\"eq\"),\n    formula = y ~ x, size = 3.5, method = \"lm\",\n    label.x = c(0.6, 0.6, 0.6), label.y = c(0.2, 0.6, 0.75), angle = 10, color = \"black\"\n  )\n\np_multi\n\n\n\n\n\n\n\nFigureÂ 11: Plotting Multi-class Data with Regression Equations\n\n\n\n\n\n\n\nDisplay Correlation Coefficient\nFigureÂ 12 uses the stat_cor() function to display the correlation coefficient label.\n\n# Display correlation coefficient\np &lt;- ggplot(data_counts, aes(x = V1, y = V2)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", formula = y ~ x, se = T, color = \"red\") +\n  stat_cor(\n    method = \"pearson\", label.sep = \",\",\n    p.accuracy = 0.00001, r.digits = 5, size = 4\n  )\n\np\n\n\n\n\n\n\n\nFigureÂ 12: Display Correlation Coefficient\n\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nKey Parameters: stat_cor\nmethod:\nThe method for calculating the correlation coefficient, which can be chosen from â€œpearsonâ€ (default), â€œkendallâ€, or â€œspearmanâ€.\nlabel.sep:\nThe delimiter for labels, defaulting to â€œ,â€.\nr.accuracy,p.accuracy:\nThe precision of the R value or P value.\nr.digits,p.digitsï¼š\nThe number of significant digits for the R value or P value.\n\n\n\n\n\n6. Add Labels to Regression Curve\n\nsingle-type Data Plotting with Label\nFigureÂ 13 uses geom_labelsmooth() to add labels to the regression curve.\n\n## Draw the regression line and add labels\np &lt;- ggplot(data[data$Species == \"setosa\", ], aes(x = Sepal.Width, y = Sepal.Length)) +\n  geom_point(shape = 16, size = 2, color = \"blue\") +\n  geom_labelsmooth(aes(label = Species[1]),\n    fill = \"white\",\n    method = \"lm\", formula = y ~ x,\n    size = 6, linewidth = 1,\n    boxlinewidth = 0.6, linecolour = \"red\"\n  )\n\np\n\n\n\n\n\n\n\nFigureÂ 13: single-type Data Plotting with Label\n\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nKey Parameters: geom_labelsmooth\nlabelï¼š\nLabel name.\nfillï¼š\nBox fill color.\nlinewidth:\nLine thickness.\nboxlinewidth:\nThe thickness of the box border.\n\n\n\n\nMulti-class Data Plotting with Labels\nFigureÂ 14 adds label to multiple types of data accordingly.\n\n# Multi-class data plotting with labels\np &lt;- ggplot(data, aes(x = Sepal.Width, y = Sepal.Length, color = Species, shape = Species)) +\n  geom_point(size = 2) +\n  theme(legend.position = \"none\") +\n  geom_labelsmooth(aes(label = Species),\n    fill = \"white\",\n    method = \"lm\", formula = y ~ x,\n    size = 3, linewidth = 0.6, boxlinewidth = 0.3\n  )\n\np     \n\n\n\n\n\n\n\nFigureÂ 14: Multi-class Data Plotting with Labels\n\n\n\n\n\n\n\n\n7. Add Marginal Rug Plots\nFigureÂ 15 uses geom_rug() to add marginal rugs.\n\np &lt;- ggplot(data, aes(x = Sepal.Width, y = Sepal.Length)) +\n  geom_point(shape = 16, size = 1.5, color = \"blue\") +\n  geom_rug(color = \"steelblue\", alpha = 0.1, linewidth = 1.5)\n\np\n\n\n\n\n\n\n\nFigureÂ 15: Add Marginal Rug Plots\n\n\n\n\n\n\n\n8. Add Marginal Distributions\nFigureÂ 16 introduces the marginal distribution of histograms, and multiple parameters can be used to adjust the style of the marginal plots.\n\n# Add marginal distributions\np &lt;- ggplot(data, aes(x = Sepal.Width, y = Sepal.Length)) +\n  geom_point(shape = 16, size = 1.5, color = \"blue\")\n\np\n\np1 &lt;- ggMarginal(p,\n  type = \"histogram\", color = \"red\", fill = \"green\",\n  margins = \"both\", xparams = list(bins = 12, fill = \"purple\")\n)\n\np1\n\n\n\n\n\n\n\nFigureÂ 16: Add Marginal Distributions\n\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nKey Parameters: ggMarginal\ntype:\nThe type of marginal distribution plot, with options including â€œdensityâ€, â€œhistogramâ€, â€œboxplotâ€, â€œviolinâ€, â€œdensigramâ€.\nmargins:\nSet which edge to draw the marginal distribution plot, margins=c(x,y) indicates that marginal plots are drawn on both the x and y edges.\nxparams,yparamsï¼š\nSet the side plot to be effective only for the x or y dimension. The parameters include common parameters such as color, fill, and size, as well as unique parameters for this marginal plot, such as the bins for histograms.\nbins:\nLike the histogram parameter bins, divide the histogram into several bars.\n\n\n\n\n9. Draw 3D Interactive Scatter Plot\nFigureÂ 17 uses three columns of data and supports interactive browsing.\n\n## 3D Interactive Scatter Plot.\np &lt;- plot_ly(data,\n  x = ~ data$Sepal.Length, y = ~ data$Sepal.Width,\n  z = ~ data$Petal.Length, color = ~ data$Species,\n  colors = c(\"#FF6DAE\", \"#D4CA3A\", \"#00BDFF\"),\n  marker = list(size = 5)\n) %&gt;%\n  add_markers()        # Add the above chart to the `plotly` visualization\n\np\n\n\n\n\n\n\n\nFigureÂ 17: Draw 3D Interactive Scatter Plot",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Scatter Plot"
    ]
  },
  {
    "objectID": "Correlation/Scatter.html#applications",
    "href": "Correlation/Scatter.html#applications",
    "title": "Scatter Plot",
    "section": "Applications",
    "text": "Applications\n\n\n\n\n\n\nFigureÂ 18: Applications of Scatter Plot\n\n\n\nThe figure shows that KRT6B expression is positively correlated with immune-related genes (including CXCL9 and CXCL10). [1]\n\n\n\n\n\n\nFigureÂ 19: Applications of Scatter Plot\n\n\n\nThe figure shows that in the brown and dark blue modules, there is a strong positive correlation between module members and gene importance (cor=0.78&p&lt;0.001, cor=0.59&p&lt;0.001). [2]\n\n\n\n\n\n\nFigureÂ 20: Applications of Scatter Plot\n\n\n\nThe figure explores the association between CXCR4 and various immune cells. [3]",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Scatter Plot"
    ]
  },
  {
    "objectID": "Correlation/Scatter.html#reference",
    "href": "Correlation/Scatter.html#reference",
    "title": "Scatter Plot",
    "section": "Reference",
    "text": "Reference\n[1] Song Q, Yu H, Cheng Y, et al.Â Bladder cancer-derived exosomal KRT6B promotes invasion and metastasis by inducing EMT and regulating the immune microenvironment[J]. J Transl Med, 2022,20(1):308.\n[2] Xie J, Chen L, Wu D, et al.Â Significance of liquid-liquid phase separation (LLPS)-related genes in breast cancer: a multi-omics analysis[J]. Aging (Albany NY), 2023,15(12):5592-5610.\n[3]Zhang S, Hou L, Sun Q. Correlation analysis of intestinal flora and immune function in patients with primary hepatocellular carcinoma[J]. J Gastrointest Oncol, 2022,13(3):1308-1316.",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Scatter Plot"
    ]
  },
  {
    "objectID": "Correlation/UMAPplot.html",
    "href": "Correlation/UMAPplot.html",
    "title": "UMAP Plot",
    "section": "",
    "text": "UMAP (Uniform Manifold Approximation and Projection) is a powerful nonlinear dimensionality reduction technique primarily used for processing high-dimensional data. The core of the UMAP algorithm is to preserve both the local and global structure of the data. It constructs a proximity graph between data points and leverages the graphâ€™s topology for manifold approximation and optimization. It effectively maps high-dimensional data into a low-dimensional space for visualization and further analysis. In bioinformatics, it is well-suited for processing high-dimensional data such as gene expression and microbiome data. Below, we demonstrate the application of UMAP in binary classification clinical data and single-cell sequencing data, respectively.",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "UMAP Plot"
    ]
  },
  {
    "objectID": "Correlation/UMAPplot.html#example",
    "href": "Correlation/UMAPplot.html#example",
    "title": "UMAP Plot",
    "section": "",
    "text": "UMAP (Uniform Manifold Approximation and Projection) is a powerful nonlinear dimensionality reduction technique primarily used for processing high-dimensional data. The core of the UMAP algorithm is to preserve both the local and global structure of the data. It constructs a proximity graph between data points and leverages the graphâ€™s topology for manifold approximation and optimization. It effectively maps high-dimensional data into a low-dimensional space for visualization and further analysis. In bioinformatics, it is well-suited for processing high-dimensional data such as gene expression and microbiome data. Below, we demonstrate the application of UMAP in binary classification clinical data and single-cell sequencing data, respectively.",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "UMAP Plot"
    ]
  },
  {
    "objectID": "Correlation/UMAPplot.html#setup",
    "href": "Correlation/UMAPplot.html#setup",
    "title": "UMAP Plot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: umap, ggplot2, patchwork, RColorBrewer, Seurat, SeuratData, dplyr, mlbench\n\n\n# Installing packages\nif (!requireNamespace(\"umap\", quietly = TRUE)) {\n  install.packages(\"umap\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"patchwork\", quietly = TRUE)) {\n  install.packages(\"patchwork\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\nif (!requireNamespace(\"Seurat\", quietly = TRUE)) {\n  install.packages(\"Seurat\")\n}\nif (!requireNamespace(\"SeuratData\", quietly = TRUE)) {\n  remotes::install_github('satijalab/seurat-data')\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"mlbench\", quietly = TRUE)) {\n  install.packages(\"mlbench\")\n}\n\n# Load packages\nlibrary(umap)\nlibrary(ggplot2)\nlibrary(patchwork)\nlibrary(RColorBrewer) \nlibrary(Seurat)      \nlibrary(SeuratData)\nlibrary(dplyr)\nlibrary(mlbench)",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "UMAP Plot"
    ]
  },
  {
    "objectID": "Correlation/UMAPplot.html#data-preparation",
    "href": "Correlation/UMAPplot.html#data-preparation",
    "title": "UMAP Plot",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n1. Clinical phenotype data: Wisconsin Breast Cancer Dataset\nThe BreastCancer dataset in the mlbench package is used. This data was originally collected by Dr.Â William H. Wolberg at the Wisconsin State Hospital and contains measurements of tumor features collected from breast cancer patients, such as the radius, texture, and symmetry of the tumor, as well as corresponding benign (benign) or malignant (malignant) labels. To facilitate analysis, the following simple preprocessing is performed on the data:\n\ndata(BreastCancer)\nwdbc_data &lt;- BreastCancer[, -1]  # Remove the ID column\nwdbc_data &lt;- na.omit(wdbc_data)\nfeatures &lt;- wdbc_data[, 1:9]  # Using the first 9 features\nfeatures &lt;- as.data.frame(lapply(features, function(x) as.numeric(as.character(x))))\ndiagnosis &lt;- wdbc_data$Class\nhead(features) \n\n\n\n2. Single-cell sequencing data: IFNB dataset\nIFNB is based on a PBMC dataset. PBMC (Peripheral Blood Mononuclear Cells) is a scRNA-seq dataset of peripheral blood mononuclear cells provided by 10x Genomics. It contains annotated B cells, T cells, NK cells, monocytes, and more. IFNB includes two PBMC datasets: one from an interferon-stimulated group and one from a control group.\nSingle-cell sequencing data, due to its high dimensionality and sparseness, is well-suited for UMAP dimensionality reduction. Below, we will use the IFNB single-cell RNA-seq dataset as an example to demonstrate UMAP dimensionality reduction in single-cell analysis. This dataset can be loaded using SeuratData.\nRunUMAP() is the UMAP dimensionality reduction function provided by Seurat. The following code provides a brief description of single-cell data preprocessing prior to UMAP. For detailed principles and instructions, please refer to professional single-cell data analysis tutorials and will not be elaborated here.\n\n# InstallData(\"ifnb\")\n# ifnb &lt;- LoadData(\"ifnb\") # Seurat V4\n\ndata(\"ifnb\") \nifnb &lt;- UpdateSeuratObject(ifnb) # Seurat V5\n\nifnb &lt;- NormalizeData(ifnb) # Perform Log2(x+1) transformation on the data\nifnb &lt;- FindVariableFeatures(ifnb) # Extract the feature with the largest variance for dimensionality reduction\nifnb &lt;- ScaleData(ifnb) # Data Scaling\nifnb &lt;- RunPCA(ifnb) # PCA pre-dimensionality reduction\nifnb &lt;- RunUMAP(ifnb, dims = 1:20) # UMAP Dimensionality Reduction",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "UMAP Plot"
    ]
  },
  {
    "objectID": "Correlation/UMAPplot.html#visualization",
    "href": "Correlation/UMAPplot.html#visualization",
    "title": "UMAP Plot",
    "section": "Visualization",
    "text": "Visualization\n\n1. UMAP visualization of clinical phenotype data\numap is an R package for UMAP dimensionality reduction, which provides a convenient umap() function for dimensionality reduction and parameter adjustment.\n\nset.seed(123)\nwdbc_umap &lt;- umap(features, \n                 n_neighbors = 15, \n                 min_dist = 0.2,\n                 metric = \"euclidean\")\n\nggplot(data.frame(wdbc_umap$layout, Diagnosis = diagnosis),\n       aes(X1, X2, color = Diagnosis)) +\n  geom_point(size = 3, alpha = 0.8) +\n  stat_ellipse(level = 0.9) +\n  theme_minimal() +\n  labs(title = \"UMAP of Wisconsin Breast Cancer Dataset\",\n       x = \"UMAP1\", y = \"UMAP2\",\n       subtitle = \"n_neighbors=15, min_dist=0.2\") +\n  scale_color_manual(values = c(\"benign\" = \"#1b9e77\", \"malignant\" = \"#d95f02\"))\n\n\n\n\n\n\n\nFigureÂ 1: UMAP visualization of clinical phenotype data\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nParameter Description:\n\nn_neighbors: Controls the granularity of local structure. Smaller values capture finer local structure but may overfit noise; larger values preserve more global structure but may blur local details. Default is 15.\nmin_dist: Controls the minimum distance between embedded points in the manifold space. Smaller values make data points closer together and local structure clearer; larger values make points more dispersed and global structure more apparent.\nmetric: Defines the distance metric. Options include \"euclidean\", \"cosine\", \"manhattan\", and \"pearson\".\n\n\n\nParameter sensitivity analysis\nWe can try adjusting different parameters in UMAP to adjust the dimensionality reduction effect. The following shows a comparison of UMAP results obtained using three different parameter combinations.\n\n# Defining parameter combinations\nparams &lt;- list(\n  list(n_neighbors=5, min_dist=0.1, label=\"Aggressive\"),\n  list(n_neighbors=15, min_dist=0.2, label=\"Default\"),\n  list(n_neighbors=50, min_dist=0.5, label=\"Conservative\")\n)\n\n# Generate UMAP and plot\nplots &lt;- list()\nfor (i in seq_along(params)) {\n  set.seed(123)\n  umap_res &lt;- umap::umap(features, \n                  n_neighbors = params[[i]]$n_neighbors,\n                  min_dist = params[[i]]$min_dist)\n  \n  df &lt;- data.frame(umap_res$layout, Diagnosis = diagnosis)\n  \n  plots[[i]] &lt;- ggplot(df, aes(X1, X2, color = Diagnosis)) +\n    geom_point(size = 2, alpha = 0.7) +\n    labs(title = paste(\"Params:\", params[[i]]$label),\n         subtitle = sprintf(\"n_neighbors=%d, min_dist=%.1f\", \n                          params[[i]]$n_neighbors, params[[i]]$min_dist),\n         x = \"UMAP1\", y = \"UMAP2\") +\n    theme_minimal(base_size = 10) +\n    scale_color_manual(values = c(\"benign\" = \"#1b9e77\", \"malignant\" = \"#d95f02\"))\n}\n\n# Using patchwork for typesetting\n(plots[[1]] / plots[[2]] / plots[[3]])\n\n\n\n\n\n\n\nFigureÂ 2: Parameter sensitivity analysis\n\n\n\n\n\n2. Seurat UMAP visualization\nSeurat provides the UMAP dimensionality reduction visualization interface function DimPlot() , which allows users to quickly visualize single-cell data. Below are the results of coloring cells by cell type and treatment group in the same dimensionality reduction space obtained above.\n(Note: The code above does not perform cell clustering; the classification results are based on the pre-defined annotations in the dataset.)\n\nplots &lt;- list()\ngroup_ident &lt;- c('seurat_annotations', 'stim')\nfor (i in seq_along(group_ident)) {\n  p &lt;- DimPlot(ifnb, reduction = 'umap', group.by = group_ident[i])\n  plots[[i]] &lt;- p\n}\n\n(plots[[1]] / plots[[2]])\n\n\n\n\n\n\n\nFigureÂ 3: Seurat UMAP visualization\n\n\n\n\n\n3. ggplot2 custom UMAP visualization\nIn addition to using interface functions, we can also use ggplot2 to customize the UMAP graph.\n\n# Extract UMAP coordinates and metadata\numap_df &lt;- Embeddings(ifnb, \"umap\") %&gt;% as.data.frame() %&gt;% mutate(CellType = ifnb$seurat_annotations, Treatment = ifnb$stim) \nhead(umap_df)\n\ncustom_colors &lt;- c(\n  \"#8DD3C7\", \"#FFFFB3\", \"#BEBADA\", \"#FB8072\", \"#80B1D3\",\n  \"#FDB462\", \"#B3DE69\", \"#FCCDE5\", \"#D9D9D9\", \"#BC80BD\",\n  \"#CCEBC5\", \"#FFED6F\", \"#A6CEE3\")\n\nggplot(umap_df, aes(UMAP_1, UMAP_2, color = CellType)) +\n      geom_point(size = 1.5, alpha = 0.8) + \n      theme_minimal() + labs(title = \"IFNB UMAP\", x = \"UMAP1\", y = \"UMAP2\") +\n      scale_color_manual(values = custom_colors)\n\n\n\n\n\n\n\nFigureÂ 4: ggplot2 custom UMAP visualization",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "UMAP Plot"
    ]
  },
  {
    "objectID": "Correlation/UMAPplot.html#application",
    "href": "Correlation/UMAPplot.html#application",
    "title": "UMAP Plot",
    "section": "Application",
    "text": "Application\n\n\n\n\n\n\nFigureÂ 5: Application of UMAP Plot\n\n\n\nFigures A-H show UMAP images of eight pancreatic islet cell datasets. [1]",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "UMAP Plot"
    ]
  },
  {
    "objectID": "Correlation/UMAPplot.html#reference",
    "href": "Correlation/UMAPplot.html#reference",
    "title": "UMAP Plot",
    "section": "Reference",
    "text": "Reference\n[1] Stuart T, Butler A, Hoffman P, et al.Â Comprehensive Integration of Single-Cell Data. Cell. 2019;177(7):1888-1902.e21.",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "UMAP Plot"
    ]
  },
  {
    "objectID": "Correlation/PCAplot.html",
    "href": "Correlation/PCAplot.html",
    "title": "PCA Plot",
    "section": "",
    "text": "Principal component analysis (PCA) is a commonly used dimensionality reduction technique for high-dimensional data analysis. Its main principle is to transform the data by identifying the two principal component directions with the largest variance. This linear transformation projects the high-dimensional data into a low-dimensional space while preserving the dataâ€™s key features. This article demonstrates how to perform PCA analysis in R and visualize it using the Iris dataset.",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "PCA Plot"
    ]
  },
  {
    "objectID": "Correlation/PCAplot.html#example",
    "href": "Correlation/PCAplot.html#example",
    "title": "PCA Plot",
    "section": "",
    "text": "Principal component analysis (PCA) is a commonly used dimensionality reduction technique for high-dimensional data analysis. Its main principle is to transform the data by identifying the two principal component directions with the largest variance. This linear transformation projects the high-dimensional data into a low-dimensional space while preserving the dataâ€™s key features. This article demonstrates how to perform PCA analysis in R and visualize it using the Iris dataset.",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "PCA Plot"
    ]
  },
  {
    "objectID": "Correlation/PCAplot.html#setup",
    "href": "Correlation/PCAplot.html#setup",
    "title": "PCA Plot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: ggplot2, dplyr, ggfortify, FactoMineR, factoextra\n\n\n# Installing packages\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"ggfortify\", quietly = TRUE)) {\n  install.packages(\"ggfortify\")\n}\nif (!requireNamespace(\"FactoMineR\", quietly = TRUE)) {\n  install.packages(\"FactoMineR\")\n}\nif (!requireNamespace(\"factoextra\", quietly = TRUE)) {\n  install.packages(\"factoextra\")\n}\n\n# Load packages\nlibrary(ggplot2)\nlibrary(ggfortify)\nlibrary(FactoMineR)\nlibrary(factoextra)\nlibrary(dplyr)",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "PCA Plot"
    ]
  },
  {
    "objectID": "Correlation/PCAplot.html#data-preparation",
    "href": "Correlation/PCAplot.html#data-preparation",
    "title": "PCA Plot",
    "section": "Data Preparation",
    "text": "Data Preparation\nUse the iris dataset in Râ€™s own dataset iris for demonstration\n\ndata(\"iris\")\nhead(iris) \n\n  Sepal.Length Sepal.Width Petal.Length Petal.Width Species\n1          5.1         3.5          1.4         0.2  setosa\n2          4.9         3.0          1.4         0.2  setosa\n3          4.7         3.2          1.3         0.2  setosa\n4          4.6         3.1          1.5         0.2  setosa\n5          5.0         3.6          1.4         0.2  setosa\n6          5.4         3.9          1.7         0.4  setosa",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "PCA Plot"
    ]
  },
  {
    "objectID": "Correlation/PCAplot.html#visualization",
    "href": "Correlation/PCAplot.html#visualization",
    "title": "PCA Plot",
    "section": "Visualization",
    "text": "Visualization\nPCA analysis\nWe first perform PCA analysis on the data. It should be noted that the data needs to be analyzed after standardization. The parameter scale in the function prcomp() provides us with the option of automatic standardization:\n\niris.pca &lt;- prcomp(iris[, -5], scale = TRUE)\nsummary(iris.pca)\n\nImportance of components:\n                          PC1    PC2     PC3     PC4\nStandard deviation     1.7084 0.9560 0.38309 0.14393\nProportion of Variance 0.7296 0.2285 0.03669 0.00518\nCumulative Proportion  0.7296 0.9581 0.99482 1.00000\n\n\n\n1. Variance Explanation and Variable Contribution Visualization\nAs you can see in summary(iris.pca), weâ€™ve extracted multiple principal components, PCs, from the dataset, describing the data from a new â€œperspective.â€ We can use fviz_eig() to draw the following histogram to show the proportion of data variance explained by each principal component. Meanwhile, fviz_pca_var() plots the variable contribution graph, showing the relationship between the original variables (i.e., petal length, width, and other raw features) and the top two principal components. The length of the arrow indicates the variable contribution (specified by col.var = \"contrib\"):\n\nfviz_eig(iris.pca, \n         addlabels = TRUE, \n         ylim = c(0, 85),\n         main = \"PCA variance explained proportion\",\n         xlab = \"PC\",\n         ylab = \"Percentage of variance explained\")\n\n\n\n\n\n\n\nFigureÂ 1: fviz_eig\n\n\n\n\n\n\nfviz_pca_var(iris.pca,\n             col.var = \"contrib\",\n             gradient.cols = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"),\n             repel = TRUE,\n             title = \"Variable contribution plot\")\n\n\n\n\n\n\n\nFigureÂ 2: fviz_pca_var\n\n\n\n\n\n\n\n2. Distribution of samples in principal component space\nNow that weâ€™ve transformed the data, we can plot the distribution of the samples in this new principal component space. If the principal components explain a high degree of variance, weâ€™ll see that different iris species are far apart in principal component space, while irises of the same species are close together. fviz_pca_ind() can create a scatter plot of the data along PC1 and PC2, coloring them by iris species and adding confidence ellipses.\n\nfviz_pca_ind(iris.pca,\n             col.ind = iris$Species,\n             geom.ind = \"point\",\n             palette = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"),\n             addEllipses = TRUE,\n             ellipse.type = \"confidence\",\n             legend.title = \"Species\",\n             # repel = TRUE,\n             title = \"Sample PCA score plot\")\n\n\n\n\n\n\n\nFigureÂ 3: fviz_pca_ind\n\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nParameter Description:\n\ncol.ind: Categorical variable for input data\ngeom.ind: Select the type of scatter plot to draw. The default is labeled scatter plots. Entering â€œpointâ€ will cause the scatter plots to be labeled without labels.\npalette: Color vector to apply to the categorical variable\naddEllipses: Whether to add ellipses\nellipse.type: Ellipse calculation method. Acceptable values include â€œconvexâ€, â€œconfidenceâ€, â€œtâ€, â€œnormâ€, and â€œeuclidâ€.\nlegend.title: Legend title\nrepel: Whether to use extended lines to mark data points\ntitle: Image title\n\n\n\nSimilar to fviz_pca_ind(), fviz_pca_biplot() can add original variable information based on sample scatter plots.\n\nfviz_pca_biplot(iris.pca,\n                col.ind = iris$Species,\n                palette = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"),\n                addEllipses = TRUE,\n                geom.ind = \"point\",\n                ellipse.type = \"confidence\",\n                legend.title = \"Species\",\n                # repel = TRUE,\n                title = \"PCA biplot\")\n\n\n\n\n\n\n\nFigureÂ 4: fviz_pca_biplot\n\n\n\n\n\nIn addition, we can also use ggplot2 to customize the PCA sample graph:\n\npca_scores &lt;- as.data.frame(iris.pca$x)\npca_scores$Species &lt;- iris$Species\n\nggplot(pca_scores, aes(x = PC1, y = PC2, color = Species)) +\n  geom_point(size = 3, alpha = 0.8) +\n  stat_ellipse(level = 0.95, linewidth = 1) +\n  scale_color_manual(values = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\")) +\n  labs(title = \"PCA analysis of the iris data set\",\n       x = paste0(\"PC1 (\", round(summary(iris.pca)$importance[2,1]*100, 1), \"%)\"),\n       y = paste0(\"PC2 (\", round(summary(iris.pca)$importance[2,2]*100, 1), \"%)\"),\n       caption = \"Confidence level: 95%\") +\n  theme_minimal(base_size = 12) +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\n\n\nFigureÂ 5: ggplot2 custom drawing PCA sample graph\n\n\n\n\n\n\n\n3. PCA analysis using FactoMineR\nFactoMineR is an R package designed for multidimensional data analysis and exploration. It also provides a convenient PCA analysis function, PCA(). The following is a simple demonstration of its use and visualization:\n\nres.pca &lt;- PCA(iris[, -5], scale.unit = TRUE, graph = FALSE)\nfviz_pca_ind(res.pca, \n             label = \"none\", \n             habillage = iris$Species,\n             addEllipses = TRUE, \n             ellipse.level = 0.95,\n             title = \"FactoMineR PCA results\")\n\n\n\n\n\n\n\nFigureÂ 6: FactoMineR draws PCA graph",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "PCA Plot"
    ]
  },
  {
    "objectID": "Correlation/PCAplot.html#application",
    "href": "Correlation/PCAplot.html#application",
    "title": "PCA Plot",
    "section": "Application",
    "text": "Application\n\n\n\n\n\n\nFigureÂ 7: Applications of PCA Plot\n\n\n\nThe figure shows the first two principal components of the mean projection strength of piriform cortex output neurons to AON, CoA, LENT, and OT. Each dot represents a slice. [1]",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "PCA Plot"
    ]
  },
  {
    "objectID": "Correlation/PCAplot.html#reference",
    "href": "Correlation/PCAplot.html#reference",
    "title": "PCA Plot",
    "section": "Reference",
    "text": "Reference\n[1] Chen Y, Chen X, Baserdem B. et al.Â High-throughput sequencing of single neuron projections reveals spatial organization in the olfactory cortex. Cell. 2022 Oct 27;185(22):4117-4134.e28.",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "PCA Plot"
    ]
  },
  {
    "objectID": "Correlation/ConnectedScatter.html",
    "href": "Correlation/ConnectedScatter.html",
    "title": "Connected Scatter",
    "section": "",
    "text": "Connected scatter is a type of chart that builds upon scatter by adding lines to connect the data points in a certain order. It allows us to discern not only the correlation between independent variable and dependent variable but also the trend in the data points.",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Connected Scatter"
    ]
  },
  {
    "objectID": "Correlation/ConnectedScatter.html#example",
    "href": "Correlation/ConnectedScatter.html#example",
    "title": "Connected Scatter",
    "section": "Example",
    "text": "Example\n\n\n\n\n\nIn this figure, this is a basic connected scatter plot. The curve representing the change between Sepal.Length and Sepal.Widthfluctuates up and down. However, overall, the dependent variable Sepal.Length increases as the independent variable Sepal.Width increases.",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Connected Scatter"
    ]
  },
  {
    "objectID": "Correlation/ConnectedScatter.html#setup",
    "href": "Correlation/ConnectedScatter.html#setup",
    "title": "Connected Scatter",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming Language: R\nDependencies: ggplot2, dplyr\n\n\n# Install packages\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\n\n# Load packages\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(stringr)",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Connected Scatter"
    ]
  },
  {
    "objectID": "Correlation/ConnectedScatter.html#data-preparation",
    "href": "Correlation/ConnectedScatter.html#data-preparation",
    "title": "Connected Scatter",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe datasets used are the built-in R datasets iris and economics. The iris dataset contains measurements of sepal length and width, as well as petal length and width, for three species of iris plants. The economics dataset is a time series of U.S. economic data. Additionally, the gene expression data for breast cancer from the NCBI database is used,which has 24 sample columns, and two rows of gene expression data are selected for plotting.\n\n# 1.Load iris data\ndata(\"iris\", package = \"datasets\")\ndata &lt;- iris\n\n# 2. Load and filter time series data\n# To simplify the plotting process, only the data from December is selected to represent the entire year\ndata_economics &lt;- economics %&gt;%\n  select(date, psavert, uempmed) %&gt;%\n  filter(str_detect(date, \"-12-01\")) %&gt;%\n  slice_head(n = 25) %&gt;%\n  mutate(date = str_extract(date, \"^\\\\d{4}\")) %&gt;% #extracts the 4-digit year from the beginning of each date string.\n  select(date, psavert, uempmed)\n\n# 3.Load gene expression data (first two rows)\ndata_counts &lt;- read.csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/GSE243555_all_genes_with_counts.txt\", sep = \"\\t\", header = TRUE, nrows = 10)\n\naxis_names &lt;- data_counts[c(1, 2), 1]        # Save names\n\ndata_counts &lt;- data_counts %&gt;%      \n  select(-1) %&gt;%               # Remove first column\n  slice(1:2) %&gt;%               # remain the first two rows\n  t()  %&gt;%                     # Transpose\n  as.data.frame() %&gt;%\n  setNames(c(\"V1\", \"V2\"))      # Set column names\n\nhead(data_counts)\n\n                           V1  V2\nMCF7.HG..1.              2905 178\nMCF7.HG..LG..2.          2496 161\nADIPO.HG..2.             1802 184\nADIPO.HG..LG..2.         1400 174\nMCF7...ADIPO..HG..2.     2180 154\nMCF7...ADIPO..HG..LG..2. 2123 118",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Connected Scatter"
    ]
  },
  {
    "objectID": "Correlation/ConnectedScatter.html#visualization",
    "href": "Correlation/ConnectedScatter.html#visualization",
    "title": "Connected Scatter",
    "section": "Visualization",
    "text": "Visualization\n\n1. Basic Plotting\nFigureÂ 1 was created by adding geom_line to the scatter plot.\n\n# Basic plotting, only adding `geom_line`\np &lt;- ggplot(data[data$Species == \"setosa\", ], aes(x = Sepal.Width, y = Sepal.Length)) +\n  geom_point(shape = 17, size = 1.5, color = \"blue\") +\n  geom_line()\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Basic Plotting\n\n\n\n\n\n\n\n2. Set Line Styles\nFigureÂ 2 sets the line direction, width, type, and color by parameters.\n\n## Set line styles\np &lt;- ggplot(data[data$Species == \"setosa\", ], aes(x = Sepal.Width, y = Sepal.Length)) +\n  geom_point(shape = 17, size = 1.5, color = \"blue\") +\n  geom_line(orientation = \"x\", linetype = 1, color = \"red\", linewidth = 0.1)\n\np\n\n\n\n\n\n\n\nFigureÂ 2: Set Line Styles\n\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nKey Parameters: geom_line\nlinetype:\nlinetype indicates the type of line, with optional values ranging from 0 to 6 (0 = blank, 1 = solid, 2 = dashed, 3 = dotted, 4 = dotdash, 5 = longdash, 6 = twodash). The specific shapes are shown in the following figure:\n\n\n\n\n\norientation:\nThe orientation of the line segment, with options â€œxâ€ and â€œyâ€. When orientation=\"x\", the line is plotted with x as the independent variable and y as the dependent variable.\nlinewidth:\nThe thickness of the line segment.\n\n\n\n\n3. Multiclass Data Plotting\nFigureÂ 3 was created by using color=Species, shape=Species, and linetype=Species to map the categorical variable to multiple features.\n\n## Multiclass Data Plotting\n## Use `color=Species`,`shape=Species`,`linetype=Species` to map categorical variables to multiple features\np &lt;- ggplot(\n  data[data$Species == \"setosa\" | data$Species == \"virginica\", ],\n  aes(x = Sepal.Width, y = Sepal.Length)\n) +\n  geom_point(aes(color = Species, shape = Species), size = 1.5) +\n  geom_line(aes(linetype = Species)) +\n  # Change the position of the legend\n  theme(legend.position = \"inside\", legend.position.inside = c(0.85, 0.8))\n\np\n\n\n\n\n\n\n\nFigureÂ 3: Multiclass Data Plotting\n\n\n\n\n\n\n\n4. Plotting with Genetic Data\nFigureÂ 4 shows a connected scatter plot of two genes related to breast cancer.\n\n# Plotting with genetic data\np &lt;- ggplot(data_counts, aes(x = V1, y = V2)) +\n  geom_point(shape = 17, size = 1.5, color = \"blue\") +\n  geom_line(orientation = \"x\", linetype = 1, color = \"red\", linewidth = 0.1) +\n  theme(axis.text.x = element_text(angle = 90)) + # Avoid text overlap\n  labs(x = axis_names[1], y = axis_names[2]) # Add x-axis and y-axis labels\n\np\n\n\n\n\n\n\n\nFigureÂ 4: Plotting with Genetic Data\n\n\n\n\n\n\n\n5. Connect Points In Chronological Order\n\nDo not Connect Points in Chronological Order (For Comparison)\nFigureÂ 5 uses geom_line() for drawing. By default, geom_line() draws along the x-axis direction (it draws along the y-axis when orientation=\"y\").\n\np &lt;- ggplot(data_economics, aes(x = psavert, y = uempmed)) +\n  geom_point(shape = 17, size = 1.5, color = \"blue\") +\n  geom_text(\n    label = data_economics$date, nudge_x = 0,\n    nudge_y = -0.1, size = 3\n  ) +\n  geom_line(linewidth = 1)\n\np\n\n\n\n\n\n\n\nFigureÂ 5: Comparison Diagram\n\n\n\n\n\n\n\nConnect Points in Chronological Order\nIn FigureÂ 6, geom_segment() is used to connect points in chronological order, which results in a significant difference compared to the plot drawn with geom_line().\n\n# Sort by date\ndata_economics &lt;- data_economics[order(data_economics$date), ]\n\n# Use `geom_segment()` to draw line segments\np &lt;- ggplot(data_economics, aes(x = psavert, y = uempmed)) +\n  geom_point(shape = 17, size = 1.5, color = \"blue\") +\n  geom_text(\n    label = data_economics$date, nudge_x = 0,\n    nudge_y = -0.1, size = 5\n  ) +\n  geom_segment(\n    aes(\n      xend = c(tail(psavert, n = 24), NA),\n      yend = c(tail(uempmed, n = 24), NA)\n    ),\n    linewidth = 1\n  )\n\np\n\n\n\n\n\n\n\nFigureÂ 6: Connect Points in Chronological Order\n\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nKey Parameters: geom_segment\nxend,yendï¼š\nCorresponding to x and y, that is, drawing a line segment from (x, y) to (xend, yend). In the code, c(tail(psavert, n=24), NA) takes the last 24 values of the psavert column and appends an NA. This makes each point point to the next one to draw a line segment, with the final point pointing to NA, thus not drawing a line segment.\n\n\n\n\nDraw Arrows\nArrows are added to each line segment in FigureÂ 7, making the chronological features in the connected scatter plot more apparent.\n\n# Sort by date\ndata_economics &lt;- data_economics[order(data_economics$date), ]\n\n# Use `geom_segment()` to draw line segments\np &lt;- ggplot(data_economics, aes(x = psavert, y = uempmed)) +\n  geom_point(shape = 17, size = 1.5, color = \"blue\") +\n  geom_text(\n    label = data_economics$date, nudge_x = 0,\n    nudge_y = -0.1, size = 5\n  ) +\n  geom_segment(\n    aes(\n      xend = c(tail(psavert, n = 24), NA),\n      yend = c(tail(uempmed, n = 24), NA)\n    ),\n    linewidth = 1, arrow = arrow(length = unit(0.5, \"cm\"))\n  )\n\np\n\n\n\n\n\n\n\nFigureÂ 7: Draw Arrows",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Connected Scatter"
    ]
  },
  {
    "objectID": "Correlation/ConnectedScatter.html#applications",
    "href": "Correlation/ConnectedScatter.html#applications",
    "title": "Connected Scatter",
    "section": "Applications",
    "text": "Applications\n\n\n\n\n\nThe plot shows the relative error curves corresponding to the model methods based on the unused, original, and improved methods. The average relative error of the component content model based on the improved method is superior to the models based on the unused and original methods.[1]\n\n\n\n\n\nComparison of sparse canonical correlation analysis with iCluster for cancer classification(SCCA-CC). Using a different number of genes preselected based on MAD, we compared the classification performance between SCCA-CC and iCluster. (A) represents the P-value associated with survival, calculated by the log-rank test; (B) represents the Silhouette score indicating clustering consistency; (C) assesses the algorithmâ€™s runtime to evaluate computational complexity.[2]\n\n\n\n\n\n\nDistribution of the number of comorbidities among HCC patients. (B) Average number of comorbidities among HCC patients of different ages and genders. (C) Distribution of the number of comorbidities among male HCC patients in different age groups. (D) Distribution of the number of comorbidities among female HCC patients in different age groups.[3]",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Connected Scatter"
    ]
  },
  {
    "objectID": "Correlation/ConnectedScatter.html#reference",
    "href": "Correlation/ConnectedScatter.html#reference",
    "title": "Connected Scatter",
    "section": "Reference",
    "text": "Reference\n[1] LU R, LIU H, YANG H, et al.Â Multi-Delay Identification of Rare Earth Extraction Process Based on Improved Time-Correlation Analysis[J]. Sensors (Basel), 2023,23(3).\n[2] QI L, WANG W, WU T, et al.Â Multi-Omics Data Fusion for Cancer Molecular Subtyping Using Sparse Canonical Correlation Analysis[J]. Front Genet, 2021,12: 607817.\n[3] MU X M, WANG W, JIANG Y Y, et al.Â Patterns of Comorbidity in Hepatocellular Carcinoma: A Network Perspective[J]. Int J Environ Res Public Health, 2020,17(9).",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Connected Scatter"
    ]
  },
  {
    "objectID": "Correlation/TernaryPlot.html",
    "href": "Correlation/TernaryPlot.html",
    "title": "Ternary chart",
    "section": "",
    "text": "A ternary chart is a type of chart used to display the proportional relationship between three variables. These three variables typically represent a certain component (such as chemical composition, species ratio, nutritional structure, etc.), and their sum is a constant, with the most common being 1 or 100%. A ternary chart uses an equilateral triangle to represent the proportional relationship between these three variables, with each pointâ€™s position reflecting the relative proportion of these three variables. This type of chart is commonly used to observe differences in component distribution among different treatment groups, check whether samples cluster in certain regions (component preferences), compare the effects of experimental treatments on component ratios, and so on.",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "TernaryPlot"
    ]
  },
  {
    "objectID": "Correlation/TernaryPlot.html#example",
    "href": "Correlation/TernaryPlot.html#example",
    "title": "Ternary chart",
    "section": "Example",
    "text": "Example\n\n\n\n\n\nThis chart shows the composition of maize bacterial communities along the soil plant continuum.",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "TernaryPlot"
    ]
  },
  {
    "objectID": "Correlation/TernaryPlot.html#setup",
    "href": "Correlation/TernaryPlot.html#setup",
    "title": "Ternary chart",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: ggtern,ggthemes\n\n\n# Installing packages\nif (!requireNamespace(\"ggtern\", quietly = TRUE)) {\n  install.packages(\"ggtern\", type = \"source\")\n}\nif (!requireNamespace(\"ggthemes\", quietly = TRUE)) {\n  install.packages(\"ggthemes\")\n}\n\n# Load packages\nlibrary(ggtern)\nlibrary(ggthemes)",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "TernaryPlot"
    ]
  },
  {
    "objectID": "Correlation/TernaryPlot.html#data-preparation",
    "href": "Correlation/TernaryPlot.html#data-preparation",
    "title": "Ternary chart",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe data comes from the paper[1]ï¼ŒThe following is the link to the data code: https://github.com/PlantNutrition/Liyuã€‚\n\n# Load data\ndata &lt;- read.table(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/Tern_data.txt\", header=T, row.names=1, sep=\"\\t\", comment.char = \"\")\n# View data\nhead(data[,1:5])\n\n                CK      NPK     NPKM       size  Kingdom\nOTU_1     4.58e-04 4.58e-04 0.000534 0.04832414 Bacteria\nOTU_10    2.99e-04 2.33e-04 0.000229 0.02537028 Bacteria\nOTU_10588 7.93e-05 2.47e-04 0.000171 0.01656730 Bacteria\nOTU_10916 1.08e-05 9.01e-06 0.000450 0.01567026 Bacteria\nOTU_11360 3.18e-03 3.17e-03 0.002610 0.29890666 Bacteria\nOTU_11839 2.22e-04 4.11e-04 0.000253 0.02951640 Bacteria",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "TernaryPlot"
    ]
  },
  {
    "objectID": "Correlation/TernaryPlot.html#visualization",
    "href": "Correlation/TernaryPlot.html#visualization",
    "title": "Ternary chart",
    "section": "Visualization",
    "text": "Visualization\n\n1. Basic Ternary Chart\n\n# Basic Ternary Chart\np1_1 &lt;- ggtern(data=data, aes(x=CK, y=NPK, z=NPKM)) +\n  geom_mask() +\n  geom_point(aes(size=size,color=Genus),alpha=0.8)\np1_1\n\n\n\n\n\n\n\nFigureÂ 1: Basic Ternary Chart\n\n\n\nBasic Ternary Chart illustrates Ternary Chart of OTU in xylem sap under three fertilization treatments. The size of each point represents the relative abundance of OTUs.\n\n\n2. Theme Change\n\n# Theme Change\np2_1 &lt;- ggtern(data=data, aes(x=CK, y=NPK, z=NPKM)) +\n  geom_mask() +\n  geom_point(aes(size=size,color=Genus),alpha=0.8) +\n  theme_tropical()\np2_1\n\n\n\n\n\n\n\nFigureÂ 2: Theme Change\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nFour different themes in R language\ntheme_minimal:\n\nA simple white background, retaining the coordinate axes and light gray grid lines. No unnecessary decorations, such as background color and borders, focus on the data itself. By default, the legend background is removed and the legend title and label are directly displayed on the chart.\n\ntheme_bw:\n\nBlack and white high contrast theme, white background with dark gray grid lines/borders. The grid lines are more prominent, suitable for black and white printing or emphasizing structured layouts. Clearer than the default theme theme_grey, with no gradient gray background.\n\ntheme_void:\n\nCompletely blank background, remove all non data elements such as coordinate axes, gridlines, labels, titles, etc. Keep only geometric objects such as points, lines, and bars, suitable for highly customizable designs.\n\ntheme_tropical:\n\nNon ggplot2 built-in themes need to be implemented through extension packages such as ggthemes. Vibrant colors, common bright backgrounds and contrasting elements such as pink, blue, and green. The style is lively and suitable for informal settings.\n\n\n\n\np2_2 &lt;- ggtern(data=data, aes(x=CK, y=NPK, z=NPKM)) +\n  geom_mask() +\n  geom_point(aes(size=size,color=Genus),alpha=0.8) +\n  theme_bw()\np2_2\n\n\n\n\n\n\n\nFigureÂ 3: Theme Change\n\n\n\n\n\n3. Beautify plots\n\np3_1 &lt;- ggtern(data=data, aes(x=CK, y=NPK, z=NPKM)) +\n  geom_mask() +\n  geom_point(aes(size=size,color=Genus),alpha=0.8)+\n  scale_size(range=c(0,10))+\n  scale_color_manual(values=c('#E31A1C','#228B22','#1F78B4','#FDB462','#8B658B','#4876FF','#00BFFF','#EE82EE','#8B8682','#CDC9C9'),limits=c('Klebsiella','Pseudomonas','Enterobacteriaceae_unclassified','Rosenbergiella','Oxalobacteraceae_unclassified','Sphingobacterium','Lactococcus','Erwinia','Others','NotSig'))+\n  guides(size=\"none\")+theme_bw()+\n  theme(axis.text=element_blank(),axis.ticks=element_blank())+\n  theme_showarrows()\np3_1\n\n\n\n\n\n\n\nFigureÂ 4: Beautify plots\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nKey Parameters: Adjusting Parameters\n\ngeom_mask: Display boundary points\nscale_color_manual: Fill color\ntheme_showarrows: Add Arrow",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "TernaryPlot"
    ]
  },
  {
    "objectID": "Correlation/TernaryPlot.html#applications",
    "href": "Correlation/TernaryPlot.html#applications",
    "title": "Ternary chart",
    "section": "Applications",
    "text": "Applications\n\n\n\n\n\n\nFigureÂ 5: Display transcriptomics of cell subpopulations\n\n\n\nThe three corners represent three subpopulations of epithelial cells, corresponding to basal cells, luminal progenitor cells (LP), and mature luminal cells (ML), respectively. From the figure, it can be seen that the cell type composition and differentiation at different stages, as well as the subpopulation status corresponding to clusters.",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "TernaryPlot"
    ]
  },
  {
    "objectID": "Correlation/TernaryPlot.html#reference",
    "href": "Correlation/TernaryPlot.html#reference",
    "title": "Ternary chart",
    "section": "Reference",
    "text": "Reference\n[1] Zhang L, Zhang M, Huang S, Li L, Gao Q, Wang Y, Zhang S, Huang S, Yuan L, Wen Y, Liu K, Yu X, Li D, Zhang L, Xu X, Wei H, He P, Zhou W, Philippot L, Ai C. A highly conserved core bacterial microbiota with nitrogen-fixation capacity inhabits the xylem sap in maize plants. Nat Commun. 2022 Jun 11;13(1):3361. doi: 10.1038/s41467-022-31113-w. PMID: 35688828; PMCID: PMC9187771.\n[2] Pal B, Chen Y, Milevskiy MJG, Vaillant F, Prokopuk L, Dawson CA, Capaldo BD, Song X, Jackling F, Timpson P, Lindeman GJ, Smyth GK, Visvader JE. Single cell transcriptome atlas of mouse mammary epithelial cells across development. Breast Cancer Res. 2021 Jun 29;23(1):69. doi: 10.1186/s13058-021-01445-4. PMID: 34187545; PMCID: PMC8243869.\n[3] Hamilton, N. E., & Ferry, M. (2018). ggtern: Ternary Diagrams Using ggplot2 [R package]. https://CRAN.R-project.org/package=ggtern\n[4] Arnold, J. (2024). ggthemes: Extra Themes, Scales and Geoms for â€˜ggplot2â€™ [R package]. https://CRAN.R-project.org/package=ggthemes",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "TernaryPlot"
    ]
  },
  {
    "objectID": "Ranking/UpsetPlot.html",
    "href": "Ranking/UpsetPlot.html",
    "title": "Upset Plot",
    "section": "",
    "text": "The Upset diagram is similar to the Venn diagram, mainly showing the number of elements in the intersection of different sets. However, when the number of sets in the Venn diagram reaches 5, the readability begins to drop sharply. The Upset diagram can well solve the problem of poor readability of the Venn diagram and can also provide additional statistical information on element properties.",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "UpsetPlot"
    ]
  },
  {
    "objectID": "Ranking/UpsetPlot.html#example",
    "href": "Ranking/UpsetPlot.html#example",
    "title": "Upset Plot",
    "section": "Example",
    "text": "Example\n\n\n\n\n\nThis is the basic style of the Upset graph. The image is divided into three parts. The top part is the histogram of the number of elements in the intersection between different sets, and the left part is the histogram of the number of elements in different sets. The matrix part in the middle is the intersection between the sets, as shown below:\n\n\n\n\n\nWhen an element of an intersection exists in a certain set, it is marked with a black dot, otherwise it is marked with a white dot. For example, if the green part is only marked in black in the B set, it means that the column is an element that only exists in B, and so on.",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "UpsetPlot"
    ]
  },
  {
    "objectID": "Ranking/UpsetPlot.html#setup",
    "href": "Ranking/UpsetPlot.html#setup",
    "title": "Upset Plot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: UpSetR; ggupset\n\n\n# Installing necessary packages\nif (!requireNamespace(\"UpSetR\", quietly = TRUE)) {\n  install.packages(\"UpSetR\")\n}\nif (!requireNamespace(\"ggupset\", quietly = TRUE)) {\n  install.packages(\"ggupset\")\n}\n\n# Load packages\nlibrary(UpSetR)\nlibrary(ggupset)",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "UpsetPlot"
    ]
  },
  {
    "objectID": "Ranking/UpsetPlot.html#data-preparation",
    "href": "Ranking/UpsetPlot.html#data-preparation",
    "title": "Upset Plot",
    "section": "Data Preparation",
    "text": "Data Preparation\n\nThe movies dataset was created by the GroupLens lab and Bilal Alsallakh; the mutations dataset was originally created by the TCGA consortium and represents the mutational landscape of 100 common gene mutations in 284 glioblastoma multiforme tumors.\nBoth datasets are included in the UpSetR package\n\n\n# UpSetR can accept three formats of data. The first is a list with named vectors (see listInput variable), the second is an expression vector (see expressionInput variable), and the third is a data frame consisting of 0,1 (see movies and mutations variables)\n# Reading CSV data\n# The list format requires each vector in the list to be a set. UpSetR requires each set to be named, and the elements in the vector are members of the corresponding set. When using the upset function to draw, you need to use the fromList function to convert the list data format.\nlistInput &lt;- list(one = c(1, 2, 3, 5, 7, 8, 11, 12, 13), two = c(1, 2, 4, 5, 10), three = c(1, 5, 6, 7, 8, 9, 10, 12, 13))\n# The expression format accepts a vector of expressions. The elements of the expression vector are the names of the sets in the intersection (separated by &), and the numeric elements in the intersection. When using the upset function to draw, you need to use the fromExpression function to convert the list data format.\nexpressionInput &lt;- c(one = 2, two = 1, three = 2, `one&two` = 1, `one&three` = 4, `two&three` = 1, `one&two&three` = 2)\n\n# In the data frame format, each column is a set and each row is an element. The data frame is required to consist of 0 and 1, which respectively indicate whether the element exists in the set. When a column has a value other than 0 or 1, the column is considered to be an attribute of the element.\nmovies &lt;- read.csv( system.file(\"extdata\", \"movies.csv\", package = \"UpSetR\"), header=T, sep=\";\" )\nmutations &lt;- read.csv( system.file(\"extdata\", \"mutations.csv\", package = \"UpSetR\"), header=T, sep = \",\")",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "UpsetPlot"
    ]
  },
  {
    "objectID": "Ranking/UpsetPlot.html#visualization",
    "href": "Ranking/UpsetPlot.html#visualization",
    "title": "Upset Plot",
    "section": "Visualization",
    "text": "Visualization\n\n1. Basic Upset Plot\nThis basic Upset graph shows the number of movies that contain different elements.\n\n# Use the above three data types to draw the Upset graph\nupset(fromList(listInput))\nupset(fromExpression(expressionInput))\nupset(movies)\n\n\n\n\n\n\n\nFigureÂ 1: Basic Upset Plot\n\n\n\n\n\n\n\n\n\n\n\nFigureÂ 2: Basic Upset Plot\n\n\n\n\n\n\n\n\n\n\n\nFigureÂ 3: Basic Upset Plot\n\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nKey Parameters: nsets\nThe nsets parameter determines how many sets are used to draw the UpSet graph, and defaults to 5 when not set.\n\n\n\n# Set nset to 6 and use the mutations dataset\nupset(mutations, nsets = 6)\n\n\n\n\n\n\n\nFigureÂ 4: Key Parameters: nsets\n\n\n\n\n\nThis graph uses the six most mutated genes to show the number of glioblastoma multiforme tumors that contain different mutations.\n\n\n\n\n\n\nTip\n\n\n\nKey Parameters: order.by\nThe order.by parameter determines the order in which the intersections in the UpSet graph are sorted. If not set, the order is based on the number of sets intersected. If set to â€œdegreeâ€, the order is based on the number of elements in the intersection. If set to â€œfreqâ€, the order is based on the size of the intersection.\n\n\n\n# Three different order.by settings, using the mutations dataset\nupset(mutations)\nupset(mutations, order.by = \"degree\")\nupset(mutations, order.by = \"freq\")\n\n\n\n\n\n\n\nFigureÂ 5: Key Parameters: order.by\n\n\n\n\n\n\n\n\n\n\n\nFigureÂ 6: Key Parameters: order.by\n\n\n\n\n\n\n\n\n\n\n\nFigureÂ 7: Key Parameters: order.by\n\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nKey Parameters: sets\nThe sets parameter can be used to specify the sets to be plotted. If not set, the nsets sets with the most elements are taken. In addition, the keep.order parameter can keep the order of the set histogram consistent with the order of the sets input.\n\n\n\n# Specify \"TTN\", \"NF1\", \"FLG\", \"KEL\" as the target set, and keep the order of the set bar graph consistent with the sets parameter\nupset(mutations, sets = c(\"TTN\",\"NF1\",\"FLG\",\"KEL\"), keep.order = T)\n\n\n\n\n\n\n\nFigureÂ 8: Key Parameters: sets\n\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nKey Parameters: empty.intersections\nThe empty.intersections parameter is set to â€œNULLâ€ by default, in which case empty intersections are not displayed. When set to any parameter, empty intersections are displayed.\n\n\n\n# Show Empty Intersections\nupset(mutations, sets = c(\"TTN\",\"NF1\",\"FLG\",\"KEL\"), keep.order = T, empty.intersections=T)\n\n\n\n\n\n\n\nFigureÂ 9: Key Parameters: empty.intersections\n\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nKey Parameters: decreasing\nThe decreasing parameter setting can reverse the direction of order.by or keep.order. When there are multiple sorting directions to control, enter a vector with multiple elements, such as â€œc(T,F)â€\n\n\n\n# Reverse sort direction\nupset(mutations, sets = c(\"TTN\",\"NF1\",\"FLG\",\"KEL\"), keep.order = T, decreasing = c(T, T))\n\n\n\n\n\n\n\nFigureÂ 10: Key Parameters: decreasing\n\n\n\n\n\n\n\n2. Personalized Upset Plot\nIn terms of image ratio, the default value of the mb.ratio parameter is â€œc(0.7, 0.3)â€, which can specify the ratio between the intersection bar graph and the intersection matrix dot graph. You need to input a vector containing two elements, which represent the ratio of the height of the bar graph and the height of the matrix dot graph to the height of the whole image.\n\nupset(mutations, mb.ratio=c(0.5,0.5))\n\n\n\n\n\n\n\nFigureÂ 11: Key Parameters: mb.ratio\n\n\n\n\n\nIn terms of image color, the UpSetR package provides multiple parameters to set the color of different parts of the Upset image:\n\nupset(mutations,\n      shade.color = \"#4C4C4C\", # Color of the intersection matrix point shadow\n      matrix.color = \"#067522\", # Colors of points and lines in the matrix\n      main.bar.color = \"#3E7B92\", # Color of the histogram of the number of intersection elements\n      sets.bar.color = \"#C9AE42\" # Color of the collection quantity bar chart\n)\n\n\n\n\n\n\n\nFigureÂ 12: Upset plot color setting\n\n\n\n\n\nIf you want to highlight certain intersections, you need to use the queries parameter provided by the UpSetR package. The queries parameter requires an input list list, which contains at least one sub-list. Each sub-list needs to contain the following fields: query, params, color, active, and query.name.\n\nquery can be entered as intersects or elements, the effect is the same\nparams specifies a subset, the input is also a list, the elements in the list can be the names of the sets, and multiple elements represent the intersection of these elements.\ncolor is the color that will be represented on the plot. If no color is provided, a color will be selected from the UpSetR default palette.\nactive determines how the query will be represented on the plot. If active is TRUE, the cross-size bars will be overlaid by the bars representing the query. If active is FALSE, a jitter point will be placed on the intersecting size bars.\nquery.name is the name of the current highlighted set, and the query.legend parameter needs to be used to specify the legend position. query.legend can be entered as â€œtopâ€ or â€œbottomâ€\n\n\nupset(mutations, sets = c(\"TTN\",\"NF1\",\"FLG\",\"KEL\"), keep.order = T,\n      query.legend = \"top\", \n      queries = list(list(query = intersects, params = list(\"TTN\"), active = T, query.name = \"NAME\"),\n                     list(query = elements, params = list(\"TTN\",\"NF1\"))))\n\n\n\n\n\n\n\nFigureÂ 13: Key Parameters: queries\n\n\n\n\n\nThere are also multiple parameters that can be adjusted for image labels and fonts:\n\nupset(mutations,\n      number.angles = 30, # The tilt angle of the numbers above the intersection bar graph\n      point.size = 2, # The size of the points in the matrix\n      line.size = 1, # Size of the lines in the matrix\n      sets.x.label = \"NAME1\", # Axis labels for a collection of bar charts\n      mainbar.y.label = \"NAME2\", # Axis labels for intersection bar chart\n      text.scale = c(1.3, 1.3, 1, 1, 1.2,1)) # Text size settings, corresponding to the axis labels of the intersection bar chart, the numbers of the intersection bar chart, the axis labels of the set bar chart, the numbers of the set bar chart, the name of the set, and the numbers above the intersection bar chart\n\n\n\n\n\n\n\nFigureÂ 14: Upset plot labels and fonts\n\n\n\n\n\n\n\n3. Advanced Upset Plot\nSometimes you need to display some properties of the elements in the collection, such as showing the distribution of movies released in 1995 in different intersections. You also need to use the queries parameter. Enter a column name that records the release years of different movies and 1995 in the params field to highlight the distribution of movies released in 1995.\n\nupset(movies, sets = c(\"Action\", \"Adventure\", \"Children\", \"War\", \"Noir\"),\n      queries = list(list(query = elements, params = list(\"ReleaseDate\",1995), active = T)))\n\n\n\n\n\n\n\nFigureÂ 15: params field\n\n\n\n\n\nIf it is a compound condition, such as highlighting only action movies released in 1995, you can introduce an additional expression parameter to further restrict the query condition.\n\nupset(movies, sets = c(\"Action\", \"Adventure\", \"Children\", \"War\", \"Noir\"),\n      queries = list(list(query = intersects, params = list(\"Action\"), active = T)),\n      expression = \"ReleaseDate == 1995\")\n\n\n\n\n\n\n\nFigureÂ 16: Key Parameters: expression\n\n\n\n\n\nThe above method is limited to discrete variables, but the attributes of elements may also include continuous variables. For continuous variables, it is recommended to use custom functions for querying. The following code can be used to highlight elements whose Watches attribute is greater than 100:\n\nMyfunc &lt;- function(row, num) {\n  data &lt;- row[\"Watches\"] &gt; num\n}\nupset(movies, sets = c(\"Action\", \"Adventure\", \"Children\", \"War\", \"Noir\"),\n      queries = list(list(query = Myfunc, params = list(100), active = T)))\n\n\n\n\n\n\n\nFigureÂ 17: Upset plot for continuous variables\n\n\n\n\n\nUpsetR also supports drawing other types of images at the same time, including histograms, scatter plots, and density plots. The first two need to be drawn using the attribute.plots parameter, and the boxplot needs to be drawn using the boxplot.summary parameter. The boxplot is not compatible with the other three types of images. attribute.plots contains the following sub-parameters:\n\ngridrows: Specifies the extent of the plot window to make room for attribute plots. UpSetR plots are based on a 100x100 grid layout. For example, if gridrows is set to 50, the new grid layout will become 150x100, with 1/3 of the area used to place attribute plots.\nplots: Receives a list of parameters including plot, x, y (if applicable), and queries.\n\nplot: is a function that returns a ggplot object, which can be input to histogram or scatter_plot.\nx: defines the x-axis aesthetic mapping used in ggplot (input as a string).\ny: defines the y-axis aesthetic mapping used in ggplot (input as a string).\nqueries: controls whether to overlay query results on the property map. If TRUE, the property map will be overlaid with query data; if FALSE, query results will not be shown in the property map.\n\nncols: specifies how the attribute graph is arranged in the space reserved by gridrows. For example:\n\nIf two attribute graphs are input and ncols=1, the two graphs are arranged one above the other.\nIf two attribute graphs are input and ncols=2, the two graphs are displayed side by side.\n\n\n\nupset(movies, sets = c(\"Action\", \"Adventure\", \"Children\", \"War\", \"Noir\"),\n      queries = list(list(query = intersects, params = list(\"War\"), active = T),\n                     list(query = elements, params = list(\"Noir\"))),\n      attribute.plots=list(gridrows = 100, \n                           ncols = 1,\n                           plots = list(list(plot=histogram, \n                                             x=\"AvgRating\",\n                                             queries=T),\n                                        list(plot = scatter_plot, \n                                             y = \"AvgRating\", \n                                             x = \"Watches\",\n                                             queries = T)\n                                        )\n                           )\n      )\n\n\n\n\n\n\n\nFigureÂ 18: Key Parameters: attribute.plots\n\n\n\n\n\nboxplot.summary is relatively simple, just specify the column name to which the element belongs:\n\nupset(movies, sets = c(\"Action\", \"Adventure\", \"Children\", \"War\", \"Noir\"),\n      queries = list(list(query = intersects, params = list(\"War\"), active = T),\n                     list(query = elements, params = list(\"Noir\"))),\n      boxplot.summary = c(\"AvgRating\", \"ReleaseDate\"))\n\n\n\n\n\n\n\nFigureÂ 19: Key Parameters: boxplot.summary\n\n\n\n\n\n\n\n4. Biological Data Example\nThe dataset uses the df_complex_conditions dataset in the ggupset package\n\n# Formatting\ndf &lt;- df_complex_conditions\ndf$\"T8\" &lt;- ifelse(df$Timepoint==8,1,0)\ndf$\"T24\" &lt;- ifelse(df$Timepoint==24,1,0)\ndf$\"T48\" &lt;- ifelse(df$Timepoint==48,1,0)\ndf$KO &lt;- ifelse(df$KO==\"TRUE\",1,0)\ndf$DrugA &lt;- ifelse(df$DrugA==\"Yes\",1,0)\n# It should be noted that the UpSetR package does not support tibble data frames and needs to be converted to traditional data frames.\ndf &lt;- data.frame(df[sample(360,180),c(3,4,1,2,5:7)])  # Here we randomly select half of the data for beauty\n\n# upset plot\nupset(df,\n      queries = list(list(query = intersects, params = list(\"DrugA\",\"T48\"), active = T)),\n      boxplot.summary = c(\"response\"))\n\n\n\n\n\n\n\nFigureÂ 20: Key Parameters: boxplot.summary\n\n\n\n\n\nThis figure shows the response of knockout KO and WT (KO behavior white dots) after or without drug (DrugA) treatment at different times.",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "UpsetPlot"
    ]
  },
  {
    "objectID": "Ranking/UpsetPlot.html#applications",
    "href": "Ranking/UpsetPlot.html#applications",
    "title": "Upset Plot",
    "section": "Applications",
    "text": "Applications\n\n\n\n\n\n\nFigureÂ 21: Applications of Upset plot\n\n\n\nThis graph shows the statistics of different diseases in the population and their survival time. [1]",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "UpsetPlot"
    ]
  },
  {
    "objectID": "Ranking/UpsetPlot.html#reference",
    "href": "Ranking/UpsetPlot.html#reference",
    "title": "Upset Plot",
    "section": "Reference",
    "text": "Reference\n[1] Peng X, Hu Y, Cai W. Association between urinary incontinence and mortality risk among US adults: a prospective cohort study. BMC Public Health. 2024 Oct 9;24(1):2753. doi: 10.1186/s12889-024-20091-x. PMID: 39385206; PMCID: PMC11463129.",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "UpsetPlot"
    ]
  },
  {
    "objectID": "Ranking/BarPlot.html",
    "href": "Ranking/BarPlot.html",
    "title": "Bar Plot",
    "section": "",
    "text": "A bar plot is a graph that uses the height or length of the bars to represent the amount of data.",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Bar Plot"
    ]
  },
  {
    "objectID": "Ranking/BarPlot.html#example",
    "href": "Ranking/BarPlot.html#example",
    "title": "Bar Plot",
    "section": "Example",
    "text": "Example\n\n\n\n\n\nAs shown in the figure above, each group of bars reflects the expression of five genes.",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Bar Plot"
    ]
  },
  {
    "objectID": "Ranking/BarPlot.html#setup",
    "href": "Ranking/BarPlot.html#setup",
    "title": "Bar Plot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming Language: R\nDependencies: magrittr; tidyr; ggplot2; cowplot; forcats; dplyr; hrbrthemes; ggpattern; rstatix; ggpubr\n\n\n# Install packages\nif (!requireNamespace(\"magrittr\", quietly = TRUE)) {\n  install.packages(\"magrittr\")\n}\nif (!requireNamespace(\"tidyr\", quietly = TRUE)) {\n  install.packages(\"tidyr\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"cowplot\", quietly = TRUE)) {\n  install.packages(\"cowplot\")\n}\nif (!requireNamespace(\"forcats\", quietly = TRUE)) {\n  install.packages(\"forcats\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"hrbrthemes\", quietly = TRUE)) {\n  install.packages(\"hrbrthemes\")\n}\nif (!requireNamespace(\"ggpattern\", quietly = TRUE)) {\n  install.packages(\"ggpattern\")\n}\nif (!requireNamespace(\"ggpubr\", quietly = TRUE)) {\n  install.packages(\"ggpubr\")\n}\nif (!requireNamespace(\"rstatix\", quietly = TRUE)) {\n  install.packages(\"rstatix\")\n}\nif (!requireNamespace(\"palmerpenguins\", quietly = TRUE)) {\n  install.packages(\"palmerpenguins\")\n}\n\n# Load packages\nlibrary(magrittr)\nlibrary(tidyr)\nlibrary(ggplot2)\nlibrary(cowplot)\nlibrary(forcats)\nlibrary(dplyr)\nlibrary(hrbrthemes)\nlibrary(ggpattern)\nlibrary(rstatix)\nlibrary(ggpubr)\nlibrary(palmerpenguins)",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Bar Plot"
    ]
  },
  {
    "objectID": "Ranking/BarPlot.html#data-preparation",
    "href": "Ranking/BarPlot.html#data-preparation",
    "title": "Bar Plot",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe data from TCGA and the data sets that come with R are mainly used for drawing.\n\ndata_TCGA &lt;- readr::read_csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/TCGA-BRCA.htseq_counts_processed.csv\")\n\ndata_TCGA1 &lt;- data_TCGA[1:5,] %&gt;%\n  gather(key = \"sample\",value = \"gene_expression\",3:1219)\n\ndata_tcga_mean &lt;- aggregate(data_TCGA1$gene_expression, \n                            by=list(data_TCGA1$gene_name), mean) # mean\ncolnames(data_tcga_mean) &lt;- c(\"gene\",\"expression\")\n\ndata_tcga_sd &lt;- aggregate(data_TCGA1$gene_expression, \n                            by=list(data_TCGA1$gene_name), sd)\ncolnames(data_tcga_sd) &lt;- c(\"gene\",\"sd\")\n\ndata_tcga &lt;- merge(data_tcga_mean, data_tcga_sd, by=\"gene\")\n\ndata_penguins &lt;- penguins\n\ndata_penguins_flipper_length &lt;- aggregate(data_penguins$flipper_length_mm,\n                                by=list(data_penguins$species,data_penguins$sex),\n                                mean)\ncolnames(data_penguins_flipper_length) &lt;- c(\"species\",\"sex\",\"flipper_length_mm\")\n\ndata_mpg &lt;- mpg",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Bar Plot"
    ]
  },
  {
    "objectID": "Ranking/BarPlot.html#visualization",
    "href": "Ranking/BarPlot.html#visualization",
    "title": "Bar Plot",
    "section": "Visualization",
    "text": "Visualization\n\n1. Basic plot\n\n1.1 Basic bar plot\nHere we take the TCGA database data as an example.\n\n# Basic bar plot\np &lt;- ggplot(data_tcga_mean, aes(x=gene, y=expression)) + \n  geom_bar(stat = \"identity\")\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Basic bar plot\n\n\n\n\n\nThe mean expression of the five gene samples is shown.\n\n\n1.2 Horizontal bar plot\nUse coord_flip() to flip the coordinate axes.\n\n# Horizontal bar plot\np &lt;- data_tcga_mean %&gt;%\n  mutate(gene=fct_reorder(gene,expression)) %&gt;% # fct_reorder order\n  ggplot(aes(x=gene, y=expression)) + \n  geom_bar(stat = \"identity\",width=0.5)+ # adjust width\n  coord_flip() # Flip the axes\n\np\n\n\n\n\n\n\n\nFigureÂ 2: Horizontal bar plot\n\n\n\n\n\n\n\n1.3 Color settings\nggplot2 can implement a variety of color settings. Here we provide six examples.\n\n# Color settings\np1 &lt;- ggplot(data_tcga_mean, aes(x=gene, y=expression)) + \n  geom_bar(stat = \"identity\",color=\"blue\", fill=rgb(0.1,0.4,0.5,0.7))+\n  labs(title = \"Unified Color\")+\n  theme(plot.title = element_text(hjust = 0.5)) +\n  geom_text(aes(label=round(expression,2)),  # Add data labels\n            position = position_dodge2(width = 0.9, preserve = 'single'), \n    vjust = -0.2, hjust = 0.5) +\n  scale_y_continuous(limits = c(0, 17),breaks = seq(0,17,5))\n\np2 &lt;- ggplot(data_tcga_mean, aes(x=gene, y=expression, fill=gene)) + \n  geom_bar(stat = \"identity\")+\n  scale_fill_hue(c = 40) +\n  labs(title = \"Gradient Color\")+\n  theme(plot.title = element_text(hjust = 0.5),\n        legend.position=\"none\") +\n  geom_text(aes(label=round(expression,2)),  # Add data labels\n            position = position_dodge2(width = 0.9, preserve = 'single'), \n            vjust = -0.2, hjust = 0.5) +\n  scale_y_continuous(limits = c(0, 17),breaks = seq(0,17,5))\n\np3 &lt;- ggplot(data_tcga_mean, aes(x=gene, y=expression, fill=gene)) + \n  geom_bar(stat = \"identity\")+\n  scale_fill_brewer(palette = \"Set1\")+\n  labs(title = \"RColorBrewer palette 1\")+\n  theme(plot.title = element_text(hjust = 0.5),\n        legend.position=\"none\") +\n  geom_text(aes(label=round(expression,2)),  # Add data labels\n            position = position_dodge2(width = 0.9, preserve = 'single'), \n            vjust = -0.2, hjust = 0.5) +\n  scale_y_continuous(limits = c(0, 17),breaks = seq(0,17,5))\n\np4 &lt;- ggplot(data_tcga_mean, aes(x=gene, y=expression, fill=gene)) + \n  geom_bar(stat = \"identity\")+\n  scale_fill_brewer(palette = \"Set2\") +\n  labs(title = \"RColorBrewer palette 2\")+\n  theme(plot.title = element_text(hjust = 0.5),\n        legend.position=\"none\") +\n  geom_text(aes(label=round(expression,2)),  # Add data labels\n            position = position_dodge2(width = 0.9, preserve = 'single'), \n            vjust = -0.2, hjust = 0.5) +\n  scale_y_continuous(limits = c(0, 17),breaks = seq(0,17,5))\n\np5 &lt;- ggplot(data_tcga_mean, aes(x=gene, y=expression, fill=gene)) + \n  geom_bar(stat = \"identity\")+\n  scale_fill_grey(start = 0.25, end = 0.75) +\n  labs(title = \"Grayscale\")+\n  theme(plot.title = element_text(hjust = 0.5),\n        legend.position=\"none\") +\n  geom_text(aes(label=round(expression,2)),  # Add data labels\n            position = position_dodge2(width = 0.9, preserve = 'single'), \n            vjust = -0.2, hjust = 0.5) +\n  scale_y_continuous(limits = c(0, 17),breaks = seq(0,17,5))\n\n\np6 &lt;- ggplot(data_tcga_mean, aes(x=gene, y=expression, fill=gene)) + \n  geom_bar(stat = \"identity\")+\n  scale_fill_manual(values = c(\"red\", \"green\", \"blue\",\"pink\",\"yellow\") ) +\n  labs(title = \"Manual settings\")+\n  theme(plot.title = element_text(hjust = 0.5),\n        legend.position=\"none\") +\n  geom_text(aes(label=round(expression,2)),  # Add data labels\n            position = position_dodge2(width = 0.9, preserve = 'single'), \n            vjust = -0.2, hjust = 0.5) +\n  scale_y_continuous(limits = c(0, 17),breaks = seq(0,17,5))\n\nplot_grid(p1, p2, p3, p4, p5, p6, labels = LETTERS[1:6], ncol = 3)\n\n\n\n\n\n\n\nFigureÂ 3: Color settings\n\n\n\n\n\n\n\n1.4 Grayscale bar plot vs.Â textured bar plot\nBesides handling color settings, ggplot2 can also draw grayscale bar charts and textured bar charts.\n\n# Grayscale bar plot\np &lt;- \n  ggplot(data_tcga_mean, aes(x=gene, y=expression, fill=gene)) +\n  geom_bar(stat=\"identity\", alpha=.6, width=.4) +\n  scale_fill_grey(start=0, end=0.8) +  # Set the grayscale range\n  theme_bw()\np\n\n\n\n\n\n\n\nFigureÂ 4: Grayscale bar plot\n\n\n\n\n\n\n# textured bar plot\np &lt;- ggplot(data_tcga_mean, aes(x=gene, y=expression)) +\n  geom_col_pattern(\n    aes(pattern=gene,\n        pattern_angle=gene,\n        pattern_spacing=gene\n    ), \n    fill            = 'white',\n    colour          = 'black', \n    pattern_density = 0.5, \n    pattern_fill    = 'black',\n    pattern_colour  = 'darkgrey'\n  ) +\n  theme_bw()\np\n\n\n\n\n\n\n\nFigureÂ 5: textured bar plot\n\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nKey parameters: \n\nfillï¼šThe base fill color behind the pattern\ncolourï¼šThe border color of the bar\npattern_densityï¼šDensity of pattern within the bar\npattern_fillï¼šPattern color\npattern_colourï¼šSecondary color of the pattern\n\n\n\n\n\n\n2. Variable Width Bar plot\nThe variable width bar chart visualizes the number of samples, using the width of the bar to represent the number of samples.\n\n# Variable Width Bar plot----\ndata &lt;- data.frame(\n  group=c(\"A \",\"B \",\"C \",\"D \") , \n  value=c(33,62,56,67) , \n  number_of_obs=c(100,500,459,342)\n)\n\n# Set the left and right width limits\ndata$right &lt;- cumsum(data$number_of_obs) + 30*c(0:(nrow(data)-1))\ndata$left &lt;- data$right - data$number_of_obs \n\n# plot\np &lt;- \n  ggplot(data, aes(ymin = 0)) + \n  geom_rect(aes(xmin = left, xmax = right, # Set upper and lower width limits\n                ymax = value, \n                colour = group, fill = group),alpha=0.8) +\n  xlab(\"number of obs\") + \n  ylab(\"value\") +\n  theme_ipsum() +\n  scale_fill_brewer(palette = \"Set1\") +\n  theme(legend.position=\"none\") \np\n\n\n\n\n\n\n\nFigureÂ 6: Variable Width Bar plot\n\n\n\n\n\nThe above graph shows the sample size using bar width.\n\n\n3. Error bar plot\nBar charts allow for error bars to be added, which we can do with geom_errorbar.\n\n3.1 Basic error bar plot\n\n# Basic error bar plot\np &lt;- \n  ggplot(data_tcga) +\n  geom_bar( aes(x=gene, y=expression), stat=\"identity\", fill=\"skyblue\", alpha=0.7) +\n  geom_errorbar(aes(x=gene, \n                    ymin=expression-sd, ymax=expression+sd), \n                width=0.4, colour=\"orange\", alpha=0.9, size=1) +\n  labs(title = \"Basic error bar plot\") +\n  theme(plot.title = element_text(hjust = 0.5))\np\n\n\n\n\n\n\n\nFigureÂ 7: Basic error bar plot\n\n\n\n\n\nThe above figure shows the expression level of each gene and adds standard deviation error bars.\n\n\n3.2 Various types of error bar plot\nAt the same time, ggplot2 provides a variety of error bar types, here we provide four examples.\n\n# Error bar chart (taking standard deviation as an example) ----\n## Various types of error bar plot\np1 &lt;- ggplot(data_tcga) +\n  geom_bar( aes(x=gene, y=expression), stat=\"identity\", fill=\"skyblue\", alpha=0.7) +\n  geom_crossbar( aes(x=gene, y=expression, \n                     ymin=expression-sd, ymax=expression+sd), \n                 width=0.4, colour=\"orange\", alpha=0.9, size=1.3) +\n  labs(title = \"Box error bar plot\")+\n  theme(plot.title = element_text(hjust = 0.5))\n\np2 &lt;- ggplot(data_tcga) +\n  geom_bar( aes(x=gene, y=expression), stat=\"identity\", fill=\"skyblue\", alpha=0.7) +\n  geom_linerange( aes(x=gene, \n                      ymin=expression-sd, ymax=expression+sd), \n                  colour=\"orange\", alpha=0.9, size=1.3) +\n  labs(title = \"Linear error bar plot\")+\n  theme(plot.title = element_text(hjust = 0.5))\n\n\np3 &lt;- ggplot(data_tcga) +\n  geom_bar( aes(x=gene, y=expression), stat=\"identity\", fill=\"skyblue\", alpha=0.7) +\n  geom_pointrange( aes(x=gene, y=expression, \n                       ymin=expression-sd, ymax=expression+sd), \n                   colour=\"orange\", alpha=0.9, size=1) +\n  labs(title = \"Line + point error bar chart\")+\n  theme(plot.title = element_text(hjust = 0.5))\n\n\np4 &lt;- ggplot(data_tcga) +\n  geom_bar( aes(x=gene, y=expression), stat=\"identity\", fill=\"skyblue\", alpha=0.7) +\n  geom_errorbar( aes(x=gene, ymin=expression-sd, ymax=expression+sd), \n                 width=0.4, colour=\"orange\", alpha=0.9, size=1.3) +\n  coord_flip() +\n  labs(title = \"Horizontal error bar plot\")+\n  theme(plot.title = element_text(hjust = 0.5))\n\nplot_grid(p1, p2, p3, p4, labels = LETTERS[1:4], ncol = 2)\n\n\n\n\n\n\n\nFigureÂ 8: Various types of error bar plot\n\n\n\n\n\n\n\n3.3 Add differential analysis\n\n# Add differential analysis\ndata_tcga_p &lt;- filter(data_TCGA1,\n                      gene_name == \"A1BG\" | gene_name == \"A1CF\" | gene_name == \"A2M\")\n\ndata_tcga_plot &lt;- filter(data_tcga,\n                         gene == \"A1BG\" | gene == \"A1CF\" | gene == \"A2M\")\n\n# Calculation of p-value between groups\ndf_p_val &lt;- data_tcga_p %&gt;% \n  wilcox_test(formula = gene_expression~gene_name) %&gt;% \n  add_significance(p.col = 'p',cutpoints = c(0,0.001,0.01,0.05,1),symbols = c('***','**','*','ns')) %&gt;% \n  add_xy_position()\n\np &lt;- \n  ggplot(data_tcga_plot) +\n  geom_bar( aes(x=gene, y=expression), stat=\"identity\", fill=\"skyblue\", alpha=0.7) +\n  geom_errorbar( aes(x=gene, \n                     ymin=expression-sd, ymax=expression+sd), \n                 width=0.4, colour=\"orange\", alpha=0.9, size=1) +\n  stat_pvalue_manual(df_p_val,label = '{p.signif}', # Adding differential analysis lines\n                     tip.length = 0.01,\n                     y.position = c(15,17,19)) +\n  labs(title = \"Add differential analysis\") +\n  theme(plot.title = element_text(hjust = 0.5))\np\n\n\n\n\n\n\n\nFigureÂ 9: Add differential analysis\n\n\n\n\n\nThe above figure adds differential analysis lines of three gene expression data.\n\n\n\n4. Stacked bar plot\nWhen including within-group grouping, we can choose to plot a stacked bar chart.\nTake the penguins dataset as an example.\n\n# Stacked bar plot----\np &lt;- \n  ggplot(data_penguins_flipper_length,aes(x=species,y=flipper_length_mm,fill=sex))+\n  geom_bar(stat=\"identity\",  \n           position = position_stack(reverse = TRUE))+ # Change stacking order\n  guides(fill=guide_legend(reverse = TRUE)) + # Change legend order\n  scale_fill_manual(values = c(\"#87CEFA\",\"#8DB6CD\"))\np\n\n\n\n\n\n\n\nFigureÂ 10: Stacked bar plot\n\n\n\n\n\nA stacked bar chart showing the wing length of penguins of different sexes.\n\n\n5. Percentage bar plot\nSimilarly, when performing ratio analysis, you can also choose to draw a percentage bar chart.\n\n# Percentage bar plot----\np &lt;- \n  ggplot(data_mpg,aes(class))+\n  geom_bar(aes(fill = drv), \n           position = 'fill') + # Draw percentage\n  scale_fill_manual(values = c(\"#87CEFA\",\"#8DB6CD\",\"#84B6BD\"))\np\n\n\n\n\n\n\n\nFigureÂ 11: Percentage bar plot\n\n\n\n\n\nThe above chart shows the percentage of drive type (four-wheel drive, front-wheel drive, rear-wheel drive) in each model.\n\n\n6. Side-by-side bar plot\nWhen including grouping within groups, we can also draw side-by-side bar plot by setting the position parameter.\n\n# Side-by-side bar plot----\np &lt;- \n  ggplot(data_mpg,aes(class)) +\n  geom_bar(aes(fill = drv), \n           position = position_dodge2(preserve = 'single')) +\n  scale_fill_manual(values = c(\"#87CEFA\",\"#8DB6CD\",\"#84B6BD\"))\np\n\n\n\n\n\n\n\nFigureÂ 12: Side-by-side bar plot\n\n\n\n\n\n\n\n7. Deformation of bar plot\n\n7.1 Pyramid plot\n\ndf &lt;- tibble(\n  gene = factor(paste0(\"gene_\", rep(1:16, 2)), levels = paste0(\"gene_\", 16:1)),\n  stat = c(seq(-10, -100, -10), seq(-90, -40, 10), seq(10, 100, 10), seq(90, 40, -10)),\n  direct = rep(c(\"down\", \"up\"), each=16)\n)\n\np &lt;- \n  ggplot(df, aes(gene, stat, fill = direct)) + \n  geom_col() +\n  coord_flip() + \n  scale_y_continuous(breaks = seq(-100, 100, 20),\n                     labels = c(seq(100, 0, -20), seq(20, 100, 20)))\np\n\n\n\n\n\n\n\nFigureÂ 13: Pyramid plot\n\n\n\n\n\n\n\n7.2 Deviation Plot\n\n# Deviation Plot\ndf &lt;- tibble(\n  gene = factor(paste0(\"gene_\", 1:20), levels = paste0(\"gene_\", 20:1)),\n  stat = c(seq(100, 10, -10), seq(-10, -100, -10)),\n  direct = factor(rep(c(\"up\", \"down\"), each=10), levels = c(\"up\", \"down\"))\n)\n\np &lt;- \n  ggplot(df, aes(gene, stat, fill = direct)) + \n  geom_col() +\n  coord_flip()\np\n\n\n\n\n\n\n\nFigureÂ 14: Deviation Plot",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Bar Plot"
    ]
  },
  {
    "objectID": "Ranking/BarPlot.html#applications",
    "href": "Ranking/BarPlot.html#applications",
    "title": "Bar Plot",
    "section": "Applications",
    "text": "Applications\n\n1. Basic bar plot\n\n\n\n\n\n\nFigureÂ 15: Applications of basic bar plot\n\n\n\nThe data are from the TCGA database. The top bar chart shows the number of available data types for each of the 36 cancer types as of January 2015; the bottom bar chart shows the number of cancer types for which each data type was available. [1]\n\n\n2. Error bar plot\n\n\n\n\n\n\nFigureÂ 16: Applications of error bar plot\n\n\n\n\nis a bar graph showing the collagen volume fractions of the PBS, MSC, GENE, and MSC + GENE groups stained with large areas; (B) is a bar graph showing the collagen volume fractions of the PBS, MSC, GENE, and MSC + GENE groups stained with Sirius red. [2]\n\n\n\n3. Side-by-side bar plot\n\n\n\n\n\n\nFigureÂ 17: Applications of side-by-side bar plot\n\n\n\nFigure B shows the average LV myocardial signal-to-noise ratio (SNR) of all mice in different segments of the six-segment model (A) acquired using a CryoProbe (CP) or room temperature coil (RT); Figure D shows the average LV myocardial SNR of all mice in different slices. [3]",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Bar Plot"
    ]
  },
  {
    "objectID": "Ranking/BarPlot.html#reference",
    "href": "Ranking/BarPlot.html#reference",
    "title": "Bar Plot",
    "section": "Reference",
    "text": "Reference\n[1] Kannan L, Ramos M, Re A, El-Hachem N, Safikhani Z, Gendoo DM, Davis S, Gomez-Cabrero D, Castelo R, Hansen KD, Carey VJ, Morgan M, Culhane AC, Haibe-Kains B, Waldron L. Public data and open source tools for multi-assay genomic investigation of disease. Brief Bioinform. 2016 Jul;17(4):603-15. doi: 10.1093/bib/bbv080. Epub 2015 Oct 12. PMID: 26463000; PMCID: PMC4945830.\n[2] Yu Q, Fang W, Zhu N, Zheng X, Na R, Liu B, Meng L, Li Z, Li Q, Li X. Beneficial effects of intramyocardial mesenchymal stem cells and VEGF165 plasmid injection in rats with furazolidone induced dilated cardiomyopathy. J Cell Mol Med. 2015 Aug;19(8):1868-76. doi: 10.1111/jcmm.12558. Epub 2015 Mar 5. PMID: 25753859; PMCID: PMC4549037.\n[3] Wagenhaus B, Pohlmann A, Dieringer MA, Els A, Waiczies H, Waiczies S, Schulz-Menger J, Niendorf T. Functional and morphological cardiac magnetic resonance imaging of mice using a cryogenic quadrature radiofrequency coil. PLoS One. 2012;7(8):e42383. doi: 10.1371/journal.pone.0042383. Epub 2012 Aug 1. PMID: 22870323; PMCID: PMC3411643.\n[4] Bache S, Wickham H (2022). magrittr: A Forward-Pipe Operator for R. R package version 2.0.3, https://CRAN.R-project.org/package=magrittr.\n[5] Wickham H, Vaughan D, Girlich M (2024). tidyr: Tidy Messy Data. R package version 1.3.1, https://CRAN.R-project.org/package=tidyr.\n[6] H. Wickham. ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York, 2016.\n[7] Wilke C (2024). cowplot: Streamlined Plot Theme and Plot Annotations for â€˜ggplot2â€™. R package version 1.1.3, https://CRAN.R-project.org/package=cowplot.\n[8] Wickham H (2023). forcats: Tools for Working with Categorical Variables (Factors). R package version 1.0.0, https://CRAN.R-project.org/package=forcats.\n[9] Wickham H, FranÃ§ois R, Henry L, MÃ¼ller K, Vaughan D (2023). dplyr: A Grammar of Data Manipulation. R package version 1.1.4, https://CRAN.R-project.org/package=dplyr.\n[10] Rudis B (2024). hrbrthemes: Additional Themes, Theme Components and Utilities for â€˜ggplot2â€™. R package version 0.8.7, https://CRAN.R-project.org/package=hrbrthemes.\n[11] FC M, Davis T, ggplot2 authors (2024). ggpattern: â€˜ggplot2â€™ Pattern Geoms. R package version 1.1.1, https://CRAN.R-project.org/package=ggpattern.\n[12] Kassambara A (2023). rstatix: Pipe-Friendly Framework for Basic Statistical Tests. R package version 0.7.2, https://CRAN.R-project.org/package=rstatix.",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Bar Plot"
    ]
  },
  {
    "objectID": "Ranking/VennPlot.html",
    "href": "Ranking/VennPlot.html",
    "title": "Veen Plot",
    "section": "",
    "text": "For the visualization of Venn diagrams, the commonly used R packages are ggVennDiagram and VennDiagram. Compared with the VennDiagram package, ggVennDiagram has the advantages of being applicable to more groups, adapting to ggplot2 syntax, and flexibly setting output formats, and is easier to learn and post-process. However, the set color of ggVennDiagram can only be set to a continuous gradient color related to the number of elements, and cannot be set to a discrete color with one color for each set. VennDiagram is just the opposite, so you can choose which R package to use for drawing according to specific needs.",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "VeenPlot"
    ]
  },
  {
    "objectID": "Ranking/VennPlot.html#example",
    "href": "Ranking/VennPlot.html#example",
    "title": "Veen Plot",
    "section": "Example",
    "text": "Example",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "VeenPlot"
    ]
  },
  {
    "objectID": "Ranking/VennPlot.html#setup",
    "href": "Ranking/VennPlot.html#setup",
    "title": "Veen Plot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: ggplot2; ggVennDiagram; VennDiagram\n\n\n# Installing necessary packages\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"ggVennDiagram\", quietly = TRUE)) {\n  install.packages(\"ggVennDiagram\")\n}\nif (!requireNamespace(\"VennDiagram\", quietly = TRUE)) {\n  install.packages(\"VennDiagram\")\n}\n\n# Load packages\nlibrary(ggplot2)\nlibrary(ggVennDiagram)\nlibrary(VennDiagram)",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "VeenPlot"
    ]
  },
  {
    "objectID": "Ranking/VennPlot.html#data-preparation",
    "href": "Ranking/VennPlot.html#data-preparation",
    "title": "Veen Plot",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe data uses a simulated gene set. Assume that we have multiple groups of different treatments A~D, each of which produces a certain number of differentially expressed genes under different treatments. The input format required by ggVennDiagram is a list. Each element in the list needs to have a corresponding name and the sub-elements it contains.\n\ngenes &lt;- paste(\"gene\",1:1000,sep=\"\")\nset.seed(123)\nx &lt;- list(A=sample(genes,300),\n          B=sample(genes,525),\n          C=sample(genes,440),\n          D=sample(genes,350))",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "VeenPlot"
    ]
  },
  {
    "objectID": "Ranking/VennPlot.html#visualization",
    "href": "Ranking/VennPlot.html#visualization",
    "title": "Veen Plot",
    "section": "Visualization",
    "text": "Visualization\n\n\n\n\n\n\nTip\n\n\n\nggVennDiagram basic parameters:\n\nx: list collection data to be input\ncategory.names: collection name, default is the name defined in list\nshow_intersect: when set to TRUE, output interactive images\nset_color: the stroke color of the collection, you can enter one or the same number of colors as the collection\nset_size: the size of the collection label\nlabel: the type of the numeric label in the collection, you can select an input from â€œbothâ€, â€œcountâ€, â€œpercentâ€, â€œnoneâ€, the default is â€œbothâ€\nlabel_alpha: the background transparency of the numeric label\nlabel_geom: the layer position of the numeric label, you can select one from â€œlabelâ€, â€œtextâ€, the default is â€œlabelâ€, when â€œtextâ€ is entered, the label will be located below the collection color block\nlabel_color: the color of the numeric label\nlabel_size: the size of the numeric label\nlabel_percent_digit: the number of decimal places reserved for the numeric label\nlabel_txtWidth: In interactive mode, the width of the text box showing the intersection element\nedge_lty: The line type of the set stroke, the default is â€œsolidâ€, other line types that can be set are: â€œblankâ€, â€œsolidâ€, â€œdashedâ€, â€œdottedâ€, â€œdotdashâ€, â€œlongdashâ€, â€œtwodashâ€\nedge_size: The line width of the set stroke\nforce_upset: Whether to use the upset graph to show the intersection\nnintersects: The number of sets used for drawing, if NULL, all sets are used\norder.intersect.by: The arrangement of intersections when drawing the upset graph\norder.set.by: The arrangement of sets when drawing the upset graph\nrelative_height: The relative height of the upper bar graph when drawing the upset graph\nrelative_width: The relative width of the left bar graph when drawing the upset graph\n\n\n\n\n1. Basic Venn Diagram\n\n# Basic Venn Diagram\nggVennDiagram(x)\n\n\n\n\n\n\n\nFigureÂ 1: Basic Venn Diagram\n\n\n\n\n\nThis figure shows the intersection of differentially expressed genes under different treatments.\n\n\n2. Beautify the Venn diagram\nThe color of the set in ggVennDiagram is a continuous variable set according to the number of elements contained in the set. The set color can be modified by functions such as scale_fill_gradient or scale_fill_gradient2 in ggplot2. For example, the following code can be used to implement continuous color setting:\n\n# Color settings\nggVennDiagram(x) + scale_fill_gradient(low=\"grey90\",high = \"red\")\n\n\n\n\n\n\n\nFigureÂ 2: Color settings\n\n\n\n\n\nYou can also use scale_fill_gradient2 to define the colors more freely:\n\n# Color settings\nggVennDiagram(x) + scale_fill_gradient2(low=\"grey90\",mid = \"yellow\",midpoint = 100,high = \"red\")\n\n\n\n\n\n\n\nFigureÂ 3: Color settings\n\n\n\n\n\nMore complex color settings can be accomplished by calling the palette:\n\n# Color settings\nggVennDiagram(x) + scale_fill_distiller(palette = \"Set1\") \n\n\n\n\n\n\n\nFigureÂ 4: Color settings\n\n\n\n\n\nItâ€™s also very easy to customize the palette:\n\n# Color settings\ncols &lt;- c('#E64E00','#65B48E','#E6EB00','#E64E00')\npal &lt;- colorRampPalette(cols)\nggVennDiagram(x) + scale_fill_gradientn(colors = pal(10)) # Numbers are the number of color levels\n\n\n\n\n\n\n\nFigureÂ 5: Color settings\n\n\n\n\n\nggVennDiagram can also customize the border of the collection through edge_lty, edge_size, and set_color.\n\n# edge settings\nggVennDiagram(x, set_color=c(\"blue\",\"red\",\"green\",\"purple\"), edge_lty=\"dashed\", edge_size=2)\n\n\n\n\n\n\n\nFigureÂ 6: edge settings\n\n\n\n\n\nThe font settings can be modified via the following parameters:\n\n# Font Settings\n# The most special parameter among the following is label. Among the four optional inputs of label, \"percent\" means only displaying percentage, \"count\" means only displaying quantity, and \"none\" means not displaying.\nggVennDiagram(x, set_size = 5, label = \"percent\", label_alpha = 0, \n              label_color = \"red\", label_size = 5, label_percent_digit = 2)\n\n\n\n\n\n\n\nFigureÂ 7: Font Settings\n\n\n\n\n\n\n\n3. VennDiagram\nWe can also draw Venn diagrams using the VennDiagram package.\n\n\n\n\n\n\nTip\n\n\n\nvenn.diagram basic parameters:\n\nx: list collection data to be input\nfilename: output file name\nimagetype: output file type can be selected from â€œtiffâ€, â€œpngâ€, â€œsvgâ€\nunits: image size unit can be selected from â€œcmâ€, â€œpxâ€, â€œunitâ€\nheight: image height\nwidth: image width\nresolution: image resolution\ncompression: image compression algorithm\nscaled: display collection size according to proportion\nalpha: collection transparency\nfill: collection color\ncol: line color\nlwd: line thickness\nlty: line shape, 1 is solid line, 2 is dotted line, blank is no line\nlabel.col: number color\ncex: number size\ncat.dist: distance between label and collection\ncat.pos: angle of label relative to collection\ncat.cex: Label font size\ncat.col: Label color\n\n\n\nThe core function of the VennDiagram package is venn.diagram. This function cannot draw images directly to the drawing board. You can draw images to the drawing board by cooperating with the grid::grid.draw() function.\n\np &lt;- venn.diagram(x,filename = NULL);grid::grid.draw(p)\n\n\n\n\n\n\n\nFigureÂ 8: venn.diagram\n\n\n\n\n\nThe biggest difference between VennDiagram set color settings and ggVennDiagram is that the colors are set as discrete colors according to different sets. The setting method is as follows:\n\n# When only one color is entered, all sets display the same color. When the number of entered colors matches the number of sets, each set has its own color. You can also use a specific naming method to accurately set the color of the set.\np &lt;- venn.diagram(\n  x, filename = NULL,\n  fill = c(\"A\"=\"#2E75A2\",\"B\"=\"#FBD75F\",\"C\"=\"#379337\",\"D\"=\"#C13A3C\"),\n  alpha= 0.3);grid::grid.draw(p)\n\n\n\n\n\n\n\nFigureÂ 9: Color settings\n\n\n\n\n\nLine settings:\n\np &lt;- venn.diagram(\n  x, filename = NULL,\n  col = c(\"A\"=\"#2E75A2\",\"B\"=\"#FBD75F\",\"C\"=\"#379337\",\"D\"=\"#C13A3C\"),\n  lwd = 0.3, lty = 2);grid::grid.draw(p)\n\n\n\n\n\n\n\nFigureÂ 10: Line settings\n\n\n\n\n\nFont settings. If you need to adjust the position, please use the cat.dist, cat.pos parameters:\n\np &lt;- venn.diagram(\n  x, filename = NULL, \n  cat.col =c(\"A\"=\"#2E75A2\",\"B\"=\"#FBD75F\",\"C\"=\"#379337\",\"D\"=\"#C13A3C\"),\n  label.col = \"red\");grid::grid.draw(p)\n\n\n\n\n\n\n\nFigureÂ 11: Font Settings\n\n\n\n\n\nDisplay the size of the collection in proportion. This mode is only applicable to two collections:\n\np &lt;- venn.diagram(\n  x[c(\"A\",\"B\")], filename = NULL, fill= c(\"A\"=\"#2E75A2\",\"B\"=\"#FBD75F\"),\n  scaled = T\n);grid::grid.draw(p)\n\n\n\n\n\n\n\nFigureÂ 12: scaled",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "VeenPlot"
    ]
  },
  {
    "objectID": "Ranking/VennPlot.html#application",
    "href": "Ranking/VennPlot.html#application",
    "title": "Veen Plot",
    "section": "Application",
    "text": "Application\n\n\n\n\n\n\nFigureÂ 13: Applications of Venn Diagram\n\n\n\nIn this figure, R1-R4 are four different genotypes. Since R2 and R4 have exactly the same genotype at the target gene, the differentially expressed genes shared by R2 and R4 may be the downstream of the target gene [4].",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "VeenPlot"
    ]
  },
  {
    "objectID": "Ranking/VennPlot.html#reference",
    "href": "Ranking/VennPlot.html#reference",
    "title": "Veen Plot",
    "section": "Reference",
    "text": "Reference\n[1] Yu Y, Li W, Liu Y, Liu Y, Zhang Q, Ouyang Y, Ding W, Xue Y, Zou Y, Yan J, Jia A, Yan J, Hao X, Gou Y, Zhai Z, Liu L, Zheng Y, Zhang B, Xu J, Yang N, Xiao Y, Zhuo L, Lai Z, Yin P, Liu HJ, Fernie AR, Jackson D, Yan J. A Zea genus-specific micropeptide controls kernel dehydration in maize. Cell. 2025 Jan 9;188(1):44-59.e21. doi: 10.1016/j.cell.2024.10.030. Epub 2024 Nov 12. PMID: 39536747.",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "VeenPlot"
    ]
  },
  {
    "objectID": "Ranking/Lollipop.html",
    "href": "Ranking/Lollipop.html",
    "title": "Lollipop Plot",
    "section": "",
    "text": "A lollipop plot is a variation of a bar chart and a scatter plot. It consists of a line segment and a point, which can clearly display data while reducing the amount of graphics. At the same time, the lollipop plot can help align values with categories and is very suitable for comparing the differences between values of multiple categories.",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Lollipop Plot"
    ]
  },
  {
    "objectID": "Ranking/Lollipop.html#example",
    "href": "Ranking/Lollipop.html#example",
    "title": "Lollipop Plot",
    "section": "Example",
    "text": "Example",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Lollipop Plot"
    ]
  },
  {
    "objectID": "Ranking/Lollipop.html#setup",
    "href": "Ranking/Lollipop.html#setup",
    "title": "Lollipop Plot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming Language: R\nDependencies: ggplot2; tidyr; palmerpenguins; cowplot; hrbrthemes; ggalt; rstatix; ggpubr\n\n\n# Install packages\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"tidyr\", quietly = TRUE)) {\n  install.packages(\"tidyr\")\n}\nif (!requireNamespace(\"palmerpenguins\", quietly = TRUE)) {\n  install.packages(\"palmerpenguins\")\n}\nif (!requireNamespace(\"cowplot\", quietly = TRUE)) {\n  install.packages(\"cowplot\")\n}\nif (!requireNamespace(\"hrbrthemes\", quietly = TRUE)) {\n  install.packages(\"hrbrthemes\")\n}\nif (!requireNamespace(\"ggalt\", quietly = TRUE)) {\n  install.packages(\"ggalt\")\n}\nif (!requireNamespace(\"rstatix\", quietly = TRUE)) {\n  install.packages(\"rstatix\")\n}\nif (!requireNamespace(\"ggpubr\", quietly = TRUE)) {\n  install.packages(\"ggpubr\")\n}\n\n# Load packages\nlibrary(ggplot2)\nlibrary(tidyr)\nlibrary(palmerpenguins)\nlibrary(cowplot)\nlibrary(hrbrthemes)\nlibrary(ggalt)\nlibrary(rstatix)\nlibrary(ggpubr)",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Lollipop Plot"
    ]
  },
  {
    "objectID": "Ranking/Lollipop.html#data-preparation",
    "href": "Ranking/Lollipop.html#data-preparation",
    "title": "Lollipop Plot",
    "section": "Data Preparation",
    "text": "Data Preparation\nMainly use Râ€™s own data set and the data in the TCGA database for drawing.\n\ndata_TCGA &lt;- read.csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/TCGA-BRCA.htseq_counts_processed.csv\")\n\ndata_TCGA1 &lt;- data_TCGA[1:25,] %&gt;%\n  gather(key = \"sample\",value = \"gene_expression\",3:1219)\n\ndata_tcga_mean &lt;- aggregate(data_TCGA1$gene_expression, \n                            by=list(data_TCGA1$gene_name), mean) # mean\ncolnames(data_tcga_mean) &lt;- c(\"gene\",\"expression\")\n\ndata_tcga_sd &lt;- aggregate(data_TCGA1$gene_expression, \n                          by=list(data_TCGA1$gene_name), sd)\ncolnames(data_tcga_sd) &lt;- c(\"gene\",\"sd\")\n\ndata_tcga &lt;- merge(data_tcga_mean, data_tcga_sd, by=\"gene\")\n\ndata_penguins &lt;- penguins\n\ndata_penguins_mean &lt;- aggregate(data_penguins$flipper_length_mm, \n                                by=list(data_penguins$species,data_penguins$sex), \n                                mean)\ncolnames(data_penguins_mean) &lt;- c(\"species\",\"sex\",\"flipper_length\")\n\n# Convert long format data to wide format\ndata_penguins_mean &lt;- spread(data_penguins_mean, key=\"sex\", value=\"flipper_length\")\n\nrow_mean = apply(data_penguins_mean[,2:3],1,mean)\n\ndata_penguins_mean$mean &lt;- row_mean",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Lollipop Plot"
    ]
  },
  {
    "objectID": "Ranking/Lollipop.html#visualization",
    "href": "Ranking/Lollipop.html#visualization",
    "title": "Lollipop Plot",
    "section": "Visualization",
    "text": "Visualization\n\n1. Basic Lollipop Chart\nA lollipop chart consists of points and lines. It can be used to plot data for both bar charts and scatter plots.\nUsing TCGA data as an example (similar to a bar chart):\n\n# `TCGA` data\np &lt;- ggplot(data_tcga, aes(x=gene, y=expression)) +\n  geom_point() + \n  geom_segment( aes(x=gene, xend=gene, y=0, yend=expression)) +\n  theme(axis.text.x = element_text(angle = 30,vjust = 0.85,hjust = 0.85))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: TCGA data\n\n\n\n\n\nThe figure above shows the expression of different genes.\nUsing the penguin dataset as an example (similar to a scatter plot).\n\n# `penguin` dataset\np &lt;- ggplot(data_penguins, aes(x=bill_length_mm, y=bill_depth_mm)) +\n  geom_point() + \n  geom_segment( aes(x=0, xend=bill_length_mm, y=bill_depth_mm, yend=bill_depth_mm))\n  # x=0, the line starts from the y-axis; y=0, the line starts from the x-axis; both equal to 0, the line starts from the origin\n\np\n\n\n\n\n\n\n\nFigureÂ 2: penguin dataset\n\n\n\n\n\nThe figure above shows the distribution relationship between penguin beak length and depth.\n\n\n2. Customize appearance\nColor and Style\n\n# point\np1 &lt;- ggplot(data_tcga, aes(x=gene, y=expression)) +\n  geom_segment( aes(x=gene, xend=gene, y=0, yend=expression)) +\n  geom_point(size=5, color=\"red\",  # circle\n             fill=alpha(\"orange\"), # fill\n             alpha=0.7, shape=21, stroke=2) +\n  labs(title = \"point appearance\")+\n  theme(plot.title = element_text(hjust = 0.5),\n        axis.text.x = element_text(angle = 60,vjust = 0.85,hjust = 0.75))\n\n# segment\np2 &lt;- ggplot(data_tcga, aes(x=gene, y=expression)) +\n  geom_point() + \n  geom_segment( aes(x=gene, xend=gene, y=0, yend=expression),\n                size=1, color=\"blue\", linetype=\"dotdash\" )+\n  labs(title = \"segment appearance\")+\n  theme(plot.title = element_text(hjust = 0.5),\n        axis.text.x = element_text(angle = 60,vjust = 0.85,hjust = 0.75))\n\n# theme\np3 &lt;- ggplot(data_tcga, aes(x=gene, y=expression)) +\n  geom_point(color=\"orange\", size=4) + \n  geom_segment( aes(x=gene, xend=gene, y=0, yend=expression),color=\"grey\") +\n  theme_light() +\n  theme(\n    panel.grid.major.x = element_blank(),\n    panel.border = element_blank(),\n    axis.ticks.x = element_blank(),\n    plot.title = element_text(hjust = 0.5),\n    axis.text.x = element_text(angle = 60,vjust = 0.85,hjust = 0.75)#æ ‡é¢˜å±…ä¸­\n  ) +\n  xlab(\"gene\") +\n  ylab(\"expression\")+\n  labs(title = \"theme\")\n\nplot_grid(p1,p2,p3, labels = LETTERS[1:3], ncol = 2)\n\n\n\n\n\n\n\nFigureÂ 3: `Color and Style\n\n\n\n\n\nFlip and Baseline\n\n# Flip\np4 &lt;- ggplot(data_tcga, aes(x=gene, y=expression)) +\n  geom_point(color=\"orange\", size=4) + \n  geom_segment( aes(x=gene, xend=gene, y=0, yend=expression),color=\"grey\") +\n  theme_light() +\n  labs(title = \"Flip Lollipop\")+\n  theme(\n    plot.title = element_text(hjust = 0.5), # Center the title\n    panel.grid.major.x = element_blank(),\n    panel.border = element_blank(),\n    axis.ticks.x = element_blank()\n  ) +\n  xlab(\"gene\") +\n  ylab(\"expression\") +\n  coord_flip() # flip\n\n# Change baseline\np5 &lt;- ggplot(data_tcga, aes(x=gene, y=expression)) +\n  geom_point(color=\"orange\", size=4) + \n  geom_segment( aes(x=gene, xend=gene, y=5, # The value is the baseline position\n                    yend=expression),color=\"grey\") +\n  theme_light() +\n  theme(\n    panel.grid.major.x = element_blank(),\n    panel.border = element_blank(),\n    axis.ticks.x = element_blank(),\n    plot.title = element_text(hjust = 0.5), # Center the title\n    axis.text.x = element_text(angle = 60,vjust = 0.85,hjust = 0.75)\n  ) +\n  xlab(\"gene\") +\n  ylab(\"expression\")+\n  labs(title = \"Change baseline\")\n\nplot_grid(p4,p5, labels = LETTERS[1:2], ncol = 2)\n\n\n\n\n\n\n\nFigureÂ 4: `Flip and Baseline\n\n\n\n\n\n\n\n3. Highlight\nWhen you need to highlight certain data, you can use the ifelse function to filter the highlighted data.\nUsing TCGA data as an example.\n\n# Highlight----\np6 &lt;- \n# Drawing + Highlighting\n  ggplot(data_tcga, aes(x=gene, y=expression)) +\n  geom_segment(\n    aes(x=gene, xend=gene, y=0, yend=expression), \n    color=ifelse(data_tcga$gene %in% c(\"A4GALT\",\"A1CF\"), \"orange\", \"grey\"), \n    size=ifelse(data_tcga$gene %in% c(\"A4GALT\",\"A1CF\"), 1.3, 0.7)\n     # Filter highlight groups using ifelse statements\n  ) +\n  geom_point(\n    color=ifelse(data_tcga$gene %in% c(\"A4GALT\",\"A1CF\"), \"orange\", \"grey\"), \n    size=ifelse(data_tcga$gene %in% c(\"A4GALT\",\"A1CF\"), 5, 2)\n  ) +\n  theme_ipsum() +\n  coord_flip() +\n  theme(\n    legend.position=\"none\"\n  ) +\n  xlab(\"gene\") +\n  ylab(\"expression\") +\n\n# Setting the label\n  annotate(\"text\", x=grep(\"A4GALT\", data_tcga$gene), # Add text labels\n           y=data_tcga$expression[which(data_tcga$gene==\"A4GALT\")]*1.05, # Determine label position\n           label=data_tcga$expression[which(data_tcga$gene==\"A4GALT\")] %&gt;% round(2), \n           color=\"orange\", size=4 , angle=0, fontface=\"bold\", hjust=0) +\n  annotate(\"text\", x=grep(\"A1CF\", data_tcga$gene), # Add text labels\n           y=data_tcga$expression[which(data_tcga$gene==\"A1CF\")]*1.2, # Determine label position\n           label=data_tcga$expression[which(data_tcga$gene==\"A1CF\")] %&gt;% round(2), \n           color=\"orange\", size=4 , angle=0, fontface=\"bold\", hjust=0)\n\np6\n\n\n\n\n\n\n\nFigureÂ 5: `Highlight\n\n\n\n\n\nHighlight the specified data and add labels using the annotate() function.\n\n\n4. Color differentiation\nSimilarly, you can use the ifelse function to categorize data, using different colors to represent data from different sources.\nUsing the penguin dataset as an example\n\ndata_penguins1 &lt;- na.omit(data_penguins)\ndata_penguins1$number &lt;- c(1:333)\ndata_penguins1$number &lt;- as.character(data_penguins1$number)\ndata_penguins1 &lt;- data_penguins1[1:20,]\n\np &lt;- ggplot(data_penguins1, aes(x=number, y=flipper_length_mm)) +\n  geom_segment(\n    aes(x=number, xend=number, y=0, yend=flipper_length_mm), \n    color=ifelse(data_penguins1$sex == \"female\",\"#FFB6C1\", \"#4169E1\"),alpha=0.5 ,\n    size=ifelse(data_penguins1$sex == \"female\", 1.3, 1.3))+\n  geom_point(\n    color=ifelse(data_penguins1$sex == \"female\", \"#FFB6C1\", \"#4169E1\"),\n    size=ifelse(data_penguins1$sex == \"female\", 5, 5)\n  ) +\n  theme_ipsum() +\n  theme(\n    legend.position=\"none\"\n  ) +\n  xlab(\"\") +\n  ylab(\"flipper length\")\np\n\n\n\n\n\n\n\nFigureÂ 6: `Color differentiation\n\n\n\n\n\nUse the ifelse function to implement classification processing of different data. In the figure above, blue represents male and pink represents female.\n\n\n5. Dumbbell Chart (Cleveland Dot Chart)\nUnlike regular lollipop charts, dumbbell charts are suitable for comparing multiple sets of data. You can also add medians, means, and other data.\nUsing the pinguin dataset as an example:\n\np &lt;- ggplot(aes(x=female,xend=male,y=species),data=data_penguins_mean) +\n  geom_dumbbell(colour_x = \"#FFB6C1\",\n                colour_xend = \"#4169E1\",\n                size_x = 2,size_xend = 1,\n                size=1,color=\"gray\",\n                dot_guide = T)+ # Add a dashed line\n  geom_point(aes(x=female,y=species,size=female), # size=female The outer ring size indicates the data size\n             alpha=0.5,color=\"#FFB6C1\")+\n  geom_point(aes(x=male,y=species,size=male),\n             alpha=0.5,color=\"#4169E1\")+\n  theme_light()+\n  theme(panel.grid.minor.x =element_blank(),\n        panel.grid = element_blank(),\n        legend.title = element_blank()\n  ) +\n  xlab(\"flipper length\") +\n  annotate(\"text\", x=200, y=3.5, label=\"female\",color=\"#FFB6C1\",size=7) +\n  annotate(\"text\", x=205, y=3.5, label=\"VS\",color=\"black\") +\n  annotate(\"text\", x=210, y=3.5, label=\"male\",color=\"#4169E1\",size=7) \n\np\n\n\n\n\n\n\n\nFigureÂ 7: Dumbbell Chart (Cleveland Dot Chart)\n\n\n\n\n\nThe figure above shows a comparison of the mean wing lengths of three different species of penguins of different sexes, where the size of the outer circle represents the size of the data.\n\n5.1 Add Mean\nUse geom_point to add mean points based on the original image.\n\n# Add Mean\np &lt;- ggplot(aes(x=female,xend=male,y=species),data=data_penguins_mean)+\n  geom_dumbbell(colour_x = \"#FFB6C1\",\n                colour_xend = \"#4169E1\",\n                size_x = 2,size_xend = 2,\n                size=1,color=\"gray\")+ \n  geom_point(aes(x=female,y=species,size=female), # size=female The outer ring size indicates the data size\n             alpha=0.7,color=\"#FFB6C1\")+\n  geom_point(aes(x=male,y=species,size=male),\n             alpha=0.7,color=\"#4169E1\")+\n  geom_point(aes(x=mean,y=species,size=mean),\n             alpha=0.5,color=\"orange\")+ # Add Mean\n  theme_light()+\n  theme(panel.grid.minor.x =element_blank(),\n        panel.grid = element_blank(),\n        legend.title = element_blank()\n  ) +\n  xlab(\"flipper length\") +\n  annotate(\"text\", x=200, y=3.5, label=\"female\",color=\"#FFB6C1\",size=7) +\n  annotate(\"text\", x=205, y=3.5, label=\"VS\",color=\"black\") +\n  annotate(\"text\", x=210, y=3.5, label=\"male\",color=\"#4169E1\",size=7) \n\np\n\n\n\n\n\n\n\nFigureÂ 8: `Add Mean\n\n\n\n\n\nAdd mean points based on the original data (you can also add median, range, data volume, etc. as needed).\n\n\n5.2 Add difference analysis\n\n# Add difference analysis\np_val1_sex &lt;- data_penguins %&gt;%  \n  group_by(species) %&gt;% \n  wilcox_test(formula = flipper_length_mm~sex)%&gt;%\n  add_significance(p.col = 'p',cutpoints = c(0,0.001,0.01,0.05,1),symbols = c('***','**','*','ns'))\n\np_val1_species &lt;- data_penguins %&gt;% \n  wilcox_test(formula = flipper_length_mm~species) %&gt;%\n  add_significance(p.col = 'p',cutpoints = c(0,0.001,0.01,0.05,1),symbols = c('***','**','*','ns')) \n\np &lt;- ggplot(aes(x=female,xend=male,y=species),data=data_penguins_mean)+\n  geom_dumbbell(colour_x = \"#FFB6C1\",\n                colour_xend = \"#4169E1\",\n                size_x = 2,size_xend = 2,\n                size=1,color=\"gray\")+\n  geom_point(aes(x=female,y=species,size=female), # size=female The outer ring size indicates the data size\n             alpha=0.7,color=\"#FFB6C1\")+\n  geom_point(aes(x=male,y=species,size=male),\n             alpha=0.7,color=\"#4169E1\")+\n  geom_point(aes(x=mean,y=species,size=mean),\n             alpha=0.5,color=\"orange\")+ # Add Mean\n  theme_light()+\n  theme(panel.grid.minor.x =element_blank(),\n        panel.grid = element_blank(),\n        legend.title = element_blank()\n  )+\n  xlab(\"flipper length\") +\n  annotate(\"text\", x=201.5, y=3.5, label=\"female\",color=\"#FFB6C1\") +\n  annotate(\"text\", x=205, y=3.5, label=\"VS\",color=\"black\") +\n  annotate(\"text\", x=208, y=3.5, label=\"male\",color=\"#4169E1\") +\n# Difference Tags\n# species\n  annotate(\"text\", y=1,x=216,\n           label=paste(\"Adelie&Chinstra p=\",\n                       p_val1_species$p[which(p_val1_species$group1==\"Adelie\"& p_val1_species$group2==\"Chinstrap\")],\n                       \" \",\n                       p_val1_species$p.signif[which(p_val1_species$group1==\"Adelie\"& p_val1_species$group2==\"Chinstrap\")])) +\n  annotate(\"text\", y=0.8,x=216,\n           label=paste(\"Adelie&Gentoo p=\",\n                       p_val1_species$p[which(p_val1_species$group1==\"Adelie\"& p_val1_species$group2==\"Gentoo\")],\n                       \" \",\n                       p_val1_species$p.signif[which(p_val1_species$group1==\"Adelie\"& p_val1_species$group2==\"Gentoo\")])) +\n  annotate(\"text\", y=0.6,x=216,\n           label=paste(\"Chinstrap&Gentoo p=\",\n                       p_val1_species$p[which(p_val1_species$group1==\"Chinstrap\"& p_val1_species$group2==\"Gentoo\")],\n                       \" \",\n                       p_val1_species$p.signif[which(p_val1_species$group1==\"Chinstrap\"& p_val1_species$group2==\"Gentoo\")])) +\n\n# sex\n  annotate(\"text\", y=grep(\"Gentoo\", data_penguins_mean$species)+0.15, # Add text labels\n           x=data_penguins_mean$mean[which(data_penguins_mean$species==\"Gentoo\")], \n           # Determine label position\n           label=p_val1_sex$p.adj.signif[which(p_val1_sex$species==\"Gentoo\")]) +\n  annotate(\"text\", y=grep(\"Chinstrap\", data_penguins_mean$species)+0.15, # Add text labels\n           x=data_penguins_mean$mean[which(data_penguins_mean$species==\"Chinstrap\")], \n           # Determine label position\n           label=p_val1_sex$p.adj.signif[which(p_val1_sex$species==\"Chinstrap\")]) +\n  annotate(\"text\", y=grep(\"Adelie\", data_penguins_mean$species)+0.15, # Add text labels\n           x=data_penguins_mean$mean[which(data_penguins_mean$species==\"Adelie\")], \n           # Determine label position\n           label=p_val1_sex$p.adj.signif[which(p_val1_sex$species==\"Adelie\")])\n\np\n\n\n\n\n\n\n\nFigureÂ 9: `Add difference analysis\n\n\n\n\n\nThe results of the difference analysis on the effects of penguin species and penguin gender on wing length in the original data were significant.",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Lollipop Plot"
    ]
  },
  {
    "objectID": "Ranking/Lollipop.html#applications",
    "href": "Ranking/Lollipop.html#applications",
    "title": "Lollipop Plot",
    "section": "Applications",
    "text": "Applications\n\n1. Lollipop plot\n\n\n\n\n\n\nFigureÂ 10: Applications of lollipop plot\n\n\n\nPanel D shows the frequencies of deletion, gain, and absence of copy number variants in AAGs (angiogenesis-related genes). [1]\n\n\n2. Dumbbell plot\n\n\n\n\n\n\nFigureÂ 11: Applications of dumbbell plot\n\n\n\n\nCorrelation between GRB10 and infiltrating immune cells; (B) Correlation between E2F3 and infiltrating immune cells.\n\nThe size of the dot represents the strength of the correlation between the gene and immune cells; larger dots indicate stronger correlations, while smaller dots indicate weaker correlations. The color of the dot represents the p-value; greener dots indicate lower p-values, while yellower dots indicate higher p-values. [2]",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Lollipop Plot"
    ]
  },
  {
    "objectID": "Ranking/Lollipop.html#reference",
    "href": "Ranking/Lollipop.html#reference",
    "title": "Lollipop Plot",
    "section": "Reference",
    "text": "Reference\n[1] Qing X, Xu W, Liu S, Chen Z, Ye C, Zhang Y. Molecular Characteristics, Clinical Significance, and Cancer Immune Interactions of Angiogenesis-Associated Genes in Gastric Cancer. Front Immunol. 2022 Feb 22;13:843077. doi: 10.3389/fimmu.2022.843077. PMID: 35273618; PMCID: PMC8901990.\n[2] Deng YJ, Ren EH, Yuan WH, Zhang GZ, Wu ZL, Xie QQ. GRB10 and E2F3 as Diagnostic Markers of Osteoarthritis and Their Correlation with Immune Infiltration. Diagnostics (Basel). 2020 Mar 22;10(3):171. doi: 10.3390/diagnostics10030171. PMID: 32235747; PMCID: PMC7151213.\n[3] H. Wickham. ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York, 2016.\n[4] Wickham H, Vaughan D, Girlich M (2024). tidyr: Tidy Messy Data. R package version 1.3.1, https://CRAN.R-project.org/package=tidyr.\n[5] Horst AM, Hill AP, Gorman KB (2020). palmerpenguins: Palmer Archipelago (Antarctica) penguin data. R package version\n[6] Wilke C (2024). cowplot: Streamlined Plot Theme and Plot Annotations for â€˜ggplot2â€™. R package version 1.1.3, https://CRAN.R-project.org/package=cowplot.\n[7] Rudis B (2024). hrbrthemes: Additional Themes, Theme Components and Utilities for â€˜ggplot2â€™. R package version 0.8.7, https://CRAN.R-project.org/package=hrbrthemes.\n[8] Rudis B, Bolker B, Schulz J (2017). ggalt: Extra Coordinate Systems, â€˜Geomsâ€™, Statistical Transformations, Scales and Fonts for â€˜ggplot2â€™. R package version 0.4.0, https://CRAN.R-project.org/package=ggalt.\n[9] Kassambara A (2023). rstatix: Pipe-Friendly Framework for Basic Statistical Tests. R package version 0.7.2, https://CRAN.R-project.org/package=rstatix.\n[10] Kassambara A (2023). ggpubr: â€˜ggplot2â€™ Based Publication Ready Plots. R package version 0.6.0, https://CRAN.R-project.org/package=ggpubr.",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Lollipop Plot"
    ]
  },
  {
    "objectID": "Ranking/Radar.html",
    "href": "Ranking/Radar.html",
    "title": "Radar/Spider Plot",
    "section": "",
    "text": "A radar chart, spider chart, or web chart is a two-dimensional chart type used to plot a series of values over one or more quantitative variables. The fmsb library is an excellent tool for building this type of chart in R.",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Radar/Spider Chart"
    ]
  },
  {
    "objectID": "Ranking/Radar.html#example",
    "href": "Ranking/Radar.html#example",
    "title": "Radar/Spider Plot",
    "section": "Example",
    "text": "Example",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Radar/Spider Chart"
    ]
  },
  {
    "objectID": "Ranking/Radar.html#setup",
    "href": "Ranking/Radar.html#setup",
    "title": "Radar/Spider Plot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming Language: R\nDependencies: fmsb\n\n\n# Install packages\nif (!requireNamespace(\"fmsb\", quietly = TRUE)) {\n  install.packages(\"fmsb\")\n}\n\n# Load packages\nlibrary(fmsb)",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Radar/Spider Chart"
    ]
  },
  {
    "objectID": "Ranking/Radar.html#data-preparation",
    "href": "Ranking/Radar.html#data-preparation",
    "title": "Radar/Spider Plot",
    "section": "Data Preparation",
    "text": "Data Preparation\nThis paper primarily uses the built-in iris dataset in R, custom datasets, and the TCGA database.\nThe input data format must be very specific. Each row must contain a single entity. Each column is a quantitative variable. The first two rows provide the minimum and maximum values to be used for each variable.\n\n# 1.R built-in data - iris\nhead(iris)\n\n  Sepal.Length Sepal.Width Petal.Length Petal.Width Species\n1          5.1         3.5          1.4         0.2  setosa\n2          4.9         3.0          1.4         0.2  setosa\n3          4.7         3.2          1.3         0.2  setosa\n4          4.6         3.1          1.5         0.2  setosa\n5          5.0         3.6          1.4         0.2  setosa\n6          5.4         3.9          1.7         0.4  setosa\n\n# 2.Self-built dataset\n## Here we create a data set about the performance of three students in different subjects\nset.seed(99)                  \ndata &lt;- as.data.frame(matrix( sample( 0:20 , 15 , replace=F) , ncol=5))\ncolnames(data) &lt;- c(\"math\" , \"english\" , \"biology\" , \"music\" , \"R-coding\" )\nrownames(data) &lt;- paste(\"mister\" , letters[1:3] , sep=\"-\")\ndata &lt;- rbind(rep(20,5) , rep(0,5) , data) \n\n# 3.TCGA database (gene expression data of liver cancer)\ntcga_group_radar &lt;- readr::read_csv(\n\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/tcga_group_radar.csv\")\ntcga_simple_bar &lt;- data.frame(tcga_group_radar[3,])",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Radar/Spider Chart"
    ]
  },
  {
    "objectID": "Ranking/Radar.html#visualization",
    "href": "Ranking/Radar.html#visualization",
    "title": "Radar/Spider Plot",
    "section": "Visualization",
    "text": "Visualization\n\n1. Basic Plot\nTake iris data as an example\n\n# Data collation\niris_setosa &lt;- iris[c(1:50),]\niris_setosa &lt;- iris_setosa[,-5]\niris_setosa_radar &lt;- rbind(rep(6,4),rep(0,4),iris_setosa)\n# plot\npar(mar = c(1, 1, 1, 1))\nradarchart(iris_setosa_radar)\n\n\n\n\n\n\n\nFigureÂ 1: Basic Plot\n\n\n\n\n\nThis radar chart depicts the distribution of four basic properties for a sample from the genus setosa.\nUsing the TCGA database as an example\n\npar(mar = c(1, 1, 1, 1))\ntcga_simple_bar &lt;- rbind(rep(2.5,3),rep(0,3),tcga_simple_bar)\nradarchart(tcga_simple_bar)\n\n\n\n\n\n\n\nFigureÂ 2: Basic Plot\n\n\n\n\n\nThis radar chart describes the expression levels of TIGAR, RNF44, and RAB4B genes in a sample.\n\n\n\n\n\n\nTip\n\n\n\nKey parameters:\nPolygonal features: - pcolï¼šLine color - pfcolï¼šFill color - plwdï¼šLine width\nGrid features: - cglcolï¼šGrid color - cgltyï¼šGrid line type - axislabcolï¼šAxis line color - caxislabelsï¼šAxis labels to display - cglwdï¼šGrid width\nGroup Label: - vlcexï¼šGroup label size\n\n\n\nradarchart(iris_setosa_radar,\n           axistype=1 ,  \n           pcol=rgb(0.2,0.5,0.5,0.9),\n           pfcol=rgb(0.2,0.5,0.5,0.1),\n           plwd=4,  \n           cglcol=\"grey\",cglty=1,axislabcol=\"grey\",\n           caxislabels=seq(0,20,5), cglwd=0.8, vlcex=0.8)\n\n\n\n\n\n\n\nFigureÂ 3: Parameter Adjustment\n\n\n\n\n\nThis radar chart describes the distribution of four basic properties of a sample from the setosa species.\n\n\n2. Multi-group radar chart\nTake self-built dataset as an example\n\nradarchart(data)\n\n\n\n\n\n\n\nFigureÂ 4: Multi-group radar chart\n\n\n\n\n\nThis radar chart describes the distribution of scores of three students in various subjects.\nAdjust parameters\n\n# Set color parameters\ncolors_border=c(rgb(0.2,0.5,0.5,0.9),rgb(0.8,0.2,0.5,0.9),rgb(0.7,0.5,0.1,0.9) )\ncolors_in=c(rgb(0.2,0.5,0.5,0.4),rgb(0.8,0.2,0.5,0.4) ,rgb(0.7,0.5,0.1,0.4) )\n\n# plot\nradarchart(data,\n           axistype=1 , \n           pcol=colors_border , pfcol=colors_in , plwd=4 , plty=1,\n           cglcol=\"grey\", cglty=1, \n           axislabcol=\"grey\", caxislabels=seq(0,20,5), \n           cglwd=0.8,\n           vlcex=0.8\n)\n\n# Add a legend\nlegend(x=0.7, y=1, \n       legend = rownames(data[-c(1,2),]), bty = \"n\",\n       pch=20,col=colors_in , text.col = \"grey\", \n       cex=1.2, pt.cex=3)\n\n\n\n\n\n\n\nFigureÂ 5: Adjust parameters\n\n\n\n\n\nThis radar chart describes the distribution of scores of three students in various subjects.\nTaking the TCGA database as an example\n\npar(mar = c(1, 1, 1, 1))\ntcga_group_radar &lt;- rbind(rep(3,3),rep(0,3),tcga_group_radar)\ntcga_group_radar &lt;- as.data.frame(tcga_group_radar) # It must be converted into a data frame before it can be drawn.\nradarchart(tcga_group_radar)\n\n\n\n\n\n\n\nFigureÂ 6: TCGA\n\n\n\n\n\nThis radar chart describes the expression levels of TIGAR, RNF44, and RAB4B genes in a sample.",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Radar/Spider Chart"
    ]
  },
  {
    "objectID": "Ranking/Radar.html#applications",
    "href": "Ranking/Radar.html#applications",
    "title": "Radar/Spider Plot",
    "section": "Applications",
    "text": "Applications\n\n1. Comprehensive comparison of multivariate data\n\n\n\n\n\n\nFigureÂ 7: Comprehensive comparison of multivariate data\n\n\n\nThis study used radar charts to analyze the role and prognostic value of the YIF1B gene in pan-cancer. [1]\n\n\n2. Applicable to comprehensive evaluation of multiple indicators\n\n\n\n\n\n\nFigureÂ 8: Applicable to comprehensive evaluation of multiple indicators\n\n\n\nThe study used radar charts to present various areas of frailty assessment in older adults. [2]",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Radar/Spider Chart"
    ]
  },
  {
    "objectID": "Ranking/Radar.html#reference",
    "href": "Ranking/Radar.html#reference",
    "title": "Radar/Spider Plot",
    "section": "Reference",
    "text": "Reference\n[1] Liu J, Chen Z, Zhao P, Li W. Prognostic and immune regulating roles of YIF1B in Pan-Cancer: a potential target for both survival and therapy response evaluation. Biosci Rep.Â 2020 Jul 31;40(7):BSR20201384. doi: 10.1042/BSR20201384. PMID: 32648580; PMCID: PMC7378310.\n[2] Jung HW. Visualizing Domains of Comprehensive Geriatric Assessments to Grasp Frailty Spectrum in Older Adults with a Radar Chart. Ann Geriatr Med Res. 2020 Mar;24(1):55-56. doi: 10.4235/agmr.20.0013. Epub 2020 Mar 27. PMID: 32743323; PMCID: PMC7370779.\n[3] Nakazawa M (2024). fmsb: Functions for Medical Statistics Book with some Demographic Data. R package version 0.7.6, https://CRAN.R-project.org/package=fmsb.",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Radar/Spider Chart"
    ]
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Bizard",
    "section": "",
    "text": "Data visualization is a critical tool in biomedical research, enabling intuitive interpretation of complex datasets to advance scientific discovery and inform clinical decisions. The R programming language, with its powerful statistical capabilities and extensive package ecosystem, has become a cornerstone for creating high-quality visualizations. However, the vast and ever-evolving landscape of R plotting packages often poses challenges for researchers, who must select appropriate methods and customize visualizations to meet specific research needs. This process demands advanced coding expertise, interdisciplinary collaboration, and significant time investment, which can hinder progress and impact the accuracy of experimental outcomes.\nTo address these challenges, we developed Bizard, a comprehensive, community-driven platform that integrates a curated repository of visualization codes, advanced tutorials, and collaborative forums. By streamlining access to resources and promoting knowledge exchange, Bizard aims to enhance biomedical researchersâ€™ data analysis capabilities and facilitate the clinical translation of research findings.",
    "crumbs": [
      "<i class='fa-solid fa-house'></i> Welcome"
    ]
  },
  {
    "objectID": "index.html#welcome",
    "href": "index.html#welcome",
    "title": "Bizard",
    "section": "",
    "text": "Data visualization is a critical tool in biomedical research, enabling intuitive interpretation of complex datasets to advance scientific discovery and inform clinical decisions. The R programming language, with its powerful statistical capabilities and extensive package ecosystem, has become a cornerstone for creating high-quality visualizations. However, the vast and ever-evolving landscape of R plotting packages often poses challenges for researchers, who must select appropriate methods and customize visualizations to meet specific research needs. This process demands advanced coding expertise, interdisciplinary collaboration, and significant time investment, which can hinder progress and impact the accuracy of experimental outcomes.\nTo address these challenges, we developed Bizard, a comprehensive, community-driven platform that integrates a curated repository of visualization codes, advanced tutorials, and collaborative forums. By streamlining access to resources and promoting knowledge exchange, Bizard aims to enhance biomedical researchersâ€™ data analysis capabilities and facilitate the clinical translation of research findings.",
    "crumbs": [
      "<i class='fa-solid fa-house'></i> Welcome"
    ]
  },
  {
    "objectID": "index.html#what-is-bizard",
    "href": "index.html#what-is-bizard",
    "title": "Bizard",
    "section": "What is Bizard?",
    "text": "What is Bizard?\nBizard brings together powerful visualization tools, curated code, and collaborative features, enabling researchers to streamline data analysis and present their findings in a clear and impactful way.\n\nComprehensive Visualization Repository: Bizard consolidates visualization codes from diverse sources, including conventional graphgallery charts and innovative contributions from global experts, providing a state-of-the-art toolkit for biomedical research.\nVersatile Chart Options: The repository features R code implementations for a wide range of visualizationsâ€”variable distributions, correlation analyses, ranking plots, and interactive chartsâ€”meeting diverse data analysis needs.\nReal-World Applications: Leveraging both native R datasets and authentic biomedical data examples, Bizard enables intuitive understanding and application of visualization techniques in real-world research contexts, accelerating clinical translation.\nTailored for Biomedical Data: Includes preprocessing algorithms, annotated plotting codes, and specialized methodologies to accommodate the complexities of biomedical datasets, making advanced visualization accessible even to users with limited programming expertise.\nIntegrated Statistical Analysis: Combines statistical analysis functions with visualization modules, ensuring rigorous, visually compelling outputs that bolster research reliability and advance evidence-based medicine.\nCollaborative and Open Innovation: Actively invites contributions from biomedical experts to refine features and address evolving data visualization challenges through collective expertise.\nMulti-Platform Accessibility: Offers resources through an open-source GitHub repository with interactive forums and a WeChat official account for tutorials and updates, fostering knowledge sharing and collaboration.\nDriving Research Excellence: Empowers researchers to elevate their data visualization skills, improve methodological standards, and advance precision medicine and personalized therapies.\nFuture Vision: Committed to expanding international collaborations and delivering innovative, refined solutions to address the growing complexity of biomedical data visualization and analysis.\n\n\n\n\n\n\n\nNote\n\n\n\nIf you find this useful or have suggestions for improvement, please let us know by leaving your comments in the GitHub DiscussionsğŸ’¬ at the bottom of any page.",
    "crumbs": [
      "<i class='fa-solid fa-house'></i> Welcome"
    ]
  },
  {
    "objectID": "Tutorial.html",
    "href": "Tutorial.html",
    "title": "Tutorial",
    "section": "",
    "text": "As a comprehensive visual code repository for community collaboration, Bizard is a platform based on GitHub that integrates Discussion Questions, Graphics Collection, Collaborative Development, and Automated Deployment. Community members can discuss problems through GitHub Discussions, initiate new graphics through GitHub Issues, contribute through GitHub Pull Requests, and automate website deployment using GitHub Actions. The following describes each step in detail:",
    "crumbs": [
      "<i class='fa-solid fa-signs-post'></i> Tutorial"
    ]
  },
  {
    "objectID": "Tutorial.html#discussion-questions",
    "href": "Tutorial.html#discussion-questions",
    "title": "Tutorial",
    "section": "Discussion Questions",
    "text": "Discussion Questions\nGitHub Discussions is a forum-like platform that provides a relaxed and open space for project communication. In Bizard, we built a website comment system based on giscus, which is located at the bottom of the website page:\n\n\n\n\n\n\nFigureÂ 1: Discuss Questions Using The Bizard Comment System\n\n\n\nIf you have problems with any of the graphic tutorials, you can start a discussion using the comment box at the bottom of the tutorial page. To do so, you need to log in to your GitHub account and edit your question using Markdown syntax.\nOnce you submit a comment, your question will be automatically announced in the GitHub Discussions section of the Bizard project repository and marked with a link to the graphic tutorial. Any community member who sees your question can contribute to the discussion, and the Bizard operations team will regularly respond to questions in GitHub Discussions.\n\n\n\n\n\n\nFigureÂ 2: Create GitHub Discussions",
    "crumbs": [
      "<i class='fa-solid fa-signs-post'></i> Tutorial"
    ]
  },
  {
    "objectID": "Tutorial.html#graphics-collection",
    "href": "Tutorial.html#graphics-collection",
    "title": "Tutorial",
    "section": "Graphics Collection",
    "text": "Graphics Collection\nBizard is always looking for new graphics from the community. You can submit them through GitHub Issues. The following information is required when submitting:\n\nProposed Graphic Name\nGraphic Category: Basics / Clinical / Omics\nGraphic Example\nRelated Resources: Graphic-Related Links\n\nReference example: New Graphic Collection (First Issue)\n\n\n\n\n\n\nFigureÂ 3: GitHub Issues Collect New Graphics\n\n\n\nAfter submitting GitHub Issues, the Bizard operations team will review the chart. The review results include the following three categories:\n\nProject not yet considered\nSupplement to existing graphic tutorials\nAdd new graphic tutorials\n\nOnce approved, you can provide a graphic tutorial via GitHub Issues or Pull Requests. If you are unable to provide a tutorial, the Bizard operations team will assign someone else to handle it.",
    "crumbs": [
      "<i class='fa-solid fa-signs-post'></i> Tutorial"
    ]
  },
  {
    "objectID": "Tutorial.html#collaborative-development",
    "href": "Tutorial.html#collaborative-development",
    "title": "Tutorial",
    "section": "Collaborative Development",
    "text": "Collaborative Development\nAll community members can participate in the development of the Bizard project through GitHub Pull Requests, such as contributing new graphic tutorials, optimizing the website layout, etc.\nBefore contributing a new tutorial via Pull Requests, we recommend submitting a GitHub Issue. The Bizard Operations Team will review the tutorial and provide suggestions for revisions. If you are unable to submit a Pull Request, the Bizard Operations Team will assign someone else to submit it.\nGraphic tutorials should be written in accordance with Bizardâ€™s formatting standards and should include the following:\n\nGraphic Description\nExample\nSetup\nData Preparation\nVisualization\nApplication\nReference\n\nReference example: - New graphic tutorial (Omics - Multiple volcano Plot) - Issue 1 (Omics/MultiVolcanoPlot)\n\n\n\n\n\n\nFigureÂ 4: GitHub Issues Submitting Graphic Tutorials\n\n\n\n\n\n\n\n\n\nFigureÂ 5: GitHub Pull Requests Submitting Graphic Tutorials",
    "crumbs": [
      "<i class='fa-solid fa-signs-post'></i> Tutorial"
    ]
  },
  {
    "objectID": "Tutorial.html#automated-deployment",
    "href": "Tutorial.html#automated-deployment",
    "title": "Tutorial",
    "section": "Automated Deployment",
    "text": "Automated Deployment\nTo ensure efficient and reliable website development and completely eliminate the tediousness, delays, and risk of human error associated with manual website updates, Bizard has built a comprehensive automated workflow using GitHub Actions. This fully automates the entire process from code submission to website deployment, significantly improving the agility and stability of website iterations. The workflow is as follows: When a developer pushes new website content or code updates to a designated master branch (such as main or master) or initiates a pull request, GitHub Actions is automatically activated. It immediately executes a series of key tasks within a clean virtual environment provided by GitHub, strictly following a pre-defined configuration file (Workflow File), building the website and automatically deploying it to GitHub Pages.\n\n\n\n\n\n\nFigureÂ 6: GitHub Actions Automated Deployment",
    "crumbs": [
      "<i class='fa-solid fa-signs-post'></i> Tutorial"
    ]
  },
  {
    "objectID": "GraphGallery.html",
    "href": "GraphGallery.html",
    "title": "Graph Gallery",
    "section": "",
    "text": "ğŸ‘‹ Bizard is a comprehensive repository of advanced visualization codes tailored for biomedical research. It currently includes approximately 750 graphics across more than 65 chart types. Below is the gallery for all graphics.\nEach graph is a row in the table. You can click on the graph to zoom in for a preview. Clicking on the blue title of a graph will take you to the corresponding graphic tutorial page. The tableâ€™s Search box provides graph search function.",
    "crumbs": [
      "<i class='fa-solid fa-panorama'></i> Graph Gallery"
    ]
  },
  {
    "objectID": "GraphGallery.html#ğğ€ğ’ğˆğ‚ğ’",
    "href": "GraphGallery.html#ğğ€ğ’ğˆğ‚ğ’",
    "title": "Graph Gallery",
    "section": "ğğ€ğ’ğˆğ‚ğ’",
    "text": "ğğ€ğ’ğˆğ‚ğ’\n\nDistribution Gallery\n\n\n\n\n\n\n\n\n\n\n\n\n\nCorrelation Gallery\n\n\n\n\n\n\n\n\n\n\n\n\n\nRanking Gallery\n\n\n\n\n\n\n\n\n\n\n\n\n\nComposition/Part Of The Whole Gallery\n\n\n\n\n\n\n\n\n\n\n\n\n\nData Over Time/Evolution Gallery\n\n\n\n\n\n\n\n\n\n\n\n\n\nProportion/Flow Gallery\n\n\n\n\n\n\n\n\n\n\n\n\n\nAnimation Gallery",
    "crumbs": [
      "<i class='fa-solid fa-panorama'></i> Graph Gallery"
    ]
  },
  {
    "objectID": "GraphGallery.html#ğğŒğˆğ‚ğ’",
    "href": "GraphGallery.html#ğğŒğˆğ‚ğ’",
    "title": "Graph Gallery",
    "section": "ğğŒğˆğ‚ğ’",
    "text": "ğğŒğˆğ‚ğ’",
    "crumbs": [
      "<i class='fa-solid fa-panorama'></i> Graph Gallery"
    ]
  },
  {
    "objectID": "GraphGallery.html#ğ‚ğ‹ğˆğğˆğ‚ğ’",
    "href": "GraphGallery.html#ğ‚ğ‹ğˆğğˆğ‚ğ’",
    "title": "Graph Gallery",
    "section": "ğ‚ğ‹ğˆğğˆğ‚ğ’",
    "text": "ğ‚ğ‹ğˆğğˆğ‚ğ’",
    "crumbs": [
      "<i class='fa-solid fa-panorama'></i> Graph Gallery"
    ]
  },
  {
    "objectID": "GraphGallery.html#ğ‡ğˆğğ‹ğğ“",
    "href": "GraphGallery.html#ğ‡ğˆğğ‹ğğ“",
    "title": "Graph Gallery",
    "section": "ğ‡ğˆğğ‹ğğ“",
    "text": "ğ‡ğˆğğ‹ğğ“\n\nBASICS\n\n\n\n\n\n\n\n\n\n\n\n\n\nOMICS\n\n\n\n\n\n\n\n\n\n\n\n\n\nCLINICS\n\n\n\n\n\n\n\n\n\n\n\n\n\nMAP",
    "crumbs": [
      "<i class='fa-solid fa-panorama'></i> Graph Gallery"
    ]
  },
  {
    "objectID": "Ranking/Wordcloud.html",
    "href": "Ranking/Wordcloud.html",
    "title": "Wordcloud",
    "section": "",
    "text": "A word cloud is a visual representation of text words, which allows you to clearly see the keywords (high-frequency words) in a large amount of text data.",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Wordcloud"
    ]
  },
  {
    "objectID": "Ranking/Wordcloud.html#example",
    "href": "Ranking/Wordcloud.html#example",
    "title": "Wordcloud",
    "section": "Example",
    "text": "Example\n\n\n\n\n\nThe image above shows a word cloud for an English text. The more frequent a word is, the larger it is. We can clearly identify the most frequent words from the word cloud, which are also the key words in the text. Displaying a large text as a word cloud allows us to understand the main content of the text in a shorter time.",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Wordcloud"
    ]
  },
  {
    "objectID": "Ranking/Wordcloud.html#setup",
    "href": "Ranking/Wordcloud.html#setup",
    "title": "Wordcloud",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming Language: R\nDependencies: wordcloud2, jiebaRD, jiebaR, dplyr, tidyverse, htmlwidgets, webshot2\n\n\n# Install packages\nif (!requireNamespace(\"wordcloud2\", quietly = TRUE)) {\n  install.packages(\"wordcloud2\")\n}\nif (!requireNamespace(\"jiebaRD\", quietly = TRUE)) {\n  install.packages(\"https://cran.r-project.org/src/contrib/Archive/jiebaRD/jiebaRD_0.1.tar.gz\")\n}\nif (!requireNamespace(\"jiebaR\", quietly = TRUE)) {\n  install.packages(\"https://cran.r-project.org/src/contrib/Archive/jiebaR/jiebaR_0.11.1.tar.gz\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"tidyverse\", quietly = TRUE)) {\n  install.packages(\"tidyverse\")\n}\nif (!requireNamespace(\"htmlwidgets\", quietly = TRUE)) {\n  install.packages(\"htmlwidgets\")\n}\nif (!requireNamespace(\"webshot2\", quietly = TRUE)) {\n  install.packages(\"webshot2\")\n}\n\n# Load packages\nlibrary(wordcloud2)\nlibrary(jiebaR)    # Breaking Chinese text into words\nlibrary(dplyr)\nlibrary(tidyverse)\nlibrary(htmlwidgets)\nlibrary(webshot2)",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Wordcloud"
    ]
  },
  {
    "objectID": "Ranking/Wordcloud.html#data-preparation",
    "href": "Ranking/Wordcloud.html#data-preparation",
    "title": "Wordcloud",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe Chinese texts used were 25 Chinese abstracts on immunotherapy for lung cancer retrieved from CNKI; the English texts used were the demoFreq dataset provided by R and 24 English abstracts on immunotherapy for lung cancer retrieved from PubMed.\n\n# 1.Chinese abstract text\nwords &lt;- read.csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/words.txt\",header = FALSE,sep=\"\\n\")\nwords &lt;- as.character(words)\n\nhead_words &lt;- substr(words, start = 1, stop = 20)\n\nhead_words\n\n[1] \"è‚ºç™Œå¯åˆ†ä¸ºéå°ç»†èƒè‚ºç™Œ(NSCLC)å’Œå°\"\n\n# 2.demoFreq dataset\ndata &lt;- demoFreq\n\nhead(data)\n\n         word freq\noil       oil   85\nsaid     said   73\nprices prices   48\nopec     opec   42\nmln       mln   31\nthe       the   26\n\n# 3.English abstract text\nwords_english &lt;- read.csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/words_english.txt\",header = FALSE,sep=\"\\n\")\n\nwords_english &lt;- as.character(words_english)\n\nhead_words_english &lt;- substr(words_english, start = 1, stop = 20)\n\nhead_words_english\n\n[1] \"Persistent inflammat\"\n\n\nConvert text into phrases/words\n\n\n\n\n\n\nTip\n\n\n\nNote:  You can directly use the sample data demoFreq, so you donâ€™t need to understand the text preprocessing process. The following mainly uses Chinese text for drawing.\n\n\nChinese text\n\n# Use the jiebaR package to split the text into phrases\nwords_seg &lt;- words %&gt;%\n  segment(worker()) %&gt;%                    # Split text into words\n  tibble(word = .) %&gt;%  \n  filter(nchar(word) &gt; 1) %&gt;%              # Remove single-word phrases\n  count(word, sort = TRUE) %&gt;%             # Statistical word frequency\n  filter(!str_detect(word, \"[0-9]+\")) %&gt;%  # Remove numbers\n  slice_max(n, n = 50)                     # Select words with high frequency\n\nhead(words_seg)\n\n# A tibble: 6 Ã— 2\n  word         n\n  &lt;chr&gt;    &lt;int&gt;\n1 æ‚£è€…       153\n2 æ²»ç–—        79\n3 å…ç–«æ²»ç–—    64\n4 NSCLC       55\n5 ç»†èƒ        55\n6 è‚ºç™Œ        54\n\n\nEnglish text\n\n# Split directly into single words\nwords_english %&gt;%\n str_replace_all(\",\", \" \") %&gt;%         # Replace punctuation marks with spaces\n str_replace_all(\"\\\\.\", \" \") %&gt;%\n str_replace_all(\"\\\\(\", \" \") %&gt;%\n str_replace_all(\"\\\\)\", \" \") %&gt;%\n str_split(\" \", simplify = TRUE) %&gt;%  # Split text into words\n .[nchar(.) &gt; 1] %&gt;%                  # Remove words of length 1 or 0\n tibble(word = .) %&gt;%\n filter(!grepl(\"[0-9]+\", word)) %&gt;%   # Remove numbers\n table() %&gt;%\n as.data.frame() %&gt;%\n arrange(desc(Freq)) %&gt;%\n slice(1:60) -&gt; words_english_sep     # Select the top 60 words\n\n# Remove meaningless words based on the word list\nwords_english_sep1 &lt;- words_english_sep[c(-1, -2, -3, -4, -5, -6, -7, -14, -20, -22, -23, -24, -26, -27, -29, -30, -31, -33, -34, -35, -36, -44, -46, -53, -55),]\n\nhead(words_english_sep1)\n\n            word Freq\n8       patients   56\n9  immunotherapy   51\n10        cancer   46\n11         NSCLC   46\n12          lung   44\n13          cell   40\n\n\nThe figure shows the words with higher frequency and their frequency after being split into words.",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Wordcloud"
    ]
  },
  {
    "objectID": "Ranking/Wordcloud.html#visualization",
    "href": "Ranking/Wordcloud.html#visualization",
    "title": "Wordcloud",
    "section": "Visualization",
    "text": "Visualization\n\n1. Basic Plotting\n\n# Basic Plotting\nBasicPlot &lt;- wordcloud2(data = words_seg, size = 1)\nBasicPlot\n\n\n\n\n\n\n\nFigureÂ 1: Basic Plotting\n\n\n\nThis figure is a basic word cloud diagram, which can be drawn by using the wordcloud2 function and word frequency data.\n\n\n2. Set Color\ncolor parameter\n\n# (1) Set text color\nSetcolors &lt;- wordcloud2(data = words_seg, size = 1, color = \"random-dark\")\nSetcolors\n\n\n\n\n\n\n\nFigureÂ 2: color parameter\n\n\n\nThis image uses the color parameter to set the word color to a random dark tone.\n\n\n\n\n\n\nTip\n\n\n\nKey parameter: color\nThe color of the text. The options are â€œrandom-darkâ€, â€œrandom-lightâ€, or you can use a vector to define a custom color.\n\n\nCustom colors\n\n# (2) Vector custom color\nCustomizeColors &lt;- wordcloud2(\n  data = words_seg, size = 1, \n  color = rep_len(c(\"green\", \"blue\"),nrow(words_seg)))\nCustomizeColors\n\n\n\n\n\n\n\nFigureÂ 3: Custom colors\n\n\n\nIn this figure, the rep_len() function is used to repeat two colors to form a vector for the definition of word color.\nBackground Color\n\n# (3) Set the background color\nBackgroundColor &lt;- wordcloud2(data = words_seg, size = 1, color = \"random-light\",\n                              backgroundColor = \"black\")\nBackgroundColor\n\n\n\n\n\n\n\nFigureÂ 4: Background Color\n\n\n\nThis figure sets the color of the word cloud to the background color through backgroundColor=\"black\" in the code.\n\n\n3. Set shape\n\n# Set as star\nSetShape &lt;- wordcloud2(data = words_seg, size = 0.5, shape = \"star\")\nSetShape\n\n\n\n\n\n\n\nFigureÂ 5: Set shape\n\n\n\nThis figure sets the shape of the word cloud to a star by shape = 'star' in the code. In addition to the star shape, there are many other shapes that can be used to make the word cloud drawing more personalized.\n\n\n\n\n\n\nTip\n\n\n\nKey parameter: shape\nThe shape of the word cloud. The options are â€˜circleâ€™ (default, original shape), â€˜cardioidâ€™ (heart shape), â€˜diamondâ€™ (diamond shape), â€˜triangle-forwardâ€™ (triangle-forward), â€˜triangleâ€™ (triangle), â€˜pentagonâ€™ (pentagon), â€˜starâ€™ (star shape).\n\n\n\n\n4. Word Cloud Rotation\nFixed rotation\n\n# (1) Set a certain rotation angle (the maximum and minimum angles are set to the same, and the rotation ratio is 1)\nSpecificRotation &lt;- wordcloud2(data = words_seg, size = 1, minRotation = -pi / 6,\n                               maxRotation = -pi / 6, rotateRatio = 1)\nSpecificRotation\n\n\n\n\n\n\n\nFigureÂ 6: Fixed rotation\n\n\n\nThe direction of the words used in this figure is rotated 30 degrees clockwise. The maximum and minimum rotation angles need to be set to the same, and the rotation ratio is set to 1.\n\n\n\n\n\n\nTip\n\n\n\nKey parameters: minRotation/maxRotation/rotateRatio\n\nminRotation: Minimum rotation angle.\nmaxRotation: Maximum rotation angle.\nrotateRatio: The ratio of word rotation. rotateRatio = 1 will rotate all words.\n\n\n\nRandom rotation\n\n# (2) Random rotation\nRandomRotation &lt;- wordcloud2(data = words_seg, size = 1, minRotation = -pi / 6,\n                             maxRotation = pi / 6, rotateRatio = 0.8)\nRandomRotation\n\n\n\n\n\n\n\nFigureÂ 7: Random rotation\n\n\n\nThe rotation angle of this word cloud is between (-30Â°, 30Â°), the angle is selected randomly, and the rotation ratio is 0.8.\n\n\n5. English word cloud\nUsing demoFreq data\n\n# Using demoFreq data\nEnglishWordcloud1 &lt;- wordcloud2(data = demoFreq[1:75, ], size = 1)\nEnglishWordcloud1\n\n\n\n\n\n\n\nFigureÂ 8: Using demoFreq data\n\n\n\nThe word cloud in this figure uses the first 75 items of the demoFreq dataset for plotting. The plotting code for the English word cloud and the Chinese word cloud is the same.\nUse PubMed abstract text\n\n# Use PubMed abstract text\nEnglishWordcloud2 &lt;- wordcloud2(data = words_english_sep1, size = 0.6)\nEnglishWordcloud2\n\n\n\n\n\n\n\nFigureÂ 9: Use PubMed abstract text\n\n\n\nThe word cloud in the figure was drawn using PubMed abstract text and shows keywords for the topic of immunotherapy for lung cancer.",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Wordcloud"
    ]
  },
  {
    "objectID": "Ranking/Wordcloud.html#applications",
    "href": "Ranking/Wordcloud.html#applications",
    "title": "Wordcloud",
    "section": "Applications",
    "text": "Applications\n\n\n\n\n\n\nFigureÂ 10: Applications of Wordcloud1\n\n\n\nThe visualization depicted in the figure shows that the bold, large font in the World Cloud visualization is intended to map the number of words that are the subject of each article abstract in maritime security research. The names of several countries, such as China, India, Indonesia, Australia, and the United States, are included in the World Cloud because most articles discuss certain countries or regions. [1]\n\n\n\n\n\n\nFigureÂ 11: Applications of Wordcloud2\n\n\n\nThe three word clouds of DATA_SET 1 in the figure show the most frequently used words in positive, negative, and neutral emotions, respectively, verifying the authorâ€™s view that social media cannot provide netizens with appropriate courses for dealing with epidemics such as COVID-19. [2]\n\n\n\n\n\n\nFigureÂ 12: Applications of Wordcloud3\n\n\n\nThe word cloud shown here was created based on 162 comments from a Survivor Corps poll that asked respondents about vibrating or buzzing sensations and neuropathic pain. The word cloud shows that pain, burning, COVID-19, legs, hands, and feet were the most common terms mentioned in the comments. The word cloud includes terms related to sensations like burning and symptoms like shingles and thrush. [3]",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Wordcloud"
    ]
  },
  {
    "objectID": "Ranking/Wordcloud.html#reference",
    "href": "Ranking/Wordcloud.html#reference",
    "title": "Wordcloud",
    "section": "Reference",
    "text": "Reference\n[1] KISMARTINI K, YUSUF I M, SABILLA K R, et al.Â A bibliometric analysis of maritime security policy: Research trends and future agenda[J]. Heliyon, 2024,10(8): e28988.\n[2] CHAKRABORTY K, BHATIA S, BHATTACHARYYA S, et al.Â Sentiment Analysis of COVID-19 tweets by Deep Learning Classifiers-A study to show how popularity is affecting accuracy in social media[J]. Appl Soft Comput, 2020,97: 106754.\n[3] MASSEY D, SAWANO M, BAKER A D, et al.Â Characterisation of internal tremors and vibration symptoms[J]. BMJ Open, 2023,13(12): e77389.",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Wordcloud"
    ]
  },
  {
    "objectID": "Ranking/Table.html",
    "href": "Ranking/Table.html",
    "title": "Table",
    "section": "",
    "text": "Tables are both a visual communication mode and a means of organizing and collating data.",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Table"
    ]
  },
  {
    "objectID": "Ranking/Table.html#example",
    "href": "Ranking/Table.html#example",
    "title": "Table",
    "section": "Example",
    "text": "Example\n\n\n\n\n\nThe table above is a basic table, containing a header row and 6 rows of data.",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Table"
    ]
  },
  {
    "objectID": "Ranking/Table.html#setup",
    "href": "Ranking/Table.html#setup",
    "title": "Table",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming Language: R\nDependencies: gt, gtExtras, dplyr\n\n\n# Install packages\nif (!requireNamespace(\"gt\", quietly = TRUE)) {\n  install.packages(\"gt\", type = \"binary\")\n}\nif (!requireNamespace(\"gtExtras\", quietly = TRUE)) {\n  install.packages(\"gtExtras\")\n}\nif (!requireNamespace(\"readr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\n\n# Load packages\nlibrary(gt)\nlibrary(gtExtras) # Used to draw highlighted rows/columns\nlibrary(dplyr)",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Table"
    ]
  },
  {
    "objectID": "Ranking/Table.html#data-preparation",
    "href": "Ranking/Table.html#data-preparation",
    "title": "Table",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe first 7 rows of the iris dataset and the first 7 rows of gastric cancer clinical data from the UCSC Xena database were selected.\n\n# 1.Select the first 7 rows of the iris dataset\ndata &lt;- iris[1:7,]\n\nhead(data)\n\n  Sepal.Length Sepal.Width Petal.Length Petal.Width Species\n1          5.1         3.5          1.4         0.2  setosa\n2          4.9         3.0          1.4         0.2  setosa\n3          4.7         3.2          1.3         0.2  setosa\n4          4.6         3.1          1.5         0.2  setosa\n5          5.0         3.6          1.4         0.2  setosa\n6          5.4         3.9          1.7         0.4  setosa\n\n# 2.The first 7 rows of clinical data on gastric cancer from the UCSC Xena database (this clinical data was only used when creating the three-line table).\ndata_clinical &lt;- read.table(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/TCGA-STAD.survival.tsv\", header = TRUE, sep = \"\\t\")\ndata_clinical &lt;- data_clinical[1:7,]\n\nhead(data_clinical)\n\n            sample OS.time OS    X_PATIENT\n1 TCGA-CG-4306-01A       1  1 TCGA-CG-4306\n2 TCGA-HU-A4GQ-01A       3  1 TCGA-HU-A4GQ\n3 TCGA-FP-A8CX-01A       7  0 TCGA-FP-A8CX\n4 TCGA-HU-A4GY-01A       8  0 TCGA-HU-A4GY\n5 TCGA-HU-A4GY-11A       8  0 TCGA-HU-A4GY\n6 TCGA-BR-8363-01A       8  1 TCGA-BR-8363",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Table"
    ]
  },
  {
    "objectID": "Ranking/Table.html#visualization",
    "href": "Ranking/Table.html#visualization",
    "title": "Table",
    "section": "Visualization",
    "text": "Visualization\n\n1. Basic Plotting\n\n# You can draw the graph by calling the gt() function.\ngt(data)\n\n\n\n\n\n\n\n\n\nSepal.Length\nSepal.Width\nPetal.Length\nPetal.Width\nSpecies\n\n\n\n\n5.1\n3.5\n1.4\n0.2\nsetosa\n\n\n4.9\n3.0\n1.4\n0.2\nsetosa\n\n\n4.7\n3.2\n1.3\n0.2\nsetosa\n\n\n4.6\n3.1\n1.5\n0.2\nsetosa\n\n\n5.0\n3.6\n1.4\n0.2\nsetosa\n\n\n5.4\n3.9\n1.7\n0.4\nsetosa\n\n\n4.6\n3.4\n1.4\n0.3\nsetosa\n\n\n\n\n\n\n\nFigureÂ 1: Basic Plotting\n\n\n\n\nThis table can be drawn by simply calling the gt() function.\n\n\n2. Centered data\n\n# `auto_align = FALSE` means disabling automatic alignment, which centers the element.\ngt(data,auto_align = FALSE)\n\n\n\n\n\n\n\n\n\nSepal.Length\nSepal.Width\nPetal.Length\nPetal.Width\nSpecies\n\n\n\n\n5.1\n3.5\n1.4\n0.2\nsetosa\n\n\n4.9\n3.0\n1.4\n0.2\nsetosa\n\n\n4.7\n3.2\n1.3\n0.2\nsetosa\n\n\n4.6\n3.1\n1.5\n0.2\nsetosa\n\n\n5.0\n3.6\n1.4\n0.2\nsetosa\n\n\n5.4\n3.9\n1.7\n0.4\nsetosa\n\n\n4.6\n3.4\n1.4\n0.3\nsetosa\n\n\n\n\n\n\n\nFigureÂ 2: Centered data\n\n\n\n\nThe data in the table is centered.\n\n\n3. Add title\n\n# tab_header() adds a main title and subtitle.\ngt(data) %&gt;%                   # \"%&gt;%\" is a pipeline operator that can complete a series of pipeline operations\n  tab_header(title = md(\"**Iris** DataSet\"),     # Add a title, md displays text in markdown format\n             # Add a subtitle\n             subtitle = md(\"The species includes *Iris setosa, versicolor, and virginica*\"))\n\n\n\n\n\n\n\n\n\nIris DataSet\n\n\nThe species includes Iris setosa, versicolor, and virginica\n\n\nSepal.Length\nSepal.Width\nPetal.Length\nPetal.Width\nSpecies\n\n\n\n\n5.1\n3.5\n1.4\n0.2\nsetosa\n\n\n4.9\n3.0\n1.4\n0.2\nsetosa\n\n\n4.7\n3.2\n1.3\n0.2\nsetosa\n\n\n4.6\n3.1\n1.5\n0.2\nsetosa\n\n\n5.0\n3.6\n1.4\n0.2\nsetosa\n\n\n5.4\n3.9\n1.7\n0.4\nsetosa\n\n\n4.6\n3.4\n1.4\n0.3\nsetosa\n\n\n\n\n\n\n\nFigureÂ 3: Add title\n\n\n\n\nThe table has been formatted with headings and subheadings in Markdown style.\n\n\n4. Add footnotes\n\n# Use tab_footnote() to add footnotes for titles.\ngt(data) %&gt;%\n  tab_header(title = md(\"**Iris** DataSet\"),\n             subtitle = md(\"The species includes *Iris setosa\n                           , versicolor, and virginica*\")) %&gt;%\n  tab_footnote(footnote = \"Source: R help files\",\n               locations = cells_title(groups=\"title\"))\n\n\n\n\n\n\n\n\n\nIris DataSet1\n\n\nThe species includes Iris setosa , versicolor, and virginica\n\n\nSepal.Length\nSepal.Width\nPetal.Length\nPetal.Width\nSpecies\n\n\n\n\n5.1\n3.5\n1.4\n0.2\nsetosa\n\n\n4.9\n3.0\n1.4\n0.2\nsetosa\n\n\n4.7\n3.2\n1.3\n0.2\nsetosa\n\n\n4.6\n3.1\n1.5\n0.2\nsetosa\n\n\n5.0\n3.6\n1.4\n0.2\nsetosa\n\n\n5.4\n3.9\n1.7\n0.4\nsetosa\n\n\n4.6\n3.4\n1.4\n0.3\nsetosa\n\n\n\n1 Source: R help files\n\n\n\n\n\n\n\n\nFigureÂ 4: Add footnotes\n\n\n\n\nThis table adds a footnote with the title Iris dataset.\n\n\n5. Add merge cell label\n\n# tab_spanner() adds a tab for merged cells.\ngt(data) %&gt;%\n  tab_header(title = md(\"**Iris** DataSet\"),\n             subtitle = md(\"The species includes *Iris setosa\n                           , versicolor, and virginica*\")) %&gt;%\n  tab_footnote(footnote = \"Source: R help files\",\n               locations = cells_title(groups=\"title\")) %&gt;%\n  tab_spanner(\n    label = \"Sepal\",columns = c(Sepal.Length, Sepal.Width)) %&gt;%\n  tab_spanner(\n    label = \"Petal\",columns = c(Petal.Length, Petal.Width))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nIris DataSet1\n\n\nThe species includes Iris setosa , versicolor, and virginica\n\n\n\nSepal\n\n\nPetal\n\nSpecies\n\n\nSepal.Length\nSepal.Width\nPetal.Length\nPetal.Width\n\n\n\n\n5.1\n3.5\n1.4\n0.2\nsetosa\n\n\n4.9\n3.0\n1.4\n0.2\nsetosa\n\n\n4.7\n3.2\n1.3\n0.2\nsetosa\n\n\n4.6\n3.1\n1.5\n0.2\nsetosa\n\n\n5.0\n3.6\n1.4\n0.2\nsetosa\n\n\n5.4\n3.9\n1.7\n0.4\nsetosa\n\n\n4.6\n3.4\n1.4\n0.3\nsetosa\n\n\n\n1 Source: R help files\n\n\n\n\n\n\n\n\nFigureÂ 5: Add merge cell label\n\n\n\n\nThis table uses tab_spanner() to add â€œSepalâ€ and â€œPetalâ€ merged cell labels.\n\n\n6. Add highlighted columns/rows\n\n# Add highlighted columns/rows\ngt(data,auto_align = FALSE) %&gt;% \n  gt_highlight_cols(Petal.Length,fill = \"blue\", \n                    alpha = 0.5) %&gt;% \n  gt_highlight_rows(rows = c(1,3))      \n\n\n\n\n\n\n\n\n\nSepal.Length\nSepal.Width\nPetal.Length\nPetal.Width\nSpecies\n\n\n\n\n5.1\n3.5\n1.4\n0.2\nsetosa\n\n\n4.9\n3.0\n1.4\n0.2\nsetosa\n\n\n4.7\n3.2\n1.3\n0.2\nsetosa\n\n\n4.6\n3.1\n1.5\n0.2\nsetosa\n\n\n5.0\n3.6\n1.4\n0.2\nsetosa\n\n\n5.4\n3.9\n1.7\n0.4\nsetosa\n\n\n4.6\n3.4\n1.4\n0.3\nsetosa\n\n\n\n\n\n\n\nFigureÂ 6: Add highlighted columns/rows\n\n\n\n\nThis table has a highlighted column Petal.Length and highlighted rows 1 and 3.\n\n\n7. md() and html() add text\n\n# `md()` and `html()` add text\ngt(data) %&gt;%\n# Use `md()` to bold the title and add a hyperlink. Use `html()` to add underlines, italics, and colors to the subtitle.\n  tab_header(title = md(\"[**Iris** DataSet](https://r-graph-gallery.com/)\"),\n             subtitle = html(\"&lt;u style='color:red;'&gt;The species includes Iris\n                                 &lt;i&gt;setosa, versicolor, and virginica\n                             &lt;/i&gt;&lt;/u&gt;\"))   \n\n\n\n\n\n\n\n\n\nIris DataSet\n\n\nThe species includes Iris setosa, versicolor, and virginica\n\n\nSepal.Length\nSepal.Width\nPetal.Length\nPetal.Width\nSpecies\n\n\n\n\n5.1\n3.5\n1.4\n0.2\nsetosa\n\n\n4.9\n3.0\n1.4\n0.2\nsetosa\n\n\n4.7\n3.2\n1.3\n0.2\nsetosa\n\n\n4.6\n3.1\n1.5\n0.2\nsetosa\n\n\n5.0\n3.6\n1.4\n0.2\nsetosa\n\n\n5.4\n3.9\n1.7\n0.4\nsetosa\n\n\n4.6\n3.4\n1.4\n0.3\nsetosa\n\n\n\n\n\n\n\nFigureÂ 7: md() and html() add text\n\n\n\n\nThis table allows you to add text and modify its style using md() and html(). You can learn the basic syntax of Markdown and HTML formats to change the formatting of the added text.\n\n\n8. Change table style\ntab_style() has a rich set of table style content, including table color fill, table content color, alignment, size, etc., and border style changes. The parameter style sets the style, and locations sets the location where the style takes effect.\nThree-wire table\n\n# `cell_borders()` represents the cell borders, and `cells_body()` represents the position of the table body.\ngt(data_clinical,auto_align = FALSE) %&gt;% \n  tab_style(\n    style=cell_borders(sides = \"bottom\", \n                       style=\"hidden\"),             # Style set to hidden\n    locations=cells_body(rows=c(1,2,3,4,5,6))       # Position yourself at the bottom of the main line excluding the last line.\n  )\n\n\n\n\n\n\n\n\n\nsample\nOS.time\nOS\nX_PATIENT\n\n\n\n\nTCGA-CG-4306-01A\n1\n1\nTCGA-CG-4306\n\n\nTCGA-HU-A4GQ-01A\n3\n1\nTCGA-HU-A4GQ\n\n\nTCGA-FP-A8CX-01A\n7\n0\nTCGA-FP-A8CX\n\n\nTCGA-HU-A4GY-01A\n8\n0\nTCGA-HU-A4GY\n\n\nTCGA-HU-A4GY-11A\n8\n0\nTCGA-HU-A4GY\n\n\nTCGA-BR-8363-01A\n8\n1\nTCGA-BR-8363\n\n\nTCGA-BR-A4J9-01A\n14\n0\nTCGA-BR-A4J9\n\n\n\n\n\n\n\nFigureÂ 8: Three-wire table\n\n\n\n\nThis table is similar to the commonly used three-line table chart format, and the table content is the clinical data of gastric cancer.\n\n\n\n\n\n\nTip\n\n\n\nKey parameters: style / locations\n\nstyleï¼šTo set the style of a cell, options include cell_fill(): cell fill, cell_text(): cell text, and cell_borders(): cell borders. Multiple style items can be included using list().\nlocationsï¼šThe options for applying style attributes include cells_title() (table title), cells_body() (table body), cells_footnotes() (table footnotes), and cells_column_labels() (table column names). Multiple locations can be specified using list(). cells_body() takes rows and columns parameters to specify the rows and columns. cells_column_labels() takes columns parameters to specify the columns.\n\n\n\nFull-border table\n\n# Full-border table\ngt(data,auto_align = FALSE) %&gt;% \n  tab_style(\n    style=cell_borders(sides = c(\"top\", \"bottom\",\"left\",\"right\"),\n                       weight = px(2)),            # Set the top, bottom, left, and right borders.\n    locations=list(cells_body(),cells_column_labels())  # For multiple types or multiple positions, a list can be used, and cells_column_labels() refers to the column names.\n  )\n\n\n\n\n\n\n\n\n\nSepal.Length\nSepal.Width\nPetal.Length\nPetal.Width\nSpecies\n\n\n\n\n5.1\n3.5\n1.4\n0.2\nsetosa\n\n\n4.9\n3.0\n1.4\n0.2\nsetosa\n\n\n4.7\n3.2\n1.3\n0.2\nsetosa\n\n\n4.6\n3.1\n1.5\n0.2\nsetosa\n\n\n5.0\n3.6\n1.4\n0.2\nsetosa\n\n\n5.4\n3.9\n1.7\n0.4\nsetosa\n\n\n4.6\n3.4\n1.4\n0.3\nsetosa\n\n\n\n\n\n\n\nFigureÂ 9: Full-border table\n\n\n\n\nThe borders of this table are all displayed. Except for three-line grids and full-border tables, you can use tab_style() to change the presence, color, thickness, and style of the cell borders.\n\n\n9. Change text style\n\n# Change text style\ngt(data) %&gt;% \n  tab_style(\n    style=cell_text(color=\"blue\",font=\"bold\",size=\"large\",align=\"center\",\n                    v_align=\"middle\",style=\"italic\",weight=\"normal\",\n                    decorate=\"underline\"),            \n    locations=cells_body(rows=2,columns=Sepal.Length)\n  )\n\n\n\n\n\n\n\n\n\nSepal.Length\nSepal.Width\nPetal.Length\nPetal.Width\nSpecies\n\n\n\n\n5.1\n3.5\n1.4\n0.2\nsetosa\n\n\n4.9\n3.0\n1.4\n0.2\nsetosa\n\n\n4.7\n3.2\n1.3\n0.2\nsetosa\n\n\n4.6\n3.1\n1.5\n0.2\nsetosa\n\n\n5.0\n3.6\n1.4\n0.2\nsetosa\n\n\n5.4\n3.9\n1.7\n0.4\nsetosa\n\n\n4.6\n3.4\n1.4\n0.3\nsetosa\n\n\n\n\n\n\n\nFigureÂ 10: Change text style\n\n\n\n\nThis table has its text style changed in the second row, first column.\n\n\n\n\n\n\nTip\n\n\n\nKey parameters: size/align/v_align/style/weight/decorate\n\nsizeï¼šText size options include â€œxx-smallâ€, â€œx-smallâ€, â€œsmallâ€, â€œmediumâ€, â€œlargeâ€, â€œx-largeâ€, â€œxx-largeâ€, or a custom value using px().\nalignï¼šHorizontal alignment options include â€œcenterâ€, â€œleftâ€, â€œrightâ€, and â€œjustifyâ€ (aligning each line).\nv_alignï¼šVertical alignment options include â€œtopâ€, â€œbottomâ€, and â€œmiddleâ€.\nstyleï¼šText style options include â€œnormalâ€, â€œitalicâ€, and â€œobliqueâ€.\nweightï¼šThe text thickness can be adjusted using options such as â€œnormalâ€, â€œboldâ€, â€œlighterâ€, â€œbolderâ€, or numbers from 1 to 1000.\ndecorateï¼šAdd a line segment with options such as â€œoverlineâ€ (the line is on the text), â€œline-throughâ€ (the line passes through the text), and â€œunderlineâ€ (the line is below the text).\n\n\n\n\n\n10. Change fill style\n\n# Change fill style\ngt(data) %&gt;% \n  tab_style(\n    style=cell_fill(color = \"yellow\", alpha =0.5),  # Just two parameters, color and transparency     \n    locations=cells_body(rows=2,columns=Sepal.Length) \n  )\n\n\n\n\n\n\n\n\n\nSepal.Length\nSepal.Width\nPetal.Length\nPetal.Width\nSpecies\n\n\n\n\n5.1\n3.5\n1.4\n0.2\nsetosa\n\n\n4.9\n3.0\n1.4\n0.2\nsetosa\n\n\n4.7\n3.2\n1.3\n0.2\nsetosa\n\n\n4.6\n3.1\n1.5\n0.2\nsetosa\n\n\n5.0\n3.6\n1.4\n0.2\nsetosa\n\n\n5.4\n3.9\n1.7\n0.4\nsetosa\n\n\n4.6\n3.4\n1.4\n0.3\nsetosa\n\n\n\n\n\n\n\nFigureÂ 11: Change fill style\n\n\n\n\nThis table adds a fill style for the second row and first column.",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Table"
    ]
  },
  {
    "objectID": "Ranking/Table.html#applications",
    "href": "Ranking/Table.html#applications",
    "title": "Table",
    "section": "Applications",
    "text": "Applications\n\n\n\n\n\n\nFigureÂ 12: Applications of Table 1\n\n\n\nThe above charts show the sample size statistics of survival status and predictive factors of adult RTA patients admitted to the comprehensive specialist public hospital in Bahir Dar. [1]\n\n\n\n\n\n\nFigureÂ 13: Applications of Table 2\n\n\n\nThe chart above shows a comparison of basic coagulation status between malaria patients and a healthy control group at Zeman Primary Hospital outpatient clinic and voluntary counseling and testing clinic (n=240) in Addis Ababa from June 1, 2021 to February 30, 2022. [2]\n\n\n\n\n\n\nFigureÂ 14: Applications of Table 3\n\n\n\nThe above chart compares the surgical characteristics and outcomes of patients with long-term COVID-19 symptoms and those without long-term COVID-19 symptoms. [3]",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Table"
    ]
  },
  {
    "objectID": "Ranking/Table.html#reference",
    "href": "Ranking/Table.html#reference",
    "title": "Table",
    "section": "Reference",
    "text": "Reference\n[1] KEBEDE A G, TEGENAW A, TAMIR Y, et al.Â Survival status and its predictors among adult victims of road traffic accident admitted to public hospitals of Bahir Bar City, Amhara regional state, Northwest, Ethiopia, 2023: multi center retrospective follow-up study[J]. BMC Emerg Med, 2024,24(1): 177.\n[2] TIRUNEH T, ALMAW A, ABEBAW A, et al.Â Basic coagulation parameters and platelet count among malaria patients attending at Addis Zemen Primary Hospital, Northwest Ethiopia[J]. BMC Infect Dis, 2024,24(1): 1069.\n[3] GOLDHABER N H, RAMESH K, HORTON L E, et al.Â The Long Haul to Surgery: Long COVID Has Minimal Burden on Surgical Departments[J]. Int J Environ Res Public Health, 2024,21(9).",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Table"
    ]
  },
  {
    "objectID": "Ranking/CircularBarplot.html",
    "href": "Ranking/CircularBarplot.html",
    "title": "Circular Barplot",
    "section": "",
    "text": "Circular Barplot is a variation of the well-known bar chart where bars are displayed along a circle instead of a straight line. Note that while visually appealing, circular bar charts must be used with caution because the groups do not share the same Y-axis. However, they are well-suited for periodic data.",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Circular Barplot"
    ]
  },
  {
    "objectID": "Ranking/CircularBarplot.html#example",
    "href": "Ranking/CircularBarplot.html#example",
    "title": "Circular Barplot",
    "section": "Example",
    "text": "Example",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Circular Barplot"
    ]
  },
  {
    "objectID": "Ranking/CircularBarplot.html#setup",
    "href": "Ranking/CircularBarplot.html#setup",
    "title": "Circular Barplot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming Language: R\nDependencies: tidyverse\n\n\n# Install packages\nif (!requireNamespace(\"tidyverse\", quietly = TRUE)) {\n  install.packages(\"tidyverse\")\n}\n\n# Load packages\nlibrary(tidyverse)",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Circular Barplot"
    ]
  },
  {
    "objectID": "Ranking/CircularBarplot.html#data-preparation",
    "href": "Ranking/CircularBarplot.html#data-preparation",
    "title": "Circular Barplot",
    "section": "Data Preparation",
    "text": "Data Preparation\nUsing Râ€™s built-in iris dataset, a custom dataset, and the TCGA database.\n\n# 1.R's built-in dataâ€”iris\nhead(iris)\n\n  Sepal.Length Sepal.Width Petal.Length Petal.Width Species\n1          5.1         3.5          1.4         0.2  setosa\n2          4.9         3.0          1.4         0.2  setosa\n3          4.7         3.2          1.3         0.2  setosa\n4          4.6         3.1          1.5         0.2  setosa\n5          5.0         3.6          1.4         0.2  setosa\n6          5.4         3.9          1.7         0.4  setosa\n\n# 2.Self-built dataset\ndata_customize &lt;- data.frame(\n  individual=paste( \"Mister \", seq(1,60), sep=\"\"),\n  group=c( rep('A', 10), rep('B', 30), rep('C', 14), rep('D', 6)) ,\n  value=sample( seq(10,100), 60, replace=T)\n)\n\n# 3.TCGA database (gene expression data for liver cancer)\ntcga_circle &lt;- readr::read_csv(\n\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/tcga_circle.csv\")",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Circular Barplot"
    ]
  },
  {
    "objectID": "Ranking/CircularBarplot.html#visualization",
    "href": "Ranking/CircularBarplot.html#visualization",
    "title": "Circular Barplot",
    "section": "Visualization",
    "text": "Visualization\n\n1. Basic Plotting\n\n1.1 iris dataset\nThis method is the same as creating a classic bar chart. Finally, we call coord_polar() to make the chart circular. Note that the ylim() parameter is very important. If it starts from 0, the bars will start from the center. If you provide a negative value, a white circular space will appear!\n\niris_id &lt;- iris[order(iris$Species),]\niris_id$new_column &lt;- 1:nrow(iris_id)\np &lt;- ggplot(iris_id, aes(x = new_column, y = Sepal.Length, fill = Species)) +\n  geom_bar(stat = \"identity\", width = 1) +\n  coord_polar(start = 0) +\n  theme_void() + \n  labs(fill = \"Species\", y = \"Sepal.Length\", x = NULL) +\n  theme(legend.title = element_blank()) \n\np\n\n\n\n\n\n\n\nFigureÂ 1: Basic Plotting\n\n\n\n\n\nThis circular bar chart describes the quantitative relationships of the Sepal.Length variable among different species.\n\n\n1.2 TCGA dataset\n(1) Add labels\n\n# Get the name and y-position of each label\nlabel_data &lt;- tcga_circle\n# Calculate the angle of the label\nnumber_of_bar &lt;- nrow(label_data)\nangle &lt;-  90 - 360 * (label_data$id-0.5) /number_of_bar    \n# Calculate the label alignment: right or left?\nlabel_data$hjust &lt;- ifelse(angle &lt; -90, 1, 0)\n# Adjust the flip angle BY to be readable\nlabel_data$angle &lt;- ifelse(angle &lt; -90, angle+180, angle)\n# Plot\ntcga_circle_id &lt;- tcga_circle\ntcga_circle_id$id &lt;- as.factor(tcga_circle_id$id)\np &lt;- ggplot(tcga_circle_id, aes(x = id, y = tcga_circle)) +\n  geom_bar(stat = \"identity\", fill=alpha(\"skyblue\", 0.7)) +\n  ylim(-10,20) +\n  coord_polar(start = 0) +\n  theme_minimal() +\n  theme(\n    axis.text = element_blank (),\n    axis.title = element_blank(),\n    panel.grid = element_blank (),\n    plot.margin = unit(rep(-1,4), \"cm\")  )+   \n  labs(fill = \"RowNames\", y = \"tcga_circle\", x = NULL) +\n  theme(legend.title = element_blank()) +\n  geom_text(data=label_data, \n            aes(x=id, y=tcga_circle+10, label=RowNames, hjust=hjust), \n            color=\"black\", fontface=\"bold\",alpha=0.6, size=2.5, \n            angle= label_data$angle, inherit.aes = FALSE )\n\np\n\n\n\n\n\n\n\nFigureÂ 2: Add labels\n\n\n\n\n\nThis circular bar chart describes the expression values of different genes in a sample of liver cancer.\n(2) Add a gap\n\n# Add a gap\nempty_bar &lt;- 20\nto_add &lt;- matrix(NA, empty_bar, ncol(tcga_circle))\ncolnames(to_add) &lt;- colnames(tcga_circle)\ntcga_circle_id &lt;- rbind(tcga_circle, to_add)\ntcga_circle_id$id &lt;- seq(1, nrow(tcga_circle_id))\n# Get the name and y-position of each label\nlabel_data &lt;- tcga_circle_id\n# Calculate the angle of the label\nnumber_of_bar &lt;- nrow(label_data)\nangle &lt;-  90 - 360 * (label_data$id-0.5) /number_of_bar    \n# Calculate the label alignment: right or left?\nlabel_data$hjust &lt;- ifelse( angle &lt; -90, 1, 0)\n# Adjust the flip angle BY to be readable\nlabel_data$angle &lt;- ifelse(angle &lt; -90, angle+180, angle)\n\np &lt;- ggplot(tcga_circle_id, aes(x = id, y = tcga_circle)) +\n  geom_bar(stat = \"identity\", fill=alpha(\"skyblue\", 0.7)) +\n  ylim(-10,20) +\n  coord_polar(start = 0) +\n  theme_minimal() +\n  theme(\n    axis.text = element_blank (),\n    axis.title = element_blank(),\n    panel.grid = element_blank (),\n    plot.margin = unit(rep(-1,4), \"cm\")  )+   \n  labs(fill = \"RowNames\", y = \"tcga_circle\", x = NULL) +\n  theme(legend.title = element_blank()) +\n  geom_text(data=label_data, \n            aes(x=id, y=tcga_circle+10, label=RowNames, hjust=hjust), \n            color=\"black\", fontface=\"bold\",alpha=0.6, size=2.5, \n            angle= label_data$angle, inherit.aes = FALSE )\n\np\n\n\n\n\n\n\n\nFigureÂ 3: Add a gap\n\n\n\n\n\nThis circular bar chart describes the expression values of different genes in a sample of liver cancer.\n\n\n\n2. Grouping\n\n2.1 Add gaps between groups\nTaking iris data as an example\n\niris_id &lt;- iris[order(iris$Species),]\niris_id$new_column &lt;- 1:nrow(iris_id)\n# Add gaps\nempty_bar &lt;- 4\nto_add &lt;- data.frame( matrix(NA, empty_bar*nlevels(iris_id$Species), ncol(iris_id)) )\n\ncolnames(to_add) &lt;- colnames(iris_id)\nto_add$Species &lt;- rep(levels(iris_id$Species), each=empty_bar)\niris_id &lt;- rbind(iris_id, to_add)\niris_id &lt;- iris_id %&gt;% arrange(Species)\niris_id$new_column &lt;- seq(1, nrow(iris_id))\n# Plot\niris_id$new_column&lt;-as.factor(iris_id$new_column)\np &lt;- ggplot(iris_id, aes(x = new_column, y = Sepal.Length,fill = Species)) +\n  geom_bar(stat = \"identity\") +\n  ylim(-20,10) +\n  coord_polar(start = 0) +\n  theme_minimal() +\n  theme(\n    axis.text = element_blank (),\n    axis.title = element_blank(),\n    panel.grid = element_blank (),\n    plot.margin = unit(rep(-1,4), \"cm\")  )+   \n  labs(fill = \"Species\", y = \"Sepal.Length\", x = NULL) +\n  theme(legend.title = element_blank()) \n\np\n\n\n\n\n\n\n\nFigureÂ 4: Add gaps between groups\n\n\n\n\n\nThis circular bar chart describes the quantitative relationships of the Sepal.Length variable among different species.\n\n\n2.2 Arranged by group size\nTaking self-built data as an example\n\n# Create gaps between each group\nempty_bar &lt;- 4\nto_add &lt;- data.frame( matrix(NA, empty_bar*nlevels(data_customize$group), ncol(data_customize)) )\ncolnames(to_add) &lt;- colnames(data_customize)\nto_add$group &lt;- rep(levels(data_customize$group), each=empty_bar)\ndata_customize_id &lt;- rbind(data_customize, to_add)\ndata_customize_id &lt;- data_customize_id %&gt;% arrange(group,value)\ndata_customize_id$id &lt;- seq(1, nrow(data_customize_id))\n\n# Add labels\nlabel_data2 &lt;- data_customize_id\nnumber_of_bar &lt;- nrow(label_data2)\nangle &lt;- 90 - 360 * (label_data2$id-0.5) /number_of_bar    \nlabel_data2$hjust &lt;- ifelse( angle &lt; -90, 1, 0)\nlabel_data2$angle &lt;- ifelse(angle &lt; -90, angle+180, angle)\n\n# Plot\ndata_customize_id$id &lt;- as.factor(data_customize_id$id)\np &lt;- ggplot(data_customize_id, aes(x=id, y=value, fill=group)) +       \n  geom_bar(stat=\"identity\", alpha=0.5) +\n  ylim(-100,120) +\n  theme_minimal() +\n  theme(\n    legend.position = \"none\",\n    axis.text = element_blank(),\n    axis.title = element_blank(),\n    panel.grid = element_blank(),\n    plot.margin = unit(rep(-1,4), \"cm\") \n  ) +\n  coord_polar() + \n  geom_text(data=label_data2, \n            aes(x=id, y=value+10, label=individual, hjust=hjust), \n            color=\"black\", fontface=\"bold\",alpha=0.6, size=2.5, \n            angle= label_data2$angle, inherit.aes = FALSE )\n\np\n\n\n\n\n\n\n\nFigureÂ 5: Arranged by group size\n\n\n\n\n\nThis circular bar plot describes the numerical value of different IDs.\n\n\n\n3. Beautify plot\n\n# Set the number of \"empty columns\" to add at the end of each group.\ndata_customize_id &lt;- data_customize\nempty_bar &lt;- 3\nto_add &lt;- data.frame(matrix(NA, empty_bar*nlevels(data_customize$group),\n                            ncol(data_customize)))\ncolnames(to_add) &lt;- colnames(data_customize)\nto_add$group &lt;- rep(levels(data_customize_id$group), each=empty_bar)\ndata_customize_id &lt;- rbind(data_customize, to_add)\ndata_customize_id &lt;- data_customize_id %&gt;% arrange(group)\ndata_customize_id$id &lt;- seq(1, nrow(data_customize_id))\n\n# Get the name and y position of each label\nlabel_data &lt;- data_customize_id\nnumber_of_bar &lt;- nrow(label_data)\nangle &lt;- 90 - 360 * (label_data2$id-0.5) /number_of_bar    \nlabel_data$hjust &lt;- ifelse( angle &lt; -90, 1, 0)\nlabel_data$angle &lt;- ifelse(angle &lt; -90, angle+180, angle)\n\n# Prepare the baseline data frame\nbase_data &lt;- data_customize_id %&gt;% \n  group_by(group) %&gt;% \n  summarize(start=min(id), end=max(id) - empty_bar) %&gt;% \n  rowwise() %&gt;% \n  mutate(title=mean(c(start, end)))\n\n# Prepare grid data frame (scale)\ngrid_data &lt;- base_data\ngrid_data$end &lt;- grid_data$end[ c( nrow(grid_data), 1:nrow(grid_data)-1)] + 1\ngrid_data$start &lt;- grid_data$start - 1\ngrid_data &lt;- grid_data[-1,]\n\n# Plot\np &lt;- ggplot(data_customize_id, aes(x=as.factor(id), y=value, fill=group)) +        \n  geom_bar(aes(x=as.factor(id), y=value, fill=group), stat=\"identity\", alpha=0.5) +\n  geom_segment(data=grid_data, aes(x = end, y = 80, xend = start, yend = 80), colour = \"grey\", alpha=1, size=0.3 , inherit.aes = FALSE ) +\n  geom_segment(data=grid_data, aes(x = end, y = 60, xend = start, yend = 60), colour = \"grey\", alpha=1, size=0.3 , inherit.aes = FALSE ) +\n  geom_segment(data=grid_data, aes(x = end, y = 40, xend = start, yend = 40), colour = \"grey\", alpha=1, size=0.3 , inherit.aes = FALSE ) +\n  geom_segment(data=grid_data, aes(x = end, y = 20, xend = start, yend = 20), colour = \"grey\", alpha=1, size=0.3 , inherit.aes = FALSE ) +\n  annotate(\"text\", x = rep(max(data$id),4), y = c(20, 40, 60, 80), label = c(\"20\", \"40\", \"60\", \"80\") , color=\"grey\", size=3 , angle=0, fontface=\"bold\", hjust=1) + \n  geom_bar(aes(x=as.factor(id), y=value, fill=group), stat=\"identity\", alpha=0.5) +\n  ylim(-100,120) +\n  theme_minimal() +\n  theme(\n    legend.position = \"none\",\n    axis.text = element_blank(),\n    axis.title = element_blank(),\n    panel.grid = element_blank(),\n    plot.margin = unit(rep(-1,4), \"cm\") \n  ) +\n  coord_polar() + \n  geom_text(data=label_data, aes(x=id, y=value+10, label=individual, hjust=hjust), color=\"black\", fontface=\"bold\",alpha=0.6, size=2.5, angle= label_data$angle, inherit.aes = FALSE ) +\n\n# Add baseline information\n  geom_segment(data=base_data, aes(x = start, y = -5, xend = end, yend = -5), colour = \"black\", alpha=0.8, size=0.6 , inherit.aes = FALSE )  +\n  geom_text(data=base_data, aes(x = title, y = -18, label=group), hjust=c(1,1,0,0), colour = \"black\", alpha=0.8, size=4, fontface=\"bold\", inherit.aes = FALSE)\n\np\n\n\n\n\n\n\n\nFigureÂ 6: Beautify plot\n\n\n\nThis circular bar chart describes the numerical value of different IDs.",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Circular Barplot"
    ]
  },
  {
    "objectID": "Ranking/CircularBarplot.html#applications",
    "href": "Ranking/CircularBarplot.html#applications",
    "title": "Circular Barplot",
    "section": "Applications",
    "text": "Applications\n\n\n\n\n\n\nFigureÂ 7: Applications of Circular Barplot\n\n\n\nThis circular bar chart, based on family whole-genome data from Corpas et al., visualizes all genetic variations on human chromosome 21. [1]",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Circular Barplot"
    ]
  },
  {
    "objectID": "Ranking/CircularBarplot.html#reference",
    "href": "Ranking/CircularBarplot.html#reference",
    "title": "Circular Barplot",
    "section": "Reference",
    "text": "Reference\n[1] Parveen A, Khurana S, Kumar A. Overview of Genomic Tools for Circular Visualization in the Next-generation Genomic Sequencing Era. Curr Genomics. 2019 Feb;20(2):90-99.",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Circular Barplot"
    ]
  },
  {
    "objectID": "Ranking/Parallel.html",
    "href": "Ranking/Parallel.html",
    "title": "Parallel Coordinates Plot",
    "section": "",
    "text": "Parallel coordinate plots are a common method for visualizing high-dimensional multivariate data. To display a set of objects in a multidimensional space, multiple parallel and equally spaced axes are drawn, and the objects in the multidimensional space are represented as broken lines with vertices on the parallel axes. Although parallel line plots are a special type of line plot, they differ significantly from ordinary line plots. This is because parallel line plots are not limited to describing changes in one or a few trends. Parallel coordinate plots can be used to describe specific numerical values at different time points in a time series, at different gradients of reaction concentrations, and so on.",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Parallel Coordinates Plot"
    ]
  },
  {
    "objectID": "Ranking/Parallel.html#example",
    "href": "Ranking/Parallel.html#example",
    "title": "Parallel Coordinates Plot",
    "section": "Example",
    "text": "Example\n\n\n\n\n\nThe position of a vertex on each axis corresponds to the variable value of that object along that dimension. This parallel coordinates plot, based on the Iris dataset, uses four variables (sepal and petal length and width) as the vertical axis. Each line represents a data point (a flower sample), and the line color indicates the flower category (Setosa, Versicolor, Virginica). Lines pass through the points on each axis, showing the sampleâ€™s value on each variable. By observing the trends and intersections of these lines, you can see the differences or similarities between different flower categories on these variables. If the lines do not cross, it means that the groups have similar performance on these variables; if they cross frequently, it means that the groups differ significantly on these variables.",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Parallel Coordinates Plot"
    ]
  },
  {
    "objectID": "Ranking/Parallel.html#setup",
    "href": "Ranking/Parallel.html#setup",
    "title": "Parallel Coordinates Plot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming Language: R\nDependencies: GGally; hrbrthemes; viridis; dplyr; tidyr; tibble; ggbump; RColorBrewer; patchwork; MASS\n\n\n# Install packages\nif (!requireNamespace(\"GGally\", quietly = TRUE)) {\n  install.packages(\"GGally\")\n}\nif (!requireNamespace(\"hrbrthemes\", quietly = TRUE)) {\n  install.packages(\"hrbrthemes\")\n}\nif (!requireNamespace(\"viridis\", quietly = TRUE)) {\n  install.packages(\"viridis\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"tidyr\", quietly = TRUE)) {\n  install.packages(\"tidyr\")\n}\nif (!requireNamespace(\"tibble\", quietly = TRUE)) {\n  install.packages(\"tibble\")\n}\nif (!requireNamespace(\"ggbump\", quietly = TRUE)) {\n  install.packages(\"ggbump\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\nif (!requireNamespace(\"patchwork\", quietly = TRUE)) {\n  install.packages(\"patchwork\")\n}\nif (!requireNamespace(\"MASS\", quietly = TRUE)) {\n  install.packages(\"MASS\")\n}\n\n# Load packages\nlibrary(GGally)\nlibrary(hrbrthemes)\nlibrary(viridis)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(tibble)\nlibrary(ggbump)\nlibrary(RColorBrewer)\nlibrary(patchwork)\nlibrary(MASS)",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Parallel Coordinates Plot"
    ]
  },
  {
    "objectID": "Ranking/Parallel.html#data-preparation",
    "href": "Ranking/Parallel.html#data-preparation",
    "title": "Parallel Coordinates Plot",
    "section": "Data Preparation",
    "text": "Data Preparation\nWe used the R dataset iris and the TCGA-CHOL.methylation450.tsv from the UCSC Xena website (UCSC Xena (xenabrowser.net)).\n\n# iris\ndata_iris &lt;- iris\ndata_iris &lt;- data_iris %&gt;%\n  group_by(Species) %&gt;%\n  sample_n(size = 20, replace = FALSE)\n\n# TCGA-CHOL.methylation450\nmethylation_raw &lt;- readr::read_tsv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/TCGA-CHOL.methylation450_.tsv\")\nmethylation_selected &lt;- methylation_raw[c(5,7,11),c(4:6)]\nrownames(methylation_selected) &lt;- c(\"cg236\", \"cg292\", \"cg658\")\ncolnames(methylation_selected) &lt;- substr(colnames(methylation_selected), 9, 12)\ndata_tcga &lt;- methylation_selected %&gt;%\n  rownames_to_column(var = \"Composite\") %&gt;%\n  pivot_longer(cols = -Composite, names_to = \"sample\", values_to = \"value\")\ndata_tcga &lt;- data_tcga %&gt;%\n  mutate(sample = as.numeric(factor(sample))) # Convert the sample to a numerical value",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Parallel Coordinates Plot"
    ]
  },
  {
    "objectID": "Ranking/Parallel.html#visualization",
    "href": "Ranking/Parallel.html#visualization",
    "title": "Parallel Coordinates Plot",
    "section": "Visualization",
    "text": "Visualization\n\n1. Basic Plotting\nUse the ggparcoord() function of the ggally package, which is an extension of the ggplot2 package, to draw parallel plots.\n\n1.1 Basic parallel graph\nThe input dataset must be a data frame with multiple numeric variables, each of which is used as the vertical axis on the plot. The number of columns for these variables is specified in the columns argument of the function. Here, the categorical variables used to color the lines are specified in the groupColumn argument.\n\n# Basic parallel graph\np &lt;- ggparcoord(data_iris, columns = 1:4, groupColumn = 5) \n\np\n\n\n\n\n\n\n\nFigureÂ 1: Basic parallel graph\n\n\n\n\n\nThis parallel coordinate graph shows the relationship between sepal length, sepal width, petal length, and petal width in the iris dataset. Each line represents a sample, and the flower category specified by groupColumn is used to distinguish the colors of the lines.\n\n\n1.2 Customize colors, themes, and overall appearance\nThis chart is essentially the same as the previous one, but with the following customizations:\n\nUse the viridis package to change the palette colors\nUse title to add a title and customize theme\nUse showPoints to add points\nUse alphaLines to change the line transparency\nUse theme_ipsum() to use the theme\n\n\n# Customize colors, themes, and overall appearance\np &lt;- ggparcoord(data_iris,\n           columns = 1:4, groupColumn = 5, order = \"anyClass\",\n           showPoints = TRUE, \n           title = \"Parallel Coordinate Plot for the Iris Data\",\n           alphaLines = 0.3) + \n  scale_color_viridis(discrete=TRUE) +\n  theme_ipsum()+\n  theme(plot.title = element_text(size=10))\n\np\n\n\n\n\n\n\n\nFigureÂ 2: Customize colors, themes, and overall appearance\n\n\n\n\n\nThis parallel coordinates plot shows the relationship between sepal length, sepal width, petal length, and petal width in the iris dataset. Custom images are used to make the image more beautiful and easy to read.\n\n\n1.3 Standardization\nStandardization transforms raw data so that it can be compared with other variables. This is a crucial step in comparing variables that do not have the same units.\nThe ggally package provides a scale parameter scale. Below are four possible options applied to the same dataset:\n\nglobalminmax â†’ No normalization\nuniminmax â†’ Normalize to minimum = 0 and maximum = 1\nstd â†’ Univariate normalization (subtract mean and divide by standard deviation)\ncenter â†’ Normalize and center the variable (variables are centered at zero)\n\n\n# No standardization\np1 &lt;- ggparcoord(data_iris,\n    columns = 1:4, groupColumn = 5, order = \"anyClass\",\n    scale=\"globalminmax\",\n    showPoints = TRUE, \n    title = \"No scaling\",\n    alphaLines = 0.3\n    ) + \n  scale_color_viridis(discrete=TRUE) +\n  theme_ipsum()+\n  theme(\n    legend.position=\"none\",\n    plot.title = element_text(size=13)\n  ) +\n  xlab(\"\")\n\n# Standardize to Min = 0 and Max = 1\np2 &lt;- ggparcoord(data_iris,\n    columns = 1:4, groupColumn = 5, order = \"anyClass\",\n    scale=\"uniminmax\",\n    showPoints = TRUE, \n    title = \"Standardize to Min = 0 and Max = 1\",\n    alphaLines = 0.3\n    ) + \n  scale_color_viridis(discrete=TRUE) +\n  theme_ipsum()+\n  theme(\n    legend.position=\"none\",\n    plot.title = element_text(size=13)\n  ) +\n  xlab(\"\")\n\n# Normalize univariately\np3 &lt;- ggparcoord(data_iris,\n    columns = 1:4, groupColumn = 5, order = \"anyClass\",\n    scale=\"std\",\n    showPoints = TRUE, \n    title = \"Normalize univariately (substract mean & divide by sd)\",\n    alphaLines = 0.3\n    ) + \n  scale_color_viridis(discrete=TRUE) +\n  theme_ipsum()+\n  theme(\n    legend.position=\"none\",\n    plot.title = element_text(size=13)\n  ) +\n  xlab(\"\")\n\n# Standardize and center variables\np4 &lt;- ggparcoord(data_iris,\n    columns = 1:4, groupColumn = 5, order = \"anyClass\",\n    scale=\"center\",\n    showPoints = TRUE, \n    title = \"Standardize and center variables\",\n    alphaLines = 0.3\n    ) + \n  scale_color_viridis(discrete=TRUE) +\n  theme_ipsum()+\n  theme(\n    legend.position=\"none\",\n    plot.title = element_text(size=13)\n  ) +\n  xlab(\"\")\n\np1 + p2 + p3 + p4 + plot_layout(ncol = 2)\n\n\n\n\n\n\n\nFigureÂ 3: Standardization\n\n\n\n\n\nThese four plots show the effects of different normalization methods on the iris dataset:\n\nNo scalingï¼šDisplays the original data, with each variable retaining its original range. Variables with larger differences in numerical ranges are more significant.\nStandardize to Min = 0 and Max = 1ï¼šThe values of all variables are scaled to the same range (0 to 1) to facilitate comparison of the changing trends of different variables.\nNormalize univariatelyï¼šEach variable was standardized to have a mean of 0 and a standard deviation of 1 to highlight the relative differences in the data.\nStandardize and center variablesï¼šThe data were mean-centered to highlight the relative differences between different groups on each variable.\n\nThese graphs use colors to distinguish different flower species, and lines to represent the values of each sample on different variables.\n\n\n1.4 Highlight Group\nIf you are interested in a specific group, you can highlight different categories by changing their colors:\n\n# Highlight Group\np &lt;- data_iris %&gt;%\n  arrange(desc(Species)) %&gt;%\n  ggparcoord(\n    columns = 1:4, groupColumn = 5, order = \"anyClass\",\n    showPoints = TRUE, \n    title = \"Original\",\n    alphaLines = 1\n    ) + \n  scale_color_manual(values=c( \"#69b3a2\", \"#E8E8E8\", \"#E8E8E8\") ) + # Highlight specific groups by changing the colors of different categories\n  theme_ipsum()+\n  theme(\n    legend.position=\"Default\",\n    plot.title = element_text(size=10)\n  ) +\n  xlab(\"\")\n\np\n\n\n\n\n\n\n\nFigureÂ 4: Highlight Group\n\n\n\n\n\nThis figure shows how different flower species from the iris dataset perform on four features (sepal length, sepal width, petal length, and petal width). Parallel coordinates are used to display the values of each sample on these variables. By sorting and coloring the samples in descending order by species, the Setosa species is highlighted in green, while the other two species are shown in gray. The lines represent the samples, showing how their values vary across the different features.\n\n\n\n2. MASS package\n\n2.1 Basic parallel plots (MASS package)\nUse the MASS package to construct a parallel coordinates plot. Note that using ggplot2 might be a better choice.\n\nmy_colors &lt;- colors()[as.numeric(data_iris$Species) * 11]\nparcoord(data_iris[, c(1:4)], col = my_colors)\n\n\n\n\n\n\n\nFigureÂ 5: MASS package\n\n\n\n\n\nThis figure is a parallel coordinate plot of the Iris dataset, showing the distribution of the four variables in the dataset (sepal length, sepal width, petal length, and petal width). Different flower species are distinguished by different colors. By observing the trends of the different colored lines, we can see the different patterns of these variables among different flower species.\n\n\n2.2 Add legend\nUse legend() to add a legend.\n\nmy_colors &lt;- colors()[as.numeric(data_iris$Species) * 11]\nparcoord(data_iris[, c(1:4)], col = my_colors)\n\nlegend(\"topright\", \n       legend = levels(data_iris$Species), \n       col = unique(my_colors), \n       pch = 1) # Add legend\n\n\n\n\n\n\n\nFigureÂ 6: Add legend\n\n\n\n\n\nThis figure is a parallel coordinate plot of the Iris dataset, showing the distribution of the four variables in the dataset (sepal length, sepal width, petal length, and petal width). Different flower species are distinguished by different colors, and a legend is provided. By observing the trends of the different colored lines, you can see the different patterns of these variables for each flower species.\n\n\n2.3 Reorder variables\nIt is very important to find the optimal order of variables in the parallel coordinates plot. To change it, just change the order in the input dataset.\n\npalette &lt;- brewer.pal(3, \"Set1\") \nmy_colors &lt;- palette[as.numeric(data_iris$Species)]\n\nparcoord(data_iris[,c(1,3,4,2)] , col= my_colors)\n\n\n\n\n\n\n\nFigureÂ 7: Reorder variables\n\n\n\n\n\nThis figure is a parallel coordinate plot of the Iris dataset, showing the distribution of four variables: sepal length, petal length, petal width, and sepal width. Different flower species are represented by three different colors. By observing the changes in the color lines, we can see the different trends in these variables among different flower species. Reordering the variables in the input dataset reorders the variables.\n\n\n2.4 Highlight Group\nIf you are interested in a specific group, you can change the color to highlight that group.\n\nisSetosa &lt;- ifelse(data_iris$Species==\"setosa\",\"red\",\"grey\")\nparcoord(data_iris[,c(1,3,4,2)] , col=isSetosa)\n\n\n\n\n\n\n\nFigureÂ 8: Highlight Group\n\n\n\n\n\nThis graph is a parallel coordinate plot of the Iris dataset, where setosa is shown in red and other species in gray. This graph visually illustrates the differences in sepal length, petal length, petal width, and sepal width between setosa and other species.\n\n\n\n3. Bump plot\nA bump plot is a type of chart that can visually display trends and is often used to compare different categories of data.\n\n3.1 Basic bump plot\n\np &lt;- ggplot(data_tcga, aes(x = sample, y = value, color = Composite)) +  \n  geom_bump(size = 2) +  \n  theme_minimal()\np\n\n\n\n\n\n\n\nFigureÂ 9: Basic bump plot\n\n\n\n\n\nThis figure shows the methylation trends of different composites (cg236, cg292, and cg658) across different samples. The colors distinguish the different composite groups, and the lines represent each groupâ€™s performance across different samples. The fluctuations of the lines reveal the trend and relative differences in the values of each group across samples.\n\n\n3.2 Change color\nIt is possible to add individual points to a bump map. This can be achieved by adding a geom_point() layer. Bump maps are drawn using the ggbump package.\n\np &lt;- ggplot(data_tcga, aes(x = sample, y = value, color = Composite)) +  \n  geom_bump(size = 2) +  \n  geom_point(size = 6) +  \n  scale_color_brewer(palette = \"Paired\") +  \n  theme_minimal()\np\n\n\n\n\n\n\n\nFigureÂ 10: Change color\n\n\n\n\n\nThis graph shows the methylation trends of different composites (cg236, cg292, and cg658) across different samples. Colors are used to distinguish different composite groups, and lines represent the performance of each group across different samples. The fluctuations of the lines reveal the trend and relative differences in the values of each group across samples. Adding points and changing the colors makes the graph more visually appealing and easy to read.\n\n\n3.3 Add labels and titles\ngeom_text() and the function labs() can be used to add labels and titles to plots.\n\np &lt;- ggplot(data_tcga, aes(x = sample, y = value, color = Composite)) +  \n  geom_bump(size = 2) +  \n  geom_point(size = 6) +  \n  geom_text(aes(label = Composite), nudge_y = -0.01, fontface = \"bold\", size=3) + \n  scale_color_brewer(palette = \"Paired\") +  \n  theme_minimal() +  \n  labs(title = \"Bump Plot of Methylation Values\",    \n     x = \"Sample\", y = \"Value\")\np\n\n\n\n\n\n\n\nFigureÂ 11: Add labels and titles\n\n\n\n\n\nThis figure shows the methylation variation of different composites (cg236, cg292, and cg658) across different samples. The lines represent the numerical trend of each composite across samples, the dots represent the specific values, and the labels indicate the compositeâ€™s name. The colors distinguish the different composites, and the fluctuations in their values across samples can be seen through the lines.",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Parallel Coordinates Plot"
    ]
  },
  {
    "objectID": "Ranking/Parallel.html#applications",
    "href": "Ranking/Parallel.html#applications",
    "title": "Parallel Coordinates Plot",
    "section": "Applications",
    "text": "Applications\n\n1. Basic Parallel Graph\n\n\n\n\n\n\nFigureÂ 12: Applications of basic parallel graph 1\n\n\n\nPerformance of different parameter sets for mutation, b-factor, and motion prediction. [1]\n\n\n\n\n\n\nFigureÂ 13: Applications of Basic parallel graph 2\n\n\n\nSelecting the optimal healthcare center in a mixed transportation network using (a) a parallel coordinate plot, (b) a bivariate geographic map, and (c) a space-filling raster. (Note: Two variables, total cost and travel cost, are visualized in the space-filling raster. Total cost is represented by a gray-to-purple color ramp, and travel cost is sorted from left to right and from bottom to top using a sweeping line.) [2]\n\n\n2. Faceted Parallel Graph\n\n\n\n\n\n\nFigureÂ 14: Applications of faceted parallel graph\n\n\n\nParallel plots illustrate cluster analysis of genes exhibiting Depot*[Dex] interactions. [3]",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Parallel Coordinates Plot"
    ]
  },
  {
    "objectID": "Ranking/Parallel.html#reference",
    "href": "Ranking/Parallel.html#reference",
    "title": "Parallel Coordinates Plot",
    "section": "Reference",
    "text": "Reference\n[1] Frappier V, Najmanovich RJ. A coarse-grained elastic network atom contact model and its use in the simulation of protein dynamics and the prediction of the effect of mutations. PLoS Comput Biol. 2014 Apr 24;10(4):e1003569. doi: 10.1371/journal.pcbi.1003569. PMID: 24762569; PMCID: PMC3998880.\n[2] Jia T, Tao H, Qin K, Wang Y, Liu C, Gao Q. Selecting the optimal healthcare centers with a modified P-median model: a visual analytic perspective. Int J Health Geogr. 2014 Oct 22;13:42. doi: 10.1186/1476-072X-13-42. PMID: 25336302; PMCID: PMC4293817.\n[3] Pickering RT, Lee MJ, Karastergiou K, Gower A, Fried SK. Depot Dependent Effects of Dexamethasone on Gene Expression in Human Omental and Abdominal Subcutaneous Adipose Tissues from Obese Women. PLoS One. 2016 Dec 22;11(12):e0167337. doi: 10.1371/journal.pone.0167337. PMID: 28005982; PMCID: PMC5179014.\n[4] Schloerke, B., Crowley, J., Cook, D., Hofmann, H., Wickham, H. (2021). GGally: Extension to â€˜ggplot2â€™. https://cran.r-project.org/package=GGally\n[5] Rudis, B. (2020). hrbrthemes: Additional Themes and Theme Components for â€˜ggplot2â€™. https://cran.r-project.org/package=hrbrthemes\n[6] Garnier, S. (2018). viridis: Colorblind-Friendly Color Maps for R. https://cran.r-project.org/package=viridis\n[7] Wickham, H., FranÃ§ois, R., Henry, L., MÃ¼ller, K. (2023). dplyr: A Grammar of Data Manipulation. https://cran.r-project.org/package=dplyr\n[8] Wickham, H., Henry, L. (2023). tidyr: Tidy Messy Data. https://cran.r-project.org/package=tidyr\n[9] MÃ¼ller, K. (2023). tibble: Simple Data Frames. https://cran.r-project.org/package=tibble\n[10] Aumayr, A., & MÃ¼nch, B. (2022). ggbump: Bump Charts with ggplot2. https://cran.r-project.org/package=ggbump\n[11] Neuwirth, E. (2023). RColorBrewer: ColorBrewer Palettes. https://cran.r-project.org/package=RColorBrewer",
    "crumbs": [
      "<i class='fa-solid fa-arrow-up-a-z'></i> Ranking",
      "Parallel Coordinates Plot"
    ]
  },
  {
    "objectID": "Correlation/Density2D.html",
    "href": "Correlation/Density2D.html",
    "title": "2D Density",
    "section": "",
    "text": "A 2D density plot shows the distribution of a combination of two numerical variables, using color gradients (or contour lines) to indicate the number of observations within an area. This can be used to identify trends in a dataset and analyze relationships between two variables. Scatter plots can be difficult to interpret when displaying large datasets because the points overlap and cannot be individually distinguished. In these cases, a two-dimensional density plot is useful.",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "2D Density"
    ]
  },
  {
    "objectID": "Correlation/Density2D.html#example",
    "href": "Correlation/Density2D.html#example",
    "title": "2D Density",
    "section": "Example",
    "text": "Example\n\n\n\n\n\nThis figure shows the two-dimensional kernel density distribution of TP53 and MDM2 gene expression values. The fill colors of the grid provide a visual representation of the sample density (i.e., number of samples) for different combinations of TP53 and MDM2 values. Darker colors indicate lower sample density in that area, while lighter colors indicate higher sample density. This visualization helps identify patterns in gene expression and potential correlations.",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "2D Density"
    ]
  },
  {
    "objectID": "Correlation/Density2D.html#setup",
    "href": "Correlation/Density2D.html#setup",
    "title": "2D Density",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming Language: R\nDependencies: ggplot2, RColorBrewer, hexbin, MASS, plotly, mvtnorm, patchwork\n\n\n# Install packages\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\nif (!requireNamespace(\"hexbin\", quietly = TRUE)) {\n  install.packages(\"hexbin\")\n}\nif (!requireNamespace(\"MASS\", quietly = TRUE)) {\n  install.packages(\"MASS\")\n}\nif (!requireNamespace(\"plotly\", quietly = TRUE)) {\n  install.packages(\"plotly\")\n}\nif (!requireNamespace(\"mvtnorm\", quietly = TRUE)) {\n  install.packages(\"mvtnorm\")\n}\nif (!requireNamespace(\"patchwork\", quietly = TRUE)) {\n  install.packages(\"patchwork\")\n}\n\n# Load packages\nlibrary(ggplot2)\nlibrary(RColorBrewer)\nlibrary(hexbin)\nlibrary(MASS)\nlibrary(plotly)\nlibrary(mvtnorm)\nlibrary(patchwork)",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "2D Density"
    ]
  },
  {
    "objectID": "Correlation/Density2D.html#data-preparation",
    "href": "Correlation/Density2D.html#data-preparation",
    "title": "2D Density",
    "section": "Data Preparation",
    "text": "Data Preparation\nUse the R built-in dataset mtcars and the TCGA-BRCA.star_counts.tsv dataset from CSC Xena DATASETS.\n\n# mtcars\ndata_mtcars &lt;- mtcars[, c(\"mpg\", \"hp\")]\n\n# TCGA-BRCA.star_counts\ntcga_raw &lt;- readr::read_tsv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/TCGA-BRCA.star_counts.tsv\")\n\ntcga_tp53_mdm2 &lt;- tcga_raw[tcga_raw$Ensembl_ID %in% c(\"ENSG00000141510.18\", \"ENSG00000131747.15\"), ]\nTP53_values &lt;- tcga_tp53_mdm2[1, -1]\nMDM2_values &lt;- tcga_tp53_mdm2[2, -1]\n\ndata_tcga &lt;- data.frame(TP53 = as.numeric(TP53_values),\n                        MDM2 = as.numeric(MDM2_values))",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "2D Density"
    ]
  },
  {
    "objectID": "Correlation/Density2D.html#visualization",
    "href": "Correlation/Density2D.html#visualization",
    "title": "2D Density",
    "section": "Visualization",
    "text": "Visualization\n\n1. 2D Histogram\n2D histogram are used to analyze the relationship between two variables. The plot area is divided into multiple bins. Use geom_bin_2d() to draw a 2D histogram. This function provides a bins parameter to control the number of bins to display. bins determines how much data is contained in each bin. Changing bins can significantly affect the graph and the intended message.\n\n# 2D Histogram\np &lt;- ggplot(data_tcga, aes(x = TP53, y = MDM2)) +\n  geom_bin2d() +\n  labs(fill = \"Gene_expression\\n(STAR_counts)\") + \n  theme_bw()\n\np\n\n\n\n\n\n\n\nFigureÂ 1: 2D Histogram\n\n\n\n\n\nThis figure shows a 2D histogram plot of TP53 and MDM2 gene expression. The color depth represents the number of data points in each region, clearly demonstrating the data distribution and density. Darker colors indicate lower sample density in that region, while lighter colors indicate higher sample density.\n\n# Modify bins + palette\np1 &lt;- \n  ggplot(data_tcga, aes(x = TP53, y = MDM2)) +\n  geom_bin2d(bins = 40) +\n  scale_fill_continuous(type = \"viridis\") +\n  labs(fill = \"Gene_expression\\n(STAR_counts)\") + \n  theme_bw()\n\n# Remove grid lines + customize colors\np2 &lt;- \n  ggplot(data_tcga, aes(x = TP53, y = MDM2)) +\n  geom_bin2d(bins = 40) +\n  scale_fill_gradient(low = \"blue\", high = \"red\") + \n  labs(fill = \"Gene_expression\\n(STAR_counts)\") + \n  theme_bw() +\n  theme(panel.grid.major = element_blank(), \n        panel.grid.minor = element_blank())\np1+p2\n\n\n\n\n\n\n\nFigureÂ 2: Change Color\n\n\n\n\n\nThis figure shows a 2D histogram of TP53 and MDM2 gene expression. The bin parameters and colors have been modified to make the graph more aesthetically pleasing and convey more effective information. The left figure gradually changes from purple to yellow as the data increases, while the right figure gradually changes from blue to red.\n\n\n2. Interactive 2D Histogram\nUse the mvtnorm package and the plotly package to draw an interactive 2D histogram.\n\nfig &lt;- plot_ly(data_tcga, x = ~TP53, y = ~MDM2)\nfig2 &lt;- subplot(\n  fig %&gt;% add_histogram2d()\n)\n\nfig2\n\n\n\n\n\n\n\nFigureÂ 3: Interactive 2D Histogram\n\n\n\n\nThis figure shows a 2D histogram of TP53 and MDM2. The grid changes from purple to yellow as the data increases. The interactive graph allows users to hover over different areas to view specific density values and quantities, providing more detailed information.\nUse the mtcars dataset from R.\n\n# Changing bins + palette\nfig &lt;- plot_ly(data_mtcars, x = ~mpg, y = ~hp)\nfig2 &lt;- fig %&gt;% add_histogram2d(colorscale = \"Blues\", nbinsx = 5, nbinsy = 6)\n\nfig2\n\n\n\n\n\n\n\nFigureÂ 4: Use the mtcars dataset from R\n\n\n\n\nThis figure plots a 2D histogram of mpg (miles per gallon) and hp (horsepower) from the mtcars dataset, with the blue color becoming lighter as the data increases. The interactive graph allows users to hover over different areas to view specific density values and quantities, making it easier to obtain more detailed information.\n\n\n3. Hexagonal plot\nA hexagonal plot is a chart type used to visualize the distribution of two-dimensional data. It divides the data into small hexagonal regions along the coordinate axis and colors each region differently based on the number of data points. Use the geom_hex() function to draw a hexagonal box plot.\n\n# Hexagonal plot\np &lt;- \n  ggplot(data_tcga, aes(x = TP53, y = MDM2)) +\n  geom_hex() +\n  labs(fill = \"Gene_expression\\n(STAR_counts)\") + \n  theme_bw()\np\n\n\n\n\n\n\n\nFigureÂ 5: Hexagonal plot\n\n\n\n\n\nThis hexagonal plot shows the relationship between TP53 and MDM2 gene expression. Darker colors indicate lower sample density in that area, while lighter colors indicate higher sample density.\n\n# Modify bins + palette\np &lt;- \n  ggplot(data_tcga, aes(x = TP53, y = MDM2)) +\n  geom_hex(bins = 40) +\n  scale_fill_continuous(type = \"viridis\") +\n  labs(fill = \"Gene_expression\\n(STAR_counts)\") + \n  theme_bw()\np\n\n\n\n\n\n\n\nFigureÂ 6: Modify bins + palette\n\n\n\n\n\nThis hexagonal plot shows the relationship between TP53 and MDM2 gene expression. The bins parameters and colors have been modified to make the graph more beautiful and more effective in conveying information.\nUse the hexbin package to draw hexagonal plots.\n\n# Use the `hexbin` package to draw hexagonal plots\nbin &lt;- hexbin(TP53_values, MDM2_values, xbins=40)\nmy_colors = colorRampPalette(rev(brewer.pal(11,'Spectral')))\npar(mar = c(0, 0, 0, 10), pty = \"s\")\nplot(bin, main=\"\" , colramp = my_colors , legend = FALSE)\n\n\n\n\n\n\n\nFigureÂ 7: Use the hexbin package to draw hexagonal plots\n\n\n\n\n\nThis hexagonal plot uses the hexbin package to show the relationship between TP53 and MDM2 gene expression. A color palette is used to assign different colors to different value ranges, making the plot more aesthetically pleasing.\n\n\n4. 2D density plot\nA 2D density plot is a type of chart used to visualize the distribution and relationship between two variables. It represents the distribution of data points by plotting density contours or filling colors on a 2D plane. Use geom_density_2d or stat_density_2d to plot a 2D density plot.\n\n# Show outlines only\np1 &lt;- \n  ggplot(data_tcga, aes(x = TP53, y = MDM2)) +\n  geom_density_2d()\n\n# Show region colors only\np2 &lt;- \n  ggplot(data_tcga, aes(x = TP53, y = MDM2)) +\n  stat_density_2d(aes(fill = ..level..), geom = \"polygon\")\n\n# Outline + Area Colorè‰²\np3 &lt;- \n  ggplot(data_tcga, aes(x = TP53, y = MDM2)) +\n  stat_density_2d(aes(fill = ..level..), geom = \"polygon\", colour=\"white\")\n\np1+p2+p3\n\n\n\n\n\n\n\nFigureÂ 8: 2D density plot\n\n\n\n\n\nThis comparison chart provides a multi-level understanding of TP53 and MDM2 gene expression values, making it easy to quickly identify patterns and trends in the data. Two-dimensional isodensity lines help identify areas of varying density. Colors represent gene expression levels, with lighter colors indicating higher density, providing a visual representation of the data distribution.\n\n# 2D Kernel Density Plot\np &lt;- \n  ggplot(data_tcga, aes(x = TP53, y = MDM2)) +\n  stat_density_2d(aes(fill = ..density..), geom = \"raster\", contour = FALSE) +\n  scale_x_continuous(expand = c(0, 0)) +\n  scale_y_continuous(expand = c(0, 0)) +\n  theme(legend.position='none')\np\n\n\n\n\n\n\n\nFigureÂ 9: 2D Kernel Density Plot\n\n\n\n\n\nThis figure shows the two-dimensional kernel density distribution between the TP53 and MDM2 gene expression values. The expression level of the gene is represented by the depth of the color, and the lighter the color, the higher the density.\n\n\n5. Custom color palette\n2D histograms, hexagonal plots, and 2D density plots all have customizable colors. You can use the scale_fill_distiller() function to define the colors.\n\n# Custom color palette\np1 &lt;- \n  ggplot(data_tcga, aes(x = TP53, y = MDM2)) +\n  stat_density_2d(aes(fill = ..density..), geom = \"raster\", contour = FALSE) +\n  scale_fill_distiller(palette=4, direction=-1) +\n  scale_x_continuous(expand = c(0, 0)) +\n  scale_y_continuous(expand = c(0, 0)) +\n  theme(legend.position='none')\n\np2 &lt;- \n  ggplot(data_tcga, aes(x = TP53, y = MDM2)) +\n  stat_density_2d(aes(fill = ..density..), geom = \"raster\", contour = FALSE) +\n  scale_fill_distiller(palette=4, direction=1) + # Change the direction of the palette from first to last\n  scale_x_continuous(expand = c(0, 0)) +\n  scale_y_continuous(expand = c(0, 0)) +\n  theme(legend.position='none')\n\n# Use a palette by its name\np3 &lt;- \n  ggplot(data_tcga, aes(x = TP53, y = MDM2)) +\n  stat_density_2d(aes(fill = ..density..), geom = \"raster\", contour = FALSE) +\n  scale_fill_distiller(palette= \"Spectral\", direction=1) +\n  scale_x_continuous(expand = c(0, 0)) +\n  scale_y_continuous(expand = c(0, 0)) +\n  theme(legend.position='none')\n\np1+p2+p3\n\n\n\n\n\n\n\nFigureÂ 10: Custom color palette\n\n\n\n\n\nThis figure compares the two-dimensional density distribution of TP53 and MDM2 gene expression under different color palette settings. By comparing different color palettes, we can observe the differences in the visual expression of density maps and help choose a color scheme that is more suitable for displaying data characteristics.\n\n\n6. 3D density plot\nYou can transform the scatter plot data into a grid, calculate the number of data points at each position on the grid, and then instead of using gradient colors to represent this number, use a third dimension to indicate that some areas are more dense.\n\n# Computing KDE\nkd &lt;- with(data_tcga, MASS::kde2d(TP53, MDM2, n = 50))\n\nplot_ly(x = kd$x, y = kd$y, z = kd$z) %&gt;%\n  add_surface() %&gt;%\n  layout(scene = list(xaxis = list(title = \"TP53\"),\n                      yaxis = list(title = \"MDM2\"),\n                      zaxis = list(title = \"Density\")))\n\n\n\n\n\n\n\nFigureÂ 11: 3D density plot\n\n\n\n\nThis figure shows a 3D kernel density plot (KDE) of TP53 and MDM2 gene expression. Using the plotly package, users can interact with the plot, rotating and zooming the graph, analyzing the data in depth and gaining a more comprehensive understanding of variable relationships in complex datasets. Color and height simultaneously indicate the magnitude of the data.",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "2D Density"
    ]
  },
  {
    "objectID": "Correlation/Density2D.html#applications",
    "href": "Correlation/Density2D.html#applications",
    "title": "2D Density",
    "section": "Applications",
    "text": "Applications\n\n\n\n\n\n\nFigureÂ 12: Applications of 2D Density\n\n\n\n2D density plots of the slope versus the position of the last rupture event upon breaking the contact between the mannose-coated AFM cantilever and A. castellanii cell after 0.5 s (top left), 5 s (top right), and 10 s (bottom) contact times. [1]\n\n\n\n\n\n\nFigureÂ 13: Applications of 2D Density\n\n\n\nAn example of a technique for statistically classifying oscillatory patterns based on principal component analysis of LFP signals. (A) Two-dimensional brain state map. The three main clusters correspond to wakefulness (WK), slow-wave sleep (SWS), and rapid eye movement (REM). (B) Power spectrogram of the SI LFP channel shows distinct patterns of signal power oscillations during brain state transitions. (C) Sleep brain state map obtained from the two-dimensional state map shown in Figure A. Six distinct brain states are encoded: WK, SWS, REM, whisker twitching (WT), M (undefined movement), and U (transition state). (D) Density map calculated from a scatter plot (e.g., (A)) shows the conserved cluster topology and relative abundance of various brain states. The scale ranges from dark blue (low density) to red (high density). (E) Velocity map represents the average of spontaneous trajectories from the two-dimensional StateMap. Stationarity (low velocity) is observed within the three main clusters (WK, SWS, and REM), while maximum velocity is achieved during transitions from one cluster to another. The velocity between onsets of WK and SWS states increased after SNI injury, also suggesting increased WK/SWS transitions during neuropathic pain. [2]\n\n\n\n\n\n\nFigureÂ 14: Applications of 2D Density\n\n\n\nDependence between variables ğ¼ğ‘… and ğ¿â¢ğ¶ğ‘… in ecotypes La-0 and Fr.2. (A) Two-dimensional kernel density plot of ğ¼ğ‘… versus ğ¿â¢ğ¶ğ‘… shows that most ğ¿â¢ğ¶ğ‘… values are located in a narrow band around the vertical line ğ¼ğ‘…=0. (B) 3D kernel density plot showing, for example, that genomic regions R with values âˆ’2â‰¤ğ¼ğ‘…â‰¤2 and 0â‰¤ğ¿â¢ğ¶ğ‘…â‰¤25 are observed with high joint probability ğ‘ƒ(âˆ’1â‰¤ğ¼ğ‘…â‰¤1,0â‰¤ğ¿â¢ğ¶ğ‘…â‰¤25) (the volume of a square-based prism formed by the interval âˆ’2â‰¤ğ¼ğ‘…â‰¤2 and 0â‰¤ğ¿â¢ğ¶ğ‘…â‰¤25 and truncated by the surface covering the red to yellow region). For these regions, the probability of observing the SNP is low (according to equations (4) and (5), and the normalized count values of the SNPs in the support region equation (3) are low. In another example, genomic regions R with values âˆ’1â‰¤ğ¼ğ‘…â‰¤1 and 150â‰¤ğ¿â¢ğ¶ğ‘…â‰¤200 are observed with low joint probability ğ‘ƒ(âˆ’1â‰¤ğ¼ğ‘…â‰¤1,150â‰¤ğ¿â¢ğ¶ğ‘…â‰¤200) (corresponding to the volume of a prism truncated by a square base surface in the interval âˆ’1â‰¤ğ¼ğ‘…â‰¤1 and 150â‰¤ğ¿â¢ğ¶ğ‘…â‰¤200); (C) Farlieâ€“Gumbelâ€“Morgenstern copula according to ğ¿â¢ğ¶ğ‘… (Weibull PDF) and Constructed from nonlinear fits of the marginal distributions of ğ¼ğ‘… (Skewâ€“Laplace PDF) estimates. The Farlieâ€“Gumbelâ€“Morgenstern copula distribution, which indicates structural dependence between the variables ğ¼ğ‘… and ğ¿â¢ğ¶ğ‘…, describes the empirical behavior shown in Panel B in an acceptable manner. [3]",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "2D Density"
    ]
  },
  {
    "objectID": "Correlation/Density2D.html#reference",
    "href": "Correlation/Density2D.html#reference",
    "title": "2D Density",
    "section": "Reference",
    "text": "Reference\n[1] Cardoso-Cruz H, Sameshima K, Lima D, Galhardo V. Dynamics of Circadian Thalamocortical Flow of Information during a Peripheral Neuropathic Pain Condition. Front Integr Neurosci. 2011 Aug 23;5:43. doi: 10.3389/fnint.2011.00043. PMID: 22007162; PMCID: PMC3188809.\n[2] Rey SA, Smith CA, Fowler MW, Crawford F, Burden JJ, Staras K. Ultrastructural and functional fate of recycled vesicles in hippocampal synapses. Nat Commun. 2015 Aug 21;6:8043. doi: 10.1038/ncomms9043. PMID: 26292808; PMCID: PMC4560786.\n[3] Sanchez R, Mackenzie SA. Genome-Wide Discriminatory Information Patterns of Cytosine DNA Methylation. Int J Mol Sci. 2016 Jun 17;17(6):938. doi: 10.3390/ijms17060938. PMID: 27322251; PMCID: PMC4926471.\n[4] Rudis, B. (2020). hrbrthemes: Additional Themes and Theme Components for â€˜ggplot2â€™. https://cran.r-project.org/package=hrbrthemes\n[5] Neuwirth, E. (2014). RColorBrewer: ColorBrewer Palettes. https://cran.r-project.org/package=RColorBrewer\n[6] Ellison, A. M. (2019). hexbin: Hexagonal Binning for Visualization of Two-Dimensional Data. https://cran.r-project.org/package=hexbin\n[7] Venables, W. N., & Ripley, B. D. (2002). MASS: Modern Applied Statistics with S. https://cran.r-project.org/package=MASS\n[8] Sievert, C. (2023). plotly: Create Interactive Web Graphics via â€˜plotly.jsâ€™. https://cran.r-project.org/package=plotly\n[9] Wickham, H. (2016). ggplot2: Elegant Graphics for Data Analysis. Springer. https://ggplot2.tidyverse.org\n[10] Genz, A., & Bretz, F. (2009). mvtnorm: Multivariate Normal and T Distributions. https://cran.r-project.org/package=mvtnorm",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "2D Density"
    ]
  },
  {
    "objectID": "Correlation/Biplot.html",
    "href": "Correlation/Biplot.html",
    "title": "Biplot",
    "section": "",
    "text": "A biplot is a visualization tool used to present the results of principal component analysis (PCA). It simultaneously displays the positions of both samples and variables in a dataset within the principal component space. In a two-dimensional biplot, samples are typically represented as points, while variables are represented as arrows. The direction and length of the arrows represent the contribution and correlation of the variables to the principal components, respectively.",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Biplot"
    ]
  },
  {
    "objectID": "Correlation/Biplot.html#example",
    "href": "Correlation/Biplot.html#example",
    "title": "Biplot",
    "section": "",
    "text": "A biplot is a visualization tool used to present the results of principal component analysis (PCA). It simultaneously displays the positions of both samples and variables in a dataset within the principal component space. In a two-dimensional biplot, samples are typically represented as points, while variables are represented as arrows. The direction and length of the arrows represent the contribution and correlation of the variables to the principal components, respectively.",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Biplot"
    ]
  },
  {
    "objectID": "Correlation/Biplot.html#setup",
    "href": "Correlation/Biplot.html#setup",
    "title": "Biplot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: ## Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: dplyr and ggbiplot\n\n\n# install packages\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\n\nif (!requireNamespace(\"ggbiplot\", quietly = TRUE)) {\n  install.packages(\"ggbiplot\")\n}\n\n# load packages\nlibrary(\"dplyr\")\n## \n## Attaching package: 'dplyr'\n## The following objects are masked from 'package:stats':\n## \n##     filter, lag\n## The following objects are masked from 'package:base':\n## \n##     intersect, setdiff, setequal, union\nlibrary(\"ggbiplot\")\n## Loading required package: ggplot2",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Biplot"
    ]
  },
  {
    "objectID": "Correlation/Biplot.html#data-preparation",
    "href": "Correlation/Biplot.html#data-preparation",
    "title": "Biplot",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe data comes from the iris dataset that comes with R.\n\ndata(\"iris\")\nhead(iris) \n\n  Sepal.Length Sepal.Width Petal.Length Petal.Width Species\n1          5.1         3.5          1.4         0.2  setosa\n2          4.9         3.0          1.4         0.2  setosa\n3          4.7         3.2          1.3         0.2  setosa\n4          4.6         3.1          1.5         0.2  setosa\n5          5.0         3.6          1.4         0.2  setosa\n6          5.4         3.9          1.7         0.4  setosa",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Biplot"
    ]
  },
  {
    "objectID": "Correlation/Biplot.html#visualization",
    "href": "Correlation/Biplot.html#visualization",
    "title": "Biplot",
    "section": "Visualization",
    "text": "Visualization\nPrincipal component analysis is performed using the prcomp function.\n\niris.pca &lt;- prcomp (~ Sepal.Length + Sepal.Width + Petal.Length + Petal.Width,\n                    data=iris,\n                    scale. = TRUE)\nsummary(iris.pca)\n\nImportance of components:\n                          PC1    PC2     PC3     PC4\nStandard deviation     1.7084 0.9560 0.38309 0.14393\nProportion of Variance 0.7296 0.2285 0.03669 0.00518\nCumulative Proportion  0.7296 0.9581 0.99482 1.00000\n\n\n\n1. Basic Plot\nUse ggbipolot to draw the loading plot of PCA results.\n\niris.gg &lt;-\n  ggbiplot(iris.pca, obs.scale = 1, var.scale = 1,\n           groups = iris$Species, point.size=2,\n           varname.size = 3, \n           varname.color = \"black\",\n           varname.adjust = 1.2,\n           ellipse = TRUE, \n           circle = TRUE) +\n  labs(fill = \"Species\", color = \"Species\") +\n  theme_minimal(base_size = 14) +\n  theme(legend.direction = 'horizontal', legend.position = 'top')\n\niris.gg\n\n\n\n\n\n\n\nFigureÂ 1: Basic Plot\n\n\n\n\n\nNote: The figure title is the gene name, the horizontal axis is PC1, and the vertical axis is PC2. The arrows in the figure indicate the length of the vectors, which represents the contribution to the variance. The direction indicates the correlation with the principal component. The colors represent the different iris species.\nWe can see that PC1 and PC2 clearly separate the three groups of samples. The vectors Petal.Length and Petal.width are nearly parallel to the x-axis, indicating that the variance in PC1 is primarily contributed by these variables, while the variance in PC2 is primarily contributed by Sepal.Width. An angle between the vectors greater than 90Â° indicates a negative correlation, while an angle less than 90Â° indicates a positive correlation.\n\n\n2. Add cluster labels\nWe can calculate the cluster centers and add labels to more intuitively display the names of different categories.\n\ngroup.labs &lt;-\n  iris.gg$data %&gt;%\n  dplyr::summarise(xvar = mean(xvar),\n            yvar = mean(yvar), .by = groups)\ngroup.labs\n\n      groups       xvar       yvar\n1     setosa -2.2099215 -0.2870013\n2 versicolor  0.4931384  0.5465027\n3  virginica  1.7167831 -0.2595014\n\n\n\niris.gg + geom_label(data = group.labs,\n                     aes(x = xvar, y=yvar, label=groups),\n                     size = 5) +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\nFigureÂ 2: Add cluster labels\n\n\n\n\n\n\n\n3. Use sample names instead of points\nIn order to show the position of different samples in PCA analysis, we can display them by setting labels.\n\nggbiplot(iris.pca, obs.scale = 1, \n         var.scale = 1,\n         groups = iris$Species, \n         labels = rownames(iris),\n         point.size=2,\n         varname.size = 3, \n         varname.color = \"black\",\n         varname.adjust = 1.2,\n         ellipse = TRUE, \n         circle = TRUE) +\n  labs(fill = \"Species\", color = \"Species\") +\n  theme_minimal(base_size = 14) +\n  theme(legend.direction = 'horizontal', legend.position = 'top')\n\n\n\n\n\n\n\nFigureÂ 3: Use sample names instead of points",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Biplot"
    ]
  },
  {
    "objectID": "Correlation/Biplot.html#application",
    "href": "Correlation/Biplot.html#application",
    "title": "Biplot",
    "section": "Application",
    "text": "Application\n\n1. Metagenomic principal component analysis loading plot\n\n\n\n\n\n\nFigureÂ 4: Metagenomic principal component analysis loading plot\n\n\n\nArrows represent bacterial species, and letters represent samples. The closer the distance between the bacterial species and the sample, the higher the correlation. In the figure, the bacterial species closest to H1, H2, H3, H4, and H7 is Bifidobacteria, indicating that this species is the dominant species in the control group. [1]\n\n\n2. Transcriptome principal component analysis loading plot\n\n\n\n\n\n\nFigureÂ 5: Transcriptome principal component analysis loading plot\n\n\n\nThere were significant differences among the four groups, with the contribution values of PC1 and PC2 being 40.92% and 24.26%, respectively. In PC2, the control group (PBS) and the asthma + mutton group (OVA + Lamb) were positively distributed, the asthma + fish group (OVA + fish) and the asthma group (OVA) were mainly negatively distributed. There were significant differences between the control group and the other three groups, and the asthma + mutton group (OVA + Lamb) and the asthma + fish group (OVA + Fish) were significantly separated.[2]",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Biplot"
    ]
  },
  {
    "objectID": "Correlation/Biplot.html#reference",
    "href": "Correlation/Biplot.html#reference",
    "title": "Biplot",
    "section": "Reference",
    "text": "Reference\n[1] Balasubramaniam C, Mallappa RH, Singh DK, et al.Â Gut bacterial profile in Indian children of varying nutritional status: a comparative pilot study. Eur J Nutr. 2021;60(7):3971-3985. doi:10.1007/s00394-021-02571-7.\n[2] Zheng HC, Wang YA, Liu ZR, et al.Â Consumption of Lamb Meat or Basa Fish Shapes the Gut Microbiota and Aggravates Pulmonary Inflammation in Asthmatic Mice. J Asthma Allergy. 2020;13:509-520. Published 2020 Oct 19. doi:10.2147/JAA.S266584.",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Biplot"
    ]
  },
  {
    "objectID": "Correlation/Bubble.html",
    "href": "Correlation/Bubble.html",
    "title": "Bubble Plot",
    "section": "",
    "text": "A bubble plot is a scatter plot in which a third numeric variable is mapped to the size of the circles. This article shows several ways to build bubble charts using R.",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Bubble Plot"
    ]
  },
  {
    "objectID": "Correlation/Bubble.html#example",
    "href": "Correlation/Bubble.html#example",
    "title": "Bubble Plot",
    "section": "Example",
    "text": "Example",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Bubble Plot"
    ]
  },
  {
    "objectID": "Correlation/Bubble.html#setup",
    "href": "Correlation/Bubble.html#setup",
    "title": "Bubble Plot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming Language: R\nDependencies: dplyr, ggplot2, gapminder, hrbrthemes, viridis\n\n\n# Install packages\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"gapminder\", quietly = TRUE)) {\n  install.packages(\"gapminder\")\n}\nif (!requireNamespace(\"hrbrthemes\", quietly = TRUE)) {\n  install.packages(\"hrbrthemes\")\n}\nif (!requireNamespace(\"viridis\", quietly = TRUE)) {\n  install.packages(\"viridis\")\n}\n\n# Load packages\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(gapminder) # is an R package that provides a summary of data from Gapminder.org. The data includes life expectancy, GDP per capita, and population data for 142 countries every five years from 1952 to 2007.\nlibrary(hrbrthemes)\nlibrary(viridis)",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Bubble Plot"
    ]
  },
  {
    "objectID": "Correlation/Bubble.html#data-preparation",
    "href": "Correlation/Bubble.html#data-preparation",
    "title": "Bubble Plot",
    "section": "Data Preparation",
    "text": "Data Preparation\nUse R built-in iris dataset, TCGA database and gapminder built-in dataset.\n\n# R built-in data - iris\nhead(iris)\n\n  Sepal.Length Sepal.Width Petal.Length Petal.Width Species\n1          5.1         3.5          1.4         0.2  setosa\n2          4.9         3.0          1.4         0.2  setosa\n3          4.7         3.2          1.3         0.2  setosa\n4          4.6         3.1          1.5         0.2  setosa\n5          5.0         3.6          1.4         0.2  setosa\n6          5.4         3.9          1.7         0.4  setosa\n\n# TCGA database (using clinical data on lung cancer in 2020)\nTCGA_clinic &lt;- readr::read_tsv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/raponi2006_public_raponi2006_public_clinicalMatrix.gz\")\nTCGA_clinic$T &lt;- as.factor(TCGA_clinic$T)\n\n# gapminder package\ndata &lt;- gapminder %&gt;% \n  filter(year==\"2007\") %&gt;% \n  dplyr::select(-year)",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Bubble Plot"
    ]
  },
  {
    "objectID": "Correlation/Bubble.html#visualization",
    "href": "Correlation/Bubble.html#visualization",
    "title": "Bubble Plot",
    "section": "Visualization",
    "text": "Visualization\n\n1. Basic Plot\n\n# Taking iris data as an example\np &lt;- ggplot(iris, aes(x=Sepal.Length, y=Sepal.Width, size = Species)) +\n  geom_point(alpha=0.4)\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Basic Plot\n\n\n\n\n\nThis bubble plot depicts the relationship between the Sepal.Length and Sepal.Width variables across species.\n\n\n2. Change Color\n\n# Change Color\np &lt;- ggplot(iris, aes(x=Sepal.Length, y=Sepal.Width, size=Species,color=Species)) +\n  geom_point(alpha=0.3)\n\np\n\n\n\n\n\n\n\nFigureÂ 2: Change Color\n\n\n\n\n\nThis bubble plot depicts the relationship between the Sepal.Length and Sepal.Width variables across species.\n\n\n3. Change the range of bubble size\n\n# Taking TCGA data as an example\np &lt;- TCGA_clinic %&gt;%\n  arrange(desc(Age)) %&gt;%\n  ggplot(aes(x=T, y=OS.time, size = Age,color=Age)) +\n  geom_point(alpha=0.4) +\n  scale_size(range = c(.1, 12), name=\"Age\")\n\np\n\n\n\n\n\n\n\nFigureÂ 3: Change the range of bubble size\n\n\n\n\n\nThis bubble plot depicts the relationship between age and OS.time variable in different tumor T stages.\n\n\n4. Refined Plot\n\n# Take the data in the gapminder package as an example\np &lt;- data %&gt;%\n  arrange(desc(pop)) %&gt;%\n  mutate(country = factor(country, country)) %&gt;%\n  ggplot(aes(x=gdpPercap, y=lifeExp, size=pop, fill=continent)) +\n  geom_point(alpha=0.5, shape=21, color=\"black\") +\n  scale_size(range = c(.1, 24), name=\"Population (M)\") +\n  scale_fill_viridis(discrete=TRUE, guide=FALSE, option=\"A\") +\n  theme_ipsum() +\n  theme(legend.position=\"bottom\") +\n  ylab(\"Life Expectancy\") +\n  xlab(\"Gdp per Capita\") +\n  theme(legend.position = \"none\")\n\np\n\n\n\n\n\n\n\nFigureÂ 4: Refined Plot\n\n\n\n\n\nThis bubble plot depicts the relationship between life expectancy (y) and GDP per capita (x) for countries around the world.",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Bubble Plot"
    ]
  },
  {
    "objectID": "Correlation/Bubble.html#applications",
    "href": "Correlation/Bubble.html#applications",
    "title": "Bubble Plot",
    "section": "Applications",
    "text": "Applications\n\n1. Bubble plots are used to display KEGG pathway enrichment analysis\n\n\n\n\n\n\nFigureÂ 5: Applications of Bubble Plot\n\n\n\nThis bubble plot shows 26 signaling pathways associated with the development and progression of COVID-19. [1]\n\n\n2. Bubble plot can be used to display multivariate data\n\n\n\n\n\n\nFigureÂ 6: Applications of Bubble Plot\n\n\n\nThis bubble plot demonstrates the agreement between extreme temperature anomalies estimated from mooring observations and historical temperature profile measurements. a. Bubble plot of the 95th percentile EHTA estimated from a mooring site and the corresponding historical temperature distribution measurements within a 5Ã—5Â° grid box centered at the mooring site. Colors indicate observations from different locations, and dot size indicates observation depths from 10 to 1000 meters. b. Same as a, but for the 5th percentile ELTA. Note that ELTAs below -3Â°C (at the KEO site) are not plotted. c, d.Â Same as a(c) and b(d), but with different percentages (p) of EHTA measurements observed within AE (c) and ELTA measurements observed within CE (d). The solid black line with gray shading represents the corresponding linear regression with a 95% confidence level. [2]",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Bubble Plot"
    ]
  },
  {
    "objectID": "Correlation/Bubble.html#reference",
    "href": "Correlation/Bubble.html#reference",
    "title": "Bubble Plot",
    "section": "Reference",
    "text": "Reference\n[1] Oh KK, Adnan M, Cho DH. Network pharmacology approach to decipher signaling pathways associated with target proteins of NSAIDs against COVID-19. Sci Rep.Â 2021 May 5;11(1):9606. doi: 10.1038/s41598-021-88313-5. PMID: 33953223; PMCID: PMC8100301.\n[2] He Q, Zhan W, Feng M, Gong Y, Cai S, Zhan H. Common occurrences of subsurface heatwaves and cold spells in ocean eddies. Nature. 2024 Oct;634(8036):1111-1117. doi: 10.1038/s41586-024-08051-2. Epub 2024 Oct 16. PMID: 39415017; PMCID: PMC11525169.\n[3] Wickham, H. (2016). ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York. https://ggplot2.tidyverse.org\n[4] Bryan, J. (2023). gapminder: Data from Gapminder (Version 1.0.0). Retrieved from https://CRAN.R-project.org/package=gapminder\n[5] Wickham, H. (2017). dplyr: A Grammar of Data Manipulation (Version 0.7.4). Retrieved from https://CRAN.R-project.org/package=dplyr\n[6] Rudis, B. (2017). hrbrthemes: Additional Themes, Theme Components and Utilities for â€˜ggplot2â€™ (Version 0.8.7). Retrieved from https://github.com/hrbrmstr/hrbrthemes\n[7] Ross, N., & Garnier, S. (2016). viridis: Default Color Maps for â€˜ggplot2â€™. Retrieved from https://cran.r-project.org/web/packages/viridis/index.html",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Bubble Plot"
    ]
  },
  {
    "objectID": "Correlation/Correlogram.html",
    "href": "Correlation/Correlogram.html",
    "title": "Correlogram",
    "section": "",
    "text": "Correlogram or Correlation diagrams are often used to summarize the correlation information of various groups of data in the entire dataset.",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Correlogram"
    ]
  },
  {
    "objectID": "Correlation/Correlogram.html#example",
    "href": "Correlation/Correlogram.html#example",
    "title": "Correlogram",
    "section": "Example",
    "text": "Example\n\n\n\n\n\nFor example, the above diagram is a correlation heatmap of various groups of data in the mtcars dataset. Colors are used to represent the pairwise correlations of data in different groups, and the shade of the color represents the magnitude of the P-value.",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Correlogram"
    ]
  },
  {
    "objectID": "Correlation/Correlogram.html#setup",
    "href": "Correlation/Correlogram.html#setup",
    "title": "Correlogram",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming Language: R\nDependencies: GGally; corrplot; ggcorrplot; corrgram\n\n\n# Install packages\nif (!requireNamespace(\"GGally\", quietly = TRUE)) {\n  install.packages(\"GGally\")\n}\nif (!requireNamespace(\"corrplot\", quietly = TRUE)) {\n  install.packages(\"corrplot\")\n}\nif (!requireNamespace(\"ggcorrplot\", quietly = TRUE)) {\n  install.packages(\"ggcorrplot\")\n}\nif (!requireNamespace(\"corrgram\", quietly = TRUE)) {\n  install.packages(\"corrgram\")\n}\n\n# Load packages\nlibrary(GGally)\nlibrary(corrplot)\nlibrary(ggcorrplot)\nlibrary(corrgram)",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Correlogram"
    ]
  },
  {
    "objectID": "Correlation/Correlogram.html#data-preparation",
    "href": "Correlation/Correlogram.html#data-preparation",
    "title": "Correlogram",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe correlation heatmap is mainly drawn using the built-in datasets in R.\n\ndata(\"flea\", package = \"GGally\")\ndata_flea &lt;- flea\n\ndata(\"mtcars\", package = \"datasets\")\ndata_mtcars &lt;- mtcars\n\ndata(\"tips\", package = \"GGally\")\ndata_tips &lt;- tips",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Correlogram"
    ]
  },
  {
    "objectID": "Correlation/Correlogram.html#visualization",
    "href": "Correlation/Correlogram.html#visualization",
    "title": "Correlogram",
    "section": "Visualization",
    "text": "Visualization\n\n1. GGally Package\n\nGGally is a commonly used tool for drawing correlation diagrams. It allows the injection of ggplot2 code but does not have a sorting function.\n\n\nDrawing of Basic Correlation Diagram\n\nggpairs(data_flea, columns = 2:5)\n\n\n\n\n\n\n\n\n\nThe above diagram shows the correlation visualization of each group of data in the flea dataset. The picture consists of three parts: the scatter plot of the correlation between the corresponding two groups of data in the lower part; the density plot of a single group of data on the diagonal; and the Pearson correlation coefficient values of the corresponding two groups of data in the upper part.\n\n\n\nIntroducing ggplot2 Codes to Color Each Category\n\nggpairs(data_flea, columns = 2:4, ggplot2::aes(colour=species,alpha=0.7)) \n\n\n\n\n\n\n\n\n\nThe above diagram, on the basis of correlation visualization, classifies each category by color.\n\n\n\nCustomizing the Plotting Type\n\nggpairs(data_tips[, c(1, 3, 4, 2)])\n\n\n\n\n\n\n\nsummary(data_tips)\n\n   total_bill         tip             sex      smoker      day         time    \n Min.   : 3.07   Min.   : 1.000   Female: 87   No :151   Fri :19   Dinner:176  \n 1st Qu.:13.35   1st Qu.: 2.000   Male  :157   Yes: 93   Sat :87   Lunch : 68  \n Median :17.80   Median : 2.900                          Sun :76               \n Mean   :19.79   Mean   : 2.998                          Thur:62               \n 3rd Qu.:24.13   3rd Qu.: 3.562                                                \n Max.   :50.81   Max.   :10.000                                                \n      size     \n Min.   :1.00  \n 1st Qu.:2.00  \n Median :2.00  \n Mean   :2.57  \n 3rd Qu.:3.00  \n Max.   :6.00  \n\n\n\nIn the above diagram, tatal_bill and tip are quantitative data, while sex and smoker are qualitative data. In the lower part, scatter plots, histograms, and bar charts of pairwise correlations are mainly drawn according to different data types; in the diagonal part, the distribution diagrams of each group of data are shown; in the upper part, pairwise correlation line charts are drawn according to different data types, and for two quantitative data, the Pearson correlation coefficient values are given.\n\n\n# Changing the plotting type\nggpairs(\n  data_tips[, c(1, 3, 4, 2)],\n  upper = list(continuous = \"density\",\n               combo = \"box_no_facet\"),\n  lower = list(continuous = \"points\",\n               combo = \"dot_no_facet\")\n)\n\n\n\n\n\n\n\n\n\nThrough customization, the histogram in the lower part is modified into a scatter plot, and the correlation coefficient values in the upper part are modified into a density plot.\n\n\n\nCorrelation Visualization\nVisualize the correlation coefficients.\n\nggcorr(data_mtcars) # Draw a correlation coefficient heatmap, with Pearson as the default\n\n\n\n\n\n\n\n\n\nThe above diagram visualizes the correlation coefficients through the ggcorrï¼ˆï¼‰ function.\nThe method parameter of ggcorr:\nThe default is in the form of c(\"pairwise\", \"pearson\"). The first parameter is to determine the handling of missing values when calculating the covariance, and the second parameter is used to determine the type of correlation coefficient, such as \"pearson\", \"kendall\" or \"spearman\".\n\n\n\n\n2. corrplot Package\n\nThe corrplot package is a commonly used tool for correlation visualization, which has powerful customization functions and a sorting function.\n\n\nBasic Plotting\n\ncorr &lt;- cor(data_mtcars)\ncorrplot(corr)\n\n\n\n\n\n\n\n\n\n\nParameter Customization\n\nThe main key parameters of corrplot():\ncorr The correlation coefficient matrix to be visualized\nmethod The shape of the visualization\ntype The display range (full, lower, upper)\ncol The color of the graph display\naddCoef.col The color of the correlation coefficient values\norder The sorting method of the correlation coefficients\nis.corr Whether to draw a correlation coefficient plot, which is TRUE by default. It can also achieve the visualization of non-correlation coefficients. Just set this parameter to FALSE.\nâ€¦â€¦\n\n\ncorrplot(corr,method = \"ellipse\" ,#method, specify the visualization shape\n         order = \"AOE\", #order, the sorting method of the correlation coefficients\n         addCoef.col=\"black\", # Specify the color of the correlation coefficients\n         type=\"lower\") # Specify the display part\n\n\n\n\n\n\n\n\n\nThe above diagram is a correlation coefficient heatmap of the mtcars dataset.\n\ntype=\"lower\" specifies to display the lower part of the heatmap.\nThe shade of the color represents the magnitude of the correlation coefficient.\nThe shape of the ellipse represents the correlation coefficient: the greater the eccentricity, the flatter the ellipse, and the larger the absolute value of the correlation coefficient; the smaller the eccentricity, the rounder the ellipse, and the smaller the absolute value of the correlation coefficient. The direction of the long axis of the ellipse represents the positive or negative of the correlation coefficient. The upper right - lower left direction corresponds to a positive value, and the upper left - lower right direction corresponds to a negative value.\n\n\n\n\nAdding Significance Labels\n\nres1 &lt;-cor.mtest(data_mtcars, conf.level= .95)\ncorrplot(corr, method= \"circle\",\n         p.mat= res1$p, sig.level= 0.01, # P-values greater than 0.01 are considered to have no statistical significance\n         mar= c(1,1,1,1))\n\n\n\n\n\n\n\n\n\nThe above diagram adds significance labels on the basis of the correlation coefficient heatmap. P-values greater than 0.01 are regarded as having no statistical significance.\n\n\n\n\n3. ggcorrplot Package\n\nThe ggcorrplot package is equivalent to a simplified version of the corrplot package, mainly including the calculation function of cor_pmat and the plotting function of ggcorrplot.\n\n\nCalculating P-values with cor_pmat\n\np.mat &lt;- cor_pmat(data_mtcars)\nhead(p.mat[, 1:6])\n\n              mpg          cyl         disp           hp         drat\nmpg  0.000000e+00 6.112687e-10 9.380327e-10 1.787835e-07 1.776240e-05\ncyl  6.112687e-10 0.000000e+00 1.802838e-12 3.477861e-09 8.244636e-06\ndisp 9.380327e-10 1.802838e-12 0.000000e+00 7.142679e-08 5.282022e-06\nhp   1.787835e-07 3.477861e-09 7.142679e-08 0.000000e+00 9.988772e-03\ndrat 1.776240e-05 8.244636e-06 5.282022e-06 9.988772e-03 0.000000e+00\nwt   1.293959e-10 1.217567e-07 1.222320e-11 4.145827e-05 4.784260e-06\n               wt\nmpg  1.293959e-10\ncyl  1.217567e-07\ndisp 1.222320e-11\nhp   4.145827e-05\ndrat 4.784260e-06\nwt   0.000000e+00\n\n\n\n\nPlotting with ggcorrplot\n\nggcorrplot(corr, method = \"square\" )\n\nWarning: `aes_string()` was deprecated in ggplot2 3.0.0.\nâ„¹ Please use tidy evaluation idioms with `aes()`.\nâ„¹ See also `vignette(\"ggplot2-in-packages\")` for more information.\nâ„¹ The deprecated feature was likely used in the ggcorrplot package.\n  Please report the issue at &lt;https://github.com/kassambara/ggcorrplot/issues&gt;.\n\n\n\n\n\n\n\n\n\n\nThe above diagram is a color heatmap of the correlation coefficients of the mtcar dataset.\n\n\nggcorrplot(corr, method = \"circle\" )\n\n\n\n\n\n\n\n\n\nHere we have changed the plotting type to a circle.\n\n\n\n\n4. corrgram Package\n\nThe corrgram package is also a good choice for drawing correlation diagrams. It can select the content to be displayed in the upper, lower, and diagonal parts.\nWe mainly use the corrgram() function to draw the correlation diagram:\n\ncor.method determines the type of correlation coefficient, pearson (default), spearman, kendall\n\nDifferent methods can be used for visualization:\n\npanel.ellipse displays an ellipse\npanel.shade is used for color blocks\npanel.pie is used for pie charts\npanel.pts is used for scatter plots\n\n\n\ncorrgram(data_mtcars, order=TRUE, \n         lower.panel=panel.shade, # Color blocks\n         upper.panel=panel.pie, # Pie chart\n         text.panel=panel.txt, \n         main=\"Car Milage Data in PC2/PC1 Order\") \n\n\n\n\n\n\n\n\n\nBy setting lower.panel=panel.shade and upper.panel=panel.pie, the upper part is set as a pie chart, and the lower part is set as a color diagram.\n\n\ncorrgram(data_mtcars, order=TRUE, \n         lower.panel=panel.ellipse, # Display an ellipse\n         upper.panel=panel.pts,  # Scatter plot\n         text.panel=panel.txt, \n         diag.panel=panel.minmax, \n         main=\"Car Milage Data in PC2/PC1 Order\") \n\n\n\n\n\n\n\n\n\nBy setting lower.panel=panel.ellipse and upper.panel=panel.pts, the upper part is set as a scatter plot, and the lower part is set as an ellipse diagram (where the red line is the fitted curve).\n\n\ncorrgram(data_mtcars, order=NULL, \n         lower.panel=panel.shade, # Color blocks\n         upper.panel=NULL, \n         text.panel=panel.txt, \n         main=\"Car Milage Data (unsorted)\")\n\n\n\n\n\n\n\n\n\nBy setting lower.panel=panel.shade and upper.panel=NULL, only the color diagram in the lower part is displayed.",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Correlogram"
    ]
  },
  {
    "objectID": "Correlation/Correlogram.html#applications",
    "href": "Correlation/Correlogram.html#applications",
    "title": "Correlogram",
    "section": "Applications",
    "text": "Applications\n\n\n\n\n\n\nFigureÂ 1: Applications of Correlogram\n\n\n\n\nThe above diagram is a correlation diagram based on the ANI values of strains. The ANI values between each indicator strain are calculated using the JSpecies software and used for the construction of the Pearson correlation matrix. This diagram shows the correlations constructed and sorted by hierarchical clustering using the corrplot package. [1]\n\n\n\n\n\n\n\nFigureÂ 2: Applications of Correlogram\n\n\n\n\nThe above diagram shows the correlations between Gain [FF], ILP, wpm, RR, R r-words, R p-words, RN, and VA. The left diagram shows the correlations without excluding the influence of childrenâ€™s grades; the right diagram shows the correlations after differentiating the grades. The magnitude of the correlation is represented by the size (and color) of the circle. The corrplot package was used for drawing. [2]",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Correlogram"
    ]
  },
  {
    "objectID": "Correlation/Correlogram.html#reference",
    "href": "Correlation/Correlogram.html#reference",
    "title": "Correlogram",
    "section": "Reference",
    "text": "Reference\n[1] Espariz M, Zuljan FA, Esteban L, Magni C. Taxonomic Identity Resolution of Highly Phylogenetically Related Strains and Selection of Phylogenetic Markers by Using Genome-Scale Methods: The Bacillus pumilus Group Case. PLoS One. 2016 Sep 22;11(9):e0163098. doi: 10.1371/journal.pone.0163098. PMID: 27658251; PMCID: PMC5033322.\n[2] Marx C, Hutzler F, Schuster S, Hawelka S. On the Development of Parafoveal Preprocessing: Evidence from the Incremental Boundary Paradigm. Front Psychol. 2016 Apr 14;7:514. doi: 10.3389/fpsyg.2016.00514. PMID: 27148123; PMCID: PMC4830847.\n[3] Schloerke B, Cook D, Larmarange J, Briatte F, Marbach M, Thoen E, Elberg A, Crowley J (2024). GGally: Extension to â€˜ggplot2â€™. R package version 2.2.1, CRAN: Package GGally.\n[4] Taiyun Wei and Viliam Simko (2024). R package â€˜corrplotâ€™: Visualization of a Correlation Matrix (Version 0.94). Available from GitHub - taiyun/corrplot: A visual exploratory tool on correlation matrix\n[5] Kassambara A (2023). ggcorrplot: Visualization of a Correlation Matrix using â€˜ggplot2â€™. R package version 0.1.4.1, CRAN: Package ggcorrplot.\n[6] Wright K (2021). corrgram: Plot a Correlogram. R package version 1.14, CRAN: Package corrgram.",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Correlogram"
    ]
  },
  {
    "objectID": "Correlation/ComplexHeatmap.html",
    "href": "Correlation/ComplexHeatmap.html",
    "title": "ComplexHeatmap",
    "section": "",
    "text": "The Complex Heatmap is an advanced data visualization tool primarily used to display matrix relationships in multidimensional data. It adds multi-level annotation, cluster analysis, and data splitting capabilities to the basic heatmap. It can more clearly present the inherent structure and relationships of complex data.",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "ComplexHeatmap"
    ]
  },
  {
    "objectID": "Correlation/ComplexHeatmap.html#example",
    "href": "Correlation/ComplexHeatmap.html#example",
    "title": "ComplexHeatmap",
    "section": "",
    "text": "The Complex Heatmap is an advanced data visualization tool primarily used to display matrix relationships in multidimensional data. It adds multi-level annotation, cluster analysis, and data splitting capabilities to the basic heatmap. It can more clearly present the inherent structure and relationships of complex data.",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "ComplexHeatmap"
    ]
  },
  {
    "objectID": "Correlation/ComplexHeatmap.html#setup",
    "href": "Correlation/ComplexHeatmap.html#setup",
    "title": "ComplexHeatmap",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: ComplexHeatmap, dendextend, tidyr, circlize, gridExtra, pheatmap\n\n\n# Installing packages\nif (!requireNamespace(\"ComplexHeatmap\", quietly = TRUE)) {\n  BiocManager::install(\"ComplexHeatmap\")\n}\nif (!requireNamespace(\"dendextend\", quietly = TRUE)) {\n  install.packages(\"dendextend\")\n}\nif (!requireNamespace(\"tidyr\", quietly = TRUE)) {\n  install.packages(\"tidyr\")\n}\nif (!requireNamespace(\"circlize\", quietly = TRUE)) {\n  install.packages(\"circlize\")\n}\nif (!requireNamespace(\"gridExtra\", quietly = TRUE)) {\n  install.packages(\"gridExtra\")\n}\nif (!requireNamespace(\"pheatmap\", quietly = TRUE)) {\n  install.packages(\"pheatmap\")\n}\n\n# Load packages\nlibrary(ComplexHeatmap)\nlibrary(dendextend)\nlibrary(tidyr)\nlibrary(circlize)\nlibrary(gridExtra)\nlibrary(pheatmap)",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "ComplexHeatmap"
    ]
  },
  {
    "objectID": "Correlation/ComplexHeatmap.html#data-preparation",
    "href": "Correlation/ComplexHeatmap.html#data-preparation",
    "title": "ComplexHeatmap",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe data mainly comes from the methylation data of the TCGA database\n\n# data_mat (continuous)\ndata &lt;- readr::read_csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/TCGA.BRCA.sampleMap_HumanMethylation27_ch.csv\")\n\ndata &lt;- as.data.frame(data)\nrownames(data) &lt;- data[,1]\ndata &lt;- data[,-1]\n\ndata_TCGA &lt;- na.omit(data[1:20,1:20])\n\ndata_TCGA &lt;- as.matrix(data_TCGA)  \n\n# Discrete\ndiscrete_mat = matrix(sample(1:5, 100, replace = TRUE), 10, 10)",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "ComplexHeatmap"
    ]
  },
  {
    "objectID": "Correlation/ComplexHeatmap.html#visualization",
    "href": "Correlation/ComplexHeatmap.html#visualization",
    "title": "ComplexHeatmap",
    "section": "Visualization",
    "text": "Visualization\n\n1. Basic ComplexHeatmap\nContinuous variables\nHere we take the methylation data of the TCGA database as an example\n\n# Continuous variables\nHeatmap(data_TCGA , name = \"Methylation\")\n\n\n\n\n\n\n\nFigureÂ 1: Continuous variables\n\n\n\n\n\nThe figure above shows a complex heatmap of methylation levels, with columns representing gene loci and samples representing behavioral patterns. Red indicates high methylation levels, while blue indicates low methylation levels. The edges represent the results of the cluster analysis.\nDiscrete variables\nHere we take generating data as an example\n\n# Discrete variables\nHeatmap(discrete_mat,  name = \"mat\")\n\n\n\n\n\n\n\nFigureÂ 2: Discrete variables\n\n\n\n\n\nThe figure above is a complex heat map of the generated discrete variables, and the side axes are the results of cluster analysis.\n\n\n2. Customization\n\n2.1 Color customization\nContinuous variables\n\n# Customizing the color of continuous variables\ncol_fun = colorRamp2(c(0, 0.5, 1),  # Set the cutoff point\n                     c(\"blue\", \"white\", \"pink\")) \nHeatmap(data_TCGA, name = \"Methylation\", col = col_fun, \n              column_title = \"Custom three-segment color\")\n\n\n\n\n\n\n\nFigureÂ 3: Customizing the color of continuous variables\n\n\n\n\n\n\n# Customizing the color of continuous variables\nHeatmap(data_TCGA, name = \"Methylation\", col = rev(rainbow(10)), \n        column_title = \"Creating a color vector\")\n\n\n\n\n\n\n\nFigureÂ 4: Customizing the color of continuous variables\n\n\n\n\n\nDiscrete variables\n\n# Customize discrete variable colors\ncolors &lt;- c(\n  \"1\" = \"#BBEDA7\",  \n  \"2\" = \"#F3D8FA\",  \n  \"3\" = \"#FFECA1\",  \n  \"4\" = \"#D9E6F7\",  \n  \"5\" = \"#EFBEC6\"   \n)\nHeatmap(discrete_mat, name = \"mat\", col = colors,\n        column_title = \"Customize discrete variable colors\")\n\n\n\n\n\n\n\nFigureÂ 5: Customize discrete variable colors\n\n\n\n\n\n\n\n2.2 Border customization\n\n# Border customization\nHeatmap(data_TCGA, name = \"Methylation\", \n        border = \"black\", # The border value can be FALSE or color\n        rect_gp = gpar(col = \"white\", lwd = 2), # lty line type, lwd line width\n        column_title = \"Border customization\")\n\n\n\n\n\n\n\nFigureÂ 6: Border customization\n\n\n\n\n\n\n\n\n3. Clustering\nYou can customize clustering methods, dendrogram position, size, etc.\n\n# Clustering\nHeatmap(data_TCGA, name = \"Methylation\", \n       # row_dend_side = \"right\", \n       # column_dend_side = \"bottom\", # Adjustable tree view position\n        column_dend_height = unit(1, \"cm\"), \n        row_dend_width = unit(1, \"cm\"), # Adjustable dendrogram distance\n        column_title = \"èšç±»è‡ªå®šä¹‰\",\n        clustering_distance_rows = \"pearson\", # Clustering method, you can set your own function\n      # show_parent_dend_line = FALSE  # Can hide dotted lines\n        ) \n\n\n\n\n\n\n\nFigureÂ 7: Clustering\n\n\n\n\n\nDendrogram rendering\nWe also use the dendextend package to color the dendrogram\n\n# Dendrogram rendering\nrow_dend = as.dendrogram(hclust(dist(data_TCGA)))\nrow_dend = color_branches(row_dend, k = 2)  # Generate branches\n# Numbers indicate the number of colors\nHeatmap(data_TCGA, name = \"Methylation\", \n        cluster_rows = row_dend,\n      # row_dend_gp = gpar(col = \"red\")  # Customizable colors are also available\n        )\n\n\n\n\n\n\n\nFigureÂ 8: Dendrogram rendering\n\n\n\n\n\nAs shown in the figure above, the branches of the tree are different colors.\n\n\n4. Segmentation\nContinuous variables\nUse k-means clustering segmentation\n\n# Continuous variable segmentation\nHeatmap(data_TCGA, \n        name = \"Methylation\", \n        row_km = 2,  # Set the number of divisions\n        column_km = 3)\n\n\n\n\n\n\n\nFigureÂ 9: Continuous variable segmentation\n\n\n\n\n\nUsing vector segmentation\n\n# Using vector segmentation\nHeatmap(data_TCGA, name = \"Methylation\", \n        row_split = rep(c(\"A\", \"B\"), 9), \n        column_split = rep(c(\"C\", \"D\"), 10))\n\n\n\n\n\n\n\nFigureÂ 10: Using vector segmentation\n\n\n\n\n\nUsing matrix segmentation\n\n# Using matrix segmentation\nHeatmap(data_TCGA, name = \"Methylation\", \n        row_split = data.frame(rep(c(\"A\", \"B\"), 9), \n                               rep(c(\"C\", \"D\"), each = 9)))\n\n\n\n\n\n\n\nFigureÂ 11: Using matrix segmentation\n\n\n\n\n\nThe above segmentation methods can be used independently in rows and columns. Setting show_parent_dend_line = FALSE can hide the dotted line\nDiscrete variables\nsegmentation by specified rows and columns\n\n# segmentation by specified rows and columns\nHeatmap(discrete_mat, \n        name = \"mat\", \n        col = 1:4, \n        row_split = discrete_mat[,1]) # segmentation by the first column in the matrix data\n\n\n\n\n\n\n\nFigureÂ 12: segmentation by specified rows and columns\n\n\n\n\n\nParameter segmentation\nTitles, clustering parameters, etc. can be segmented based on heatmap segmentation\n\n# Parameter segmentation\nHeatmap(data_TCGA, name = \"Methylation\", \n        row_km = 2, \n        row_title_gp = gpar(col = c(\"#9A090A\", \"#0D4B99\"), font = 1:2),\n        row_names_gp = gpar(col = c(\"#748901\", \"#E6AC03\"), fontsize = c(10, 12)),\n        column_km = 3, \n        column_title_gp = gpar(fill = c(\"#BFD641\", \"#FE9900\", \"#CC6CE7\"), font = 1:3),\n        column_names_gp = gpar(col = c(\"#1D6103\", \"#E08804\", \"#5E0676\"), fontsize = c(10, 12, 8)))\n\n\n\n\n\n\n\nFigureÂ 13: Parameter segmentation\n\n\n\n\n\nAnnotation segmentation\nEdge annotations can be segmented based on heatmap segmentation\n\n# Annotation segmentation\nHeatmap(data_TCGA, name = \"Methylation\", row_km = 2, column_km = 3,\n        top_annotation = HeatmapAnnotation(foo1 = 1:20, bar1 = anno_points(runif(20))),\n        right_annotation = rowAnnotation(foo2 = 18:1, bar2 = anno_barplot(runif(18)))\n)\n\n\n\n\n\n\n\nFigureÂ 14: Annotation segmentation\n\n\n\n\n\nThe added point map, heat map, and bar map annotations in the above figure are all segmented with the main heatmap.\n\n\n5. Add labels\nAdd data\ncell_fun accepts a function that is applied to each cell in the heatmap. The functionâ€™s arguments are as follows:\n\nj: Column index (column number).\ni: Row index (row number).\nx, y: Coordinates of the cell center (in the coordinate system of the plotting device).\nwidth, height: The width and height of the cell.\nfill: The value corresponding to the cell (i.e., the value in the matrix).\n\n\n# Add data\nsmall_mat = data_TCGA[1:9, 1:9]\ncol_fun = colorRamp2(c(0, 0.5, 1), c(\"#EBA7FE\", \"white\", \"pink\"))\nHeatmap(small_mat, name = \"Methylation\", col = col_fun,\n        cell_fun = function(j, i, x, y, width, height, fill) {\n          grid.text(sprintf(\"%.1f\", small_mat[i, j]), x, y, gp = gpar(fontsize = 10))\n        })\n\n\n\n\n\n\n\nFigureÂ 15: Add data\n\n\n\n\n\n\n# Add data\nsmall_mat = data_TCGA[1:9, 1:9]\nHeatmap(small_mat, name = \"Methylation\",  col = col_fun,\n        cell_fun = function(j, i, x, y, width, height, fill) {\n          if(small_mat[i, j] &gt; 0.5) # Set the display range\n            grid.text(sprintf(\"%.1f\", small_mat[i, j]), x, y, gp = gpar(fontsize = 10)) # Add text/value\n        })\n\n\n\n\n\n\n\nFigureÂ 16: Add data\n\n\n\n\n\nThe above figure only shows data with methylation levels greater than 0.5\nAdd graphics\n\n# Add graphics\nsmall_mat = data_TCGA[1:9, 1:9]\nHeatmap(small_mat, name = \"Methylation\", col = col_fun,\n        row_km = 2, column_km = 2,\n        layer_fun = function(j, i, x, y, w, h, fill) {\n          ind_mat = restore_matrix(j, i, x, y)\n          ind = unique(c(ind_mat[1, 4], ind_mat[3, 2])) # Positioning, add graphics to each segmentation location\n          grid.points(x[ind], y[ind], pch = 16, size = unit(4, \"mm\")) # Add Point\n        }\n)\n\n\n\n\n\n\n\nFigureÂ 17: Add graphics",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "ComplexHeatmap"
    ]
  },
  {
    "objectID": "Correlation/ComplexHeatmap.html#application",
    "href": "Correlation/ComplexHeatmap.html#application",
    "title": "ComplexHeatmap",
    "section": "Application",
    "text": "Application\n\n\n\n\n\n\nFigureÂ 18: Applications of ComplexHeatmap\n\n\n\nThe figure above is an unsupervised hierarchical clustering heatmap of 59 differentially methylated ATG sites in the AVR data [1]. Red indicates high DNA methylation, and green indicates low DNA methylation.",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "ComplexHeatmap"
    ]
  },
  {
    "objectID": "Correlation/ComplexHeatmap.html#reference",
    "href": "Correlation/ComplexHeatmap.html#reference",
    "title": "ComplexHeatmap",
    "section": "Reference",
    "text": "Reference\n[1] Radhakrishna U, Albayrak S, Alpay-Savasan Z, Zeb A, Turkoglu O, Sobolewski P, Bahado-Singh RO. Genome-Wide DNA Methylation Analysis and Epigenetic Variations Associated with Congenital Aortic Valve Stenosis (AVS). PLoS One. 2016 May 6;11(5):e0154010. doi: 10.1371/journal.pone.0154010. PMID: 27152866; PMCID: PMC4859473.\n[2] Gu, Z. (2016) Complex heatmaps reveal patterns and correlations in multidimensional genomic data. Bioinformatics.Gu, Z. (2022) Complex Heatmap Visualization. iMeta.\n[3] Tal Galili (2015). dendextend: an R package for visualizing, adjusting, and comparing trees of hierarchical clustering. Bioinformatics. DOI:10.1093/bioinformatics/btv428\n[4] Wickham H, Vaughan D, Girlich M (2024). tidyr: Tidy Messy Data. R package version 1.3.1, CRAN: Package tidyr.\n[5] Gu, Z. (2014) circlize implements and enhances circular visualization in R. Bioinformatics.\n[6] Auguie B (2017). gridExtra: Miscellaneous Functions for â€œGridâ€ Graphics. R package version 2.3, CRAN: Package gridExtra.\n[7] Kolde R (2019). pheatmap: Pretty Heatmaps. R package version 1.0.12, CRAN: Package pheatmap.",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "ComplexHeatmap"
    ]
  },
  {
    "objectID": "Correlation/Heatmap.html",
    "href": "Correlation/Heatmap.html",
    "title": "Heatmap",
    "section": "",
    "text": "A heatmap is a powerful visualization tool that represents matrix values through color gradients. It is widely used to illustrate gene expression differences across sample groups, variations in compound concentrations, and pairwise sample similarities. More broadly, any tabular dataset can be structured into a heatmap to enhance interpretability.",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Heatmap"
    ]
  },
  {
    "objectID": "Correlation/Heatmap.html#example",
    "href": "Correlation/Heatmap.html#example",
    "title": "Heatmap",
    "section": "Example",
    "text": "Example\n\n\n\n\n\nIn this heatmap, rows correspond to car models (e.g., Mazda RX4, Merc 450SLC), while columns represent specific attributes (e.g., mpg for miles per gallon, hp for horsepower, wt for weight). Each cell encodes the attribute value for a given car, with higher values appearing closer to yellow.\nHierarchical clustering (dendrograms) on the top and left depict similarity relationships among rows and columns, facilitating pattern recognition and comparative analysis.\n\n\n\n\n\n\nNote\n\n\n\nNotes: The heatmap in this example provides limited insight due to the disparity in attribute scales. Attributes such as hp (horsepower) and disp (displacement) exhibit substantially higher values than others, distorting the color mapping and overshadowing lower-range features. To enhance interpretability, data normalization is required, as discussed in the following sections.",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Heatmap"
    ]
  },
  {
    "objectID": "Correlation/Heatmap.html#setup",
    "href": "Correlation/Heatmap.html#setup",
    "title": "Heatmap",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming Language: R\nDependencies:readr, ggplot2, hrbrthemes, dplyr, tidyr, viridis, tibble, htmlwidgets, RColorBrewer, plotly, remotes, d3heatmap, heatmaply, lattice, ComplexHeatmap, pheatmap, circlize, gridExtra, cowplot\n\n\n# Installing necessary packages\nif (!requireNamespace(\"readr\", quietly = TRUE)) {\n  install.packages(\"readr\")\n}\nif (!requireNamespace(\"tidyverse\", quietly = TRUE)) {\n  install.packages(\"tidyverse\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"hrbrthemes\", quietly = TRUE)) {\n  remotes::install_github(\"hrbrmstr/hrbrthemes\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"tidyr\", quietly = TRUE)) {\n  install.packages(\"tidyr\")\n}\nif (!requireNamespace(\"viridis\", quietly = TRUE)) {\n  install.packages(\"viridis\")\n}\nif (!requireNamespace(\"tibble\", quietly = TRUE)) {\n  install.packages(\"tibble\")\n}\nif (!requireNamespace(\"htmlwidgets\", quietly = TRUE)) {\n  install.packages(\"htmlwidgets\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\nif (!requireNamespace(\"plotly\", quietly = TRUE)) {\n  install.packages(\"plotly\")\n}\nif (!requireNamespace(\"d3heatmap\", quietly = TRUE)) {\n  remotes::install_github(\"talgalili/d3heatmap\")\n}\nif (!requireNamespace(\"heatmaply\", quietly = TRUE)) {\n  install.packages(\"heatmaply\")\n}\nif (!requireNamespace(\"lattice\", quietly = TRUE)) {\n  install.packages(\"lattice\")\n}\nif (!requireNamespace(\"ComplexHeatmap\", quietly = TRUE)) {\n  BiocManager::install(\"ComplexHeatmap\")\n}\nif (!requireNamespace(\"pheatmap\", quietly = TRUE)) {\n  install.packages(\"pheatmap\")\n}\nif (!requireNamespace(\"circlize\", quietly = TRUE)) {\n  install.packages(\"circlize\")\n}\nif (!requireNamespace(\"gridExtra\", quietly = TRUE)) {\n  install.packages(\"gridExtra\")\n}\nif (!requireNamespace(\"cowplot\", quietly = TRUE)) {\n  install.packages(\"cowplot\")\n}\n\n# Loading the libraries\nlibrary(readr)\nlibrary(hrbrthemes)     # Additional themes for ggplot2\nlibrary(dplyr)          # Data manipulation functions\nlibrary(tidyr)          # Data tidying functions\nlibrary(viridis)        # Color palettes for better visualization\nlibrary(tibble)         # Tidy data frames\nlibrary(htmlwidgets)    # Interactive web visualizations\nlibrary(RColorBrewer)   # Color palettes for visualizations\nlibrary(plotly)         # Interactive plots\nlibrary(d3heatmap)      # D3.js-based interactive heatmaps\nlibrary(heatmaply)      # Interactive heatmaps with ggplot2\nlibrary(lattice)        # Trellis graphics for multivariate data\nlibrary(ComplexHeatmap) # Advanced heatmap functionalities\nlibrary(pheatmap)       # Pretty heatmaps with clustering support\nlibrary(circlize)       # Circular visualizations\nlibrary(gridExtra)      # Grid layout visualization\nlibrary(cowplot)\nlibrary(tidyverse)\nlibrary(ggplot2)        # Data visualization package",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Heatmap"
    ]
  },
  {
    "objectID": "Correlation/Heatmap.html#data-preparation",
    "href": "Correlation/Heatmap.html#data-preparation",
    "title": "Heatmap",
    "section": "Data Preparation",
    "text": "Data Preparation\nThis section provides a brief tutorial using built-in R datasets (mtcars, volcano) and the TCGA-CHOL.methylation450.tsv dataset from UCSC Xena DATASETS. These datasets will be used to demonstrate heatmap visualization in R. This example demonstrates how to load and work with these datasets in R.\n\n# load built-in R datasets `mtcars`\ndata(\"mtcars\", package = \"datasets\")\nmtcars_matrix &lt;- as.matrix(mtcars)\n\n# Load and process methylation data\nraw_methylation_data &lt;- readr::read_tsv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/TCGA-CHOL.methylation450.tsv\")\n\n# Convert to matrix and clean up row/column names\nmethylation_matrix &lt;- raw_methylation_data[, -1] %&gt;%\n  as.data.frame() %&gt;%\n  `rownames&lt;-`(raw_methylation_data$Composite)\n\n# Tidy to long format\nmethylation_long &lt;- methylation_matrix %&gt;%\n  rownames_to_column(\"Composite\") %&gt;%\n  pivot_longer(cols = -Composite, names_to = \"Sample\", values_to = \"Methylation_Level\") %&gt;%\n  mutate(\n    Methylation_Level = as.numeric(Methylation_Level),\n    Composite = gsub(\"^cg0+\", \"cg\", Composite),\n    Sample = substr(Sample, 9, 12)\n  )\n\n# Standardize methylation values\nmethylation_long_standardized &lt;- methylation_long %&gt;%\n  group_by(Composite) %&gt;%\n  mutate(Standardized_Level = scale(Methylation_Level)[,1]) %&gt;%\n  ungroup()\n\n# Convert back to wide format matrix\nstandardized_methylation_matrix &lt;- methylation_long_standardized %&gt;%\n  select(Composite, Sample, Standardized_Level) %&gt;%\n  pivot_wider(names_from = Sample, values_from = Standardized_Level) %&gt;%\n  column_to_rownames(\"Composite\") %&gt;%\n  as.matrix()\n\n\n# Clean up raw methylation matrix (numerical version for raw heatmap)\nmethylation_matrix_num &lt;- methylation_matrix %&gt;%\n  mutate(across(everything(), ~ as.numeric(as.character(.)))) %&gt;%\n  `rownames&lt;-`(gsub(\"^cg0+\", \"cg\", rownames(.))) %&gt;%\n  { `colnames&lt;-`(., substr(colnames(.), 9, 12)) } %&gt;%\n  as.matrix()",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Heatmap"
    ]
  },
  {
    "objectID": "Correlation/Heatmap.html#visualization",
    "href": "Correlation/Heatmap.html#visualization",
    "title": "Heatmap",
    "section": "Visualization",
    "text": "Visualization\n\n1. Basic R Heatmaps\n\n1.1 Basic Heatmap\nUsing the heatmap() function to construct a heatmap. Below is the simplest heatmap created in base R without additional parameters. The heatmap() function requires a matrix as input. If the data is in a data frame, it can be converted into a matrix using the as.matrix() function. A matrix can also be transposed using the t() function, which swaps rows and columns, effectively exchanging the X and Y axes.\n\nheatmap(mtcars_matrix)\n\n\n\n\n\n\n\nFigureÂ 1: Basic Heatmap Basic R\n\n\n\n\n\nThis heatmap uses color variations to display numerical differences between performance variables of various cars in the mtcars dataset.\n\n\n\n\n\n\nTip\n\n\n\nThis heatmap is not particularly insightful because the variables hp and disp with relatively high values dominate the scale. Consequently, variations in other variables (e.g., mpg, wt) are hard to discern. Standardizing the data, as discussed in the next section, is necessary.\n\n\n\n\n1.2 Standardization\nThe scale parameter in the heatmap() function can be used to standardize the matrix. It can be applied to rows or columns. Here, columns are chosen since we aim to capture variations between columns.\n\nheatmap(mtcars_matrix, scale=\"column\")\n\n\n\n\n\n\n\nFigureÂ 2: Standardization Basic R\n\n\n\n\n\nThis heatmap presents standardized values of performance variables in the mtcars dataset, making comparisons across variables on a common scale and improving the visual accuracy and interpretability.\n\n\n1.3 Clustering Dendrograms and Reordering\nIn the generated heatmap, the order of rows and columns differs from the original mtcars matrix because heatmap() applies clustering algorithms to reorder variables and observations. It calculates distances between pairs of rows and columns and sorts them based on similarities.\nAdditionally, dendrograms are displayed alongside the heatmap. These can be disabled using the Rowv and Colv parameters, as shown below.\n\nheatmap(mtcars_matrix, Colv = NA, Rowv = NA, scale=\"column\")\n\n\n\n\n\n\n\nFigureÂ 3: Clustering Dendrograms and Reordering Basic R\n\n\n\n\n\nThis heatmap shows the standardized values of performance variables in the mtcars dataset, with the dendrograms removed to maintain the original order of rows and columns.\n\n\n1.4 Color Palettes\nHeatmaps can utilize different color palettes:\n\nBuilt-in R palettes: terrain.colors(), rainbow(), heat.colors(), topo.colors(), cm.colors()\nPalettes suggested by the RColorBrewer package\nCustom color palettes\n\n\n# Native color palette\nheatmap(mtcars_matrix, scale=\"column\", col = cm.colors(256))\nheatmap(mtcars_matrix, scale=\"column\", col = terrain.colors(256))\n\n# Using Rcolorbrewer\ncoul &lt;- colorRampPalette(brewer.pal(8, \"PiYG\"))(25)\nheatmap(mtcars_matrix, scale=\"column\", col = coul)\n\n# Custom color palette\nmy_palette &lt;- colorRampPalette(c(\"blue\", \"white\", \"red\"))(256)\nheatmap(mtcars_matrix, scale = \"column\", col = my_palette)\n\n\n\n\n\n\n\nFigureÂ 4: Color Palettes Basic R\n\n\n\n\n\n\n\n\n\n\n\nFigureÂ 5: Color Palettes Basic R\n\n\n\n\n\n\n\n\n\n\n\nFigureÂ 6: Color Palettes Basic R\n\n\n\n\n\n\n\n\n\n\n\nFigureÂ 7: Color Palettes Basic R\n\n\n\n\n\nThe following four heatmaps demonstrate the same data using different color palettes. These highlight the differences in performance variables of cars in the mtcars dataset, emphasizing how palette selection can influence visual interpretation and clarity.\n\nRColorBrewer\nThe display.brewer.all() function in the RColorBrewer package showcases all available color schemes.\n\npar(plt=c(0.1,1,0,1))\ndisplay.brewer.all()\n\n\n\n\n\n\n\nFigureÂ 8: RColorBrewer Basic R\n\n\n\n\n\nThe image displays color scheme names on the left and their respective colors on the right. These schemes fall into three categories: - Sequential (seq): Gradual variations of a single color, suitable for continuous or ordered categorical variables. - Qualitative (qual): Highly distinct colors without hierarchical relationships, ideal for unordered categorical variables. - Diverging (div): Two colors transitioning in opposite directions, often used for continuous variables with meaningful midpoint values (e.g., temperature or odds ratios).\n\n\n\n1.5 Customizing Layout\nHeatmaps can be customized using standard parameters like main for the title and xlab/ylab for axis labels. Additionally, labRow/colRow allow changes to labels, while cexRow/cexCol adjust their sizes.\n\n# Custom titles and axis titles\np5 &lt;- heatmap(mtcars_matrix, Colv = NA, Rowv = NA, scale=\"column\", col = coul, xlab=\"variable\", main=\"heatmap\")\n\n# Custom labels\np6 &lt;- par(mar = c(5, 0, 4, 2))  # Adjust margins\nheatmap(mtcars_matrix, scale=\"column\", cexRow=.8, labRow=paste(\"new_\", rownames(mtcars_matrix),sep=\"\"), col= colorRampPalette(brewer.pal(8, \"Blues\"))(25))\n\n\n\n\n\n\n\nFigureÂ 9: Customizing Layout Basic R\n\n\n\n\n\n\n\n\n\n\n\nFigureÂ 10: Customizing Layout Basic R\n\n\n\n\n\nThe following two heatmaps illustrate standardized performance variables in the mtcars dataset with customized titles, axis labels, and row annotations, improving visual clarity and data communication.\n\n\n1.6 Heatmaps with Color Annotations\nHeatmaps are often used to compare observed structures against expected ones. TheRowSideColors parameter can add a color vector to the side of a heatmap to indicate expected groupings.\n\nmy_group &lt;- as.numeric(as.factor(substr(rownames(mtcars_matrix), 1 , 1))) # Group row labels by the first letter and convert to numeric\ncolSide &lt;- brewer.pal(9, \"Set1\")[my_group] # Use the Set1 color scheme from RColorBrewer to generate 9 colors, assigning each group a color\ncolMain &lt;- colorRampPalette(brewer.pal(8, \"Blues\"))(25)\nheatmap(mtcars_matrix, Colv = NA, Rowv = NA, scale=\"column\" , RowSideColors=colSide, col=colMain)\n\n\n\n\n\n\n\nFigureÂ 11: Heatmaps with Color Annotations Basic R\n\n\n\n\n\nThe heatmap below groups rows by their first letters and assigns a distinct color to each group, helping observers quickly identify differences between groups and understand data patterns more intuitively.\n\n\n\n2. ggplot2 Heatmaps\nThe ggplot2 package uses the geom_tile() function to create heatmaps. Unlike heatmap(), it doesnâ€™t natively support standardization, clustering, or dendrograms.\n\n2.1 Basic Heatmap\nA basic heatmap created with ggplot2 and geom_tile(). Standardization must be performed beforehand, as geom_tile() cannot directly standardize data.\nThe input data must be in a long-format data frame, where each row represents one observation with three key variables:\n\nx: Position on the X-axis\ny: Position on the Y-axis\nfill: Numerical values mapped to colors\n\n\np &lt;- ggplot(methylation_long_standardized, aes(x = Sample, y = Composite, fill= Standardized_Level)) + \n  geom_tile()\n\np \n\n\n\n\n\n\n\nFigureÂ 12: Basic Heatmap ggplot2\n\n\n\n\n\nThis heatmap demonstrates the distribution of standardized methylation levels (Standardized_Level) in the TCGA-CHOL dataset across samples (Sample) and composites (Composite), highlighting differences in methylation patterns.\n\n\n2.2 Color Palettes\nHeatmaps can have their color palettes customized, just like any ggplot2 chart. Below are three examples using different approaches:\n\nscale_fill_gradient(): Sets the extreme colors of the palette.\nscale_fill_distiller()): Uses ColorBrewer palettes.\nscale_fill_viridis() Implements the Viridis palette. Remember to set discrete=FALSE for continuous variables (ensuring smooth color gradients).\n\n\n# Extreme colors\np7 &lt;- ggplot(methylation_long_standardized, aes(x = Sample, y = Composite, fill= Standardized_Level)) + \n  geom_tile()+\n  scale_fill_gradient(low=\"white\", high=\"blue\") +\n  theme_ipsum() +\n  theme(axis.text.x = element_text(size = 10))\n\n# ColorBrewer color palette\np8 &lt;- ggplot(methylation_long_standardized, aes(x = Sample, y = Composite, fill= Standardized_Level)) + \n  geom_tile() +\n  scale_fill_distiller(palette = \"RdPu\") +\n  theme_ipsum() +\n  theme(axis.text.x = element_text(size = 10)) \n\n# Using Viridis\np9 &lt;- ggplot(methylation_long_standardized, aes(x = Sample, y = Composite, fill= Standardized_Level)) + \n  geom_tile()+\n  scale_fill_viridis(discrete=FALSE) +\n  theme_ipsum() + \n  theme(axis.text.x = element_text(size = 10))\n\nplot_grid(p7, p8, p9, ncol = 3)\n\n\n\n\n\n\n\nFigureÂ 13: Color Palettes ggplot2\n\n\n\n\n\nThese three heatmaps showcase identical data from the TCGA-CHOL dataset, illustrating the distribution of standardized methylation levels between various samples and composites. They emphasize the importance of palette choice for visual impact and data interpretation.\n\n\n2.3 Handling Wide-Format Data\nA common issue involves input in a wide matrix format, such as the volcano dataset. In such cases, the gather() function from the tidyr package can transform the data into a long format suitable for visualization with ggplot.\n\nvolcano %&gt;%\n  as_tibble() %&gt;%\n  rowid_to_column(var=\"X\") %&gt;%\n  gather(key=\"Y\", value=\"Z\", -1) %&gt;%\n  \n  mutate(Y=as.numeric(gsub(\"V\",\"\",Y))) %&gt;%\n\n  ggplot(aes(X, Y, fill= Z)) + \n    geom_tile() +\n    theme_ipsum() +\n    theme(legend.position=\"none\")\n\n\n\n\n\n\n\nFigureÂ 14: Handling Wide-Format Data\n\n\n\n\n\nThis heatmap represents the elevation values (Z) in the volcano dataset. The x-axis indicates row indices (X), the y-axis represents column indices (Y), and color fill depicts changes in elevation.\n\n\n2.4 Interactive Heatmaps\nOne of the significant advantages of creating heatmaps with ggplot2 is the ability to make them interactive using the plotly package. Simply wrap the plot in an object and pass it to the ggplotly() function.\nYou can also customize tooltips to provide richer information. Try hovering over a cell to view tooltips or zoom in on specific areas.\n\n# Create tooltips text\nmethylation_long_annotated &lt;- methylation_long_standardized %&gt;%\n  mutate(text = paste0(\"Composite: \",Composite, \"\\n\", \"Sample: \", Sample, \"\\n\", \"Standardized_Level: \", Standardized_Level))\n\np &lt;- ggplot(methylation_long_annotated, aes(Composite, Sample, fill = Standardized_Level, text = text)) + \n  geom_tile() +\n  theme_ipsum()\n\npp &lt;- ggplotly(p, tooltip=\"text\", width = 1200, height = 700)\n\npp\n\n\n\n\n\n\n\nFigureÂ 15: Interactive Heatmaps\n\n\n\n\nThis interactive heatmap, built with the plotly package, allows dynamic exploration and in-depth data analysis, offering a more intuitive understanding and information retrieval process.\nAlternative packages like d3heatmap and heatmaply can also create interactive heatmaps.\n\nUsing the d3heatmap Package\n\nd3heatmap(standardized_methylation_matrix, scale = \"row\", dendrogram = \"none\")\n\n\n\n\n\n\n\nFigureÂ 16: Using d3heatmap ggplot2\n\n\n\n\nThe d3heatmap package creates interactive heatmaps, enabling dynamic exploration and deeper insights into data.\n\n\nUsing the heatmaply Package\n\np &lt;- heatmaply(standardized_methylation_matrix,\n               dendrogram = \"none\",\n               xlab = \"\", ylab = \"\",\n               main = \"\",\n               scale = \"row\",\n               margins = c(50,0,30,30),\n               grid_color = \"white\",\n               grid_width = 0.00001,\n               titleX = FALSE,\n               hide_colorbar = TRUE,\n               branches_lwd = 0.1,\n               fontsize_row = 5, fontsize_col = 5,\n               labCol = colnames(standardized_methylation_matrix),\n               labRow = rownames(standardized_methylation_matrix),\n               heatmap_layers = theme(axis.line = element_blank())\n)\n\np\n\n\n\n\n\n\n\nFigureÂ 17: Using heatmaply ggplot2\n\n\n\n\nSimilarly, the heatmaply package generates interactive heatmaps, allowing for dynamic analysis and enhanced comprehension of the data.\n\n\n\n\n3. lattice Heatmaps\nThe lattice package provides the levelplot() function for constructing heatmaps.\n\n3.1 Basic Usage of levelplot()\n\n# Convert the Sample and Composite columns from characters to factors\nmethylation_long_standardized$Sample &lt;- as.factor(methylation_long_standardized$Sample)\nmethylation_long_standardized$Composite &lt;- as.factor(methylation_long_standardized$Composite) \n\nlevelplot(Standardized_Level ~ Sample * Composite, data = methylation_long_standardized,\n          xlab = \"Sample\", ylab = \"Composite\",\n          main = \"Heatmap of Standardized TCGA-CHOL Methylation Levels\")\n\n\n\n\n\n\n\nFigureÂ 18: Basic Heatmap lattice\n\n\n\n\n\nThis heatmap illustrates the distribution of standardized methylation levels between samples and composites in the TCGA-CHOL dataset, highlighting variations in methylation states across different samples.\n\n\n3.2 Wide-Format Matrix Input\nUnlike the earlier example with long-format data, this approach uses a square matrix.\n\n\n\n\n\n\nTip\n\n\n\nRows and columns are flipped in the heatmap.\n\n\n\nlevelplot(standardized_methylation_matrix)\n\n\n\n\n\n\n\nFigureÂ 19: Wide-Format Matrix Input lattice\n\n\n\n\n\nThis heatmap demonstrates variations in methylation states across TCGA-CHOL samples using a wide-format matrix in levelplot().\n\n\n3.3 Flipping Axes\nRâ€™s t() function transposes the input matrix, flipping the x and y coordinates. This makes the heatmapâ€™s structure align precisely with the input matrix.\nSetting aspect = \"fill\" adjusts the aspect ratio automatically to reflect the matrixâ€™s actual proportions.\n\n# Flip X and Y axes\nlevelplot( t(standardized_methylation_matrix),\n           col.regions=heat.colors(220),\n           aspect = \"fill\") # Automatically adjust aspect ratio\n\n\n\n\n\n\n\nFigureÂ 20: Flipping Axes lattice\n\n\n\n\n\nThis heatmap reflects the same data as the original matrix with flipped coordinates for structural alignment.\n\n\n3.4 Color Palettes\nMultiple palette options are available: - Native R palettes: terrain.color()ï¼Œ rainbow()ï¼Œheat.colors()ï¼Œ topo.colors()ï¼Œcm.colors() - RColorBrewerpalettes - Viridispalettes: viridis, magma, inferno, plasma\n\n# Native color palette\np10 &lt;- levelplot(volcano, col.regions = terrain.colors(100)) # try cm.colors() or terrain.colors()\np10\n\n# Using Rcolorbrewer\ncoul &lt;- colorRampPalette(brewer.pal(8, \"PiYG\"))(25)\np11 &lt;- levelplot(volcano, col.regions = coul)\np11\n\n# Using Viridis\ncoul &lt;- viridis(100)\np12 &lt;- levelplot(volcano, col.regions = coul) \np12\n\n\n\n\n\n\n\nFigureÂ 21: Color Palettes lattice\n\n\n\n\n\n\n\n\n\n\n\nFigureÂ 22: Color Palettes lattice\n\n\n\n\n\n\n\n\n\n\n\nFigureÂ 23: Color Palettes lattice\n\n\n\n\n\nUsing the volcano dataset, these heatmaps visualize elevation values and emphasize the impact of palette selection on interpretability.ã€‚\n\n\n\n4. pheatmap Heatmaps\nThe pheatmap package also builds heatmaps and supports data standardization.\n\n4.1 Basic Heatmap\n\npheatmap(methylation_matrix_num, scale = \"row\")\n\n\n\n\n\n\n\nFigureÂ 24: Basic Heatmap\n\n\n\n\n\nThis heatmap visualizes differences in methylation patterns across samples in the TCGA-CHOL dataset using the pheatmap package.\n\n\n4.2 Adjusting Dendrograms\n\nclustering_distance_rows and clustering_distance_cols represent the distance measures used for row and column clustering. The default is â€œeuclideanâ€, but it can also be set to â€œcorrelationâ€, meaning clustering will be performed based on the Pearson correlation method.\nclustering_method allows modification of the clustering method, which can be one of the following: â€˜wardâ€™, â€˜ward.Dâ€™, â€˜ward.D2â€™, â€˜singleâ€™, â€˜completeâ€™, â€˜averageâ€™, â€˜mcquittyâ€™, â€˜medianâ€™, or â€˜centroidâ€™.\n\n\npheatmap(methylation_matrix_num, scale = \"row\", \n         clustering_distance_rows = \"euclidean\", clustering_distance_cols = \"euclidean\", # Distance measure used for clustering\n         clustering_method = \"complete\", # Clustering method\n         cluster_rows = T, cluster_cols = F, # Whether to display clustering trees\n         treeheight_row = 30, treeheight_col = 30) # Adjust clustering tree heights\n\n\n\n\n\n\n\nFigureÂ 25: è°ƒæ•´èšç±»å›¾\n\n\n\n\n\nThis heatmap uses the pheatmap package to display the differences in methylation status across different samples in the TCGA-CHOL dataset, with clustering between samples turned off. The samples are arranged in their original order.\n\n\n4.3 Angle Adjustment of Labels and Segmentation Position Without Clustering\n\npheatmap(methylation_matrix_num, scale = \"row\", \n         clustering_distance_rows = \"euclidean\", clustering_distance_cols = \"euclidean\", # Distance measure used for clustering\n         clustering_method = \"complete\", # Clustering method\n         cluster_rows = T, cluster_cols = F, # Whether to display clustering trees\n         treeheight_row = 30, treeheight_col = 30, # Adjust clustering tree heights\n         angle_col = \"45\", # Change column label angle\n         gaps_col = c(3,6))  # Used only when column clustering is not performed, assuming samples are split into three groups at positions 3 and 6\n\n\n\n\n\n\n\nFigureÂ 26: Angle Adjustment of Labels and Segmentation Position Without Clustering\n\n\n\n\n\nAdjusting the label angles in this heatmap can prevent overlapping labels and improve readability. Adjusting the segmentation position under non-clustered conditions can highlight differences between specific samples, facilitating intuitive analysis.\n\n\n4.4 Adding Values or Markers\n\npheatmap(methylation_matrix_num, scale = \"row\",\n         border_color = \"white\", # Change cell border color\n         display_numbers = TRUE, # Display corresponding values in heatmap cells\n         fontsize_number = 9, \n         number_color = \"grey30\",\n         number_format = \"%.1f\") # Keep one decimal place\n\n\n\n\n\n\n\nFigureÂ 27: Adding Values or Markers\n\n\n\n\n\nAdding values or markers to the heatmap provides additional context, helping observers quickly identify the specific methylation level of each sample or site, thereby enhancing the intuitiveness and accuracy of data interpretation.\n\nUsing Raw Data for Annotation\n\npheatmap(methylation_matrix_num, scale = \"row\",\n         border_color = \"white\",\n         display_numbers = matrix(ifelse(methylation_matrix_num &gt; .8 | methylation_matrix_num &lt; -.8, \"*\", \"\"), nrow = nrow(methylation_matrix_num)),\n         fontsize_number = 9, \n         number_color = \"grey30\")\n\n\n\n\n\n\n\nFigureÂ 28: Using Raw Data for Annotation\n\n\n\n\n\nThis heatmap uses unnormalized data for annotation, making the results incomparable and potentially misleading observers regarding the differences between samples. Unnormalized values may obscure actual relative changes due to absolute value differences between samples, reducing the accuracy of data interpretation.\n\n\nUsing Normalized Data\n\npheatmap(standardized_methylation_matrix, scale = \"none\", # No need for further standardization\n         border_color = \"white\",\n         display_numbers = matrix(ifelse(standardized_methylation_matrix &gt; 1 | standardized_methylation_matrix &lt; -1, \"*\", \"\"), nrow = nrow(standardized_methylation_matrix)),\n         fontsize_number = 9, \n         number_color = \"grey30\") \n\n\n\n\n\n\n\nFigureÂ 29: Using Normalized Data\n\n\n\n\n\nMarking the heatmap with normalized data can intuitively highlight significant values or features, making it easier for observers to recognize notable methylation state changes or outliers, thus providing guidance for subsequent analysis. This approach enhances the readability and interpretability of the data, helping users quickly extract key information.\n\n\n\n4.5 Color Palettes\nThe heatmap generated by the pheatmap package allows for various ways to modify the color palette: - Native R palettes:terrain.color()ï¼Œ rainbow()ï¼Œheat.colors()ï¼Œ topo.colors()ï¼Œcm.colors() - Custom palettes - RColorBrewer palettes\n\n# Native color palette\np13 &lt;- pheatmap(standardized_methylation_matrix, scale = \"none\",\n         border_color = \"white\",\n         color = colorRampPalette(c(\"navy\",\"white\",\"firebrick3\"))(100))\n\n# Custom color palette\np14 &lt;- pheatmap(standardized_methylation_matrix, scale = \"none\",\n         border_color = \"white\",\n         color = cm.colors(100))\n\n# Using Rcolorbrewer\ncoul &lt;- colorRampPalette(brewer.pal(8, \"PiYG\"))(25)\np15 &lt;- pheatmap(standardized_methylation_matrix, scale = \"none\",\n         border_color = \"white\",\n         color = coul)\n\n\n\n\n\n\n\nFigureÂ 30: è°ƒè‰²æ¿\n\n\n\n\n\n\n\n\n\n\n\nFigureÂ 31: è°ƒè‰²æ¿\n\n\n\n\n\n\n\n\n\n\n\nFigureÂ 32: è°ƒè‰²æ¿\n\n\n\n\n\nThese three heatmaps use different color palettes to showcase the differences in methylation states among samples in the TCGA-CHOL dataset, emphasizing the importance of palette choice for visual effects and data interpretation.\n\n\n\n5. complexheatmap Heatmaps\nThe ComplexHeatmap package, based on the grid package, uses an object-oriented approach to implement heatmaps and their components. It mainly includes the following classes:\n\nHeatmapï¼šDraws a single heatmap (note the capitalization).\nHeatmapListï¼šDraws a list of heatmaps.\nHeatmapAnnotation: Defines row and column annotations for the heatmap, which can either be part of the heatmap or independent of it.\n\nAdditionally, there are some internal classes:\n\nSingleAnnotationï¼š: Defines a single row or column annotation, forming the list elements of HeatmapAnnotation.\nColorMapping: Defines the mapping of values to colors.\nAnnotationFunction: Used to customize annotation graphics.\n\n\n5.1 Basic Heatmap\n\nHeatmap(standardized_methylation_matrix)\n\n\n\n\n\n\n\nFigureÂ 33: Basic Heatmap complexheatmap\n\n\n\n\n\nThis heatmap uses the ComplexHeatmap package to display the differences in methylation status across different samples in the TCGA-CHOL dataset.\n\n\n5.2 Color Palettes\nUsually, the matrices we plot consist of continuous data, so the color mapping function needs to take a vector as input and return a vector as output.\nThe author of this package recommends using the colorRamp2() function from another package, circlize, to set up color mapping. The colorRamp2() function takes two parameters: the first sets the breakpoint values for mapping, and the second specifies the corresponding color values.\nIn the example below, values between -2 and 2 are linearly interpolated to obtain corresponding colors, with values greater than 2 mapped to red and values less than -2 mapped to green.\n\ncol_fun &lt;- colorRamp2(c(-2, 0, 2), c(\"green\", \"white\", \"red\"))\nHeatmap(standardized_methylation_matrix, name = \"Standardized_Level\", col = col_fun)\n\n\n\n\n\n\n\nFigureÂ 34: Color Palettes complexheatmap\n\n\n\n\n\nThis heatmap uses colorRamp2() to set up color mapping, showcasing the differences in methylation states among samples in the TCGA-CHOL dataset.\nAdditionally, using colorRamp2() ensures color comparability across multiple heatmaps. For example, in two heatmaps, the same color always corresponds to the same value:\n\np1 &lt;- Heatmap(standardized_methylation_matrix, name = \"Standardized_Level1\", col = col_fun)\np2 &lt;- Heatmap(standardized_methylation_matrix/2, name = \"Standardized_Level2\", col = col_fun)\np1 + p2 \n\n\n\n\n\n\n\nFigureÂ 35: Using colorRamp2 complexheatmap\n\n\n\n\n\nThis heatmap uses colorRamp2() to enable color comparisons on the same scale, showcasing the differences in methylation states among samples in the TCGA-CHOL dataset.\nIf the matrix is continuous, you can simply provide a color vector, and the colors will be linearly interpolated. However, this method is not robust to outliers, as color mapping is determined by the minimum and maximum values in the matrix. Extreme outliers can cause less noticeable color variations within the normal range.\n\nHeatmap(standardized_methylation_matrix, name = \"Standardized_Level\", col = rev(cm.colors(10)), column_title = \"color vector for continuous matrix\")\n\n\n\n\n\n\n\nFigureÂ 36: Using Color Vector complexheatmap\n\n\n\n\n\nThis heatmap demonstrates color mapping through linear interpolation, showing the differences in methylation states among samples in the TCGA-CHOL dataset.\nYou can also visualize NA values using the na_col parameter to specify the color for NA:\n\nstandardized_methylation_matrix_na &lt;- standardized_methylation_matrix\nna_index &lt;- sample(c(TRUE, FALSE), nrow(standardized_methylation_matrix)*ncol(standardized_methylation_matrix), replace = TRUE, prob = c(1, 9))\nstandardized_methylation_matrix_na[na_index] &lt;- NA\nHeatmap(standardized_methylation_matrix_na, name = \"matrix with na\", na_col = \"grey\", column_title = \"matrix with na\")\n\n\n\n\n\n\n\nFigureÂ 37: Using na_col Parameter complexheatmap\n\n\n\n\n\nThis heatmap uses the na_col parameter to set the color of NA values to gray, showcasing the differences in methylation states among samples in the TCGA-CHOL dataset.\nBy default, linear interpolation of colors follows the LAB color space. Other color spaces, such as RGB, XYZ, and sRGB, are also available.\n\nf1 &lt;- colorRamp2(seq(min(standardized_methylation_matrix), max(standardized_methylation_matrix), length = 3), c(\"blue\", \"#EEEEEE\", \"red\"))\nf2 &lt;- colorRamp2(seq(min(standardized_methylation_matrix), max(standardized_methylation_matrix), length = 3), c(\"blue\", \"#EEEEEE\", \"red\"), space = \"RGB\")\n\np1 &lt;- Heatmap(standardized_methylation_matrix, name = \"Standardized_Level1\", col = f1, column_title = \"color space in LAB\")\np2 &lt;- Heatmap(standardized_methylation_matrix, name = \"Standardized_Level2\", col = f2, column_title = \"color space in RGB\")\np1 + p2\n\n\n\n\n\n\n\nFigureÂ 38: Different Linear Interpolation complexheatmap\n\n\n\n\n\nThis heatmap illustrates the differences in methylation states among samples in the TCGA-CHOL dataset across various color spaces.\n\n\n5.3 Borders and Gridlines\nThe outermost border of the heatmap is set using the border parameter, while gridlines are configured with the rect_gp parameter.\nThe border parameter can be a logical or a color value. The rect_gp parameter requires a grid::gpar object.\n\nHeatmap(standardized_methylation_matrix, name = \"Standardized_Level\", border = \"black\", col = col_fun, rect_gp = gpar(col = \"white\", lwd = 2) )\n\n\n\n\n\n\n\nFigureÂ 39: Borders and Gridlines complexheatmap\n\n\n\n\n\nThis heatmap modifies the borders and gridlines to show the differences in methylation states among samples in the TCGA-CHOL dataset.\n\n\n5.4 Clustering\nAdjusting the cluster_rows and cluster_columns parameters modifies the clustering of the heatmap.\n\np1 &lt;- Heatmap(standardized_methylation_matrix, cluster_rows = F, cluster_columns = F)\np1\n\n\n\n\n\n\n\nFigureÂ 40: Clustering complexheatmap\n\n\n\n\n\nThis heatmap disables clustering, highlighting the differences in methylation states among samples in the TCGA-CHOL dataset.\n\n\n5.5 Annotation Bars and Multiple Heatmaps\nAnnotation bars are an important component of heatmaps. The ComplexHeatmap package provides flexible settings for annotation bars, which can be placed on any of the four sides of the heatmap (top, bottom, left, or right) using top_annotation, bottom_annotation, left_annotation, and right_annotation. All annotation bars are created using the HeatmapAnnotation() function (alternatively, the rowAnnotation() function can be used as a variant by specifying HeatmapAnnotation(..., which = \"row\")).\n\np1 &lt;- rowAnnotation(\n  \"Average Methylation\" = anno_barplot(\n    rowMeans(standardized_methylation_matrix), \n    gp = gpar(fill = \"blue\"), \n    width = unit(4, \"cm\"),\n    axis_param = list(at = pretty(rowMeans(standardized_methylation_matrix)), \n                      labels = format(pretty(rowMeans(standardized_methylation_matrix)), nsmall = 1, digits = 1))\n  )\n)\n\np2 &lt;- Heatmap(standardized_methylation_matrix, \n               name = \"Standardized Methylation Levels\", \n               col = f2, \n               row_km = 2,\n               column_names_gp = gpar(fontsize = 8))  # Based on row clustering\n\np1 + p2\n\n\n\n\n\n\n\nFigureÂ 41: Multiple Heatmaps complexheatmap\n\n\n\n\n\nThis bar chart serves as an annotation bar for the heatmap, displaying the average methylation value for each site.\nOne of the standout features of the ComplexHeatmap package is its ability to plot multiple heatmaps simultaneously. The example below shows horizontally arranged heatmaps; vertically arranged heatmaps follow a similar principle. Horizontally aligned heatmaps require the same rows.\nThe combination of the heatmap and bar chart displays differences in methylation states among samples in the TCGA-CHOL dataset and the average methylation value for each site.",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Heatmap"
    ]
  },
  {
    "objectID": "Correlation/Heatmap.html#applications",
    "href": "Correlation/Heatmap.html#applications",
    "title": "Heatmap",
    "section": "Applications",
    "text": "Applications\n\n1. Basic Heatmap\n\n\n\n\n\n\nYang, M., Liu, B. et al.(2013)\n\n\n\n\nFigureÂ 42: Applications of Basic Heatmap\n\n\n\nFigure 2: Heatmaps of TEC matching from 52 healthy individuals. (a) Raw heatmap. (b) Binary heatmap. [1]\n\n\n2. Heatmaps with Color Annotations\n\n\n\n\n\n\nKey, M. (2012)\n\n\n\n\nFigureÂ 43: Applications of Heatmaps with Color Annotations\n\n\n\nFigure 6: Grouping by labels. All heatmap functions support row and column annotations, but implementations vary. Heatmap (a) and heatmap.2 (b) functions support displaying only a single color bar. Heatmap.plus (c) supports displaying a matrix of colored bars. Heatmap_plus (d) can display data frames for binary variables. Although heatmap.2 and heatmap.plus can generate rectangular images, heatmap and heatmap_plus output square images. [2]\n\n\n3. Comparative Heatmaps\n\n\n\n\n\n\nHoggard, T. et al.(2016)\n\n\n\n\nFigureÂ 44: Applications of Comparative Heatmaps\n\n\n\nFigure 6: Comparative heatmaps for miniARS experiments to resolve ambiguities in partitioning and replication functions associated with miniARS chromosomal fragments. Fragments depleted in the Cen-miniARS or Acen-miniARS experiments (e.g., miniARS317 fragments) compared to fragments enriched in these experiments. (B) Shared fragments in the miniARS datasets located in the given competition fitness deciles (i.e., fragments present in both Acen-miniARS and Cen-miniARS libraries) are represented in this heatmap. The heatmap is divided into 100 sections, each representing a combination of competition fitness deciles in the Acen-miniARS and Cen-miniARS experiments, as shown: Bottom-left: Fragments with low competition fitness in both Acen- and Cen-miniARS, indicating weak replication and partitioning abilities. (Partitioning â€œâˆ’â€; Replication â€œâˆ’â€). Contains 288 fragments representing 62 origins. Bottom-right: Fragments with high competition fitness in Acen-miniARS but low in Cen-miniARS, indicating strong partitioning but weak replication abilities (Partitioning â€œ+â€; Replication â€œâˆ’â€). Contains 103 fragments representing 32 origins. Top-left: Fragments with low competition fitness in Acen-miniARS but high in Cen-miniARS, indicating weak partitioning but strong replication abilities (Partitioning â€œâˆ’â€; Replication â€œ+â€). Contains 105 fragments representing 33 origins. (C) Combination analysis of the fragments from (B), aiming to define regions critical for maximizing partitioning abilities (1st and 4th pairs of heatmaps) versus replication abilities (2nd and 3rd pairs of heatmaps). (D) Similar to (B), but heatmaps include only miniARS fragments indicating ARS regions.\nAbbreviations: ARS: Autonomous Replicating Sequence, FKH: Forkhead, ORC: Origin Recognition Complex, RAP1: Rap1 protein binding site [3]",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Heatmap"
    ]
  },
  {
    "objectID": "Correlation/Heatmap.html#reference",
    "href": "Correlation/Heatmap.html#reference",
    "title": "Heatmap",
    "section": "Reference",
    "text": "Reference\n\nYang, M., Liu, B., Zhao, M., Li, F., Wang, G., & Zhou, F. (2013). Normalizing electrocardiograms of both healthy persons and cardiovascular disease patients for biometric authentication. PLoS One, 8(8), e71523. https://doi.org/10.1371/journal.pone.0071523\n\nKey, M. (2012). A tutorial in displaying mass spectrometry-based proteomic data using heat maps. BMC Bioinformatics, 13(Suppl 16), S10. https://doi.org/10.1186/1471-2105-13-S16-S10\n\nHoggard, T., Liachko, I., Burt, C., Meikle, T., Jiang, K., Craciun, G., Dunham, M. J., & Fox, C. A. (2016). High throughput analyses of budding yeast ARSs reveal new DNA elements capable of conferring centromere-independent plasmid propagation. G3 (Bethesda), 6(4), 993â€“1012. https://doi.org/10.1534/g3.116.027904\n\nWickham, H. (2016). ggplot2: Elegant graphics for data analysis. Springer. https://r-graph-gallery.com/ggplot2-package.html\n\nRudis, B. (2020). hrbrthemes: Additional themes and theme components for â€˜ggplot2â€™. https://cran.r-project.org/package=hrbrthemes\n\nWickham, H., FranÃ§ois, R., Henry, L., & MÃ¼ller, K. (2021). dplyr: A grammar of data manipulation. https://cran.r-project.org/package=dplyr\n\nWickham, H., & Henry, L. (2021). tidyr: Tidy messy data. https://cran.r-project.org/package=tidyr\n\nGarnier, S. (2018). viridis: Default color maps from â€˜matplotlibâ€™. https://cran.r-project.org/package=viridis\n\nHenry, L. (2022). tibble: Simple data frames. https://cran.r-project.org/package=tibble\n\nUrbanek, S. (2021). htmlwidgets: HTML widgets for R. https://cran.r-project.org/package=htmlwidgets\n\nNeuwirth, E. (2014). RColorBrewer: ColorBrewer palettes. https://cran.r-project.org/package=RColorBrewer\n\nWinston, L., & Hsu, T. (2021). plotly: Create interactive web graphics via â€˜plotly.jsâ€™. https://cran.r-project.org/package=plotly\n\nD3heatmap: Interactive heatmaps using â€˜d3.jsâ€™. https://cran.r-project.org/package=d3heatmap\n\nGang, C. (2020). heatmaply: Interactive heat maps for R. https://cran.r-project.org/package=heatmaply\n\nBecker, R. A., Wilks, A. R., & Brownrigg, R. (2021). lattice: The lattice package for R. https://cran.r-project.org/package=lattice\n\nAuguie, B. (2017). gridExtra: Miscellaneous Functions for â€œGridâ€ Graphics. https://cran.r-project.org/package=gridExtra",
    "crumbs": [
      "<i class='fa-solid fa-diagram-project'></i> Correlation",
      "Heatmap"
    ]
  },
  {
    "objectID": "Omics/MultiSeqsAlignment.html",
    "href": "Omics/MultiSeqsAlignment.html",
    "title": "Multiple Sequences Alignment",
    "section": "",
    "text": "Multiple Sequence Alignment (MSA) is a fundamental and crucial technique in bioinformatics. It is used to align three or more biological sequences (DNA, RNA, or proteins) based on their evolutionary or structural similarities, so that homologous sites (i.e., sites derived from a common ancestor) are aligned as much as possible."
  },
  {
    "objectID": "Omics/MultiSeqsAlignment.html#example",
    "href": "Omics/MultiSeqsAlignment.html#example",
    "title": "Multiple Sequences Alignment",
    "section": "Example",
    "text": "Example"
  },
  {
    "objectID": "Omics/MultiSeqsAlignment.html#setup",
    "href": "Omics/MultiSeqsAlignment.html#setup",
    "title": "Multiple Sequences Alignment",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: ggmsa\n\n\n# Install packages\nif (!requireNamespace(\"ggmsa\", quietly = TRUE)) {\n  install.packages(\"ggmsa\")\n}\n\n# Library packages\nlibrary(ggmsa)"
  },
  {
    "objectID": "Omics/MultiSeqsAlignment.html#data-preparation",
    "href": "Omics/MultiSeqsAlignment.html#data-preparation",
    "title": "Multiple Sequences Alignment",
    "section": "Data Preparation",
    "text": "Data Preparation\nDNA/RNA/amino acid sequence data is usually stored in FASTA format, where each sequence consists of a description line (starting with â€œ&gt;â€) followed by sequence lines.\n\n# Example data\nprotein_fasta &lt;- system.file(\"extdata\", \"sample.fasta\", package = \"ggmsa\")\n\n# Data preview\nseqs &lt;- readLines(protein_fasta)\nhead(seqs)\n\n[1] \"&gt;PH4H_Rattus_norvegicus\"                                                         \n[2] \"MAAVVLENGVLSRKLSDFGQETSYIEDNSNQNGAISLIFSLKEEVGALAKVLRLFEENDINLTHIESRPSRLNKDEYEFF\"\n[3] \"TYLDKRTKPVLGSIIKSLRNDIGATVHELSRDKEKNTVPWFPRTIQELDRFANQILSYGAELDADHPGFKDPVYRARRKQ\"\n[4] \"FADIAYNYRHGQPIPRVEYTEEEKQTWGTVFRTLKALYKTHACYEHNHIFPLLEKYCGFREDNIPQLEDVSQFLQTCTGF\"\n[5] \"RLRPVAGLLSSRDFLGGLAFRVFHCTQYIRHGSKPMYTPEPDICHELLGHVPLFSDRSFAQFSQEIG-LASLGAPDEYIE\"\n[6] \"KLATIYWFTVEFGLCKEG-DSIKAYGAGLLSSFGELQYCLSD-KPKLLPLELEKTACQEYSVTEFQPLYYVAESFSDAKE\""
  },
  {
    "objectID": "Omics/MultiSeqsAlignment.html#visualization",
    "href": "Omics/MultiSeqsAlignment.html#visualization",
    "title": "Multiple Sequences Alignment",
    "section": "Visualization",
    "text": "Visualization\n\n1. Multiple sequence alignment of proteins\nThe visualization of multiple protein sequence alignment shows the alignment of multiple protein sequences in specific regions, helps identify conserved regions and mutation sites, and provides a professional color scheme for amino acid sequences.\n\n# Multiple sequence alignment of proteins\np &lt;- ggmsa(\n  protein_fasta,\n  start = 300,\n  end = 330,\n  font = \"DroidSansMono\",\n  color = \"Chemistry_AA\",\n  char_width = 0.5,\n  seq_name = TRUE,\n  consensus_views = FALSE\n)\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Multiple sequence alignment of proteins\n\n\n\n\n\n\n\n2. Multiple sequence alignment and statistics\nThe statistical chart of multiple sequence alignment results shows the conservation and variation of multiple sequences within the alignment region, helping to identify key sites and regions.\n\n# Multiple sequence alignment and statistics\np &lt;- ggmsa(\n  protein_fasta,\n  start = 300,\n  end = 320,\n  font = \"DroidSansMono\",\n  color = \"Chemistry_AA\",\n  char_width = 0.5,\n  seq_name = TRUE,\n  consensus_views = FALSE\n) +\n  geom_msaBar()\n\np\n\n\n\n\n\n\n\nFigureÂ 2: Multiple sequence alignment and statistics\n\n\n\n\n\n\n\n3. Multiple sequence alignment and Logo\nWhile performing multiple sequence alignment and displaying the alignment consensus results with a Logo, the bases or amino acids of multiple sequences are sorted and displayed in the form of a Logo.\n\n# Multiple sequence alignment and Logo\np &lt;- ggmsa(\n  protein_fasta,\n  start = 300,\n  end = 330,\n  font = \"DroidSansMono\",\n  color = \"Chemistry_AA\",\n  char_width = 0.5,\n  seq_name = TRUE,\n  consensus_views = FALSE\n) +\n  geom_seqlogo()\n\np\n\n\n\n\n\n\n\nFigureÂ 3: Multiple sequence alignment and Logo"
  },
  {
    "objectID": "Omics/CollinearityPlot.html",
    "href": "Omics/CollinearityPlot.html",
    "title": "Collinearity Plot",
    "section": "",
    "text": "Collinearity plot is often used to compare genome sequences of different species, identify conserved homologous gene blocks and their arrangement order, and reveal changes in chromosome structure during evolution. This plot is widely used in the study of genome evolution, functional gene localization, and species relationship analysis.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "CollinearityPlot"
    ]
  },
  {
    "objectID": "Omics/CollinearityPlot.html#example",
    "href": "Omics/CollinearityPlot.html#example",
    "title": "Collinearity Plot",
    "section": "Example",
    "text": "Example\n\n\n\n\n\nThis plot is a colinearity diagram of the ternary genome, where Amborella, Grape, and Liriodendron represent three different species, the long bars represent genomes, the numbers are chromosome numbers, and the lines represent the comparison between the genomes of different species. The highlighted lines represent the comparison of the genomic regions of interest.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "CollinearityPlot"
    ]
  },
  {
    "objectID": "Omics/CollinearityPlot.html#setup",
    "href": "Omics/CollinearityPlot.html#setup",
    "title": "Collinearity Plot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: RIdeogram\n\n\n# Install packages\nif (!requireNamespace(\"RIdeogram\", quietly = TRUE)) {\n  install.packages(\"RIdeogram\")\n}\n\n# Load packages\nlibrary(RIdeogram)",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "CollinearityPlot"
    ]
  },
  {
    "objectID": "Omics/CollinearityPlot.html#data-preparation",
    "href": "Omics/CollinearityPlot.html#data-preparation",
    "title": "Collinearity Plot",
    "section": "Data Preparation",
    "text": "Data Preparation\nWe import the sample data provided in the RIdeogram package. karyotype_ternary_comparison contains different species and genome information, and synteny_ternary_comparison contains genome comparison information between different species.\n\ndata(karyotype_ternary_comparison, package=\"RIdeogram\")\ndata(synteny_ternary_comparison, package=\"RIdeogram\")\n\n\n# View karyotype_ternary_comparison data structure\nhead(karyotype_ternary_comparison)\n\n  Chr Start      End   fill   species size  color\n1  NA     1 15980527 fcb06b Amborella   10 fcb06b\n2  NA     1 11522362 fcb06b Amborella   10 fcb06b\n3  NA     1 11085951 fcb06b Amborella   10 fcb06b\n4  NA     1 10537363 fcb06b Amborella   10 fcb06b\n5  NA     1  9585472 fcb06b Amborella   10 fcb06b\n6  NA     1  9414115 fcb06b Amborella   10 fcb06b\n\n\n\n# View synteny_ternary_comparison data structure\nhead(synteny_ternary_comparison)\n\n  Species_1 Start_2   End_2 Species_2  Start_1    End_1   fill type\n1         1 4761181 2609697         1   342802   981451 cccccc    1\n2         6 6344197 8074393         1 15387184 16716190 cccccc    1\n3        10 6457890 9052487         1 11224953 14959548 cccccc    1\n4        13 6318795 1295413         1 20564870 21386271 cccccc    1\n5        16 1398101 2884119         1 21108654 22221088 cccccc    1\n6        16 1482529 2093625         1 21864494 22364888 cccccc    1",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "CollinearityPlot"
    ]
  },
  {
    "objectID": "Omics/CollinearityPlot.html#visualization",
    "href": "Omics/CollinearityPlot.html#visualization",
    "title": "Collinearity Plot",
    "section": "Visualization",
    "text": "Visualization\n\n1. Basic Collinearity Plot\nYou can use the ideogram function provided in the RIdeogram package to draw a collinearity plot.\n\n# Basic Collinearity Plot\nideogram(karyotype = karyotype_ternary_comparison, synteny = synteny_ternary_comparison)\nconvertSVG(\"chromosome.svg\", device = \"png\")\n\n\n\n\n\n\n\nFigureÂ 1: Basic Collinearity Plot\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nKey Parameters: \n\nkaryotype: A table containing information about different species and their genomes. The data structure is shown in karyotype_ternary_comparison.\noverlaid: A table containing genome comparison information between different species. The data structure is shown in synteny_ternary_comparison.\n\n\n\n\n\n2. Change Colors\nIf you want to change the colors of the plot, just modify the color column in the karyotype and overlaid tables. As shown below, we modify the color and fill columns in the karyotype_ternary_comparison table, and the fill column in the synteny_ternary_comparison.\n\n# Change the colors of three species\nchange_color1 &lt;- c(\"fcb06b\"=\"ff0000\", \"078dd8\"=\"00ff00\", \"139b08\"=\"0000ff\")\nkaryotype_ternary_comparison$color &lt;- as.character(change_color1[karyotype_ternary_comparison$color])\nkaryotype_ternary_comparison$fill &lt;- as.character(change_color1[karyotype_ternary_comparison$fill])\n\n# Change the line color\nchange_color2 &lt;- c(\"cccccc\"=\"add8e6\", \"e41a1c\"=\"8b0000\")\nsynteny_ternary_comparison$fill &lt;- as.character(change_color2[synteny_ternary_comparison$fill])\n\n# Plot\nideogram(karyotype = karyotype_ternary_comparison, synteny = synteny_ternary_comparison)\n\n\n\n\n\n\n\nFigureÂ 2: Change Colors",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "CollinearityPlot"
    ]
  },
  {
    "objectID": "Omics/CollinearityPlot.html#application",
    "href": "Omics/CollinearityPlot.html#application",
    "title": "Collinearity Plot",
    "section": "Application",
    "text": "Application\n\n\n\n\n\n\nFigureÂ 3: Applications of Collinearity Plot\n\n\n\nThis figure shows the homology of R2R3-MYB genes in B. napus and three ancestral plant species. The figure shows the colinearity between Arabidopsis (A. thaliana), Brassica rapa (B. rapa), Brassica oleracea (B. oleracea), Brassica napus (B. napus).[1]",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "CollinearityPlot"
    ]
  },
  {
    "objectID": "Omics/CollinearityPlot.html#reference",
    "href": "Omics/CollinearityPlot.html#reference",
    "title": "Collinearity Plot",
    "section": "Reference",
    "text": "Reference\n[1] Luo D, Mei D, Wei W, Liu J. Identification and Phylogenetic Analysis of the R2R3-MYB Subfamily in Brassica napus. Plants (Basel). 2023;12(4):886. Published 2023 Feb 16. doi:10.3390/plants12040886",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "CollinearityPlot"
    ]
  },
  {
    "objectID": "Omics/GwasSnpPlot.html",
    "href": "Omics/GwasSnpPlot.html",
    "title": "GWAS Circos Plot",
    "section": "",
    "text": "The visualization of Genome-Wide Association Study (GWAS) results mainly includes SNP circular plots displayed by chromosome positions, SNP density plots, Manhattan plots for significance screening, QQ plots comparing the distribution of observed p-values with expected p-values, etc., which are used to screen candidate variant genes at the genome-wide level."
  },
  {
    "objectID": "Omics/GwasSnpPlot.html#example",
    "href": "Omics/GwasSnpPlot.html#example",
    "title": "GWAS Circos Plot",
    "section": "Example",
    "text": "Example"
  },
  {
    "objectID": "Omics/GwasSnpPlot.html#setup",
    "href": "Omics/GwasSnpPlot.html#setup",
    "title": "GWAS Circos Plot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: MetaNet; pcutils; igraph; dplyr\n\n\n# Install packages\nif (!requireNamespace(\"CMplot\", quietly = TRUE)) {\n  install.packages(\"CMplot\")\n}\n\n# Library packages\nlibrary(CMplot)"
  },
  {
    "objectID": "Omics/GwasSnpPlot.html#data-preparation",
    "href": "Omics/GwasSnpPlot.html#data-preparation",
    "title": "GWAS Circos Plot",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe sample data includes 60K liquid chip raw variation information data of Pig.\n\n# Example data\ndata(pig60K)\ndata &lt;- pig60K\n\n# Data preview\nhead(data, 5)\n\n          SNP Chromosome Position    trait1    trait2    trait3\n1 ALGA0000009          1    52297 0.7738187 0.5119432 0.5119432\n2 ALGA0000014          1    79763 0.7738187 0.5119432 0.5119432\n3 ALGA0000021          1   209568 0.7583016 0.9840529 0.9840529\n4 ALGA0000022          1   292758 0.7200305 0.4888714 0.4888714\n5 ALGA0000046          1   747831 0.9736840 0.2209684 0.2209684"
  },
  {
    "objectID": "Omics/GwasSnpPlot.html#visualization",
    "href": "Omics/GwasSnpPlot.html#visualization",
    "title": "GWAS Circos Plot",
    "section": "Visualization",
    "text": "Visualization\n\n1. SNP screening genome circular map\nGenome circular maps can display more chromosomes and traits under the same proportion, and have a great advantage when comparing multiple traits.\n\n# SNP screening genome circular map\np &lt;- CMplot(\n  data,\n  type = \"p\",\n  plot.type = \"c\",\n  chr.labels = paste(\"Chr\", c(1:18, \"X\", \"Y\"), sep = \"\"),\n  r = 8,\n  cir.axis = TRUE,\n  outward = TRUE,\n  cir.axis.col = \"black\",\n  cir.chr.h = 2,\n  chr.den.col = \"black\",\n  file.output = FALSE,\n  verbose = FALSE,\n  mar = c(0,0,0,0)\n)\n\np\n\nNULL\n\n\n\n\n\n\n\n\nFigureÂ 1: SNP screening genome circular map\n\n\n\n\n\n\n\n2. SNP Chromosome Density Map\nThe SNP chromosome density map shows the distribution of SNP density on each chromosome.\n\n# SNP Chromosome Density Map\np &lt;- capture.output(\n  CMplot(\n    data,\n    plot.type = \"d\",\n    bin.size = 1e6,\n    chr.den.col = c(\"darkgreen\", \"yellow\", \"red\"),\n    main = \"Density\",\n    file.output = FALSE,\n    verbose = FALSE\n  )\n)\n\nprint(p[1])\n\n[1] NA\n\n\n\n\n\n\n\n\nFigureÂ 2: SNP Chromosome Density Map\n\n\n\n\n\n\n\n3. Manhattan plot for SNP screening\nThe Manhattan plot for SNP screening is convenient for displaying the significance of SNPs at 5% or 1%, and it also helps identify the concentration effect of key chromosomes.\n\n# Manhattan plot for SNP screening\np &lt;- CMplot(\n  data,\n  type = \"p\",\n  plot.type = \"m\",\n  LOG10 = TRUE,\n  threshold = NULL,\n  file.output = FALSE,\n  verbose = FALSE,\n  chr.labels.angle = 45\n)\n\np\n\nNULL\n\n\n\n\n\n\n\n\nFigureÂ 3: Manhattan plot for SNP screening\n\n\n\n\n\n\n\n\n\n\n\nFigureÂ 4: Manhattan plot for SNP screening\n\n\n\n\n\n\n\n\n\n\n\nFigureÂ 5: Manhattan plot for SNP screening\n\n\n\n\n\n\n\n4. QQ plot based on SNP\nThe core function of the QQ plot based on SNPs is to test whether the P-value distribution of SNPs in GWAS analysis conforms to the â€œexpected distribution under the no-association hypothesisâ€, so as to judge the reliability of the analysis results.\n\n# QQ plot based on SNP\np &lt;- CMplot(\n  data,\n  plot.type = \"q\",\n  box = FALSE,\n  conf.int = TRUE,\n  conf.int.col = NULL,\n  threshold.col = \"red\",\n  threshold.lty = 2,\n  file.output = FALSE,\n  verbose = FALSE\n)\n\np\n\nNULL\n\n\n\n\n\n\n\n\nFigureÂ 6: QQ plot based on SNP\n\n\n\n\n\n\n\n\n\n\n\nFigureÂ 7: QQ plot based on SNP\n\n\n\n\n\n\n\n\n\n\n\nFigureÂ 8: QQ plot based on SNP"
  },
  {
    "objectID": "Omics/SyntenyBlocksPlot.html",
    "href": "Omics/SyntenyBlocksPlot.html",
    "title": "Synteny Blocks Plot",
    "section": "",
    "text": "Collinearity is widely used in the study of complex genomes. This tutorial, based on the R package syntR, summarizes the identification of shared collinearity blocks between two genetic maps, chromosomal rearrangements, and their mapping.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "SyntenyBlocksPlot"
    ]
  },
  {
    "objectID": "Omics/SyntenyBlocksPlot.html#example",
    "href": "Omics/SyntenyBlocksPlot.html#example",
    "title": "Synteny Blocks Plot",
    "section": "",
    "text": "Collinearity is widely used in the study of complex genomes. This tutorial, based on the R package syntR, summarizes the identification of shared collinearity blocks between two genetic maps, chromosomal rearrangements, and their mapping.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "SyntenyBlocksPlot"
    ]
  },
  {
    "objectID": "Omics/SyntenyBlocksPlot.html#setup",
    "href": "Omics/SyntenyBlocksPlot.html#setup",
    "title": "Synteny Blocks Plot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: syntR\n\n\n# Installing packages\nif (!requireNamespace(\"UpSetR\", quietly = TRUE)) {\n  remotes::install_github(\"ksamuk/syntR\")\n}\n\n# Load packages\nlibrary(syntR)",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "SyntenyBlocksPlot"
    ]
  },
  {
    "objectID": "Omics/SyntenyBlocksPlot.html#data-preparation",
    "href": "Omics/SyntenyBlocksPlot.html#data-preparation",
    "title": "Synteny Blocks Plot",
    "section": "Data Preparation",
    "text": "Data Preparation\nsyntR requires marker positions from two genetic maps (chromosome and map position for each marker). Before using syntR, the marker order must be inferred for each map. Before using syntR for mapping, positional data for individual markers (e.g., SNPs, microsatellites, etc.) from the two maps can be obtained using R/qtl, ASMap, and Lep-MAP. Alternatively, the alignment results can be converted to similar input files for analysis and mapping using minimap2.\n\n# load the example marker data\ndata(ann_pet_map)\nhead(ann_pet_map)\n\n             map1_name map1_chr map1_pos            map2_name map2_chr map2_pos\n1 HanXRQChr12_10463750    Ann12 23.33200 HanXRQChr12_10463750 Pet12_16 0.000000\n2 HanXRQChr12_10463069    Ann12 23.33091 HanXRQChr12_10463069 Pet12_16 3.660274\n3 HanXRQChr12_67274477    Ann12 51.14234 HanXRQChr12_67274477 Pet12_16 3.660274\n4 HanXRQChr12_11545866    Ann12 25.01880 HanXRQChr12_11545866 Pet12_16 3.660274\n5 HanXRQChr12_11545707    Ann12 25.01856 HanXRQChr12_11545707 Pet12_16 3.660274\n6  HanXRQChr12_9937279    Ann12 22.47337  HanXRQChr12_9937279 Pet12_16 4.567248\n\n\nThe data is organized into six columns:\n\nmap1_name: A unique identifier for the marker. In this example, the marker is named based on its position in the reference genome (determined by aligning GBS reads).\nmap1_chr: The chromosome number of the marker in the first map.\nmap1_pos: The position of the marker in the first map (e.g., in centimeters).\nmap2_name: Same as above, but for map 2. These names may or may not be the same as map1_names.\nmap2_chr: The chromosome number of the marker in the second map.\nmap2_pos: The position of the marker in the second map.\n\nThe example data is generated by comparing GBS data of two butterflies, Helianthus petiolaris ssp. petiolaris and H. petiolaris ssp. fallax. First, load the marker data (ann_pet_map) and the chromosome length list of map1 (ann_chr_lengths), and convert it into a list with three elements (marker data, the position of the chromosome break between map1 and map2) through the make_one_map function:\n\n# read in list of chromosome lengths for map1\n# this is an optional file that defines the maximum \n# length of each chromosome (in cM) if this is known\n# NB: this is useful when the markers being compared \n# do not cover the entire map\ndata(ann_chr_lengths)\nann_chr_lengths\n\n  map1_chr map1_max_chr_lengths\n1    Ann08                63.68\n2    Ann09                96.46\n3    Ann12                71.68\n4    Ann15                80.29\n5    Ann16               103.49\n6    Ann17                97.14\n\n\n\n# make_one_map places all the markers on a single scale\n# and adds padding between the chromosomes \n# to aid the algorithm and for visualization purposes\nmap_list &lt;- make_one_map(ann_pet_map, map1_max_chr_lengths = ann_chr_lengths)",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "SyntenyBlocksPlot"
    ]
  },
  {
    "objectID": "Omics/SyntenyBlocksPlot.html#visualization",
    "href": "Omics/SyntenyBlocksPlot.html#visualization",
    "title": "Synteny Blocks Plot",
    "section": "Visualization",
    "text": "Visualization\n\n1. Adjust the order of the graphs\nUse plot_maps() to create a basic bitmap of labeled data:\n\n# Adjust the order of the graphs\nplot_maps(map_df = map_list[[1]], map1_chrom_breaks = map_list[[2]], map2_chrom_breaks = map_list[[3]])\n\n\n\n\n\n\n\nFigureÂ 1: Adjust the order of the graphs\n\n\n\n\n\nChromosomes are labeled with species-specific names, and chromosome breaks are indicated by horizontal and vertical lines.\nBecause the chromosomes are ordered arbitrarily (chromosomes have no inherent order), these diagrams appear quite scattered. To improve readability, the order of the chromosomes of species 2 can be rearranged to align with that of species 1 (plotted along the x-axis). Any â€œcompletely upside-downâ€ chromosomes can also be rotated so that they align along a 1:1 line (in terms of chromosomal proportions).\n\n# Adjust the order of the graphs\nmap2_chr_order &lt;- c(\"Pet8\", \"Pet9\", \"Pet12_16\", \"Pet15\", \"Pet16_17\", \"Pet17\")\nflip_chrs &lt;- c(\"Pet9\")\nmap_list &lt;- make_one_map(ann_pet_map, map1_max_chr_lengths = ann_chr_lengths, map2_chr_order = map2_chr_order, flip_chrs = flip_chrs)\nplot_maps(map_df = map_list[[1]], map1_chrom_breaks = map_list[[2]], map2_chrom_breaks = map_list[[3]])\n\n\n\n\n\n\n\nFigureÂ 2: Adjust the order of the graphs\n\n\n\n\n\n\n\n2. Determining the optimal flipping parameters\nThe key tuning parameters for the syntR algorithm are max_cluster_range (CR max), followed by max_nn_dist (NN dist). max_cluster_range determines the maximum size of marker clusters that will be collapsed into a single point for further analysis. It defines the maximum distance that clustered markers can span. Larger values for max_cluster_range result in more markers clustered into a single point.\nmax_nn_dist determines which markers are considered outliers and removed from further analysis. Markers with no adjacent markers within the max_nn_dist range are considered outliers. Larger values for max_nn_dist result in fewer markers being removed.\nA simple way to find the optimal combination of these two parameters is to fit a range of values for both parameters and choose the value that maximizes the coverage (the percentage of the map assigned to the same block) of both maps and minimizes the number of outliers (â€œCombinedâ€ in the figure below is the sum of the ratios of these metrics).\nThe method for selecting the best CR max and NN dist is: (1) run syntR with a range of parameter combinations; (2) save summary statistics about the genetic distance for each map represented in the homology block and the number of markers retained for each run; (3) find the parameter combination that maximizes the average weighted composite statistic of these three measures. In the case of multiple local maxima, the local maximum with the smallest CR max value is selected to reduce the number of potential false positives.\nThis step can be skipped by using the default values of max_cluster_range = 2 and max_nn_dist = 10. This parameter is likely to be well suited for most genetic maps.\n\n# find best parameter combination\n# run find_synteny_blocks with each parameter combination and collect summary statistics\n\nparameter_data &lt;- test_parameters(map_list, max_cluster_range_list = seq(1, 5, by = 0.5), max_nn_dist_list = seq(10, 50, by = 10))\nplot_summary_stats(parameter_data[[1]], \"composite\")\n\n\n\n\n\n\n\nFigureÂ 3: Determining the optimal flipping parameters\n\n\n\n\n\nIn this example, choose max_cluster_range to be 2 and max_nn_dsit to be 10.\n\n\n3. Find synteny blocks\nAfter determining the two tuning parameters, we can run the main syntR function: find_synteny_blocks. This function takes a set of labeled data (contained in the map_list object we created earlier) and runs it through the algorithm described by Ostevik et al.Â to perform error detection and homology block identification. To run it:\n\n# Find synteny blocks\nsynt_blocks &lt;- find_synteny_blocks(map_list, max_cluster_range = 2, max_nn_dist = 10, plots = TRUE)\n\n\n\n\n\n\n\nFigureÂ 4: Find synteny blocks\n\n\n\n\n\n\n\n\n\n\n\nFigureÂ 5: Find synteny blocks\n\n\n\n\n\n\n\n\n\n\n\nFigureÂ 6: Find synteny blocks\n\n\n\n\n\nWhen plots=TRUE is specified, the function generates three plots showing the algorithmâ€™s progress. In the first plot, the mapping errors are smoothed using a pre-clustering step. Next, outliers are labeled and removed. Finally, homologous blocks are identified using the syntR Friends clustering algorithm.\nfind_synteny_blocks outputs a list object containing five data frames:\n\n# print the contents of synt_blocks\n\nlapply(synt_blocks, head)\n\n$marker_df\n             map1_name map1_chr map1_pos map1_posfull            map2_name\n1 HanXRQChr12_10463750    Ann12 23.33200     223.4720 HanXRQChr12_10463750\n2 HanXRQChr12_10463069    Ann12 23.33091     223.4709 HanXRQChr12_10463069\n3 HanXRQChr12_67274477    Ann12 51.14234     251.2823 HanXRQChr12_67274477\n4 HanXRQChr12_11545866    Ann12 25.01880     225.1588 HanXRQChr12_11545866\n5 HanXRQChr12_11545707    Ann12 25.01856     225.1586 HanXRQChr12_11545707\n6  HanXRQChr12_9937279    Ann12 22.47337     222.6134  HanXRQChr12_9937279\n  map2_chr map2_pos map2_posfull cluster block final_block orientation\n1 Pet12_16 0.000000     283.4780       1     2           2    positive\n2 Pet12_16 3.660274     287.1382       2     2           2    positive\n3 Pet12_16 3.660274     287.1382       3  &lt;NA&gt;          NA     outlier\n4 Pet12_16 3.660274     287.1382       4     2           2    positive\n5 Pet12_16 3.660274     287.1382       4     2           2    positive\n6 Pet12_16 4.567248     288.0452       2     2           2    positive\n\n$synteny_blocks_df\n  block map1_chr map1_start  map1_end map2_chr map2_start  map2_end\n1     5    Ann08   0.307917  3.096819     Pet8    0.00000  5.872578\n2     6    Ann08   7.970652 11.630196     Pet8   12.06862 28.437648\n3     7    Ann08  15.356354 22.979486     Pet8   28.43765 38.207576\n4     8    Ann08  24.903278 28.616233     Pet8   38.20758 43.602465\n5     9    Ann08  32.578270 34.839079     Pet8   48.02882 50.686116\n6    10    Ann08  29.056599 32.577711     Pet8   51.58404 59.123579\n   orientation\n1     negative\n2     positive\n3     negative\n4     positive\n5 unclassified\n6     negative\n\n$map1_breaks\n      start       end\n1  3.096819  7.970652\n2 11.630196 15.356354\n3 22.979486 24.903278\n4 28.616233 29.056599\n5 32.577711 32.578270\n6 34.839079 37.529721\n\n$map2_breaks\n      start      end\n1  5.872578 12.06862\n2 28.437648 28.43765\n3 38.207576 38.20758\n4 43.602465 48.02882\n5 50.686116 51.58404\n6 59.123579 59.12358\n\n$summary_stats\n  num_blocks map1_coverage map2_coverage n_outliers\n1         41      382.8091      567.0453        205\n\n\nThese elements are:\n\n$marker_df, a data frame containing the original list of markers and their homologous block assignments.\n$synteny_blocks_df, a data frame summarizing the span of each homologous block in each map (in map units), and the inferred orientation (juxtaposed, inverted, etc.) of homologous blocks with sufficient evidence for orientation.\n$map1_breaks, a data frame listing the breakpoints between synthetic blocks in map1.\n$map2_breaks, a data frame listing the breakpoints between synthetic blocks in map2.\n$summary_stats, a data frame summarizing the algorithm results (coverage, etc.)\n\nThe orientation of the blocks can be plotted as shown below:\n\n# Plot synteny block orientations\nsynt_blocks[[1]] %&gt;%\n    plot_maps(map_list[[2]], map_list[[3]], col = c(\"blue\", \"grey\", \"red\", \"black\")[as.numeric(as.factor(.$orientation))], \n              main = \"Synteny block orientation\",  cex_val = 0.75)\n\n\n\n\n\n\n\nFigureÂ 7: Plot synteny block orientations\n\n\n\n\n\nIn this case, blue = inverted, red = syntenic, and grey/black = unclassified.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "SyntenyBlocksPlot"
    ]
  },
  {
    "objectID": "Omics/SyntenyBlocksPlot.html#application",
    "href": "Omics/SyntenyBlocksPlot.html#application",
    "title": "Synteny Blocks Plot",
    "section": "Application",
    "text": "Application\n\n\n\n\n\n\nFigureÂ 8: Applications of Synteny Blocks Plot",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "SyntenyBlocksPlot"
    ]
  },
  {
    "objectID": "Omics/SyntenyBlocksPlot.html#reference",
    "href": "Omics/SyntenyBlocksPlot.html#reference",
    "title": "Synteny Blocks Plot",
    "section": "Reference",
    "text": "Reference\n[1] Ostevik, Kate L., Kieran Samuk, and Loren H. Rieseberg. â€œAncestral reconstruction of karyotypes reveals an exceptional rate of nonrandom chromosomal evolution in sunflower.â€ Genetics 214, no. 4 (2020): 1031-1045.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "SyntenyBlocksPlot"
    ]
  },
  {
    "objectID": "Omics/PopulationMapPlot.html",
    "href": "Omics/PopulationMapPlot.html",
    "title": "Population Map Plot",
    "section": "",
    "text": "Shows the geographical distribution of disease incidence, with light and dark colors indicating higher and lower incidence rates, and map boundaries representing administrative divisions.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "PopulationMapPlot"
    ]
  },
  {
    "objectID": "Omics/PopulationMapPlot.html#example",
    "href": "Omics/PopulationMapPlot.html#example",
    "title": "Population Map Plot",
    "section": "",
    "text": "Shows the geographical distribution of disease incidence, with light and dark colors indicating higher and lower incidence rates, and map boundaries representing administrative divisions.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "PopulationMapPlot"
    ]
  },
  {
    "objectID": "Omics/PopulationMapPlot.html#setup",
    "href": "Omics/PopulationMapPlot.html#setup",
    "title": "Population Map Plot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: sf; rnaturalearth; rnaturalearthdata; gstat; dplyr; ggplot2; ggspatial; ggnewscale; ggrepel; ggfx; doParallel; viridis\n\n\n# Install packages\nif (!requireNamespace(\"sf\", quietly = TRUE)) {\n  install.packages(\"sf\")\n}\nif (!requireNamespace(\"rnaturalearth\", quietly = TRUE)) {\n  install.packages(\"rnaturalearth\")\n}\nif (!requireNamespace(\"rnaturalearthdata\", quietly = TRUE)) {\n  install.packages(\"rnaturalearthdata\")\n}\nif (!requireNamespace(\"gstat\", quietly = TRUE)) {\n  install.packages(\"gstat\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"ggspatial\", quietly = TRUE)) {\n  install.packages(\"ggspatial\")\n}\nif (!requireNamespace(\"ggnewscale\", quietly = TRUE)) {\n  install.packages(\"ggnewscale\")\n}\nif (!requireNamespace(\"ggrepel\", quietly = TRUE)) {\n  install.packages(\"ggrepel\")\n}\nif (!requireNamespace(\"ggfx\", quietly = TRUE)) {\n  install.packages(\"ggfx\")\n}\nif (!requireNamespace(\"doParallel\", quietly = TRUE)) {\n  install.packages(\"doParallel\")\n}\nif (!requireNamespace(\"viridis\", quietly = TRUE)) {\n  install.packages(\"viridis\")\n}\n\n# Load packages\nlibrary(sf)\nlibrary(rnaturalearth)\nlibrary(rnaturalearthdata)\nlibrary(gstat) \nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(ggspatial) \nlibrary(ggnewscale)\nlibrary(ggrepel)\nlibrary(ggfx)\nlibrary(doParallel)\nlibrary(viridis)",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "PopulationMapPlot"
    ]
  },
  {
    "objectID": "Omics/PopulationMapPlot.html#data-preparation",
    "href": "Omics/PopulationMapPlot.html#data-preparation",
    "title": "Population Map Plot",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Global geographic data\nworld &lt;- ne_countries(scale = \"medium\", returnclass = \"sf\")\n# Simulating epidemiological data\nset.seed(123)\nworld$incidence &lt;- runif(nrow(world), 0, 100)  # Randomly generate incidence data",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "PopulationMapPlot"
    ]
  },
  {
    "objectID": "Omics/PopulationMapPlot.html#visualization",
    "href": "Omics/PopulationMapPlot.html#visualization",
    "title": "Population Map Plot",
    "section": "Visualization",
    "text": "Visualization\n\n1. Basic Plot\n\n# Basic map of global disease incidence distribution\np1 &lt;- ggplot(data = world) +\n  geom_sf(aes(fill = incidence)) +\n  scale_fill_viridis(option = \"C\") +\n  labs(title = \"Global Disease Incidence\",\n       fill = \"Incidence Rate\\n(per 100k)\")\n\np1\n\n\n\n\n\n\n\nFigureÂ 1: Basic map of global disease incidence distribution\n\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nKey parameter analysis: binwidth / bins aes(fill): Define color maps for epidemiological indicators\nscale_fill_viridis(): Use accessible color gradients\nne_countries(): The scale parameter controls the mapâ€™s level of detail.ï¼ˆsmall/medium/largeï¼‰\n\n\n\n# Customized epidemiological maps\np2 &lt;- ggplot(data = world) +\n  geom_sf(aes(fill = incidence), color = \"white\", size = 0.2) +\n  scale_fill_gradientn(colors = c(\"#2c7bb6\", \"#abd9e9\", \"#ffffbf\", \"#fdae61\", \"#d7191c\"),\n                       breaks = c(20, 40, 60, 80)) +\n  # scale\n  annotation_scale(\n    location = \"bl\",\n    plot_unit = \"km\",\n    style = \"ticks\",\n    width_hint = 0.1\n  ) +\n  # Compass (after restoration)\n  annotation_north_arrow(\n    location = \"tr\",\n    which_north = \"grid\",  # Use Grid North\n    style = north_arrow_minimal(\n      line_width = 1,\n      text_size = 10\n    ),\n    pad_x = unit(1.2, \"cm\"),\n    pad_y = unit(1.2, \"cm\")\n  ) +\n  coord_sf(crs =  \"+proj=robin\",\n           xlim = c(-1.6e7, 1.6e7),\n           ylim = c(-7.5e6, 8.5e6),\n           expand = FALSE) +  # Use Robinson projection\n  theme_void() +\n  guides(fill = guide_colorbar(barwidth = 1)) +\n  labs(fill = \"Incidence Rate\")+ \n  theme(\n    legend.position = c(0.1, 0.3)  # Relative position coordinates (the lower left corner is 0,0)\n  )\n\np2\n\n\n\n\n\n\n\nFigureÂ 2: Customized epidemiological maps\n\n\n\n\n\n\n\n2. Advanced plot\n\n# Advanced plot\n# Further process the data and use spatial points to infer the situation of nearby surfaces\n# Reduce calculation time, the fewer points below, the closer the estimated distance, the higher the resolution, and the more accurate it is\n# Parallel initialization\nregisterDoParallel(cores = 4)\n\n# Data Preparation\nworld_proj &lt;- st_transform(world, \"+proj=eqc +units=m\")\ncentroids &lt;- st_centroid(world_proj) %&gt;% \n  dplyr::select(incidence)\n\n# Create a low-resolution grid (100x100)\ngrid &lt;- st_make_grid(world_proj, n = c(100,100)) %&gt;% \n  st_as_sf() %&gt;%\n  st_join(world_proj, join = st_intersects)\n\n# Variogram model optimization\nvariogram_model &lt;- vgm(\n  psill = 30,\n  model = \"Exp\",  # Switch to an exponential model\n  range = 2e6,    # 2000 km related range\n  nugget = 5\n)\n\n# Block parallel computing\ngrid_chunks &lt;- split(grid, cut(st_coordinates(st_centroid(grid))[,1], 4))\n\nkrige_result &lt;- foreach(i=1:4, .combine=rbind) %dopar% {\n  krige(incidence ~ 1,\n        locations = centroids,\n        newdata = grid_chunks[[i]],\n        model = variogram_model,\n        nmax = 30)\n} %&gt;% st_as_sf()\n\n# Convert back to WGS84 coordinate system\nkrige_result &lt;- st_transform(krige_result, 4326)\n\n\nadvanced_map &lt;- ggplot() +\n  # Spatially interpolated surfaces\n  geom_sf(data = krige_result, \n          aes(fill = var1.pred, color = var1.pred),\n          alpha = 0.6) +\n  scale_fill_gradientn(\n    colors = c(\"#2c7bb6\", \"#abd9e9\", \"#ffffbf\", \"#fdae61\", \"#d7191c\"),\n    name = \"Interpolated\\nIncidence\"\n  ) +\n  scale_color_gradientn(\n    colors = c(\"#2c7bb6\", \"#abd9e9\", \"#ffffbf\", \"#fdae61\", \"#d7191c\"),\n    guide = \"none\"\n  ) +\n  ggnewscale::new_scale_fill() +\n  \n  # Original national borders\n  geom_sf(data = world, \n          aes(fill = incidence),\n          color = \"white\", \n          size = 0.1,\n          alpha = 0.5) +\n  scale_fill_gradientn(\n    colors = c(\"#2c7bb6\", \"#abd9e9\", \"#ffffbf\", \"#fdae61\", \"#d7191c\"),\n    name = \"Country\\nIncidence\",\n    breaks = seq(0, 100, 20)\n  ) +\n  \n  # 3D relief effect\n  ggfx::with_shadow(\n    geom_sf(data = world,\n            aes(geometry = geometry),\n            color = \"grey30\",\n            fill = NA,\n            size = 0.2),\n    sigma = 5,\n    x_offset = 3,\n    y_offset = 3\n  ) +\n  \n  # Hotspot annotation\n  geom_sf(data = world %&gt;% filter(incidence &gt; quantile(incidence, 0.9)),\n          color = \"red\",\n          fill = NA,\n          size = 0.5) +\n  ggrepel::geom_label_repel(\n    data = world %&gt;% filter(incidence &gt; quantile(incidence, 0.9)),\n    aes(label = name, geometry = geometry),\n    stat = \"sf_coordinates\",\n    size = 2.5,\n    box.padding = 0.2,\n    min.segment.length = 0,\n    fill = alpha(\"white\", 0.8)\n  ) +\n  \n  # Map elements\n  annotation_north_arrow(\n    location = \"tr\",\n    width = unit(1.2, \"cm\"),   # New width parameter\n    height = unit(1.2, \"cm\"),  # Added height parameter\n    style = north_arrow_minimal()  # Remove size parameters\n  ) +\n  \n  # Coordinate projection\n  coord_sf(crs = \"+proj=robin\") +\n  \n  # Theme Settings\n  theme_void() +\n  theme(\n    legend.position = c(0.12, 0.3),\n    legend.background = element_rect(fill = alpha(\"white\", 0.8), color = NA),\n    plot.title = element_text(hjust = 0.5, face = \"bold\", size = 16),\n    panel.background = element_rect(fill = \"#F0F8FF\")\n  ) +\n  labs(title = \"Advanced Spatial Distribution of Disease Incidence\")\n\nadvanced_map\n\n\n\n\n\n\n\nFigureÂ 3: Advanced plot\n\n\n\nOptionally, you can use callout-tip to add a detailed description of the parameter if needed.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "PopulationMapPlot"
    ]
  },
  {
    "objectID": "Omics/PopulationMapPlot.html#application",
    "href": "Omics/PopulationMapPlot.html#application",
    "title": "Population Map Plot",
    "section": "Application",
    "text": "Application\n\n\n\n\n\n\nPopulation Map Application\n\nThis chart shows how common cancers vary across countries around the world. [1]",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "PopulationMapPlot"
    ]
  },
  {
    "objectID": "Omics/PopulationMapPlot.html#reference",
    "href": "Omics/PopulationMapPlot.html#reference",
    "title": "Population Map Plot",
    "section": "Reference",
    "text": "Reference\n[1] Global Burden of Disease 2019 Cancer Collaboration; Kocarnik JM, Compton K, Dean FE, et al.Â Cancer Incidence, Mortality, Years of Life Lost, Years Lived With Disability, and Disability-Adjusted Life Years for 29 Cancer Groups From 2010 to 2019: A Systematic Analysis for the Global Burden of Disease Study 2019. JAMA Oncol. 2022;8(3):420-444. https://doi.org/10.1001/jamaoncol.2021.6987\n[2] Fidler MM, Gupta S, Soerjomataram I, Ferlay J, Steliarova-Foucher E, Bray F. Cancer incidence and mortality among young adults aged 20-39 years worldwide in 2012: a population-based study. Lancet Oncol. 2017;18(12):1579-1589. https://doi.org/10.1016/S1470-2045(17)30677-0\n[3] Wickham H, Chang W, Henry L, et al.Â ggplot2: Create Elegant Data Visualisations Using the Grammar of Graphics [Computer software]. (Version 3.4.0). 2022. https://ggplot2.tidyverse.org/reference/ggsf.html",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "PopulationMapPlot"
    ]
  },
  {
    "objectID": "Omics/ManhattanPlot.html",
    "href": "Omics/ManhattanPlot.html",
    "title": "Manhattan Plot",
    "section": "",
    "text": "Manhattan plot is a graph used to describe the relationship between mutations on chromosomes and traits. It is named Manhattan plot because it resembles the urban landscape of Manhattan, USA. Manhattan plot is generally drawn in the form of scatter plot, but it can also be displayed in bar chart or line chart. It is usually drawn using R package qqman or directly using ggplot2.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "ManhattanPlot"
    ]
  },
  {
    "objectID": "Omics/ManhattanPlot.html#example",
    "href": "Omics/ManhattanPlot.html#example",
    "title": "Manhattan Plot",
    "section": "Example",
    "text": "Example\n\n\n\n\n\nThe horizontal axis of the Manhattan plot is the chromosome position, and the vertical axis is the P value or any value such as Î”SNP, ED, etc. that can indicate the strength of the association between the mutation site and the trait. The P value will be used as an example below.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "ManhattanPlot"
    ]
  },
  {
    "objectID": "Omics/ManhattanPlot.html#setup",
    "href": "Omics/ManhattanPlot.html#setup",
    "title": "Manhattan Plot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: qqman; tidyverse; aplot\n\n\n# Installing necessary packages\nif (!requireNamespace(\"qqman\", quietly = TRUE)) {\n  install.packages(\"qqman\")\n}\nif (!requireNamespace(\"tidyverse\", quietly = TRUE)) {\n  install.packages(\"tidyverse\")\n}\nif (!requireNamespace(\"aplot\", quietly = TRUE)) {\n  install.packages(\"aplot\")\n}\n\n# Load packages\nlibrary(qqman)\nlibrary(tidyverse)\nlibrary(aplot)",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "ManhattanPlot"
    ]
  },
  {
    "objectID": "Omics/ManhattanPlot.html#data-preparation",
    "href": "Omics/ManhattanPlot.html#data-preparation",
    "title": "Manhattan Plot",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe data uses the gwasResults dataset that comes with qqman.\n\n# View the dataset\nhead(gwasResults)\n\n  SNP CHR BP         P\n1 rs1   1  1 0.9148060\n2 rs2   1  2 0.9370754\n3 rs3   1  3 0.2861395\n4 rs4   1  4 0.8304476\n5 rs5   1  5 0.6417455\n6 rs6   1  6 0.5190959",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "ManhattanPlot"
    ]
  },
  {
    "objectID": "Omics/ManhattanPlot.html#visualization",
    "href": "Omics/ManhattanPlot.html#visualization",
    "title": "Manhattan Plot",
    "section": "Visualization",
    "text": "Visualization\n\n1. qqman draws Manhattan plot\nmanhattan and qq are the two most important functions in qqman, responsible for drawing Manhattan graphs and QQ graphs respectively:\n\n\n\n\n\n\nTip\n\n\n\nmanhattan parameters:\n\nx: input data, required format is dataframe\nchr: column name for recording chromosome information, must be a number\nbp: column name for recording base coordinate position information, must be a number\np: column name for recording P value or other value information, must be a number\nsnp: column name for recording SNP name\ncol: alternating color setting\nchrlabs: chromosome name on X-axis, default is consistent with the name in dataframe\nsuggestiveline: blue threshold line, not drawn when set to FALSE\ngenomewideline: red threshold line, not drawn when set to FALSE\nhighlight: highlighted SNP name\nlogp: when set to TRUE, the vertical axis is -log10(P), when set to FALSE, the vertical axis is P\nannotatePval: set threshold, mark SNPs above the threshold in the figure\nannotateTop: mark only one highest SNP for each chromosome\n\n\n\n\n# Basic manhattan plot\nmanhattan(gwasResults)\n\n\n\n\n\n\n\nFigureÂ 1: Basic manhattan plot\n\n\n\n\n\nThis figure shows the association between all SNPs on the genome and traits, with an obvious peak on chromosome 3, indicating that there is a region on chromosome 3 that may be strongly correlated with the trait.\nThe color of chromosomes in manhattan can be modified by the col parameter:\n\n# Color settings\nmanhattan(gwasResults, col = c(\"#3E7B92\",\"#F0E442\",\"#BF242A\"))\n\n\n\n\n\n\n\nFigureÂ 2: Color settings\n\n\n\n\n\nTo highlight specific SNPs:\n\n# Highlight settings\nmanhattan(gwasResults, highlight =\"rs3057\")\n\n\n\n\n\n\n\nFigureÂ 3: Highlight settings\n\n\n\n\n\nAnnotate SNPs above the threshold (one per chromosome):\n\n# Annotation Settings\nmanhattan(gwasResults, highlight =\"rs3057\", annotatePval=1e-5)\n\n\n\n\n\n\n\nFigureÂ 4: Annotation Settings\n\n\n\n\n\n\n\n2. ggplot2 draws manhattan plot\nUsing qqman to draw a Manhattan map can meet most of the needs, but there are still some needs that cannot be met, such as setting the style and color of the threshold line. In this case, ggplot2 can be used for drawing.\n\n# ggplot2 draws manhattan plot\ndf &lt;- gwasResults\ndf$CHR &lt;- factor(as.character(df$CHR),levels=unique(df$CHR))\nlen &lt;- \n    df %&gt;% \n    group_by(CHR) %&gt;%  # CHR is the column name of chromosome information\n    summarise(len=max(BP))  # BP is the column name for the location information\nlen &lt;-  # Calculate the position of SNP in the graph\n    len %&gt;% summarise(pos=cumsum(len)-len)\nrownames(len) &lt;- unique(df$CHR)\ndf$BP &lt;- df$BP+len$pos[match(df$CHR,rownames(len))]\nX_axis &lt;-  df %&gt;% group_by(CHR) %&gt;% summarize(center=( max(BP) + min(BP) ) / 2 ) # Calculate the position of chromosomes\n\n# The P value is subjected to multiple corrections below. It is actually not advisable to use a fixed threshold for P in qqman.\nbf &lt;- max(df$P[p.adjust(df$P, method = \"bonferroni\")&lt;0.05])  # Using the Bonferroni method\nfdr&lt;- max(df$P[p.adjust(df$P, method = \"fdr\")&lt;0.05])  # Using the fdr method\n\ncol &lt;- c(\"gray10\", \"gray60\") # Set the chromosome color here\ncols &lt;- rep(col ,nrow(X_axis))\nline_col1 &lt;- \"red\" # Threshold line color here\nline_col2 &lt;- \"blue\"\nline_type1 &lt;- \"dashed\" # Here the threshold line type\nline_type2 &lt;- \"dashed\" \nggplot()+\n    geom_point(df,mapping=aes(x=BP,y=-log10(P),color=CHR),alpha=0.7,size=1,shape=16)+\n    geom_hline(yintercept = -log10(bf),lty=line_type1 ,color= line_col1 )+\n    geom_hline(yintercept = -log10(fdr),lty=line_type2 ,color= line_col2)+\n    scale_color_manual(values = cols ) +\n    theme_bw()+\n    theme(panel.grid.major = element_blank(),panel.grid.minor=element_blank(),\n          legend.position = 'none')+\n    xlab(\"CHR\")+ylab(\"-log10(P)\")+ # Horizontal axis vertical axis title\n    scale_x_continuous( limits = c(0, max(df$BP)),label = X_axis$CHR, breaks= X_axis$center ) +\n    scale_y_continuous(expand = c(0,0)) \n\n\n\n\n\n\n\nFigureÂ 5: ggplot2 draws manhattan plot\n\n\n\n\n\nThe advantage of using ggplot2 to draw a Manhattan map is that the style of the image can be highly customized. You can notice that I have set several variables above. You only need to modify these variables to customize the color and threshold line style.\n\ncol &lt;- c(\"#3E7B92\",\"#F0E442\",\"#BF242A\") # Set the chromosome color here\ncols &lt;- rep(col ,nrow(X_axis))\nline_col1 &lt;- \"#DB5A6A\" # Threshold line color here\nline_col2 &lt;- \"#0050B7\"\nline_type1 &lt;- \"solid\" # Here, the threshold line type can be set as follows: â€solidâ€œ,â€œblankâ€, â€œsolidâ€, â€œdashedâ€, â€œdottedâ€, â€œdotdashâ€, â€œlongdashâ€, â€œtwodashâ€\nline_type2 &lt;- \"dotdash\" \nggplot()+\n    geom_point(df,mapping=aes(x=BP,y=-log10(P),color=CHR),alpha=0.7,size=1,shape=16)+\n    geom_hline(yintercept = -log10(bf),lty=line_type1 ,color= line_col1 )+\n    geom_hline(yintercept = -log10(fdr),lty=line_type2 ,color= line_col2)+\n    scale_color_manual(values = cols ) +\n    theme_bw()+\n    theme(panel.grid.major = element_blank(),panel.grid.minor=element_blank(),\n          legend.position = 'none')+\n    xlab(\"CHR\")+ylab(\"-log10(P)\")+\n    scale_x_continuous( limits = c(0, max(df$BP)),label = X_axis$CHR, breaks= X_axis$center ) +\n    scale_y_continuous(expand = c(0,0)) \n\n\n\n\n\n\n\nFigureÂ 6: ggplot2 modify colors\n\n\n\n\n\nSince ggplot2 plots images one by one, the screened SNPs can be superimposed on the original image using geom_point:\n\ndf2 &lt;- df[df$P&lt;bf,]\ndf3 &lt;- df[df$SNP==\"rs3057\",]\ncol &lt;- c(\"gray10\", \"gray60\") # Set the chromosome color here\ncols &lt;- rep(col ,nrow(X_axis))\nline_col1 &lt;- \"red\" # Threshold line color here\nline_col2 &lt;- \"blue\"\nline_type1 &lt;- \"dashed\" # Here the threshold line type\nline_type2 &lt;- \"dashed\" \nggplot()+\n    geom_point(df,mapping=aes(x=BP,y=-log10(P),color=CHR),alpha=0.7,size=1,shape=16)+\n    geom_point(df2,mapping=aes(x=BP,y=-log10(P)),color=\"blue\",size=1,shape=16)+\n    geom_point(df3,mapping=aes(x=BP,y=-log10(P)),color=\"red\",size=3,shape=18)+\n    geom_hline(yintercept = -log10(bf),lty=line_type1 ,color= line_col1 )+\n    geom_hline(yintercept = -log10(fdr),lty=line_type2 ,color= line_col2)+\n    scale_color_manual(values = cols ) +\n    theme_bw()+\n    theme(panel.grid.major = element_blank(),panel.grid.minor=element_blank(),\n          legend.position = 'none')+\n    xlab(\"CHR\")+ylab(\"-log10(P)\")+\n    scale_x_continuous( limits = c(0, max(df$BP)),label = X_axis$CHR, breaks= X_axis$center ) +\n    scale_y_continuous(limits = c(0, max(-log10(df$P))+1),expand = c(0,0)) \n\n\n\n\n\n\n\nFigureÂ 7: Highlight or mark SNPs\n\n\n\n\n\nWhen you have two traits, you may need to display the GWAS results of the two traits at the same time. You can use the following method to draw a two-way Manhattan plot. Here we only use one set of data as an example.\n\ncol &lt;- c(\"gray10\", \"gray60\") # Set the chromosome color here\ncols &lt;- rep(col ,nrow(X_axis))\nline_col1 &lt;- \"red\" # Threshold line color here\nline_col2 &lt;- \"blue\"\nline_type1 &lt;- \"dashed\" # Here the threshold line type\nline_type2 &lt;- \"dashed\" \np1 &lt;- \n    ggplot()+\n    geom_point(df,mapping=aes(x=BP,y=-log10(P),color=CHR),alpha=0.7,size=1,shape=16)+\n    geom_hline(yintercept = -log10(bf),lty=line_type1 ,color= line_col1 )+\n    geom_hline(yintercept = -log10(fdr),lty=line_type2 ,color= line_col2)+\n    scale_color_manual(values = cols ) +\n    theme_bw()+\n    theme(panel.grid.major = element_blank(),panel.grid.minor=element_blank(),\n          axis.text.x = element_text(vjust = -2),\n          axis.title.x = element_blank(),\n          legend.position = 'none')+\n    ylab(\"-log10(P)\")+ # Horizontal axis vertical axis title\n    scale_x_continuous( limits = c(0, max(df$BP)),label = X_axis$CHR, breaks= X_axis$center ) +\n    scale_y_continuous(expand = c(0,0)) \np2 &lt;- \n    ggplot()+\n    geom_point(df,mapping=aes(x=BP,y=-log10(P),color=CHR),alpha=0.7,size=1,shape=16)+\n    geom_hline(yintercept = -log10(bf),lty=line_type1 ,color= line_col1 )+\n    geom_hline(yintercept = -log10(fdr),lty=line_type2 ,color= line_col2)+\n    scale_color_manual(values = cols ) +\n    theme_bw()+\n    theme(panel.grid.major = element_blank(),panel.grid.minor=element_blank(),\n          axis.text.x = element_blank(),axis.title.x = element_blank(),\n          legend.position = 'none')+\n    ylab(\"-log10(P)\")+\n    scale_x_continuous( limits = c(0, max(df$BP)),label = X_axis$CHR, breaks= X_axis$center ,position = 'top') +\n    scale_y_reverse(expand = c(0,0))\np1/p2\n\n\n\n\n\n\n\nFigureÂ 8: Bidirectional Manhattan plot",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "ManhattanPlot"
    ]
  },
  {
    "objectID": "Omics/ManhattanPlot.html#application",
    "href": "Omics/ManhattanPlot.html#application",
    "title": "Manhattan Plot",
    "section": "Application",
    "text": "Application\nfig-HistApplications} \nApplications of Manhattan Plot :::\nThis figure shows the association between SNP loci in poplar trees and temperature (top)/rainfall (bottom) [1]ã€‚",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "ManhattanPlot"
    ]
  },
  {
    "objectID": "Omics/ManhattanPlot.html#reference",
    "href": "Omics/ManhattanPlot.html#reference",
    "title": "Manhattan Plot",
    "section": "Reference",
    "text": "Reference\n[1] Sang Y, Long Z, Dan X, Feng J, Shi T, Jia C, Zhang X, Lai Q, Yang G, Zhang H, Xu X, Liu H, Jiang Y, Ingvarsson PK, Liu J, Mao K, Wang J. Genomic insights into local adaptation and future climate-induced vulnerability of a keystone forest tree in East Asia. Nat Commun. 2022 Nov 1;13(1):6541. doi: 10.1038/s41467-022-34206-8. PMID: 36319648; PMCID: PMC9626627.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> ğğŒğˆğ‚ğ’",
      "ManhattanPlot"
    ]
  },
  {
    "objectID": "ToolLinks.html#web-visualization-applications",
    "href": "ToolLinks.html#web-visualization-applications",
    "title": "Tool Links",
    "section": "Web visualization applications",
    "text": "Web visualization applications",
    "crumbs": [
      "<i class='fa-solid fa-laptop-code'></i> Tool Links"
    ]
  },
  {
    "objectID": "Hiplot/009-barplot-line-multiple.html",
    "href": "Hiplot/009-barplot-line-multiple.html",
    "title": "Multiple Barplot&Line",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Multiple Barplot&Line plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/barplot-line-multiple?lang=en\nDisplaying multiple bar or line plot in one diagram.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Multiple Barplot&Line"
    ]
  },
  {
    "objectID": "Hiplot/009-barplot-line-multiple.html#setup",
    "href": "Hiplot/009-barplot-line-multiple.html#setup",
    "title": "Multiple Barplot&Line",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2; reshape2; ggthemes\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"reshape2\", quietly = TRUE)) {\n  install.packages(\"reshape2\")\n}\nif (!requireNamespace(\"ggthemes\", quietly = TRUE)) {\n  install.packages(\"ggthemes\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(reshape2)\nlibrary(ggthemes)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Multiple Barplot&Line"
    ]
  },
  {
    "objectID": "Hiplot/009-barplot-line-multiple.html#data-preparation",
    "href": "Hiplot/009-barplot-line-multiple.html#data-preparation",
    "title": "Multiple Barplot&Line",
    "section": "Data Preparation",
    "text": "Data Preparation\nData frame with multiple columns data (Numeric).\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/barplot-line-multiple/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# convert data structure\ndata_melt &lt;- melt(data, id.vars = colnames(data)[1])\ndata_melt[, 1] &lt;- factor(data_melt[, 1], level = unique(data_melt[, 1]))\n\n# View data\nhead(data)\n\n  age height weight math biology english chinese\n1  12    158    100  120      90     115     140\n2  15    160    110  145      80     120     120\n3  18    175    120  132      95     118     110\n4  20    176    121  124      99     118     136\n5  21    176    120  135      98     114     150\n6  22    177    124  140      87     110     150",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Multiple Barplot&Line"
    ]
  },
  {
    "objectID": "Hiplot/009-barplot-line-multiple.html#visualization",
    "href": "Hiplot/009-barplot-line-multiple.html#visualization",
    "title": "Multiple Barplot&Line",
    "section": "Visualization",
    "text": "Visualization\n\n1. Multiple Line\n\n# Multiple Line\np &lt;- ggplot(data = data_melt, aes(x = age, y = value, group = variable,\n                                  colour = variable)) +\n  geom_line(alpha = 1, size = 1) +\n  geom_point(aes(shape = variable), alpha = 1, size = 3) +\n  labs(title = \"Line (Multiple)\", x = \"X Lable\", y = \"Value\") +\n  scale_color_manual(values = c(\"#3B4992FF\",\"#EE0000FF\",\"#008B45FF\",\"#631879FF\",\n                               \"#008280FF\",\"#BB0021FF\")) +\n  theme_stata() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Multiple Line\n\n\n\n\n\n\n\n2. Multiple Barplot\n\n# Multiple Barplot\np &lt;- ggplot(data = data_melt, aes(x = age, y = value, fill = variable)) +\n  geom_bar(stat = \"identity\", position = position_dodge(), colour = \"black\",\n           alpha = 1) +\n  labs(title = \"\", x = \"X Lable\", y = \"Value\") +\n  \n  scale_fill_manual(values = c(\"#3B4992FF\",\"#EE0000FF\",\"#008B45FF\",\"#631879FF\",\n                               \"#008280FF\",\"#BB0021FF\")) +\n  theme_stata() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 2: Multiple Barplot",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Multiple Barplot&Line"
    ]
  },
  {
    "objectID": "Hiplot/175-tsne.html",
    "href": "Hiplot/175-tsne.html",
    "title": "tSNE",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot tSNE plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/tsne?lang=en\nT-sne is a nonlinear dimensionality reduction algorithm suitable for high-dimensional data reduction to two or three dimensions and visualization. The algorithm can make the t distribution of points with greater similarity closer in the lower dimensional space. For low similarity points, the t distribution is farther away in the low dimensional space.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "tSNE"
    ]
  },
  {
    "objectID": "Hiplot/175-tsne.html#setup",
    "href": "Hiplot/175-tsne.html#setup",
    "title": "tSNE",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; Rtsne; ggpubr\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"Rtsne\", quietly = TRUE)) {\n  install.packages(\"Rtsne\")\n}\nif (!requireNamespace(\"ggpubr\", quietly = TRUE)) {\n  install.packages(\"ggpubr\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(Rtsne)\nlibrary(ggpubr)",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "tSNE"
    ]
  },
  {
    "objectID": "Hiplot/175-tsne.html#data-preparation",
    "href": "Hiplot/175-tsne.html#data-preparation",
    "title": "tSNE",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data are the data set (gene name and corresponding gene expression value) and sample information (sample name and grouping).\n\n# Load data\ndata1 &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/tsne/data.json\")$exampleData[[1]]$textarea[[1]])\ndata1 &lt;- as.data.frame(data1)\ndata2 &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/tsne/data.json\")$exampleData[[1]]$textarea[[2]])\ndata2 &lt;- as.data.frame(data2)\n\n# convert data structure\nsample.info &lt;- data2\nrownames(data1) &lt;- data1[, 1]\ndata1 &lt;- as.matrix(data1[, -1])\n## tsne\nset.seed(123)\ntsne_info &lt;- Rtsne(t(data1), perplexity = 1, theta = 0.1, check_duplicates = FALSE)\ncolnames(tsne_info$Y) &lt;- c(\"tSNE_1\", \"tSNE_2\")\n# handle data\ntsne_data &lt;- data.frame(\n  sample = colnames(data1),\n  tsne_info$Y\n)\ncolorBy &lt;- sample.info[match(colnames(data1), sample.info[, 1]), \"group\"]\ncolorBy &lt;- factor(colorBy, level = colorBy[!duplicated(colorBy)])\ntsne_data$colorBy = colorBy\nshapeBy &lt;- NULL\n\n# View data\nhead(data1)\n\n              M1       M2        M3       M8       M9      M10\nGBP4    6.599344 5.226266  3.693288 7.658312 8.666038 7.419708\nBCAT1   5.760380 4.892783  5.448924 8.765915 8.097206 8.262942\nCMPK2   9.561905 4.549168  3.998655 7.379591 7.938063 6.154118\nSTOX2   8.396409 8.717055  8.039064 3.542217 4.305187 6.964710\nPADI2   8.419766 8.268430  8.451181 4.136667 4.910986 4.080363\nSCARNA5 7.653074 5.780393 10.633550 3.822596 4.041078 7.956589\n\nhead(data2)\n\n  sample group\n1     M1    G1\n2     M2    G1\n3     M3    G1\n4     M8    G2\n5     M9    G2\n6    M10    G2",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "tSNE"
    ]
  },
  {
    "objectID": "Hiplot/175-tsne.html#visualization",
    "href": "Hiplot/175-tsne.html#visualization",
    "title": "tSNE",
    "section": "Visualization",
    "text": "Visualization\n\n# tsne\np &lt;- ggscatter(data = tsne_data, x = \"tSNE_1\", y = \"tSNE_2\", size = 2, \n               palette = \"lancet\", color = \"colorBy\") +\n  labs(color = \"group\") +\n  ggtitle(\"tSNE Plot1\") +\n  theme_bw() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: tsne\n\n\n\n\n\nDifferent colors represent different samples, which is the same as PCA (principal component analysis) graphic interpretation. The difference lies in the visualization effect. For dissimilar points in T-SNE, a small distance will generate a large gradient to repel them.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "tSNE"
    ]
  },
  {
    "objectID": "Hiplot/184-waffle.html",
    "href": "Hiplot/184-waffle.html",
    "title": "Waffle Plot",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Waffle Plot plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/waffle?lang=en",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Waffle Plot"
    ]
  },
  {
    "objectID": "Hiplot/184-waffle.html#setup",
    "href": "Hiplot/184-waffle.html#setup",
    "title": "Waffle Plot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; waffle\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"waffle\", quietly = TRUE)) {\n  remotes::install_github(\"hrbrmstr/waffle\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(waffle)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Waffle Plot"
    ]
  },
  {
    "objectID": "Hiplot/184-waffle.html#data-preparation",
    "href": "Hiplot/184-waffle.html#data-preparation",
    "title": "Waffle Plot",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/waffle/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# convert data structure\nparts &lt;- data[,2]\n\n# View data\nhead(data)\n\n                      label value\n1 Un-breached US Population   230\n2                   Premera    11\n3                    Anthem    79",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Waffle Plot"
    ]
  },
  {
    "objectID": "Hiplot/184-waffle.html#visualization",
    "href": "Hiplot/184-waffle.html#visualization",
    "title": "Waffle Plot",
    "section": "Visualization",
    "text": "Visualization\n\n# Waffle Plot\np &lt;- waffle(parts, rows = 8, size = 1, legend_pos = \"right\") +\n  ggtitle(\"Waffle Plot\") +\n  scale_fill_manual(values = c(\"#e04d39\",\"#5bbad6\",\"#1e9f86\")) +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Waffle Plot",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Waffle Plot"
    ]
  },
  {
    "objectID": "Hiplot/180-violin-group.html",
    "href": "Hiplot/180-violin-group.html",
    "title": "Violin Group",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Violin Group plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/violin-group?lang=en\nViolin and box plot of grouped data with T-test.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Violin Group"
    ]
  },
  {
    "objectID": "Hiplot/180-violin-group.html#setup",
    "href": "Hiplot/180-violin-group.html#setup",
    "title": "Violin Group",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggpubr; ggthemes\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggpubr\", quietly = TRUE)) {\n  install.packages(\"ggpubr\")\n}\nif (!requireNamespace(\"ggthemes\", quietly = TRUE)) {\n  install.packages(\"ggthemes\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggpubr)\nlibrary(ggthemes)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Violin Group"
    ]
  },
  {
    "objectID": "Hiplot/180-violin-group.html#data-preparation",
    "href": "Hiplot/180-violin-group.html#data-preparation",
    "title": "Violin Group",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n&lt;1st-col&gt;: (Numeric) value data\n&lt;2nd-col&gt;: (String) 1st-rank groups\n&lt;3rd-col&gt;: (String) 2nd-rank groups\n\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/violin-group/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# convert data structure\ndata[, 3] &lt;- factor(data[, 3], levels = unique(data[, 3]))\n\n# View data\nhead(data)\n\n  Value Group1 Group2\n1   4.2    low treat1\n2  11.5    low treat1\n3   7.3    low treat1\n4   5.8    low treat1\n5   6.4    low treat1\n6  10.0    low treat1",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Violin Group"
    ]
  },
  {
    "objectID": "Hiplot/180-violin-group.html#visualization",
    "href": "Hiplot/180-violin-group.html#visualization",
    "title": "Violin Group",
    "section": "Visualization",
    "text": "Visualization\n\n# Violin Group\np &lt;- ggviolin(data, x = \"Group1\", y = \"Value\", color = \"Group2\", add = \"dotplot\",\n              add.params = list(fill = \"white\",size = 1), title = \"Violin Diagram\",\n              xlab = \"Group1\", ylab = \"Value\", fill = \"Group2\",\n              palette = c(\"#374E55FF\", \"#DF8F44FF\"), alpha = 0.5, trim = F) +\n  stat_compare_means(aes(group = data[, colnames(data)[3]]),\n    method = \"t.test\", vjust = -6, label.x.npc = \"left\", label.y.npc = \"top\",\n    tip.length = 0.03, bracket.size = 0.3, step.increase = 0, position = \"identity\",\n    na.rm = FALSE, show.legend = NA, inherit.aes = TRUE, geom = \"text\") +\n  theme_stata() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Violin Group",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Violin Group"
    ]
  },
  {
    "objectID": "Hiplot/099-map-china-county.html",
    "href": "Hiplot/099-map-china-county.html",
    "title": "China Map (County)",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot China Map (County) plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/map-china-county?lang=en",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "China Map (County)"
    ]
  },
  {
    "objectID": "Hiplot/099-map-china-county.html#setup",
    "href": "Hiplot/099-map-china-county.html#setup",
    "title": "China Map (County)",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2; RColorBrewer\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(RColorBrewer)",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "China Map (County)"
    ]
  },
  {
    "objectID": "Hiplot/099-map-china-county.html#data-preparation",
    "href": "Hiplot/099-map-china-county.html#data-preparation",
    "title": "China Map (County)",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/map-china-county/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\ndt_map &lt;- readRDS(url(\"https://download.hiplot.cn/ui/basic/map-china-county/china.county.rds\"))\n\n# Convert data structure\ndt_map$Value &lt;- data$value[match(dt_map$county, data$name)]\n\n# View data\nhead(data)\n\n      name value\n1   ä¸œåŸåŒº   739\n2   è¥¿åŸåŒº   536\n3   æœé˜³åŒº   138\n4   ä¸°å°åŒº   561\n5 çŸ³æ™¯å±±åŒº   345\n6   æµ·æ·€åŒº   898",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "China Map (County)"
    ]
  },
  {
    "objectID": "Hiplot/099-map-china-county.html#visualization",
    "href": "Hiplot/099-map-china-county.html#visualization",
    "title": "China Map (County)",
    "section": "Visualization",
    "text": "Visualization\n\n# China Map (County)\np &lt;- ggplot(dt_map) +\n  geom_polygon(aes(x = long, y = lat, group = group, fill = Value),\n               alpha = 0.9, size = 0.5) +\n  geom_path(aes(x = long, y = lat, group = group), color = \"black\", size = 0.2) +\n  coord_fixed() +\n  scale_fill_gradientn(\n    colours = colorRampPalette(rev(brewer.pal(11,\"RdYlBu\")))(500),\n    breaks = seq(min(data$value), max(data$value), \n                 round((max(data$value)-min(data$value))/7)),\n    name = \"\",\n    guide = guide_legend(\n      direction = \"vertical\", keyheight = unit(1, units = \"mm\"),\n      keywidth = unit(8, units = \"mm\"),\n      title.position = \"top\", title.hjust = 0.5, label.hjust = 0.5,\n      nrow = 1, byrow = T, reverse = F, label.position = \"bottom\")) +\n  theme(text = element_text(color = \"#3A3F4A\"),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank(),\n        legend.position = \"top\",\n        legend.text = element_text(size = 4 * 1.5, color = \"black\"),\n        legend.title = element_text(size = 5 * 1.5, color = \"black\"),\n        plot.title = element_text(\n          face = \"bold\", size = 5 * 1.5, hjust = 0.5, \n          margin = margin(t = 4, b = 5), color = \"black\"),\n        plot.background = element_rect(fill = \"#FFFFFF\", color = \"#FFFFFF\"),\n        panel.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        legend.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        plot.margin = unit(c(1.5, 1.5, 1.5, 1.5), \"cm\")) +\n  labs(x = NULL, y = NULL, title = \"China City Map\")\n\np\n\n\n\n\n\n\n\nFigureÂ 1: China Map (County)",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "China Map (County)"
    ]
  },
  {
    "objectID": "Hiplot/076-ggwordcloud.html",
    "href": "Hiplot/076-ggwordcloud.html",
    "title": "ggwordcloud",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot ggwordcloud plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/ggwordcloud?lang=en\nThe word cloud is to visualize the â€œkeywordsâ€ that appear frequently in the web text by forming a â€œkeyword cloud layerâ€ or â€œkeyword renderingâ€.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "ggwordcloud"
    ]
  },
  {
    "objectID": "Hiplot/076-ggwordcloud.html#setup",
    "href": "Hiplot/076-ggwordcloud.html#setup",
    "title": "ggwordcloud",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggwordcloud\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggwordcloud\", quietly = TRUE)) {\n  install.packages(\"ggwordcloud\")\n}\nif (!requireNamespace(\"curl\", quietly = TRUE)) {\n  install.packages(\"curl\")\n}\nif (!requireNamespace(\"png\", quietly = TRUE)) {\n  install.packages(\"png\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggwordcloud)\nlibrary(curl)\nlibrary(png)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "ggwordcloud"
    ]
  },
  {
    "objectID": "Hiplot/076-ggwordcloud.html#data-preparation",
    "href": "Hiplot/076-ggwordcloud.html#data-preparation",
    "title": "ggwordcloud",
    "section": "Data Preparation",
    "text": "Data Preparation\nLoad data nouns and noun frequencies.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/ggwordcloud/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\ninmask &lt;- \"https://download.hiplot.cn/api/file/fetch/?path=public/demo/ggwordcloud/hearth.png\"\n\n# Convert data structure\ncol &lt;- data[, 2]\ndata &lt;- cbind(data, col)\n\n# View data\nhead(data)\n\n    word freq col\n1    oil   85  85\n2   said   73  73\n3 prices   48  48\n4   opec   42  42\n5    mln   31  31\n6    the   26  26",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "ggwordcloud"
    ]
  },
  {
    "objectID": "Hiplot/076-ggwordcloud.html#visualization",
    "href": "Hiplot/076-ggwordcloud.html#visualization",
    "title": "ggwordcloud",
    "section": "Visualization",
    "text": "Visualization\n\n# ggwordcloud\np &lt;- ggplot(data, aes(label = word, size = freq, color = col)) +\n  scale_size_area(max_size = 40) +\n  theme_minimal() + \n  geom_text_wordcloud_area(\n    mask = png::readPNG(curl::curl_fetch_memory(inmask)$content), \n    rm_outside = TRUE) +\n  scale_color_gradient(low = \"#8B0000\", high = \"#FF0000\")\n\np\n\n\n\n\n\n\n\nFigureÂ 1: ggwordcloud\n\n\n\n\n\nDisplay the proportion of nouns in the word cloud graph according to the frequency of nouns.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "ggwordcloud"
    ]
  },
  {
    "objectID": "Hiplot/107-map-germany.html",
    "href": "Hiplot/107-map-germany.html",
    "title": "Germany Map",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Germany Map plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/map-germany?lang=en",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Germany Map"
    ]
  },
  {
    "objectID": "Hiplot/107-map-germany.html#setup",
    "href": "Hiplot/107-map-germany.html#setup",
    "title": "Germany Map",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2; RColorBrewer\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(RColorBrewer)",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Germany Map"
    ]
  },
  {
    "objectID": "Hiplot/107-map-germany.html#data-preparation",
    "href": "Hiplot/107-map-germany.html#data-preparation",
    "title": "Germany Map",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/map-germany/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\ndt_map &lt;- readRDS(url(\"https://download.hiplot.cn/ui/basic/map-germany/germany.rds\"))\n\n# Convert data structure\ndt_map$Value &lt;- data$value[match(dt_map$ENG_NAME, data$name)]\n\n# View data\nhead(data)\n\n               name value\n1 Baden-WÃ¼rttemberg   334\n2            Bayern   562\n3            Berlin   980\n4       Brandenburg   577\n5            Bremen    54\n6           Hamburg   528",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Germany Map"
    ]
  },
  {
    "objectID": "Hiplot/107-map-germany.html#visualization",
    "href": "Hiplot/107-map-germany.html#visualization",
    "title": "Germany Map",
    "section": "Visualization",
    "text": "Visualization\n\n# Germany Map\np &lt;- ggplot(dt_map) +\n  geom_polygon(aes(x = long, y = lat, group = group, fill = Value),\n               alpha = 0.9, size = 0.5) +\n  geom_path(aes(x = long, y = lat, group = group), color = \"black\", size = 0.2) +\n  coord_fixed() +\n  scale_fill_gradientn(\n    colours = colorRampPalette(rev(brewer.pal(11,\"RdYlBu\")))(500),\n    breaks = seq(min(data$value), max(data$value), \n                 round((max(data$value)-min(data$value))/7)),\n    name = \"Color Key\",\n    guide = guide_legend(\n      direction = \"vertical\", keyheight = unit(1, units = \"mm\"),\n      keywidth = unit(8, units = \"mm\"),\n      title.position = \"top\", title.hjust = 0.5, label.hjust = 0.5,\n      nrow = 1, byrow = T, reverse = F, label.position = \"bottom\")) +\n  theme(text = element_text(color = \"#3A3F4A\"),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank(),\n        legend.position = \"top\",\n        legend.text = element_text(size = 4 * 1.5, color = \"black\"),\n        legend.title = element_text(size = 5 * 1.5, color = \"black\"),\n        plot.title = element_text(\n          face = \"bold\", size = 5 * 1.5, hjust = 0.5, \n          margin = margin(t = 4, b = 5), color = \"black\"),\n        plot.background = element_rect(fill = \"#FFFFFF\", color = \"#FFFFFF\"),\n        panel.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        legend.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        plot.margin = unit(c(1.5, 1.5, 1.5, 1.5), \"cm\")) +\n  labs(x = NULL, y = NULL, title = \"Germany Map\")\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Germany Map",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Germany Map"
    ]
  },
  {
    "objectID": "Hiplot/101-map-china2.html",
    "href": "Hiplot/101-map-china2.html",
    "title": "China Map 2",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot China Map 2 plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/map-china2?lang=en",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "China Map 2"
    ]
  },
  {
    "objectID": "Hiplot/101-map-china2.html#setup",
    "href": "Hiplot/101-map-china2.html#setup",
    "title": "China Map 2",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2; RColorBrewer\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(RColorBrewer)",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "China Map 2"
    ]
  },
  {
    "objectID": "Hiplot/101-map-china2.html#data-preparation",
    "href": "Hiplot/101-map-china2.html#data-preparation",
    "title": "China Map 2",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/map-china2/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\ndt_map &lt;- readRDS(url(\"https://download.hiplot.cn/ui/basic/map-china/china.rds\"))\n\n# Convert data structure\ndt_map$Value &lt;- data$value[match(dt_map$FCNAME, data$name)]\n\n# View data\nhead(data)\n\n    name value\n1 å®‰å¾½çœ  6118\n2 ç¦å»ºçœ  3581\n3 ç”˜è‚ƒçœ  2617\n4 å¹¿ä¸œçœ  9449\n5 è´µå·çœ  3762\n6 æµ·å—çœ   845",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "China Map 2"
    ]
  },
  {
    "objectID": "Hiplot/101-map-china2.html#visualization",
    "href": "Hiplot/101-map-china2.html#visualization",
    "title": "China Map 2",
    "section": "Visualization",
    "text": "Visualization\n\n# China Map 2\np &lt;- ggplot(dt_map) +\n  geom_polygon(aes(x = long, y = lat, group = group, fill = Value),\n               alpha = 0.9, size = 0.5) +\n  geom_path(aes(x = long, y = lat, group = group), color = \"black\", size = 0.2) +\n  coord_fixed() +\n  scale_fill_gradientn(\n    colours = colorRampPalette(rev(brewer.pal(11,\"RdYlBu\")))(500),\n    breaks = seq(min(data$value), max(data$value), \n                 round((max(data$value)-min(data$value))/7)),\n    name = \"Color Key\",\n    guide = guide_legend(\n      direction = \"vertical\", keyheight = unit(1, units = \"mm\"),\n      keywidth = unit(8, units = \"mm\"),\n      title.position = \"top\", title.hjust = 0.5, label.hjust = 0.5,\n      nrow = 1, byrow = T, reverse = F, label.position = \"bottom\")) +\n  theme(text = element_text(color = \"#3A3F4A\"),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank(),\n        legend.position = \"top\",\n        legend.text = element_text(size = 4 * 1.5, color = \"black\"),\n        legend.title = element_text(size = 5 * 1.5, color = \"black\"),\n        plot.title = element_text(\n          face = \"bold\", size = 5 * 1.5, hjust = 0.5, \n          margin = margin(t = 4, b = 5), color = \"black\"),\n        plot.background = element_rect(fill = \"#FFFFFF\", color = \"#FFFFFF\"),\n        panel.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        legend.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        plot.margin = unit(c(1.5, 1.5, 1.5, 1.5), \"cm\")) +\n  labs(x = NULL, y = NULL, title = \"China Map\")\n\np\n\n\n\n\n\n\n\nFigureÂ 1: China Map 2",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "China Map 2"
    ]
  },
  {
    "objectID": "Hiplot/034-custom-heat-map.html",
    "href": "Hiplot/034-custom-heat-map.html",
    "title": "Custom Heatmap",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Custom Heatmap plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/custom-heat-map?lang=en\nCustom Heatmap, directly plot a heatmap based on the given data.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Custom Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/034-custom-heat-map.html#setup",
    "href": "Hiplot/034-custom-heat-map.html#setup",
    "title": "Custom Heatmap",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Custom Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/034-custom-heat-map.html#data-preparation",
    "href": "Hiplot/034-custom-heat-map.html#data-preparation",
    "title": "Custom Heatmap",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe case data is a grayscale image of the official logo of hiplot.org.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/custom-heat-map/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# convert data structure\ndraw_data &lt;- as.matrix(data[, 2:ncol(data)])\nrow_num &lt;- nrow(draw_data)\ncol_num &lt;- ncol(draw_data)\ncol_labels &lt;- colnames(data)\ncol_labels &lt;- col_labels[2:ncol(data)]\nrow_labels &lt;- data$name\nrm(data)\ndf &lt;- expand.grid(row = 1:row_num, col = 1:col_num)\ndf$value &lt;- c(draw_data)\n\n# View data\nhead(df)\n\n  row col value\n1   1   1   236\n2   2   1   236\n3   3   1   236\n4   4   1   236\n5   5   1   236\n6   6   1   236",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Custom Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/034-custom-heat-map.html#visualization",
    "href": "Hiplot/034-custom-heat-map.html#visualization",
    "title": "Custom Heatmap",
    "section": "Visualization",
    "text": "Visualization\n\n# Custom Heatmap\np &lt;- ggplot(df, aes(x = col, y = row, fill = value)) +\n  geom_point(shape = 21, size = 8, aes(fill = value), color = \"white\") +\n  scale_fill_gradient(low = \"#DDDDDD\", high = \"#0000F5\") +\n  guides(fill = guide_colorbar(title = \"Value\")) +\n  theme(\n    panel.background = element_rect(fill = \"white\"),\n    panel.grid = element_blank(),\n    axis.text = element_text(size = 10),\n    axis.ticks = element_blank(),\n    axis.title = element_blank()\n    ) +\n  scale_x_continuous(breaks = 1:col_num, labels = col_labels, position = \"top\") +\n  scale_y_reverse(breaks = 1:row_num, labels = row_labels, position = \"left\")\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Custom Heatmap",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Custom Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/072-ggpubr-boxplot.html",
    "href": "Hiplot/072-ggpubr-boxplot.html",
    "title": "GGPubr Boxplot",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot GGPubr Boxplot plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/ggpubr-boxplot?lang=en\nFeature-rich boxplot (GGPubr interface).",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "GGPubr Boxplot"
    ]
  },
  {
    "objectID": "Hiplot/072-ggpubr-boxplot.html#setup",
    "href": "Hiplot/072-ggpubr-boxplot.html#setup",
    "title": "GGPubr Boxplot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggpubr; ggthemes\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggpubr\", quietly = TRUE)) {\n  install.packages(\"ggpubr\")\n}\nif (!requireNamespace(\"ggthemes\", quietly = TRUE)) {\n  install.packages(\"ggthemes\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggpubr)\nlibrary(ggthemes)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "GGPubr Boxplot"
    ]
  },
  {
    "objectID": "Hiplot/072-ggpubr-boxplot.html#data-preparation",
    "href": "Hiplot/072-ggpubr-boxplot.html#data-preparation",
    "title": "GGPubr Boxplot",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/ggpubr-boxplot/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# View data\nhead(data)\n\n   len supp dose\n1  4.2   VC  0.5\n2 11.5   VC  0.5\n3  7.3   VC  0.5\n4  5.8   VC  0.5\n5  6.4   VC  0.5\n6 10.0   VC  0.5",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "GGPubr Boxplot"
    ]
  },
  {
    "objectID": "Hiplot/072-ggpubr-boxplot.html#visualization",
    "href": "Hiplot/072-ggpubr-boxplot.html#visualization",
    "title": "GGPubr Boxplot",
    "section": "Visualization",
    "text": "Visualization\n\n# GGPubr Boxplot\np &lt;- ggboxplot(\n  data = data, x = \"supp\", y = \"len\", facet.by = \"dose\",\n  merge = T,\n  color = \"supp\",\n  fill = \"white\") + \n  stat_compare_means(\n    label = \"p.signif\",\n    label.x.npc = \"center\",\n    method = \"wilcox\") + \n  scale_y_continuous(expand = expansion(mult = c(0.2, 0.2))) +\n  scale_fill_manual(values = c(\"#e04d39\",\"#5bbad6\")) +\n  ggtitle(\"Complex Boxplot\") + \n  theme_stata() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: GGPubr Boxplot",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "GGPubr Boxplot"
    ]
  },
  {
    "objectID": "Hiplot/053-ezcox.html",
    "href": "Hiplot/053-ezcox.html",
    "title": "Cox Models Forest",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Cox Models Forest plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/ezcox?lang=en\nCox model forest is a visual representation of a COX model that constructs a risk forest map to facilitate variable screening.",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Cox Models Forest"
    ]
  },
  {
    "objectID": "Hiplot/053-ezcox.html#setup",
    "href": "Hiplot/053-ezcox.html#setup",
    "title": "Cox Models Forest",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ezcox\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ezcox\", quietly = TRUE)) {\n  install.packages(\"ezcox\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ezcox)",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Cox Models Forest"
    ]
  },
  {
    "objectID": "Hiplot/053-ezcox.html#data-preparation",
    "href": "Hiplot/053-ezcox.html#data-preparation",
    "title": "Cox Models Forest",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data are time,status and multiple variable factor.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/ezcox/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# View data\nhead(data)\n\n  time status sex ph.ecog age\n1  306      2   1       1  74\n2  455      2   1       0  68\n3 1010      1   1       0  56\n4  210      2   1       1  57\n5  883      2   1       0  60\n6 1022      1   1       1  74",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Cox Models Forest"
    ]
  },
  {
    "objectID": "Hiplot/053-ezcox.html#visualization",
    "href": "Hiplot/053-ezcox.html#visualization",
    "title": "Cox Models Forest",
    "section": "Visualization",
    "text": "Visualization\n\n# Cox Models Forest\np &lt;- show_forest(\n  data = data,\n  covariates = c(\"sex\", \"ph.ecog\"),\n  controls = \"age\",\n  merge_models = F,\n  drop_controls = F,\n  add_caption = T\n)\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Cox Models Forest\n\n\n\n\n\nThe first column of the table shows the variables and sample numbers, the second column shows the forest plot, and the third column shows the CI 95% confidence interval range, its mean and P values.\nForest map interpretation.\nThe middle vertical line represents the invalid line, the horizontal line represents the 95% confidence interval of the variable factor, and the length represents the magnitude of the confidence interval. If the confidence interval of a variable factor intersects the invalid line, the variable factor is considered to have no statistical significance, and the position of the square is the point estimation of HR.\nAge is the control variable.\nThe incidence of the ph.ecog factor is greater than that of the age factor, and the ph.ecog factor increases the occurrence of survival (P&lt;0.001, statistically significant).\nThe incidence of sex is less than that of age, and sex reduces the incidence of survival (P =0.002&lt;0.05, statistically significant).",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Cox Models Forest"
    ]
  },
  {
    "objectID": "Hiplot/140-pie-matrix.html",
    "href": "Hiplot/140-pie-matrix.html",
    "title": "Pie Matrix",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Pie Matrix plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/pie-matrix?lang=en",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pie Matrix"
    ]
  },
  {
    "objectID": "Hiplot/140-pie-matrix.html#setup",
    "href": "Hiplot/140-pie-matrix.html#setup",
    "title": "Pie Matrix",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2; dplyr; tidyr; stringr\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"tidyr\", quietly = TRUE)) {\n  install.packages(\"tidyr\")\n}\nif (!requireNamespace(\"stringr\", quietly = TRUE)) {\n  install.packages(\"stringr\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(stringr)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pie Matrix"
    ]
  },
  {
    "objectID": "Hiplot/140-pie-matrix.html#data-preparation",
    "href": "Hiplot/140-pie-matrix.html#data-preparation",
    "title": "Pie Matrix",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/pie-matrix/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\ndata[,\"genre\"] &lt;- factor(data[,\"genre\"], levels = unique(data[,\"genre\"]))\ndata[,\"mpaa\"] &lt;- factor(data[,\"mpaa\"], levels = unique(data[,\"mpaa\"]))\ndata[,\"status\"] &lt;- factor(data[,\"status\"], levels = unique(data[,\"status\"]))\ncol &lt;- c(\"#E64B35FF\",\"#4DBBD5FF\")\ndf &lt;- matrix(NA, nrow = length(unique(data[,\"mpaa\"])),\n             ncol = length(unique(data[,\"genre\"])))\nrow.names(df) &lt;- unique(data[,\"mpaa\"])\ncolnames(df) &lt;- unique(data[,\"genre\"])\nfor (i in 1:nrow(df)) {\n    for (j in 1:ncol(df)) {\n      for (k in unique(data[,\"status\"])) {\n        if (is.na(df[i, j])) {\n          df[i, j] &lt;- sum(data[,\"genre\"] == unique(data[,\"genre\"])[j] &\n            data[,\"mpaa\"] == unique(data[,\"mpaa\"])[i] &\n            data[,\"status\"] == k)\n        } else {\n          df[i, j] &lt;- paste0(df[i, j], \",\", \n            sum(data[,\"genre\"] == unique(data[,\"genre\"])[j] &\n              data[,\"mpaa\"] == unique(data[,\"mpaa\"])[i] &\n              data[,\"status\"] == k))\n        }\n      }\n    }\n}\ndf &lt;- as.matrix(df)\n\n# View data\nhead(data[,1:5])\n\n                                               title year length budget rating\n1                          Shawshank Redemption, The 1994    142     25    9.1\n2     Lord of the Rings: The Return of the King, The 2003    251     94    9.0\n3 Lord of the Rings: The Fellowship of the Ring, The 2001    208     93    8.8\n4             Lord of the Rings: The Two Towers, The 2002    223     94    8.8\n5                                       Pulp Fiction 1994    168      8    8.8\n6                                   Schindler's List 1993    195     25    8.8",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pie Matrix"
    ]
  },
  {
    "objectID": "Hiplot/140-pie-matrix.html#visualization",
    "href": "Hiplot/140-pie-matrix.html#visualization",
    "title": "Pie Matrix",
    "section": "Visualization",
    "text": "Visualization\n\n# Pie Matrix\np &lt;- df %&gt;% as.table() %&gt;%\n  as.data.frame() %&gt;%\n  mutate(Freq = str_split(Freq,\",\")) %&gt;%\n  unnest(Freq) %&gt;%\n  mutate(Freq = as.integer(Freq)) %&gt;%\n  # Convert the values to a percentage (which adds up to 1 for each graph)\n  group_by(Var1, Var2) %&gt;%\n  mutate(Freq = ifelse(is.na(Freq), NA, Freq / sum(Freq)),\n         color = row_number()) %&gt;%\n  ungroup() %&gt;%\n  # Plot\n  ggplot(aes(\"\", Freq, fill=factor(color, labels = unique(data[,\"status\"])))) + \n  geom_bar(width = 2, stat = \"identity\") +\n  coord_polar(\"y\") +\n  facet_wrap(~Var1+Var2, ncol = ncol(df)) +\n  scale_fill_manual(values = col) +\n  theme_void() +\n  theme(axis.text = element_blank(), axis.ticks = element_blank(),\n        panel.grid = element_blank(), axis.title = element_blank(),\n        legend.position = \"bottom\", legend.direction = \"horizontal\") +\n  guides(fill = guide_legend(nrow = 1, title = \"status\"))\n  \np\n\n\n\n\n\n\n\nFigureÂ 1: Pie Matrix",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pie Matrix"
    ]
  },
  {
    "objectID": "Hiplot/135-pca2.html",
    "href": "Hiplot/135-pca2.html",
    "title": "PCA2",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot PCA2 plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/pca2?lang=en\nPrincipal component analysis (PCA) is a data processing method with â€œdimension reductionâ€ as the core, replacing multi-index data with a few comprehensive indicators (PCA), and restoring the most essential characteristics of data.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "PCA2"
    ]
  },
  {
    "objectID": "Hiplot/135-pca2.html#setup",
    "href": "Hiplot/135-pca2.html#setup",
    "title": "PCA2",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; FactoMineR; factoextra\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"FactoMineR\", quietly = TRUE)) {\n  install.packages(\"FactoMineR\")\n}\nif (!requireNamespace(\"factoextra\", quietly = TRUE)) {\n  install.packages(\"factoextra\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(FactoMineR)\nlibrary(factoextra)",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "PCA2"
    ]
  },
  {
    "objectID": "Hiplot/135-pca2.html#data-preparation",
    "href": "Hiplot/135-pca2.html#data-preparation",
    "title": "PCA2",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data are set (gene name and corresponding gene expression value) and sample information (sample name and grouping).\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/pca2/data.json\")$exampleData[[1]]$textarea[[1]])\ndata &lt;- as.data.frame(data)\nsample_info &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/pca2/data.json\")$exampleData[[1]]$textarea[[2]])\nsample_info &lt;- as.data.frame(sample_info)\n\n# Convert data structure\nrow.names(sample_info) &lt;- sample_info[,1]\nsample_info &lt;- sample_info[colnames(data)[-1],]\n## tsne\nrownames(data) &lt;- data[, 1]\ndata &lt;- as.matrix(data[, -1])\npca_data &lt;- PCA(t(as.matrix(data)), scale.unit = TRUE, ncp = 5, graph = FALSE)\n\n# View data\nhead(data[,1:5])\n\n              M1       M2        M3       M4       M5\nGBP4    6.599344 5.226266  3.693288 3.938501 4.527193\nBCAT1   5.760380 4.892783  5.448924 3.485413 3.855669\nCMPK2   9.561905 4.549168  3.998655 5.614384 3.904793\nSTOX2   8.396409 8.717055  8.039064 7.643060 9.274649\nPADI2   8.419766 8.268430  8.451181 9.200732 8.598207\nSCARNA5 7.653074 5.780393 10.633550 5.913684 8.805605",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "PCA2"
    ]
  },
  {
    "objectID": "Hiplot/135-pca2.html#visualization",
    "href": "Hiplot/135-pca2.html#visualization",
    "title": "PCA2",
    "section": "Visualization",
    "text": "Visualization\n\n# PCA2\np &lt;- fviz_pca_ind(pca_data, geom.ind = \"point\", pointsize = 6, addEllipses = TRUE,\n                  mean.point = F, col.ind = sample_info[,\"Group\"]) +\n  ggtitle(\"Principal Component Analysis\") +\n  scale_fill_manual(values = c(\"#00468BFF\",\"#ED0000FF\")) +\n  scale_color_manual(values = c(\"#00468BFF\",\"#ED0000FF\")) +\n  theme_bw() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: PCA2\n\n\n\n\n\nDifferent colors represent different samples, which can explain the relationship between principal components and original variables. For example, M1 has a greater contribution to PC1, while M8 has a greater negative correlation with PC1.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "PCA2"
    ]
  },
  {
    "objectID": "Hiplot/186-waterfalls.html",
    "href": "Hiplot/186-waterfalls.html",
    "title": "Waterfalls",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Waterfalls plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/waterfalls?lang=en\nThe waterfall chart is used to display the cumulative effect of sequentially introduced positive or negative values . These intermediate values can either be time based or category based.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Waterfalls"
    ]
  },
  {
    "objectID": "Hiplot/186-waterfalls.html#setup",
    "href": "Hiplot/186-waterfalls.html#setup",
    "title": "Waterfalls",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; waterfalls; ggplot2\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"waterfalls\", quietly = TRUE)) {\n  install.packages(\"waterfalls\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(waterfalls)\nlibrary(ggplot2)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Waterfalls"
    ]
  },
  {
    "objectID": "Hiplot/186-waterfalls.html#data-preparation",
    "href": "Hiplot/186-waterfalls.html#data-preparation",
    "title": "Waterfalls",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data have two columns, with the first for category based items and the second for their corresponding values.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/waterfalls/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# View data\nhead(data)\n\n  label value\n1     a   100\n2     b   -20\n3     c    10\n4     d    20\n5     e   110",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Waterfalls"
    ]
  },
  {
    "objectID": "Hiplot/186-waterfalls.html#visualization",
    "href": "Hiplot/186-waterfalls.html#visualization",
    "title": "Waterfalls",
    "section": "Visualization",
    "text": "Visualization\n\n# Waterfalls\np &lt;- waterfall(data, rect_text_labels = data$value, rect_text_size = 1,\n    rect_text_labels_anchor = \"centre\", calc_total = T,\n    total_axis_text = \"Total\", total_rect_text = sum(data$value),\n    total_rect_color = \"steelblue\", total_rect_text_color = \"black\",\n    rect_width = 0.7, rect_border = \"black\", draw_lines = TRUE,\n    linetype = 2, fill_by_sign = F, \n    fill_colours = c(\"#E64B35FF\",\"#4DBBD5FF\",\"#00A087FF\",\"#3C5488FF\",\"#F39B7FFF\",\n                     \"#8491B4FF\"),\n    scale_y_to_waterfall = T) +\n  theme_bw() +\n  theme(axis.text = element_text(size = 12),\n        plot.title = element_text(hjust = 0.5)) +\n  labs(title = \"Waterfalls Plot\")\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Waterfalls\n\n\n\n\n\nAs shown in the example figure, the x-axis represent each category based items, the y-axis showing their cumulative values. Increments and decrements that are sufficiently extreme can cause the cumulative total to fall above and below the axis at various points.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Waterfalls"
    ]
  },
  {
    "objectID": "Hiplot/163-scatterpie.html",
    "href": "Hiplot/163-scatterpie.html",
    "title": "Scatterpie",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Scatterpie plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/scatterpie?lang=en\nScatter Pie can be used to visualize data fraction in different space coordinates.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Scatterpie"
    ]
  },
  {
    "objectID": "Hiplot/163-scatterpie.html#setup",
    "href": "Hiplot/163-scatterpie.html#setup",
    "title": "Scatterpie",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; scatterpie\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"scatterpie\", quietly = TRUE)) {\n  install.packages(\"scatterpie\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(scatterpie)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Scatterpie"
    ]
  },
  {
    "objectID": "Hiplot/163-scatterpie.html#data-preparation",
    "href": "Hiplot/163-scatterpie.html#data-preparation",
    "title": "Scatterpie",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/scatterpie/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# View data\nhead(data)\n\n            x          y          A        B        C        D\n1  -56.047565  12.665926 0.71040656 2.887786 1.309570 2.892264\n2  -23.017749  -1.427338 0.25688371 1.403569 1.375096 4.945092\n3    7.050839  68.430114 0.24669188 0.524395 3.189978 5.138863\n4   12.928774 -11.288549 0.34754260 3.144288 3.789556 2.295894\n5 -126.506123  29.230687 0.95161857 3.029335 1.048951 2.471943\n6  -68.685285   6.192712 0.04502772 3.203072 2.596539 4.439393",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Scatterpie"
    ]
  },
  {
    "objectID": "Hiplot/163-scatterpie.html#visualization",
    "href": "Hiplot/163-scatterpie.html#visualization",
    "title": "Scatterpie",
    "section": "Visualization",
    "text": "Visualization\n\n# Scatterpie\np &lt;- ggplot() +\n  geom_scatterpie(data = data, aes(x = x, y = y), cols = colnames(data)[-c(1, 2)]) +\n  scale_fill_manual(values = c(\"#E64B35FF\",\"#4DBBD5FF\",\"#00A087FF\",\"#3C5488FF\")) +\n  labs(x=\"x\", y=\"y\") +\n  theme_minimal() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Scatterpie",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Scatterpie"
    ]
  },
  {
    "objectID": "Hiplot/029-cor-heatmap-simple.html",
    "href": "Hiplot/029-cor-heatmap-simple.html",
    "title": "Simplified Correlation Heatmap",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Simplified Correlation Heatmap plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/cor-heatmap-simple?lang=en\nSimplified variables correlation heatmap",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Simplified Correlation Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/029-cor-heatmap-simple.html#setup",
    "href": "Hiplot/029-cor-heatmap-simple.html#setup",
    "title": "Simplified Correlation Heatmap",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2; ggisoband\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"sigminer\", quietly = TRUE)) {\n  BiocManager::install(\"sigminer\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(sigminer)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Simplified Correlation Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/029-cor-heatmap-simple.html#data-preparation",
    "href": "Hiplot/029-cor-heatmap-simple.html#data-preparation",
    "title": "Simplified Correlation Heatmap",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/cor-heatmap-simple/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# View data\nhead(data)\n\n   mpg cyl disp  hp drat    wt  qsec vs am gear carb\n1 21.0   6  160 110 3.90 2.620 16.46  0  1    4    4\n2 21.0   6  160 110 3.90 2.875 17.02  0  1    4    4\n3 22.8   4  108  93 3.85 2.320 18.61  1  1    4    1\n4 21.4   6  258 110 3.08 3.215 19.44  1  0    3    1\n5 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2\n6 18.1   6  225 105 2.76 3.460 20.22  1  0    3    1",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Simplified Correlation Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/029-cor-heatmap-simple.html#visualization",
    "href": "Hiplot/029-cor-heatmap-simple.html#visualization",
    "title": "Simplified Correlation Heatmap",
    "section": "Visualization",
    "text": "Visualization\n\n# Simplified Correlation Heatmap\np &lt;- show_cor(\n  data = data,\n  x_vars = c(\"mpg\",\"cyl\",\"disp\"),\n  y_vars = c(\"wt\",\"hp\",\"drat\"),\n  cor_method = \"pearson\",\n  vis_method = \"square\",\n  lab = T,\n  test = T,\n  hc_order = F,\n  legend.title = \"Corr\"\n  ) +\n  ggtitle(\"\") +\n  labs(x=\"\", y=\"\") +\n  theme_bw() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Simplified Correlation Heatmap",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Simplified Correlation Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/170-taylor-diagram.html",
    "href": "Hiplot/170-taylor-diagram.html",
    "title": "Taylor Diagram",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Taylor Diagram plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/taylor-diagram?lang=en\nIt can be used to display the standard deviation (SD), root mean square (RMS) error and correlation coefficient of the models simultaneously.",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Taylor Diagram"
    ]
  },
  {
    "objectID": "Hiplot/170-taylor-diagram.html#setup",
    "href": "Hiplot/170-taylor-diagram.html#setup",
    "title": "Taylor Diagram",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: openair\n\n\n# Install packages\nif (!requireNamespace(\"openair\", quietly = TRUE)) {\n  install.packages(\"openair\")\n}\n\n# Load packages\nlibrary(openair)",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Taylor Diagram"
    ]
  },
  {
    "objectID": "Hiplot/170-taylor-diagram.html#data-preparation",
    "href": "Hiplot/170-taylor-diagram.html#data-preparation",
    "title": "Taylor Diagram",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndat &lt;- selectByDate(mydata, year = 2003)\n\n# convert data structure\ndat &lt;- data.frame(date = mydata$date, obs = mydata$nox, mod = mydata$nox)\ndat &lt;- transform(dat, month = as.numeric(format(date, \"%m\")))\nmod1 &lt;- transform(dat, mod = mod + 10 * month + 10 * month * rnorm(nrow(dat)),\nmodel = \"model 1\")\nmod1 &lt;- transform(mod1, mod = c(mod[5:length(mod)], mod[(length(mod) - 3) :\nlength(mod)]))\nmod2 &lt;- transform(dat, mod = mod + 7 * month + 7 * month * rnorm(nrow(dat)),\nmodel = \"model 2\")\nmod3 &lt;- transform(dat, mod = mod + 3 * month + 3 * month * rnorm(nrow(dat)),\nmodel = \"model 3\")\nmod.dat &lt;- rbind(mod1, mod2, mod3)\n\n# View data\nhead(mod.dat)\n\n                 date obs      mod month   model\n1 1998-01-01 00:00:00 285 477.8532     1 model 1\n2 1998-01-01 01:00:00  NA 268.4497     1 model 1\n3 1998-01-01 02:00:00  NA 187.4198     1 model 1\n4 1998-01-01 03:00:00 493 185.7096     1 model 1\n5 1998-01-01 04:00:00 468 156.2628     1 model 1\n6 1998-01-01 05:00:00 264 124.1938     1 model 1",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Taylor Diagram"
    ]
  },
  {
    "objectID": "Hiplot/170-taylor-diagram.html#visualization",
    "href": "Hiplot/170-taylor-diagram.html#visualization",
    "title": "Taylor Diagram",
    "section": "Visualization",
    "text": "Visualization\n\n# Taylor Diagram\nTaylorDiagram(mod.dat, obs = \"obs\", mod = \"mod\", group = \"model\",\n              main = \"Taylor diagram\", \n              cols = c(\"#00468BFF\",\"#8e6097\",\"#BFACF0FF\"))\n\n\n\n\n\n\n\nFigureÂ 1: Taylor Diagram",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Taylor Diagram"
    ]
  },
  {
    "objectID": "Hiplot/025-complex-heatmap.html",
    "href": "Hiplot/025-complex-heatmap.html",
    "title": "Complex Heatmap",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Complex Heatmap plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/complex-heatmap?lang=en\nA multi-omics plugins to draw heatmap, meta annotation, and mutations.",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Complex Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/025-complex-heatmap.html#setup",
    "href": "Hiplot/025-complex-heatmap.html#setup",
    "title": "Complex Heatmap",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ComplexHeatmap; circlize; randomcoloR; ggplotify; stringr; cowplot; hiplotlib\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ComplexHeatmap\", quietly = TRUE)) {\n  BiocManager::install(\"ComplexHeatmap\")\n}\nif (!requireNamespace(\"circlize\", quietly = TRUE)) {\n  install.packages(\"circlize\")\n}\nif (!requireNamespace(\"randomcoloR\", quietly = TRUE)) {\n  install.packages(\"randomcoloR\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\nif (!requireNamespace(\"stringr\", quietly = TRUE)) {\n  install.packages(\"stringr\")\n}\nif (!requireNamespace(\"cowplot\", quietly = TRUE)) {\n  install.packages(\"cowplot\")\n}\nif (!requireNamespace(\"hiplotlib\", quietly = TRUE)) {\n  remotes::install_github(\"hiplot/hiplotlib\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ComplexHeatmap)\nlibrary(circlize)\nlibrary(randomcoloR)\nlibrary(ggplotify)\nlibrary(stringr)\nlibrary(cowplot)\nlibrary(hiplotlib)",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Complex Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/025-complex-heatmap.html#data-preparation",
    "href": "Hiplot/025-complex-heatmap.html#data-preparation",
    "title": "Complex Heatmap",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/complex-heatmap/data.json\")$exampleData[[1]]$textarea[[1]])\ndata &lt;- as.data.frame(data)\ndata2 &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/complex-heatmap/data.json\")$exampleData[[1]]$textarea[[2]])\ndata2 &lt;- as.data.frame(data2)\n\n# convert data structure\nkeep_vars_ref &lt;- ls() \nrow.names(data) &lt;- data[, 1]\ndata &lt;- data[, -1]\naxis_raw &lt;- c(\"KRAS\",\"GBP4\")\nexp_start_col &lt;- which(colnames(data) == axis_raw[2])\nmut_start_col &lt;- which(colnames(data) == axis_raw[1])\nheat_mat &lt;- as.matrix(t(data[, exp_start_col:ncol(data)]))\nmut_mat &lt;- as.matrix(t(data[, mut_start_col:(exp_start_col - 1)]))\nmut_mat[is.na(mut_mat)] &lt;- \"\"\n\ncolor_key &lt;- c(\"#196ABD\", \"#3399FF\", \"#3399FF\", \"#f4f4f4\", \"#f4f4f4\", \"#f4f4f4\", \"#FF3333\", \"#FF3333\", \"#C20B01\")\n\ncols &lt;- c()\nfor (i in 1:nrow(data2)) {\n  cols[data2[i,1]] &lt;- data2[i,2]\n}\ncol_meta &lt;- list()\ncol_meta_pre &lt;- list()\nitems &lt;- c()\nfor (i in 1:(mut_start_col - 1)) {\n  ref &lt;- unique(data[, i])\n  ref &lt;- ref[!is.na(ref) & ref != \"\"]\n  if (any(is.numeric(ref)) & length(ref) &gt; 2) {\n    col_meta_pre[[colnames(data)[i]]] &lt;- hiplotlib::col_fun_cont(data[,i])\n  } else if (length(ref) == 2 & any(is.numeric(ref))) {\n    col_meta_pre[[colnames(data)[i]]] &lt;- c(\"#f4f4f4\", \"#5a5a5a\")\n    items &lt;- c(items, ref)\n  } else if (length(ref) == 2 & any(is.character(ref))) {\n    col_meta_pre[[colnames(data)[i]]] &lt;- c(\"#196ABD\", \"#C20B01\")\n    items &lt;- c(items, unique(data[, i]))\n  } else if (length(unique(data[, i])) &gt; 2) {\n    col_meta_pre[[colnames(data)[i]]] &lt;- distinctColorPalette(\n      length(unique(data[, i]))\n    )\n    items &lt;- c(items, unique(data[, i]))\n  }\n}\nmeta_mat2 &lt;- NULL\nmeta_mat2_unique_names &lt;- c()\nmeta_mat2_unique_cols &lt;- c()\nfor (i in names(col_meta_pre)) {\n  if (!is.function(col_meta_pre[[i]])) {\n    meta_mat2_unique_names &lt;- c(meta_mat2_unique_names, i)\n    meta_mat2_unique_cols &lt;- c(meta_mat2_unique_cols, col_meta_pre[[i]])\n    meta_mat2 &lt;- cbind(meta_mat2, data[, i])\n    colnames(meta_mat2)[ncol(meta_mat2)] &lt;- i\n  } else {\n    col_meta[[i]] &lt;- col_meta_pre[[i]]\n  }\n}\nmeta_mat2 &lt;- as.matrix(meta_mat2)\ncol_meta[[\"Meta2\"]] &lt;- structure(\n  names = items[!duplicated(items)],\n  meta_mat2_unique_cols[!duplicated(items)]\n)\n\n# View data\nhead(data)\n\n   Age Gender      Fusion Death Relapse     KRAS       TP53                NRAS\nM1  12 Female   ETV6-PMEL     0       0 missense       &lt;NA&gt; missense/frameshift\nM2   5   Male ETV6-BORCS5     0       1 missense       &lt;NA&gt;                &lt;NA&gt;\nM3  16 Female   ETV6-NID1     0       0 missense       &lt;NA&gt;                &lt;NA&gt;\nM4  26 Female     ERG-FUS     0       0     &lt;NA&gt;       &lt;NA&gt;                &lt;NA&gt;\nM5  32 Female RUNX1-UGGT2     1       0     &lt;NA&gt; frameshift                &lt;NA&gt;\nM6   1 Female  ETV6-RUNX1     1       1 missense       &lt;NA&gt;                &lt;NA&gt;\n         JAK1       JAK3       PTEN   NOTCH1      KMT2A               SETD2\nM1       &lt;NA&gt; frameshift       &lt;NA&gt;     &lt;NA&gt;       &lt;NA&gt; missense/frameshift\nM2       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;     &lt;NA&gt;       &lt;NA&gt;                &lt;NA&gt;\nM3       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; missense   nonsense            nonsense\nM4       &lt;NA&gt;       &lt;NA&gt; proteinIns     &lt;NA&gt;       &lt;NA&gt;                &lt;NA&gt;\nM5       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; missense frameshift                &lt;NA&gt;\nM6 frameshift       &lt;NA&gt; proteinIns     &lt;NA&gt;       &lt;NA&gt;                &lt;NA&gt;\n        KDM6A     DNMT3A                        DDX3X     GBP4    BCAT1\nM1                  &lt;NA&gt;                         &lt;NA&gt; 6.599344 5.760380\nM2   nonsense       &lt;NA&gt;                         &lt;NA&gt; 5.226266 4.892783\nM3       &lt;NA&gt;       &lt;NA&gt;                         &lt;NA&gt; 3.693288 5.448924\nM4       &lt;NA&gt;       &lt;NA&gt;                         &lt;NA&gt; 3.938501 3.485413\nM5       &lt;NA&gt;       &lt;NA&gt;                         &lt;NA&gt; 4.527193 3.855669\nM6 proteinDel frameshift missense/frameshift/missense 9.308119 8.662081\n      CMPK2    STOX2    PADI2   SCARNA5 ALOX12P2  SNORA74B HIST1H2BL     MNDA\nM1 9.561905 8.396409 8.419766  7.653074 9.001421  5.538709  6.181270 8.702635\nM2 4.549168 8.717055 8.268430  5.780393 7.753542  7.169053  4.448419 7.322352\nM3 3.998655 8.039064 8.451181 10.633550 4.920960 11.441646  5.604961 9.271821\nM4 5.614384 7.643060 9.200732  5.913684 7.636354  5.982566  6.485168 9.134515\nM5 3.904793 9.274649 8.598207  8.805605 9.888625  8.394403  2.599574 8.339114\nM6 9.790770 4.417013 4.590033  5.890120 6.211944  4.751559  7.630177 4.571902\n      OLFM4     FLT3     CHD7    NFIL3   HSPA1B    AP5B1   IPCEF1     LRG1\nM1 9.345308 5.164306 8.373475 8.055416 5.008199 8.236820 8.263067 8.553083\nM2 6.438607 4.419355 8.728032 8.365100 9.194650 8.972639 9.287856 9.053322\nM3 8.716761 5.063551 8.408818 9.239194 6.598850 8.204217 8.602233 9.074509\nM4 9.685545 5.412784 8.716476 8.536825 7.129509 8.432428 8.491156 8.736700\nM5 7.688262 3.337863 8.373771 8.452351 3.885270 9.224007 8.447699 7.656333\nM6 5.969804 8.585164 4.613199 4.478527 5.712179 4.424204 4.483936 4.529944\n      THBS4     RGL4     MPP7     UGCG   CYSTM1    ANXA2   ENDOD1 ARHGAP24\nM1 8.881039 8.454808 8.690520 8.648366 8.628884 4.983769 5.551640 6.890079\nM2 8.896205 8.019389 8.630346 8.600555 9.238677 6.748022 5.406465 8.883941\nM3 7.844801 8.990836 7.080873 9.431046 8.487243 6.220791 4.663785 9.560651\nM4 8.739369 9.718631 9.838476 7.923021 8.958537 4.719403 3.550765 8.285674\nM5 8.627063 7.908075 8.271824 8.309214 7.357109 3.284346 4.103507 9.043752\nM6 4.699310 4.147051 5.179200 4.902510 4.541605 8.089850 8.393991 3.544010\n       CST7 HIST1H2BM     EREG     EMP1    NFAM1  SLC40A1     CD52 HIST1H2BH\nM1 7.883061  6.186908 8.598145 4.837475 8.656290 9.520822 4.230927  5.805177\nM2 8.546585  4.448803 4.920184 5.999576 9.957289 4.630086 5.932496  4.343197\nM3 8.364553  5.428771 9.227645 6.115168 7.319900 5.116486 5.011898  6.139380\nM4 9.540110  6.747681 5.222157 5.056323 8.073514 9.346003 5.101308  5.817530\nM5 8.697473  2.577579 4.689850 4.808930 9.016658 9.813192 4.398327  2.513284\nM6 3.557674  7.828233 8.703617 6.713164 4.517623 6.101416 6.380094  8.188458\n     PFKFB3 SNORD116-20    STX11    SYNE2     TCN1  SNORA74A     CD74   EIF4E3\nM1 7.424257    8.377058 8.338488 9.110726 8.193179  5.498904 5.017443 9.366888\nM2 9.676785    5.359553 8.565954 9.678361 8.907285  5.062103 5.383978 8.360189\nM3 8.935156    8.694841 8.767868 8.405612 8.713848 12.561499 3.405651 5.655052\nM4 8.045833    8.044567 9.403257 6.946242 8.980928  5.839202 3.264327 4.287721\nM5 8.890690    2.953568 7.892702 8.156073 7.627558  7.581051 5.602966 8.713765\nM6 4.273864    7.268419 4.205835 5.791007 4.626609  5.498296 8.550157 8.880801\n      MYO7B       MX1      LDLR    S100P  PTPRCAP      KIT     OLR1      NKG7\nM1 8.796115 10.739903  3.302395 8.356363 5.028667 5.888212 9.018682  7.312523\nM2 9.265837  4.504043 10.582430 7.915491 4.724011 2.533194 7.936957 10.372964\nM3 7.865640  4.714303  6.209913 9.481770 4.122229 5.077111 9.390897  7.937744\nM4 8.785320  6.244798  3.804214 9.642993 4.188948 4.744693 8.897994  8.161249\nM5 9.209703  4.891501  4.631391 8.363519 3.803051 4.839051 8.668925  9.671051\nM6 4.272202 10.727879  5.534046 3.699451 8.525159 9.085158 5.261595  4.164076",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Complex Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/025-complex-heatmap.html#visualization",
    "href": "Hiplot/025-complex-heatmap.html#visualization",
    "title": "Complex Heatmap",
    "section": "Visualization",
    "text": "Visualization\n\n# Complex Heatmap\nparams &lt;- list()\nfor (i in names(col_meta)) {\n  if (i != \"Meta2\") {\n    params[[i]] &lt;- data[, i]\n  }\n}\nparams2 &lt;- list(\n  Meta2 = meta_mat2,\n  gap = 0,\n  border = TRUE,\n  show_annotation_name = TRUE,\n  col = col_meta,\n  na_col = \"#FFFFFF\",\n  show_legend = FALSE,\n  annotation_legend_param = list(direction = \"horizontal\")\n)\nfor (i in names(params2)) {\n  params[[i]] &lt;- params2[[i]]\n}\nha &lt;- do.call(HeatmapAnnotation, params)\nhlist &lt;- Heatmap(heat_mat,\n      col = hiplotlib::col_fun_cont(heat_mat, cols = color_key),\n      name = \"Expression\",\n      gap = 0,\n      clustering_distance_columns = \"euclidean\",\n      clustering_distance_rows = \"euclidean\",\n      clustering_method_columns = \"ward.D2\",\n      show_row_dend = TRUE, show_column_dend = TRUE,\n      show_row_names = FALSE,\n      row_title_gp = gpar(col = \"#FFFFFF00\"),\n      cluster_rows = TRUE,\n      cluster_columns = TRUE,\n      bottom_annotation = ha,\n      show_heatmap_legend = TRUE,\n      heatmap_legend_param = list(direction = \"horizontal\")\n    )\np1 &lt;- as.ggplot(\n  function() {\n    draw(hlist, annotation_legend_side = \"right\", heatmap_legend_side = \"top\")\n  }\n)\nidx &lt;- sort(rowSums(!is.na(mut_mat) & mut_mat != \"0\" & mut_mat != \"\"), decreasing = TRUE)\nmut_mat &lt;- mut_mat[names(idx),]\n\np2 &lt;- as.ggplot(\n  function() {\n    params &lt;- list(\n      mut_mat,\n      get_type = function(x) strsplit(x, \"/\")[[1]],\n      alter_fun = hiplotlib::alter_fun, col = cols, row_order = 1:nrow(mut_mat),\n      show_column_names = TRUE,\n      show_pct = TRUE,\n      right_annotation = NULL,\n      top_annotation = NULL,\n      border = TRUE,\n      heatmap_legend_param = list(direction = \"horizontal\"),\n      show_heatmap_legend = FALSE)\n      params$column_order &lt;- unlist(column_order(hlist))\n      draw(do.call(oncoPrint, params), annotation_legend_side = \"bottom\", heatmap_legend_side = \"bottom\")\n    }\n  )\n\np3 &lt;- as.ggplot(function() {\n    legend_tmp &lt;- list()\n    for (i in names(col_meta_pre)) {\n      if (is.function(col_meta_pre[[i]])) {\n        legend_tmp[[i]] &lt;- Legend(\n          col_fun = col_meta_pre[[i]],\n          title = i, direction = \"horizontal\"\n        )\n      } else if (identical(col_meta_pre[[i]], c(\"#f4f4f4\", \"#5a5a5a\"))) {\n        legend_tmp[[i]] &lt;- Legend(\n          at = unique(data[, i]), title = i,\n          direction = \"horizontal\",\n          labels = c(\"No\", \"Yes\"),\n          legend_gp = gpar(fill = col_meta_pre[[i]])\n        )\n      } else {\n         legend_tmp[[i]] &lt;- Legend(\n          at = unique(data[, i]), title = i,\n          direction = \"horizontal\",\n          legend_gp = gpar(fill = col_meta_pre[[i]])\n        )\n      }\n    }\n    ref_mut &lt;- unique(unlist(str_split(mut_mat, \"/\")))\n    ref_mut &lt;- ref_mut[ref_mut != \"\" & ref_mut != \"NANA\"]\n    ref_mut &lt;- ref_mut[!is.na(ref_mut)]\n    lgd_mut &lt;- Legend(\n      at = ref_mut, title = \"Mutations\",\n      direction = \"horizontal\",\n      legend_gp = gpar(fill = cols[ref_mut])\n    )\n    legend_tmp[[length(legend_tmp) + 1]] &lt;- lgd_mut\n    legend_tmp$direction &lt;- \"horizontal\"\n    legend_tmp$max_width &lt;- unit(14, \"cm\")\n    legend_tmp$column_gap &lt;- unit(5, \"mm\")\n    legend_tmp$row_gap &lt;- unit(0.5, \"cm\")\n    draw(do.call(packLegend, legend_tmp))\n  })\nrel_height &lt;- as.numeric(str_split(\"4, 2, 2\", \", |,| |;\")[[1]])\np &lt;- plot_grid(p1, p2, p3, ncol = 1, rel_heights = rel_height)\np\n\n\n\n\n\n\n\nFigureÂ 1: Complex Heatmap",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Complex Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/042-diffusion-map.html",
    "href": "Hiplot/042-diffusion-map.html",
    "title": "Diffusion Map",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Diffusion Map plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/diffusion-map?lang=en\nDiffusion Map is a nonlinear dimensionality reduction algorithm that can be used to visualize developmental trajectories.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Diffusion Map"
    ]
  },
  {
    "objectID": "Hiplot/042-diffusion-map.html#setup",
    "href": "Hiplot/042-diffusion-map.html#setup",
    "title": "Diffusion Map",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; destiny; ggplotify; scatterplot3d; ggpubr\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"destiny\", quietly = TRUE)) {\n  remotes::install_github(\"theislab/destiny\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\nif (!requireNamespace(\"scatterplot3d\", quietly = TRUE)) {\n  install.packages(\"scatterplot3d\")\n}\nif (!requireNamespace(\"ggpubr\", quietly = TRUE)) {\n  install.packages(\"ggpubr\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(destiny)\nlibrary(ggplotify)\nlibrary(scatterplot3d)\nlibrary(ggpubr)",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Diffusion Map"
    ]
  },
  {
    "objectID": "Hiplot/042-diffusion-map.html#data-preparation",
    "href": "Hiplot/042-diffusion-map.html#data-preparation",
    "title": "Diffusion Map",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata1 &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/diffusion-map/data.json\")$exampleData[[1]]$textarea[[1]])\ndata1 &lt;- as.data.frame(data1)\ndata2 &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/diffusion-map/data.json\")$exampleData[[1]]$textarea[[2]])\ndata2 &lt;- as.data.frame(data2)\n\n# convert data structure\nsample.info &lt;- data2\nrownames(data1) &lt;- data1[, 1]\ndata1 &lt;- as.matrix(data1[, -1])\n## tsne\nset.seed(123)\ndm_info &lt;- DiffusionMap(t(data1))\ndm_info &lt;- cbind(DC1 = dm_info$DC1, DC2 = dm_info$DC2, DC3 = dm_info$DC3)\ndm_data &lt;- data.frame(\n  sample = colnames(data1),\n  dm_info\n)\n\ncolorBy &lt;- sample.info[match(colnames(data1), sample.info[, 1]), \"Group\"]\ncolorBy &lt;- factor(colorBy, level = colorBy[!duplicated(colorBy)])\ndm_data$colorBy = colorBy\n\n# View data\nhead(dm_data)\n\n   sample        DC1        DC2         DC3 colorBy\nM1     M1 0.05059918 0.15203860 -0.06533168      G1\nM2     M2 0.05030863 0.14435034 -0.06044277      G1\nM3     M3 0.04271398 0.09273382 -0.02730427      G1\nM4     M4 0.04680742 0.10425273 -0.03789962      G1\nM5     M5 0.04971521 0.12786900 -0.05608321      G1\nM6     M6 0.04840072 0.12728303 -0.05256815      G1",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Diffusion Map"
    ]
  },
  {
    "objectID": "Hiplot/042-diffusion-map.html#visualization",
    "href": "Hiplot/042-diffusion-map.html#visualization",
    "title": "Diffusion Map",
    "section": "Visualization",
    "text": "Visualization\n\n1. 2D\n\n# 2D Diffusion Map\np &lt;- ggscatter(data = dm_data,  x = \"DC1\", y = \"DC2\", color = \"colorBy\",\n               size = 2, palette = \"lancet\", alpha = 1) +\n  labs(color = \"Group\") +\n  ggtitle(\"Diffusion Map\") +\n  scale_color_manual(values = c(\"#3B4992FF\",\"#EE0000FF\",\"#008B45FF\")) +\n  theme_classic() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: 2D Diffusion Map\n\n\n\n\n\n\n\n2. 3D\n\n# 3D Diffusion Map\ngroup.color &lt;- c(\"#3B4992FF\",\"#EE0000FF\",\"#008B45FF\")\nnames(group.color) &lt;- unique(dm_data$colorBy)\ngroup.color &lt;- group.color[!is.na(names(group.color))]\nif (length(group.color) == 0) {\n  group.color &lt;- c(Default=\"black\")\n  dm_data$colorBy &lt;- \"Default\"\n}\np &lt;- as.ggplot(function(){\n  scatterplot3d(x = dm_data$DC1, y = dm_data$DC2, z = dm_data$DC3,\n                color =  alpha(group.color[dm_data$colorBy], 1),\n                xlim=c(min(dm_data$DC1), max(dm_data$DC1)),\n                ylim=c(min(dm_data$DC2), max(dm_data$DC2)),\n                zlim=c(min(dm_data$DC3), max(dm_data$DC3)),\n                pch = 16, cex.symbols  = 0.6,\n                scale.y = 0.8,\n                xlab = \"DC1\", ylab = \"DC2\", zlab = \"DC3\",\n                angle = 40,\n                main = \"Diffusion Map\",\n                col.axis = \"#444444\", col.grid = \"#CCCCCC\")\n  legend(\"right\", legend = names(group.color),\n         col = alpha(group.color, 0.8), pch = 16)\n    })\np &lt;- p + theme_classic()\n\np\n\n\n\n\n\n\n\nFigureÂ 2: 3D Diffusion Map",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Diffusion Map"
    ]
  },
  {
    "objectID": "Hiplot/085-half-violin.html",
    "href": "Hiplot/085-half-violin.html",
    "title": "Half Violin",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Half Violin plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/half-violin?lang=en\nThe half violin plot is a statistical graph used to display the distribution and probability density of data by replacing the left part with the data frequency count graph on the basis of keeping the right part of violin graph.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Half Violin"
    ]
  },
  {
    "objectID": "Hiplot/085-half-violin.html#setup",
    "href": "Hiplot/085-half-violin.html#setup",
    "title": "Half Violin",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2; dplyr; ggpubr; ggthemes\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"ggpubr\", quietly = TRUE)) {\n  install.packages(\"ggpubr\")\n}\nif (!requireNamespace(\"ggthemes\", quietly = TRUE)) {\n  install.packages(\"ggthemes\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(ggpubr)\nlibrary(ggthemes)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Half Violin"
    ]
  },
  {
    "objectID": "Hiplot/085-half-violin.html#data-preparation",
    "href": "Hiplot/085-half-violin.html#data-preparation",
    "title": "Half Violin",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data is data set (gene names and expression levels in different tumors).\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/half-violin/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\ncolnames(data) &lt;- c(\"Value\", \"Group\")\ndata[, 2] &lt;- factor(data[, 2], levels = unique(data[, 2]))\n\n# View data\nhead(data)\n\n     Value Group\n1 12.10228   AML\n2 12.61382   AML\n3 12.52741   AML\n4 12.67990   AML\n5 12.64837   AML\n6 12.12146   AML",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Half Violin"
    ]
  },
  {
    "objectID": "Hiplot/085-half-violin.html#visualization",
    "href": "Hiplot/085-half-violin.html#visualization",
    "title": "Half Violin",
    "section": "Visualization",
    "text": "Visualization\n\n# Half Violin\ngeom_flat_violin &lt;- function(\n  mapping = NULL, data = NULL, stat = \"ydensity\", position = \"dodge\", \n  trim = TRUE, scale = \"area\", show.legend = NA, inherit.aes = TRUE, ...) {\n  ggplot2::layer(data = data, mapping = mapping, stat = stat, \n                 geom = geom_flat_violin_proto, position = position,\n                 show.legend = show.legend, inherit.aes = inherit.aes,\n                 params = list(trim = trim, scale = scale, ...))\n}\n\n\"%||%\" &lt;- function(a, b) {\n  if (!is.null(a)) {\n    a\n  } else {\n    b\n  }\n}\n\ngeom_flat_violin_proto &lt;-\n  ggproto(\"geom_flat_violin_proto\", Geom,\n          setup_data = function(data, params) {\n            data$width &lt;- data$width %||%\n              params$width %||% (resolution(data$x, FALSE) * 0.9)\n            \n            data %&gt;%\n              dplyr::group_by(.data = ., group) %&gt;%\n              dplyr::mutate(.data = ., ymin = min(y), ymax = max(y), xmin = x,\n                            xmax = x + width / 2)\n          },\n          \n          draw_group = function(data, panel_scales, coord) {\n            data &lt;- base::transform(data, xminv = x, \n                                    xmaxv = x + violinwidth * (xmax - x))\n            \n            newdata &lt;- base::rbind(\n              dplyr::arrange(.data = base::transform(data, x = xminv), y),\n              dplyr::arrange(.data = base::transform(data, x = xmaxv), -y))\n            \n            newdata &lt;- rbind(newdata, newdata[1, ])\n            \n            ggplot2:::ggname(\"geom_flat_violin\",\n                             GeomPolygon$draw_panel(newdata, panel_scales, coord))\n          },\n          \n          draw_key = draw_key_polygon,\n          \n          default_aes = ggplot2::aes(weight = 1, colour = \"grey20\", fill = \"white\",\n                                     size = 0.5, alpha = NA, linetype = \"solid\"),\n          required_aes = c(\"x\", \"y\")\n        )\n\np &lt;- ggplot(data = data, aes(Group, Value, fill = Group)) +\n  geom_flat_violin(alpha = 1, scale = \"count\", trim = FALSE) +\n  geom_boxplot(width = 0.05, fill = \"white\", alpha = 1, \n               outlier.colour = NA, position = position_nudge(0.05)) +\n  stat_summary(fun = mean, geom = \"point\", fill = \"white\", shape = 21, size = 2,\n               position = position_nudge(0.05)) +\n  geom_dotplot(alpha = 1, binaxis = \"y\", dotsize = 0.5, stackdir = \"down\", \n               binwidth = 0.1, position = position_nudge(-0.025)) +\n  theme(legend.position = \"none\") +\n  xlab(colnames(data)[2]) +\n  ylab(colnames(data)[1]) +\n  guides(fill = F) +\n  ggtitle(\"Half Violin Plot\") +\n  scale_fill_manual(values = c(\"#e04d39\",\"#5bbad6\",\"#1e9f86\")) +\n  theme_stata() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Half Violin\n\n\n\n\n\nThe half violin plot can reflect the data distribution, which is similar to the box diagram. The black horizontal line in the box shows the median gene expression level in each tumor, and the upper and lower edges in the white box represent the upper and lower quartiles in the data set. The distribution of observable numerical points on the left half; The violin graph can also reflect the data density, and the more concentrated the data set, the fatter the graph. The gene expression distribution in the BLGG group is more concentrated, followed by BIC group and AML group.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Half Violin"
    ]
  },
  {
    "objectID": "Hiplot/102-map-europe.html",
    "href": "Hiplot/102-map-europe.html",
    "title": "Europe Map",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Europe Map plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/map-europe?lang=en",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Europe Map"
    ]
  },
  {
    "objectID": "Hiplot/102-map-europe.html#setup",
    "href": "Hiplot/102-map-europe.html#setup",
    "title": "Europe Map",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2; RColorBrewer\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(RColorBrewer)",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Europe Map"
    ]
  },
  {
    "objectID": "Hiplot/102-map-europe.html#data-preparation",
    "href": "Hiplot/102-map-europe.html#data-preparation",
    "title": "Europe Map",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/map-europe/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\ndt_map &lt;- readRDS(url(\"https://download.hiplot.cn/ui/basic/map-europe/eu.rds\"))\n\n# Convert data structure\ndt_map$Value &lt;- data$value[match(dt_map$ENG_NAME, data$region)]\n\n# View data\nhead(data)\n\n              region value\n1            Albania   758\n2            Andorra   139\n3            Austria   256\n4            Belgium   959\n5 Bosnia Herzegovina   422\n6            Croatia   791",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Europe Map"
    ]
  },
  {
    "objectID": "Hiplot/102-map-europe.html#visualization",
    "href": "Hiplot/102-map-europe.html#visualization",
    "title": "Europe Map",
    "section": "Visualization",
    "text": "Visualization\n\n# Europe Map\np &lt;- ggplot(dt_map) +\n  geom_polygon(aes(x = long, y = lat, group = group, fill = Value),\n               alpha = 0.9, size = 0.5) +\n  geom_path(aes(x = long, y = lat, group = group), color = \"black\", size = 0.2) +\n  coord_fixed() +\n  scale_fill_gradientn(\n    colours = colorRampPalette(rev(brewer.pal(11,\"RdYlBu\")))(500),\n    breaks = seq(min(data$value), max(data$value), \n                 round((max(data$value)-min(data$value))/7)),\n    name = \"Color Key\",\n    guide = guide_legend(\n      direction = \"vertical\", keyheight = unit(1, units = \"mm\"),\n      keywidth = unit(8, units = \"mm\"),\n      title.position = \"top\", title.hjust = 0.5, label.hjust = 0.5,\n      nrow = 1, byrow = T, reverse = F, label.position = \"bottom\")) +\n  theme(text = element_text(color = \"#3A3F4A\"),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank(),\n        legend.position = \"top\",\n        legend.text = element_text(size = 4 * 1.5, color = \"black\"),\n        legend.title = element_text(size = 5 * 1.5, color = \"black\"),\n        plot.title = element_text(\n          face = \"bold\", size = 5 * 1.5, hjust = 0.5, \n          margin = margin(t = 4, b = 5), color = \"black\"),\n        plot.background = element_rect(fill = \"#FFFFFF\", color = \"#FFFFFF\"),\n        panel.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        legend.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        plot.margin = unit(c(1.5, 1.5, 1.5, 1.5), \"cm\")) +\n  labs(x = NULL, y = NULL, title = \"Europe Map\")\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Europe Map",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Europe Map"
    ]
  },
  {
    "objectID": "Hiplot/145-pyramid-chart2.html",
    "href": "Hiplot/145-pyramid-chart2.html",
    "title": "Pyramid Chart 2",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Pyramid Chart 2 plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/pyramid-chart2?lang=en\nThe pyramid chart is a pyramid-like figure that distributes data on both sides of a central axis.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pyramid Chart 2"
    ]
  },
  {
    "objectID": "Hiplot/145-pyramid-chart2.html#setup",
    "href": "Hiplot/145-pyramid-chart2.html#setup",
    "title": "Pyramid Chart 2",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; apyramid; ggplot2\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"apyramid\", quietly = TRUE)) {\n  install.packages(\"apyramid\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(apyramid)\nlibrary(ggplot2)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pyramid Chart 2"
    ]
  },
  {
    "objectID": "Hiplot/145-pyramid-chart2.html#data-preparation",
    "href": "Hiplot/145-pyramid-chart2.html#data-preparation",
    "title": "Pyramid Chart 2",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data are age, gender, and the number of people after the combination of the first two variables .\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/pyramid-chart2/data.json\")$exampleData[[1]]$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\nx &lt;- as.integer(data[,\"age\"])\ndata$age_group &lt;- cut(x, breaks = pretty(x), right = TRUE, include.lowest = TRUE)\n\n# View data\nhead(data[,1:5])\n\n  case_id date_of_onset date_of_hospitalisation date_of_outcome outcome\n1       1     2013/2/19                    &lt;NA&gt;        2013/3/4   Death\n2       2     2013/2/27                2013/3/3       2013/3/10   Death\n3       3      2013/3/9               2013/3/19        2013/4/9   Death\n4       4     2013/3/19               2013/3/27            &lt;NA&gt;    &lt;NA&gt;\n5       5     2013/3/19               2013/3/30       2013/5/15 Recover\n6       6     2013/3/21               2013/3/28       2013/4/26   Death",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pyramid Chart 2"
    ]
  },
  {
    "objectID": "Hiplot/145-pyramid-chart2.html#visualization",
    "href": "Hiplot/145-pyramid-chart2.html#visualization",
    "title": "Pyramid Chart 2",
    "section": "Visualization",
    "text": "Visualization\n\n# Pyramid Chart 2\np &lt;- age_pyramid(data, \"age_group\", split_by = \"Gender\") + \n  scale_fill_manual(values = c(\"#BC3C29FF\",\"#0072B5FF\")) +\n  xlab(\"Age group\") + \n  ylab(\"Gender\") +\n  theme_classic() +\n  theme(text = element_text(family = \"Arial\"),\n      plot.title = element_text(size = 12,hjust = 0.5),\n      axis.title = element_text(size = 12),\n      axis.text = element_text(size = 10),\n      axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n      legend.position = \"right\",\n      legend.direction = \"vertical\",\n      legend.title = element_text(size = 10),\n      legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Pyramid Chart 2\n\n\n\n\n\nThe graph shows the age groups from bottom to top in order on the central axis, the left side represents the number of men, the right side represents the number of women, and the X-axis represents the number of people. The graph clearly shows the proportion of men and women in different age groups and the proportion of different age groups in the same gender.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pyramid Chart 2"
    ]
  },
  {
    "objectID": "Hiplot/088-histogram.html",
    "href": "Hiplot/088-histogram.html",
    "title": "Histogram",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Histogram plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/histogram?lang=en\nHistogram refers to the distribution of continuous variable data by a series of vertical stripes or line segments with different heights.",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Histogram"
    ]
  },
  {
    "objectID": "Hiplot/088-histogram.html#setup",
    "href": "Hiplot/088-histogram.html#setup",
    "title": "Histogram",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2; ggthemes\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"ggthemes\", quietly = TRUE)) {\n  install.packages(\"ggthemes\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(ggthemes)",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Histogram"
    ]
  },
  {
    "objectID": "Hiplot/088-histogram.html#data-preparation",
    "href": "Hiplot/088-histogram.html#data-preparation",
    "title": "Histogram",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data is the data set (data on treatment outcomes of different treatment regimens).\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/histogram/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\ndata[, 2] &lt;- factor(data[, 2], levels = unique(data[, 2]))\n\n# View data\nhead(data)\n\n  Value Group2\n1   4.2 treat1\n2  11.5 treat1\n3   7.3 treat1\n4   5.8 treat1\n5   6.4 treat1\n6  10.0 treat1",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Histogram"
    ]
  },
  {
    "objectID": "Hiplot/088-histogram.html#visualization",
    "href": "Hiplot/088-histogram.html#visualization",
    "title": "Histogram",
    "section": "Visualization",
    "text": "Visualization\n\n# Histogram\np &lt;- ggplot(data, aes(x=Value, fill=Group2)) +\n  geom_histogram(alpha = 1, bins = 12, col = \"white\") +\n  ggtitle(\"Histogram Plot\") +\n  scale_fill_manual(values = c(\"#e04d39\",\"#5bbad6\",\"#1e9f86\")) +\n  theme_stata() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Histogram\n\n\n\n\n\nThe width of the rectangle in the figure is proportional to and different from the spacing, and the vertical axis represents the frequency.",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Histogram"
    ]
  },
  {
    "objectID": "Hiplot/137-perspective.html",
    "href": "Hiplot/137-perspective.html",
    "title": "Perspective",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Perspective plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/perspective?lang=en\nThe three-dimensional perspective is a three-dimensional figure that can connect the higher values contained in a matrix with surfaces.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Perspective"
    ]
  },
  {
    "objectID": "Hiplot/137-perspective.html#setup",
    "href": "Hiplot/137-perspective.html#setup",
    "title": "Perspective",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; shape; ggplotify\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"shape\", quietly = TRUE)) {\n  install.packages(\"shape\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(shape)\nlibrary(ggplotify)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Perspective"
    ]
  },
  {
    "objectID": "Hiplot/137-perspective.html#data-preparation",
    "href": "Hiplot/137-perspective.html#data-preparation",
    "title": "Perspective",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data is a matrix.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/perspective/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\ndata &lt;- as.matrix(data)\ncol &lt;- drapecol(data)\n\n# View data\nhead(data[,1:5])\n\n      V1  V2  V3  V4  V5\n[1,] 100 101 102 103 104\n[2,] 100 101 102 103 104\n[3,] 101 102 103 104 105\n[4,] 101 102 103 104 105\n[5,] 101 102 103 104 105\n[6,] 101 102 103 104 105",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Perspective"
    ]
  },
  {
    "objectID": "Hiplot/137-perspective.html#visualization",
    "href": "Hiplot/137-perspective.html#visualization",
    "title": "Perspective",
    "section": "Visualization",
    "text": "Visualization\n\n# Perspective\np &lt;- as.ggplot(function() {\n  persp(as.matrix(data),\n    theta = 45, phi = 20,\n    expand = 0.5,\n    r = 180, col = col,\n    ltheta = 120,\n    shade = 0.5,\n    ticktype = \"detailed\",\n    xlab = \"X\", ylab = \"Y\", zlab = \"Z\",\n    border = \"black\" # could be NA\n  )\n  title(\"Perspective Plot\", line = 0)\n})\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Perspective\n\n\n\n\n\nA clear view of a mountain peak.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Perspective"
    ]
  },
  {
    "objectID": "Hiplot/079-gocircle.html",
    "href": "Hiplot/079-gocircle.html",
    "title": "GOCircle Plot",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot GOCircle Plot plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/gocircle?lang=en\nThe gocircle plot is used to display the circular plot combines gene expression and gene- annotation enrichment data. A subset of terms is displayed like the GOBar plot in combination with a scatter plot of the gene expression data. The whole plot is drawn on a specific coordinate system to achieve the circular layout. The segments are labeled with the term ID.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "GOCircle Plot"
    ]
  },
  {
    "objectID": "Hiplot/079-gocircle.html#setup",
    "href": "Hiplot/079-gocircle.html#setup",
    "title": "GOCircle Plot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; GOplot; ggplotify\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"GOplot\", quietly = TRUE)) {\n  install.packages(\"GOplot\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(GOplot)\nlibrary(ggplotify)",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "GOCircle Plot"
    ]
  },
  {
    "objectID": "Hiplot/079-gocircle.html#data-preparation",
    "href": "Hiplot/079-gocircle.html#data-preparation",
    "title": "GOCircle Plot",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data are the results of GO enrichment with seven columns: category, GO id, GO term, gene count, gene name, logFC, adjust pvalue and zscore.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/gocircle/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\ncolnames(data) &lt;- c(\"category\",\"ID\",\"term\",\"count\",\"genes\",\"logFC\",\"adj_pval\",\"zscore\")\ndata &lt;- data[!is.na(data$adj_pval),]\ndata$adj_pval &lt;- as.numeric(data$adj_pval)\ndata$zscore &lt;- as.numeric(data$zscore)\ndata$count &lt;- as.numeric(data$count)\n\n# View data\nhead(data)\n\n  category         ID              term count  genes      logFC adj_pval\n1       BP GO:0007507 heart development    54   DLC1 -0.9707875 2.17e-06\n2       BP GO:0007507 heart development    54   NRP2 -1.5153173 2.17e-06\n3       BP GO:0007507 heart development    54   NRP1 -1.1412315 2.17e-06\n4       BP GO:0007507 heart development    54   EDN1  1.3813006 2.17e-06\n5       BP GO:0007507 heart development    54 PDLIM3 -0.8876939 2.17e-06\n6       BP GO:0007507 heart development    54   GJA1 -0.8179480 2.17e-06\n      zscore\n1 -0.8164966\n2 -0.8164966\n3 -0.8164966\n4 -0.8164966\n5 -0.8164966\n6 -0.8164966",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "GOCircle Plot"
    ]
  },
  {
    "objectID": "Hiplot/079-gocircle.html#visualization",
    "href": "Hiplot/079-gocircle.html#visualization",
    "title": "GOCircle Plot",
    "section": "Visualization",
    "text": "Visualization\n\n# GOCircle Plot\np &lt;- function () {\n  GOCircle(data, title = \"GO Enrichment Circleplot\",\n           nsub = 10, rad1 = 2, rad2 = 3, table.legend = T, label.size = 5,\n           zsc.col = c(\"#FC8D59\",\"#FFFFBF\",\"#99D594\")) + \n    theme(plot.title = element_text(hjust = 0.5))\n}\np &lt;- as.ggplot(p)\n\np\n\n\n\n\n\n\n\nFigureÂ 1: GOCircle Plot\n\n\n\nAs shown in the example figure, the outer circle shows a scatter plot for each term of the logFC of the assigned genes. Red circles display up-regulation and blue ones down-regulation by default.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "GOCircle Plot"
    ]
  },
  {
    "objectID": "Hiplot/068-ggpie.html",
    "href": "Hiplot/068-ggpie.html",
    "title": "GGPIE",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot GGPIE plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/ggpie?lang=en\nThe pie chart is a statistical chart that shows the proportion of each part by dividing a circle into sections.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "GGPIE"
    ]
  },
  {
    "objectID": "Hiplot/068-ggpie.html#setup",
    "href": "Hiplot/068-ggpie.html#setup",
    "title": "GGPIE",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggpie; dplyr; ggplot2; cowplot\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggpie\", quietly = TRUE)) {\n  install.packages(\"ggpie\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"cowplot\", quietly = TRUE)) {\n  install.packages(\"cowplot\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggpie)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(cowplot)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "GGPIE"
    ]
  },
  {
    "objectID": "Hiplot/068-ggpie.html#data-preparation",
    "href": "Hiplot/068-ggpie.html#data-preparation",
    "title": "GGPIE",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data are different groups and their data.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/ggpie/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\naxis &lt;- c(\"am\", \"cyl\")\ndata[, axis[1]] &lt;- factor(data[, axis[1]], levels = unique(data[, axis[1]]))\ndata[, axis[2]] &lt;- factor(data[, axis[2]], levels = unique(data[, axis[2]]))\n\n# View data\nhead(data)\n\n   mpg cyl disp  hp drat    wt  qsec vs am gear carb\n1 21.0   6  160 110 3.90 2.620 16.46  0  1    4    4\n2 21.0   6  160 110 3.90 2.875 17.02  0  1    4    4\n3 22.8   4  108  93 3.85 2.320 18.61  1  1    4    1\n4 21.4   6  258 110 3.08 3.215 19.44  1  0    3    1\n5 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2\n6 18.1   6  225 105 2.76 3.460 20.22  1  0    3    1",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "GGPIE"
    ]
  },
  {
    "objectID": "Hiplot/068-ggpie.html#visualization",
    "href": "Hiplot/068-ggpie.html#visualization",
    "title": "GGPIE",
    "section": "Visualization",
    "text": "Visualization\n\n# GGPIE\nplist &lt;- list()\nfor (j in unique(data[, axis[2]])) {\n  plist[[j]] &lt;- ggpie(\n    data = data[data[, axis[2]] == j,],\n    group_key = axis[1], count_type = \"full\",\n    label_type = \"horizon\", label_size = 8,\n    label_info = \"all\", label_pos = \"out\") + \n    scale_fill_manual(values = c(\"#00468BFF\",\"#ED0000FF\")) +\n    ggtitle(j)\n  }\n\nplot_grid(plotlist = plist, ncol = 3)\n\n\n\n\n\n\n\nGGPIE\n\nIn a circle graph, the arc length of each slice (the arc length of its center Angle and the region corresponding to its center Angle) is proportional to the number represented. The pie chart shows the number of samples for the 1 to 4 components and the corresponding proportions. The number of samples in one group is 13, accounting for 11.71%; the number of samples in two groups is 34, accounting for 30.63%; the number of samples in three groups is 21, accounting for 18.92%; and the number of samples in four groups is 43, accounting for 38.74%.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "GGPIE"
    ]
  },
  {
    "objectID": "Hiplot/027-contour-matrix.html",
    "href": "Hiplot/027-contour-matrix.html",
    "title": "Contour (Matrix)",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Contour (Matrix) plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/contour-matrix?lang=en\nThe contour map (matrix) is a graph that displays three-dimensional data in a two-dimensional form",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Contour (Matrix)"
    ]
  },
  {
    "objectID": "Hiplot/027-contour-matrix.html#setup",
    "href": "Hiplot/027-contour-matrix.html#setup",
    "title": "Contour (Matrix)",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2; reshape2; ggisoband; cowplot\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"reshape2\", quietly = TRUE)) {\n  install.packages(\"reshape2\")\n}\nif (!requireNamespace(\"ggisoband\", quietly = TRUE)) {\n  remotes::install_github(\"clauswilke/ggisoband\")\n}\nif (!requireNamespace(\"cowplot\", quietly = TRUE)) {\n  install.packages(\"cowplot\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(reshape2)\nlibrary(ggisoband)\nlibrary(cowplot)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Contour (Matrix)"
    ]
  },
  {
    "objectID": "Hiplot/027-contour-matrix.html#data-preparation",
    "href": "Hiplot/027-contour-matrix.html#data-preparation",
    "title": "Contour (Matrix)",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data is a matrix.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/contour-matrix/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# convert data structure\ndata &lt;- as.matrix(data)\ncolnames(data) &lt;- NULL\ndata3d &lt;- reshape2::melt(data)\nnames(data3d) &lt;- c(\"x\", \"y\", \"z\")\n\n# View data\nhead(data3d)\n\n  x y   z\n1 1 1 100\n2 2 1 101\n3 3 1 102\n4 4 1 103\n5 5 1 104\n6 6 1 105",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Contour (Matrix)"
    ]
  },
  {
    "objectID": "Hiplot/027-contour-matrix.html#visualization",
    "href": "Hiplot/027-contour-matrix.html#visualization",
    "title": "Contour (Matrix)",
    "section": "Visualization",
    "text": "Visualization\n\n# Contour (Matrix)\ncomplex_general_theme &lt;- \n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np1 &lt;- ggplot(data3d, aes(x, y, z = z)) +\n  geom_isobands(\n    alpha = 1,\n    aes(color = stat(zmin)), fill = NA\n  ) +\n  scale_color_viridis_c() +\n  coord_cartesian(expand = FALSE) +\n  theme_bw() +\n  complex_general_theme\n\np2 &lt;- ggplot(data3d, aes(x, y, z = z)) +\n  geom_isobands(\n    alpha = 1,\n    aes(fill = stat(zmin)), color = NA\n  ) +\n  scale_fill_viridis_c(guide = \"legend\") +\n  coord_cartesian(expand = FALSE) +\n  theme_bw() +\n  complex_general_theme\n\nplot_grid(p1, p2, labels = c(\"A\", \"B\"), label_size = 12)\n\n\n\n\n\n\n\nFigureÂ 1: Contour (Matrix)\n\n\n\n\n\nYellow represents the highest, dark purple represents the lowest, the height scale range is 90-190.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Contour (Matrix)"
    ]
  },
  {
    "objectID": "Hiplot/018-calibration-curve.html",
    "href": "Hiplot/018-calibration-curve.html",
    "title": "Calibration Curve",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Calibration Curve plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/calibration-curve?lang=en\nThe calibration curve is used to evaluate the consistency / calibration, i.e.Â the difference between the predicted value and the real value.",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Calibration Curve"
    ]
  },
  {
    "objectID": "Hiplot/018-calibration-curve.html#setup",
    "href": "Hiplot/018-calibration-curve.html#setup",
    "title": "Calibration Curve",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; survival; rms; ggplotify\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"survival\", quietly = TRUE)) {\n  install.packages(\"survival\")\n}\nif (!requireNamespace(\"rms\", quietly = TRUE)) {\n  install.packages(\"rms\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(survival)\nlibrary(rms)\nlibrary(ggplotify)",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Calibration Curve"
    ]
  },
  {
    "objectID": "Hiplot/018-calibration-curve.html#data-preparation",
    "href": "Hiplot/018-calibration-curve.html#data-preparation",
    "title": "Calibration Curve",
    "section": "Data Preparation",
    "text": "Data Preparation\nData frame of multi columns data (Numeric allow NA). i.e the survival data (status with 0 and 1).\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/calibration-curve/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# convert data structure\nres.lrm &lt;- lrm(as.formula(paste(\n  \"status ~ \", \n  paste(colnames(data)[3:length(colnames(data))], collapse = \"+\"))),\n  data = data, x = TRUE, y = TRUE)\n\nlrm.cal &lt;- calibrate(res.lrm, method = \"boot\", B = length(rownames(data)))\n\n# View data\nhead(data)\n\n  time status age sex ph.ecog ph.karno pat.karno meal.cal wt.loss\n1  306      2  74   1       1       90       100     1175      NA\n2  455      2  68   1       0       90        90     1225      15\n3 1010      1  56   1       0       90        90       NA      15\n4  210      2  57   1       1       90        60     1150      11\n5  883      2  60   1       0      100        90       NA       0\n6 1022      1  74   1       1       50        80      513       0",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Calibration Curve"
    ]
  },
  {
    "objectID": "Hiplot/018-calibration-curve.html#visualization",
    "href": "Hiplot/018-calibration-curve.html#visualization",
    "title": "Calibration Curve",
    "section": "Visualization",
    "text": "Visualization\n\n# Calibration Curve\np &lt;- as.ggplot(function() {\n  plot(lrm.cal,\n       xlab = \"Nomogram Predicted Survival\",\n       ylab = \"Actual Survival\",\n       main = \"Calibration Curve\"\n       )\n})\n\n\nn=168   Mean absolute error=0.065   Mean squared error=0.00507\n0.9 Quantile of absolute error=0.099\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Calibration Curve",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Calibration Curve"
    ]
  },
  {
    "objectID": "Hiplot/071-ggpiestats.html",
    "href": "Hiplot/071-ggpiestats.html",
    "title": "Piestats",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Piestats plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/ggpiestats?lang=en",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Piestats"
    ]
  },
  {
    "objectID": "Hiplot/071-ggpiestats.html#setup",
    "href": "Hiplot/071-ggpiestats.html#setup",
    "title": "Piestats",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggstatsplot; ggplot2\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggstatsplot\", quietly = TRUE)) {\n  install.packages(\"ggstatsplot\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggstatsplot)\nlibrary(ggplot2)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Piestats"
    ]
  },
  {
    "objectID": "Hiplot/071-ggpiestats.html#data-preparation",
    "href": "Hiplot/071-ggpiestats.html#data-preparation",
    "title": "Piestats",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/ggpiestats/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\naxis &lt;- c(\"am\", \"cyl\")\ndata[, axis[1]] &lt;- factor(data[, axis[1]], levels = unique(data[, axis[1]]))\ndata[, axis[2]] &lt;- factor(data[, axis[2]], levels = unique(data[, axis[2]]))\n\n# View data\nhead(data)\n\n   mpg cyl disp  hp drat    wt  qsec vs am gear carb\n1 21.0   6  160 110 3.90 2.620 16.46  0  1    4    4\n2 21.0   6  160 110 3.90 2.875 17.02  0  1    4    4\n3 22.8   4  108  93 3.85 2.320 18.61  1  1    4    1\n4 21.4   6  258 110 3.08 3.215 19.44  1  0    3    1\n5 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2\n6 18.1   6  225 105 2.76 3.460 20.22  1  0    3    1",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Piestats"
    ]
  },
  {
    "objectID": "Hiplot/071-ggpiestats.html#visualization",
    "href": "Hiplot/071-ggpiestats.html#visualization",
    "title": "Piestats",
    "section": "Visualization",
    "text": "Visualization\n\n# Piestats\np &lt;- ggpiestats(data = data, x = am, y = cyl,\n                paired = F) +\n  scale_fill_manual(values = c(\"#3B4992FF\",\"#EE0000FF\"))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Piestats",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Piestats"
    ]
  },
  {
    "objectID": "Hiplot/003-barplot-3d.html",
    "href": "Hiplot/003-barplot-3d.html",
    "title": "3D Barplot",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot 3D Barplot plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/barplot-3d?lang=en\n3D bar charts are used to provide a 3D look and feel for the data. The third dimension is often used for aesthetic reasons, but it does not improve data reading. Still intended to show comparisons between discrete categories.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "3D Barplot"
    ]
  },
  {
    "objectID": "Hiplot/003-barplot-3d.html#setup",
    "href": "Hiplot/003-barplot-3d.html#setup",
    "title": "3D Barplot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; plot3D; ggplotify\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"plot3D\", quietly = TRUE)) {\n  install.packages(\"plot3D\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(plot3D)\nlibrary(ggplotify)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "3D Barplot"
    ]
  },
  {
    "objectID": "Hiplot/003-barplot-3d.html#data-preparation",
    "href": "Hiplot/003-barplot-3d.html#data-preparation",
    "title": "3D Barplot",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data are efficacy data of different doses of drugs in different treatment regimens.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/barplot-3d/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# convert data vector to a matrix\nmat &lt;- matrix(rep(1, nrow(data)), nrow = length(unique(data[, 2])))\nrownames(mat) &lt;- unique(data[, 2])\ncolnames(mat) &lt;- unique(data[, 3])\nfor (i in 1:nrow(mat)) {\n  for (j in seq_len(ncol(mat))) {\n    mat[i, j] &lt;- data[, 1][data[, 2] == rownames(mat)[i] &\n      data[, 3] == colnames(mat)[j]]\n  }\n}\n\n# View data\nmat\n\n       high mid low\nGroup1   13  25   5\nGroup2   34   8  25\nGroup3   21  17  12\nGroup4   43  10  19",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "3D Barplot"
    ]
  },
  {
    "objectID": "Hiplot/003-barplot-3d.html#visualization",
    "href": "Hiplot/003-barplot-3d.html#visualization",
    "title": "3D Barplot",
    "section": "Visualization",
    "text": "Visualization\n\n# 3D Barplot\np &lt;- as.ggplot(function() {\n  hist3D(\n    x = 1:nrow(mat), y = seq_len(ncol(mat)), z = mat,\n    bty = \"g\", phi = 20,\n    theta = -55,\n    xlab = colnames(data)[2],\n    ylab = colnames(data)[3], zlab = colnames(data)[1],\n    main = \"3D Bar Plot\", colkey = F,\n    border = \"black\", shade = 0.8, axes = T,\n    ticktype = \"detailed\", space = 0.3, d = 2, cex.axis = 0.3,\n    colvar = as.numeric(as.factor(data[, 2])), alpha = 1,\n    col = c(\"#E64B35FF\",\"#4DBBD5FF\",\"#00A087FF\",\"#3C5488FF\")\n  )\n\n  # Use text3D to label x axis\n  text3D(\n    x = 1:nrow(mat), y = rep(0.5, nrow(mat)), z = rep(3, nrow(mat)),\n    labels = rownames(mat),\n    add = TRUE, adj = 0, cex = 0.8\n  )\n  # Use text3D to label y axis\n  text3D(\n    x = rep(1, ncol(mat)), y = seq_len(ncol(mat)), z = rep(0, ncol(mat)),\n    labels = colnames(mat), bty = \"g\",\n    add = TRUE, adj = 1, cex = 0.8\n  )\n})\n\np\n\n\n\n\n\n\n\nFigureÂ 1: 3D Barplot\n\n\n\n\n\nThe 3D histogram shows the different therapeutic effects of different treatment groups (groups 1 to 4) with low, medium and high doses. Group 1 had the best effect with medium dose treatment, group 2 had the best effect with high dose treatment, group 3 had no significant difference with dose treatment, and group 4 had the best effect with high dose treatment.\n\n\n\n\n\n\nTip\n\n\n\nSpecial Parameters: \n\nPhi: The larger the positive value is, the more it tends to observe from the top down. The greater the negative value, the more likely it is to be observed from the bottom of the three-dimensional figure upwards.\nTheta: The Angle at which a three-dimensional figure rotates horizontally.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "3D Barplot"
    ]
  },
  {
    "objectID": "Hiplot/157-rose-chart.html",
    "href": "Hiplot/157-rose-chart.html",
    "title": "Rose Chart",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Rose Chart plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/rose-chart?lang=en\nThe rose chart is a column chart drawn in polar coordinates. The radius of the arc is used to indicate the size of the data.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Rose Chart"
    ]
  },
  {
    "objectID": "Hiplot/157-rose-chart.html#setup",
    "href": "Hiplot/157-rose-chart.html#setup",
    "title": "Rose Chart",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Rose Chart"
    ]
  },
  {
    "objectID": "Hiplot/157-rose-chart.html#data-preparation",
    "href": "Hiplot/157-rose-chart.html#data-preparation",
    "title": "Rose Chart",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data is divided into three columns, the first column is the sample name, the second column is the grouping, and the third column is the value corresponding to the sample.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/rose-chart/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\ndata[, 2] &lt;- factor(data[, 2], levels = unique(data[, 2]))\n\n# View data\nhead(data)\n\n    Sample       Group Freq\n1    Brain Upregulated  142\n2    Colon Upregulated  270\n3   Kidney Upregulated  108\n4 Pancreas Upregulated  194\n5     Skin Upregulated  189\n6   Testis Upregulated   97",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Rose Chart"
    ]
  },
  {
    "objectID": "Hiplot/157-rose-chart.html#visualization",
    "href": "Hiplot/157-rose-chart.html#visualization",
    "title": "Rose Chart",
    "section": "Visualization",
    "text": "Visualization\n\n# Rose Chart\np &lt;- ggplot(data, aes(x = Sample, y = Freq)) +\n  geom_col(aes(fill = Group), width = 0.9, size = 0, alpha = 0.8) +\n  coord_polar() +\n  ggtitle(\"Rose Chart\") +\n  scale_fill_manual(values = c(\"#E64B35FF\", \"#4DBBD5FF\")) +\n  theme_bw() +\n  theme(aspect.ratio = 1,\n        axis.text.x = element_text(colour = \"black\"),\n        axis.text.y = element_text(colour = \"black\"),\n        legend.title = element_blank(),\n        legend.position = \"bottom\",\n        plot.title = element_text(hjust = 0.5))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Rose Chart\n\n\n\n\n\nThe case data is the distribution of up- and down-regulated genes in different organs after using scRNA-Seq to sequence different human organs.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Rose Chart"
    ]
  },
  {
    "objectID": "Hiplot/077-gobar.html",
    "href": "Hiplot/077-gobar.html",
    "title": "GOBar Plot",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot GOBar Plot plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/gobar?lang=en\nThe gobar plot is used to display Z-score coloured barplot of terms ordered alternatively by z-score or the negative logarithm of the adjusted p-value.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "GOBar Plot"
    ]
  },
  {
    "objectID": "Hiplot/077-gobar.html#setup",
    "href": "Hiplot/077-gobar.html#setup",
    "title": "GOBar Plot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; GOplot\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"GOplot\", quietly = TRUE)) {\n  install.packages(\"GOplot\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(GOplot)",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "GOBar Plot"
    ]
  },
  {
    "objectID": "Hiplot/077-gobar.html#data-preparation",
    "href": "Hiplot/077-gobar.html#data-preparation",
    "title": "GOBar Plot",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data are the results of GO enrichment with seven columns: category, GO id, GO term, gene count, gene name, logFC, adjust pvalue and zscore.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/gobar/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\ncolnames(data) &lt;- c(\"category\",\"ID\",\"term\",\"count\",\"genes\",\"logFC\",\"adj_pval\",\"zscore\")\ndata &lt;- data[data$category %in% c(\"BP\",\"CC\",\"MF\"),]\ndata &lt;- data[!is.na(data$adj_pval),]\ndata$adj_pval &lt;- as.numeric(data$adj_pval)\ndata$zscore &lt;- as.numeric(data$zscore)\n\n# View data\nhead(data)\n\n  category         ID              term count  genes      logFC adj_pval\n1       BP GO:0007507 heart development    54   DLC1 -0.9707875 2.17e-06\n2       BP GO:0007507 heart development    54   NRP2 -1.5153173 2.17e-06\n3       BP GO:0007507 heart development    54   NRP1 -1.1412315 2.17e-06\n4       BP GO:0007507 heart development    54   EDN1  1.3813006 2.17e-06\n5       BP GO:0007507 heart development    54 PDLIM3 -0.8876939 2.17e-06\n6       BP GO:0007507 heart development    54   GJA1 -0.8179480 2.17e-06\n      zscore\n1 -0.8164966\n2 -0.8164966\n3 -0.8164966\n4 -0.8164966\n5 -0.8164966\n6 -0.8164966",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "GOBar Plot"
    ]
  },
  {
    "objectID": "Hiplot/077-gobar.html#visualization",
    "href": "Hiplot/077-gobar.html#visualization",
    "title": "GOBar Plot",
    "section": "Visualization",
    "text": "Visualization\n\n# GOBar Plot\np &lt;- GOBar(data, display = \"multiple\", order.by.zscore = T,\n           title = \"GO Enrichment Barplot \", \n           zsc.col = c(\"#EF8A62\",\"#F7F7F7\",\"#67A9CF\")) + \n    theme(plot.title = element_text(hjust = 0.5),\n          axis.text.x = element_text(size = 8))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: GOBar Plot\n\n\n\n\n\nAs shown in the example figure, the x-axis represent each GO term, the y-axis represent the -log(adj_pvalue), each bar is colored by the z-score. If display is used to facet the plot the width of the panels will be proportional to the length of the x scale.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "GOBar Plot"
    ]
  },
  {
    "objectID": "Hiplot/090-interval-bar-chart.html",
    "href": "Hiplot/090-interval-bar-chart.html",
    "title": "Interval Bar Chart",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Interval Bar Chart plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/interval-bar-chart?lang=en",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Interval Bar Chart"
    ]
  },
  {
    "objectID": "Hiplot/090-interval-bar-chart.html#setup",
    "href": "Hiplot/090-interval-bar-chart.html#setup",
    "title": "Interval Bar Chart",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Interval Bar Chart"
    ]
  },
  {
    "objectID": "Hiplot/090-interval-bar-chart.html#data-preparation",
    "href": "Hiplot/090-interval-bar-chart.html#data-preparation",
    "title": "Interval Bar Chart",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe case data consists of the highest and lowest temperatures for each of the twelve months in a year, along with the corresponding abbreviated month names. Based on the case data, temperature intervals and average temperature lines have been plotted for each month.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/interval-bar-chart/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\ndata$name_num &lt;- match(data[[\"month\"]], unique(data[[\"month\"]]))\n\n# View data\nhead(data)\n\n  month min_temperature max_temperature mean name_num\n1   Jan              15              20   16        1\n2   Feb              17              25   20        2\n3   Mar              20              26   23        3\n4   Apr              25              30   27        4\n5   May              30              35   32        5\n6   Jun              32              35   34        6",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Interval Bar Chart"
    ]
  },
  {
    "objectID": "Hiplot/090-interval-bar-chart.html#visualization",
    "href": "Hiplot/090-interval-bar-chart.html#visualization",
    "title": "Interval Bar Chart",
    "section": "Visualization",
    "text": "Visualization\n\n# Interval Bar Chart\np &lt;- ggplot(data, aes(x = month, y = max_temperature)) +\n  geom_rect(aes(xmin = name_num - 0.4, xmax = name_num + 0.4,\n                ymin = min_temperature, ymax = max_temperature), \n            fill = \"#282726\", alpha = 0.7) +\n  geom_line(aes(x = name_num, y = mean), color = \"#006064\", size = 0.8) +\n  labs(x = \"Month\", y = \"Temperature\") +\n  scale_x_discrete() +\n  theme_bw()\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Interval Bar Chart",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Interval Bar Chart"
    ]
  },
  {
    "objectID": "Hiplot/167-stacked-percentage-bar-chart.html",
    "href": "Hiplot/167-stacked-percentage-bar-chart.html",
    "title": "Percentsge Stacked Bar Chart",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Percentsge Stacked Bar Chart plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/stacked-percentage-bar-chart?lang=en",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Percentsge Stacked Bar Chart"
    ]
  },
  {
    "objectID": "Hiplot/167-stacked-percentage-bar-chart.html#setup",
    "href": "Hiplot/167-stacked-percentage-bar-chart.html#setup",
    "title": "Percentsge Stacked Bar Chart",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2; dplyr; tidyr; scales\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"tidyr\", quietly = TRUE)) {\n  install.packages(\"tidyr\")\n}\nif (!requireNamespace(\"scales\", quietly = TRUE)) {\n  install.packages(\"scales\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(scales)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Percentsge Stacked Bar Chart"
    ]
  },
  {
    "objectID": "Hiplot/167-stacked-percentage-bar-chart.html#data-preparation",
    "href": "Hiplot/167-stacked-percentage-bar-chart.html#data-preparation",
    "title": "Percentsge Stacked Bar Chart",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe case data represents the sales percentage of three different products in a shopping mall over the course of one week.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/stacked-percentage-bar-chart/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# convert data structure\ndata$total &lt;- rowSums(data[, -1])\ndata_long &lt;- gather(data, kinds, value, -days, -total)\ndata_long &lt;- data_long %&gt;%\n  group_by(days) %&gt;%\n  mutate(percent = value / total * 100)\ndata_long[[\"days\"]] &lt;- factor(data_long[[\"days\"]], levels = data[[\"days\"]])\n\n# View data\nhead(data)\n\n       days goods1 goods2 goods3 total\n1    Monday    150    300      0   450\n2   Tuesday    200    250      0   450\n3 Wednesday    300    100      0   400\n4  Thursday    200    300      0   500\n5    Friday    100    300      0   400\n6  Saturday     50     50    400   500",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Percentsge Stacked Bar Chart"
    ]
  },
  {
    "objectID": "Hiplot/167-stacked-percentage-bar-chart.html#visualization",
    "href": "Hiplot/167-stacked-percentage-bar-chart.html#visualization",
    "title": "Percentsge Stacked Bar Chart",
    "section": "Visualization",
    "text": "Visualization\n\n# Percentsge Stacked Bar Chart\np &lt;- ggplot(data_long, aes(x = percent, y = days, fill = kinds)) +\n  geom_bar(stat = \"identity\", position = \"stack\") +\n  geom_text(aes(label = ifelse(percent != 0, paste0(round(percent), \"%\"), \"\")),\n            position = position_stack(vjust = 0.5)) +\n  labs(title = \"Percentage Stacked Bar Chart\", x = \"Percentage\", y = \"Days\") +\n  scale_x_continuous(labels = percent_format(scale = 1)) +\n  theme_bw() +\n  theme(plot.title = element_text(hjust = 0.5)) +\n  scale_fill_manual(values = c(\"#E64B35FF\",\"#4DBBD5FF\",\"#00A087FF\"))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Percentsge Stacked Bar Chart",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Percentsge Stacked Bar Chart"
    ]
  },
  {
    "objectID": "Hiplot/087-hic-heatmap.html",
    "href": "Hiplot/087-hic-heatmap.html",
    "title": "Hi-C Heatmap",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Hi-C Heatmap plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/hic-heatmap?lang=en\nThe HiC heatmap is used to display the genome-wide chromatin interaction with heatmap on different chromosomes.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Hi-C Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/087-hic-heatmap.html#setup",
    "href": "Hiplot/087-hic-heatmap.html#setup",
    "title": "Hi-C Heatmap",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2; RColorBrewer\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(RColorBrewer)",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Hi-C Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/087-hic-heatmap.html#data-preparation",
    "href": "Hiplot/087-hic-heatmap.html#data-preparation",
    "title": "Hi-C Heatmap",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data have three columns, with the first for one locus bin index, the second for another locus bin index, and the third for the interaction frequency between this two locus.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/hic-heatmap/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# View data\nhead(data)\n\n  index_bin1 index_bin2 freq\n1        135        428   13\n2        365        479   38\n3        209        340    8\n4        216        166   34\n5        288        484    5\n6        162        479   14",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Hi-C Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/087-hic-heatmap.html#visualization",
    "href": "Hiplot/087-hic-heatmap.html#visualization",
    "title": "Hi-C Heatmap",
    "section": "Visualization",
    "text": "Visualization\n\n# Hi-C Heatmap\n## Calculate the number of bins\nbins_num &lt;- max(data$index_bin1) + 1\n## Set the resolution of HiC data\nresolution &lt;- 500\nres &lt;- resolution * 1000\n# Set the separation unit to 50Mb\nintervals &lt;- 50\nspacing &lt;- intervals * 1000000\n## Count the number of breaks\nbreaks_num &lt;- (res * bins_num) / spacing\n## Set breaks\nbreaks &lt;- c()\nfor (i in 0:breaks_num) {\n  breaks &lt;- c(breaks, i * intervals)\n}\n\np &lt;- ggplot(data = data, aes(x = index_bin1 * res, y = index_bin2 * res)) +\n  geom_tile(aes(fill = freq)) +\n  scale_fill_gradientn(\n    colours = colorRampPalette(rev(brewer.pal(11,\"RdYlBu\")))(500),\n    limits = c(0, max(data$freq) * 1.2)\n  ) +\n  scale_y_reverse() +\n  scale_x_continuous(breaks = breaks * 1000000, labels = paste0(breaks, \"Mb\")) +\n  scale_y_continuous(breaks = breaks * 1000000, labels = paste0(breaks, \"Mb\")) +\n  theme(panel.grid = element_blank(), axis.title = element_blank()) +\n  labs(title = paste0(\"(resolution: \", res / 1000, \"Kb)\"), x=\"\", y=\"\") +\n  theme_bw() +\n  theme(plot.title = element_text(hjust = 0.5),\n        legend.position = \"right\", legend.key.size = unit(0.8, \"cm\"),\n        panel.grid = element_blank())\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Hi-C Heatmap\n\n\n\n\n\nAs shown in the example figure, a heat map represent the interaction frequency between any two locus. The color displays their intensity of interaction.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Hi-C Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/129-neural-network.html",
    "href": "Hiplot/129-neural-network.html",
    "title": "Neural Network",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Neural Network plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/neural-network?lang=en",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Neural Network"
    ]
  },
  {
    "objectID": "Hiplot/129-neural-network.html#setup",
    "href": "Hiplot/129-neural-network.html#setup",
    "title": "Neural Network",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; NeuralNetTools; nnet\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"NeuralNetTools\", quietly = TRUE)) {\n  install.packages(\"NeuralNetTools\")\n}\nif (!requireNamespace(\"nnet\", quietly = TRUE)) {\n  install.packages(\"nnet\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(NeuralNetTools)\nlibrary(nnet)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Neural Network"
    ]
  },
  {
    "objectID": "Hiplot/129-neural-network.html#data-preparation",
    "href": "Hiplot/129-neural-network.html#data-preparation",
    "title": "Neural Network",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/neural-network/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# View data\nhead(data)\n\n         Y1        Y2          X1         X2         X3\n1 0.7646258 0.5494452 -0.89691455 -1.8923489  0.6408445\n2 0.2383994 0.4605024  0.18484918  1.2928042 -1.6013778\n3 0.3800247 0.2527468  1.58784533 -0.6182543 -0.7778154\n4 0.3545279 0.6319730 -1.13037567  1.0409383 -1.6473925\n5 0.3667356 0.4684437 -0.08025176  1.1758795  0.1542662\n6 0.5509560 0.4439474  0.13242028 -1.5018321 -1.1756313",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Neural Network"
    ]
  },
  {
    "objectID": "Hiplot/129-neural-network.html#visualization",
    "href": "Hiplot/129-neural-network.html#visualization",
    "title": "Neural Network",
    "section": "Visualization",
    "text": "Visualization\n\n# Neural Network\nmod &lt;- nnet(Y1 ~ X1 + X2 + X3, data = neuraldat, size = 10,\n            maxint = 100, decay = 0)\n\n# weights:  51\ninitial  value 266.331730 \niter  10 value 0.816899\niter  20 value 0.150085\niter  30 value 0.064880\niter  40 value 0.041231\niter  50 value 0.028908\niter  60 value 0.022252\niter  70 value 0.019230\niter  80 value 0.016901\niter  90 value 0.013354\niter 100 value 0.010100\nfinal  value 0.010100 \nstopped after 100 iterations\n\n# plot\npar(mar = numeric(4))\nplotnet(mod)\n\n\n\n\n\n\n\nFigureÂ 1: Neural Network",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Neural Network"
    ]
  },
  {
    "objectID": "Hiplot/177-upset-plot.html",
    "href": "Hiplot/177-upset-plot.html",
    "title": "Upset Plot",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Upset Plot plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/upset-plot?lang=en\nUpset can be used to show the interactive relationship between collections.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Upset Plot"
    ]
  },
  {
    "objectID": "Hiplot/177-upset-plot.html#setup",
    "href": "Hiplot/177-upset-plot.html#setup",
    "title": "Upset Plot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; VennDiagram; ComplexHeatmap; ggplotify; ggplot2\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"VennDiagram\", quietly = TRUE)) {\n  install.packages(\"VennDiagram\")\n}\nif (!requireNamespace(\"ComplexHeatmap\", quietly = TRUE)) {\n  BiocManager::install(\"ComplexHeatmap\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(VennDiagram)\nlibrary(ComplexHeatmap)\nlibrary(ggplotify)\nlibrary(ggplot2)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Upset Plot"
    ]
  },
  {
    "objectID": "Hiplot/177-upset-plot.html#data-preparation",
    "href": "Hiplot/177-upset-plot.html#data-preparation",
    "title": "Upset Plot",
    "section": "Data Preparation",
    "text": "Data Preparation\nThere are two types of data tables: list and binary. The list format is that each column is a set and contains all the elements corresponding to the set. In the binary format, the first column is all the elements of all sets, and the subsequent columns are a numeric matrix composed of 0 and 1. 1 indicates that the corresponding row element exists in a certain set, and 0 indicates that it does not exist.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/upset-plot/data.json\")$exampleData[[1]]$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# convert data structure\nfor (i in seq_len(ncol(data))) {\n  data[is.na(data[, i]), i] &lt;- \"\"\n}\ndata2 &lt;- as.list(data)\ndata2 &lt;- lapply(data2, function(x) {x[x != \"\"]})\ndata2 &lt;- list_to_matrix(data2)\nm = make_comb_mat(data2, mode = \"distinct\")\nss = set_size(m)\ncs = comb_size(m)\nset_order &lt;- order(ss)\ncomb_order &lt;- order(comb_degree(m), -cs)\n\n# View data\nhead(data)\n\n     Set1      Set2     Set3      Set4    Set5      Set6    Set7     Set8\n1   ISG15      HES5     DVL1   MATP6P1 FAM132A   FAM132A FAM132A  TNFRSF4\n2  TTLL10  AURKAIP1 ARHGEF16   MIR551A    AGRN   MIR551A WBP1LP6   WASH7P\n3    HES4 LINC00982   OR4F16  C1orf222 WBP1LP6   MIR200B   PANK4   TMEM52\n4  OR4G4P    FAM87B      SKI   MIR200B  KLHL17    ATAD3C  OR4G4P   MMP23B\n5 MND2P28       SKI   WASH7P LINC00115  FAM41C   ANKRD65   SSU72   CDK11B\n6  FAM87B     GABRD    MEGF6    ATAD3B   PANK4 LINC01128 MND2P28 C1orf170",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Upset Plot"
    ]
  },
  {
    "objectID": "Hiplot/177-upset-plot.html#visualization",
    "href": "Hiplot/177-upset-plot.html#visualization",
    "title": "Upset Plot",
    "section": "Visualization",
    "text": "Visualization\n\n# Upset Plot\np &lt;- as.ggplot(function(){\n  top_annotation &lt;- HeatmapAnnotation(\n    Intersections = anno_barplot(\n      cs, ylim = c(0, max(cs)*1.1), \n      border = FALSE, \n      gp = gpar(fill = \"#000000\", fontsize = 10), \n      height = unit(5, \"cm\")\n    ), \n    annotation_name_side = \"left\", \n    annotation_name_rot = 90\n  )\n  \n  left_annotation &lt;- rowAnnotation(\n    Numbers = anno_barplot(-ss, axis_param = list(\n      at = seq(-max(ss), 0, round(max(ss)/5)),\n      labels = rev(seq(0, max(ss), round(max(ss)/5))),\n      labels_rot = 0),\n      baseline = 0,\n      border = FALSE, \n      gp = gpar(fill = \"#000000\", fontsize = 10), \n      width = unit(4, \"cm\")\n    ),\n    set_name = anno_text(set_name(m), location = 0.5,  just = \"center\",\n                         width = max_text_width(set_name(m)) + unit(5, \"mm\"))\n  )\n  \n  ht = UpSet(m, comb_col = \"#000000\", bg_col = \"#F0F0F0\", bg_pt_col = \"#CCCCCC\",\n             pt_size = unit(3, \"mm\"), lwd = 2, set_order = set_order,\n             comb_order = comb_order, top_annotation = top_annotation,\n             left_annotation = left_annotation,  right_annotation = NULL,\n             show_row_names = FALSE)\n  ht = draw(ht)\n  od = column_order(ht)\n  decorate_annotation(\"Intersections\", {\n    grid.text(cs[od], x = seq_along(cs), y = unit(cs[od], \"native\") + unit(2, \"pt\"),\n              default.units = \"native\", just = c(\"left\", \"bottom\"), \n              gp = gpar(fontsize = 10, col = \"#000000\",\n              fontfamily = \"Arial\"), hjust = 0.5)\n  })\n})\np &lt;- p + ggtitle(\"Upset Plot\") + \n  theme(plot.title = element_text(hjust = 0.6))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Upset Plot",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Upset Plot"
    ]
  },
  {
    "objectID": "Hiplot/064-ggbetweenstats.html",
    "href": "Hiplot/064-ggbetweenstats.html",
    "title": "Betweenstats",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Betweenstats plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/ggbetweenstats?lang=en",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Betweenstats"
    ]
  },
  {
    "objectID": "Hiplot/064-ggbetweenstats.html#setup",
    "href": "Hiplot/064-ggbetweenstats.html#setup",
    "title": "Betweenstats",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggstatsplot; ggplot2; cowplot\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggstatsplot\", quietly = TRUE)) {\n  install.packages(\"ggstatsplot\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"cowplot\", quietly = TRUE)) {\n  install.packages(\"cowplot\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggstatsplot)\nlibrary(ggplot2)\nlibrary(cowplot)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Betweenstats"
    ]
  },
  {
    "objectID": "Hiplot/064-ggbetweenstats.html#data-preparation",
    "href": "Hiplot/064-ggbetweenstats.html#data-preparation",
    "title": "Betweenstats",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/ggbetweenstats/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\naxis &lt;- c(\"mpaa\", \"length\", \"genre\")\ndata[, axis[1]] &lt;- factor(data[, axis[1]], levels = unique(data[, axis[1]]))\ndata[, axis[3]] &lt;- factor(data[, axis[3]], levels = unique(data[, axis[3]]))\n\n# View data\nhead(data)\n\n                                                                 title year\n1                       Lord of the Rings: The Return of the King, The 2003\n2                   Lord of the Rings: The Fellowship of the Ring, The 2001\n3                               Lord of the Rings: The Two Towers, The 2002\n4                                                            Star Wars 1977\n5                       Star Wars: Episode V - The Empire Strikes Back 1980\n6 Dr. Strangelove or: How I Learned to Stop Worrying and Love the Bomb 1964\n  length budget rating  votes  mpaa  genre\n1    251   94.0    9.0 103631 PG-13 Action\n2    208   93.0    8.8 157608 PG-13 Action\n3    223   94.0    8.8 114797 PG-13 Action\n4    125   11.0    8.8 134640    PG Action\n5    129   18.0    8.8 103706    PG Action\n6     93    1.8    8.7  63471    PG Comedy",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Betweenstats"
    ]
  },
  {
    "objectID": "Hiplot/064-ggbetweenstats.html#visualization",
    "href": "Hiplot/064-ggbetweenstats.html#visualization",
    "title": "Betweenstats",
    "section": "Visualization",
    "text": "Visualization\n\n# Betweenstats\ng &lt;- unique(data[,axis[3]])\nplist &lt;- list()\nfor (i in 1:length(g)) {\n  fil &lt;- data[,axis[3]] == g[i]\n  plist[[i]] &lt;- ggbetweenstats(\n    data = data[fil,], x = mpaa, y = length,\n    title= paste('', axis[3], g[i], sep = ':'),\n    p.adjust.method = \"holm\",\n    plot.type = \"boxviolin\",\n    pairwise.comparisons = T,\n    pairwise.display = \"significant\",\n    effsize.type = \"unbiased\",\n    notch = T,\n    type = \"parametric\",\n    plotgrid.args = list(ncol = 2)) +\n    scale_color_manual(values = c(\"#00468BFF\",\"#ED0000FF\",\"#42B540FF\"))\n}\np &lt;- plot_grid(plotlist = plist, ncol = 2)\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Betweenstats",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Betweenstats"
    ]
  },
  {
    "objectID": "Hiplot/143-pseudo-enhanced-ma.html",
    "href": "Hiplot/143-pseudo-enhanced-ma.html",
    "title": "EnhancedMA",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot EnhancedMA plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/pseudo-enhanced-ma?lang=en\nVisualization of differentially expressed genes.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "EnhancedMA"
    ]
  },
  {
    "objectID": "Hiplot/143-pseudo-enhanced-ma.html#setup",
    "href": "Hiplot/143-pseudo-enhanced-ma.html#setup",
    "title": "EnhancedMA",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; EnhancedVolcano\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"EnhancedVolcano\", quietly = TRUE)) {\n  remotes::install_github('kevinblighe/EnhancedVolcano')\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(EnhancedVolcano)",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "EnhancedMA"
    ]
  },
  {
    "objectID": "Hiplot/143-pseudo-enhanced-ma.html#data-preparation",
    "href": "Hiplot/143-pseudo-enhanced-ma.html#data-preparation",
    "title": "EnhancedMA",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/pseudo-enhanced-ma/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\nrow.names(data) &lt;- data[,1]\ndata &lt;- data[,-1]\ndata$baseMeanNew &lt;- 1 / (10^log(data$baseMean + 1))\n\n# View data\nhead(data)\n\n              baseMean log2FoldChange      lfcSE       stat       pvalue\nCOL6A3    8.494143e+04    -0.34453583 0.07607842 -4.5305972 5.881720e-06\nZNF157    2.456747e+00    -0.42976616 0.33693867 -1.2957785 1.950518e-01\nRPL23P11  0.000000e+00             NA         NA         NA           NA\nSCARNA10  4.406548e-01    -0.05657159 0.15265730 -0.2329492 8.158009e-01\nRNU6-857P 0.000000e+00             NA         NA         NA           NA\nTOPORS    5.331777e+02     0.10709656 0.12572643  0.8549637 3.925712e-01\n                  padj  baseMeanNew\nCOL6A3    6.207728e-05 4.469624e-12\nZNF157              NA 5.750056e-02\nRPL23P11            NA 1.000000e+00\nSCARNA10            NA 4.314220e-01\nRNU6-857P           NA 1.000000e+00\nTOPORS    6.148749e-01 5.239278e-07",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "EnhancedMA"
    ]
  },
  {
    "objectID": "Hiplot/143-pseudo-enhanced-ma.html#visualization",
    "href": "Hiplot/143-pseudo-enhanced-ma.html#visualization",
    "title": "EnhancedMA",
    "section": "Visualization",
    "text": "Visualization\n\n# EnhancedMA\np &lt;- EnhancedVolcano(\n  data, lab = rownames(data), title = \"MA plot\", subtitle = \"EnhancedMA\",\n  x = 'log2FoldChange', y = 'baseMeanNew', xlab = bquote(~Log[2]~ 'fold change'),\n  ylab = bquote(~Log[e]~ 'base mean + 1'), ylim = c(0,12),\n  pCutoff = as.numeric(1e-05), FCcutoff = 1, pointSize = 3.5,\n  labSize = 4, boxedLabels = T, colAlpha = 1,\n  legendLabels = c('NS', expression(Log[2]~FC),\n                   'Mean expression', \n                   expression(Mean-expression~and~log[2]~FC)),\n  legendPosition = \"bottom\", legendLabSize = 16, legendIconSize = 4.0,\n  encircleCol = 'black', encircleSize = 2.5, encircleFill = 'pink',\n  encircleAlpha = 1/2) + \n  coord_flip() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: EnhancedMA",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "EnhancedMA"
    ]
  },
  {
    "objectID": "Hiplot/051-eulerr.html",
    "href": "Hiplot/051-eulerr.html",
    "title": "Eulerr Plot",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Eulerr Plot plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/eulerr?lang=en",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Eulerr Plot"
    ]
  },
  {
    "objectID": "Hiplot/051-eulerr.html#setup",
    "href": "Hiplot/051-eulerr.html#setup",
    "title": "Eulerr Plot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; eulerr; ggplotify\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"eulerr\", quietly = TRUE)) {\n  install.packages(\"eulerr\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(eulerr)\nlibrary(ggplotify)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Eulerr Plot"
    ]
  },
  {
    "objectID": "Hiplot/051-eulerr.html#data-preparation",
    "href": "Hiplot/051-eulerr.html#data-preparation",
    "title": "Eulerr Plot",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/eulerr/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# convert data structure\ngenes &lt;- as.numeric(data[, 2])\nnames(genes) &lt;- as.character(data[, 1])\neuler_set &lt;- euler(genes)\n  \n# View data\nhead(data)\n\n      Term Value\n1       SE    13\n2    Treat    28\n3 Anti-CCP   101\n4    DAS28    91\n5 SE&Treat     1\n6 SE&DAS28    14",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Eulerr Plot"
    ]
  },
  {
    "objectID": "Hiplot/051-eulerr.html#visualization",
    "href": "Hiplot/051-eulerr.html#visualization",
    "title": "Eulerr Plot",
    "section": "Visualization",
    "text": "Visualization\n\n# Eulerr Plot\nfill &lt;- c(\"#3B4992FF\",\"#EE0000FF\",\"#008B45FF\",\"#631879FF\",\"#008280FF\",\"#BB0021FF\",\n          \"#5F559BFF\",\"#A20056FF\")\np &lt;- as.ggplot(\n  plot(euler_set,\n    labels = list(col = rep(\"white\", length(genes))),\n    fills = list(fill = fill),\n    quantities = list(type = c(\"percent\", \"counts\"),\n    col = rep(\"white\", length(genes))),\n    main = \"Eulerr\")\n)\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Eulerr Plot",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Eulerr Plot"
    ]
  },
  {
    "objectID": "Hiplot/162-scatter2.html",
    "href": "Hiplot/162-scatter2.html",
    "title": "Scatter2",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Scatter2 plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/scatter2?lang=en\nTwo-dimensional spatial scatter to demonstrate multi-numerical variable relationships.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Scatter2"
    ]
  },
  {
    "objectID": "Hiplot/162-scatter2.html#setup",
    "href": "Hiplot/162-scatter2.html#setup",
    "title": "Scatter2",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; grafify; ggplot2\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"grafify\", quietly = TRUE)) {\n  install.packages(\"grafify\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(grafify)\nlibrary(ggplot2)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Scatter2"
    ]
  },
  {
    "objectID": "Hiplot/162-scatter2.html#data-preparation",
    "href": "Hiplot/162-scatter2.html#data-preparation",
    "title": "Scatter2",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/scatter2/data.json\")$exampleData[[1]]$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# View data\nhead(data[,1:5])\n\n                car  mpg cyl  disp  hp\n1    Hornet 4 Drive 21.4   6 258.0 110\n2 Hornet Sportabout 18.7   8 360.0 175\n3           Valiant 18.1   6 225.0 105\n4        Duster 360 14.3   8 360.0 245\n5        Merc 450SE 16.4   8 275.8 180\n6        Merc 450SL 17.3   8 275.8 180",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Scatter2"
    ]
  },
  {
    "objectID": "Hiplot/162-scatter2.html#visualization",
    "href": "Hiplot/162-scatter2.html#visualization",
    "title": "Scatter2",
    "section": "Visualization",
    "text": "Visualization\n\n# scatter2\nsymsize &lt;- data[,\"gear\"]\ndata[,\"gear\"] &lt;- factor(data[,\"gear\"], levels = unique(data[,\"gear\"]))\np &lt;- ggplot(data, aes(x = mpg, y = disp)) + \n  geom_point(alpha = 1, aes(size = gear, fill = gear), shape = 21, stroke = 0.5) +\n  labs(fill = \"gear\", color = \"gear\") +\n  guides(x = guide_axis(angle = 0),\n         fill = guide_legend(title = \"gear\"),\n         color = FALSE,\n         size = guide_legend(title = \"gear\")) +\n  ggtitle(\"Scatter2 Plot\") +\n  scale_fill_grafify() +\n  theme_classic(base_size = 20) +\n  theme(text = element_text(family = \"Arial\"),\n        strip.background = element_blank(),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: scatter2",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Scatter2"
    ]
  },
  {
    "objectID": "Hiplot/147-pyramid-stack2.html",
    "href": "Hiplot/147-pyramid-stack2.html",
    "title": "Pyramid Stack2",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Pyramid Stack2 plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/pyramid-stack2?lang=en\nThe pyramid stack is a pyramid-like figure that distributes data on both sides of a central axis.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pyramid Stack2"
    ]
  },
  {
    "objectID": "Hiplot/147-pyramid-stack2.html#setup",
    "href": "Hiplot/147-pyramid-stack2.html#setup",
    "title": "Pyramid Stack2",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; plotrix; ggplotify\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"plotrix\", quietly = TRUE)) {\n  install.packages(\"plotrix\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(plotrix)\nlibrary(ggplotify)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pyramid Stack2"
    ]
  },
  {
    "objectID": "Hiplot/147-pyramid-stack2.html#data-preparation",
    "href": "Hiplot/147-pyramid-stack2.html#data-preparation",
    "title": "Pyramid Stack2",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/pyramid-stack2/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\nagegrps &lt;- unique(data[,1])\nsplit_var &lt;- unique(data[,2])\ndat_left &lt;- as.matrix(data[data[,2] == split_var[1],-c(1,2)])\ndat_right &lt;- as.matrix(data[data[,2] == split_var[2],-c(1,2)])\n\n# View data\nhead(data)\n\n  Month Year Class1 Class2 Class3 Class4\n1     1 2019      8    6.0      8    6.0\n2     2 2019      4    2.0      4    2.0\n3     3 2019      4    4.5      1    4.5\n4     4 2019      6    8.0      1    9.0\n5     5 2019      8    6.0      8    6.0\n6     6 2019      4    2.0      4    2.0",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pyramid Stack2"
    ]
  },
  {
    "objectID": "Hiplot/147-pyramid-stack2.html#visualization",
    "href": "Hiplot/147-pyramid-stack2.html#visualization",
    "title": "Pyramid Stack2",
    "section": "Visualization",
    "text": "Visualization\n\n# Pyramid Stack2\np &lt;- as.ggplot(function() {\n  cols &lt;- c(\"#E64B35FF\",\"#4DBBD5FF\",\"#00A087FF\",\"#3C5488FF\")\n  names(cols) &lt;- colnames(dat_left)\n  cols &lt;- cols[1:ncol(dat_left)]\n  pyramid.plot(dat_left, dat_right, labels = agegrps, unit = \"Value\",\n               lxcol = cols, rxcol = cols,\n               laxlab=as.numeric(c(0,10,20,30)), raxlab=as.numeric(c(0,10,20,30)),\n               top.labels=c(split_var[1], colnames(data)[1], split_var[2]),\n               gap=4, ppmar=c(4,2,4,7), do.first=\"plot_bg(\\\"#FFFFFF\\\")\")\n  mtext(\"Porridge temperature by age and sex of bear\", 3, 2, cex=1)\n  legend(\"right\", inset=c(-0.25,0), legend = colnames(dat_left), fill = cols)\n  })\n\n32 32 \n\np\n\n\n\n\n\n\n\nFigureÂ 1: Pyramid Stack2",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pyramid Stack2"
    ]
  },
  {
    "objectID": "Hiplot/086-heatmap.html",
    "href": "Hiplot/086-heatmap.html",
    "title": "Heatmap",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Heatmap plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/heatmap?lang=en\nHeat map is an intuitive and visual method for analyzing the distribution of experimental data, which can be used for quality control of experimental data and visualization display of difference data, as well as clustering of data and samples to observe sample quality.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/086-heatmap.html#setup",
    "href": "Hiplot/086-heatmap.html#setup",
    "title": "Heatmap",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ComplexHeatmap; genefilter\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ComplexHeatmap\", quietly = TRUE)) {\n  BiocManager::install(\"ComplexHeatmap\")\n}\nif (!requireNamespace(\"genefilter\", quietly = TRUE)) {\n  install.packages(\"genefilter\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ComplexHeatmap)\nlibrary(genefilter)",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/086-heatmap.html#data-preparation",
    "href": "Hiplot/086-heatmap.html#data-preparation",
    "title": "Heatmap",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data are Count (gene name and corresponding gene expression value), sampleInfo (sample name, group and other relevant information, such as age), and gene information (gene name and its pathway, such as tumor pathway and physiological pathway).\n\n# Load data\ndata_count &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/heatmap/data.json\")$exampleData[[1]]$textarea[[1]])\ndata_count &lt;- as.data.frame(data_count)\ndata_sample &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/heatmap/data.json\")$exampleData[[1]]$textarea[[2]])\ndata_sample &lt;- as.data.frame(data_sample)\ndata_gene &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/heatmap/data.json\")$exampleData[[1]]$textarea[[3]])\ndata_gene &lt;- as.data.frame(data_gene)\n\n# Convert data structure\ndata_count &lt;- data_count[!is.na(data_count[, 1]), ]\nidx &lt;- duplicated(data_count[, 1])\ndata_count[idx, 1] &lt;- paste0(data_count[idx, 1], \"--dup-\", cumsum(idx)[idx])\nfor (i in 2:ncol(data_count)) {\n  data_count[, i] &lt;- as.numeric(data_count[, i])\n}\ndata &lt;- as.matrix(data_count[, -1])\nrownames(data) &lt;- data_count[, 1]\n\n## Add annotation information to samples\nsample.info &lt;- data_sample[-1]\nrow.names(sample.info) &lt;- data_sample[, 1]\nsample_info_reorder &lt;- as.data.frame(sample.info[match(\n  colnames(data), rownames(sample.info)\n  ), ])\ncolnames(sample_info_reorder) &lt;- colnames(sample.info)\nrownames(sample_info_reorder) &lt;- colnames(data)\n\n## Add annotation information to genes\ngene_info &lt;- data_gene[-1]\nrownames(gene_info) &lt;- data_gene[, 1]\ngene_info_reorder &lt;- as.data.frame(gene_info[match(\n  rownames(data), rownames(gene_info)\n  ), ])\ncolnames(gene_info_reorder) &lt;- colnames(gene_info)\nrownames(gene_info_reorder) &lt;- rownames(data)\n\n# View data\nhead(data)\n\n              M1       M2        M3       M4       M5       M6       M7\nGBP4    6.599344 5.226266  3.693288 3.938501 4.527193 9.308119 8.987865\nBCAT1   5.760380 4.892783  5.448924 3.485413 3.855669 8.662081 8.793320\nCMPK2   9.561905 4.549168  3.998655 5.614384 3.904793 9.790770 7.133188\nSTOX2   8.396409 8.717055  8.039064 7.643060 9.274649 4.417013 4.725270\nPADI2   8.419766 8.268430  8.451181 9.200732 8.598207 4.590033 5.368268\nSCARNA5 7.653074 5.780393 10.633550 5.913684 8.805605 5.890120 5.527945\n              M8       M9      M10\nGBP4    7.658312 8.666038 7.419708\nBCAT1   8.765915 8.097206 8.262942\nCMPK2   7.379591 7.938063 6.154118\nSTOX2   3.542217 4.305187 6.964710\nPADI2   4.136667 4.910986 4.080363\nSCARNA5 3.822596 4.041078 7.956589",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/086-heatmap.html#visualization",
    "href": "Hiplot/086-heatmap.html#visualization",
    "title": "Heatmap",
    "section": "Visualization",
    "text": "Visualization\n\n# Heatmap\n## Set annotation_col and annotation_row to add annotations to samples and genes respectively\ntop_var &lt;- 100\ntop_var_genes &lt;- rownames(data)[head(\n  order(genefilter::rowVars(data), decreasing = TRUE),\n  nrow(data) * top_var / 100\n)]\n## Set annotation_colors\ncol &lt;- colorRampPalette(c(\"#0060BF\",\"#FFFFFF\",\"#CA1111\"))(50)\nannotation_colors &lt;- list()\nfor(i in colnames(sample_info_reorder)) {\n  if (is.numeric(sample_info_reorder[,i])) {\n    annotation_colors[[i]] &lt;- col\n  } else {\n    ref &lt;- c(\"#323232\",\"#1B6393\")\n    annotation_colors[[i]] &lt;- ref\n    names(annotation_colors[[i]]) &lt;- unique(sample_info_reorder[,i])\n  }\n}\nfor(i in colnames(gene_info_reorder)) {\n  if (is.numeric(gene_info_reorder[,i])) {\n    annotation_colors[[i]] &lt;- col\n  } else {\n    ref &lt;- c(\"#323232\",\"#1B6393\")\n    annotation_colors[[i]] &lt;- ref\n    names(annotation_colors[[i]]) &lt;- unique(gene_info_reorder[,i])\n  }\n}\n\np &lt;- \n  ComplexHeatmap::pheatmap(\n    data[row.names(data) %in% top_var_genes,],\n    color = col, \n    border_color = NA,\n    fontsize_row = 6, fontsize_col = 6,\n    main = \"Heatmap Plot\",\n    cluster_rows = T, cluster_cols = T,\n    scale = \"none\",\n    clustering_method = \"ward.D2\",\n    clustering_distance_cols = \"euclidean\",\n    clustering_distance_rows = \"euclidean\",\n    fontfamily = \"Arial\",\n    display_numbers = F,\n    number_color = \"black\",\n    annotation_col = sample_info_reorder,\n    annotation_row = gene_info_reorder,\n    annotation_colors = annotation_colors\n  )\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Heatmap\n\n\n\n\n\nIn the example figure, each small grid represents each gene, and the shade of color represents the expression level of this gene. The larger the expression level is, the darker the color will be (red is up-regulated, green is down-regulated).Each row represents the expression of each gene in a different sample, and each column represents the expression of all genes in each sample.The upper tree represents the clustering analysis results of different samples of different groups and ages, and the left tree represents the clustering analysis results of different genes from different samples.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/001-area.html",
    "href": "Hiplot/001-area.html",
    "title": "Area Plot",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Area Plot plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/area?lang=en\nThe area chart displays graphically quantitative data. It is based on the line chart. The area between axis and line are commonly emphasized with colors, textures and hatchings.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Area"
    ]
  },
  {
    "objectID": "Hiplot/001-area.html#setup",
    "href": "Hiplot/001-area.html#setup",
    "title": "Area Plot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2; ggthemes\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"ggthemes\", quietly = TRUE)) {\n  install.packages(\"ggthemes\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(ggthemes)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Area"
    ]
  },
  {
    "objectID": "Hiplot/001-area.html#data-preparation",
    "href": "Hiplot/001-area.html#data-preparation",
    "title": "Area Plot",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data are xaxis.value and yaxis.value.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/area/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# View data\nhead(data)\n\n   group xaxis.value yaxis.value\n1 Group1        1900          26\n2 Group1        1901          27\n3 Group1        1902          10\n4 Group1        1903          16\n5 Group1        1904          19\n6 Group1        1905          18",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Area"
    ]
  },
  {
    "objectID": "Hiplot/001-area.html#visualization",
    "href": "Hiplot/001-area.html#visualization",
    "title": "Area Plot",
    "section": "Visualization",
    "text": "Visualization\n\n# Area Plot\np &lt;- ggplot(data, aes(x = xaxis.value, y = yaxis.value, fill = group)) +\n  geom_area(alpha = 1) +\n  ylab(\"yaxis.value\") +\n  xlab(\"xaxis.value\") +\n  ggtitle(\"Area Plot\") +\n  scale_fill_manual(values = c(\"#e04d39\",\"#5bbad6\",\"#1e9f86\")) +\n  theme_stata() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Area Plot\n\n\n\n\n\nDifferent colors represent different groups of area charts.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Area"
    ]
  },
  {
    "objectID": "Hiplot/092-line-color-dot.html",
    "href": "Hiplot/092-line-color-dot.html",
    "title": "Line (Color Dot)",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Line (Color Dot) plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/line-color-dot?lang=en",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Line (Color Dot)"
    ]
  },
  {
    "objectID": "Hiplot/092-line-color-dot.html#setup",
    "href": "Hiplot/092-line-color-dot.html#setup",
    "title": "Line (Color Dot)",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; grafify\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"grafify\", quietly = TRUE)) {\n  install.packages(\"grafify\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(grafify)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Line (Color Dot)"
    ]
  },
  {
    "objectID": "Hiplot/092-line-color-dot.html#data-preparation",
    "href": "Hiplot/092-line-color-dot.html#data-preparation",
    "title": "Line (Color Dot)",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/line-color-dot/data.json\")$exampleData[[1]]$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\nx &lt;- \"Time\"\ny &lt;- \"PI\"\ngroup &lt;- \"Experiment\"\nfacet &lt;- \"Genotype\"\ndata[, x] &lt;- factor(data[, x], levels = unique(data[, x]))\ndata[, group] &lt;- factor(data[, group], levels = unique(data[, group]))\ndata[, facet] &lt;- factor(data[, facet], levels = unique(data[, facet]))\n\n# View data\nhead(data)\n\n  Experiment Time Subject Genotype       PI Time2\n1         e1 t100      s1       WT 20.47120   100\n2         e2 t100      s2       WT 28.88967   100\n3         e3 t100      s3       WT 11.55061   100\n4         e4 t100      s4       WT 23.24516   100\n5         e5 t100      s5       WT 30.20904   100\n6         e6 t100      s6       WT 28.68300   100",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Line (Color Dot)"
    ]
  },
  {
    "objectID": "Hiplot/092-line-color-dot.html#visualization",
    "href": "Hiplot/092-line-color-dot.html#visualization",
    "title": "Line (Color Dot)",
    "section": "Visualization",
    "text": "Visualization\n\n# Line (Color Dot)\np &lt;- plot_befafter_colours(\n  data = data, xcol = get(x), ycol = get(y), match = get(group),\n  symsize = 5, symthick = 1, s_alpha = 1) +\n  facet_wrap(facet) +\n  guides(fill = guide_legend(title = group)) +\n  scale_fill_grafify() +\n  xlab(x) + ylab(y) +\n  ggtitle(\"Two-way repeated measures\") +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12, hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Line (Color Dot)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Line (Color Dot)"
    ]
  },
  {
    "objectID": "Hiplot/182-visdat.html",
    "href": "Hiplot/182-visdat.html",
    "title": "Visdat",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Visdat plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/visdat?lang=en",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Visdat"
    ]
  },
  {
    "objectID": "Hiplot/182-visdat.html#setup",
    "href": "Hiplot/182-visdat.html#setup",
    "title": "Visdat",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; visdat; ggplot2; dplyr; patchwork\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"visdat\", quietly = TRUE)) {\n  install.packages(\"visdat\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"patchwork\", quietly = TRUE)) {\n  install.packages(\"patchwork\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(visdat)\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(patchwork)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Visdat"
    ]
  },
  {
    "objectID": "Hiplot/182-visdat.html#data-preparation",
    "href": "Hiplot/182-visdat.html#data-preparation",
    "title": "Visdat",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/visdat/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# View data\nhead(data)\n\n  RowNames Ozone Solar.R Wind Temp Month Day\n1        1    41     190  7.4   67     5   1\n2        2    36     118  8.0   72     5   2\n3        3    12     149 12.6   74     5   3\n4        4    18     313 11.5   62     5   4\n5        5    NA      NA 14.3   56     5   5\n6        6    28      NA 14.9   66     5   6",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Visdat"
    ]
  },
  {
    "objectID": "Hiplot/182-visdat.html#visualization",
    "href": "Hiplot/182-visdat.html#visualization",
    "title": "Visdat",
    "section": "Visualization",
    "text": "Visualization\n\n# Visdat\nadd_palette &lt;- function (p) {\n  ## add color palette\n  p &lt;- p + scale_fill_manual(values = c(\"#3B4992FF\", \"#EE0000FF\"))\n}\npobj &lt;- list()\npobj[[\"p1\"]] &lt;- add_palette(vis_dat(data)) + ggtitle(':vis_dat')\npobj[[\"p2\"]] &lt;- add_palette(vis_guess(data)) + ggtitle(':vis_guess')\npobj[[\"p3\"]] &lt;- vis_miss(data, cluster = T, sort_miss = T) + ggtitle(':vis_miss')\npobj[[\"p4\"]] &lt;- add_palette(vis_expect(data, ~.x &gt;= 20 )) + ggtitle(':vis_expect')\npobj[[\"p5\"]] &lt;- vis_cor(data) + \n  scale_fill_gradientn(colours = c(\"#0571B0\", \"#92C5DE\", \"#F4A582\", \"#CA0020\")) +\n  ggtitle(':vis_cor')\npobj[[\"p6\"]] &lt;- data %&gt;%\n      select_if(is.numeric) %&gt;%\n      vis_value() + ggtitle(':vis_value')\npobj[[\"p6\"]] &lt;- pobj[[\"p6\"]] + \n  scale_fill_gradientn(colours = c(\"#0571B0\",\"#92C5DE\",\"#F7F7F7\",\"#F4A582\",\n                                   \"#CA0020\"))\n\npstr &lt;- paste0(sprintf(\"pobj[[%s]]\", 1:length(pobj)), collapse = \" + \")\np &lt;- eval(parse(text = \n  sprintf(\"%s + plot_layout(ncol = 2) +\nplot_annotation(tag_levels = 'A')\", pstr)))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Visdat",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Visdat"
    ]
  },
  {
    "objectID": "Hiplot/132-parallel-coordinate.html",
    "href": "Hiplot/132-parallel-coordinate.html",
    "title": "Parallel Coordinate",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Parallel Coordinate plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/parallel-coordinate?lang=en",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Parallel Coordinate"
    ]
  },
  {
    "objectID": "Hiplot/132-parallel-coordinate.html#setup",
    "href": "Hiplot/132-parallel-coordinate.html#setup",
    "title": "Parallel Coordinate",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; GGally; hrbrthemes; viridis; ggthemes\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"GGally\", quietly = TRUE)) {\n  install.packages(\"GGally\")\n}\nif (!requireNamespace(\"hrbrthemes\", quietly = TRUE)) {\n  remotes::install_github(\"hrbrmstr/hrbrthemes\")\n}\nif (!requireNamespace(\"viridis\", quietly = TRUE)) {\n  install.packages(\"viridis\")\n}\nif (!requireNamespace(\"ggthemes\", quietly = TRUE)) {\n  install.packages(\"ggthemes\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(GGally)\nlibrary(hrbrthemes)\nlibrary(viridis)\nlibrary(ggthemes)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Parallel Coordinate"
    ]
  },
  {
    "objectID": "Hiplot/132-parallel-coordinate.html#data-preparation",
    "href": "Hiplot/132-parallel-coordinate.html#data-preparation",
    "title": "Parallel Coordinate",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/parallel-coordinate/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\ndata[, 6] &lt;- factor(data[, 6], levels = unique(data[, 6]))\n\n# View data\nhead(data)\n\n    Name Value1 Value2 Value3 Value4       Group\n1    ATR    5.1    3.5    1.4    0.2 p53 pathway\n2  CHEK1    4.9    3.0    1.4    0.2 p53 pathway\n3  GORAB    4.7    3.2    1.3    0.2 p53 pathway\n4 CDKN2A    4.6    3.1    1.5    0.2 p53 pathway\n5   MDM2    5.0    3.6    1.4    0.2 p53 pathway\n6   MDM4    5.4    3.9    1.7    0.4 p53 pathway",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Parallel Coordinate"
    ]
  },
  {
    "objectID": "Hiplot/132-parallel-coordinate.html#visualization",
    "href": "Hiplot/132-parallel-coordinate.html#visualization",
    "title": "Parallel Coordinate",
    "section": "Visualization",
    "text": "Visualization\n\n# Parallel Coordinate\np &lt;- ggparcoord(data, columns = 2:(ncol(data) - 1), groupColumn = ncol(data),\n                title = \"Parallel Coordinate Plot for cancer Data\",\n                alphaLines = 0.3, scale = \"globalminmax\",\n                showPoints = T, boxplot = F) +\n  theme_base() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12, hjust = 0.5),\n        axis.title = element_text(size = 10),\n        axis.text = element_text(size = 12),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10)) +\n  scale_color_viridis(discrete = TRUE) +\n  facet_grid(formula(paste(\"~\", (colnames(data)[ncol(data)]))))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Parallel Coordinate",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Parallel Coordinate"
    ]
  },
  {
    "objectID": "Hiplot/171-time-roc.html",
    "href": "Hiplot/171-time-roc.html",
    "title": "Time ROC",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Time ROC plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/time-roc?lang=en\nReceiver Operating Characteristic (ROC) analysis with time records in survival analysis.",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Time ROC"
    ]
  },
  {
    "objectID": "Hiplot/171-time-roc.html#setup",
    "href": "Hiplot/171-time-roc.html#setup",
    "title": "Time ROC",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; plotROC; survivalROC; ggplot2; grid\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"plotROC\", quietly = TRUE)) {\n  install.packages(\"plotROC\")\n}\nif (!requireNamespace(\"survivalROC\", quietly = TRUE)) {\n  install.packages(\"survivalROC\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"grid\", quietly = TRUE)) {\n  install.packages(\"grid\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(plotROC)\nlibrary(survivalROC)\nlibrary(ggplot2)\nlibrary(grid)",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Time ROC"
    ]
  },
  {
    "objectID": "Hiplot/171-time-roc.html#data-preparation",
    "href": "Hiplot/171-time-roc.html#data-preparation",
    "title": "Time ROC",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n: (Numeric) survival data (i.e survive, risk).\n: (Numeric) time data.\n\n\n# Load data\ndata1 &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/time-roc/data.json\")$exampleData$textarea[[1]])\ndata1 &lt;- as.data.frame(data1)\ndata2 &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/time-roc/data.json\")$exampleData$textarea[[2]])\ndata2 &lt;- as.data.frame(data2)\n\n# convert data structure\nsurv_table &lt;- data1\ncolnames(surv_table) &lt;- c(\"surv\", \"cens\", \"risk\")\nmtime &lt;- as.data.frame(data2)[, 1]\nsroc &lt;- lapply(mtime, function(t) {\n  stroc &lt;- survivalROC(\n    Stime = surv_table$surv,\n    status = surv_table$cens,\n    marker = surv_table$risk,\n    predict.time = t,\n    method = \"KM\"\n  )\n  data.frame(\n    TPF = stroc[[\"TP\"]],\n    FPF = stroc[[\"FP\"]],\n    cut = stroc[[\"cut.values\"]],\n    time = rep(\n      stroc[[\"predict.time\"]],\n      length(stroc[[\"TP\"]])\n    ),\n    AUC = rep(\n      stroc$AUC,\n      length(stroc$FP)\n    )\n  )\n})\nmroc &lt;- do.call(rbind, sroc)\nmroc$time &lt;- factor(mroc$time)\n\n# View data\nhead(data1)\n\n       surv cens       risk\n1 11.126027    0 0.19205450\n2  9.794521    0 0.47734974\n3 13.690411    0 0.04605343\n4 10.068493    0 0.29717146\n5  3.317808    0 0.18144610\n6 12.312329    0 0.62681895\n\nhead(data2)\n\n  times\n1     2\n2     4\n3     6\n4     8\n5    10",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Time ROC"
    ]
  },
  {
    "objectID": "Hiplot/171-time-roc.html#visualization",
    "href": "Hiplot/171-time-roc.html#visualization",
    "title": "Time ROC",
    "section": "Visualization",
    "text": "Visualization\n\n# Time ROC\ncol &lt;- c(\"#E64B35FF\",\"#4DBBD5FF\",\"#00A087FF\",\"#3C5488FF\",\"#F39B7FFF\")\np &lt;- ggplot(mroc, aes(x = FPF, y = TPF, label = cut, color = time)) +\n  plotROC::geom_roc(labels = FALSE, stat = \"identity\", n.cuts = 0) +\n  geom_abline(slope = 1, intercept = 0, color = \"red\", linetype = 2) +\n  labs(title = \"ROC Dependence Time\", x = \"False positive rate\",\n       y = \"True positive rate\", \n       color = paste(\"Time\", \"(\", \"Year\", \")\")) +\n  theme_bw() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12, hjust = 0.5),\n        axis.title = element_text(size = 10),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10)) +\n  scale_color_manual(values = col)\n\nauc &lt;- levels(factor(mroc$AUC))\nfor (i in 1:length(auc)) {\n  p &lt;- p + annotate(\"text\",\n    x = 0.75,\n    y = 0.05 + 0.05 * i, ## æ³¨é‡Štextçš„ä½ç½®\n    col = col[i],\n    label = paste(\n      paste(paste(mtime[i], \"Year\", sep = \" \"), \" = \"),\n      round(as.numeric(auc[i]), 2)\n    )\n  )\n}\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Time ROC",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Time ROC"
    ]
  },
  {
    "objectID": "Hiplot/122-moon-charts.html",
    "href": "Hiplot/122-moon-charts.html",
    "title": "Moon charts",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Moon charts plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/moon-charts?lang=en\nThe moon chart is a graph that uses the moonâ€™s waxing and waning to reflect the size of the data.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Moon charts"
    ]
  },
  {
    "objectID": "Hiplot/122-moon-charts.html#setup",
    "href": "Hiplot/122-moon-charts.html#setup",
    "title": "Moon charts",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; gggibbous; ggplot2\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"gggibbous\", quietly = TRUE)) {\n  install.packages(\"gggibbous\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(gggibbous)\nlibrary(ggplot2)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Moon charts"
    ]
  },
  {
    "objectID": "Hiplot/122-moon-charts.html#data-preparation",
    "href": "Hiplot/122-moon-charts.html#data-preparation",
    "title": "Moon charts",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data are the name of the restaurant and the number of types of food in the restaurant, the number of decorative style types, the number of tableware sets and the number of price types.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/moon-charts/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\ndata[, 1] &lt;- factor(data[, 1], levels = unique(data[, 1]))\nrest_cols &lt;- colnames(data)[-1]\ntidyrest &lt;- reshape(\n  data,\n  varying = rest_cols,\n  v.names = \"Score\",\n  timevar = \"Category\",\n  times = factor(rest_cols, levels = rest_cols),\n  idvar = colnames(data)[1],\n  direction = \"long\"\n)\n\n# View data\nhead(data)\n\n                     Restaurant Food Decor Service Price\n1       Anscombe\"s Luncheonette    5     2       4     4\n2                  Chai Squared    3     5       2     5\n3 Tukey\"s Honest Southern Diner    4     3       3     2\n4                  Bagels ANOVA    4     1       3     5\n5                 Spearmint Row    1     5       5     2",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Moon charts"
    ]
  },
  {
    "objectID": "Hiplot/122-moon-charts.html#visualization",
    "href": "Hiplot/122-moon-charts.html#visualization",
    "title": "Moon charts",
    "section": "Visualization",
    "text": "Visualization\n\n# Moon charts\np &lt;- ggplot(tidyrest, aes(0, 0)) +\n  geom_moon(aes(ratio = (Score - 1) / 4), fill = \"black\") +\n  geom_moon(aes(ratio = 1 - (Score - 1) / 4), right = FALSE) +\n  facet_grid(Category ~ Restaurant, switch = \"y\") +\n  theme_minimal() +\n  theme(\n    panel.grid = element_blank(),\n    axis.text = element_blank(),\n    axis.title = element_blank()\n  )\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Moon charts\n\n\n\n\n\nThe first row of the diagram shows the name of the restaurant, the first column shows different variables in the restaurant, the blank moon represents the number of 1 (the least number), the black moon represents the number of 5 (the most number) data, as the number of data increases, the black area of the moon gradually becomes larger, that is, gradually becomes full moon.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Moon charts"
    ]
  },
  {
    "objectID": "Hiplot/037-dendrogram.html",
    "href": "Hiplot/037-dendrogram.html",
    "title": "Dendrogram",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Dendrogram plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/dendrogram?lang=en\nThe dendrogram is a diagram representing a tree. This diagrammatic representation is frequently used in different contexts:In hierarchical clustering, it illustrates the arrangement of the clusters produced by the corresponding analyses.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Dendrogram"
    ]
  },
  {
    "objectID": "Hiplot/037-dendrogram.html#setup",
    "href": "Hiplot/037-dendrogram.html#setup",
    "title": "Dendrogram",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ape; ggplotify\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ape\", quietly = TRUE)) {\n  install.packages(\"ape\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ape)\nlibrary(ggplotify)",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Dendrogram"
    ]
  },
  {
    "objectID": "Hiplot/037-dendrogram.html#data-preparation",
    "href": "Hiplot/037-dendrogram.html#data-preparation",
    "title": "Dendrogram",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/dendrogram/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# convert data structure\ndata &lt;- data[, -1]\n\n# View data\nhead(data)\n\n        M1       M2        M3       M4       M5       M6       M7       M8\n1 6.599344 5.226266  3.693288 3.938501 4.527193 9.308119 8.987865 7.658312\n2 5.760380 4.892783  5.448924 3.485413 3.855669 8.662081 8.793320 8.765915\n3 9.561905 4.549168  3.998655 5.614384 3.904793 9.790770 7.133188 7.379591\n4 8.396409 8.717055  8.039064 7.643060 9.274649 4.417013 4.725270 3.542217\n5 8.419766 8.268430  8.451181 9.200732 8.598207 4.590033 5.368268 4.136667\n6 7.653074 5.780393 10.633550 5.913684 8.805605 5.890120 5.527945 3.822596\n        M9      M10\n1 8.666038 7.419708\n2 8.097206 8.262942\n3 7.938063 6.154118\n4 4.305187 6.964710\n5 4.910986 4.080363\n6 4.041078 7.956589",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Dendrogram"
    ]
  },
  {
    "objectID": "Hiplot/037-dendrogram.html#visualization",
    "href": "Hiplot/037-dendrogram.html#visualization",
    "title": "Dendrogram",
    "section": "Visualization",
    "text": "Visualization\n\n# Dendrogram\nd &lt;- dist(t(data), method = \"euclidean\")\nhc &lt;- hclust(d, method = \"complete\")\nclus &lt;- cutree(hc, 4)\n\np &lt;- as.ggplot(function() {\n  par(mar = c(5, 5, 10, 5), mgp = c(2.5, 1, 0))\n  plot(as.phylo(hc),\n       type = \"phylogram\",\n       tip.color = c(\"#00468bff\",\"#ed0000ff\",\"#42b540ff\",\"#0099b4ff\")[clus], \n       label.offset = 1,\n       cex = 1, font = 2, use.edge.length = T\n       )\n  title(\"Dendrogram Plot\", line = 1)\n  })\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Dendrogram",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Dendrogram"
    ]
  },
  {
    "objectID": "Hiplot/144-pyramid-chart.html",
    "href": "Hiplot/144-pyramid-chart.html",
    "title": "Pyramid Chart",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Pyramid Chart plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/pyramid-chart?lang=en\nThe pyramid chart is a pyramid-like figure that distributes data on both sides of a central axis.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pyramid Chart"
    ]
  },
  {
    "objectID": "Hiplot/144-pyramid-chart.html#setup",
    "href": "Hiplot/144-pyramid-chart.html#setup",
    "title": "Pyramid Chart",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggcharts\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggcharts\", quietly = TRUE)) {\n  install.packages(\"ggcharts\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggcharts)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pyramid Chart"
    ]
  },
  {
    "objectID": "Hiplot/144-pyramid-chart.html#data-preparation",
    "href": "Hiplot/144-pyramid-chart.html#data-preparation",
    "title": "Pyramid Chart",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data are age, gender, and the number of people after the combination of the first two variables .\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/pyramid-chart/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# View data\nhead(data)\n\n    age    sex    pop\n1   0-4   male 225817\n2   0-4 female 213072\n3   5-9   male 223656\n4   5-9 female 210508\n5 10-14   male 214782\n6 10-14 female 201672",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pyramid Chart"
    ]
  },
  {
    "objectID": "Hiplot/144-pyramid-chart.html#visualization",
    "href": "Hiplot/144-pyramid-chart.html#visualization",
    "title": "Pyramid Chart",
    "section": "Visualization",
    "text": "Visualization\n\n# Pyramid Chart\np &lt;- pyramid_chart(data = data, x = age, y = pop, group = sex, \n                   title = \"\", sort = \"no\", bar_colors = c(\"#C20B01\",\"#196ABD\")) +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Pyramid Chart\n\n\n\n\n\nThe graph shows the age groups from bottom to top in order on the central axis, the left side represents the number of men, the right side represents the number of women, and the X-axis represents the number of people. The graph clearly shows the proportion of men and women in different age groups and the proportion of different age groups in the same gender.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Pyramid Chart"
    ]
  },
  {
    "objectID": "Hiplot/115-map-usa.html",
    "href": "Hiplot/115-map-usa.html",
    "title": "USA Map (States)",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot USA Map (States) plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/map-usa?lang=en",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "USA Map (States)"
    ]
  },
  {
    "objectID": "Hiplot/115-map-usa.html#setup",
    "href": "Hiplot/115-map-usa.html#setup",
    "title": "USA Map (States)",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2; RColorBrewer\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(RColorBrewer)",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "USA Map (States)"
    ]
  },
  {
    "objectID": "Hiplot/115-map-usa.html#data-preparation",
    "href": "Hiplot/115-map-usa.html#data-preparation",
    "title": "USA Map (States)",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/map-usa/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\ndt_map &lt;- readRDS(url(\"https://download.hiplot.cn/ui/basic/map-usa/usa.rds\"))\n\n# Convert data structure\ndt_map$Value &lt;- data$value[match(dt_map$state, data$name)]\n\n# View data\nhead(data)\n\n          name value\n1   Washington   438\n2      Montana   103\n3        Maine   614\n4 North Dakota   256\n5 South Dakota   639\n6      Wyoming   599",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "USA Map (States)"
    ]
  },
  {
    "objectID": "Hiplot/115-map-usa.html#visualization",
    "href": "Hiplot/115-map-usa.html#visualization",
    "title": "USA Map (States)",
    "section": "Visualization",
    "text": "Visualization\n\n# USA Map (States)\np &lt;- ggplot(dt_map) +\n  geom_polygon(aes(x = long, y = lat, group = group, fill = Value),\n               alpha = 0.9, size = 0.5) +\n  geom_path(aes(x = long, y = lat, group = group), color = \"black\", size = 0.2) +\n  coord_fixed() +\n  scale_fill_gradientn(\n    colours = colorRampPalette(rev(brewer.pal(11,\"RdYlBu\")))(500),\n    breaks = seq(min(data$value), max(data$value), \n                 round((max(data$value)-min(data$value))/7)),\n    name = \"Color Key\",\n    guide = guide_legend(\n      direction = \"vertical\", keyheight = unit(1, units = \"mm\"),\n      keywidth = unit(8, units = \"mm\"),\n      title.position = \"top\", title.hjust = 0.5, label.hjust = 0.5,\n      nrow = 1, byrow = T, reverse = F, label.position = \"bottom\")) +\n  theme(text = element_text(color = \"#3A3F4A\"),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank(),\n        legend.position = \"top\",\n        legend.text = element_text(size = 4 * 1.5, color = \"black\"),\n        legend.title = element_text(size = 5 * 1.5, color = \"black\"),\n        plot.title = element_text(\n          face = \"bold\", size = 5 * 1.5, hjust = 0.5, \n          margin = margin(t = 4, b = 5), color = \"black\"),\n        plot.background = element_rect(fill = \"#FFFFFF\", color = \"#FFFFFF\"),\n        panel.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        legend.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        plot.margin = unit(c(1.5, 1.5, 1.5, 1.5), \"cm\")) +\n  labs(x = NULL, y = NULL, title = \"USA Map\")\n\np\n\n\n\n\n\n\n\nFigureÂ 1: USA Map (States)",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "USA Map (States)"
    ]
  },
  {
    "objectID": "Hiplot/142-point-sd.html",
    "href": "Hiplot/142-point-sd.html",
    "title": "Point (SD)",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Point (SD) plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/point-sd?lang=en\nDisplaying the standard deviation (SD) of multi-group data.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Point (SD)"
    ]
  },
  {
    "objectID": "Hiplot/142-point-sd.html#setup",
    "href": "Hiplot/142-point-sd.html#setup",
    "title": "Point (SD)",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; grafify; dplyr\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"grafify\", quietly = TRUE)) {\n  install.packages(\"grafify\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(grafify)\nlibrary(dplyr)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Point (SD)"
    ]
  },
  {
    "objectID": "Hiplot/142-point-sd.html#data-preparation",
    "href": "Hiplot/142-point-sd.html#data-preparation",
    "title": "Point (SD)",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/point-sd/data.json\")$exampleData[[1]]$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\ny &lt;- \"Doubling_time\"\ngroup &lt;- \"Student\"\ndata[, group] &lt;- factor(data[, group], levels = unique(data[, group]))\ndata &lt;- data %&gt;% \n  mutate(median = median(get(y), na.rm = TRUE),\n         mean = mean(get(y), na.rm = TRUE))\n\n# View data\nhead(data)\n\n  Experiment Student Doubling_time facet   median     mean\n1       Exp1       A      17.36765    F1 20.18114 19.91642\n2       Exp1       B      18.04119    F1 20.18114 19.91642\n3       Exp1       C      18.70120    F1 20.18114 19.91642\n4       Exp1       D      20.06762    F1 20.18114 19.91642\n5       Exp1       E      20.19807    F2 20.18114 19.91642\n6       Exp1       F      22.11908    F2 20.18114 19.91642",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Point (SD)"
    ]
  },
  {
    "objectID": "Hiplot/142-point-sd.html#visualization",
    "href": "Hiplot/142-point-sd.html#visualization",
    "title": "Point (SD)",
    "section": "Visualization",
    "text": "Visualization\n\n# Point (SD)\np &lt;- plot_point_sd(data = data, Student, Doubling_time, symsize = 5,\n                   symthick = 0.5, s_alpha = 1, ewid = 0, symshape = 21,\n                   all_alpha = 0) +\n  geom_hline(aes(yintercept = median), colour = 'black', linetype = 2, \n             size = 0.5) +\n  xlab(group) + ylab(y) + \n  guides(fill = guide_legend(title = group)) +\n  ggtitle(\"Point-SD\") +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n    \n  \np\n\n\n\n\n\n\n\nFigureÂ 1: Point (SD)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Point (SD)"
    ]
  },
  {
    "objectID": "Hiplot/120-meta-cont.html",
    "href": "Hiplot/120-meta-cont.html",
    "title": "Meta-analysis of Continuous Data",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Meta-analysis of Continuous Data plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/meta-cont?lang=en",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Meta-analysis of Continuous Data"
    ]
  },
  {
    "objectID": "Hiplot/120-meta-cont.html#setup",
    "href": "Hiplot/120-meta-cont.html#setup",
    "title": "Meta-analysis of Continuous Data",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; meta; ggplotify\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"meta\", quietly = TRUE)) {\n  install.packages(\"meta\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(meta)\nlibrary(ggplotify)",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Meta-analysis of Continuous Data"
    ]
  },
  {
    "objectID": "Hiplot/120-meta-cont.html#data-preparation",
    "href": "Hiplot/120-meta-cont.html#data-preparation",
    "title": "Meta-analysis of Continuous Data",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/meta-cont/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\nm1 &lt;- metacont(n.e, mean.e, sd.e, n.c, mean.c, sd.c, studlab = Study, data = data,\n              sm = \"SMD\")\n\n# View data\nhead(data)\n\n  Study n.e mean.e sd.e n.c mean.c  sd.c\n1     A  13    5.0 4.70  13   6.50  3.80\n2     B  30    4.9 1.71  50   6.10  2.30\n3     C  35   22.5 3.44  35  24.90 10.65\n4     D  20   12.5 1.47  20  12.30  1.66\n5     E   8    6.5 0.76   8   7.38  1.41",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Meta-analysis of Continuous Data"
    ]
  },
  {
    "objectID": "Hiplot/120-meta-cont.html#visualization",
    "href": "Hiplot/120-meta-cont.html#visualization",
    "title": "Meta-analysis of Continuous Data",
    "section": "Visualization",
    "text": "Visualization\n\n# Meta-analysis of Continuous Data\np &lt;- as.ggplot(function(){\n  meta::forest(m1, layout = \"meta\")\n  })\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Meta-analysis of Continuous Data",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Meta-analysis of Continuous Data"
    ]
  },
  {
    "objectID": "Hiplot/121-metawho.html",
    "href": "Hiplot/121-metawho.html",
    "title": "Meta-Subgroup Analysis",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Meta-Subgroup Analysis plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/metawho?lang=en\nThe goal of metawho is to provide simple R implementation of â€œMeta-analytical method to Identify Who Benefits Most from Treatmentsâ€.\nmetawho is powered by R package metafor and does not support dataset contains individuals for now. Please use stata package ipdmetan if you are more familar with stata code.",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Meta-Subgroup Analysis"
    ]
  },
  {
    "objectID": "Hiplot/121-metawho.html#setup",
    "href": "Hiplot/121-metawho.html#setup",
    "title": "Meta-Subgroup Analysis",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; meta; cowplot\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"metawho\", quietly = TRUE)) {\n  install.packages(\"metawho\")\n}\nif (!requireNamespace(\"cowplot\", quietly = TRUE)) {\n  install.packages(\"cowplot\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(metawho)\nlibrary(cowplot)",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Meta-Subgroup Analysis"
    ]
  },
  {
    "objectID": "Hiplot/121-metawho.html#data-preparation",
    "href": "Hiplot/121-metawho.html#data-preparation",
    "title": "Meta-Subgroup Analysis",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/metawho/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\ndata = deft_prepare(data, conf_level = 1 - 0.95)\nres = deft_do(data, group_level = unique(data$subgroup))\n\n# View data\nhead(data)\n\n                 entry         trial subgroup   hr ci.lb ci.ub  ni   conf_q\n1      Rizvi 2015-Male    Rizvi 2015     Male 0.30  0.09  1.00  16 1.959964\n2    Rizvi 2015-Female    Rizvi 2015   Female 0.11  0.02  0.56  18 1.959964\n3      Rizvi 2018-Male    Rizvi 2018     Male 1.25  0.82  1.90 118 1.959964\n4    Rizvi 2018-Female    Rizvi 2018   Female 0.63  0.42  0.95 122 1.959964\n5   Hellmann 2018-Male Hellmann 2018     Male 0.90  0.41  1.99  37 1.959964\n6 Hellmann 2018-Female Hellmann 2018   Female 0.28  0.12  0.67  38 1.959964\n          yi       sei\n1 -1.2039728 0.6142831\n2 -2.2072749 0.8500678\n3  0.2231436 0.2143674\n4 -0.4620355 0.2082200\n5 -0.1053605 0.4030005\n6 -1.2729657 0.4387290",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Meta-Subgroup Analysis"
    ]
  },
  {
    "objectID": "Hiplot/121-metawho.html#visualization",
    "href": "Hiplot/121-metawho.html#visualization",
    "title": "Meta-Subgroup Analysis",
    "section": "Visualization",
    "text": "Visualization\n\n# Meta-Subgroup Analysis\np1 &lt;- deft_show(res, element = \"all\")\np2 &lt;- deft_show(res, element = \"subgroup\")\np &lt;- plot_grid(p1, p2, nrow = 2)\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Meta-Subgroup Analysis",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Meta-Subgroup Analysis"
    ]
  },
  {
    "objectID": "Hiplot/013-big-corrplot.html",
    "href": "Hiplot/013-big-corrplot.html",
    "title": "Corrplot Big Data",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Corrplot Big Data plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/big-corrplot?lang=en\nThe correlation heat map is a graph that analyzes the correlation between two or more variables.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Corrplot Big Data"
    ]
  },
  {
    "objectID": "Hiplot/013-big-corrplot.html#setup",
    "href": "Hiplot/013-big-corrplot.html#setup",
    "title": "Corrplot Big Data",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ComplexHeatmap\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ComplexHeatmap\", quietly = TRUE)) {\n  BiocManager::install(\"ComplexHeatmap\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ComplexHeatmap)",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Corrplot Big Data"
    ]
  },
  {
    "objectID": "Hiplot/013-big-corrplot.html#data-preparation",
    "href": "Hiplot/013-big-corrplot.html#data-preparation",
    "title": "Corrplot Big Data",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data are the gene names and the expression of each sample.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/big-corrplot/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# convert data structure\ndata &lt;- data[!is.na(data[, 1]), ]\nidx &lt;- duplicated(data[, 1])\ndata[idx, 1] &lt;- paste0(data[idx, 1], \"--dup-\", cumsum(idx)[idx])\nrownames(data) &lt;- data[, 1]\ndata &lt;- data[, -1]\nstr2num_df &lt;- function(x) {\n  x[] &lt;- lapply(x, function(l) as.numeric(l))\n  x\n}\ntmp &lt;- t(str2num_df(data))\ncorr &lt;- round(cor(tmp, use = \"na.or.complete\", method = \"pearson\"), 3)\n\n# View data\nhead(corr[,1:5])\n\n         RGL4   MPP7   UGCG CYSTM1  ANXA2\nRGL4    1.000  0.914  0.929  0.936 -0.592\nMPP7    0.914  1.000  0.852  0.907 -0.543\nUGCG    0.929  0.852  1.000  0.956 -0.440\nCYSTM1  0.936  0.907  0.956  1.000 -0.358\nANXA2  -0.592 -0.543 -0.440 -0.358  1.000\nENDOD1 -0.908 -0.862 -0.791 -0.762  0.826",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Corrplot Big Data"
    ]
  },
  {
    "objectID": "Hiplot/013-big-corrplot.html#visualization",
    "href": "Hiplot/013-big-corrplot.html#visualization",
    "title": "Corrplot Big Data",
    "section": "Visualization",
    "text": "Visualization\n\n# Corrplot Big Data\np &lt;- ComplexHeatmap::Heatmap(\n  corr, col = colorRampPalette(c(\"#4477AA\",\"#FFFFFF\",\"#BB4444\"))(50),\n  clustering_distance_rows = \"euclidean\",\n  clustering_method_rows = \"ward.D2\",\n  clustering_distance_columns = \"euclidean\",\n  clustering_method_columns = \"ward.D2\",\n  show_column_dend = FALSE, show_row_dend = FALSE,\n  column_names_gp = gpar(fontsize = 8),\n  row_names_gp = gpar(fontsize = 8)\n)\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Corrplot Big Data\n\n\n\n\n\nRed indicates positive correlation between two genes, blue indicates negative correlation between two genes, and the number in each cell indicates correlation coefficient.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Corrplot Big Data"
    ]
  },
  {
    "objectID": "Hiplot/082-group-comparison.html",
    "href": "Hiplot/082-group-comparison.html",
    "title": "Group-comparison Heatmap",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Group-comparison Heatmap plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/group-comparison?lang=en\nGroup-comparison Heatmap provides a way to compare multiple variables across multiple (&gt;2) groups and visualize the result with heatmap.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Group-comparison Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/082-group-comparison.html#setup",
    "href": "Hiplot/082-group-comparison.html#setup",
    "title": "Group-comparison Heatmap",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; sigminer\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"sigminer\", quietly = TRUE)) {\n  remotes::install_github(\"ShixiangWang/sigminer\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(sigminer)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Group-comparison Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/082-group-comparison.html#data-preparation",
    "href": "Hiplot/082-group-comparison.html#data-preparation",
    "title": "Group-comparison Heatmap",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/group-comparison/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# View data\nhead(data)\n\n  g1 g2 e1         e2\n1  A AA  N -1.8060313\n2  A AA  N -0.5820759\n3  A AA  N -1.1088896\n4  A AA  N -1.0149620\n5  A AA  P -0.1623095\n6  A AA  N  0.5630558",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Group-comparison Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/082-group-comparison.html#visualization",
    "href": "Hiplot/082-group-comparison.html#visualization",
    "title": "Group-comparison Heatmap",
    "section": "Visualization",
    "text": "Visualization\n\n# Define plot functions\nunlist_and_covert &lt;- function(x, recursive = FALSE) {\n  if (!is.null(x)) {\n    x &lt;- unlist(x, recursive = recursive)\n    if (!is.null(x)) {\n      y &lt;- sapply(x, function(x) {\n        if (identical(x, \"NA\")) NA else x\n      })\n      names(y) &lt;- names(x)\n      x &lt;- y\n    }\n  }\n  x\n}\n\nplotentry &lt;- function(data,\n                      grp_vars = NULL, enrich_vars = NULL, cross = TRUE,\n                      co_method = c(\"t.test\", \"wilcox.test\"), ref_group = NA,\n                      scales = \"free\", add_text_annotation = TRUE,\n                      fill_by_p_value = TRUE, use_fdr = TRUE, cut_p_value = FALSE,\n                      cluster_row = FALSE) {\n  ref_group &lt;- unlist_and_covert(ref_group)\n  if (is.null(ref_group)) ref_group &lt;- NA\n  rv &lt;- group_enrichment(data, grp_vars, enrich_vars, cross, co_method, ref_group)\n  if (length(unique(rv$grp_var)) == 1) {\n    p &lt;- show_group_enrichment(rv,\n      return_list = TRUE,\n      scales = scales, add_text_annotation = add_text_annotation,\n      fill_by_p_value = fill_by_p_value, use_fdr = use_fdr, cut_p_value = cut_p_value,\n      cluster_row = cluster_row\n    )\n    p &lt;- p[[1]]\n  } else {\n    p &lt;- show_group_enrichment(rv,\n      scales = scales, add_text_annotation = add_text_annotation,\n      fill_by_p_value = fill_by_p_value, use_fdr = use_fdr, cut_p_value = cut_p_value,\n      cluster_row = cluster_row\n    )\n  }\n  return(p)\n}\n\n# plot\np &lt;- plotentry(\n  data = data,\n  grp_vars = \"g1\",\n  enrich_vars = c(\"e1\", \"e2\"),\n  cross = T,\n  add_text_annotation = T,\n  fill_by_p_value = T,\n  use_fdr = T,\n  cut_p_value = F,\n  cluster_row = F,\n  co_method = \"t.test\",\n  scales = \"free\"\n)\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Group-comparison Heatmap",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Group-comparison Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/158-sankey.html",
    "href": "Hiplot/158-sankey.html",
    "title": "Sankey",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Sankey plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/sankey?lang=en\nSankey diagrams are a type of flow diagramin which the width of the arrows is proportional to the flow rate.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Sankey"
    ]
  },
  {
    "objectID": "Hiplot/158-sankey.html#setup",
    "href": "Hiplot/158-sankey.html#setup",
    "title": "Sankey",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggalluvial; ggplot2\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggalluvial\", quietly = TRUE)) {\n  install.packages(\"ggalluvial\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggalluvial)\nlibrary(ggplot2)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Sankey"
    ]
  },
  {
    "objectID": "Hiplot/158-sankey.html#data-preparation",
    "href": "Hiplot/158-sankey.html#data-preparation",
    "title": "Sankey",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data are the four variables and the frequency of combination of four variables.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/sankey/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\nvalue &lt;- \"Freq\"\naxis &lt;- c(\"Class\", \"Sex\")\nusr_axis &lt;- c()\nfor (i in seq_len(length(axis))) {\n  usr_axis &lt;- c(usr_axis, axis[i])\n  assign(paste0(\"axis\", i), axis[i])\n}\nindex_axis &lt;- match(usr_axis, colnames(data))\nindex_value &lt;- match(value, colnames(data))\ndata1 &lt;- data[, c(index_value, index_axis)]\n## define band color\nnlevels &lt;- as.numeric(apply(data1[, -1], 2, function(data) {\n  return(length(unique(data)))\n}))\nband_color &lt;- c(\"#8DD3C7\", \"#FFFFB3\", \"#BEBADA\", \"#FB8072\", \"#8DD3C7\", \"#FFFFB3\")\n## rename data\ndata_rename &lt;- data1\ncolnames(data_rename) &lt;- c(\n  \"value\",\n  paste(\"axis\", seq_len(length(usr_axis)), sep = \"\")\n)\n\n# View data\nhead(data)\n\n  Class    Sex   Age Survived Freq\n1   1st   Male Child       No    0\n2   2nd   Male Child       No    0\n3   3rd   Male Child       No   35\n4  Crew   Male Child       No    0\n5   1st Female Child       No    0\n6   2nd Female Child       No    0",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Sankey"
    ]
  },
  {
    "objectID": "Hiplot/158-sankey.html#visualization",
    "href": "Hiplot/158-sankey.html#visualization",
    "title": "Sankey",
    "section": "Visualization",
    "text": "Visualization\n\n# Sankey\np &lt;- ggplot(data_rename, aes(y = value, axis1 = axis1, axis2 = axis2)) +\n  geom_alluvium(alpha = 1, aes(fill = data1[, colnames(data1) == \"Sex\"]),\n                width = 0, reverse = FALSE) +\n  scale_x_discrete(limits = usr_axis, expand = c(0.02, 0.1)) +\n  ylab(\"\") +\n  scale_fill_discrete(name = \"Sex\") +\n  coord_flip() +\n  geom_stratum(alpha = 1, width = 1 / 8, reverse = FALSE, fill = band_color,\n               color = \"white\") +\n  geom_text(stat = \"stratum\", infer.label = TRUE, reverse = FALSE) +\n  ggtitle(\"Sankey plot\") +\n  guides(fill = guide_legend(title = \"Sex\")) +\n  scale_fill_manual(values = c(\"#00468BFF\", \"#ED0000FF\")) +\n  theme_bw() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Sankey\n\n\n\n\n\nThe color of female shunting is blue, the color of male shunting is red, and the width of blue shunting is equal to the total width of female.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Sankey"
    ]
  },
  {
    "objectID": "Hiplot/049-easy-pairs.html",
    "href": "Hiplot/049-easy-pairs.html",
    "title": "Easy Pairs",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Easy Pairs plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/easy-pairs?lang=en\nDisplay a matrix of plots for viewing correlation relationship and distributions of multiple variables.",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Easy Pairs"
    ]
  },
  {
    "objectID": "Hiplot/049-easy-pairs.html#setup",
    "href": "Hiplot/049-easy-pairs.html#setup",
    "title": "Easy Pairs",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; GGally\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"GGally\", quietly = TRUE)) {\n  install.packages(\"GGally\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(GGally)",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Easy Pairs"
    ]
  },
  {
    "objectID": "Hiplot/049-easy-pairs.html#data-preparation",
    "href": "Hiplot/049-easy-pairs.html#data-preparation",
    "title": "Easy Pairs",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/easy-pairs/data.json\")$exampleData[[1]]$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# View data\nhead(data)\n\n  total_bill  tip gender smoker day   time size\n1      16.99 1.01 Female     No Sun Dinner    2\n2      10.34 1.66   Male     No Sun Dinner    3\n3      21.01 3.50   Male     No Sun Dinner    3\n4      23.68 3.31   Male     No Sun Dinner    2\n5      24.59 3.61 Female     No Sun Dinner    4\n6      25.29 4.71   Male     No Sun Dinner    4",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Easy Pairs"
    ]
  },
  {
    "objectID": "Hiplot/049-easy-pairs.html#visualization",
    "href": "Hiplot/049-easy-pairs.html#visualization",
    "title": "Easy Pairs",
    "section": "Visualization",
    "text": "Visualization\n\n# Easy Pairs\np &lt;- ggpairs(data, columns = c(\"total_bill\", \"time\", \"tip\"),\n             mapping = aes_string(color = \"gender\")) +\n  ggtitle(\"Easy Pairs\") +\n  scale_fill_manual(values = c(\"#3B4992FF\",\"#EE0000FF\")) +\n  theme_bw() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Easy Pairs",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Easy Pairs"
    ]
  },
  {
    "objectID": "Hiplot/181-violin.html",
    "href": "Hiplot/181-violin.html",
    "title": "Violin",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Violin plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/violin?lang=en\nThe violin plot, named for its resemblance to a violin, is a statistical diagram combining a box diagram with a kernel density diagram to show the distribution of data and the probability density.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Violin"
    ]
  },
  {
    "objectID": "Hiplot/181-violin.html#setup",
    "href": "Hiplot/181-violin.html#setup",
    "title": "Violin",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggpubr; ggthemes\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggpubr\", quietly = TRUE)) {\n  install.packages(\"ggpubr\")\n}\nif (!requireNamespace(\"ggthemes\", quietly = TRUE)) {\n  install.packages(\"ggthemes\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggpubr)\nlibrary(ggthemes)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Violin"
    ]
  },
  {
    "objectID": "Hiplot/181-violin.html#data-preparation",
    "href": "Hiplot/181-violin.html#data-preparation",
    "title": "Violin",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data is data set (gene names and expression levels in different tumors).\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/violin/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# convert data structure\ngroups &lt;- unique(data[, 2])\nngroups &lt;- length(groups)\ncomb &lt;- combn(1:ngroups, 2)\nmy_comparisons &lt;- list()\nfor (i in seq_len(ncol(comb))) {\n  my_comparisons[[i]] &lt;- groups[comb[, i]]\n}\n\n# View data\nhead(data)\n\n  Expresssion Tumor\n1    12.10228   AML\n2    12.61382   AML\n3    12.52741   AML\n4    12.67990   AML\n5    12.64837   AML\n6    12.12146   AML",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Violin"
    ]
  },
  {
    "objectID": "Hiplot/181-violin.html#visualization",
    "href": "Hiplot/181-violin.html#visualization",
    "title": "Violin",
    "section": "Visualization",
    "text": "Visualization\n\n# Violin\np &lt;- ggviolin(data, x = \"Tumor\", y = \"Expresssion\", fill = \"Tumor\", add = \"boxplot\",\n              xlab = \"Tumor\", ylab = \"Expresssion\", \n              add.params = list(fill = \"white\"),\n              palette = c(\"#e04d39\",\"#5bbad6\",\"#1e9f86\"),\n              title = \"Violin Plot\", alpha = 1) + \n  stat_compare_means(comparisons = my_comparisons, label = \"p.signif\") +\n  theme_stata() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Violin\n\n\n\n\n\nThe violin plot can reflect the data distribution, which is similar to the box diagram. The black horizontal line in the box shows the median gene expression level in each tumor, and the upper and lower edges in the white box represent the upper and lower quartiles in the data set. The violin graph can also reflect the data density, and the more concentrated the data set, the fatter the graph. The gene expression distribution in the BLGG group is more concentrated, followed by BIC group and AML group.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Violin"
    ]
  },
  {
    "objectID": "Hiplot/050-easy-som.html",
    "href": "Hiplot/050-easy-som.html",
    "title": "Easy SOM",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Easy SOM plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/easy-som?lang=en\nEstablish the SOM model and conduct the visulization.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Easy SOM"
    ]
  },
  {
    "objectID": "Hiplot/050-easy-som.html#setup",
    "href": "Hiplot/050-easy-som.html#setup",
    "title": "Easy SOM",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; kohonen\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"kohonen\", quietly = TRUE)) {\n  install.packages(\"kohonen\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(kohonen)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Easy SOM"
    ]
  },
  {
    "objectID": "Hiplot/050-easy-som.html#data-preparation",
    "href": "Hiplot/050-easy-som.html#data-preparation",
    "title": "Easy SOM",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/easy-som/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# convert data structure\ntarget &lt;- data[,1]\ntarget &lt;- factor(target, levels = unique(target))\ndata &lt;- data[,-1]\ndata &lt;- as.data.frame(data)\nfor (i in 1:ncol(data)) {\n  data[,i] &lt;- as.numeric(data[,i])\n}\ndata &lt;- as.matrix(data)\nset.seed(7)\nkohmap &lt;- xyf(scale(data), target, grid = somgrid(xdim=6, ydim=4, topo=\"hexagonal\"), rlen=100)\n\ncolor_key &lt;- c(\"#A50026\",\"#D73027\",\"#F46D43\",\"#FDAE61\",\"#FEE090\",\"#FFFFBF\",\"#E0F3F8\",\n               \"#ABD9E9\",\"#74ADD1\",\"#4575B4\",\"#313695\")\ncolors &lt;- function (n, alpha, rev = FALSE) {\n  colorRampPalette(color_key)(n)\n}\n\n# View data\nhead(data[,1:5])\n\n     alcohol malic acid  ash ash alkalinity magnesium\n[1,]   12.86       1.35 2.32           18.0       122\n[2,]   12.88       2.99 2.40           20.0       104\n[3,]   12.81       2.31 2.40           24.0        98\n[4,]   12.70       3.55 2.36           21.5       106\n[5,]   12.51       1.24 2.25           17.5        85\n[6,]   12.60       2.46 2.20           18.5        94",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Easy SOM"
    ]
  },
  {
    "objectID": "Hiplot/050-easy-som.html#visualization",
    "href": "Hiplot/050-easy-som.html#visualization",
    "title": "Easy SOM",
    "section": "Visualization",
    "text": "Visualization\n\n# Easy SOM\np &lt;- function () {\n  par(mfrow = c(3,2))\n  xyfpredictions &lt;- classmat2classvec(getCodes(kohmap, 2))\n  plot(kohmap, type=\"counts\", col = as.integer(target),\n       palette.name = colors,\n       pchs = as.integer(target), \n       main = \"Counts plot\", shape = \"straight\", border = NA)\n  \n  som.hc &lt;- cutree(hclust(object.distances(kohmap, \"codes\")), 3)\n  add.cluster.boundaries(kohmap, som.hc)\n\n  plot(kohmap, type=\"mapping\",\n       labels = as.integer(target), col = colors(3)[as.integer(target)],\n       palette.name = colors,\n       shape = \"straight\",\n       main = \"Mapping plot\")\n\n  ## add background colors to units according to their predicted class labels\n  xyfpredictions &lt;- classmat2classvec(getCodes(kohmap, 2))\n  bgcols &lt;- colors(3)\n  plot(kohmap, type=\"mapping\", col = as.integer(target),\n       pchs = as.integer(target), bgcol = bgcols[as.integer(xyfpredictions)],\n       main = \"Another mapping plot\", shape = \"straight\", border = NA)\n  \n  similarities &lt;- plot(kohmap, type=\"quality\", shape = \"straight\",\n                       palette.name = colors)\n  \n  plot(kohmap, type=\"codes\", shape = \"straight\", \n       main = c(\"Codes X\", \"Codes Y\"), palette.name = colors)\n}\n\np()\n\n\n\n\n\n\n\nFigureÂ 1: Easy SOM",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Easy SOM"
    ]
  },
  {
    "objectID": "Hiplot/165-slopegraph.html",
    "href": "Hiplot/165-slopegraph.html",
    "title": "Slopegraph",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Slopegraph plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/slopegraph?lang=en\nSopegraph can be used to display the change of values.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Slopegraph"
    ]
  },
  {
    "objectID": "Hiplot/165-slopegraph.html#setup",
    "href": "Hiplot/165-slopegraph.html#setup",
    "title": "Slopegraph",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; CGPfunctions; ggplot2\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"CGPfunctions\", quietly = TRUE)) {\n  install.packages(\"CGPfunctions\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(CGPfunctions)\nlibrary(ggplot2)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Slopegraph"
    ]
  },
  {
    "objectID": "Hiplot/165-slopegraph.html#data-preparation",
    "href": "Hiplot/165-slopegraph.html#data-preparation",
    "title": "Slopegraph",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/slopegraph/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# convert data structure\ndata[, \"country\"] &lt;- factor(data[ ,\"country\"], levels = unique(data[ ,\"country\"]))\ndata[, \"year\"] &lt;- factor(data[ ,\"year\"], levels = unique(data[ ,\"year\"]))\n\n# View data\nhead(data)\n\n      country continent year lifeExp     pop gdpPercap\n1  Costa Rica  Americas 1992      76 3173216  6160.416\n2  Costa Rica  Americas 1997      77 3518107  6677.045\n3  Costa Rica  Americas 2002      78 3834934  7723.447\n4  Costa Rica  Americas 2007      79 4133884  9645.061\n5 El Salvador  Americas 1992      67 5274649  4444.232\n6 El Salvador  Americas 1997      70 5783439  5154.825",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Slopegraph"
    ]
  },
  {
    "objectID": "Hiplot/165-slopegraph.html#visualization",
    "href": "Hiplot/165-slopegraph.html#visualization",
    "title": "Slopegraph",
    "section": "Visualization",
    "text": "Visualization\n\n# Slopegraph\np &lt;- newggslopegraph(data, year, lifeExp, country) +\n  labs(subtitle = \"\", title = \"Slope Graph\", x = \"Life Expectancy (years)\",\n       y = \"country\", caption = \"\") +\n  scale_color_manual(values = c(\"#3B4992FF\", \"#EE0000FF\", \"#008B45FF\",\n                               \"#631879FF\", \"#008280FF\", \"#BB0021FF\")) +\n  theme_minimal() +\n  theme(plot.title = element_text(hjust = 0.5))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Slopegraph",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Slopegraph"
    ]
  },
  {
    "objectID": "Hiplot/061-gene-rank.html",
    "href": "Hiplot/061-gene-rank.html",
    "title": "Gene Ranking Dotplot",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Gene Ranking Dotplot plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/gene-rank?lang=en\nGene expression ranking visualization.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Gene Ranking Dotplot"
    ]
  },
  {
    "objectID": "Hiplot/061-gene-rank.html#setup",
    "href": "Hiplot/061-gene-rank.html#setup",
    "title": "Gene Ranking Dotplot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggrepel; ggplot2; RColorBrewer\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggrepel\", quietly = TRUE)) {\n  install.packages(\"ggrepel\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggrepel)\nlibrary(ggplot2)\nlibrary(RColorBrewer)",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Gene Ranking Dotplot"
    ]
  },
  {
    "objectID": "Hiplot/061-gene-rank.html#data-preparation",
    "href": "Hiplot/061-gene-rank.html#data-preparation",
    "title": "Gene Ranking Dotplot",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/gene-rank/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\n## ordered by log2FoldChange and pvalue\ndata &lt;- data[order(-data$log2FC, data$pvalue), ]\n## add the rank column\ndata$rank &lt;- 1:nrow(data)\n## get the top n up and down gene for labeling\ntop_n &lt;- 5\ntop_n_up &lt;- rownames(head(data, top_n))\ntop_n_down &lt;- rownames(tail(data, top_n))\ngenes_to_label &lt;- c(top_n_up, top_n_down)\ndata2 &lt;- data[genes_to_label, ]\n\n# View data\nhead(data)\n\n        gene   log2FC       pvalue rank\n514 LOC91370 3.889820 8.478310e-03    1\n293   LRRC25 3.492413 5.000000e-05    2\n470   BEGAIN 3.312996 3.347634e-03    3\n159   RDM1P5 3.125070 1.538852e-02    4\n194    CLDN1 3.096516 2.622163e-02    5\n626    KCNS1 2.949729 2.770000e-09    6",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Gene Ranking Dotplot"
    ]
  },
  {
    "objectID": "Hiplot/061-gene-rank.html#visualization",
    "href": "Hiplot/061-gene-rank.html#visualization",
    "title": "Gene Ranking Dotplot",
    "section": "Visualization",
    "text": "Visualization\n\n# Gene Ranking Dotplot\np &lt;- \n  ggplot(data, aes(rank, log2FC, color = pvalue, size = abs(log2FC))) + \n  geom_point() + \n  scale_color_gradientn(colours = colorRampPalette(brewer.pal(11,'RdYlBu'))(100)) +\n  geom_hline(yintercept = c(-1, 1), linetype = 2, size = 0.3) +\n  geom_hline(yintercept = 0, linetype = 1, size = 0.5) +\n  geom_vline(xintercept = median(data$rank), linetype = 2, size = 0.3) + \n  geom_text_repel(data = data2, aes(rank, log2FC, label = gene),\n                  size = 3, color = \"red\") +\n  xlab(\"\") + ylab(\"\") + \n  ylim(c(-max(abs(data$log2FC)), max(abs(data$log2FC)))) +\n  labs(color = \"Pvalue\", size = \"Log2FoldChange\") +\n  theme_bw(base_size = 12) +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Gene Ranking Dotplot",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Gene Ranking Dotplot"
    ]
  },
  {
    "objectID": "Hiplot/017-bumpchart.html",
    "href": "Hiplot/017-bumpchart.html",
    "title": "Bumpchart",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Bumpchart plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/bumpchart?lang=en\nBump chart can be used to display the change of grouped values.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Bumpchart"
    ]
  },
  {
    "objectID": "Hiplot/017-bumpchart.html#setup",
    "href": "Hiplot/017-bumpchart.html#setup",
    "title": "Bumpchart",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2; ggbump; dplyr\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"ggbump\", quietly = TRUE)) {\n  install.packages(\"ggbump\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(ggbump)\nlibrary(dplyr)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Bumpchart"
    ]
  },
  {
    "objectID": "Hiplot/017-bumpchart.html#data-preparation",
    "href": "Hiplot/017-bumpchart.html#data-preparation",
    "title": "Bumpchart",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/bumpchart/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# View data\nhead(data)\n\n     x y group\n1 2019 4     A\n2 2020 2     A\n3 2021 2     A\n4 2019 3     B\n5 2020 1     B\n6 2021 4     B",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Bumpchart"
    ]
  },
  {
    "objectID": "Hiplot/017-bumpchart.html#visualization",
    "href": "Hiplot/017-bumpchart.html#visualization",
    "title": "Bumpchart",
    "section": "Visualization",
    "text": "Visualization\n\n# Bumpchart\np &lt;- ggplot(data, aes(x = x, y = y, color = group)) +\n  geom_bump(size = 1.5) +\n  geom_point(size = 5) +\n  geom_text(data = data %&gt;% filter(x == min(x)),\n            aes(x = x - 0.1, label = group),\n            size = 5, hjust = 1) +\n  geom_text(data = data %&gt;% filter(x == max(x)),\n            aes(x = x + 0.1, label = group),\n            size = 5, hjust = 0) +\n  theme_void() +\n  theme(legend.position = \"none\") +\n  scale_color_manual(values = c(\"#0571B0\",\"#92C5DE\",\"#F4A582\",\"#CA0020\"))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Bumpchart",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Bumpchart"
    ]
  },
  {
    "objectID": "Hiplot/152-rcs-lrm.html",
    "href": "Hiplot/152-rcs-lrm.html",
    "title": "RCS-LRM",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot RCS-LRM plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/rcs-lrm?lang=en\nNonlinear regression analysis.",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "RCS-LRM"
    ]
  },
  {
    "objectID": "Hiplot/152-rcs-lrm.html#setup",
    "href": "Hiplot/152-rcs-lrm.html#setup",
    "title": "RCS-LRM",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; rms; survival; ggplot2; stringr\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"rms\", quietly = TRUE)) {\n  install.packages(\"rms\")\n}\nif (!requireNamespace(\"survival\", quietly = TRUE)) {\n  install.packages(\"survival\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"stringr\", quietly = TRUE)) {\n  install.packages(\"stringr\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(rms)\nlibrary(survival)\nlibrary(ggplot2)\nlibrary(stringr)",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "RCS-LRM"
    ]
  },
  {
    "objectID": "Hiplot/152-rcs-lrm.html#data-preparation",
    "href": "Hiplot/152-rcs-lrm.html#data-preparation",
    "title": "RCS-LRM",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/rcs-lrm/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\ndata &lt;- na.omit(data)\nex &lt;- set::not(colnames(data), c(\"main\", \"group\"))\nex &lt;- str_c(ex, collapse = \"+\")\ndd &lt;&lt;- datadist(data)\noptions(datadist = \"dd\")\nfor (i in 3:5) {\n  fit &lt;- lrm(as.formula(paste0(\"group~rcs(main,nk=i,inclx = T)+\", ex, collapse = \"+\")), data = data, x = TRUE)\n  tmp &lt;- AIC(fit)\n  if (i == 3) {\n    AIC &lt;- tmp\n    nk &lt;&lt;- 3\n  }\n  if (tmp &lt; AIC) {\n    AIC &lt;- tmp\n    nk &lt;&lt;- i\n  }\n}\nfit &lt;- lrm(as.formula(paste0(\"group~rcs(main,nk=nk,inclx = T)+\", ex, collapse = \"+\")), data = data, x = TRUE)\ndd$limits$main[2] &lt;- median(data$main)\nfit &lt;- update(fit)\norr &lt;- Predict(fit, main, fun = exp, ref.zero = TRUE)\n\n# View data\nhead(data)\n\n  main   X2 X3 group\n1  100 0.90  0     1\n2   90 0.65  1     1\n3  400 1.36  0     1\n4  200 0.83  0     1\n5  300 1.38  0     1\n6  200 0.69  0     1",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "RCS-LRM"
    ]
  },
  {
    "objectID": "Hiplot/152-rcs-lrm.html#visualization",
    "href": "Hiplot/152-rcs-lrm.html#visualization",
    "title": "RCS-LRM",
    "section": "Visualization",
    "text": "Visualization\n\n# RCS-LRM\np &lt;- ggplot() +\n  geom_line(data = orr, aes(main, yhat), linetype = \"solid\", size = 1, alpha = 1,\n            colour = \"#FF0000\") +\n  geom_ribbon(data = orr, aes(main, ymin = lower, ymax = upper), alpha = 0.6, \n              fill = \"#FFC0CB\") +\n  geom_hline(yintercept = 1, linetype = 2, size = 0.5) +\n  geom_vline(xintercept = dd$limits$main[2], linetype = 2, size = 0.5) +\n  labs(x = \"main\", y = \"Odds Ratio(95%CI)\") +\n  theme_bw() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n \np\n\n\n\n\n\n\n\nFigureÂ 1: RCS-LRM",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "RCS-LRM"
    ]
  },
  {
    "objectID": "Hiplot/185-waterfalls-plot.html",
    "href": "Hiplot/185-waterfalls-plot.html",
    "title": "Waterfalls Plot2",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Waterfalls Plot2 plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/waterfalls-plot?lang=en\nUsed to visualize changes in data, with the difference from version 1 being the ability to customize the colors for upward and downward values.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Waterfalls Plot2"
    ]
  },
  {
    "objectID": "Hiplot/185-waterfalls-plot.html#setup",
    "href": "Hiplot/185-waterfalls-plot.html#setup",
    "title": "Waterfalls Plot2",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; waterfalls; ggplot2\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"waterfalls\", quietly = TRUE)) {\n  install.packages(\"waterfalls\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(waterfalls)\nlibrary(ggplot2)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Waterfalls Plot2"
    ]
  },
  {
    "objectID": "Hiplot/185-waterfalls-plot.html#data-preparation",
    "href": "Hiplot/185-waterfalls-plot.html#data-preparation",
    "title": "Waterfalls Plot2",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/waterfalls-plot/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# convert data structure\ndata[[\"name\"]] &lt;- factor(data[[\"name\"]], levels = data[[\"name\"]])\ndata$fill &lt;- ifelse(data$value &gt; 0, \"#B71C1C\", \"#1B5E20\")\n\n# View data\nhead(data)\n\n  name value    fill\n1    A   100 #B71C1C\n2    B   -20 #1B5E20\n3    C   120 #B71C1C\n4    D   -40 #1B5E20\n5    E  -100 #1B5E20\n6    F    80 #B71C1C",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Waterfalls Plot2"
    ]
  },
  {
    "objectID": "Hiplot/185-waterfalls-plot.html#visualization",
    "href": "Hiplot/185-waterfalls-plot.html#visualization",
    "title": "Waterfalls Plot2",
    "section": "Visualization",
    "text": "Visualization\n\n# Waterfalls Plot2\np &lt;- waterfall(data, calc_total = T, rect_width = 0.7, fill_by_sign = F,\n               fill_colours = data$fill, total_rect_color = \"#1E065D\") +\n  theme_bw()\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Waterfalls Plot2",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Waterfalls Plot2"
    ]
  },
  {
    "objectID": "Hiplot/023-circular-barplot.html",
    "href": "Hiplot/023-circular-barplot.html",
    "title": "Circular Barplot",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Circular Barplot plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/circular-barplot?lang=en\nDrawing circular barplot",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Circular Barplot"
    ]
  },
  {
    "objectID": "Hiplot/023-circular-barplot.html#setup",
    "href": "Hiplot/023-circular-barplot.html#setup",
    "title": "Circular Barplot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2; dplyr\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(dplyr)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Circular Barplot"
    ]
  },
  {
    "objectID": "Hiplot/023-circular-barplot.html#data-preparation",
    "href": "Hiplot/023-circular-barplot.html#data-preparation",
    "title": "Circular Barplot",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/circular-barplot/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# convert data structure\ndata$group &lt;- as.factor(data$group)\nempty_bar &lt;- 2\nto_add &lt;- data.frame(matrix(NA, empty_bar*nlevels(data$group), ncol(data)))\ncolnames(to_add) &lt;- colnames(data)\nto_add$group &lt;- rep(levels(data$group), each=empty_bar)\ndata &lt;- rbind(data, to_add)\ndata &lt;- data %&gt;% arrange(group)\ndata$id &lt;- seq(1, nrow(data))\n\nlabel_data &lt;- data\nnumber_of_bar &lt;- nrow(label_data)\nangle &lt;- 90 - 360 * (label_data$id-0.5) /number_of_bar\nlabel_data$hjust &lt;- ifelse( angle &lt; -90, 1, 0)\nlabel_data$angle &lt;- ifelse(angle &lt; -90, angle+180, angle)\n\nbase_data &lt;- data %&gt;% \n  group_by(group) %&gt;% \n  dplyr::summarize(start=min(id), end=max(id) - empty_bar) %&gt;% \n  rowwise() %&gt;% \n  mutate(title=mean(c(start, end)))\n\n# View data\nhead(data)\n\n  individual group value id\n1   Mister 1     A    82  1\n2   Mister 2     A    98  2\n3   Mister 3     A    72  3\n4   Mister 4     A    34  4\n5   Mister 5     A    60  5\n6   Mister 6     A    61  6",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Circular Barplot"
    ]
  },
  {
    "objectID": "Hiplot/023-circular-barplot.html#visualization",
    "href": "Hiplot/023-circular-barplot.html#visualization",
    "title": "Circular Barplot",
    "section": "Visualization",
    "text": "Visualization\n\n# Circular Barplot\np &lt;- ggplot(data, aes(x=as.factor(id), y=value, fill=group)) +\n  geom_bar(aes(x=as.factor(id), y=value, fill=group), stat=\"identity\", alpha=0.5) +\n  ylim(-50,max(na.omit(data$value))+30) +\n  geom_segment(data=base_data, aes(x = start, y = -5, xend = end, yend = -5), colour = \"black\", alpha=0.8, size=0.8 , inherit.aes = FALSE )  +\n  geom_text(data=base_data, aes(x = title, y = -12, label=group), colour = \"black\", alpha=0.8, size=4, fontface=\"bold\", inherit.aes = FALSE) +\n  geom_text(data=label_data, aes(x=id, y=value+8, label=individual, hjust=hjust), color=\"black\", fontface=\"bold\",alpha=0.6, size=3, angle= label_data$angle, inherit.aes = FALSE ) +\n  geom_text(data=label_data, aes(x=id, y=value-10, label=value, hjust=hjust), color=\"black\", fontface=\"bold\",alpha=0.6, size=3, angle= label_data$angle, inherit.aes = FALSE ) +\n  coord_polar() + \n  scale_fill_manual(values = c(\"#3b4992ff\",\"#ee0000ff\",\"#008b45ff\",\"#631879ff\")) +\n  theme_minimal() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_blank(),\n        axis.text = element_blank(),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10),\n        panel.grid = element_blank(),\n        plot.margin = unit(rep(-1,4), \"cm\"))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Circular Barplot",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Circular Barplot"
    ]
  },
  {
    "objectID": "Hiplot/156-roc.html",
    "href": "Hiplot/156-roc.html",
    "title": "ROC",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot ROC plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/roc?lang=en\nReceiver operating characteristic curve (ROC curve) is used to describe the diagnostic ability of binary classifier system when its recognition threshold changes.",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "ROC"
    ]
  },
  {
    "objectID": "Hiplot/156-roc.html#setup",
    "href": "Hiplot/156-roc.html#setup",
    "title": "ROC",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; pROC; ggplotify\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"pROC\", quietly = TRUE)) {\n  install.packages(\"pROC\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(pROC)\nlibrary(ggplotify)",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "ROC"
    ]
  },
  {
    "objectID": "Hiplot/156-roc.html#data-preparation",
    "href": "Hiplot/156-roc.html#data-preparation",
    "title": "ROC",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data are the outcomes of one column of dichotomous variables and three columns of different variables (diagnostic indicators) and their values.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/roc/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\nname_val &lt;- colnames(data)[2:ncol(data)]\nnum_value &lt;- ncol(data) - 1\n\n# View data\nhead(data)\n\n  outcome value-Am value-GG value-EL\n1    Good        3     0.33    17.30\n2    Good        2     0.11    12.71\n3    Good        4     0.28     9.44\n4    Good        2     0.07    11.07\n5    Good        1     0.10    19.46\n6    Good        4     0.32    10.83",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "ROC"
    ]
  },
  {
    "objectID": "Hiplot/156-roc.html#visualization",
    "href": "Hiplot/156-roc.html#visualization",
    "title": "ROC",
    "section": "Visualization",
    "text": "Visualization\n\n# ROC\ncol &lt;- c(\"#00468BFF\",\"#ED0000FF\",\"#42B540FF\")\np &lt;- as.ggplot(function() {\n  for (i in 1:num_value) {\n    if (i == 1) {\n      roc_data &lt;- roc(data[, 1], data[, i + 1],\n        percent = T, plot = T, grid = T, lty = i, quiet = T,\n        print.auc = F, col = col[i], smooth = F,\n        main = \"ROC Plot\"\n      )\n      text(30, 50, \"AUC\", font = 2, col = \"darkgray\")\n      text(30, 50 - 10 * i,\n        paste(name_val[i], \":\", sprintf(\"%0.4f\", as.numeric(roc_data$auc))),\n        col = col[i]\n      )\n    } else {\n      roc_data &lt;- roc(data[, 1], data[, i + 1],\n        percent = T, plot = T, grid = T, add = T, lty = i, quiet = T,\n        print.auc = F, col = col[i]\n      )\n      text(30, 50 - 10 * i,\n        paste(name_val[i], \":\", sprintf(\"%0.4f\", as.numeric(roc_data$auc))),\n        col = col[i]\n      )\n    }\n  }\n    })\n\np\n\n\n\n\n\n\n\nFigureÂ 1: ROC\n\n\n\n\n\nThere is no functional relationship between specificity on the horizontal axis and sensitivity on the vertical axis.The closer the curve is to the upper left corner, the better the predictive ability of the diagnostic index is.Each color represented a variable (diagnostic indicator), and the blue and red curves were significantly better predictors than the green curves.AUC is the area under ROC curve.AUC=1 indicates that there is at least one threshold on the curve that leads to a perfect prediction.0.5&lt;AUC&lt;1, better than random guess, appropriate selection of threshold value, can have predictive value. AUC=0.5, like random guesses, the model has no predictive value. If AUC&lt;0.5, the possible reason is that the dichotomy variable such as (0,1) is reversed with the ending setting, and the result assignment can be reversed.In this diagram, it can be considered that Am variable has the best predictive ability as shown in value-Am(86.9792)&gt;value-GG(84.3750)&gt;value-EL(56.7708).",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "ROC"
    ]
  },
  {
    "objectID": "Hiplot/030-cor-heatmap.html",
    "href": "Hiplot/030-cor-heatmap.html",
    "title": "Correlation Heatmap",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Correlation Heatmap plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/cor-heatmap?lang=en\nThe correlation heat map is a graph that analyzes the correlation between two or more variables.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Correlation Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/030-cor-heatmap.html#setup",
    "href": "Hiplot/030-cor-heatmap.html#setup",
    "title": "Correlation Heatmap",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggcorrplot\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggcorrplot\", quietly = TRUE)) {\n  install.packages(\"ggcorrplot\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggcorrplot)",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Correlation Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/030-cor-heatmap.html#data-preparation",
    "href": "Hiplot/030-cor-heatmap.html#data-preparation",
    "title": "Correlation Heatmap",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data are the gene names and the expression of each sample.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/cor-heatmap/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# convert data structure\ndata &lt;- data[!is.na(data[, 1]), ]\nidx &lt;- duplicated(data[, 1])\ndata[idx, 1] &lt;- paste0(data[idx, 1], \"--dup-\", cumsum(idx)[idx])\nrownames(data) &lt;- data[, 1]\ndata &lt;- data[, -1]\nstr2num_df &lt;- function(x) {\n  final &lt;- NULL\n  for (i in seq_len(ncol(x))) {\n    final &lt;- cbind(final, as.numeric(x[, i]))\n  }\n  colnames(final) &lt;- colnames(x)\n  return(final)\n}\ntmp &lt;- str2num_df(t(data))\ncorr &lt;- round(cor(tmp, use = \"na.or.complete\", method = \"pearson\"), 3)\np_mat &lt;- round(cor_pmat(tmp, method = \"pearson\"), 3)\n\n# View data\nhead(data)\n\n             M1       M2       M3       M4       M5       M6        M7       M8\nRGL4   8.454808 8.019389 8.990836 9.718631 7.908075 4.147051  4.985084 4.576711\nMPP7   8.690520 8.630346 7.080873 9.838476 8.271824 5.179200  5.200868 3.266993\nUGCG   8.648366 8.600555 9.431046 7.923021 8.309214 4.902510  5.750804 4.492856\nCYSTM1 8.628884 9.238677 8.487243 8.958537 7.357109 4.541605  6.370533 4.246651\nANXA2  4.983769 6.748022 6.220791 4.719403 3.284346 8.089850 10.637472 7.214912\nENDOD1 5.551640 5.406465 4.663785 3.550765 4.103507 8.393991  9.538503 9.069923\n             M9      M10\nRGL4   4.930349 4.293700\nMPP7   5.565226 4.300309\nUGCG   4.659987 3.306275\nCYSTM1 4.745769 3.449627\nANXA2  9.002710 5.123359\nENDOD1 8.639664 7.106392",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Correlation Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/030-cor-heatmap.html#visualization",
    "href": "Hiplot/030-cor-heatmap.html#visualization",
    "title": "Correlation Heatmap",
    "section": "Visualization",
    "text": "Visualization\n\n# Correlation Heatmap\np &lt;- ggcorrplot(\n  corr,\n  colors = c(\"#4477AA\", \"#FFFFFF\", \"#BB4444\"),\n  method = \"circle\",\n  hc.order = T,\n  hc.method = \"ward.D2\",\n  outline.col = \"white\",\n  ggtheme = theme_bw(),\n  type = \"upper\",\n  lab = F,\n  lab_size = 3,\n  legend.title = \"Correlation\"\n  ) +\n  ggtitle(\"Cor Heatmap Plot\") +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\np\n\n\n\n\n\n\n\nFigureÂ 1: Correlation Heatmap\n\n\n\n\n\nRed indicates positive correlation between two genes, blue indicates negative correlation between two genes, and the number in each cell indicates correlation coefficient.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Correlation Heatmap"
    ]
  },
  {
    "objectID": "Hiplot/016-bubble.html",
    "href": "Hiplot/016-bubble.html",
    "title": "Bubble",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Bubble plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/bubble?lang=en\nThe bubble chart is a statistical chart that shows the third variable by the size of the bubble on the basis of the scatter chart, so that the three variables can be compared and analyzed simultaneously.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Bubble"
    ]
  },
  {
    "objectID": "Hiplot/016-bubble.html#setup",
    "href": "Hiplot/016-bubble.html#setup",
    "title": "Bubble",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2; stringr\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"stringr\", quietly = TRUE)) {\n  install.packages(\"stringr\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(stringr)",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Bubble"
    ]
  },
  {
    "objectID": "Hiplot/016-bubble.html#data-preparation",
    "href": "Hiplot/016-bubble.html#data-preparation",
    "title": "Bubble",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data are GO Term,Gene Ridio, Gene count and P-value.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/bubble/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# convert data structure\ndata[, 1] &lt;- str_to_sentence(str_remove(data[, 1], pattern = \"\\\\w+:\\\\d+\\\\W\"))\ntopnum &lt;- 7\ndata &lt;- data[1:topnum, ]\ndata[, 1] &lt;- factor(data[, 1], level = rev(unique(data[, 1])))\n\n# View data\nhead(data)\n\n                               Term Count     Ratio   PValue\n1                   Immune response    20 10.471204 9.61e-08\n2     Defense response to bacterium    11  5.759162 3.02e-06\n3                   Cell chemotaxis     8  4.188482 5.14e-06\n4                     Cell adhesion    17  8.900524 2.73e-05\n5             Complement activation     8  4.188482 3.56e-05\n6 Extracellular matrix organization    11  5.759162 4.23e-05",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Bubble"
    ]
  },
  {
    "objectID": "Hiplot/016-bubble.html#visualization",
    "href": "Hiplot/016-bubble.html#visualization",
    "title": "Bubble",
    "section": "Visualization",
    "text": "Visualization\n\n# Bubble\np &lt;- ggplot(data, aes(Ratio, Term)) +\n  geom_point(aes(size = Count, colour = -log10(PValue))) +\n  scale_colour_gradient(low = \"#00438E\", high = \"#E43535\") +\n  labs(colour = \"-log10 (PValue)\", size = \"Count\", x = \"Ratio\", y = \"Term\", \n       title = \"Bubble Plot\") +\n  scale_x_continuous(limits = c(0, max(data$Ratio) * 1.2)) +\n  guides(color = guide_colorbar(order = 1), size = guide_legend(order = 2)) +\n  scale_y_discrete(labels = function(x) {str_wrap(x, width = 65)}) +\n  theme_bw() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Bubble\n\n\n\n\n\nThe x-axis represents Gene Ridio, and the y-axis is GO Term; The size of the dot represents the number of genes, and the color of the dot represents the high or low P value.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Bubble"
    ]
  },
  {
    "objectID": "Hiplot/097-map-americas.html",
    "href": "Hiplot/097-map-americas.html",
    "title": "Americas Map",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Americas Map plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/map-americas?lang=en",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Americas Map"
    ]
  },
  {
    "objectID": "Hiplot/097-map-americas.html#setup",
    "href": "Hiplot/097-map-americas.html#setup",
    "title": "Americas Map",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2; RColorBrewer\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(RColorBrewer)",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Americas Map"
    ]
  },
  {
    "objectID": "Hiplot/097-map-americas.html#data-preparation",
    "href": "Hiplot/097-map-americas.html#data-preparation",
    "title": "Americas Map",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/map-americas/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\ndt_map &lt;- readRDS(url(\"https://download.hiplot.cn/ui/basic/map-americas/amr.rds\"))\n\n# Convert data structure\ndt_map$Value &lt;- data$value[match(dt_map$ENG_NAME, data$region)]\n\n# View data\nhead(data)\n\n               region value\n1 Aruba (Netherlands)    48\n2 Antigua and Barbuda   749\n3           Argentina   667\n4       Anguilla (UK)    14\n5            Barbados    83\n6        Bermuda (UK)   109",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Americas Map"
    ]
  },
  {
    "objectID": "Hiplot/097-map-americas.html#visualization",
    "href": "Hiplot/097-map-americas.html#visualization",
    "title": "Americas Map",
    "section": "Visualization",
    "text": "Visualization\n\n# Americas Map\np &lt;- ggplot(dt_map) +\n  geom_polygon(aes(x = long, y = lat, group = group, fill = Value),\n               alpha = 0.9, size = 0.5) +\n  geom_path(aes(x = long, y = lat, group = group), color = \"black\", size = 0.2) +\n  coord_fixed() +\n  scale_fill_gradientn(\n    colours = colorRampPalette(rev(brewer.pal(11,\"RdYlBu\")))(500),\n    breaks = seq(min(data$value), max(data$value), \n                 round((max(data$value)-min(data$value))/7)),\n    name = \"Color Key\",\n    guide = guide_legend(\n      direction = \"vertical\", keyheight = unit(1, units = \"mm\"),\n      keywidth = unit(8, units = \"mm\"),\n      title.position = \"top\", title.hjust = 0.5, label.hjust = 0.5,\n      nrow = 1, byrow = T, reverse = F, label.position = \"bottom\")) +\n  theme(text = element_text(color = \"#3A3F4A\"),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank(),\n        legend.position = \"top\",\n        legend.text = element_text(size = 4 * 1.5, color = \"black\"),\n        legend.title = element_text(size = 5 * 1.5, color = \"black\"),\n        plot.title = element_text(\n          face = \"bold\", size = 5 * 1.5, hjust = 0.5, \n          margin = margin(t = 4, b = 5), color = \"black\"),\n        plot.background = element_rect(fill = \"#FFFFFF\", color = \"#FFFFFF\"),\n        panel.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        legend.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        plot.margin = unit(c(1.5, 1.5, 1.5, 1.5), \"cm\")) +\n  labs(x = NULL, y = NULL, title = \"Americas Map\")\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Americas Map",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Americas Map"
    ]
  },
  {
    "objectID": "Hiplot/106-map-germany-town.html",
    "href": "Hiplot/106-map-germany-town.html",
    "title": "Germany Map (Town)",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Germany Map (Town) plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/map-germany-town?lang=en",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Germany Map (Town)"
    ]
  },
  {
    "objectID": "Hiplot/106-map-germany-town.html#setup",
    "href": "Hiplot/106-map-germany-town.html#setup",
    "title": "Germany Map (Town)",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2; RColorBrewer\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(RColorBrewer)",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Germany Map (Town)"
    ]
  },
  {
    "objectID": "Hiplot/106-map-germany-town.html#data-preparation",
    "href": "Hiplot/106-map-germany-town.html#data-preparation",
    "title": "Germany Map (Town)",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/map-germany-town/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\ndt_map &lt;- readRDS(url(\"https://download.hiplot.cn/ui/basic/map-germany-town/germany_town.rds\"))\n\n# Convert data structure\ndt_map$Value &lt;- data$value[match(dt_map$ENG_NAME, data$name)]\n\n# View data\nhead(data)\n\n          name value\n1 Allmendingen   711\n2      Altheim   540\n3    BerghÃ¼len   582\n4   Blaubeuren   454\n5    Blaustein   766\n6     Balzheim   480",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Germany Map (Town)"
    ]
  },
  {
    "objectID": "Hiplot/106-map-germany-town.html#visualization",
    "href": "Hiplot/106-map-germany-town.html#visualization",
    "title": "Germany Map (Town)",
    "section": "Visualization",
    "text": "Visualization\n\n# Germany Map (Town)\np &lt;- ggplot(dt_map) +\n  geom_polygon(aes(x = long, y = lat, group = group, fill = Value),\n               alpha = 0.9, size = 0.5) +\n  geom_path(aes(x = long, y = lat, group = group), color = \"black\", size = 0.2) +\n  coord_fixed() +\n  scale_fill_gradientn(\n    colours = colorRampPalette(rev(brewer.pal(11,\"RdYlBu\")))(500),\n    breaks = seq(min(data$value), max(data$value), \n                 round((max(data$value)-min(data$value))/7)),\n    name = \"Color Key\",\n    guide = guide_legend(\n      direction = \"vertical\", keyheight = unit(1, units = \"mm\"),\n      keywidth = unit(8, units = \"mm\"),\n      title.position = \"top\", title.hjust = 0.5, label.hjust = 0.5,\n      nrow = 1, byrow = T, reverse = F, label.position = \"bottom\")) +\n  theme(text = element_text(color = \"#3A3F4A\"),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank(),\n        legend.position = \"top\",\n        legend.text = element_text(size = 4 * 1.5, color = \"black\"),\n        legend.title = element_text(size = 5 * 1.5, color = \"black\"),\n        plot.title = element_text(\n          face = \"bold\", size = 5 * 1.5, hjust = 0.5, \n          margin = margin(t = 4, b = 5), color = \"black\"),\n        plot.background = element_rect(fill = \"#FFFFFF\", color = \"#FFFFFF\"),\n        panel.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        legend.background = element_rect(fill = \"#FFFFFF\", color = NA),\n        plot.margin = unit(c(1.5, 1.5, 1.5, 1.5), \"cm\")) +\n  labs(x = NULL, y = NULL, title = \"Germany Map\")\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Germany Map (Town)",
    "crumbs": [
      "<i class='fa-solid fa-earth-oceania'></i> MAP",
      "Germany Map (Town)"
    ]
  },
  {
    "objectID": "Hiplot/166-stack-violin.html",
    "href": "Hiplot/166-stack-violin.html",
    "title": "Stack Violin",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Stack Violin plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/stack-violin?lang=en\nThe expression of key genes in each cluster in single-cell transcriptomic (Single Cell RNA-Seq)analysis.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Simple Funnel Diagram"
    ]
  },
  {
    "objectID": "Hiplot/166-stack-violin.html#setup",
    "href": "Hiplot/166-stack-violin.html#setup",
    "title": "Stack Violin",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: readr; limma; Seurat; ggplot2\n\n\n# Install packages\nif (!requireNamespace(\"readr\", quietly = TRUE)) {\n  install.packages(\"readr\")\n}\nif (!requireNamespace(\"limma\", quietly = TRUE)) {\n  install.packages(\"limma\")\n}\nif (!requireNamespace(\"Seurat\", quietly = TRUE)) {\n  install.packages(\"Seurat\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# Load packages\nlibrary(readr)\nlibrary(limma)\nlibrary(Seurat)\nlibrary(ggplot2)",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Simple Funnel Diagram"
    ]
  },
  {
    "objectID": "Hiplot/166-stack-violin.html#data-preparation",
    "href": "Hiplot/166-stack-violin.html#data-preparation",
    "title": "Stack Violin",
    "section": "Data Preparation",
    "text": "Data Preparation\nGene expression matrix. Gene expression matrix in all cells and groups in single cell transcriptome analysis (Single Cell RNA-Seq).\n\n# Load data\ndata &lt;- readr::read_delim(\"https://download.hiplot.cn/api/file/fetch/?path=/c622f9b0-54da-11f0-ba5f-8dc116702904/public/demo/stack-violin.txt\")\n\n# convert data structure\ndata &lt;- as.matrix(data)\nrownames(data) &lt;- data[, 1]\nexp &lt;- data[, 2:ncol(data)]\ndimnames &lt;- list(\n  rownames(exp),\n  colnames(exp)\n)\ndata &lt;- matrix(as.numeric(as.matrix(exp)),\n  nrow = nrow(exp),\n  dimnames = dimnames\n)\ndata &lt;- avereps(data,\n  ID = rownames(data)\n)\n## Convert the matrix to a Seurat object and filter the data\npbmc &lt;- CreateSeuratObject(\n  counts = data,\n  project = \"seurat\",\n  min.cells = 0,\n  min.features = 0,\n  names.delim = \"_\",\n)\n## Calculate the percentage of mitochondrial genes using the PercentageFeatureSet function\npbmc[[\"percent.mt\"]] &lt;- PercentageFeatureSet(\n  object = pbmc,\n  pattern = \"^MT-\"\n)\n## Filter the data\npbmc &lt;- subset(\n  x = pbmc,\n  subset = nFeature_RNA &gt; 50 & percent.mt &lt; 5\n)\n## Normalize the data\npbmc &lt;- NormalizeData(\n  object = pbmc,\n  normalization.method = \"LogNormalize\",\n  scale.factor = 10000, verbose = F\n)\n## Extract genes with large coefficient of variation between cells\npbmc &lt;- FindVariableFeatures(\n  object = pbmc,\n  selection.method = \"vst\",\n  nfeatures = 1500, verbose = F\n)\n## Standard preprocessing steps before PCA dimensionality reduction\npbmc &lt;- ScaleData(pbmc)\npbmc &lt;- RunPCA(\n  object = pbmc,\n  npcs = 20,\n  pc.genes = VariableFeatures(object = pbmc)\n)\n## Distribution of p-values for each PC and uniform distribution\npbmc &lt;- JackStraw(\n  object = pbmc,\n  num.replicate = 100\n)\npbmc &lt;- ScoreJackStraw(\n  object = pbmc,\n  dims = 1:20\n)\n## Calculate neighbor distance\npbmc &lt;- FindNeighbors(\n  object = pbmc,\n  dims = 1:20\n)\n## Group cells and optimize standard modularity\npbmc &lt;- FindClusters(\n  object = pbmc,\n  resolution = 0.5\n)\n\nModularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck\n\nNumber of nodes: 653\nNumber of edges: 19073\n\nRunning Louvain algorithm...\nMaximum modularity in 10 random starts: 0.8659\nNumber of communities: 8\nElapsed time: 0 seconds\n\n## TSNE clustering\npbmc &lt;- RunTSNE(\n  object = pbmc,\n  dims = 1:20\n)\n## Finding differentially expressed features\nlog_fc_filter &lt;- 0.5\nadj_pval_filter &lt;- 0.05\npbmc_markers &lt;- FindAllMarkers(\n  object = pbmc,\n  only.pos = FALSE,\n  min.pct = 0.25,\n  logfc.threshold = log_fc_filter\n)\npbmc_sig_markers &lt;- pbmc_markers[(abs(as.numeric(\n  as.vector(pbmc_markers$avg_logFC)\n)) &gt; log_fc_filter &\n  as.numeric(as.vector(pbmc_markers$p_val_adj)) &lt;\n    adj_pval_filter), ]\n\n# View data\nhead(data[,1:5])\n\n         PT089_P1_A01 PT089_P1_A02 PT089_P1_A03 PT089_P1_A04 PT089_P1_A05\nA1BG             0.00            0            0            0            0\nA1BG-AS1         0.00            0            0            0            0\nA1CF             0.00            0            0            1            0\nA2M              0.00            0            0          339            0\nA2M-AS1          0.00            0            0            0            0\nA2ML1            1.08            0            0            0            0",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Simple Funnel Diagram"
    ]
  },
  {
    "objectID": "Hiplot/166-stack-violin.html#visualization",
    "href": "Hiplot/166-stack-violin.html#visualization",
    "title": "Stack Violin",
    "section": "Visualization",
    "text": "Visualization\n\n# Stack Violin\n## Define the plot function\nmodify_vlnplot &lt;- function(obj,\n                           feature,\n                           pt.size = 0,\n                           plot.margin = unit(c(-0.75, 0, -0.75, 0), \"cm\"),\n                           ...) {\n  p &lt;- VlnPlot(obj,\n    features = feature,\n    pt.size = pt.size,\n    ...\n  )\n\n  p &lt;- p +\n    xlab(\"\") +\n    ylab(feature) +\n    theme(\n      axis.text.x = element_blank(),\n      axis.text.y = element_blank(),\n      axis.ticks.x = element_blank(),\n      axis.ticks.y = element_line(),\n      axis.title.y = element_text(angle = 0, vjust = 0.5),\n      plot.margin = plot.margin,\n      text = element_text(\n        family = \"Arial\"\n      ),\n      plot.title = element_blank(),\n      axis.title = element_text(\n        size = 10\n      ),\n      legend.position = \"none\",\n      legend.direction = \"vertical\",\n      legend.title = element_text(\n        size = 10\n      ),\n      legend.text = element_text(\n        size = 10\n      )\n    ) +\n    scale_fill_manual(values = c(\"#00468BFF\",\"#ED0000FF\",\"#42B540FF\",\"#0099B4FF\",\n                                 \"#925E9FFF\",\"#FDAF91FF\",\"#AD002AFF\",\"#ADB6B6FF\"))\n  return(p)\n}\n\n## main function\nstacked_vln_plot &lt;- function(obj,\n                           features,\n                           pt.size = 0,\n                           plot.margin = unit(c(-0.75, 0, -0.75, 0), \"cm\"),\n                           ...) {\n  plot_list &lt;- purrr::map(\n    features,\n    function(x) {\n      modify_vlnplot(\n        obj = obj,\n        feature = x,\n        ...\n      )\n    }\n  )\n  plot_list[[length(plot_list)]] &lt;- plot_list[[length(plot_list)]] +\n    theme(\n      axis.text.x = element_text(),\n      axis.ticks.x = element_line()\n    )\n  p &lt;- patchwork::wrap_plots(\n    plotlist = plot_list,\n    ncol = 1\n  )\n  return(p)\n}\n\n## plot\np &lt;- stacked_vln_plot(pbmc, c(\"ACTG1\",\"ARF1\",\"ALDOA\",\"ARHGDIA\",\"ACTB\"), pt.size = 0)\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Stack Violin",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Simple Funnel Diagram"
    ]
  },
  {
    "objectID": "Hiplot/002-barcode-plot.html",
    "href": "Hiplot/002-barcode-plot.html",
    "title": "Barcode Plot",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Barcode Plot plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/barcode-plot?lang=en\nBarcode Plot is Suitable for displaying the distribution of large amounts of data.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Barcode Plot"
    ]
  },
  {
    "objectID": "Hiplot/002-barcode-plot.html#setup",
    "href": "Hiplot/002-barcode-plot.html#setup",
    "title": "Barcode Plot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Barcode Plot"
    ]
  },
  {
    "objectID": "Hiplot/002-barcode-plot.html#data-preparation",
    "href": "Hiplot/002-barcode-plot.html#data-preparation",
    "title": "Barcode Plot",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe case data represents the sales revenue of a certain product in 500 stores in three regions.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/barcode-plot/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# View data\nhead(data)\n\n     region    sales\n1 GuangDong 42.54612\n2 GuangDong 46.26102\n3 GuangDong 46.00448\n4 GuangDong 45.05684\n5 GuangDong 48.67611\n6 GuangDong 56.95071",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Barcode Plot"
    ]
  },
  {
    "objectID": "Hiplot/002-barcode-plot.html#visualization",
    "href": "Hiplot/002-barcode-plot.html#visualization",
    "title": "Barcode Plot",
    "section": "Visualization",
    "text": "Visualization\n\n# Barcode Plot\np &lt;- ggplot(data, aes(x = sales, y = region)) +\n  geom_tile(width = 0.01, height = 0.9, fill = \"#606fcc\") + # Control the width and height of the Barcode\n  theme_bw() +\n  labs(title = \"Sales report\", x = \"Sales\", y = \"Region\") +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Barcode Plot\n\n\n\n\n\nThrough the barcode plot, we can observe that the number of stores with sales revenue around 50 is relatively high in Guangdong and Fujian regions. Additionally, the sales revenue among stores in Guangdong shows less variation, indicating a more concentrated distribution.\n\n\n\n\n\n\nTip\n\n\n\nSpecial Parameters: \n\nwidth: Width of the bars\nheight: Height of the bars\nfill: Color of the bars",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Barcode Plot"
    ]
  },
  {
    "objectID": "Hiplot/127-network-igraph.html",
    "href": "Hiplot/127-network-igraph.html",
    "title": "Network (igraph)",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Network (igraph) plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/network-igraph?lang=en\nNetwork (igraph) can be used to visulize basic network based on igraph.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Network (igraph)"
    ]
  },
  {
    "objectID": "Hiplot/127-network-igraph.html#setup",
    "href": "Hiplot/127-network-igraph.html#setup",
    "title": "Network (igraph)",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; igraph; stringr; ggplotify; RColorBrewer\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"igraph\", quietly = TRUE)) {\n  install.packages(\"igraph\")\n}\nif (!requireNamespace(\"stringr\", quietly = TRUE)) {\n  install.packages(\"stringr\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\nif (!requireNamespace(\"RColorBrewer\", quietly = TRUE)) {\n  install.packages(\"RColorBrewer\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(igraph)\nlibrary(stringr)\nlibrary(ggplotify)\nlibrary(RColorBrewer)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Network (igraph)"
    ]
  },
  {
    "objectID": "Hiplot/127-network-igraph.html#data-preparation",
    "href": "Hiplot/127-network-igraph.html#data-preparation",
    "title": "Network (igraph)",
    "section": "Data Preparation",
    "text": "Data Preparation\nTwo data tables need to be entered. Table 1 is node information, including node ID and other annotation information, which can be used to map color and size. Table 2 is the link information, including node ID and connection information between nodes.\n\n# Load data\nnodes_data &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/network-igraph/data.json\")$exampleData[[1]]$textarea[[1]])\nnodes_data &lt;- as.data.frame(nodes_data)\nedges_data &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/network-igraph/data.json\")$exampleData[[1]]$textarea[[2]])\nedges_data &lt;- as.data.frame(edges_data)\n\n# Convert data structure\nnodes_data[,\"type.label\"] &lt;- factor(nodes_data[,\"type.label\"], \n                                    levels = unique(nodes_data[,\"type.label\"]))\nnodes_data$hiplot_color_type &lt;- as.numeric(nodes_data[,\"type.label\"])\nnet &lt;- graph_from_data_frame(d = edges_data, vertices = nodes_data, directed = T)\n## Generate colors based on type\ncolrs &lt;- c(\"#7f7f7f\",\"#ff6347\",\"#ffd700\")\ncolrs2 &lt;- c(\"#BC3C29FF\",\"#0072B5FF\",\"#E18727FF\",\"#20854EFF\",\"#7876B1FF\",\n            \"#6F99ADFF\",\"#FFDC91FF\",\"#EE4C97FF\")\nV(net)$color &lt;- colrs[V(net)$hiplot_color_type]\n## Compute node degrees (#links) and use that to set node size\ndeg &lt;- degree(net, mode=\"all\")\nV(net)$size &lt;- deg*3\n## Set label\nV(net)$label.color &lt;- \"black\"\nV(net)$label &lt;- NA\n## Set edge width based on weight\nweight_column &lt;- edges_data$weight\nE(net)$width &lt;- weight_column/6\n## Change arrow size and edge color\nE(net)$arrow.size &lt;- .2\nE(net)$edge.color &lt;- \"gray80\"\nedge.start &lt;- ends(net, es=E(net), names=F)[,1]\nedge.col &lt;- V(net)$color[edge.start]\n\n# View data\nhead(nodes_data)\n\n   id               media media.type type.label audience.size hiplot_color_type\n1 s01            NY Times          1  Newspaper            20                 1\n2 s02     Washington Post          1  Newspaper            25                 1\n3 s03 Wall Street Journal          1  Newspaper            30                 1\n4 s04           USA Today          1  Newspaper            32                 1\n5 s05            LA Times          1  Newspaper            20                 1\n6 s06       New York Post          1  Newspaper            50                 1\n\nhead(edges_data)\n\n  from  to      type weight\n1  s01 s02 hyperlink     22\n2  s01 s03 hyperlink     22\n3  s01 s04 hyperlink     21\n4  s01 s15   mention     20\n5  s02 s01 hyperlink     23\n6  s02 s03 hyperlink     21",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Network (igraph)"
    ]
  },
  {
    "objectID": "Hiplot/127-network-igraph.html#visualization",
    "href": "Hiplot/127-network-igraph.html#visualization",
    "title": "Network (igraph)",
    "section": "Visualization",
    "text": "Visualization\n\n# Network (igraph)\nraw &lt;- par()\np &lt;- as.ggplot(function () {\n  par(mar=c(8,2,2,2))\n  radian.rescale &lt;- function(x, start=0, direction=1) {\n    c.rotate &lt;- function(x) (x + start) %% (4 * pi) * direction\n    c.rotate(scales::rescale(x, c(0, 2 * pi), range(x)))\n  }\n\n  label &lt;- eval(parse(text = sprintf(\"V(net)$%s\", \"media\")))\n\n  l &lt;- do.call(layout_as_star, list(net))\n  params &lt;- list(net, layout = l, main = \"Network1\",\n      edge.color = edge.col, edge.curved = .1,\n      vertex.shape = \"circle\",\n      edge.lty = \"solid\",\n      label.family = \"Arial\",\n      vertex.label.family = \"Arial\",\n      vertex.label.dist = 3.1,\n      edge.arrow.mode = F\n  )\n  lab.locs &lt;- radian.rescale(x=1:length(label), direction=-1, start=0)\n  params$vertex.label.degree &lt;- lab.locs\n  params$vertex.label &lt;- label\n  params$vertex.color = V(net)$color\n  do.call(plot, params)\n  legend(x = -1.7, y = -1.4, unique(nodes_data[,\"type.label\"]), pch = 21,\n        col = \"#777777\", pt.bg = colrs, pt.cex = 2, cex = .8, bty = \"n\",\n        ncol = 1)\n  legend(x = -1.2, y = -1.37,\n    legend=round(sort(unique(E(net)$width)), 2), pt.cex= 0.8,\n      col='black', ncol = 3, bty = \"n\", lty = 1,\n      lwd = round(sort(unique(E(net)$width)), 2)\n  )\n  if (length(unique(V(net)$size)) &gt; 8) {\n    size_leg &lt;- sort(unique(V(net)$size))[seq(1, length(unique(V(net)$size)), 2)]\n  } else {\n    size_leg &lt;- sort(unique(V(net)$size))\n  }\n  legend(x = 0.5, y = -1.3,\n        size_leg,\n        pch = 21,\n        col = \"black\", pt.bg = \"#777777\",\n        pt.cex = size_leg / 3.8, cex = .8, bty = \"n\",\n        ncol = 3,\n        y.intersp = 3,\n        x.intersp = 2.5,\n        text.width = 0.25\n  )\n  par(mar=raw$mar)\n})\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Network (igraph)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Network (igraph)"
    ]
  },
  {
    "objectID": "Hiplot/183-volcano.html",
    "href": "Hiplot/183-volcano.html",
    "title": "Volcano",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Volcano plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/volcano?lang=en\nThe volcanogram is a visual representation of the difference in gene expression between two samples.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Volcano"
    ]
  },
  {
    "objectID": "Hiplot/183-volcano.html#setup",
    "href": "Hiplot/183-volcano.html#setup",
    "title": "Volcano",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggpubr\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggpubr\", quietly = TRUE)) {\n  install.packages(\"ggpubr\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggpubr)",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Volcano"
    ]
  },
  {
    "objectID": "Hiplot/183-volcano.html#data-preparation",
    "href": "Hiplot/183-volcano.html#data-preparation",
    "title": "Volcano",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data is the gene name and its corresponding logFC and p.value.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/volcano/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# convert data structure\n## Perform log10 transformation on the difference p (adj.P.Val column)\ndata[, \"logP\"] &lt;- -log10(as.numeric(data[, \"P.Value\"]))\ndata[, \"logFC\"] &lt;- as.numeric(data[, \"logFC\"])\n## Add a new column Group\ndata[, \"Group\"] &lt;- \"not-significant\"\n## Up and down\ndata$Group[which((data[, \"P.Value\"] &lt; 0.05) & (data$logFC &gt;= 2))] &lt;- \"Up-regulated\"\ndata$Group[which((data[, \"P.Value\"] &lt; 0.05) & (data$logFC &lt;= 2 * -1))] &lt;- \"Down-regulated\"\n## Add a new column Label\ndata[[\"Label\"]] &lt;- \"\"\n## Sort the p-values of differentially expressed genes from small to large\ndata &lt;- data[order(data[, \"P.Value\"]), ]\n## Among the highly expressed genes, select the 10 with the smallest adj.P.Val\nup_genes &lt;- head(data[, \"Symbol\"][which(data$Group == \"Up-regulated\")], 10)\ndown_genes &lt;- head(data[, \"Symbol\"][which(data$Group == \"Down-regulated\")], 10)\nnot_sig_genes &lt;- NA\n## Merge up_genes and down_genes and add them to Label\ndeg_top_genes &lt;- c(as.character(up_genes), as.character(not_sig_genes),\nas.character(down_genes))\ndeg_top_genes &lt;- deg_top_genes[!is.na(deg_top_genes)]\ndata$Label[match(deg_top_genes, data[, \"Symbol\"])] &lt;- deg_top_genes\n\n# View data\nhead(data)\n\n    Symbol     logFC  P.Value     logP           Group    Label\n1      LTB  2.580831 1.17e-14 13.93181    Up-regulated      LTB\n2    CDCA5 -2.326302 2.46e-13 12.60906  Down-regulated    CDCA5\n3 C10orf54  3.307901 3.53e-13 12.45223    Up-regulated C10orf54\n4    CAPN7  2.514235 1.04e-12 11.98297    Up-regulated    CAPN7\n5     OIP5 -2.166620 1.43e-12 11.84466  Down-regulated     OIP5\n7     PKIG -1.560504 1.58e-12 11.80134 not-significant",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Volcano"
    ]
  },
  {
    "objectID": "Hiplot/183-volcano.html#visualization",
    "href": "Hiplot/183-volcano.html#visualization",
    "title": "Volcano",
    "section": "Visualization",
    "text": "Visualization\n\n# Volcano\noptions(ggrepel.max.overlaps = 100)\np &lt;- ggscatter(data, x = \"logFC\", y = \"logP\", color = \"Group\", \n               palette = c(\"#2f5688\", \"#BBBBBB\", \"#CC0000\"), size = 1, \n               alpha = 0.5, font.label = 8, repel = TRUE, label=data$Label,\n               xlab = \"log2(Fold Change)\", ylab = \"-log10(P Value)\",\n               show.legend.text = FALSE) +\n  ggtitle(\"Volcano Plot\") +\n  geom_hline(yintercept = -log(0.05, 10), linetype = \"dashed\") +\n  geom_vline(xintercept = c(2, -2), linetype = \"dashed\") +\n  theme_bw() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Volcano\n\n\n\n\n\nThe horizontal axis is denoted by log2 (fold change), and the more different genes are distributed at both ends of the picture.The ordinate is denoted by -log10 (p.value) and is the negative log of the P value of T test significance.Blue dots represent down-regulated genes, red dots represent up-regulated genes, and gray dots represent genes that are not significantly different.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Volcano"
    ]
  },
  {
    "objectID": "Hiplot/014-bivariate.html",
    "href": "Hiplot/014-bivariate.html",
    "title": "Bivariate Chart",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Bivariate Chart plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/bivariate?lang=en\nDisplay the bivariate.",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Bivariate Chart"
    ]
  },
  {
    "objectID": "Hiplot/014-bivariate.html#setup",
    "href": "Hiplot/014-bivariate.html#setup",
    "title": "Bivariate Chart",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; GGally\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"GGally\", quietly = TRUE)) {\n  install.packages(\"GGally\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(GGally)",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Bivariate Chart"
    ]
  },
  {
    "objectID": "Hiplot/014-bivariate.html#data-preparation",
    "href": "Hiplot/014-bivariate.html#data-preparation",
    "title": "Bivariate Chart",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/bivariate/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# View data\nhead(data)\n\n  total_bill  tip gender smoker day   time size\n1      16.99 1.01 Female     No Sun Dinner    2\n2      10.34 1.66   Male     No Sun Dinner    3\n3      21.01 3.50   Male     No Sun Dinner    3\n4      23.68 3.31   Male     No Sun Dinner    2\n5      24.59 3.61 Female     No Sun Dinner    4\n6      25.29 4.71   Male     No Sun Dinner    4",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Bivariate Chart"
    ]
  },
  {
    "objectID": "Hiplot/014-bivariate.html#visualization",
    "href": "Hiplot/014-bivariate.html#visualization",
    "title": "Bivariate Chart",
    "section": "Visualization",
    "text": "Visualization\n\n# Bivariate Chart\np &lt;- ggbivariate(data, outcome = \"smoker\", \n                 explanatory = c(\"day\",\"time\",\"gender\",\"tip\")) +\n  ggtitle(\"Bivariate\") +\n  scale_fill_manual(values = c(\"#e04d39\",\"#5bbad6\")) +\n  theme_bw() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Bivariate Chart",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Bivariate Chart"
    ]
  },
  {
    "objectID": "Hiplot/172-treeheatr.html",
    "href": "Hiplot/172-treeheatr.html",
    "title": "Treeheatr",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Treeheatr plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/treeheatr?lang=en\nThe heatmap decision tree is a visualization graph that combines two types of graphs: heatmap and decision tree visualization.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Treeheatr"
    ]
  },
  {
    "objectID": "Hiplot/172-treeheatr.html#setup",
    "href": "Hiplot/172-treeheatr.html#setup",
    "title": "Treeheatr",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; treeheatr; ggplotify\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"treeheatr\", quietly = TRUE)) {\n  install.packages(\"treeheatr\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(treeheatr)\nlibrary(ggplotify)",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Treeheatr"
    ]
  },
  {
    "objectID": "Hiplot/172-treeheatr.html#data-preparation",
    "href": "Hiplot/172-treeheatr.html#data-preparation",
    "title": "Treeheatr",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe first column is the name of the species, the second column is the island, and the rest are the species characteristics.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/treeheatr/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# convert data structure\nx &lt;- data\nwrong_cols &lt;- suppressWarnings(sapply(x, function(x) {\n  if (!is.numeric(x)) {\n    sum(!is.na(as.numeric(x))) &gt; 0.7 * length(x)\n  } else {\n    FALSE\n  }\n}))\nif (any(wrong_cols)) {\n  ix &lt;- which(wrong_cols)\n  for (i in ix) {\n    data[[i]] &lt;- suppressWarnings(as.numeric(data[[i]]))\n  }\n  rm(ix)\n}\nrm(x, wrong_cols)\n\n# View data\nhead(data)\n\n  species    island culmen_length_mm culmen_depth_mm flipper_length_mm\n1  Adelie Torgersen             39.1            18.7               181\n2  Adelie Torgersen             39.5            17.4               186\n3  Adelie Torgersen             40.3            18.0               195\n4  Adelie Torgersen               NA              NA                NA\n5  Adelie Torgersen             36.7            19.3               193\n6  Adelie Torgersen             39.3            20.6               190\n  body_mass_g    sex\n1        3750   MALE\n2        3800 FEMALE\n3        3250 FEMALE\n4          NA   &lt;NA&gt;\n5        3450 FEMALE\n6        3650   MALE",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Treeheatr"
    ]
  },
  {
    "objectID": "Hiplot/172-treeheatr.html#visualization",
    "href": "Hiplot/172-treeheatr.html#visualization",
    "title": "Treeheatr",
    "section": "Visualization",
    "text": "Visualization\n\n# Treeheatr\np &lt;- as.ggplot(function() {\n  print(heat_tree(data,\n    target_lab = \"species\",\n    task = 'classification',\n    show = \"heat-tree\",\n    heat_rel_height = 0.2,\n    panel_space = 0.001,\n    clust_samps = T,\n    clust_target = T,\n    lev_fac = 1.3,\n    cont_legend = F,\n    cate_legend = F\n  ))\n})\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Treeheatr\n\n\n\n\n\nThe upper half of the figure is a decision diagram, and the lower half is a heat map.\nDecision tree: The topmost island has the greatest influence on the classification of species, and can be classified into different species according to different conditions.\nHeatmap: you can observe the changes in the amount of each species under each condition.\nLegend: For each categorical variable, different colors indicate different types; for continuous variables, the higher the value, the lighter the color, otherwise, the darker.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "Treeheatr"
    ]
  },
  {
    "objectID": "Hiplot/005-barplot-errorbar.html",
    "href": "Hiplot/005-barplot-errorbar.html",
    "title": "Barplot (errorbar)",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Barplot (errorbar) plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/barplot-errorbar?lang=en\nBar plot with error-lines and groups.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Barplot (errorbar)"
    ]
  },
  {
    "objectID": "Hiplot/005-barplot-errorbar.html#setup",
    "href": "Hiplot/005-barplot-errorbar.html#setup",
    "title": "Barplot (errorbar)",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggplot2; Rmisc; ggpubr\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"Rmisc\", quietly = TRUE)) {\n  install.packages(\"Rmisc\")\n}\nif (!requireNamespace(\"ggpubr\", quietly = TRUE)) {\n  install.packages(\"ggpubr\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggplot2)\nlibrary(Rmisc)\nlibrary(ggpubr)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Barplot (errorbar)"
    ]
  },
  {
    "objectID": "Hiplot/005-barplot-errorbar.html#data-preparation",
    "href": "Hiplot/005-barplot-errorbar.html#data-preparation",
    "title": "Barplot (errorbar)",
    "section": "Data Preparation",
    "text": "Data Preparation\nData frame:\n&lt;1st-col&gt;: (Numeric) values as Y-axis.\n&lt;2nd-col&gt;: (Numeric or String) classes as X-axis.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/barplot-errorbar/data.json\")$exampleData[[1]]$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# convert data structure\ndata[, 2] &lt;- factor(data[, 2], levels = unique(data[, 2]))\ndata_sd &lt;- summarySE(data, measurevar = colnames(data)[1], groupvars = colnames(data)[2])\n\n# View data\nhead(data_sd)\n\n    class N score       sd       se       ci\n1    math 4 63.50 3.109126 1.554563 4.947314\n2 chinese 4 73.75 2.986079 1.493039 4.751518\n3 english 4 83.25 2.362908 1.181454 3.759914",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Barplot (errorbar)"
    ]
  },
  {
    "objectID": "Hiplot/005-barplot-errorbar.html#visualization",
    "href": "Hiplot/005-barplot-errorbar.html#visualization",
    "title": "Barplot (errorbar)",
    "section": "Visualization",
    "text": "Visualization\n\n# Barplot (errorbar)\np &lt;- ggplot(data_sd, aes(x = data_sd[, 1], y = data_sd[, 3], fill = data_sd[, 1])) +\n  geom_bar(stat = \"identity\", color = \"black\", \n           position = position_dodge(), alpha = 1) +\n  geom_errorbar(aes(ymin = data_sd[, 3] - sd, ymax = data_sd[, 3] + sd),\n                width = 0.2,\n                position = position_dodge(0.9)) +\n  labs(title = \"Barplot (errorbar)\", x = colnames(data_sd)[1], \n       y = colnames(data_sd)[3], fill = colnames(data_sd)[1]) +\n  geom_jitter(data = data, aes(data[, 2], data[, 1], fill = data[, 2]), size = 2, fill = \"black\", pch = 19, width = 0.2) +\n  stat_compare_means(data = data, aes(data[, 2], data[, 1], fill = data[, 2]),\n                     label = \"p.format\", ref.group = \".all.\", vjust = 1, \n                     method = \"t.test\") +\n  scale_fill_manual(values = c(\"#E64B35FF\",\"#4DBBD5FF\",\"#00A087FF\",\"#3C5488FF\")) +\n  theme_bw() +\n  ylim(0,100) +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Barplot (errorbar)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Barplot (errorbar)"
    ]
  },
  {
    "objectID": "Hiplot/059-gantt.html",
    "href": "Hiplot/059-gantt.html",
    "title": "Gantt",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Gantt plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/gantt?lang=en\nThe Gantt chart is a type of bar chart that illustrates a project schedule.",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Gantt"
    ]
  },
  {
    "objectID": "Hiplot/059-gantt.html#setup",
    "href": "Hiplot/059-gantt.html#setup",
    "title": "Gantt",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; tidyverse; ggthemes\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"tidyverse\", quietly = TRUE)) {\n  install.packages(\"tidyverse\")\n}\nif (!requireNamespace(\"ggthemes\", quietly = TRUE)) {\n  install.packages(\"ggthemes\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(tidyverse)\nlibrary(ggthemes)",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Gantt"
    ]
  },
  {
    "objectID": "Hiplot/059-gantt.html#data-preparation",
    "href": "Hiplot/059-gantt.html#data-preparation",
    "title": "Gantt",
    "section": "Data Preparation",
    "text": "Data Preparation\nData were loaded for 4 samples (4 patients), 3 items (3 treatments), and the start and end times of each treatment.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/gantt/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\nusr_ylab &lt;- colnames(data)[1]\nif (!is.numeric(data[, 2])) {\n  data[, 2] &lt;- factor(data[, 2], levels = unique(data[, 2]))\n}\ndata_gather &lt;- gather(data, \"state\", \"date\", 3:4)\nsample &lt;- levels(data_gather$sample)\ndata_gather$sample &lt;- factor(data_gather$sample,\n  levels = rev(unique(data_gather$sample))\n)\n\n# View data\nhead(data_gather)\n\n    sample   item state date\n1 patient1 treat1 start    1\n2 patient2 treat1 start    2\n3 patient2 treat2 start    5\n4 patient2 treat3 start    7\n5 patient3 treat3 start    6\n6 patient3 treat1 start    3",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Gantt"
    ]
  },
  {
    "objectID": "Hiplot/059-gantt.html#visualization",
    "href": "Hiplot/059-gantt.html#visualization",
    "title": "Gantt",
    "section": "Visualization",
    "text": "Visualization\n\n# Gantt\np &lt;- ggplot(data_gather, aes(date, sample, color = item)) +\n  geom_line(size = 10, alpha = 1) +\n  labs(x = \"Time\", y = \"sample\", title = \"Gantt Plot\") +\n  theme(axis.ticks = element_blank()) +\n  scale_color_manual(values = c(\"#e04d39\",\"#5bbad6\",\"#1e9f86\")) +\n  theme_stata() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Gantt\n\n\n\n\n\nThe horizontal axis represents the time schedule, the vertical axis represents 4 patients, and the 3 colors represent 3 treatments. The figure can observe the time schedule of different treatments for each patient.",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "Gantt"
    ]
  },
  {
    "objectID": "Hiplot/044-diy-gsea.html",
    "href": "Hiplot/044-diy-gsea.html",
    "title": "DIY GSEA",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot DIY GSEA plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/diy-gsea?lang=en\nMake your geneset.",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "DIY GSEA"
    ]
  },
  {
    "objectID": "Hiplot/044-diy-gsea.html#setup",
    "href": "Hiplot/044-diy-gsea.html#setup",
    "title": "DIY GSEA",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; clusterProfiler\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"clusterProfiler\", quietly = TRUE)) {\n  BiocManager::install(\"clusterProfiler\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(clusterProfiler)",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "DIY GSEA"
    ]
  },
  {
    "objectID": "Hiplot/044-diy-gsea.html#data-preparation",
    "href": "Hiplot/044-diy-gsea.html#data-preparation",
    "title": "DIY GSEA",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata1 &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/diy-gsea/data.json\")$exampleData$textarea[[1]])\ndata1 &lt;- as.data.frame(data1)\ndata2 &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/diy-gsea/data.json\")$exampleData$textarea[[2]])\ndata2 &lt;- as.data.frame(data2)\n\n# convert data structure\ndata1[,2] &lt;- as.numeric(data1[,2])\ngeneList &lt;- data1[,2]\nnames(geneList) &lt;- data1[,1]\ngeneList &lt;- sort(geneList, decreasing = TRUE)\nterm &lt;- data.frame(term=data2[,1], gene=data2[,2])\n\n# View data\nhead(term)\n\n                         term   gene\n1 GO_ADAPTIVE_IMMUNE_RESPONSE ADAM17\n2 GO_ADAPTIVE_IMMUNE_RESPONSE  AICDA\n3 GO_ADAPTIVE_IMMUNE_RESPONSE  ALCAM\n4 GO_ADAPTIVE_IMMUNE_RESPONSE  ANXA1\n5 GO_ADAPTIVE_IMMUNE_RESPONSE   BATF\n6 GO_ADAPTIVE_IMMUNE_RESPONSE  BCL10",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "DIY GSEA"
    ]
  },
  {
    "objectID": "Hiplot/044-diy-gsea.html#visualization",
    "href": "Hiplot/044-diy-gsea.html#visualization",
    "title": "DIY GSEA",
    "section": "Visualization",
    "text": "Visualization\n\n# DIY GSEA\ny &lt;- clusterProfiler::GSEA(geneList, TERM2GENE = term, pvalueCutoff = 1)\np &lt;- gseaplot(\n  y,\n  y@result$Description[1],\n  color = \"#000000\",\n  by = \"runningScore\",\n  color.line = \"#4CAF50\",\n  color.vline= \"#FA5860\",\n  title = \"DIY GSEA Plot\",\n  )\n\np\n\n\n\n\n\n\n\nFigureÂ 1: DIY GSEA",
    "crumbs": [
      "<i class='fa-solid fa-dna'></i> OMICS",
      "DIY GSEA"
    ]
  },
  {
    "objectID": "Hiplot/073-ggscatterstats.html",
    "href": "Hiplot/073-ggscatterstats.html",
    "title": "Scatterstats",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Scatterstats plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/ggscatterstats?lang=en",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Scatterstats"
    ]
  },
  {
    "objectID": "Hiplot/073-ggscatterstats.html#setup",
    "href": "Hiplot/073-ggscatterstats.html#setup",
    "title": "Scatterstats",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggpubr; ggthemes\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggstatsplot\", quietly = TRUE)) {\n  install.packages(\"ggstatsplot\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggstatsplot)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Scatterstats"
    ]
  },
  {
    "objectID": "Hiplot/073-ggscatterstats.html#data-preparation",
    "href": "Hiplot/073-ggscatterstats.html#data-preparation",
    "title": "Scatterstats",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/ggscatterstats/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# View data\nhead(data)\n\n                                                                 title year\n1                       Lord of the Rings: The Return of the King, The 2003\n2                   Lord of the Rings: The Fellowship of the Ring, The 2001\n3                               Lord of the Rings: The Two Towers, The 2002\n4                                                            Star Wars 1977\n5                       Star Wars: Episode V - The Empire Strikes Back 1980\n6 Dr. Strangelove or: How I Learned to Stop Worrying and Love the Bomb 1964\n  length budget rating  votes  mpaa  genre\n1    251   94.0    9.0 103631 PG-13 Action\n2    208   93.0    8.8 157608 PG-13 Action\n3    223   94.0    8.8 114797 PG-13 Action\n4    125   11.0    8.8 134640    PG Action\n5    129   18.0    8.8 103706    PG Action\n6     93    1.8    8.7  63471    PG Comedy",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Scatterstats"
    ]
  },
  {
    "objectID": "Hiplot/073-ggscatterstats.html#visualization",
    "href": "Hiplot/073-ggscatterstats.html#visualization",
    "title": "Scatterstats",
    "section": "Visualization",
    "text": "Visualization\n\n# Scatterstats\np &lt;- ggscatterstats(\n  data = data, x = rating, y = budget\n)\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Scatterstats",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Scatterstats"
    ]
  },
  {
    "objectID": "Hiplot/039-density-histogram.html",
    "href": "Hiplot/039-density-histogram.html",
    "title": "Density-Histogram",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Density-Histogram plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/density-histogram?lang=en\nUse density plots or histograms to show data distribution.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Density-Histogram"
    ]
  },
  {
    "objectID": "Hiplot/039-density-histogram.html#setup",
    "href": "Hiplot/039-density-histogram.html#setup",
    "title": "Density-Histogram",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; grafify; dplyr\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"grafify\", quietly = TRUE)) {\n  install.packages(\"grafify\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(grafify)\nlibrary(dplyr)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Density-Histogram"
    ]
  },
  {
    "objectID": "Hiplot/039-density-histogram.html#data-preparation",
    "href": "Hiplot/039-density-histogram.html#data-preparation",
    "title": "Density-Histogram",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/density-histogram/data.json\")$exampleData[[1]]$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# convert data structure\ny &lt;- \"Doubling_time\"\ngroup &lt;- \"Student\"\ndata[, group] &lt;- factor(data[, group], levels = unique(data[, group]))\ndata &lt;- data %&gt;% \n  mutate(median = median(get(y), na.rm = TRUE),\n         mean = mean(get(y), na.rm = TRUE))\n\n# View data\nhead(data)\n\n  Experiment Student Doubling_time facet   median     mean\n1       Exp1       A      17.36765    F1 20.18114 19.91642\n2       Exp1       B      18.04119    F1 20.18114 19.91642\n3       Exp1       C      18.70120    F1 20.18114 19.91642\n4       Exp1       D      20.06762    F1 20.18114 19.91642\n5       Exp1       E      20.19807    F2 20.18114 19.91642\n6       Exp1       F      22.11908    F2 20.18114 19.91642",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Density-Histogram"
    ]
  },
  {
    "objectID": "Hiplot/039-density-histogram.html#visualization",
    "href": "Hiplot/039-density-histogram.html#visualization",
    "title": "Density-Histogram",
    "section": "Visualization",
    "text": "Visualization\n\n1. Density Plot\n\n# Density Plot\np &lt;- plot_density(\n  data = data, \n  ycol = get(y), \n  group = get(group),\n  linethick = 0.5,\n  c_alpha = 0.6) + \n  ggtitle(\"Density Plot\") + \n  geom_vline(aes_string(xintercept = \"median\"),\n        colour = 'black', linetype = 2, size = 0.5) + \n  xlab(y) + \n  ylab(\"density\") + \n  guides(fill = guide_legend(title = group), color = FALSE) +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"bottom\",\n        legend.direction = \"horizontal\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Density Plot\n\n\n\n\n\n\n\n2. Histogram Plot\n\n# Histogram Plot\np &lt;- plot_histogram(\n  data = data, \n  ycol = get(y), \n  group = get(group),\n  linethick = 0.5,\n  BinSize = 30)  + \n  ggtitle(\"Histogram Plot\") + \n  geom_vline(aes_string(xintercept = \"median\"),\n        colour = 'black', linetype = 2, size = 0.5) + \n  xlab(y) + \n  ylab(\"density\") + \n  guides(fill = guide_legend(title = group), color = FALSE) +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"bottom\",\n        legend.direction = \"horizontal\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n\np\n\n\n\n\n\n\n\nFigureÂ 2: Histogram Plot",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Density-Histogram"
    ]
  },
  {
    "objectID": "Hiplot/000-test-demo.html",
    "href": "Hiplot/000-test-demo.html",
    "title": "ggplot2 demo",
    "section": "",
    "text": "Code\n# Installing necessary packages\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}"
  },
  {
    "objectID": "Hiplot/000-test-demo.html#air-quality",
    "href": "Hiplot/000-test-demo.html#air-quality",
    "title": "ggplot2 demo",
    "section": "Air Quality",
    "text": "Air Quality\nFigureÂ 1 further explores the impact of temperature on ozone level.\n\n\nCode\nlibrary(ggplot2)\n\nggplot(airquality, aes(Temp, Ozone)) + \n  geom_point() + \n  geom_smooth(method = \"loess\")\n\n\n\n\n\n\n\n\nFigureÂ 1: Temperature and ozone level."
  },
  {
    "objectID": "Hiplot/159-scatter-3d.html",
    "href": "Hiplot/159-scatter-3d.html",
    "title": "3D-Scatter",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot 3D-Scatter plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/scatter-3d?lang=en\n3D scatter plot is to apply a number of quantitative variables to different coaxes in space and combine different variables into coordinates in space, so as to clearly explain the interaction between the three quantitative variables.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "3D-Scatter"
    ]
  },
  {
    "objectID": "Hiplot/159-scatter-3d.html#setup",
    "href": "Hiplot/159-scatter-3d.html#setup",
    "title": "3D-Scatter",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; plot3D; ggplotify\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"plot3D\", quietly = TRUE)) {\n  install.packages(\"plot3D\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(plot3D)\nlibrary(ggplotify)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "3D-Scatter"
    ]
  },
  {
    "objectID": "Hiplot/159-scatter-3d.html#data-preparation",
    "href": "Hiplot/159-scatter-3d.html#data-preparation",
    "title": "3D-Scatter",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data are three variables and grouping.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/scatter-3d/data.json\")$exampleData[[1]]$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\ncol_idx &lt;- which(colnames(data) == \"group\")\ndata[, col_idx] &lt;- as.factor(data[, col_idx])\nshapes &lt;- 19\nshape_idx &lt;- \"\"\n\n# View data\nhead(data)\n\n      temp    pressure dtime group\n1 41.11057  0.49351190     1    G1\n2 35.23429  0.76636476     2    G1\n3 26.58407  0.63885937     3    G1\n4 34.76097 -0.08106332     4    G1\n5 25.76521 -0.31731579     5    G1\n6 20.30115 -1.91132873     6    G1",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "3D-Scatter"
    ]
  },
  {
    "objectID": "Hiplot/159-scatter-3d.html#visualization",
    "href": "Hiplot/159-scatter-3d.html#visualization",
    "title": "3D-Scatter",
    "section": "Visualization",
    "text": "Visualization\n\n# 3D-Scatter\np &lt;- as.ggplot(function() {\n  plot3d &lt;- scatter3D(data[, 1], data[, 2], data[, 3],\n    pch = shapes, cex = 1,\n    phi = 0, theta = 45, ticktype = \"detailed\",\n    bty = \"b2\", colkey = FALSE, alpha = 1,\n    xlab = colnames(data)[1], ylab = colnames(data)[2],\n    zlab = colnames(data)[3],\n    main = \"3D-Scatter Plot\",\n    colvar = as.numeric(as.factor(data[, 4])),\n    col = c(\"#e04d39\",\"#5bbad6\",\"#1e9f86\")\n  )\n  \n  legend(\"right\", pch=19, legend = levels(data[, col_idx]),\n         cex = 1.1, bty = 'n', xjust = 0.5, horiz = F,\n         title = colnames(data)[col_idx],\n         col = c(\"#e04d39\",\"#5bbad6\",\"#1e9f86\"))\n})\n\np\n\n\n\n\n\n\n\nFigureÂ 1: 3D-Scatter\n\n\n\n\n\nIn the figure, temperature, pressure and time are respectively placed on x (horizontal axis), Y (vertical axis) and Z (perspective axis) to generate a THREE-DIMENSIONAL scatter plot, and the correlation between variables and their correlation degree can be intuitively found.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "3D-Scatter"
    ]
  },
  {
    "objectID": "Hiplot/043-diverging-scale.html",
    "href": "Hiplot/043-diverging-scale.html",
    "title": "Diverging Scale",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Diverging Scale plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/diverging-scale?lang=en\nThe diverging scale is a graph that maps a continuous, quantitative input to a continuous fixed interpolator.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Diverging Scale"
    ]
  },
  {
    "objectID": "Hiplot/043-diverging-scale.html#setup",
    "href": "Hiplot/043-diverging-scale.html#setup",
    "title": "Diverging Scale",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggcharts\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggcharts\", quietly = TRUE)) {\n  install.packages(\"ggcharts\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggcharts)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Diverging Scale"
    ]
  },
  {
    "objectID": "Hiplot/043-diverging-scale.html#data-preparation",
    "href": "Hiplot/043-diverging-scale.html#data-preparation",
    "title": "Diverging Scale",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe first column is a list of model names, and the remaining columns enter the relevant indicators and corresponding values.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/diverging-scale/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# convert data structure\ndata &lt;- dplyr::transmute(.data = data, x = model, y = scale(hp))\n\n# View data\nhead(data)\n\n                  x          y\n1         Mazda RX4 -0.6130929\n2     Mazda RX4 Wag -0.6130929\n3        Datsun 710 -0.9123057\n4    Hornet 4 Drive -0.6130929\n5 Hornet Sportabout  0.5309561\n6           Valiant -0.7010967",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Diverging Scale"
    ]
  },
  {
    "objectID": "Hiplot/043-diverging-scale.html#visualization",
    "href": "Hiplot/043-diverging-scale.html#visualization",
    "title": "Diverging Scale",
    "section": "Visualization",
    "text": "Visualization\n\n1.Barplot\n\n# Diverging Scale Barplot\nfill_colors &lt;- c(\"#C20B01\", \"#196ABD\")\nfill_colors &lt;- fill_colors[c(any(data[, \"y\"] &gt; 0), any(data[, \"y\"] &lt; 0))]\np &lt;- diverging_bar_chart(data = data, x = x, y = y, bar_colors = fill_colors,\n                         text_color = '#000000') + \n  theme(axis.text.x = element_text(color = \"#000000\"),\n        axis.title.x = element_text(colour = \"#000000\"),\n        axis.title.y = element_text(colour = \"#000000\"),\n        plot.background = element_blank()) + \n  labs(x = \"model\", y = \"scale(hp)\", title = \"\")\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Diverging Scale Barplot\n\n\n\n\n\nHp data is shown on the horizontal axis, model names (classification) are shown on the vertical axis, models above average are shown in red, and models below average are shown in blue. Data is assigned on a scale of 2 by size.\n\n\n2.Lollipop Plot\n\n# Diverging Scale Lollipop Plot\nfill_colors &lt;- c(\"#C20B01\", \"#196ABD\")\nfill_colors &lt;- fill_colors[c(any(data[, \"y\"] &gt; 0), any(data[, \"y\"] &lt; 0))]\np &lt;- diverging_lollipop_chart(\n  data = data, x = x, y = y, lollipop_colors = fill_colors,\n  line_size = 0.3, point_size = 1.9, text_color = '#000000') + \n  theme(axis.text.x = element_text(color = \"#000000\"),\n        axis.title.x = element_text(colour = \"#000000\"),\n        axis.title.y = element_text(colour = \"#000000\"),\n        plot.background = element_blank()) + \n  labs(x = \"model\", y = \"scale(hp)\", title = \"\")\n\np\n\n\n\n\n\n\n\nFigureÂ 2: Diverging Scale Lollipop Plot",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Diverging Scale"
    ]
  },
  {
    "objectID": "Hiplot/151-rcs-cox.html",
    "href": "Hiplot/151-rcs-cox.html",
    "title": "RCS-COX",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot RCS-COX plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/rcs-cox?lang=en\nNonlinear regression analysis.",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "RCS-COX"
    ]
  },
  {
    "objectID": "Hiplot/151-rcs-cox.html#setup",
    "href": "Hiplot/151-rcs-cox.html#setup",
    "title": "RCS-COX",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; rms; survival; ggplot2; stringr\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"rms\", quietly = TRUE)) {\n  install.packages(\"rms\")\n}\nif (!requireNamespace(\"survival\", quietly = TRUE)) {\n  install.packages(\"survival\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"stringr\", quietly = TRUE)) {\n  install.packages(\"stringr\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(rms)\nlibrary(survival)\nlibrary(ggplot2)\nlibrary(stringr)",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "RCS-COX"
    ]
  },
  {
    "objectID": "Hiplot/151-rcs-cox.html#data-preparation",
    "href": "Hiplot/151-rcs-cox.html#data-preparation",
    "title": "RCS-COX",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/rcs-cox/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\ndata &lt;- na.omit(data)\nex &lt;- set::not(colnames(data), c(\"main\", \"time\", \"event\"))\nex &lt;- str_c(ex, collapse = \"+\")\ndd &lt;&lt;- datadist(data)\noptions(datadist = \"dd\")\nfor (i in 3:5) {\n  fit &lt;- coxph(as.formula(paste0(\"Surv(time, event) ~ rcs(main, nk = i, inclx = T)+\", ex, collapse = \"+\")), data = data, x = TRUE)\n  tmp &lt;- extractAIC(fit)\n  if (i == 3) {\n    AIC &lt;- tmp[2]\n    nk &lt;&lt;- 3\n  }\n  if (tmp[2] &lt; AIC) {\n    AIC &lt;- tmp[2]\n    nk &lt;&lt;- i\n  }\n}\nfit &lt;- cph(as.formula(paste0(\"Surv(time, event) ~ rcs(main, nk = nk, inclx = T)+\", ex, collapse = \"+\")), data = data, x = TRUE)\ndd$limits$main[2] &lt;- median(data$main)\nfit &lt;- update(fit)\norr &lt;- Predict(fit, main, fun = exp, ref.zero = TRUE)\n\n# View data\nhead(data)\n\n      main x1 x2 time event\n1 25.54051  1  1 2178     0\n2 24.02398  1  2 2172     0\n3 22.14290  1  3 2190     0\n4 26.63187  1  4  297     1\n5 24.41255  1  5 2131     0\n6 23.24236  1  6    1     1",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "RCS-COX"
    ]
  },
  {
    "objectID": "Hiplot/151-rcs-cox.html#visualization",
    "href": "Hiplot/151-rcs-cox.html#visualization",
    "title": "RCS-COX",
    "section": "Visualization",
    "text": "Visualization\n\n# RCS-COX\np &lt;- ggplot() +\n  geom_line(data = orr, aes(main, yhat), linetype = \"solid\", size = 1, alpha = 1,\n            colour = \"#FF0000\") +\n  geom_ribbon(data = orr, aes(main, ymin = lower, ymax = upper), alpha = 0.6, \n              fill = \"#FFC0CB\") +\n  geom_hline(yintercept = 1, linetype = 2, size = 0.5) +\n  geom_vline(xintercept = dd$limits$main[2], linetype = 2, size = 0.5) +\n  labs(x = \" \", y = \"Hazard Ratio(95%CI)\") +\n  theme_bw() +\n  theme(text = element_text(family = \"Arial\"),\n        plot.title = element_text(size = 12,hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        axis.text.x = element_text(angle = 0, hjust = 0.5,vjust = 1),\n        legend.position = \"right\",\n        legend.direction = \"vertical\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10))\n \np\n\n\n\n\n\n\n\nFigureÂ 1: RCS-COX",
    "crumbs": [
      "<i class='fa-solid fa-stethoscope'></i> CLINICS",
      "RCS-COX"
    ]
  },
  {
    "objectID": "Hiplot/067-gghistostats.html",
    "href": "Hiplot/067-gghistostats.html",
    "title": "Histostats",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Histostats plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/gghistostats?lang=en\nDisplay data distribution and inference.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Histostats"
    ]
  },
  {
    "objectID": "Hiplot/067-gghistostats.html#setup",
    "href": "Hiplot/067-gghistostats.html#setup",
    "title": "Histostats",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; ggstatsplot\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"ggstatsplot\", quietly = TRUE)) {\n  install.packages(\"ggstatsplot\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(ggstatsplot)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Histostats"
    ]
  },
  {
    "objectID": "Hiplot/067-gghistostats.html#data-preparation",
    "href": "Hiplot/067-gghistostats.html#data-preparation",
    "title": "Histostats",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/gghistostats/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# Convert data structure\naxis &lt;- c(\"budget\", \"genre\")\ndata[, axis[2]] &lt;- factor(data[, axis[2]], levels = unique(data[, axis[2]]))\n\n# View data\nhead(data)\n\n                                                                 title year\n1                       Lord of the Rings: The Return of the King, The 2003\n2                   Lord of the Rings: The Fellowship of the Ring, The 2001\n3                               Lord of the Rings: The Two Towers, The 2002\n4                                                            Star Wars 1977\n5                       Star Wars: Episode V - The Empire Strikes Back 1980\n6 Dr. Strangelove or: How I Learned to Stop Worrying and Love the Bomb 1964\n  length budget rating  votes  mpaa  genre\n1    251   94.0    9.0 103631 PG-13 Action\n2    208   93.0    8.8 157608 PG-13 Action\n3    223   94.0    8.8 114797 PG-13 Action\n4    125   11.0    8.8 134640    PG Action\n5    129   18.0    8.8 103706    PG Action\n6     93    1.8    8.7  63471    PG Comedy",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Histostats"
    ]
  },
  {
    "objectID": "Hiplot/067-gghistostats.html#visualization",
    "href": "Hiplot/067-gghistostats.html#visualization",
    "title": "Histostats",
    "section": "Visualization",
    "text": "Visualization\n\n# Histostats\np &lt;- grouped_gghistostats(\n  data = data, x = budget, grouping.var = genre,\n  effsize.type = \"unbiased\",\n  type = \"parametric\",\n  centrality.k = 2,\n  plotgrid.args = list(ncol = 2),\n  centrality.parameter = \"solid\",\n  centrality.line.args = list(size = 1, color = \"black\"),\n  bar.fill = \"#0D47A1\", \n  centrality.label.args = list(color = \"#0D47A1\", size = 3),\n  test.value = as.numeric(0),\n  normal.curve = F,\n  normal.curve.args = list(size = 1)\n)\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Histostats",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Histostats"
    ]
  },
  {
    "objectID": "Hiplot/054-fan.html",
    "href": "Hiplot/054-fan.html",
    "title": "Fan Plot",
    "section": "",
    "text": "Note\n\n\n\nHiplot website\nThis page is the tutorial for source code version of the Hiplot Fan Plot plugin. You can also use the Hiplot website to achieve no code ploting. For more information please see the following link:\nhttps://hiplot.cn/basic/fan?lang=en\nThe pie chart is a statistical chart designed to clearly show the percentage of each data group by the size of the pie.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Fan Plot"
    ]
  },
  {
    "objectID": "Hiplot/054-fan.html#setup",
    "href": "Hiplot/054-fan.html#setup",
    "title": "Fan Plot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: data.table; jsonlite; plotrix; ggplotify\n\n\n# Install packages\nif (!requireNamespace(\"data.table\", quietly = TRUE)) {\n  install.packages(\"data.table\")\n}\nif (!requireNamespace(\"jsonlite\", quietly = TRUE)) {\n  install.packages(\"jsonlite\")\n}\nif (!requireNamespace(\"plotrix\", quietly = TRUE)) {\n  install.packages(\"plotrix\")\n}\nif (!requireNamespace(\"ggplotify\", quietly = TRUE)) {\n  install.packages(\"ggplotify\")\n}\n\n# Load packages\nlibrary(data.table)\nlibrary(jsonlite)\nlibrary(plotrix)\nlibrary(ggplotify)",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Fan Plot"
    ]
  },
  {
    "objectID": "Hiplot/054-fan.html#data-preparation",
    "href": "Hiplot/054-fan.html#data-preparation",
    "title": "Fan Plot",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe loaded data are different groups and their data.\n\n# Load data\ndata &lt;- data.table::fread(jsonlite::read_json(\"https://hiplot.cn/ui/basic/fan/data.json\")$exampleData$textarea[[1]])\ndata &lt;- as.data.frame(data)\n\n# View data\nhead(data)\n\n   group value\n1 Group1    13\n2 Group2    34\n3 Group3    21\n4 Group4    43",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Fan Plot"
    ]
  },
  {
    "objectID": "Hiplot/054-fan.html#visualization",
    "href": "Hiplot/054-fan.html#visualization",
    "title": "Fan Plot",
    "section": "Visualization",
    "text": "Visualization\n\n# Fan Plot\np &lt;- as.ggplot(function() {\n  fan.plot(data[, 2], main = \"\", labels = as.character(data[, 1]),\n           col = c(\"#E64B35FF\",\"#4DBBD5FF\",\"#00A087FF\",\"#3C5488FF\"))\n  })\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Fan Plot\n\n\n\n\n\nDifferent colors represent different groups and different areas represent data and proportion.",
    "crumbs": [
      "<i class='fa-solid fa-atom'></i> BASICS",
      "Fan Plot"
    ]
  },
  {
    "objectID": "Proportion/ArcDiagram.html",
    "href": "Proportion/ArcDiagram.html",
    "title": "Arc Diagram",
    "section": "",
    "text": "The arc diagram is a diagram connected by arcs, showing the relationships between nodes.",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Arc Diagram"
    ]
  },
  {
    "objectID": "Proportion/ArcDiagram.html#example",
    "href": "Proportion/ArcDiagram.html#example",
    "title": "Arc Diagram",
    "section": "Example",
    "text": "Example\n\n\n\n\n\nThe figure shows a simple arc diagram. The nodes are neatly arranged at the bottom of the diagram and connected by arcs, forming the main body of the arc diagram.",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Arc Diagram"
    ]
  },
  {
    "objectID": "Proportion/ArcDiagram.html#setup",
    "href": "Proportion/ArcDiagram.html#setup",
    "title": "Arc Diagram",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming Language: R\nDependencies: ggraph, tidyverse, viridis, patchwork, igraph, colormap\n\n\n# Install packages\nif (!requireNamespace(\"tidyverse\", quietly = TRUE)) {\n  install.packages(\"tidyverse\")\n}\nif (!requireNamespace(\"viridis\", quietly = TRUE)) {\n  install.packages(\"viridis\")\n}\nif (!requireNamespace(\"patchwork\", quietly = TRUE)) {\n  install.packages(\"patchwork\")\n}\nif (!requireNamespace(\"igraph\", quietly = TRUE)) {\n  install.packages(\"igraph\")\n}\nif (!requireNamespace(\"ggraph\", quietly = TRUE)) {\n  install.packages(\"ggraph\")\n}\nif (!requireNamespace(\"colormap\", quietly = TRUE)) {\n  install.packages(\"colormap\")\n}\n\n# Load packages\nlibrary(tidyverse) \nlibrary(viridis)   \nlibrary(patchwork) \nlibrary(igraph)    \nlibrary(ggraph)    \nlibrary(colormap)",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Arc Diagram"
    ]
  },
  {
    "objectID": "Proportion/ArcDiagram.html#data-preparation",
    "href": "Proportion/ArcDiagram.html#data-preparation",
    "title": "Arc Diagram",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe data includes custom data, co-authored networks of researchers, and PPI network data exported by Cytoscape software.\n\n# 1.Custom data\n# `links` stores edge information, and `nodes` stores node information and node grouping information.\nlinks &lt;- data.frame(\nsource = c(\"A\", \"A\", \"A\", \"A\", \"B\", \"G\", \"G\", \"G\", \"G\"),\n  target = c(\"B\", \"C\", \"D\", \"F\", \"E\", \"H\", \"I\", \"J\", \"F\")\n)\nnodes &lt;- data.frame(\n  point = c(\"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\", \"I\", \"J\"),\n  groups = c(\n    \"group-one\", \"group-one\", \"group-one\", \"group-one\", \"group-one\",\n    \"group-one\", \"group-two\", \"group-two\", \"group-two\", \"group-two\"\n  )\n)\n\nhead(links)\n\n  source target\n1      A      B\n2      A      C\n3      A      D\n4      A      F\n5      B      E\n6      G      H\n\nhead(nodes)\n\n  point    groups\n1     A group-one\n2     B group-one\n3     C group-one\n4     D group-one\n5     E group-one\n6     F group-one\n\n# 2.Researchers co-authored network\n# Copy the link information to a txt file, read it, and draw the plot.\ndata_dif &lt;- read.csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/Arc.txt\", header = T, sep = \" \")\n\nhead(data_dif[,1:5])\n\n          from A.Bateman A.Besnard A.Breil A.Cenci\n1     A Armero        NA        NA       1      NA\n2    A Bateman        NA        NA      NA      NA\n3    A Besnard        NA        NA      NA      NA\n4      A Breil        NA        NA      NA      NA\n5      A Cenci        NA        NA      NA      NA\n6 A Chifolleau        NA        NA      NA      NA\n\n# 3.PPI network node and edge data\n# Read PPI network information downloaded from GitHub\ndata_ppi &lt;- read.csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/string_interactions_short.tsv_1%20default%20edge.csv\", header = TRUE)\n\nhead(data_ppi[,c(9,3)])\n\n                           name combined_score\n1   ABCB4 (interacts with) CFTR          0.458\n2 ABCB4 (interacts with) CREBBP          0.440\n3  ABCB4 (interacts with) ABCC8          0.410\n4   ABCB5 (interacts with) CFTR          0.415\n5  ABCB5 (interacts with) ABCC8          0.436\n6  ABCB5 (interacts with) PROM1          0.786",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Arc Diagram"
    ]
  },
  {
    "objectID": "Proportion/ArcDiagram.html#basic-arc-diagram",
    "href": "Proportion/ArcDiagram.html#basic-arc-diagram",
    "title": "Arc Diagram",
    "section": "Basic arc diagram",
    "text": "Basic arc diagram\n\n1. Basic arc diagram\n\n# Basic arc diagram\nmygraph &lt;- graph_from_data_frame(links, vertices = nodes) # Generate graph structure\n\np &lt;- ggraph(mygraph, layout = \"linear\") +\n  geom_edge_arc(edge_colour = \"black\", edge_alpha = 0.3, edge_width = 0.4) +\n  geom_node_point(color = \"grey\", size = 5) +\n  geom_node_text(aes(label = name), repel = FALSE, size = 6, nudge_y = -0.15) +\n  theme_void() +\n  theme(\n    legend.position = \"none\",\n    plot.margin = unit(rep(2, 4), \"cm\")\n  )\n\np\n\n\n\n\nBasic arc diagram\n\n\n\n\nThe figure shows the drawing of a basic arc diagram. It has few nodes and edges, so the structure of the arc diagram is simple.\n\n\n2. Map group information to node colors\n\n# Map group information to node colors\nmygraph &lt;- graph_from_data_frame(links, vertices = nodes) # Generated graph\np &lt;- ggraph(mygraph, layout = \"linear\") +\n  geom_edge_arc(edge_colour = \"black\", edge_alpha = 0.3, edge_width = 0.4) +\n  geom_node_point(aes(color = groups), size = 5) +\n  geom_node_text(aes(label = name), repel = FALSE, size = 6, nudge_y = -0.15) +\n  theme_void() +\n  theme(\n    legend.position = \"none\",\n    plot.margin = unit(rep(2, 4), \"cm\")\n  )\np\n\n\n\n\nMap group information to node colors\n\n\n\n\nAs shown in the figure, color = groups maps grouping information to the color of the nodes, which can be seen intuitively in the arc diagram.\n\n\n3. Drawing complex graph structures\nTypical raw data often contains many nodes and edges, resulting in complex graph structures. When plotting, nodes need to be categorized and sorted, and the size of nodes and edges needs to be measured to display an aesthetically pleasing arc graph. This study uses co-authored network data from researchers.\n\n# Co-authored Network Data Processing and Graphics\n# 1.Data layout transformation\nconnect &lt;- data_dif %&gt;% # connect stores the edge information of the nodes.\n  gather(key = \"to\", value = \"value\", -1) %&gt;% # Use this method to convert the data excluding the first column into two columns (one column for column names and one column for values).\n  mutate(to = gsub(\"\\\\.\", \" \", to)) %&gt;% # Change the column name format from \"to\" to be consistent with \"from\".\n  na.omit() # Remove NA value\n\n# 2.Node statistics\ncoauth &lt;- # coauth stores node names and in/out degree information; grouping information will be added later.\n  c(as.character(connect$from), as.character(connect$to)) %&gt;%\n  as.tibble() %&gt;% # Similar to a data frame type, column names default to \"value\" â€”\n  group_by(value) %&gt;% # Group by \"value\"\n  summarize(n = n()) # Count the in-degree and out-degree of node names\ncolnames(coauth) &lt;- c(\"name\", \"n\") # Change column name\n\n# 3.Grouping nodes\nmygraph &lt;- graph_from_data_frame(connect, vertices = coauth, directed = FALSE) # Generate a graph\ncom &lt;- walktrap.community(mygraph) # Grouping based on the path size of the nodesâ€”â€”â€”â€”\n# Add group information to Coauth\ncoauth &lt;- coauth %&gt;%\n  mutate(grp = com$membership) %&gt;% # Add Groups\n  arrange(grp) %&gt;% # Sort by group\n  mutate(name = factor(name, name))\n\n# 4.Select the top 15 groups\ncoauth &lt;- coauth[coauth$grp &lt; 16, ]\n# Filter connections that appear only in the first 15 sets of points.\nconnect &lt;- connect %&gt;%\n  filter(from %in% coauth$name) %&gt;%\n  filter(to %in% coauth$name)\n\n# 5.Generate a graph\nmygraph &lt;- graph_from_data_frame(connect, vertices = coauth, directed = FALSE)\n# Generate colors by group\nmycolor &lt;- colormap(colormap = colormaps$viridis, nshades = max(coauth$grp))\nmycolor &lt;- sample(mycolor, length(mycolor))\n# ggraph drawing\nggraph(mygraph, layout = \"linear\") +\n  geom_edge_arc(edge_colour = \"black\", edge_alpha = 0.2, edge_width = 0.3, fold = TRUE) +\n  geom_node_point(aes(size = n, color = as.factor(grp), fill = grp), alpha = 0.5) + # Map n and the grouping variable to size and color.\n  scale_size_continuous(range = c(0.5, 8)) + # Set size range\n  scale_color_manual(values = mycolor) + # Set the group color\n  geom_node_text(aes(label = name), angle = 65, hjust = 1, nudge_y = -1.1, size = 2.3) + # Set node labels and skew them to avoid overlap.\n  theme_void() + # Remove background table, axis theme\n  theme(\n    legend.position = \"none\", # Remove legend\n    plot.margin = unit(c(0, 0, 0.4, 0), \"null\"),\n    panel.spacing = unit(c(0, 0, 3.4, 0), \"null\")\n  ) +\n  expand_limits(x = c(-1.2, 1.2), y = c(-5.6, 1.2))\n\n\n\n\nDrawing complex graph structures\n\n\n\n\nThe figure shows an arc diagram drawn based on a complex graph structure. Drawing an arc diagram (or graph in general) requires preprocessing the data into two data frames, one containing node information and the other containing edge information. The data processing steps in this case are as follows:\n\nModify the data layout to generate edge information (stored via connect);\nExtract all node information based on the edge information (stored via coauth);\nGroup nodes according to walktrap.community(). Grouping features can be mapped to node colors to display different groups. For aesthetic purposes, sort the grouped nodes;\nSelect only the preceding groups, and filter the nodes in the preceding connect groups;\nGenerate the graph and use ggraph() to plot it, selecting colors.\n\nPlotting complex data without grouping or sorting (for comparison)\n\n# No grouping or sorting (comparison)\n# 1.Data layout transformation\nconnect &lt;- data_dif %&gt;% # connect stores the edge information of the nodes.\n  gather(key = \"to\", value = \"value\", -1) %&gt;% # Use this method to convert the data excluding the first column into two columns (one column for column names and one column for values).\n  mutate(to = gsub(\"\\\\.\", \" \", to)) %&gt;% # Change the column name format from \"to\" to be consistent with \"from\".\n  na.omit() # Remove NA value\n\n# 2.Node statistics\ncoauth &lt;- # coauth stores node names and in/out degree information; grouping information will be added later.\n  c(as.character(connect$from), as.character(connect$to)) %&gt;%\n  as.tibble() %&gt;% # Similar to a data frame type, column names default to \"value\" â€”\n  group_by(value) %&gt;% # Group by \"value\"\n  summarize(n = n()) # Count the in-degree and out-degree of node names\ncolnames(coauth) &lt;- c(\"name\", \"n\") # Change column name\n\n# 5.Generate a graph\nmygraph &lt;- graph_from_data_frame(connect, vertices = coauth, directed = FALSE)\n# ggraph drawing\nggraph(mygraph, layout = \"linear\") +\n  geom_edge_arc(edge_colour = \"black\", edge_alpha = 0.2, edge_width = 0.3, fold = TRUE) +\n  geom_node_point(aes(size = n), alpha = 0.5) + # Map n and the grouping variable to size and color.\n  scale_size_continuous(range = c(0.5, 8)) + # Set size range\n  geom_node_text(aes(label = name), angle = 65, hjust = 1, nudge_y = -1.1, size = 2.3) + # Set node labels and skew them to avoid overlap.\n  theme_void() + # Remove background table, axis theme\n  theme(\n    legend.position = \"none\", # Remove legend\n    plot.margin = unit(c(0, 0, 0.4, 0), \"null\"),\n    panel.spacing = unit(c(0, 0, 3.4, 0), \"null\")\n  ) +\n  expand_limits(x = c(-1.2, 1.2), y = c(-5.6, 1.2))\n\n\n\n\nPlotting complex data without grouping or sorting (for comparison)\n\n\n\n\nThe image shows an arc graph drawn from complex graph data without grouping and sorting. As you can see, the nodes and arcs are very disorganized, and the content of the arc graph is uninterpretable. Therefore, when drawing arc graphs from complex graph data, it is essential to group and sort the nodes and use color mapping to categorize different points.\n\n\n4. The thickness of the arc is defined according to the edge weight.\nSometimes the edges of a graph are assigned weights, which can be mapped to the thickness of an arc.\n\n# 1.Edge information is extracted from the PPI data table, and the combined score value is used as the weight.\ndata_ppi &lt;- data_ppi[, c(9, 3)] # Extract columns 3 and 9\ndata_ppi$from &lt;- gsub(\" \\\\(.*\", \"\", data_ppi[, 1]) # Extract the left-hand node name of name\ndata_ppi$to &lt;- gsub(\".*\\\\) \", \"\", data_ppi[, 1]) # Extract the right-hand node name of name\nconnect &lt;- data_ppi[, -1] # Remove the first column\nconnect &lt;- connect[, c(2, 3, 1)] # Place the two columns of information at the beginning (from and to columns).\n\n# 2.Node statistics\ncoauth &lt;- # coauth stores node names and in/out degree information; grouping information will be added later.\n  c(as.character(connect$from), as.character(connect$to)) %&gt;%\n  as.tibble() %&gt;% # Similar to a data frame type, column names default to \"value\" â€”\n  group_by(value) %&gt;% # Group by \"value\"\n  summarize(n = n()) # Count the in-degree and out-degree of node names\ncolnames(coauth) &lt;- c(\"name\", \"n\") # Change column name\n\n# 3.Grouping nodes\nmygraph &lt;- graph_from_data_frame(connect, vertices = coauth, directed = FALSE) # Generate a graph\ncom &lt;- walktrap.community(mygraph) # Grouping nodes based on their path length â€”\n## Add group information to Coauth\ncoauth &lt;- coauth %&gt;%\n  mutate(grp = com$membership) %&gt;% # Add Groups\n  arrange(grp) %&gt;% # Sort by group\n  mutate(name = factor(name, name))\n\n# 4.Select the top 15 groups\ncoauth &lt;- coauth[coauth$grp &lt; 16, ]\n# Filter connections that appear only in the first 15 sets of points.\nconnect &lt;- connect %&gt;%\n  filter(from %in% coauth$name) %&gt;%\n  filter(to %in% coauth$name)\n\n# 5.Generate a graph\nmygraph &lt;- graph_from_data_frame(connect, vertices = coauth, directed = FALSE)\n# Generate colors by group\nmycolor &lt;- colormap(colormap = colormaps$viridis, nshades = max(coauth$grp))\nmycolor &lt;- sample(mycolor, length(mycolor))\n# ggraph drawing\nggraph(mygraph, layout = \"linear\") +\n  geom_edge_arc(aes(edge_width = connect$combined_score), edge_colour = \"black\", edge_alpha = 0.2, fold = TRUE) +\n  geom_node_point(aes(size = n, color = as.factor(grp), fill = grp), alpha = 0.5) + # Map n and the grouping variable to size and color.\n  scale_size_continuous(range = c(0.5, 8)) + # Set size range\n  scale_color_manual(values = mycolor) + # Set the group color\n  geom_node_text(aes(label = name), angle = 65, hjust = 1, nudge_y = -1.1, size = 2.3) + # Set node labels and skew them to avoid overlap.\n  theme_void() + # Remove background table, axis theme\n  theme(\n    legend.position = \"none\", # Remove legend\n    plot.margin = unit(c(0, 0, 0.4, 0), \"null\"),\n    panel.spacing = unit(c(0, 0, 3.4, 0), \"null\")\n  ) +\n  expand_limits(x = c(-1.2, 1.2), y = c(-5.6, 1.2))\n\n\n\n\nThe thickness of the arc is defined according to the edge weight\n\n\n\n\nThe figure shows an arc graph drawn using PPI edge data. Nodes represent genes, arcs represent relationships between genes, and the thickness of the arcs represents the weight (strength) of the relationships between genes. Unlike the previous figure, the edge information is extracted, and edge_width = connect$combined_score is used in the drawing process to map the weights to the thickness of the arcs.",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Arc Diagram"
    ]
  },
  {
    "objectID": "Proportion/ArcDiagram.html#applications",
    "href": "Proportion/ArcDiagram.html#applications",
    "title": "Arc Diagram",
    "section": "Applications",
    "text": "Applications\n\n\n\n\n\n\nFigureÂ 1: Applications of arc diagram\n\n\n\nHi-C interaction arc diagrams across the entire Dixon chromosome at resolutions of 500 Kb and 1 Mb, modeled by GOTHiC. a. Arc diagrams showing interactions at least 50 reads (500 Kb resolution) and 100 reads (1 Mb resolution). b. Arc diagrams of significant interactions. [1]",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Arc Diagram"
    ]
  },
  {
    "objectID": "Proportion/ArcDiagram.html#reference",
    "href": "Proportion/ArcDiagram.html#reference",
    "title": "Arc Diagram",
    "section": "Reference",
    "text": "Reference\n[1] KHAKMARDAN S, REZVANI M, POUYAN A A, et al.Â MHiC, an integrated user-friendly tool for the identification and visualization of significant interactions in Hi-C data[J]. BMC Genomics, 2020,21(1): 225.",
    "crumbs": [
      "<i class='fa-solid fa-chart-diagram'></i> Proportion/Flow",
      "Arc Diagram"
    ]
  },
  {
    "objectID": "Animation/Interactivity.html",
    "href": "Animation/Interactivity.html",
    "title": "Interactivity",
    "section": "",
    "text": "Interactive charts allow users to perform actions: zoom, hover the mouse over markers for tooltips, select variables to display, and so on. R provides a set of packages called HTML widgets: these allow you to build interactive data visualizations directly from R.",
    "crumbs": [
      "<i class='fa-solid fa-seedling'></i> Animation",
      "Interactivity"
    ]
  },
  {
    "objectID": "Animation/Interactivity.html#example",
    "href": "Animation/Interactivity.html#example",
    "title": "Interactivity",
    "section": "Example",
    "text": "Example\n\n\n\n\n\nThe basic scatter plot above can intuitively represent a general trend of the dependent variable y changing with the independent variable x. It can be seen that y increases roughly as x increases.",
    "crumbs": [
      "<i class='fa-solid fa-seedling'></i> Animation",
      "Interactivity"
    ]
  },
  {
    "objectID": "Animation/Interactivity.html#setup",
    "href": "Animation/Interactivity.html#setup",
    "title": "Interactivity",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming Language: R\nDependencies: plotly, gapminder, ggiraph, webshot, tidyverse, chorddiag, streamgraph, htmlwidgets, dygraphs, xts, d3heatmap, patchwork\n\n\n# Install packages\nif (!requireNamespace(\"plotly\", quietly = TRUE)) {\n  install.packages(\"plotly\")\n}\nif (!requireNamespace(\"gapminder\", quietly = TRUE)) {\n  install.packages(\"gapminder\")\n}\nif (!requireNamespace(\"ggiraph\", quietly = TRUE)) {\n  install.packages(\"ggiraph\")\n}\nif (!requireNamespace(\"webshot\", quietly = TRUE)) {\n  install.packages(\"webshot\")\n}\nif (!requireNamespace(\"tidyverse\", quietly = TRUE)) {\n  install.packages(\"tidyverse\")\n}\nif (!requireNamespace(\"chorddiag\", quietly = TRUE)) {\n  remotes::install_github(\"mattflor/chorddiag\")\n}\nif (!requireNamespace(\"streamgraph\", quietly = TRUE)) {\n  remotes::install_github(\"hrbrmstr/streamgraph\")\n}\nif (!requireNamespace(\"htmlwidgets\", quietly = TRUE)) {\n  install.packages(\"htmlwidgets\")\n}\nif (!requireNamespace(\"dygraphs\", quietly = TRUE)) {\n  install.packages(\"dygraphs\")\n}\nif (!requireNamespace(\"xts\", quietly = TRUE)) {\n  install.packages(\"xts\")\n}\nif (!requireNamespace(\"d3heatmap\", quietly = TRUE)) {\n  install.packages(\"d3heatmap\")\n}\nif (!requireNamespace(\"patchwork\", quietly = TRUE)) {\n  install.packages(\"patchwork\")\n}\n\n# Load packages\nlibrary(plotly)\nlibrary(gapminder)\nlibrary(ggiraph)\nlibrary(webshot)\nlibrary(tidyverse)\nlibrary(chorddiag)\nlibrary(streamgraph)\nlibrary(htmlwidgets)\nlibrary(dygraphs)\nlibrary(xts)     \nlibrary(d3heatmap)\nlibrary(patchwork)",
    "crumbs": [
      "<i class='fa-solid fa-seedling'></i> Animation",
      "Interactivity"
    ]
  },
  {
    "objectID": "Animation/Interactivity.html#data-preparation",
    "href": "Animation/Interactivity.html#data-preparation",
    "title": "Interactivity",
    "section": "Data Preparation",
    "text": "Data Preparation\nIt primarily utilizes gapminder, TCGA dataset, GISAID database, and built-in R datasets.\n1. gapminder dataset\nThe gapminder package is an R language package that provides an excerpt from a dataset from the Gapminder.org website. This dataset contains population, life expectancy, and GDP data for 142 countries, updated every five years from 1952 to 2007.\n\nhead(gapminder)\n\n# A tibble: 6 Ã— 6\n  country     continent  year lifeExp      pop gdpPercap\n  &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;\n1 Afghanistan Asia       1952    28.8  8425333      779.\n2 Afghanistan Asia       1957    30.3  9240934      821.\n3 Afghanistan Asia       1962    32.0 10267083      853.\n4 Afghanistan Asia       1967    34.0 11537966      836.\n5 Afghanistan Asia       1972    36.1 13079460      740.\n6 Afghanistan Asia       1977    38.4 14880372      786.\n\n\n2. TCGA dataset\nDNA methylation data were selected from the TCGA Bile Duct Cancer (CHOL) dataset.\n\ndata &lt;- readr::read_csv(\n\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/data.csv\")\nhead(data)\n\n# A tibble: 6 Ã— 5\n   ...1 Composite Sample Methylation_Level Standardized_Level\n  &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;              &lt;dbl&gt;              &lt;dbl&gt;\n1     1         1 AA30              0.0276             -0.450\n2     2         1 AA0S              0.654               2.32 \n3     3         1 AAV9              0.0356             -0.415\n4     4         1 AA2X              0.0198             -0.485\n5     5         1 AA2U              0.0182             -0.492\n6     6         1 A8Y8              0.0323             -0.429\n\n\n3. Data on COVID-19 infections in 2020 (data source: GISAID database)\n\ncovid_all &lt;- readr::read_csv(\n\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/covid_all.csv\")\ncovid_China &lt;- readr::read_csv(\n\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/covid_China.csv\")\nhead(covid_all)\n\n# A tibble: 6 Ã— 6\n   ...1   X.1     X location      time       count\n  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;         &lt;date&gt;     &lt;dbl&gt;\n1     1     1     1 Africa        2020-01-01    17\n2     2     2     2 Asia          2020-01-01   787\n3     3     3     3 Europe        2020-01-01   119\n4     4     4     4 North America 2020-01-01    78\n5     5     5     5 South America 2020-01-01     2\n6     6     6     6 Africa        2020-02-01    14\n\nhead(covid_China)\n\n# A tibble: 6 Ã— 3\n   ...1 time       count\n  &lt;dbl&gt; &lt;date&gt;     &lt;dbl&gt;\n1     1 2020-01-01    34\n2     2 2020-01-02     2\n3     3 2020-01-03     1\n4     4 2020-01-05     1\n5     5 2020-01-08     2\n6     6 2020-01-10     2\n\n\n4. R Built-in Dataset - mtcars\n\nmtcars_db &lt;- rownames_to_column(mtcars, var = \"carname\")\nhead(mtcars_db)\n\n            carname  mpg cyl disp  hp drat    wt  qsec vs am gear carb\n1         Mazda RX4 21.0   6  160 110 3.90 2.620 16.46  0  1    4    4\n2     Mazda RX4 Wag 21.0   6  160 110 3.90 2.875 17.02  0  1    4    4\n3        Datsun 710 22.8   4  108  93 3.85 2.320 18.61  1  1    4    1\n4    Hornet 4 Drive 21.4   6  258 110 3.08 3.215 19.44  1  0    3    1\n5 Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2\n6           Valiant 18.1   6  225 105 2.76 3.460 20.22  1  0    3    1",
    "crumbs": [
      "<i class='fa-solid fa-seedling'></i> Animation",
      "Interactivity"
    ]
  },
  {
    "objectID": "Animation/Interactivity.html#visualization",
    "href": "Animation/Interactivity.html#visualization",
    "title": "Interactivity",
    "section": "Visualization",
    "text": "Visualization\n\n1. Bubble chart (using plotly)\nUsing the gapminder dataset\n\nplot1 &lt;- gapminder %&gt;%\n  filter(year==1977) %&gt;%\n  ggplot(aes(gdpPercap, lifeExp, size = pop, color=continent))+\n  geom_point() +\n  theme_bw()\nggplotly(plot1)\n\n\n\nBubble chart (using plotly)\n\n\nThis bubble chart illustrates the relationship between GDP per capita and life expectancy at birth in different regions, with the size of the circles representing population size.\n\n\n2. Heatmap (using plotly and d3heatmap)\nThere are two options for building interactive heatmaps from R:\n\nPlotly: As mentioned above, Plotly allows you to convert any heatmap created using ggplot2 into an interactive version.\nD3heatmap: A package that uses the same syntax as the basic R heatmap function heatmap() for creating interactive versions.\n\n\n2.1 plotly\nTaking the TCGA database as an example\n\nplot2 &lt;- ggplot(data, aes(x = Sample, y = Composite, fill= Standardized_Level)) +\n  geom_tile()\n\nggplotly(plot2)\n\n\n\nplotly\n\n\nThis heatmap depicts the distribution of standardized methylation levels among different samples and composites in the TCGA-CHOL dataset, reflecting the differences in methylation status among the samples.\n\n\n2.2 d3heatmap\nTaking the mtcars database as an example\n\nd3heatmap(mtcars, scale=\"column\")\n\n\n\nd3heatmap\n\n\nThis heatmap describes the different attributes of different car models in the mtcars database.\n\n\n\n3. Streamline diagram (using streamgraph)\nTaking the GISAID database as an example\nThe streamgraph package allows you to build interactive flow graphs, and hovering over a group will give you its name and its exact value. This is also the only way to build flow graphs from R.\n\nstreamgraph(covid_all,key = \"location\",\n            value = \"count\",date = \"time\",\n            height=\"300px\", width=\"1000px\")\n\n\n\n\n\n\n\nFigureÂ 1: streamgraph\n\n\n\nThis line graph illustrates the changing trends in the number of COVID-19 infections in different regions of the world in 2020.\n\n\n4. Chord diagram (using the chorddiag package)\nThe chorddiag package allows you to build interactive chord diagrams using R. It takes a square matrix as input, providing the flow intensity between each pair of nodes that will be displayed around the circle. Once the data is correctly formatted, the chorddiag() function will automatically build the diagram for you.\n\n# Create a dataset\nm &lt;- matrix(\n  c(\n    11975, 5871, 8916, 2868,\n    1951, 10048, 2060, 6171,\n    8010, 16145, 8090, 8045,\n    1013, 990, 940, 6907\n  ),\n  byrow = TRUE,\n  nrow = 4, ncol = 4\n)\nhaircolors &lt;- c(\"black\", \"blonde\", \"brown\", \"red\")\ndimnames(m) &lt;- list(\n  have = haircolors,\n  prefer = haircolors\n)\ngroupColors &lt;- c(\"#000000\", \"#FFDD89\", \"#957244\", \"#F26223\")\n\n# plot\np &lt;- chorddiag(m, groupColors = groupColors, groupnamePadding = 60)\np\n\n# Save the image as HTML\n# saveWidget(p, file=paste0( getwd(), \"./chord_interactive.html\")) \n\n\n\n\n\n\n\nFigureÂ 2: chorddiag\n\n\n\n\n\n5. Time series plots (using the dygraphs package)\n\n# When processing data, it's important to convert the time data into XTS time series data.\ncovid_China$time &lt;- as.Date(covid_China$time, format = \"%Y-%m-%d\")\ndon &lt;- xts(x = covid_China$count, order.by = covid_China$time)\n\n# plot\np &lt;- dygraph(don) %&gt;%\n  dyOptions(labelsUTC = TRUE, fillGraph=TRUE, \n            fillAlpha=0.1, drawGrid = FALSE, colors=\"#D8AE5A\") %&gt;%\n  dyRangeSelector() %&gt;%\n  dyCrosshair(direction = \"vertical\") %&gt;%\n  dyHighlight(highlightCircleSize = 5, \n              highlightSeriesBackgroundAlpha = 0.2, \n              hideOnMouseOut = FALSE)  %&gt;%\n  dyRoller(rollPeriod = 1)\n\np\n\n\n\n\n\n\n\nFigureÂ 3: dygraphs\n\n\n\nThis time series plot depicts the growth of the number of COVID-19 cases in China in 2020.\n\n\n6. ggiraph package\nThe ggiraph package in R is an extension of the ggplot2 package, designed to simplify the process of creating interactive and dynamic plots. It is an HTML widget, meaning it is highly compatible with R Markdown/Quarto documents and the Shiny application.\n\n6.1 Basic usage\nThis is an example using the geom_point_interactive() function, which â€œreplacesâ€ the original geom_point() function in ggplot2. It will also draw circles on the plot, but these circles will be interactive. This geometry has some new parameters, such as hover_nearest = TRUE, which ensures that we always consider the nearest point being hovered over.\nTaking mtcars data as an example\n\n# plot\nmyplot &lt;- ggplot(\n  data = mtcars_db,\n  mapping = aes(\n    x = disp, y = qsec,\n    tooltip = carname, data_id = carname\n  )\n) +\n  geom_point_interactive(\n    size = 3, hover_nearest = TRUE\n  )\n\n# Convert images into interactive formats\ninteractive_plot &lt;- girafe(ggobj = myplot)\ninteractive_plot\n\n\n\n\n\n\n\nFigureÂ 4: Taking mtcars data as an example\n\n\n\nThis scatter plot shows the relationship between quarter-mile time and engine displacement for different cars in the mtcars dataset. Hovering the mouse over the origin will display the name of each car.\n\n\n6.2 Merge charts\n\n# plot1\nscatter &lt;- ggplot(\n  data = mtcars_db,\n  mapping = aes(\n    x = disp, y = qsec,\n    tooltip = carname, data_id = carname\n  )\n) +\n  geom_point_interactive(\n    size = 3, hover_nearest = TRUE\n  ) +\n  labs(\n    title = \"Displacement vs Quarter Mile\",\n    x = \"Displacement\", y = \"Quarter Mile\"\n  ) +\n  theme_bw()\n\n# plot2\nbar &lt;- ggplot(\n  data = mtcars_db,\n  mapping = aes(\n    x = reorder(carname, mpg), y = mpg,\n    tooltip = paste(\"Car:\", carname, \"&lt;br&gt;MPG:\", mpg),\n    data_id = carname\n  )\n) +\n  geom_col_interactive(fill = \"skyblue\") +\n  coord_flip() +\n  labs(\n    title = \"Miles per Gallon by Car\",\n    x = \"Car\", y = \"Miles per Gallon\"\n  ) +\n  theme_bw()\n\n# Merge two charts\ncombined_plot &lt;- scatter + bar +\n  plot_layout(ncol = 2)\n\n# Convert images into interactive formats\ninteractive_plot_match &lt;- girafe(ggobj = combined_plot)\n\n# Options for setting interactive charts\ninteractive_plot_match &lt;- girafe_options(\n  interactive_plot_match,\n  opts_hover(css = \"fill:cyan;stroke:black;cursor:pointer;\"),\n  opts_selection(type = \"single\", css = \"fill:red;stroke:black;\")\n)\n\ninteractive_plot_match\n\n\n\n\n\n\n\nFigureÂ 5: Merge charts\n\n\n\nThe left image shows the relationship between quarter-mile travel time and engine displacement for different cars in the mtcars dataset, while the right image shows the relationship between miles per gallon for different cars. By interactively merging the two images, the performance of each car can be quickly and intuitively obtained.\n\n\n6.3 Customize interactive charts using CSS\nWhile CSS is primarily used for web design, it can also be used to customize visual effects in R, making it convenient for handling web-based outputs such as interactive charts or Shiny applications.\nBasic Graphics (using a line chart as an example)\n\n# plot\nplot &lt;- covid_all %&gt;%\n  ggplot(mapping = aes(\n    x = time,\n    y = count,\n    color = location,\n    tooltip = location,\n    data_id = location\n  )) +\n  geom_line_interactive(hover_nearest = TRUE) +\n  theme_classic()\n\n# Convert images into interactive formats\ninteractive_plot_line &lt;- girafe(ggobj = plot)\n\ninteractive_plot_line\n\n\n\n\n\n\n\nFigureÂ 6: Customize interactive charts using CSS\n\n\n\nThis line graph depicts the changing trends in the number of COVID-19 infections in different regions of the world in 2020, with each curve representing a different continent.\n\n\n6.4 Add CSS\n1. Add fill effect\nThe simplest way to add CSS to ggiraph is to use the girafe_options() function.\n\ninteractive_plot_line &lt;- girafe_options(\n  interactive_plot_line,\n  opts_hover(css = \"fill:#ffe7a6;stroke:black;cursor:pointer;\"),\n  opts_selection(type = \"single\", css = \"fill:red;stroke:black;\"),\n  opts_toolbar(saveaspng = FALSE)\n)\ninteractive_plot_line\n\n\n\n\n\n\n\nFigureÂ 7: Add fill effect\n\n\n\nThis line graph depicts the changing trends in the number of COVID-19 infections in different regions of the world in 2020, with each curve representing a different continent.\n2. Highlight a curve\nWhen one line is selected, the other lines automatically fade in color.\nHere are some parameters for adjusting the curve:\n\nstroke: Changes the color of the hover line (e.g., stroke: #69B3A2;)\nstroke-width: Increases the width of the hover line for emphasis.\ntransition: Adds a smooth transition effect (e.g., transition: all 0.3s ease;)\nopacity: Reduces the opacity of non-hover lines (e.g., opacity: 0.5;)\nfilter: Applies a grayscale effect to non-hover lines (e.g., filter: grayscale(90%);)\n\n\ninteractive_plot_line2 &lt;- girafe_options(\n  interactive_plot_line,\n  opts_hover(css = \"stroke:#69B3A2; stroke-width: 3px; transition: all 0.3s ease;\"),\n  opts_hover_inv(\"opacity:0.5;filter:saturate(10%);\"),\n  opts_toolbar(saveaspng = FALSE)\n)\ninteractive_plot_line2\n\n\n\n\n\n\n\nFigureÂ 8: Highlight a curve\n\n\n\nThis line graph depicts the changing trends in the number of COVID-19 infections in different regions of the world in 2020, with each curve representing a different continent.\n\n\n\n7. Save interactive charts to .PNG and .HTML formats.\nInteractive charts can be saved as .html and two .png formats. To do this, you must rely on the htmlwidget and webshot packages respectively. You can then embed your visual iframe-like img in any webpage using the &lt;img&gt; tag.\n\n# Save as HTML\nsaveWidget(p, file=\"myFile.html\")\n\n# Save as PNG\nwebshot::install_phantomjs()\nwebshot(\"paste_your_html_here\" , \"output.png\", delay = 0.2 , cliprect = c(440, 0, 1000, 10))",
    "crumbs": [
      "<i class='fa-solid fa-seedling'></i> Animation",
      "Interactivity"
    ]
  },
  {
    "objectID": "Animation/Interactivity.html#applications",
    "href": "Animation/Interactivity.html#applications",
    "title": "Interactivity",
    "section": "Applications",
    "text": "Applications\nInteractive charts can make research data more intuitive.\n\n\n\n\n\n\nFigureÂ 9: Applications of Interactivity plot\n\n\n\nKepler.gl is a powerful geospatial data visualization tool developed and open-sourced by Uber. It is designed to help users quickly and intuitively explore and visualize large-scale geospatial datasets. [1]\nAfter importing basic data, interactive scatter plots, bar charts, and heat maps can be automatically generated, which helps to better present research data based on different geographical locations.",
    "crumbs": [
      "<i class='fa-solid fa-seedling'></i> Animation",
      "Interactivity"
    ]
  },
  {
    "objectID": "Animation/Interactivity.html#reference",
    "href": "Animation/Interactivity.html#reference",
    "title": "Interactivity",
    "section": "Reference",
    "text": "Reference\n[1] https://zhuanlan.zhihu.com/p/365767977\n[2] Wickham, H., & FranÃ§ois, R. (2019). dplyr: A Grammar of Data Manipulation (Version 1.0.0). https://CRAN.R-project.org/package=dplyr\n[3] Gohel, D., & Skintzos, P. (2024). ggiraph: Make â€˜ggplot2â€™ Graphics Interactive. https://CRAN.R-project.org/package=ggiraph\n[4] Wickham, H., Hester, J., Chang, W., & Bryan, J. (2024). devtools: Tools to Make Developing R Packages Easier. R package version 2.4.5.9000. https://github.com/r-lib/devtools.\n[5] Allaire, J. J., & Xie, Y. (2018). webshot: Save Web Content as an Image File [Computer software]. Retrieved from https://CRAN.R-project.org/package=webshot\n[6] Wickham, H., Averick, M., Bryan, J., Chang, W., McGowan, L. D., FranÃ§ois, R., â€¦ Yutani, H. (2019). tidyverse: Easily Install and Load the â€˜Tidyverseâ€™ (Version 1.2.1) [Computer software]. Retrieved from https://CRAN.R-project.org/package=tidyverse\n[7] Wickham, H., & Chang, W. (2016). ggplot2: Elegant Graphics for Data Visualization. Springer-Verlag New York.\n[8] Sievert, C. (2020). Interactive Web-Based Data Visualization with R, plotly, and shiny. Chapman and Hall/CRC. https://plotly-r.com\n[9] Bryan J (2023). gapminder: Data from Gapminder. https://github.com/jennybc/gapminder, https://www.gapminder.org/data/, https://doi.org/10.5281/zenodo.594018, https://jennybc.github.io/gapminder/.\n[11] Flor, M. (2018). chorddiag: Create a D3 Chord Diagram. https://rdrr.io/github/mattflor/chorddiag/\n[12] Hart, E., & Wickham, H. (2017). streamgraph: Create Streamgraph in R. https://CRAN.R-project.org/package=streamgraph\n[13] Vaidyanathan, R., Cheng, J., Allaire, J. J., Xie, Y., & Russell, K. (2018). htmlwidgets: HTML Widgets for R. https://github.com/ramnathv/htmlwidgets\n[14] anderkam, D., Shevtsov, P., Allaire, J. J., Owen, J., Gromer, D., & Thieurmel, B. (2011). dygraphs: Interface to â€˜Dygraphsâ€™ Interactive Time Series Charting Library. R package version 1.1.1.7. https://CRAN.R-project.org/package=dygraphs\n[15] Ryan, J. A., & Ulrich, J. M. (2024). xts: eXtensible Time Series. R package version 0.14.1. https://CRAN.R-project.org/package=xts\n[16] Grolemund, G., & Wickham, H. (2011). Dates and Times Made Easy with lubridate. Journal of Statistical Software, 40(3), 1â€“25. https://www.jstatsoft.org/v40/i03/\n[17] Cheng, J., Galili, T., RStudio, Inc., Bostock, M., & Palmer, J. (2019). d3heatmap: Interactive Heat Maps Using â€˜htmlwidgetsâ€™ and â€˜D3.jsâ€™. https://rdrr.io/cran/d3heatmap/",
    "crumbs": [
      "<i class='fa-solid fa-seedling'></i> Animation",
      "Interactivity"
    ]
  },
  {
    "objectID": "DataOverTime/StackedArea.html",
    "href": "DataOverTime/StackedArea.html",
    "title": "Stacked Area Chart",
    "section": "",
    "text": "Stacked area charts are similar to basic area charts, except that each dataset in the chart starts from the previous dataset and is used to show the trend line of how the size of each value changes over time or category, demonstrating the relationship between the part and the whole.",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Stacked Area Chart"
    ]
  },
  {
    "objectID": "DataOverTime/StackedArea.html#example",
    "href": "DataOverTime/StackedArea.html#example",
    "title": "Stacked Area Chart",
    "section": "Example",
    "text": "Example",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Stacked Area Chart"
    ]
  },
  {
    "objectID": "DataOverTime/StackedArea.html#setup",
    "href": "DataOverTime/StackedArea.html#setup",
    "title": "Stacked Area Chart",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming Language: R\nDependencies: ggplot2; dplyr; tidyverse; viridis; hrbrthemes; babynames; plotly\n\n\n# Install packages\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"tidyverse\", quietly = TRUE)) {\n  install.packages(\"tidyverse\")\n}\nif (!requireNamespace(\"viridis\", quietly = TRUE)) {\n  install.packages(\"viridis\")\n}\nif (!requireNamespace(\"hrbrthemes\", quietly = TRUE)) {\n  install.packages(\"hrbrthemes\")\n}\nif (!requireNamespace(\"babynames\", quietly = TRUE)) {\n  install.packages(\"babynames\")\n}\nif (!requireNamespace(\"plotly\", quietly = TRUE)) {\n  install.packages(\"plotly\")\n}\n\n# Load packages\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(tidyverse) \nlibrary(viridis)\nlibrary(hrbrthemes)\nlibrary(babynames)\nlibrary(plotly)",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Stacked Area Chart"
    ]
  },
  {
    "objectID": "DataOverTime/StackedArea.html#data-preparation",
    "href": "DataOverTime/StackedArea.html#data-preparation",
    "title": "Stacked Area Chart",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe plotting primarily utilizes the datasets included in the R package and COVID-19 infection data. The data_covi19 COVID-19 infection data comes from the GISAID database.\n\n# data_WorldPhones\ndata_WorldPhones &lt;- as.data.frame(WorldPhones)\ndata_WorldPhones &lt;- rownames_to_column(data_WorldPhones,\"year\")\ndata_WorldPhones &lt;- data_WorldPhones %&gt;%\n  gather(key = \"area\",value = \"Phones\",-\"year\" )\ndata_WorldPhones$year &lt;- as.numeric(data_WorldPhones$year)\n\n# data_USPersonalExpenditure\ndata_USPersonalExpenditure &lt;- USPersonalExpenditure\ndata_USPersonalExpenditure &lt;- as.data.frame(data_USPersonalExpenditure)\ndata_USPersonalExpenditure &lt;- rownames_to_column(data_USPersonalExpenditure,\"type\")\ndata_USPersonalExpenditure &lt;- data_USPersonalExpenditure %&gt;%\n  gather(key = \"year\",value = \"expense\",-\"type\" )\ndata_USPersonalExpenditure$year &lt;- as.numeric(data_USPersonalExpenditure$year)\n\n# data_baby\ndata_baby &lt;- babynames %&gt;% \n  filter(name %in% c(\"Ashley\", \"Amanda\", \"Jessica\", \"Patricia\", \"Linda\", \"Deborah\",   \"Dorothy\", \"Betty\", \"Helen\")) %&gt;%\n  filter(sex==\"F\")\n\n# data_covi19\ndata_covi19 &lt;- readr::read_csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/data_covi19.csv\")\ndata_covi19$date &lt;- c(6:12)\ndata_covi19 &lt;- gather(data_covi19, key = \"area\", value = \"cases\", 2:7)",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Stacked Area Chart"
    ]
  },
  {
    "objectID": "DataOverTime/StackedArea.html#visualization",
    "href": "DataOverTime/StackedArea.html#visualization",
    "title": "Stacked Area Chart",
    "section": "Visualization",
    "text": "Visualization\n\n1. Basic stacked area diagram\nTaking the WorldPhones dataset as an example\n\n# Basic stacked area diagram----\noptions(scipen = 20) # Do not use scientific notation\np &lt;- ggplot(data_WorldPhones, aes(x=year, y=Phones, fill=area)) + \n  geom_area()+\n  scale_y_continuous(limits = c(0, 150000),\n                     breaks = seq(0, 150000,50000))\n\np\n\n\n\n\nBasic stacked area diagram\n\n\n\n\nThe image above shows the accumulated area of total phone calls in each region over the years.\nThis is an example using data on COVID-19 infections in various regions globally during the second half of 2020.\n\np &lt;- ggplot(data_covi19, aes(x=date , y=cases, fill=area)) + \n  geom_area() +\n  scale_y_continuous() +\n  theme(plot.title = element_text(hjust = 0.5)) +\n  labs(x=\"month\") +\n  ggtitle(\"Number of COVID-19 infections in various regions in the second half of 2020\")\n\np\n\n\n\n\nCOVID-19 infection data\n\n\n\n\nThe horizontal axis of the graph above represents the month, and the vertical axis represents the number of COVID-19 infections.\n\n\n2. proportional stacked area diagram\nTake the USPersonalExpenditure dataset as an example.\n\n# Calculate data percentage\ndata_USPersonalExpenditure1 &lt;- data_USPersonalExpenditure  %&gt;%\n  group_by(year, type) %&gt;%\n  summarise(n = sum(expense)) %&gt;%\n  mutate(percentage = n / sum(n))\n\n# plot\np &lt;- ggplot(data_USPersonalExpenditure1, aes(x=year, y=percentage, fill=type)) + \n  geom_area(alpha=0.8 , size=0.1, colour=\"black\")\n\np\n\n\n\n\nTake the USPersonalExpenditure dataset as an example\n\n\n\n\nThe chart above shows the stacked area of US personal spending across different consumption categories over the years.\nThis is illustrated by data on COVID-19 infections in various regions globally during the second half of 2020.\n\n# Calculate data percentage\ndata_covi19_percent &lt;- data_covi19  %&gt;%\n  group_by(date, area) %&gt;%\n  summarise(n = sum(cases)) %&gt;%\n  mutate(percentage = n / sum(n))\n\n# plot\np &lt;- ggplot(data_covi19_percent, aes(x=date, y=percentage, fill=area)) + \n  geom_area(alpha=0.8 , size=0.1, colour=\"black\") +\n  theme(plot.title = element_text(hjust = 0.5)) +\n  labs(x=\"month\") +\n  ggtitle(\"Stacked chart of percentage of COVID-19 infections in various regions during the second half of 2020\")\n\np\n\n\n\n\nCOVID-19 infection data\n\n\n\n\nThe horizontal axis of the chart above represents the month, and the vertical axis represents the percentage of COVID-19 infections in each region.\n\n\n3. Customization\n\n# Customization----\np &lt;- ggplot(data_USPersonalExpenditure, aes(x=year, y=expense, fill=type)) + \n  geom_area(alpha=0.6 , size=.5, colour=\"white\") +\n  scale_fill_viridis(discrete = T) + # Use color levels\n  theme_ipsum() + \n  ggtitle(\"Categories of U.S. personal spending (in billions of dollars)\") # Set title\n\np\n\n\n\n\nCustomization\n\n\n\n\n\n\n4. Interactive stacked area map\nUsing the plotly package, we can create interactive stacked area plots.\nLetâ€™s take the babynames dataset as an example.\n\n# Interactive stacked area plot (plotly)----\n# plot\np1 &lt;- data_baby %&gt;% \n  ggplot( aes(x=year, y=n, fill=name, text=name)) +\n  geom_area( ) +\n  scale_fill_viridis(discrete = TRUE) +\n  theme(legend.position=\"none\") +\n  ggtitle(\"Popularity of American Names over the Past Thirty Years\") +\n  theme_ipsum() +\n  theme(legend.position=\"none\")\n\n# Convert into interactive graphics\np_inter1 &lt;- ggplotly(p1, tooltip=\"text\")\np_inter1\n\n\n\nInteractive stacked area map\n\n\nThe image above is an interactive stackable bar chart, which allows users to view groups, zoom in and out, and perform other functions.",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Stacked Area Chart"
    ]
  },
  {
    "objectID": "DataOverTime/StackedArea.html#applications",
    "href": "DataOverTime/StackedArea.html#applications",
    "title": "Stacked Area Chart",
    "section": "Applications",
    "text": "Applications\n\n\n\n\n\n\nFigureÂ 1: Applications of stacked area chart\n\n\n\nVariations in the proportions of different bone marrow progenitor cell populations in the liver (CS12 to CS23, 6 biologically independent embryonic samples and 259 cells) and in the blood (CS13 to CS20, 5 biologically independent embryonic samples and 131 cells). [1]",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Stacked Area Chart"
    ]
  },
  {
    "objectID": "DataOverTime/StackedArea.html#reference",
    "href": "DataOverTime/StackedArea.html#reference",
    "title": "Stacked Area Chart",
    "section": "Reference",
    "text": "Reference\n[1] Bian, Z., Gong, Y., Huang, T. et al.Â Deciphering human macrophage development at single-cell resolution. Nature 582, 571â€“576 (2020). https://doi.org/10.1038/s41586-020-2316-7\n[2] H. Wickham. ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York, 2016.\n[3] Wickham H, FranÃ§ois R, Henry L, MÃ¼ller K, Vaughan D (2023). dplyr: A Grammar of Data Manipulation. R package version 1.1.4, https://CRAN.R-project.org/package=dplyr.\n[4] Wickham H, Averick M, Bryan J, Chang W, McGowan LD, FranÃ§ois R, Grolemund G, Hayes A, Henry L, Hester J, Kuhn M, Pedersen TL, Miller E, Bache SM, MÃ¼ller K, Ooms J, Robinson D, Seidel DP, Spinu V, Takahashi K, Vaughan D, Wilke C, Woo K, Yutani H (2019). â€œWelcome to the tidyverse.â€ Journal of Open Source Software, 4(43), 1686. doi:10.21105/joss.01686 https://doi.org/10.21105/joss.01686.\n[5] Simon Garnier, Noam Ross, Robert Rudis, AntÃ´nio P. Camargo, Marco Sciaini, and CÃ©dric Scherer (2024). viridis(Lite) - Colorblind-Friendly Color Maps for R. viridis package version 0.6.5.\n[6] C. Sievert. Interactive Web-Based Data Visualization with R, plotly, and shiny. Chapman and Hall/CRC Florida, 2020.\n[7] Wickham H (2021). babynames: US Baby Names 1880-2017. R package version 1.0.1, https://CRAN.R-project.org/package=babynames.\n[8] Rudis B (2024). hrbrthemes: Additional Themes, Theme Components and Utilities for â€˜ggplot2â€™. R package version 0.8.7, https://CRAN.R-project.org/package=hrbrthemes.",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Stacked Area Chart"
    ]
  },
  {
    "objectID": "DataOverTime/Streamgraph.html",
    "href": "DataOverTime/Streamgraph.html",
    "title": "Streamgraph",
    "section": "",
    "text": "A Streamgraph is a stacked area diagram. It represents the evolution of numerical variables across multiple groups. Typically, it displays areas around a central axis with rounded edges to create a flowing shape.",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Streamgraph"
    ]
  },
  {
    "objectID": "DataOverTime/Streamgraph.html#example",
    "href": "DataOverTime/Streamgraph.html#example",
    "title": "Streamgraph",
    "section": "Example",
    "text": "Example",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Streamgraph"
    ]
  },
  {
    "objectID": "DataOverTime/Streamgraph.html#setup",
    "href": "DataOverTime/Streamgraph.html#setup",
    "title": "Streamgraph",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming Language: R\nDependencies:streamgraph, dplyr, htmlwidgets, ggplot2, ggstream\n\n\n# Install packages\nif (!requireNamespace(\"streamgraph\", quietly = TRUE)) {\n  remotes::install_github(\"hrbrmstr/streamgraph\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"htmlwidgets\", quietly = TRUE)) {\n  install.packages(\"htmlwidgets\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"ggstream\", quietly = TRUE)) {\n  install.packages(\"ggstream\")\n}\n\n# Load packages\nlibrary(streamgraph)\nlibrary(dplyr)\nlibrary(htmlwidgets)\nlibrary(ggplot2)\nlibrary(ggstream)",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Streamgraph"
    ]
  },
  {
    "objectID": "DataOverTime/Streamgraph.html#data-preparation",
    "href": "DataOverTime/Streamgraph.html#data-preparation",
    "title": "Streamgraph",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe study primarily utilizes the built-in R dataset ChickWeight and a batch of COVID-19 infection data from 2020.\n\n# 1.R's built-in data - ChickWeight\n## This dataset contains 50 samples in total. The dataset chick_new_2 below selects 5 representative samples with a Diet value of 1.\nchick_new_1 &lt;- subset(ChickWeight,Diet==\"1\")\nchick_new_2 &lt;- chick_new_1[c(1:12,144:155,73:95,156:167),]\n\n# 2.Data on COVID-19 infections in 2020 (data source: GISAID database)\n## The following data was obtained through data processing, where covid_all represents the total number of people infected with COVID-19 in different regions each month.\ncovid_all &lt;- readr::read_csv(\n\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/covid_all.csv\")\nhead(covid_all)\n\n# A tibble: 6 Ã— 6\n   ...1   X.1     X location      time       count\n  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;         &lt;date&gt;     &lt;dbl&gt;\n1     1     1     1 Africa        2020-01-01    17\n2     2     2     2 Asia          2020-01-01   787\n3     3     3     3 Europe        2020-01-01   119\n4     4     4     4 North America 2020-01-01    78\n5     5     5     5 South America 2020-01-01     2\n6     6     6     6 Africa        2020-02-01    14\n\ncovid_month &lt;- readr::read_csv(\n\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/covid_month.csv\")\nhead(covid_month)\n\n# A tibble: 6 Ã— 7\n   ...1   X.2   X.1     X location      month count\n  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt; &lt;dbl&gt;\n1     1     1     1     1 Africa            1    17\n2     2     2     2     2 Asia              1   787\n3     3     3     3     3 Europe            1   119\n4     4     4     4     4 North America     1    78\n5     5     5     5     5 South America     1     2\n6     6     6     6     6 Africa            2    14",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Streamgraph"
    ]
  },
  {
    "objectID": "DataOverTime/Streamgraph.html#visualization",
    "href": "DataOverTime/Streamgraph.html#visualization",
    "title": "Streamgraph",
    "section": "Visualization",
    "text": "Visualization\n\n1. Basic plotting (using the streamgraph package)\nFlowcharts can be built with just a few lines of code.\n\n1.1 Basic code\nTaking the data on COVID-19 infections in 2020 as an example\n\nstreamgraph(covid_all, key = \"location\",\n            value = \"count\",date = \"time\",\n            height=\"300px\", width=\"1000px\")\n\n\n\n\nBasic code\n\n\nThis streamgraph depicts the number of people infected with the novel coronavirus in different regions at different times in 2020.\nStream graphs created using the streamgraph package allow you to directly display specific information by hovering the mouse over different colors; alternatively, you can use drop-down buttons to see the details of each sample.\n\n\n1.2 Add dropdown button\nThe sg_legend() function adds a dropdown button. Unlike other streamgraph() options, sg_legend() is used after a pipe command (%&gt;%).\n\nstreamgraph(covid_all, key = \"location\",\n            value = \"count\",date = \"time\",\n            height=\"300px\", width=\"1000px\") %&gt;%\n  sg_legend(show=TRUE, label=\"location: \")\n\n\n\n\nAdd dropdown button\n\n\n\n\n1.3 Change shape\nThe shape of the streamline diagram can be changed by adjusting the interpolate parameter.\n\nstreamgraph(covid_all, key = \"location\",\n            value = \"count\",date = \"time\",\n            interpolate=\"step\",\n            height=\"300px\", width=\"1000px\") %&gt;%\nsg_legend(show=TRUE, label=\"location: \")\n\n\n\n\nChange shape\n\n\nThis streamgraph depicts the number of people infected with the novel coronavirus in different regions at different times in 2020.\n\n\n1.4 Change color\n\nscale_fill_brewer(): Uses an R ColorBrewer palette, including both continuous and categorical colors.\nscale_fill_manual(): Constructs a custom color palette: simply provide a vector containing the selected colors.\n\n\nstreamgraph(covid_all,key = \"location\",\n            value = \"count\",date = \"time\",\n            interpolate=\"linear\",\n            height=\"300px\", width=\"1000px\") %&gt;%\n  sg_fill_brewer(\"Reds\")\n\n\n\n\nChange color\n\n\nThis streamgraph depicts the number of people infected with the novel coronavirus in different regions at different times in 2020.\n\n\n\n2. streamgraph offset\nThere are three possible scenarios:\n\nsilhouette: The shape is displayed on either side of the horizontal axis.\nzero: Displayed above the 0 line.\nexpand: Equivalent to a percentage stacked area chart; the full height is used to visualize the percentage.\n\n\n2.1 silhouette\n\nstreamgraph(covid_all,key = \"location\",\n            value = \"count\",date = \"time\",\n            offset=\"silhouette\",\n            height=\"300px\", width=\"1000px\")\n\n\n\n\nsilhouette\n\n\nThis streamgraph depicts the number of people infected with the novel coronavirus in different regions at different times in 2020.\n\n\n2.2 zero\n\nstreamgraph(covid_all,key = \"location\",\n            value = \"count\",date = \"time\",\n            offset=\"zero\",\n            height=\"300px\", width=\"1000px\")\n\n\n\n\nzero\n\n\nThis streamgraph depicts the number of people infected with the novel coronavirus in different regions at different times in 2020.\n\n\n2.3 expand\n\nstreamgraph(covid_all,key = \"location\",\n            value = \"count\",date = \"time\",\n            offset=\"expand\",\n            height=\"300px\", width=\"1000px\")\n\n\n\n\nexpand\n\n\nThis streamgraph depicts the number of people infected with the novel coronavirus in different regions at different times in 2020.\n\n\n\n3. Save the chart as an HTML file\nUse the saveWidget() function from the htmlwidgets package.\n\npp &lt;- streamgraph(chick_new,key = \"Chick\",\n                  value = \"weight\",date = \"Time\",\n                  height=\"300px\", width=\"1000px\")\nsaveWidget(pp, file=paste0( getwd(), \"/HtmlWidget/streamgraphDropdown.html\"))\n\n\n\n4. Basic plotting (using the ggplot2 package)\nCompared to the streamgraph package, the ggplot2 package allows for more detailed customization.\n\n4.1 Basic code\nTake the data on COVID-19 infections in 2020 as an example.\n\ncovid_all %&gt;% \n  ggplot(aes(time, count, fill = location, label = location, color = location)) +\n  geom_area()\n\n\n\n\nBasic code\n\n\n\n\nThis streamgraph depicts the number of people infected with the novel coronavirus in different regions at different times in 2020.\n\n\n4.2 Beautify plot\n\nAdjust curve shape: geom_stream()\nAdjust color: scale_fill_manual() and scale_color_manual()\n\n\ncovid_all %&gt;% \n  ggplot(aes(time, count, fill = location, label = location, color = location))  +\n  geom_stream(type = \"ridge\", bw=1) \n\n\n\n\nBeautify plot\n\n\n\n\nThis streamgraph depicts the number of people infected with the novel coronavirus in different regions at different times in 2020.\n\n\n4.3 Taking ChickWeight data as an example\n\nchick_new_2 %&gt;% \n  ggplot(aes(Time, weight, fill = Chick, label = Chick, color = Chick)) +\n  geom_area()\n\n\n\n\nTaking ChickWeight data as an example\n\n\n\n\nThis streamgraph illustrates how the weight of different chicks changes over time.",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Streamgraph"
    ]
  },
  {
    "objectID": "DataOverTime/Streamgraph.html#applications",
    "href": "DataOverTime/Streamgraph.html#applications",
    "title": "Streamgraph",
    "section": "Applications",
    "text": "Applications\n\n\n\n\n\n\nFigureÂ 1: Applications of streamgraph\n\n\n\nThis streamgraph shows the temporal variation of the influenza lineage cycle. [1]",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Streamgraph"
    ]
  },
  {
    "objectID": "DataOverTime/Streamgraph.html#reference",
    "href": "DataOverTime/Streamgraph.html#reference",
    "title": "Streamgraph",
    "section": "Reference",
    "text": "Reference\n[1] Dhanasekaran V, Sullivan S, Edwards KM, Xie R, Khvorov A, Valkenburg SA, Cowling BJ, Barr IG. Human seasonal influenza under COVID-19 and the potential consequences of influenza lineage elimination. Nat Commun. 2022 Mar 31;13(1):1721. doi: 10.1038/s41467-022-29402-5. PMID: 35361789; PMCID: PMC8971476.\n[2] Wickham, H., & FranÃ§ois, R. (2019). dplyr: A Grammar of Data Manipulation (Version x.y.z). Retrieved from https://CRAN.R-project.org/package=dplyr\n[3] Rudis, B. (2015). streamgraph: An htmlwidget for building streamgraph visualizations. Retrieved from https://github.com/hrbrmstr/streamgraph\n[4] Wickham, H., & Romain FranÃ§ois. (2024). devtools: Tools to Make Developing R Packages Easier (Version 2.4.5). Retrieved from [https://CRAN.R-project.org/package=devtools](https://cran.r-project.org/package=devtools\n[5] Vaidyanathan R, Cheng J, Allaire JJ, Xie Y. htmlwidgets: HTML Widgets for R. R package version 1.6.4. 2023. Available from: https://CRAN.R-project.org/package=htmlwidgets.\n[6] David Sjoberg (2021). ggstream: Create Streamplots in â€˜ggplot2â€™. R package version 0.1.0. https://CRAN.R-project.org/package=ggstream",
    "crumbs": [
      "<i class='fa-solid fa-timeline'></i> Evolution",
      "Streamgraph"
    ]
  },
  {
    "objectID": "DataOverTime/CalendHighlight.html",
    "href": "DataOverTime/CalendHighlight.html",
    "title": "Calend Highlight",
    "section": "",
    "text": "Date highlighting marks are mainly used to display changes in data within certain specific date ranges in time series data, and can be used for an overview of activity frequencies and marking of special dates."
  },
  {
    "objectID": "DataOverTime/CalendHighlight.html#example",
    "href": "DataOverTime/CalendHighlight.html#example",
    "title": "Calend Highlight",
    "section": "Example",
    "text": "Example"
  },
  {
    "objectID": "DataOverTime/CalendHighlight.html#setup",
    "href": "DataOverTime/CalendHighlight.html#setup",
    "title": "Calend Highlight",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming Language: R\nDependencies: calendR\n\n\n# Install packages\nif (!requireNamespace(\"calendR\", quietly = TRUE)) {\n  install.packages(\"calendR\")\n}\n\n# Load packages\nlibrary(calendR)"
  },
  {
    "objectID": "DataOverTime/CalendHighlight.html#data-preparation",
    "href": "DataOverTime/CalendHighlight.html#data-preparation",
    "title": "Calend Highlight",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe data is the calendar data for a specified year, and certain date ranges can be selected to be highlighted.\n\n# Construct data\nset.seed(1)\ndata &lt;- rnorm(365)\n\n# View data\nhead(data)\n\n[1] -0.6264538  0.1836433 -0.8356286  1.5952808  0.3295078 -0.8204684"
  },
  {
    "objectID": "DataOverTime/CalendHighlight.html#visualization",
    "href": "DataOverTime/CalendHighlight.html#visualization",
    "title": "Calend Highlight",
    "section": "Visualization",
    "text": "Visualization\n\n1. Chinese Calendar\nIt should be noted that if you are in China, the default weeknames and monthnames are in Chinese; if you are in other countries/regions, the default weeknames and monthnames are in English.\n\n# Chinese Calendar\np &lt;- calendR(\n    year = 2025,\n    month = NULL,\n    from = NULL,\n    to = NULL,\n    start = \"M\",\n    mbg.col = 2,\n    # orientation = \"portrait\",\n    months.col = \"white\",\n    months.pos = 0.5,\n    monthnames = c(\n        \"ä¸€æœˆ\",\n        \"äºŒæœˆ\",\n        \"ä¸‰æœˆ\",\n        \"å››æœˆ\",\n        \"äº”æœˆ\",\n        \"å…­æœˆ\",\n        \"ä¸ƒæœˆ\",\n        \"å…«æœˆ\",\n        \"ä¹æœˆ\",\n        \"åæœˆ\",\n        \"åä¸€æœˆ\",\n        \"åäºŒæœˆ\"\n    ),\n    weeknames = c(\"ä¸€\", \"äºŒ\", \"ä¸‰\", \"å››\", \"äº”\", \"å…­\", \"æ—¥\"),\n    special.days = data,\n    special.col = \"#00338888\",\n    gradient = TRUE,\n    low.col = \"#FFFFFF88\",\n    font.family = \"sans\",\n    font.style = \"plain\",\n    day.size = 2,\n    # ncol = 2,\n    lunar = FALSE,\n    pdf = FALSE\n)\n\np\n\n\n\n\nChinese Calendar\n\n\n\n\n\n\n2. English Calendar\n\n# English Calendar\np &lt;- calendR(\n    year = 2025,\n    month = NULL,\n    from = NULL,\n    to = NULL,\n    start = \"S\",\n    mbg.col = 2,\n    # orientation = \"portrait\",\n    months.col = \"white\",\n    months.pos = 0.5,\n    monthnames = c(\n    \"January\",\n    \"February\",\n    \"March\",\n    \"April\",\n    \"May\",\n    \"June\",\n    \"July\",\n    \"August\",\n    \"September\",\n    \"October\",\n    \"November\",\n    \"December\"\n  ),\n    weeknames = c(\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"),\n    special.days = data,\n    special.col = \"#00888888\",\n    gradient = TRUE,\n    low.col = \"#FFFFFF88\",\n    font.family = \"sans\",\n    font.style = \"plain\",\n    day.size = 2,\n    # ncol = 2,\n    lunar = FALSE,\n    pdf = FALSE\n)\n\np\n\n\n\n\nEnglish Calendar\n\n\n\n\n\n\n3. Calendar Period\n\n# Calendar Period\ndata &lt;- rnorm(30, 15, 10)\ndays &lt;- rep(min(data) - 0.05, 365)\ndays[30:180] &lt;- data\n\np &lt;- calendR(\n    year = 2025,\n    month = NULL,\n    from = NULL,\n    to = NULL,\n    start = \"S\",\n    mbg.col = 2,\n    # orientation = \"portrait\",\n    months.col = \"white\",\n    months.pos = 0.5,\n    monthnames = c(\n    \"January\",\n    \"February\",\n    \"March\",\n    \"April\",\n    \"May\",\n    \"June\",\n    \"July\",\n    \"August\",\n    \"September\",\n    \"October\",\n    \"November\",\n    \"December\"\n  ),\n    weeknames = c(\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"),\n    special.days = days,\n    special.col = \"#FF000088\",\n    gradient = TRUE,\n    low.col = \"#FFFFFF88\",\n    font.family = \"sans\",\n    font.style = \"plain\",\n    day.size = 2,\n    # ncol = 2,\n    lunar = FALSE,\n    pdf = FALSE\n)\n\np\n\n\n\n\nCalendar Period"
  },
  {
    "objectID": "Distribution/ViolinPlot.html",
    "href": "Distribution/ViolinPlot.html",
    "title": "Violin Plot",
    "section": "",
    "text": "A violin plot combines elements of a density plot and a box plot to visualize data distribution. It displays key statistical information, including the median, quartiles, minimum, and maximum values. Violin plots are particularly useful for comparing distributions across different groups, offering a more intuitive representation than traditional box plots by revealing the shape of the data distribution.",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Violin Plot"
    ]
  },
  {
    "objectID": "Distribution/ViolinPlot.html#example",
    "href": "Distribution/ViolinPlot.html#example",
    "title": "Violin Plot",
    "section": "Example",
    "text": "Example",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Violin Plot"
    ]
  },
  {
    "objectID": "Distribution/ViolinPlot.html#setup",
    "href": "Distribution/ViolinPlot.html#setup",
    "title": "Violin Plot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: readr; tidyr; ggplot2; dplyr; gghalves; forcats; hrbrthemes; viridis; ggstatsplot; palmerpenguins\n\n\n# Installing packages\nif (!requireNamespace(\"readr\", quietly = TRUE)) {\n  install.packages(\"readr\")\n}\nif (!requireNamespace(\"tidyr\", quietly = TRUE)) {\n  install.packages(\"tidyr\")\n}\nif (!requireNamespace(\"gghalves\", quietly = TRUE)) {\n  install.packages(\"gghalves\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"ggpubr\", quietly = TRUE)) {\n  install.packages(\"ggpubr\")\n}\nif (!requireNamespace(\"forcats\", quietly = TRUE)) {\n  install.packages(\"forcats\")\n}\nif (!requireNamespace(\"hrbrthemes\", quietly = TRUE)) {\n  remotes::install_github(\"hrbrmstr/hrbrthemes\")\n}\nif (!requireNamespace(\"viridis\", quietly = TRUE)) {\n  install.packages(\"viridis\")\n}\nif (!requireNamespace(\"ggstatsplot\", quietly = TRUE)) {\n  install.packages(\"ggstatsplot\")\n}\nif (!requireNamespace(\"palmerpenguins\", quietly = TRUE)) {\n  install.packages(\"palmerpenguins\")\n}\n\n# Load packages\nlibrary(readr)\nlibrary(tidyr)\nlibrary(ggplot2)\nlibrary(ggpubr)\nlibrary(dplyr)\nlibrary(gghalves)\nlibrary(forcats)\nlibrary(hrbrthemes)\nlibrary(viridis)\nlibrary(ggstatsplot)\nlibrary(palmerpenguins)",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Violin Plot"
    ]
  },
  {
    "objectID": "Distribution/ViolinPlot.html#data-preparation",
    "href": "Distribution/ViolinPlot.html#data-preparation",
    "title": "Violin Plot",
    "section": "Data Preparation",
    "text": "Data Preparation\nWe used the built-in R datasets (iris, penguins) and the TCGA-BRCA.htseq_counts.tsv dataset from UCSC Xena DATASETS. Selected genes were chosen for demonstration purposes.\n\n# Load the TCGA-BRCA gene expression dataset from a processed CSV file  \ndata_counts &lt;- readr::read_csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/TCGA-BRCA.htseq_counts_processed.csv\")\n\n# Load built-in R dataset iris\ndata_wide &lt;- iris[ , 1:4] # Take the data in columns 1-4 of the iris database as an example\n\n# Load built-in R dataset penguins\ndata(\"penguins\", package = \"palmerpenguins\")\ndata_penguins &lt;- drop_na(penguins) # Remove missing values\n\n# Manually create a demonstration dataset with grouped values \ndata &lt;- data.frame(\n  name=c( rep(\"A\",500), rep(\"B\",500), rep(\"B\",500), rep(\"C\",20), rep('D', 100)  ),\n  value=c( rnorm(500, 10, 5), rnorm(500, 13, 1), rnorm(500, 18, 1), rnorm(20, 25, 4), rnorm(100, 12, 1) )\n  )\nsample_size &lt;- data %&gt;% \n  group_by(name) %&gt;% \n  summarize(num=n()) # Compute the sample size for each group",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Violin Plot"
    ]
  },
  {
    "objectID": "Distribution/ViolinPlot.html#visualization",
    "href": "Distribution/ViolinPlot.html#visualization",
    "title": "Violin Plot",
    "section": "Visualization",
    "text": "Visualization\n\n1. Basic Violin Plot\nExample 1: Basic Violin Plot with Manually Created Data\n\n# Basic Violin Plot\np &lt;- ggplot(data, aes(x=name, y=value, fill=name)) + \n  geom_violin()\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Basic Violin Plot\n\n\n\n\n\nExample 2: Basic Violin Plot with the iris Dataset\n\n# Transform the `iris` dataset from wide format to long format. Use the gather function to collect the data in each column into two new columns named \"MesureType\" and \"Val\", so that one row represents one observation.\ndata_long_iris &lt;- data_wide %&gt;%  \n  gather(key = \"MeasureType\", value = \"Value\")  \n\nggplot(data_long_iris, aes(x = MeasureType, y = Value, fill = MeasureType)) +  \n  geom_violin()  \n\n\n\n\n\n\n\nFigureÂ 2: Basic Violin Plot Using the iris Dataset\n\n\n\n\n\nExample 3: Violin Plot with TCGA-BRCA Gene Expression Data\n\nexample_counts1 &lt;- data_counts[1:5,] %&gt;%\n  gather(key = \"sample\",value = \"gene_expression\",3:1219) # Select five example genes for visualization: A1BG, A1BG-AS1, A1CF, A2M, and A2M-AS1.\n\nggplot(example_counts1, aes(x=gene_name, y=gene_expression, fill=gene_name)) +\n  geom_violin()\n\n\n\n\n\n\n\nFigureÂ 3: Basic Violin Plot Using the TCGA-BRCA dataset\n\n\n\n\n\nExample 4: Basic violin plot with significance annotation of differences between groups\n\n# Organize and group the data\ndata_long_iris &lt;- data_wide %&gt;%\n  gather(key = \"MeasureType\",\n         value = \"Value\")\n\n# Draw a basic violin plot\np &lt;- ggplot(data_long_iris,\n       aes(x = MeasureType,\n           y = Value,\n           fill = MeasureType)) +\n  geom_violin()\n\n# Extract and deduplicate groups\ngroups &lt;- length(unique(data_long_iris$MeasureType))\nif (groups == 2) {\n    p &lt;- p +\n        stat_compare_means(\n            method = \"wilcox.test\", # c(\"t.test\", \"wilcox.test\")\n            paired = FALSE,\n            method.args = list(),\n            ref.group = NULL,\n            comparisons = NULL,\n            hide.ns = FALSE,\n            label.sep = \", \",\n            label = \"p.format\", # c(\"p.signif\", \"p.format\")\n            label.x.npc = \"left\",\n            label.y.npc = \"top\",\n            label.x = NULL,\n            label.y = NULL,\n            vjust = 0,\n            tip.length = 0.03,\n            bracket.size = 0.3,\n            step.increase = 0.1,\n            symnum.args = list(),\n            geom = \"text\",\n            position = \"identity\",\n            na.rm = FALSE,\n            show.legend = NA,\n            inherit.aes = TRUE\n        )\n} else if (groups &gt; 2) {\n    p &lt;- p +\n        stat_compare_means(\n            method = \"wilcox.test\", # c(\"t.test\", \"wilcox.test\")\n            paired = FALSE,\n            method.args = list(),\n            ref.group = NULL,\n            # Perform pairwise comparisons for multiple group comparisons\n            comparisons = combn(unique(as.character(data_long_iris$MeasureType)), 2, simplify = FALSE),\n            hide.ns = FALSE,\n            label.sep = \", \",\n            label = \"p.format\", # c(\"p.signif\", \"p.format\")\n            label.x.npc = \"left\",\n            label.y.npc = \"top\",\n            label.x = NULL,\n            label.y = NULL,\n            vjust = 0,\n            tip.length = 0.03,\n            bracket.size = 0.3,\n            step.increase = 0.1,\n            symnum.args = list(),\n            geom = \"text\",\n            position = \"identity\",\n            na.rm = FALSE,\n            show.legend = NA,\n            inherit.aes = TRUE\n        )\n}\n\np\n\n\n\n\n\n\n\nFigureÂ 4: Basic violin plot with significance annotation of differences between groups\n\n\n\n\n\n\n\n2. Horizontal Violin Plot\nThe x and y axes can be flipped using coord_flip().\n\nexample_counts2 &lt;- data_counts[1:6,] %&gt;% \n  gather(key = \"sample\",value = \"gene_expression\",3:1219) %&gt;% \n  mutate(gene_name= fct_reorder(gene_name,gene_expression ))\n\nggplot(example_counts2, aes(x=gene_name, y=gene_expression, fill=gene_name, color=gene_name)) +\n  geom_violin() +\n  scale_fill_viridis(discrete=TRUE) +\n  scale_color_viridis(discrete=TRUE) +\n  theme_ipsum() + # Improve plot appearance\n  theme(legend.position=\"none\" ) +\n  coord_flip() + # flip the x and y axes\n  xlab(\"\") +\n  ylab(\"Assigned Probability (%)\")\n\n\n\n\n\n\n\nFigureÂ 5: Horizontal Violin Plot Using the TCGA-BRCA dataset\n\n\n\n\n\n\n\n3. Violin Plot with Boxplot\nIn practical visualization applications, a box plot can be added to a violin plot using geom_boxplot(), which helps in visually comparing the distribution of the data.\n\nexample_data &lt;- data %&gt;% \n  left_join(sample_size) %&gt;%\n  mutate(myaxis = paste0(name, \"\\n\", \"n=\", num)) # The `myaxis` variable is created to display sample size on the x-axis.  \n\nggplot(example_data, aes(x=myaxis, y=value, fill=name)) +\n  geom_violin(width=1.4) +\ngeom_boxplot( width=0.1,color=\"grey\", alpha=0.2) + # Draw a box plot. A small width value makes the box plot inside the violin plot.\nscale_fill_viridis(discrete = TRUE) +\n  theme_ipsum() + # Beautify the graph\n  theme(\n   legend.position=\"none\",\n   plot.title = element_text(size=11)\n  ) +\n  ggtitle(\"A Violin plot wrapping a boxplot\") +  # Set the title\n  xlab(\"\")\n\n\n\n\n\n\n\nFigureÂ 6: Violin Plot with Boxplot\n\n\n\n\n\nAnother Violin Plot with Box Plot using the TCGA-BRCA Gene Expression Data\n\nexample_counts3 &lt;- data_counts[1:5,] %&gt;%\n  gather(key = \"sample\", value = \"gene_expression\",3:1219) %&gt;%\n  mutate(gene_name= fct_reorder(gene_name,gene_expression ))\n\nggplot(example_counts3, aes(x=gene_name, y=gene_expression, fill=gene_name, color=gene_name)) +\n  geom_violin() +\n  geom_boxplot( width=0.1,color=\"grey\", alpha=0.2)+\n  scale_fill_viridis(discrete=TRUE) +\n  scale_color_viridis(discrete=TRUE) +\n  theme_ipsum() + # Beautify the graph\n  theme(legend.position=\"none\" ) \n\n\n\n\n\n\n\nFigureÂ 7: Violin Plot with Boxplot Using the TCGA-BRCA dataset\n\n\n\n\n\n\n\n4. Grouped Violin Plot\nOn the basis of the basic violin plot, we can achieve intra-group comparison by setting the fill value.\nThe example below demonstrates intra-group comparison using the fill aesthetic. In this case, the penguins dataset is used. The x variable represents the species, and fill=sex creates an intra-group classification to visualize the comparison of flipper lengths within each species, grouped by gender.\n\nggplot(data_penguins, aes(fill=sex, y=flipper_length_mm, x=species)) + # Use X as the major classification and fill as the intra-group classification\n  geom_violin(position=\"dodge\", alpha=0.5, outlier.colour=\"transparent\") +\n  scale_fill_viridis(discrete=T, name=\"\") +\n  theme_ipsum()  \n\n\n\n\n\n\n\nFigureÂ 8: Grouped Violin Plot Using the penguins dataset\n\n\n\n\n\n\n\n5. Half-Violin Plot\nA half-violin plot is useful for visualizing a large amount of data in a compact form. We can use the geom_half_violin function to display two groups separately.\nIn the following example, we visualize the flipper lengths of penguins for both species and genders, by plotting female and male penguins on opposite sides of the plot.\n\n# Separate the data for female and male penguins\ndata_female &lt;- data_penguins %&gt;% filter(sex == \"female\")\ndata_male &lt;- data_penguins %&gt;% filter(sex == \"male\")\n\n# Plot the half-violin plot for both groups (females on the right and males on the left)\nggplot() +\n  geom_half_violin(\n    data = data_female,\n    aes(y = flipper_length_mm, x = species),\n    position = position_dodge(width = 1),\n    scale = 'width',\n    colour = NA,\n    fill = \"#9370DB\",\n    alpha = 0.8,  ## Set transparency\n    side = \"r\"\n  ) +\n  geom_half_violin(\n    data = data_male,\n    aes(y = flipper_length_mm, x = species),\n    position = position_dodge(width = 1),\n    scale = 'width',\n    colour = NA,\n    fill = \"#FFFF00\",\n    alpha = 0.6,\n    side = \"l\"\n  )\n\n\n\n\n\n\n\nFigureÂ 9: Half-Violin Plot Using the penguins dataset\n\n\n\n\n\n\n\n6. Violin Plot Using the ggstatsplot Package\nThe ggstatsplot package extends ggplot2 by adding powerful statistical visualizations. The ggbetweenstats() function allows the creation of combined violin plots, box plots, and scatter plots.\nIn the following example, we visualize the distribution of bill lengths across different penguin species using the penguins dataset. We further enhance the plotâ€™s aesthetics using the theme() function.\n\nplt &lt;- ggbetweenstats(\n  data = data_penguins,\n  x = species,\n  y = bill_length_mm\n) +\n# Beautification\n  labs(  ## Add labels and title\n    x = \"Penguins Species\",\n    y = \"Bill Length\",\n    title = \"Distribution of bill length across penguins species\"\n  ) +\n  theme(\n    axis.ticks = element_blank(),\n    axis.line = element_line(colour = \"grey50\"),\n    panel.grid = element_line(color = \"#b4aea9\"),\n    panel.grid.minor = element_blank(),\n    panel.grid.major.x = element_blank(),\n    panel.grid.major.y = element_line(linetype = \"dashed\"),\n    panel.background = element_rect(fill = \"#fbf9f4\", color = \"#fbf9f4\"),\n    plot.background = element_rect(fill = \"#fbf9f4\", color = \"#fbf9f4\")\n  )\n\nplt\n\n\n\n\n\n\n\nFigureÂ 10: Violin Plot Using the ggstatsplot Package",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Violin Plot"
    ]
  },
  {
    "objectID": "Distribution/ViolinPlot.html#application",
    "href": "Distribution/ViolinPlot.html#application",
    "title": "Violin Plot",
    "section": "Application",
    "text": "Application\n\n1. Basic Violin Plot\n\n\n\n\n\n\nFigureÂ 11: Applications of Basic Violin Plot\n\n\n\nFigureÂ 11 e is a violin plot of the relative abundances of circRNAs in seven types of cancer tissues and their corresponding normal tissues [1].\n\n\n2. Grouped Violin Plot\n\n\n\n\n\n\nFigureÂ 12: Applications of Grouped Violin Plot\n\n\n\nThe above violin plot analyzes and compares the levels and distributions of 31 proteins and mRNAs in single A549 cells [2].\n\n\n3. Half-Violin Plot\n\n\n\n\n\n\nFigureÂ 13: Applications of Half-Violin Plot\n\n\n\nFigureÂ 13 E uses a half-violin plot to analyze the clone size distribution of WT clones in WT intestines (left) or Mâˆ’/+ intestines (middle and right figures) [3].\n\n\n4. Violin Plot with Boxplot\n\n\n\n\n\n\nFigureÂ 14: Applications of Violin Plot with Boxplot\n\n\n\nFigureÂ 14 D shows the expected median MSD and distribution of droplets attached to the substrate (noise) and in water (stimulation), as well as the nanoscale RMS displacement [4].",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Violin Plot"
    ]
  },
  {
    "objectID": "Distribution/ViolinPlot.html#reference",
    "href": "Distribution/ViolinPlot.html#reference",
    "title": "Violin Plot",
    "section": "Reference",
    "text": "Reference\n[1] Zheng Q, Bao C, Guo W, Li S, Chen J, Chen B, Luo Y, Lyu D, Li Y, Shi G, Liang L, Gu J, He X, Huang S. Circular RNA profiling reveals an abundant circHIPK3 that regulates cell growth by sponging multiple miRNAs. Nat Commun. 2016 Apr 6;7:11215. doi: 10.1038/ncomms11215. PMID: 27050392; PMCID: PMC4823868.\n[2] Gong H, Wang X, Liu B, Boutet S, Holcomb I, Dakshinamoorthy G, Ooi A, Sanada C, Sun G, Ramakrishnan R. Single-cell protein-mRNA correlation analysis enabled by multiplexed dual-analyte co-detection. Sci Rep.Â 2017 Jun 5;7(1):2776. doi: 10.1038/s41598-017-03057-5. PMID: 28584233; PMCID: PMC5459813.\n[3] Kolahgar G, Suijkerbuijk SJ, Kucinski I, Poirier EZ, Mansour S, Simons BD, Piddini E. Cell Competition Modifies Adult Stem Cell and Tissue Population Dynamics in a JAK-STAT-Dependent Manner. Dev Cell. 2015 Aug 10;34(3):297-309. doi: 10.1016/j.devcel.2015.06.010. Epub 2015 Jul 23. PMID: 26212135; PMCID: PMC4537514.\n[4] Cribb JA, Osborne LD, Beicker K, Psioda M, Chen J, Oâ€™Brien ET, Taylor Ii RM, Vicci L, Hsiao JP, Shao C, Falvo M, Ibrahim JG, Wood KC, Blobe GC, Superfine R. An Automated High-throughput Array Microscope for Cancer Cell Mechanics. Sci Rep.Â 2016 Jun 6;6:27371. doi: 10.1038/srep27371. PMID: 27265611; PMCID: PMC4893602.\n[5] Wickham H, Vaughan D, Girlich M (2024). tidyr: Tidy Messy Data. R package version 1.3.1, https://CRAN.R-project.org/package=tidyr.\n[6] H. Wickham. ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York, 2016.\n[7] Wickham H, FranÃ§ois R, Henry L, MÃ¼ller K, Vaughan D (2023). dplyr: A Grammar of Data Manipulation. R package version 1.1.4, https://CRAN.R-project.org/package=dplyr.\n[8] Tiedemann F (2022). gghalves: Compose Half-Half Plots Using Your Favourite Geoms. R package version 0.1.4, https://CRAN.R-project.org/package=gghalves.\n[9] Wickham H (2023). forcats: Tools for Working with Categorical Variables (Factors). R package version 1.0.0, https://CRAN.R-project.org/package=forcats.\n[10] Rudis B (2024). hrbrthemes: Additional Themes, Theme Components and Utilities for â€˜ggplot2â€™. R package version 0.8.7, https://CRAN.R-project.org/package=hrbrthemes.\n[11] Simon Garnier, Noam Ross, Robert Rudis, AntÃ´nio P. Camargo, Marco Sciaini, and CÃ©dric Scherer (2024). viridis(Lite) - Colorblind-Friendly Color Maps for R. viridis package version 0.6.5.\n[12] Patil, I. (2021). Visualizations with statistical details: The â€˜ggstatsplotâ€™ approach. Journal of Open Source Software, 6(61), 3167, doi:10.21105/joss.03167\n[13] Horst AM, Hill AP, Gorman KB (2020). palmerpenguins: Palmer Archipelago (Antarctica) penguin data. R package version 0.1.0. https://allisonhorst.github.io/palmerpenguins/. doi: 10.5281/zenodo.3960218.",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Violin Plot"
    ]
  },
  {
    "objectID": "Distribution/BoxPlot.html",
    "href": "Distribution/BoxPlot.html",
    "title": "Box Plot",
    "section": "",
    "text": "Boxplots visualize the central tendency and dispersion of one or more sets of continuous quantitative data. They incorporate statistical measures that not only compare differences across categories but also reveal dispersion, outliers, and distribution patterns.\nA boxplot is defined by five key lines: the upper boundary, upper quartile, median, lower quartile, and lower boundary. Points beyond the upper or lower boundary are considered outliers.",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Box Plot"
    ]
  },
  {
    "objectID": "Distribution/BoxPlot.html#example",
    "href": "Distribution/BoxPlot.html#example",
    "title": "Box Plot",
    "section": "Example",
    "text": "Example",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Box Plot"
    ]
  },
  {
    "objectID": "Distribution/BoxPlot.html#setup",
    "href": "Distribution/BoxPlot.html#setup",
    "title": "Box Plot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming Language: R\nPackages: ggplot2, dplyr, hrbrthemes, viridis, ggExtra, ggpubr, rstatix, ggtext, ggpmisc\n\n\n# Installing necessary packages\nif (!requireNamespace(\"readr\", quietly = TRUE)) {\n  install.packages(\"readr\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"hrbrthemes\", quietly = TRUE)) {\n  remotes::install_github(\"hrbrmstr/hrbrthemes\")\n}\nif (!requireNamespace(\"viridis\", quietly = TRUE)) {\n  install.packages(\"viridis\")\n}\nif (!requireNamespace(\"ggExtra\", quietly = TRUE)) {\n  install.packages(\"ggExtra\")\n}\nif (!requireNamespace(\"ggpubr\", quietly = TRUE)) {\n  install.packages(\"ggpubr\")\n}\nif (!requireNamespace(\"rstatix\", quietly = TRUE)) {\n  install.packages(\"rstatix\")\n}\nif (!requireNamespace(\"ggtext\", quietly = TRUE)) {\n  install.packages(\"ggtext\")\n}\nif (!requireNamespace(\"ggpmisc\", quietly = TRUE)) {\n  install.packages(\"ggpmisc\")\n}\n\n# Loading the libraries\nlibrary(readr)\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(hrbrthemes)\nlibrary(viridis)\nlibrary(ggpubr)\nlibrary(rstatix)\nlibrary(ggtext)\nlibrary(ggpmisc)\nlibrary(ggExtra)",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Box Plot"
    ]
  },
  {
    "objectID": "Distribution/BoxPlot.html#data-preparation",
    "href": "Distribution/BoxPlot.html#data-preparation",
    "title": "Box Plot",
    "section": "Data Preparation",
    "text": "Data Preparation\nWe used the built-in R datasets (mtcars), data from ggplot2 package (mpg, diamonds) and the TCGA-BRCA.htseq_counts.tsv dataset from UCSC Xena DATASETS. Selected genes were chosen for demonstration purposes.\n\n# Load mtcars dataset\ndata(\"mtcars\")\ndata_mtcars &lt;- mtcars\n\n# Load mpg dataset from ggplot2 package\ndata_mpg &lt;- ggplot2::mpg\n\n# Load diamonds dataset from ggplot2 package\ndata_diamonds &lt;- ggplot2::diamonds\n\n# Load the TCGA-BRCA gene expression dataset from a processed CSV file  \ndata_TCGA &lt;- readr::read_csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/TCGA-BRCA.htseq_counts_processed.csv\")\ndata_TCGA1 &lt;- data_TCGA[1:5,] %&gt;%\n  gather(key = \"sample\",value = \"gene_expression\",3:1219)",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Box Plot"
    ]
  },
  {
    "objectID": "Distribution/BoxPlot.html#visualization",
    "href": "Distribution/BoxPlot.html#visualization",
    "title": "Box Plot",
    "section": "Visualization",
    "text": "Visualization\n\n1. Basic Plotting\n\nBasic Plotting\nThe ggplot2 package allows the use of geom_boxplot() to create a basic boxplot.\nTaking the TCGA-BRCA.htseq_counts.tsv dataset as an example:\n\nggplot(data_TCGA1, aes(x=as.factor(gene_name), y=gene_expression)) + \n  geom_boxplot(fill=\"slateblue\", alpha=0.2) + # color fill and font size\n  xlab(\"gene_name\") # x-axis label\n\n\n\n\n\n\n\n\n\n\nParameter Adjustment\nTaking the mtcars dataset as an example:\n\nggplot(data_mtcars, aes(x=as.factor(cyl), y=mpg)) + \n  geom_boxplot(\n    # box\n    color=\"blue\",\n    fill=\"blue\",\n    alpha=0.2,\n    # notch\n    notch=TRUE,\n    notchwidth = 0.8,\n    # outliers\n    outlier.colour=\"red\",\n    outlier.fill=\"red\",\n    outlier.size=3\n  ) + \n  xlab(\"cyl\")\n\n\n\n\n\n\n\n\n\n\nColor Settings\nTaking the mpg dataset as an example, several common color scales for boxplots are demonstrated:\n\nggplot(data_mpg, aes(x=class, y=hwy)) + \n  geom_boxplot(color=\"red\", fill=\"orange\", alpha=0.2)\n\n\n\n\n\n\n\n\n\n\nggplot(data_mpg, aes(x=class, y=hwy, fill=class)) + \n  geom_boxplot(alpha=0.3) +\n  theme(legend.position=\"none\")\n\n\n\n\n\n\n\n\n\n\nggplot(data_mpg, aes(x=class, y=hwy, fill=class)) + \n  geom_boxplot(alpha=0.3) +\n  theme(legend.position=\"none\") +\n  scale_fill_brewer(palette=\"Dark2\")\n\n\n\n\n\n\n\n\n\n\nGroup Highlighting\nTaking the mpg dataset as an example, different colors are set for groups that need to be highlighted:\n\ndata_mpg %&gt;% \n  # add highlighted group, create color vector\n  mutate(type=ifelse(class==\"subcompact\",\"Highlighted\",\"Normal\")) %&gt;%\n  # fill=type, map the color vector to the boxplot\n  ggplot(aes(x=class, y=hwy, fill=type, alpha=type)) + \n  geom_boxplot() +\n  scale_fill_manual(values=c(\"#69b3a2\", \"grey\")) +\n  scale_alpha_manual(values=c(1,0.1)) +\n  theme_ipsum() +\n  theme(legend.position = \"none\") +\n  xlab(\"\")\n\n\n\n\n\n\n\n\n\n\n\n2. Variable Width Boxplot\nThe basic boxplot does not display the sample size information of categories. We can draw a variable width boxplot where the box width is proportional to the sample size by using the varwidth parameter.\n\nnames &lt;- c(rep(\"A\", 20) , rep(\"B\", 5) , rep(\"C\", 30), rep(\"D\", 100))\nvalue &lt;- c(sample(2:5, 20 , replace=T) , sample(4:10, 5 , replace=T), sample(1:7, 30 , replace=T), sample(3:8, 100 , replace=T))\ndata &lt;- data.frame(names,value)\n# create corresponding x-axis labels\nmy_xlab &lt;- paste(levels(data$names),\"\\n(N=\",table(data$names),\")\",sep=\"\")\n\n# plotting\nggplot(data, aes(x=names, y=value, fill=names)) +\n  geom_boxplot(varwidth = TRUE, alpha=0.2) + # varwidth = TRUE achieves width proportional to sample size\n  theme(legend.position=\"none\") +\n  scale_x_discrete(labels=my_xlab)\n\n\n\n\n\n\n\n\nTaking the mpg dataset as an example again:\n\nggplot(data_mpg, aes(x=class, y=hwy, fill=class)) + \n  geom_boxplot(varwidth = TRUE,alpha=0.3) +\n  theme(legend.position=\"none\") +\n  scale_fill_brewer(palette=\"Dark2\")\n\n\n\n\n\n\n\n\n\n\n3. Boxplot for Continuous Variables\nFor continuous variables, we can use the cut_width() function to divide the continuous variable into intervals and then draw the boxplot.\nTaking the diamonds dataset as an example:\n\ndata_diamonds %&gt;%\n  # create a new variable, divide the continuous variable into intervals (0.5 as one interval)\n  mutate(bin=cut_width(carat, width=0.5, boundary=0)) %&gt;%\n  # plotting, use the divided intervals as x\n  ggplot(aes(x=bin, y=price)) +\n  geom_boxplot(fill=\"#69b3a2\") +\n  theme_ipsum() +\n  xlab(\"Carat\")\n\n\n\n\n\n\n\n\n\n\n4. Boxplot with Mean Values\nThe basic boxplot displays the median for each group. We can also use the stat_summary() function to add the mean value for each group to the boxplot.\n\nnames=c(rep(\"A\", 20) , rep(\"B\", 8) , rep(\"C\", 30), rep(\"D\", 80))\nvalue=c( sample(2:5, 20 , replace=T) , sample(4:10, 8 , replace=T), sample(1:7, 30 , replace=T), sample(3:8, 80 , replace=T) )\ndata=data.frame(names,value)\n# Plotting\np &lt;- ggplot(data, aes(x=names, y=value, fill=names)) +\n  geom_boxplot(alpha=0.7) +\n  stat_summary(fun.y=mean, geom=\"point\", shape=20, size=14, color=\"white\", fill=\"white\") +\n  theme(legend.position=\"none\") +\n  scale_fill_brewer(palette=\"Set1\")\np\n\n\n\n\n\n\n\n\nUsing the mpg dataset as an example again\n\nggplot(data_mpg, aes(x=class, y=hwy, fill=class)) + \n  geom_boxplot(varwidth = TRUE,alpha=0.3) +\n  stat_summary(fun.y=mean, geom=\"point\", shape=10, size=5, color=\"black\", fill=\"black\") +\n  # fun.y specifies the type of statistic to add, geom specifies the type of geometric object, shape specifies the shape of the point, and size specifies the size\n\n  theme(legend.position=\"none\") +\n  scale_fill_brewer(palette=\"Dark2\")\n\n\n\n\n\n\n\n\n\n\n5. Scatter Boxplot & Violin Plot\n\nScatter Boxplot\nBoxplots are often used to compare the distributions of multiple groups, but they do not show the specific distribution of the data (for example, it is impossible to determine whether the distribution is normal or bimodal from a boxplot). We can use the geom_jitter() function to add individual observations, allowing us to see the specific distribution of each group.\n\ndata &lt;- data.frame(\n  name=c( rep(\"A\",500), rep(\"B\",500), rep(\"B\",500), rep(\"C\",20), rep('D', 100)  ),\n  value=c( rnorm(500, 10, 5), rnorm(500, 13, 1), rnorm(500, 18, 1), rnorm(20, 25, 4), rnorm(100, 12, 1) )\n)\n\n\ndata %&gt;%\n  ggplot( aes(x=name, y=value, fill=name)) +\n  geom_boxplot() +\n  scale_fill_viridis(discrete = TRUE, alpha=0.6) +\n  geom_jitter(color=\"black\", size=0.4, alpha=0.9) + # Plotting scatter points\n  theme_ipsum() +\n  theme(\n    legend.position=\"none\",\n    plot.title = element_text(size=11)\n  ) +\n  ggtitle(\"A boxplot with jitter\") +\n  xlab(\"\")\n\n\n\n\n\n\n\n\n\n\n\nViolin Plot\nViolin plots combine the features of boxplots and density distribution plots, also showing the specific distribution of observations within groups.\n\ndata &lt;- data.frame(\n  name=c( rep(\"A\",500), rep(\"B\",500), rep(\"B\",500), rep(\"C\",20), rep('D', 100)  ),\n  value=c( rnorm(500, 10, 5), rnorm(500, 13, 1), rnorm(500, 18, 1), rnorm(20, 25, 4), rnorm(100, 12, 1) )\n)\n\ndata %&gt;%\n  ggplot( aes(x=name, y=value, fill=name)) +\n  geom_violin() +\n  scale_fill_viridis(discrete = TRUE, alpha=0.6, option=\"A\") +\n  theme_ipsum() +\n  theme(\n    legend.position=\"none\",\n    plot.title = element_text(size=11)\n  ) +\n  ggtitle(\"Violin chart\") +\n  xlab(\"\")\n\n\n\n\n\n\n\n\n\n\n\n6. Grouped Boxplot\nOn the basis of single-group comparison, we can use the fill parameter to draw grouped boxplots, which facilitates comparisons both between and within groups.\n\nvariety=rep(LETTERS[1:4], each=40)\ntreatment=rep(c(\"high\",\"low\"),each=20)\nnote=seq(1:160)+sample(1:150, 160, replace=T)\ndata=data.frame(variety, treatment ,  note)\n\n# Plotting\nggplot(data, aes(x=variety, y=note, fill=treatment)) + # The fill parameter adds grouping\n  geom_boxplot()\n\n\n\n\n\n\n\n\nAdding statistics analysis:\n\nvariety=rep(LETTERS[1:4], each=40)\ntreatment=rep(c(\"high\",\"low\"),each=20)\nnote=seq(1:160)+sample(1:150, 160, replace=T)\ndata=data.frame(variety, treatment ,  note)\n\n# Difference test\n# Within groups\ndf &lt;- data\ndf$variety &lt;- factor(df$variety)\ndf_p_val1 &lt;- df %&gt;% \n  group_by(variety) %&gt;% \n  wilcox_test(formula = note~treatment) %&gt;% \n  add_significance(p.col = 'p',cutpoints = c(0,0.001,0.01,0.05,1),symbols = c('***','**','*','ns')) %&gt;% \n  add_xy_position(x='variety')\n# Between groups\ndf_p_val2 &lt;- df %&gt;% \n  wilcox_test(formula = note~variety) %&gt;% \n  add_significance(p.col = 'p',cutpoints = c(0,0.001,0.01,0.05,1),symbols = c('***','**','*','ns')) %&gt;% \n  add_xy_position()\n\n\n# Plotting\nggplot()+\n  geom_boxplot(data = df,mapping = aes(x=variety, y=note, fill=treatment),width=0.5)+\n  stat_pvalue_manual(df_p_val1,label = '{p.signif}',\n                     tip.length = 0)+\n  stat_pvalue_manual(df_p_val2,label = '{p.signif}',\n                     tip.length = 0.01,\n                     y.position = df_p_val2$y.position+0.5)+\n  labs(x='variety',y='note')+\n  guides(fill=guide_legend(title = 'treatment'))+\n  theme_test()+\n  theme(axis.text = element_text(color = 'black'),\n        plot.caption = element_markdown(face = 'bold'),\n        legend.position = c(0.7,0.1),\n        legend.direction = 'horizontal')\n\n\n\n\n\n\n\n\n\nIn addition to grouped boxplots, we can also draw boxplots for each subgroup separately for comparison.\n\nvariety=rep(LETTERS[1:7], each=40)\ntreatment=rep(c(\"high\",\"low\"),each=20)\nnote=seq(1:280)+sample(1:150, 280, replace=T)\ndata1=data.frame(variety, treatment ,  note)\n# treatment as the basis\np1 &lt;- ggplot(data1, aes(x=variety, y=note, fill=treatment)) + \n  geom_boxplot() +\n    facet_wrap(~treatment, scale=\"free\")+\n  labs(x='variety',y='note')+\n  guides(fill=guide_legend(title = 'treatment'))+\n  theme_test()+\n  theme(axis.text = element_text(color = 'black'),\n        plot.caption = element_markdown(face = 'bold'),\n        legend.position = c(0.9,0.1),\n        legend.direction = 'horizontal')\np1\n\n\n\n\n\n\n\n\n\n# variety as the basis\np2 &lt;- ggplot(data1, aes(x=variety, y=note, fill=treatment)) + \n  geom_boxplot() +\n  facet_wrap(~variety, scale=\"free\")+\n  labs(x='variety',y='note')+\n  guides(fill=guide_legend(title = 'treatment'))+\n  theme_test()+\n  theme(axis.text = element_text(color = 'black'),\n        plot.caption = element_markdown(face = 'bold'),\n        legend.position = c(0.9,-0.05),\n        legend.direction = 'horizontal')\np2\n\n\n\n\n\n\n\n\n\n\n7. Adding Marginal Distributions to Boxplots\nAdding marginal distributions on the X and Y axes is a common visualization method. We can achieve this using the ggExtra package. Here, we mainly introduce the addition of marginal distributions to boxplots.\nTaking the mtcars dataset as an example:\n\n# Original scatter plot\np1&lt;-ggplot(data_mtcars, aes(x=wt, y=mpg, color=cyl, size=cyl))+\n  geom_point()+\n  theme_bw()+ \n  geom_smooth(method = 'lm', formula = y~x, se = TRUE, show.legend = FALSE) + \n  stat_poly_eq(aes(label = paste(..eq.label.., ..rr.label.., stat(p.value.label), sep = '~`,`~')),\n               formula = y~x, parse = TRUE, npcx= 'left', npcy= 'bottom', size = 4)\n\np1\n\n\n\n\n\n\n\n\n\n# Adding marginal boxplot distributions\np1 &lt;- ggMarginal(p1, type=\"boxplot\")\np1\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nThe main customizable parameters of ggMarginal() are:\n\nsize to change the size of the marginal plot\nAll common appearance customization parameters\nmargins = 'x' or margins = 'y' to display only one marginal plot",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Box Plot"
    ]
  },
  {
    "objectID": "Distribution/BoxPlot.html#application",
    "href": "Distribution/BoxPlot.html#application",
    "title": "Box Plot",
    "section": "Application",
    "text": "Application\n\n1. Basic Boxplot\n\n\n\n\n\n\nFigureÂ 1: Applications of Basic Boxplot\n\n\n\nFigure E: Fab-PLA results quantified using BlobFinder software and presented in the form of a boxplot. The median is highlighted with a thick line, and the whiskers represent the minimum and maximum values. It shows the distribution of PLA signal quantification data for each group of cells.[1]\n\n\n2. Highlighted Boxplot\n\n\n\n\n\n\nFigureÂ 2: Applications of Highlighted Boxplot\n\n\n\nFigure B: Boxplot of probe distance distribution.\nFigure D & Figure F: Boxplots of the maximum nuclear cross-sectional area distribution in H2A-overexpressing cells in MDA-MB-453 (D) or HEK293 (F). Groups with significant differences are highlighted.[2]\n\n\n3. Grouped Boxplot\n\n\n\n\n\n\nFigureÂ 3: Applications of Grouped Boxplot\n\n\n\nFigure C: Boxplot of genome size for organisms with H2A that does or does not contain the shown residues.[2]",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Box Plot"
    ]
  },
  {
    "objectID": "Distribution/BoxPlot.html#reference",
    "href": "Distribution/BoxPlot.html#reference",
    "title": "Box Plot",
    "section": "Reference",
    "text": "Reference\n[1] Volkmann C, Brings N, Becker M, Hobeika E, Yang J, Reth M. Molecular requirements of the B-cell antigen receptor for sensing monovalent antigens. EMBO J. 2016 Nov 2;35(21):2371-2381. doi: 10.15252/embj.201694177. Epub 2016 Sep 15. PMID: 27634959; PMCID: PMC5090217.\n[2] Macadangdang BR, Oberai A, Spektor T, Campos OA, Sheng F, Carey MF, Vogelauer M, Kurdistani SK. Evolution of histone 2A for chromatin compaction in eukaryotes. Elife. 2014 Jun 17;3:e02792. doi: 10.7554/eLife.02792. PMID: 24939988; PMCID: PMC4098067.\n[3] H. Wickham. ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York, 2016.\n[4] Wickham H, FranÃ§ois R, Henry L, MÃ¼ller K, Vaughan D (2023). dplyr: A Grammar of Data Manipulation. R package version 1.1.4, https://CRAN.R-project.org/package=dplyr.\n[5] Rudis B (2024). hrbrthemes: Additional Themes, Theme Components and Utilities for â€˜ggplot2â€™. R package version 0.8.7, https://CRAN.R-project.org/package=hrbrthemes.\n[6] Wickham H, Averick M, Bryan J, Chang W, McGowan LD, FranÃ§ois R, Grolemund G, Hayes A, Henry L, Hester J, Kuhn M, Pedersen TL, Miller E, Bache SM, MÃ¼ller K, Ooms J, Robinson D, Seidel DP, Spinu V, Takahashi K, Vaughan D, Wilke C, Woo K, Yutani H (2019). â€œWelcome to the tidyverse.â€ Journal of Open Source Software, 4(43), 1686. doi:10.21105/joss.01686 https://doi.org/10.21105/joss.01686.\n[7] Simon Garnier, Noam Ross, Robert Rudis, AntÃ´nio P. Camargo, Marco Sciaini, and CÃ©dric Scherer (2024). viridis(Lite) - Colorblind-Friendly Color Maps for R. viridis package version 0.6.5.\n[8] Attali D, Baker C (2023). ggExtra: Add Marginal Histograms to â€˜ggplot2â€™, and More â€˜ggplot2â€™ Enhancements. R package version 0.10.1, https://CRAN.R-project.org/package=ggExtra.",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Box Plot"
    ]
  },
  {
    "objectID": "Distribution/Density.html",
    "href": "Distribution/Density.html",
    "title": "Density Plot",
    "section": "",
    "text": "A density plot represents the distribution of a numerical variable using kernel density estimation to display the probability density function. It is a smoothed version of a histogram, sharing the same concept but providing a clearer representation of the overall trend and shape of the data.",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Density Plot"
    ]
  },
  {
    "objectID": "Distribution/Density.html#example",
    "href": "Distribution/Density.html#example",
    "title": "Density Plot",
    "section": "Example",
    "text": "Example\n\n\n\n\n\nThis density plot illustrates the distribution of expression levels for the TSPAN6 gene across multiple samples. The x-axis represents the data values (e.g., gene expression levels ranging from 8 to 15), while the y-axis represents density, not absolute counts. The y-axis can be interpreted as the â€œrelative frequencyâ€ of data values within a specific interval. The total area under the density curve is 1, representing the relative probability distribution of the data across the x-axis. In simpler terms, it measures the proportion of samples within a specific value range relative to the total sample size.\nUnlike histograms, which use absolute frequencies on the y-axis, density plots use density values, resulting in a smoother representation of data distribution. This allows for a clearer visualization of the dataâ€™s central tendency and overall distribution characteristics.\nThe plot shows that the expression levels of the TSPAN6 gene are concentrated between 10 and 13, with a peak around 12, indicating that most samples have relatively consistent expression levels. The unimodal distribution suggests that the expression pattern of TSPAN6 is stable across most samples.",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Density Plot"
    ]
  },
  {
    "objectID": "Distribution/Density.html#setup",
    "href": "Distribution/Density.html#setup",
    "title": "Density Plot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming Language: R\nDependencies: readr; ggplot2, ggExtra, hrbrthemes, dplyr, tidyr, viridis, ggpmisc, ggpubr, geomtextpath, cowplot\n\n\n# Installing necessary packages \nif (!requireNamespace(\"readr\", quietly = TRUE)) {   \n  install.packages(\"readr\") \n} \nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {   \n  install.packages(\"ggplot2\") \n} \nif (!requireNamespace(\"ggExtra\", quietly = TRUE)) {   \n  install.packages(\"ggExtra\") \n} \nif (!requireNamespace(\"hrbrthemes\", quietly = TRUE)) {\n  remotes::install_github(\"hrbrmstr/hrbrthemes\") \n} \nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\") \n} \nif (!requireNamespace(\"tidyr\", quietly = TRUE)) {\n  install.packages(\"tidyr\") \n} \nif (!requireNamespace(\"viridis\", quietly = TRUE)) {\n  install.packages(\"viridis\") \n} \nif (!requireNamespace(\"ggpmisc\", quietly = TRUE)) {\n  install.packages(\"ggpmisc\") \n} \nif (!requireNamespace(\"ggpubr\", quietly = TRUE)) {\n  install.packages(\"ggpubr\") \n} \nif (!requireNamespace(\"geomtextpath\", quietly = TRUE)) {\n  install.packages(\"geomtextpath\") \n}  \nif (!requireNamespace(\"cowplot\", quietly = TRUE)) {\n  install.packages(\"cowplot\")\n}\n\n# Loading the libraries\nlibrary(readr)         # For read files\nlibrary(ggplot2)       # For creating plots \nlibrary(ggExtra)       # For enhancing ggplot2 graphics \nlibrary(hrbrthemes)    # For professional themes \nlibrary(dplyr)         # For data manipulation\nlibrary(tidyr)         # For reshaping data\nlibrary(viridis)       # For color maps \nlibrary(ggpmisc)       # For statistical annotations \nlibrary(ggpubr)        # For publication-ready themes \nlibrary(geomtextpath)  # For adding text to density curves\nlibrary(cowplot)        # Plot alignment and annotation package",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Density Plot"
    ]
  },
  {
    "objectID": "Distribution/Density.html#data-preparation",
    "href": "Distribution/Density.html#data-preparation",
    "title": "Density Plot",
    "section": "Data Preparation",
    "text": "Data Preparation\nHereâ€™s a brief tutorial using the built-in R datasets (iris, mtcars, diamonds) and the TCGA-LIHC.htseq_counts.tsv dataset from UCSC Xena DATASETS. This example demonstrates how to load and work with these datasets in R.\n\n# Read the TSV data \ndata &lt;- readr::read_csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/TCGA-LIHC.htseq_counts.csv.gz\")\n\n# Filter and reshape data for the first gene TSPAN6 (Ensembl ID: ENSG00000000003.13)\ndata1 &lt;- data %&gt;%   \n  filter(Ensembl_ID == \"ENSG00000000003.13\") %&gt;%   \n  pivot_longer(     \n    cols = -Ensembl_ID,      \n    names_to = \"sample\",      \n    values_to = \"expression\"   \n    ) %&gt;%   \n  mutate(var = \"var1\")  # Add a column to differentiate the variables  \n\n# Filter and reshape data for the second gene SCYL3 (Ensembl ID: ENSG00000000457.12)\ndata2 &lt;- data %&gt;%   \n  filter(Ensembl_ID == \"ENSG00000000457.12\") %&gt;%   \n  pivot_longer(     \n    cols = -Ensembl_ID,      \n    names_to = \"sample\",      \n    values_to = \"expression\"   \n    ) %&gt;%   \n  mutate(var = \"var2\")  # Add a column to differentiate the variables  \n\n# Combine the two datasets \ndata12 &lt;- bind_rows(data1, data2)  \n\n# View the final combined dataset \nhead(data12)\n\n# A tibble: 6 Ã— 4\n  Ensembl_ID         sample           expression var  \n  &lt;chr&gt;              &lt;chr&gt;                 &lt;dbl&gt; &lt;chr&gt;\n1 ENSG00000000003.13 TCGA-DD-A4NG-01A      12.8  var1 \n2 ENSG00000000003.13 TCGA-G3-AAV4-01A       9.72 var1 \n3 ENSG00000000003.13 TCGA-2Y-A9H1-01A      11.3  var1 \n4 ENSG00000000003.13 TCGA-CC-A3M9-01A      11.6  var1 \n5 ENSG00000000003.13 TCGA-K7-AAU7-01A      11.5  var1 \n6 ENSG00000000003.13 TCGA-BC-A10W-01A      12.0  var1",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Density Plot"
    ]
  },
  {
    "objectID": "Distribution/Density.html#visualization",
    "href": "Distribution/Density.html#visualization",
    "title": "Density Plot",
    "section": "Visualization",
    "text": "Visualization\n\n1. Basic Density Plot\nIn the ggplot2 package, you can create a density plot using geom_density, which requires only a numeric variable as input.\n\n# Basic Density Plot \np1 &lt;- ggplot(data1, aes(x = expression)) +   \n  geom_density(fill = \"#69b3a2\", color = \"#e9ecef\", alpha = 0.8) +   \n  labs(title = \"Density Plot of TSPAN6 Expression Levels\",        \n       x = \"Expression\",        \n       y = \"Density\") +   \n  theme_minimal()  \np1\n\n\n\n\n\n\n\nFigureÂ 1: Basic Density Plot\n\n\n\n\n\nFigureÂ 1 illustrates the distribution of expression levels of the TSPAN6 gene across multiple samples from LIHC patients sourced from TCGA.\n\n\n\n\n\n\nTip\n\n\n\ntheme_ipsum You can use the theme_ipsum from the hrbrthemes package: it is easy to use and makes your charts look more professional. As you can see, theme_ipsum() comes with a set of pre-configured settings, such as font size, color, and gridlines, which adhere to good visualization practices, are well-designed, and are ready for publishing.\n\nggplot(data1, aes(x = expression)) +\n  geom_density(fill = \"#69b3a2\", color = \"#e9ecef\", alpha = 0.8) +\n  labs(title = \"Density Plot of TSPAN6 Expression Levels\",\n       x = \"Expression\",\n       y = \"Density\") +\n  theme_ipsum()\n\n\n\n\n\n\n\nFigureÂ 2: Themed Density Plot\n\n\n\n\n\n\n\n\n\n2. Mirrored Density Plot\nThe mirror density plot helps us intuitively compare the distributions of two datasets. Through the mirrored structure, we can quickly determine whether the two datasets exhibit symmetry or differences. The mirror density plot combines two density plots into a single graph, reducing the required visualization space while maintaining a clear description of the data distribution.\n\n# Create a mirrored density plot \nggplot(data12, aes(x = expression, fill = var)) +\n\n  # Draw the upper density curve\n  geom_density(data = filter(data12, var == \"var1\"), aes(y = ..density..), fill = \"#69b3a2\", alpha = 0.8) +\n  geom_label(data = filter(data12, var == \"var1\"), aes(x = median(expression), y = 0.25, label = \"TSPAN6\"), color = \"white\", fill = \"#1b9e77\") +\n  \n  # Draw the lower density curve\n  geom_density(data = filter(data12, var == \"var2\"), aes(y = -..density..), fill = \"#404080\", alpha = 0.8) +\n  geom_label(data = filter(data12, var == \"var2\"), aes(x = median(expression), y = -0.25, label = \"C1QA\"), color = \"white\", fill = \"#7570b3\") +  \n\n  # Beautify the plot\n  xlab(\"Expression\") +\n  ylab(\"Density\") +\n  ggtitle(\"Mirror Density Plot of TSPAN6 and C1QA\") +\n  theme(legend.position = \"none\") +\n  theme_minimal()\n\n\n\n\n\n\n\nFigureÂ 3: Mirrored Density Plot\n\n\n\n\n\nFigureÂ 3 demonstrates the expression distribution of the TSPAN6 and C1QA genes in LIHC patients sourced from TCGA. The same approach can also be used to generate a mirrored histogram.\n\n\n3. Multiple Groups Density Plot\nA multi-group density plot allows for an intuitive comparison of the distribution differences between different groups, helping to identify trends, patterns, and outliers, while presenting data from multiple groups on the same plot, making it easier to compare group characteristics. However, when there are many groups or the distribution curves overlap, the plot can become cluttered, making it difficult to distinguish the differences between groups, which reduces the readability of the chart. Transparency adjustments can be made to reduce visual interference from overlapping areas. However, this method can only improve the visualization to a certain extent and is not a universal solution. Other plotting methods discussed later in this document (e.g., facet density plots) can be used to resolve this issue.\n\n# Without transparency (left)\np1 &lt;- ggplot(data=diamonds, aes(x=price, group=cut, fill=cut)) +\n  geom_density(adjust=1.5) +\n  theme_minimal() +\n  ggtitle(\"p1\")\n\n# With transparency (right)\np2 &lt;- ggplot(data=diamonds, aes(x=price, group=cut, fill=cut)) +\n  geom_density(adjust=1.5, alpha=.4) +\n  theme_minimal() +\n  ggtitle(\"p2\")\n\nplot_grid(p1, p2, ncol = 2)\n\n\n\n\n\n\n\nFigureÂ 4: Multiple Groups Density Plot Using the Diamonds Dataset\n\n\n\n\n\nFigureÂ 4 compares the density distributions of the diamonds datasetâ€™s price under different transparency settings. The left plot (p1) does not apply transparency, with all group fill colors opaque. The graph is overall crowded, and there is significant overlap between groups, making it hard to interpret the information. The right plot (p2) applies transparency, making the color layering effects between different groups more prominent, thus allowing for a clearer observation of the density distribution characteristics of each group.\n\n# Create annotation framework\nannot &lt;- data.frame(\n  Species = c(\"setosa\", \"versicolor\", \"virginica\"),\n  x = c(1.8, 4, 5.1),  # Annotation positions for each species\n  y = c(0.5, 0.9, .8)\n)\n\n# Generate density plot\nggplot(filter(iris, Species %in% c(\"setosa\", \"versicolor\", \"virginica\")), aes(x = Petal.Length, color = Species, fill = Species)) +\n  geom_density(alpha = 0.6) +\n  scale_fill_viridis(discrete = TRUE) +\n  scale_color_viridis(discrete = TRUE) +\n  geom_text(data = annot, aes(x = x, y = y, label = Species, color = Species), hjust = 0, size = 4.5) +\n  theme_minimal() +\n  theme(\n    legend.position = \"none\"\n  ) +\n  ylab(\"\") +\n  xlab(\"Petal Length (cm)\")\n\n\n\n\n\n\n\nFigureÂ 5: Multiple Groups Density Plot Using the Iris Dataset\n\n\n\n\n\nFigureÂ 5 shows the distribution density of petal length (Petal.Length) for different species in the Iris dataset, allowing for a clear visualization of the distribution differences in petal length across species.\n\n\n4. Faceted Density Plot\nFacet density plots for multiple variables, by displaying data from different groups in different panels, allow for a more intuitive comparison of distribution differences between groups, reducing visual clutter. If all panels share the same X-axis, the distribution features of each group, such as central tendency, spread, and shape, can still be compared. Facet density plots for multiple variables are created using facet_wrap().\n\nggplot(data=diamonds, aes(x=price, group=cut, fill=cut)) +\n  geom_density(adjust=1.5) +\n  theme_ipsum() +\n  facet_wrap(~cut) + \n  theme(\n    legend.position=\"none\",\n    panel.spacing = unit(0.1, \"lines\"),\n    axis.ticks.x=element_blank()\n  )\n\n\n\n\n\n\n\nFigureÂ 6: Faceted Density Plot\n\n\n\n\n\nFigureÂ 6 demonstrates the price distribution for different cut grades in the diamonds dataset. The density curve for each cut grade is displayed in separate facets, making it easier to observe the price distribution pattern of each cut grade within the same coordinate system.\n\n\n5. Stacked Density Plot\nIn a stacked density plot, the density distributions of different groups are stacked on top of each other, avoiding the confusion caused by overlapping curves. However, since the groups are stacked, it becomes difficult to understand the distribution of groups not at the bottom of the chart (facet density plots are recommended here).\n\np &lt;- ggplot(data=diamonds, aes(x=price, group=cut, fill=cut)) +\n  geom_density(adjust=1.5, position=\"fill\") +\n  theme_ipsum()\np\n\n\n\n\n\n\n\nFigureÂ 7: Stacked Density Plot\n\n\n\n\n\nFigureÂ 7 shows the relative distribution of prices for different cut grades in the diamonds dataset. By using a stacked density plot (position=â€œfillâ€), the cumulative density for all groups at each price position sums to 1, making it easier to compare the relative density distributions of different cut grades.\n\n\n6. Marginal distributions (density plots)\nMarginal distributions provide additional information about the data, not only showing the relationships between variables but also revealing the independent distribution characteristics of each variable. Combining marginal density plots with scatter plots (or other main plots) offers a comprehensive view, making it easier to detect patterns, outliers, and trends in the data. Marginal distributions (density plots) can be drawn using the ggMarginal() function from the ggExtra package.\n\np &lt;- ggplot(mtcars, aes(x = wt, y = mpg, color = factor(cyl), size = factor(cyl))) +\n  geom_point(aes(color = factor(cyl)), show.legend = TRUE) +  # Scatter plot with size variation based on cyl\n  geom_smooth(method = 'lm', formula = y ~ x, se = TRUE, linewidth = 1, aes(color = factor(cyl))) +  # Regression curve with color and width based on cyl\n  scale_color_manual(values = c(\"#2e3b97\", \"#faad61\", \"#b76252\")) +  # Specifying colors for the regression curves\n  stat_poly_eq(aes(label = paste(after_stat(eq.label), after_stat(rr.label), after_stat(p.value.label), sep = \"~~~~\")), \n               formula = y ~ x, size = 4,\n               hjust = -1,   # Adjust horizontal alignment\n               vjust = 1.1,   # Adjust vertical alignment\n               position = position_nudge(x = 2.7, y = 1)) + \n  theme(legend.position = \"none\")  # Hide legend\n\n# Add marginal density plot to the scatter plot\np1 &lt;- ggMarginal(p, type=\"density\")  \n\np1\n\n\n\n\n\n\n\nFigureÂ 8: Marginal Density Plot\n\n\n\n\n\nThe scatter plot shows the relationship between car weight (wt) and miles per gallon (mpg) for different cylinder counts (cyl) in the mtcars dataset. The marginal density plot shows the distribution patterns of wt (weight) and mpg (miles per gallon) for cars with different cylinder counts (cyl), revealing the differences in wt or mpg between the different cylinder groups.\n\n\n\n\n\n\nTip\n\n\n\nCustomizable Parameters for Plots with Marginal Distributions\n\nChange the size of the marginal plot using the size parameter.\nCustomize the appearance of the marginal plot with common parameters.\nDisplay only one marginal plot (either the x or y axis) using margins = 'x' or margins = 'y'.\n\n\np &lt;- ggplot(mtcars, aes(x = wt, y = mpg, color = factor(cyl), size = factor(cyl))) +\n  geom_point(aes(color = factor(cyl)), show.legend = TRUE) +  # Scatter plot with size variation based on cyl\n  geom_smooth(method = 'lm', formula = y ~ x, se = TRUE, linewidth = 1, aes(color = factor(cyl))) +  # Regression curve with color and width based on cyl\n  scale_color_manual(values = c(\"#2e3b97\", \"#faad61\", \"#b76252\")) +  # Specifying colors for the regression curves\n  stat_poly_eq(aes(label = paste(after_stat(eq.label), after_stat(rr.label), after_stat(p.value.label), sep = \"~~~~\")),\n               formula = y ~ x, size = 4,\n               hjust = -1.45,   # Adjusted horizontal alignment (modified value)\n               vjust = 1.1,   # Adjust vertical alignment\n               position = position_nudge(x = 2.7, y = 1)) + \n  theme(legend.position = \"none\")  # Hide legend\n\n# Marginal density plot\np2 &lt;- ggMarginal(p, type=\"density\", margins = 'x', color=\"purple\", size = 4)  # Display only x-axis marginal density plot\n\np2\n\n\n\n\n\n\n\nFigureÂ 9: Customizable Parameters for Plots with Marginal Distributions\n\n\n\n\n\nSimilar to the previous plot, FigureÂ 9 also shows the relationship between weight (wt) and miles per gallon (mpg) for cars with different numbers of cylinders (cyl) in the mtcars dataset. The marginal density plot illustrates the distribution pattern of cars with different cylinder counts (cyl) in terms of mpg (miles per gallon).\n\n\n\n\n7. Annotated Density Plot\nAnnotated density plots allow key information or group names to be displayed directly on the plot, making it easier to understand the distribution and differences of data across groups without relying on a legend. This enhances the readability of the plot and improves the efficiency of information delivery. You can add text or labels along the density curve using ggplot2 and the geomtextpath package.\n\nggplot(iris, aes(x = Sepal.Length, colour = Species, label = Species)) +\n  geom_textdensity() +\n  theme_bw() + guides(color = 'none')\n\n\n\n\n\n\n\nFigureÂ 10: Annotated Density Plot\n\n\n\n\n\nFigureÂ 10 represents the Sepal.Length distribution for different species in the iris dataset using text density curves. The text layout adjusts dynamically according to the density of the distribution, making it easier to visually observe the distribution of sepal length across species.\n\n\n\n\n\n\nTip\n\n\n\nCustomizable Parameters for Labels in Annotated Density Plots\n\nChange the size of the text using the size parameter.\nCustomize the font style with the fontface parameter.\nAdjust vertical alignment with the vjust parameter.\nAdjust horizontal alignment with the hjust parameter. The last two parameters (vjust and hjust) can be floats (usually between -1 and 1) or strings such as xmid (or ymid), xmax (or ymax), and auto (default).\n\n\n\n\nmtcars$labels = ifelse(mtcars$vs==0, \"Type 0\", \"Type 1\")\nggplot(mtcars, aes(x = qsec, colour = as.factor(labels), label = as.factor(labels))) +\n  geom_textdensity(size = 6, fontface = 4, # Bold italic text\n                   vjust = -0.4, hjust = \"ymid\") +\n  theme_bw() + guides(color = 'none')  # Remove color guide\n\n\n\n\n\n\n\nFigureÂ 11: Customizable Parameters for Annotated Density Plot\n\n\n\n\n\nFigureÂ 11 shows the text density distribution of qsec (1/4 mile acceleration time) and vs (engine type) in the mtcars dataset. By adjusting text density properties, the labels become more noticeable and readable.",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Density Plot"
    ]
  },
  {
    "objectID": "Distribution/Density.html#applications",
    "href": "Distribution/Density.html#applications",
    "title": "Density Plot",
    "section": "Applications",
    "text": "Applications\n\n1. Applications of Basic Density Plot\n\n\n\n\n\n\nMende, D. R. et al.(2016)\n\n\n\n\nFigureÂ 12: Applications of Basic Density Plot\n\n\n\nFigureÂ 12: Summary of the coverage of iSAGs assembled from the metagenomic and single-cell datasets used in this study. (A) Fragment recruitment map of metagenomic reads mapped to the iSAGs constructed in this study. The alternating orange and green bars at the bottom of each graph represent overlapping group boundaries, which are sorted from longest to shortest. (B) A density plot showing the relative coverage of raw SAG reads mapped to the iSAGs constructed here. [1]\n\n\n2. Applications of Multiple Groups Density Plot\n\n\n\n\n\n\nGrimmer, M. R. et al.(2014)\n\n\n\n\nFigureÂ 13: Applications of Multiple Groups Density Plot\n\n\n\nFigureÂ 13: Analysis of activating and repressing promoters. (A) A tag density plot of the frequency of the main 598-SKD binding motifs at the binding promoters (as shown in the figure above, representing partial target motifs). The colored curves correspond to the 598-SKD binding promoters on genes that are constitutively active, downregulated, or upregulated. (B) Tag density plot of 598-SKD and 598 ChIP-seq tags at the 598-SKD target promoters across expression groups; plot colors correspond to those in (A). (C) Tag density plot of 598-SKD across promoters and gene bodies; plot colors correspond to those in (A). [2]\n\n\n3. Applications of Faceted Density Plots\n\n\n\n\n\n\nReck, M. et al.(2015)\n\n\n\n\nFigureÂ 14: Applications of Faceted Density Plots\n\n\n\nFigureÂ 14 analyzes the overexpression of comE, comR, comS, and comRS in the LytFsm reporter gene strain background. [3]",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Density Plot"
    ]
  },
  {
    "objectID": "Distribution/Density.html#reference",
    "href": "Distribution/Density.html#reference",
    "title": "Density Plot",
    "section": "Reference",
    "text": "Reference\n\nMende, D. R., Aylward, F. O., Eppley, J. M., Nielsen, T. N., & DeLong, E. F. (2016). Improved Environmental Genomes via Integration of Metagenomic and Single-Cell Assemblies. Frontiers in Microbiology, 7, 143. https://doi.org/10.3389/fmicb.2016.00143. PMID: 26904016; PMCID: PMC4749706.\n\nGrimmer, M. R., Stolzenburg, S., Ford, E., Lister, R., Blancafort, P., & Farnham, P. J. (2014). Analysis of an artificial zinc finger epigenetic modulator: widespread binding but limited regulation. Nucleic Acids Research, 42(16), 10856â€“10868. https://doi.org/10.1093/nar/gku708. PMID: 25122745; PMCID: PMC4176344.\nReck, M., Tomasch, J., & Wagner-DÃ¶bler, I. (2015). The Alternative Sigma Factor SigX Controls Bacteriocin Synthesis and Competence, the Two Quorum Sensing Regulated Traits in Streptococcus mutans. PLoS Genetics, 11(7), e1005353. https://doi.org/10.1371/journal.pgen.1005353. PMID: 26158727; PMCID: PMC4497675.\n\nWickham, H. (2016). ggplot2: Elegant graphics for data analysis. Springer. https://ggplot2.tidyverse.org\n\nGao, Y. (2021). ggExtra: Add marginal plots to ggplot2. https://cran.r-project.org/package/ggExtra\n\nRudis, B. (2020). hrbrthemes: Additional Themes and Theme Components for â€˜ggplot2â€™. https://cran.r-project.org/package/hrbrthemes\n\nWickham, H., FranÃ§ois, R., Henry, L., & MÃ¼ller, K. (2021). dplyr: A Grammar of Data Manipulation. https://cran.r-project.org/package/dplyr\nWickham, H., & Henry, L. (2021). tidyr: Tidy Messy Data. https://cran.r-project.org/package/tidyr\n\nGarnier, S. (2018). viridis: Default Color Maps from â€˜matplotlibâ€™. https://cran.r-project.org/package/viridis\n\nAubry, R., & Bouchard, C. (2020). ggpmisc: Miscellaneous Extensions to â€˜ggplot2â€™. https://cran.r-project.org/package/ggpmisc\n\nKassambara, A. (2021). ggpubr: â€˜ggplot2â€™ Based Publication Ready Plots. https://cran.r-project.org/package/ggpubr\n\nBrown, C. (2022). geomtextpath: Curved Text on Geoms in â€˜ggplot2â€™. https://cran.r-project.org/package/geomtextpath\nWilke, C. O. (2020). cowplot: Streamlined Plot Theme and Plot Annotations for â€œggplot2â€. https://cran.r-project.org/package=cowplot",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "Density Plot"
    ]
  },
  {
    "objectID": "Distribution/RadialColumnChart.html",
    "href": "Distribution/RadialColumnChart.html",
    "title": "Radial Column Chart",
    "section": "",
    "text": "The proportion of threatened species in each tetrapod taxonomic group is presented in a circular layout, with a blue baseline indicating the best estimate and grey grid lines assisting in the reading of the percentage.",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "RadialColumnChart"
    ]
  },
  {
    "objectID": "Distribution/RadialColumnChart.html#example",
    "href": "Distribution/RadialColumnChart.html#example",
    "title": "Radial Column Chart",
    "section": "",
    "text": "The proportion of threatened species in each tetrapod taxonomic group is presented in a circular layout, with a blue baseline indicating the best estimate and grey grid lines assisting in the reading of the percentage.",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "RadialColumnChart"
    ]
  },
  {
    "objectID": "Distribution/RadialColumnChart.html#setup",
    "href": "Distribution/RadialColumnChart.html#setup",
    "title": "Radial Column Chart",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: ggplot2, dplyr, scales, ggforce\n\n\n# Install packages\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"scales\", quietly = TRUE)) {\n  install.packages(\"scales\")\n}\nif (!requireNamespace(\"ggforce\", quietly = TRUE)) {\n  install.packages(\"ggforce\")\n}\n\n# Load packages\nlibrary(ggplot2)    \nlibrary(dplyr)      \nlibrary(scales)    \nlibrary(ggforce)",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "RadialColumnChart"
    ]
  },
  {
    "objectID": "Distribution/RadialColumnChart.html#data-preparation",
    "href": "Distribution/RadialColumnChart.html#data-preparation",
    "title": "Radial Column Chart",
    "section": "Data Preparation",
    "text": "Data Preparation\n\nMust include R built-in datasets (such as iris and penguins) and biomedical datasets (such as omics data, survival information, clinical indicators, etc.).\nBiomedical datasets must be uploaded to Bizard Tencent Cloud to obtain links for embedding in tutorials. Data from public datasets is preferred; if provided by individuals/organizations, they must ensure that the data is publicly available. The dataset size must be less than 1MB.\n\n\n# Data reading and processing code can be displayed freely------\n# Generate simulated clinical data\nset.seed(123)\nn &lt;- 12  # Sample size\n\ndf &lt;- data.frame(\n  id = 1:n,\n  patient = paste0(\"P-\", sprintf(\"%02d\", 1:n)),\n  value = c(rnorm(6, 80, 15), rnorm(6, 120, 20)),  # Control group and treatment group\n  group = rep(c(\"Control\", \"Treatment\"), each = 6)\n) %&gt;%\n  mutate(\n    angle = 90 - 360 * (id - 0.5)/n,\n    hjust = ifelse(angle &lt; -90, 1, 0),\n    angle = ifelse(angle &lt; -90, angle + 180, angle)\n  )\n\n# Adding built-in datasets\ndata(\"iris\")",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "RadialColumnChart"
    ]
  },
  {
    "objectID": "Distribution/RadialColumnChart.html#visualization",
    "href": "Distribution/RadialColumnChart.html#visualization",
    "title": "Radial Column Chart",
    "section": "Visualization",
    "text": "Visualization\n\n1. Simple ring layout\n\n# Basic histogram\np1 &lt;- ggplot(df, aes(x = factor(id), y = value)) +\n  geom_col(aes(fill = group), width = 0.8, alpha = 0.8) +\n  coord_radial(inner.radius = 0.3) +\n  scale_fill_manual(values = c(\"#1E88E5\", \"#D81B60\")) +\n  theme_void() +\n  labs(title = \"Comparison of indicators between the treatment group and the control group\")\np1\n\n\n\n\n\n\n\nFigureÂ 1: Radial plot of gene expression range\n\n\n\n\n\nSupplement the important parameters that can be extended by the basic code and provide corresponding drawing codes, for example:\n\n\n\n\n\n\nTip\n\n\n\nKey Parameters:\n\ncoord_radial(inner.radius=0.3): Controls the center whitespace ratio\nwidth=0.8: Recommended column width range is 0.5-1.0\nalpha=0.8: Sets the color transparency\n\n\n\n\np2 &lt;- ggplot(df, aes(x = factor(id))) +\n  geom_col(aes(y = value, fill = group), width = 0.85) +\n  geom_text(aes(y = value + 15, label = patient, angle = angle), \n            size = 3, hjust = 0.3) +\n  coord_radial(start = -0.05 * pi) +\n  scale_fill_manual(values = c(\"#004D40\", \"#FFA000\")) +\n  theme_void() +\n  labs(fill = \"Experimental groups\")\n\np2\n\n\n\n\n\n\n\nFigureÂ 2: Radial plot with patient labels\n\n\n\n\n\n\n\n2. More advanced charts\n\np1 &lt;- ggplot(df) +\n  geom_col(aes(x = id, y = value, fill = group), width = 0.85) +\n  geom_hline(yintercept = c(50, 100, 150), \n             color = \"grey80\", linetype = \"dashed\") +\n  geom_segment(aes(x = 0.5, xend = n+0.5, y = 100, yend = 100),\n               color = \"#283593\", linewidth = 0.8) +\n  geom_text(aes(x = id, y = value + 20, label = patient, angle = angle),\n            size = 3, hjust = 0.3) +\n  coord_radial(inner.radius = 0.25) +\n  scale_fill_brewer(palette = \"Set2\") +\n  theme_void() +\n  labs(caption = \"The dotted line represents the reference interval of clinical indicators\") +\n  theme(legend.position = \"bottom\")\n\np1\n\n\n\n\n\n\n\nFigureÂ 3: Scientific-grade radial histogram\n\n\n\n\n\n\n# Generate the main drawing object\np1 &lt;-  ggplot(df) +\n  geom_col(aes(x = id, y = value, fill = group), \n           width = 0.85, alpha = 0.8) +\n  \n  # ========== Core coordinate axis system ==========\n# Main Y axis (along the 0 degree direction)\ngeom_segment(aes(x = 0.5, xend = 0.5, y = 0, yend = max(df$value) * 1.1),\n             color = \"grey40\", linewidth = 0.6, \n             arrow = arrow(length = unit(0.2, \"cm\"))) +\n  \n  # Y-axis scale lines (radial)\n  do.call(c, lapply(c(50, 100, 150), function(yval) {\n    geom_segment(aes(x = 0.5 - 0.05, xend = 0.5 + 0.05,\n                     y = yval, yend = yval),\n                 color = \"grey50\", linewidth = 0.4)\n  })) +  # Merge elements in a list\n  \n  # Y-axis tick labels (along the axis direction)\n  do.call(c, lapply(c(50, 100, 150), function(yval) {\n    geom_text(aes(x = 0.5 + 0.1, y = yval,\n                  label = yval, angle = -90),\n              color = \"grey30\", size = 3.5, hjust = 0)\n  })) +  # Merge elements in a list\n  \n  # Other horizontal lines and data labels\n  geom_hline(yintercept = c(50, 100, 150), \n             color = \"grey80\", linetype = \"dashed\") +\n  geom_segment(aes(x = 0.5, xend = 0.5, y = 100, yend = 100), \n               color = \"#283593\", linewidth = 0.8) + # Modify the end coordinates to adapt to polar coordinates\n  geom_text(aes(x = id, y = value + 20, label = patient, angle = angle),\n            size = 3, hjust = 0.3) +\n  \n  # ========== Coordinate system settings ==========\ncoord_radial(inner.radius = 0.35,\n             start = -0.1 * pi) +\n  \n  # ========== Visual Mapping ==========\nscale_fill_viridis_d(option = \"C\", begin = 0.2) +\n  theme_void() +\n  labs(caption = \"The dotted line represents the reference interval of clinical indicators\") +\n  theme(plot.margin = margin(2, 2, 2, 2, \"cm\"),\n        legend.position = \"bottom\")\n\np1\n\n\n\n\n\n\n\nFigureÂ 4: Scientific-grade radial histogram",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "RadialColumnChart"
    ]
  },
  {
    "objectID": "Distribution/RadialColumnChart.html#application",
    "href": "Distribution/RadialColumnChart.html#application",
    "title": "Radial Column Chart",
    "section": "Application",
    "text": "Application\nShow the practical application of visualization charts in biomedical literature. If basic charts/advanced charts are widely used in various types of biomedical literature, you can choose to display them separately.\n\n\n\n\n\n\nFigureÂ 5: Application of Radial Column Chart\n\n\n\nThis radial bar chart uses a circular layout to visually display the status of tetrapod conservation.",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "RadialColumnChart"
    ]
  },
  {
    "objectID": "Distribution/RadialColumnChart.html#reference",
    "href": "Distribution/RadialColumnChart.html#reference",
    "title": "Radial Column Chart",
    "section": "Reference",
    "text": "Reference\n[1] Cox N, Young BE, & Xie Y. A global reptile assessment highlights shared conservation needs of tetrapods. Nature. 2022 May;605(7909):285-290. https://doi.org/10.1038/s41586-022-04664-7\n[2] Costa, A. M., Machado, J. T., & Quelhas, M. D. (2011). Histogram-based DNA analysis for the visualization of chromosome, genome, and species information. Bioinformatics, 27(9), 1207â€“1214. https://doi.org/10.1093/bioinformatics/btr131",
    "crumbs": [
      "<i class='fa-solid fa-chart-simple'></i> Distribution",
      "RadialColumnChart"
    ]
  },
  {
    "objectID": "Composition/Waffle.html",
    "href": "Composition/Waffle.html",
    "title": "Waffle Chart",
    "section": "",
    "text": "A waffle chart visually represents categorical data using a grid of small squares that resemble waffles. Each category is assigned a unique color, and the number of squares assigned to each category corresponds to its proportion in the total data count.",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Waffle Chart"
    ]
  },
  {
    "objectID": "Composition/Waffle.html#example",
    "href": "Composition/Waffle.html#example",
    "title": "Waffle Chart",
    "section": "Example",
    "text": "Example",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Waffle Chart"
    ]
  },
  {
    "objectID": "Composition/Waffle.html#setup",
    "href": "Composition/Waffle.html#setup",
    "title": "Waffle Chart",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming Language: R\nDependencies: ggplot2, waffle, dplyr\n\n\n# Install packages\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"waffle\", quietly = TRUE)) {\n  install.packages(\"waffle\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\n\n# Load packages\nlibrary(ggplot2)\nlibrary(waffle)\nlibrary(dplyr)",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Waffle Chart"
    ]
  },
  {
    "objectID": "Composition/Waffle.html#data-preparation",
    "href": "Composition/Waffle.html#data-preparation",
    "title": "Waffle Chart",
    "section": "Data Preparation",
    "text": "Data Preparation\nIt primarily utilizes the TCGA database and the built-in R dataset mtcars.\n\n# 1.TCGA database (clinical data on lung cancer in 2020)\nTCGA_cli_df &lt;- readr::read_tsv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/raponi2006_public_raponi2006_public_clinicalMatrix.gz\")\n# Data Preparation\ncounts &lt;- table(TCGA_cli_df$T)\ncounts &lt;- as.data.frame(counts)\nnames(counts)[names(counts) == \"Var1\"] &lt;- \"T\"\n\n# 2.R built-in data - mtcars\ncounts1 &lt;- table(mtcars$cyl)\ncounts1 &lt;- as.data.frame(counts1)\nnames(counts1)[names(counts1) == \"Var1\"] &lt;- \"cyl\"\n\n# 3.Self-created dataset\ndata &lt;- data.frame(\n  group = c(\"First group\", \"First group\", \"First group\", \"First group\",\n            \"First group\", \"First group\", \"Second group\", \"Second group\",\n            \"Second group\", \"Second group\", \"Third group\", \"Third group\"),\n  subgroup = c(\"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"A\", \"B\", \"C\", \"D\", \"A\", \"B\"),\n  value = c(10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120)\n)",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Waffle Chart"
    ]
  },
  {
    "objectID": "Composition/Waffle.html#visualization",
    "href": "Composition/Waffle.html#visualization",
    "title": "Waffle Chart",
    "section": "Visualization",
    "text": "Visualization\n\n1. Basic plot (Waffle package)\n\n1.1 Basic Code\nTaking TCGA data as an example\n\nwaffle(counts)\n\n\n\n\nBasic plot\n\n\n\n\nThis waffle chart illustrates the proportion of different tumor stages in the total sample.\n\n\n1.2 Beautify plot\n\nrows: The number of rows in the block, defaults to 10.\nxlab: Text below the chart, recommended for describing the meaning of each square, e.g., â€œ1 sq == 1000â€.\ntitle: Chart title.\ncolors: An array of colors equal to the number of values in parts. If omitted, the Color Brewer â€œSet2â€ colors are used.\nsize: Width of the separator between blocks, defaults to 2.\nflip: Flips the x and y axes.\npad: How many blocks to use to fill the grid.\nglyph_size: Glyph size.\nlegend_pos: Legend position.\n\n\nwaffle(counts,rows = 5,\n       colors = c(\"#fb5607\", \"#8338ec\",\"yellow\", \"blue\"),\n       size = 4,flip = F,glyph_size=3,legend_pos=\"bottom\")\n\n\n\n\nBeautify plot\n\n\n\n\nThis figure illustrates the proportion of different tumor stages in the total sample.\n\n\n1.3 Taking the mtcars database as an example\n\nwaffle(counts1)\n\n\n\n\nTaking the mtcars database as an example\n\n\n\n\nThis graph illustrates the proportion of different cylinder counts in the total sample of the mtcars dataset.\n\n\n\n2. Basic plot (ggplot2 package)\n\n2.1 Basic Code\nTaking TCGA data as an example\n\nggplot(counts, aes(fill=T, values=Freq)) +\n  geom_waffle() +\n  theme_void()\n\n\n\n\nTaking TCGA data as an example\n\n\n\n\nThis waffle chart illustrates the proportion of different tumor stages in the total sample.\n\n\n2.2 Beautify plot\n\nn_rows: This parameter sets the number of rows in the waffle chart. The default is 10.\nxlab: The text below the chart, recommended to describe the meaning of each square, such as â€œ1 sq == 1000â€.\ntitle: The chart title.\nscale_fill_manual(): Changes the color.\nlabels: Changes the labels.\nsize: This parameter sets the width of the separator between squares. The default is 2.\nradius: This parameter sets the corner radius of the squares. It can be controlled by specifying the grid::unit() value. For example, radius = unit(4, \"pt\") adds rounded corners to the squares, changing their shape.\nflip: If set to TRUE, flips the x and y coordinates, and n_rows becomes n_cols, which helps achieve a waffle bar chart effect. The default is FALSE.\n\n\nggplot(counts, aes(fill=T, values=Freq)) +\n  geom_waffle(color = \"white\",radius = unit(4, \"pt\")) +\n  scale_fill_manual(values = c(\"#999999\", \"#E69F00\", \"#56B4E9\",\"red\")) +\n  theme_void()\n\n\n\n\nBeautify plot\n\n\n\n\nThis figure illustrates the proportion of different tumor stages in the total sample.\n\n\n2.3 Taking the mtcars database as an example\n\nggplot(counts1, aes(fill=cyl, values=Freq)) +\n  geom_waffle(color = \"white\",row=8) +\n  scale_fill_manual(values = c(\"#999999\", \"#E69F00\", \"#56B4E9\")) +\n  theme_void()+\n  geom_waffle(size = 0.1)\n\n\n\n\nTaking the mtcars database as an example\n\n\n\n\nThis graph illustrates the proportion of different cylinder counts in the total sample of the mtcars data.\n\n\n2.4 Grouping\ngeom_waffle() can be used to build waffle charts with groups and subgroups.\nThe fill parameter is used to color the chart by group.\n\nggplot(data = data, aes(fill=subgroup, values=value)) +\n  geom_waffle(color = \"white\", size = 1.125, n_rows = 6) +\n  facet_wrap(~group, ncol=1) +\ntheme_void()\n\n\n\n\nGrouping\n\n\n\n\nThis waffle chart shows the distribution of elements within three different groups in the dataset.\nEnhancing the Graphics\nThe colors of the waffle chart can be customized using the scale_fill_manual() function.\n\nggplot(data = data, aes(fill=subgroup, values=value)) +\n  geom_waffle(color = \"white\", size = 1.125, n_rows = 6) +\n  facet_wrap(~group, ncol=1) +\ntheme_void() +\n  scale_fill_manual(values = c(\"#69b3a2\", \"#404080\", \"#FFA07A\", \"#FFD700\", \"#FF6347\", \"#4682B4\"))\n\n\n\n\nBeautify plot\n\n\n\n\nThis waffle chart illustrates the distribution of elements within three different groups in the dataset.",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Waffle Chart"
    ]
  },
  {
    "objectID": "Composition/Waffle.html#applications",
    "href": "Composition/Waffle.html#applications",
    "title": "Waffle Chart",
    "section": "Applications",
    "text": "Applications\n\n\n\n\n\n\nFigureÂ 1: Applications of waffle chart\n\n\n\nWaffle diagrams are used to illustrate the impact of different factors on patient comfort. [1]",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Waffle Chart"
    ]
  },
  {
    "objectID": "Composition/Waffle.html#reference",
    "href": "Composition/Waffle.html#reference",
    "title": "Waffle Chart",
    "section": "Reference",
    "text": "Reference\n[1] Niehoff JH, Heuser A, Michael AE, Lennartz S, Borggrefe J, Kroeger JR. Patient Comfort in Modern Computed Tomography: What Really Counts. Tomography. 2022 May 23;8(3):1401-1412. doi: 10.3390/tomography8030113. PMID: 35645399; PMCID: PMC9149918.\n[2] Wickham, H. (2016). ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York. https://ggplot2.tidyverse.org\n[3] Rudis B, Gandy D (2023). waffle: Create Waffle Chart Visualizations. R package version 1.0.2,https://CRAN.R-project.org/package=waffle.\n[4] Wickham H, FranÃ§ois R, Henry L, MÃ¼ller K, Vaughan D (2023).dplyr: A Grammar of Data Manipulation. R package version 1.1.4, https://CRAN.R-project.org/package=dplyr.",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Waffle Chart"
    ]
  },
  {
    "objectID": "Composition/CircularPacking.html",
    "href": "Composition/CircularPacking.html",
    "title": "Circular Packing Chart",
    "section": "",
    "text": "Circular Packing can be viewed as a special type of classification tree diagram, which is particularly suitable for displaying classification data with hierarchical relationships.",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Circular Packing Chart"
    ]
  },
  {
    "objectID": "Composition/CircularPacking.html#example",
    "href": "Composition/CircularPacking.html#example",
    "title": "Circular Packing Chart",
    "section": "Example",
    "text": "Example",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Circular Packing Chart"
    ]
  },
  {
    "objectID": "Composition/CircularPacking.html#setup",
    "href": "Composition/CircularPacking.html#setup",
    "title": "Circular Packing Chart",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming Language: R\nDependencies: packcircles; ggplot2; dplyr; tidyr; viridis; ggiraph; ggiraph; htmlwidgets; ggraph; igraph; tidyverse; flare; cowplot; circlepackeR; data.tree\n\n\n# Install packages\nif (!requireNamespace(\"packcircles\", quietly = TRUE)) {\n  install.packages(\"packcircles\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"viridis\", quietly = TRUE)) {\n  install.packages(\"viridis\")\n}\nif (!requireNamespace(\"ggiraph\", quietly = TRUE)) {\n  install.packages(\"ggiraph\")\n}\nif (!requireNamespace(\"htmlwidgets\", quietly = TRUE)) {\n  install.packages(\"htmlwidgets\")\n}\nif (!requireNamespace(\"ggraph\", quietly = TRUE)) {\n  install.packages(\"ggraph\")\n}\nif (!requireNamespace(\"igraph\", quietly = TRUE)) {\n  install.packages(\"igraph\")\n}\nif (!requireNamespace(\"tidyverse\", quietly = TRUE)) {\n  install.packages(\"tidyverse\")\n}\nif (!requireNamespace(\"flare\", quietly = TRUE)) {\n  install.packages(\"flare\")\n}\nif (!requireNamespace(\"cowplot\", quietly = TRUE)) {\n  install.packages(\"cowplot\")\n}\nif (!requireNamespace(\"circlepackeR\", quietly = TRUE)) {\n  remotes::install_github(\"jeromefroe/circlepackeR\")\n}\nif (!requireNamespace(\"data.tree\", quietly = TRUE)) {\n  install.packages(\"data.tree\")\n}\n\n# Load packages\nlibrary(packcircles)\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(viridis)\nlibrary(ggiraph)\nlibrary(htmlwidgets)\nlibrary(ggraph)\nlibrary(igraph)\nlibrary(tidyverse)\nlibrary(flare)\nlibrary(cowplot)\nlibrary(circlepackeR) \nlibrary(data.tree)",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Circular Packing Chart"
    ]
  },
  {
    "objectID": "Composition/CircularPacking.html#data-preparation",
    "href": "Composition/CircularPacking.html#data-preparation",
    "title": "Circular Packing Chart",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n#GO BP\ndata_BP &lt;- readr::read_csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/data_BP.csv\")\n\n#flare\ndata_edges &lt;- flare$edges\ndata_vertices &lt;- flare$vertices\n\n#KEGG\ndata_KEGG &lt;- readr::read_csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/data_KEGG.csv\")\n\n#KEGG_type\ndata_KEGG_type &lt;- readr::read_csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/data_KEGG_type.csv\")\ndata_KEGG_type$pvalue_log &lt;- -log10(data_KEGG_type$pvalue)\nsummary(data_KEGG_type)\n\n      PW                 ID                pvalue               NES         \n Length:33          Length:33          Min.   :3.490e-06   Min.   :-1.7497  \n Class :character   Class :character   1st Qu.:4.930e-05   1st Qu.:-1.5834  \n Mode  :character   Mode  :character   Median :6.342e-04   Median :-1.5103  \n                                       Mean   :2.093e-03   Mean   :-0.7439  \n                                       3rd Qu.:2.889e-03   3rd Qu.:-1.3939  \n                                       Max.   :8.710e-03   Max.   : 2.0829  \n     type             subtype            pvalue_log   \n Length:33          Length:33          Min.   :2.060  \n Class :character   Class :character   1st Qu.:2.539  \n Mode  :character   Mode  :character   Median :3.198  \n                                       Mean   :3.442  \n                                       3rd Qu.:4.307  \n                                       Max.   :5.457  \n\ndata_KEGG_type1 &lt;- data_KEGG_type %&gt;%\n  dplyr::select(type, subtype, PW, pvalue_log, NES) %&gt;%\n  arrange(type, subtype)",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Circular Packing Chart"
    ]
  },
  {
    "objectID": "Composition/CircularPacking.html#visualization",
    "href": "Composition/CircularPacking.html#visualization",
    "title": "Circular Packing Chart",
    "section": "Visualization",
    "text": "Visualization\n\n1. Single-level Circular Packing Chart\n\n1.1 Basic Circular Packing Chart\nThe GO analysis results of differentially expressed genes in mouse lung tissue before and after cisplatin administration are used as an example.\n\n## color\ndata_BP1 &lt;- data_BP\ndata_BP1$pvalue_log &lt;- -log10(data_BP1$pvalue)\npacking_BP &lt;- circleProgressiveLayout(data_BP1$pvalue_log, sizetype='area' )\n\n\n# Merging plotting data\ndata_BUBBLE_BP &lt;- cbind(data_BP1, packing_BP)\n\n# Generate the coordinates of each vertex of the circle, where npoint is the number of vertices.\ndat.gg_BP &lt;- circleLayoutVertices(packing_BP, npoints=50)\n\n# plot\np &lt;- ggplot() + \n  geom_polygon(data = dat.gg_BP, \n               aes(x, y, group = id, fill=as.factor(id)), \n               colour = \"black\", alpha = 0.6) +\n  scale_fill_manual(values = magma(nrow(data_BUBBLE_BP))) + # change color\n  geom_text(data = data_BUBBLE_BP,\n            aes(x, y, size=pvalue_log, label = str_wrap(BP,width = 10)),\n            show.legend = FALSE) +\n  scale_size_continuous(range = c(0.5,1.5)) +\n  theme_void() + \n  theme(legend.position=\"none\",\n        plot.title = element_text(hjust=0.5,size = 20)) +\n  coord_equal() +\n  ggtitle(\"Basic circular packing chart + custom colors\")\n\np\n\n\n\n\nBasic Circular Packing Chart\n\n\n\n\nThe figure above shows the Biological Process portion of the differential gene GO analysis of mouse lung tissue before and after cisplatin administration, with colors representing different biological processes.\n\n\n1.2 Color mapping data size\nThe GO analysis results of differentially expressed genes in mouse lung tissue before and after cisplatin administration are used as an example.\n\n# Basic Circular Packing Chart (ggplot2) ----\n# plot ----\n# Returns the position and size of each bubble.\ndata_BP1 &lt;- data_BP\ndata_BP1$pvalue_log &lt;- -log10(data_BP1$pvalue)\npacking_BP &lt;- circleProgressiveLayout(data_BP1$pvalue_log, sizetype='area' )\n\n\n# Merging plotting data\ndata_BUBBLE_BP &lt;- cbind(data_BP1, packing_BP)\n\n# Generate the coordinates of each vertex of the circle, where npoint is the number of vertices.\ndat.gg_BP &lt;- circleLayoutVertices(packing_BP, npoints=50)\n\n# value maps to NES value\ndat.gg_BP$NES &lt;- rep(data_BP1$NES, each=51) \n\n# plot\nggplot() + \n  geom_polygon(data = dat.gg_BP, aes(x, y, group = id, fill=NES), # Color indicates NES value.\n               colour = \"black\", alpha = 0.6) +\n  scale_fill_continuous(type = \"viridis\")+\n\n# Add labels + control size\n  geom_text(data = data_BUBBLE_BP,\n            aes(x, y, size=pvalue_log, label = str_wrap(BP,width = 10)),\n            show.legend = FALSE) +\n  scale_size_continuous(range = c(0.5,1.5)) +\n\n# theme\n  theme_void()  + \n  theme(plot.title = element_text(hjust=0.5,size = 20)) + \n  coord_equal()+\n  ggtitle(\"Biological Process\")\n\n\n\n\nColor mapping data size\n\n\n\n\nThe figure above shows the Biological Process portion of the differential gene GO analysis in mouse lung tissue before and after cisplatin administration. The size of the circle represents the negative value of log10(P), with larger circles indicating more reliable results. The circle color represents the NES value.\n\n\n1.3 Custom Background\nThe KNGG pathway analysis results corresponding to differentially expressed genes in mouse lung tissue before and after cisplatin administration are used as an example.\n\n## Custom Background\n# Color mapping data values\ndata_KEGG1 &lt;- data_KEGG\ndata_KEGG1$pvalue_log &lt;- -log10(data_KEGG1$pvalue)\npacking_KEGG &lt;- circleProgressiveLayout(data_KEGG1$pvalue_log, sizetype='area' )\n\n\n# Merging plotting data\ndata_BUBBLE_KEGG &lt;- cbind(data_KEGG1, packing_KEGG)\n\n# Generate the coordinates of each vertex of the circle, where npoint is the number of vertices.\ndat.gg_KEGG &lt;- circleLayoutVertices(packing_KEGG, npoints=50)\n\n# value maps to NES value\ndat.gg_KEGG$NES &lt;- rep(data_KEGG1$NES, each=51) \n\n\np3 &lt;- ggplot() + \n  geom_polygon(data = dat.gg_KEGG, aes(x, y, group = id, fill=NES),\n               colour = \"grey\", alpha = 0.6, size=.5) +\n  scale_fill_distiller(palette = \"Spectral\", direction = 1 ) +\n\n# Add labels + control size\n  geom_label(data = data_BUBBLE_KEGG, \n             aes(x, y, size=pvalue_log, label = str_wrap(PW,width = 15)),\n             show.legend = FALSE) +\n  scale_size_continuous(range = c(1.5,2)) +\n\n# Theme, Custom\n  theme_void()  + \n  theme(\n    legend.text = element_text(colour=\"white\", size = 10),\n    plot.background = element_rect(fill=\"black\"),\n    plot.title = element_text(color=\"grey\", hjust=0.5,size = 20)\n  ) + \n  coord_equal() +\n  ggtitle(\"Custom Background\")\n\np3\n\n\n\n\nCustom Background\n\n\n\n\n\n\n\n2. Interactive Single-level Circular Packing Chart\nThe ggiraph package allows us to draw interactive circular packing chart.\n\n# Interaction----\n# Color mapping data values\ndata_KEGG1 &lt;- data_KEGG\ndata_KEGG1$pvalue_log &lt;- -log10(data_KEGG1$pvalue)\npacking_KEGG &lt;- circleProgressiveLayout(data_KEGG1$pvalue_log, sizetype='area' )\n\n\n# Merging plotting data\ndata_BUBBLE_KEGG &lt;- cbind(data_KEGG1, packing_KEGG)\n\n# Generate the coordinates of each vertex of the circle, where npoint is the number of vertices.\ndat.gg_KEGG &lt;- circleLayoutVertices(packing_KEGG, npoints=50)\n\n# value maps to NES value\ndat.gg_KEGG$NES &lt;- rep(data_KEGG1$NES, each=51) \n\ndata_BUBBLE_KEGG$text &lt;- paste(\"Pathway:\",data_BUBBLE_KEGG$PW, \n                               \"\\n\", \"-log10(P):\", data_BUBBLE_KEGG$pvalue_log, \n                               \"\\n\",\"NES:\", data_BUBBLE_KEGG$NES)\n\np5 &lt;- ggplot() + \n  geom_polygon_interactive(data = dat.gg_KEGG, \n                           aes(x, y, group = id, fill=NES, tooltip = data_BUBBLE_KEGG$text[id], data_id = id), \n                           colour = \"black\", alpha = 0.6) +\n  scale_fill_distiller(palette = \"BuPu\", direction = 1 ) +\n\n# Add labels + control size\n  geom_text(data = data_BUBBLE_KEGG,\n            aes(x, y, size=pvalue_log, label = str_wrap(PW,width = 15)),\n            show.legend = FALSE) +\n  scale_size_continuous(range = c(1.5,2)) +\n\n# theme\n  theme_void()  + \n  theme(plot.title = element_text(hjust=0.5,size = 20)) + \n  coord_equal()+\n  ggtitle(\"Interactive graphics\")\n\n\nP_inter &lt;- girafe(ggobj = p5, width_svg = 7, height_svg = 7)\n\nP_inter\n\n\n\nInteractive Single-level Circular Packing Chart\n\n\nThe image above is an interactive single-level circular packing chart. The circle where the mouse hovers is orange, allowing users to interactively view the pathway name, the -log10 value of the P-value, and the NES value. A download function is also provided.\n\n\n3. Multi-level circular packing chart\nThis example uses KNGG pathway analysis data supplemented with pathway classification.\nDrawing multi-level circular packing chart requires organizing the data into a vertex dataset and an edge dataset. The graph_from_data_frame() function in the igraph package can effectively create an igraph graph from one or two data frames containing a list of edges and edge/vertex attributes for plotting.\n\n# Point dataset\nrstat_nodes_KEGG &lt;- data.frame(name = c(\"KEGG Pathways\",\n                                        unique(data_KEGG_type1$type), \n                                        unique(data_KEGG_type1$subtype),\n                                        unique(data_KEGG_type1$PW)), \n                               pvalue_log = c(rep(0,22),data_KEGG_type1$pvalue_log),\n                               NES = c(rep(0,22),data_KEGG_type1$NES),\n                               label = c(\"KEGG Pathways\",\n                                         unique(data_KEGG_type1$type), \n                                         unique(data_KEGG_type1$subtype),\n                                         unique(data_KEGG_type1$PW)))\n\n\n# Start creating the edge dataset\nedges1 &lt;- rep(\"KEGG Pathways\", length(unique(data_KEGG_type1$type)))\n\n# Create functions for batch processing\nfcount1 &lt;- function(n){\n  data1 &lt;- filter(data_KEGG_type1, data_KEGG_type1$type == unique(data_KEGG_type1$type)[n])\n  count &lt;- length(unique(data1$subtype)) \n  result &lt;- rep(unique(data_KEGG_type1$type)[n], count)\nreturn(result)\n}\n\nedges2&lt;- NULL\nfor(i in seq(1, 6)){\n  edges2 &lt;- c(edges2,fcount1(i))\n  #print(edges2)\n}\n\n\n# Create functions for batch processing\nfcount2 &lt;- function(n){\n  data1 &lt;- filter(data_KEGG_type1, data_KEGG_type1$subtype == unique(data_KEGG_type1$subtype)[n])\n  count &lt;- length(unique(data1$PW)) \n  result &lt;- rep(unique(data_KEGG_type1$subtype)[n], count)\nreturn(result)\n}\n\nedges3&lt;- NULL\nfor(i in seq(1,15)){\n  edges3 &lt;- c(edges3,fcount2(i))\n  #print(edges3)\n}\n\n\nedgesa &lt;- unique(data_KEGG_type1$type)\n\n\n# Create functions for batch processing\nfcounta &lt;- function(n){\n  data1 &lt;- filter(data_KEGG_type1, data_KEGG_type1$type == unique(data_KEGG_type1$type)[n])\n  result &lt;- unique(data1$subtype)\nreturn(result)\n}\n\nedgesb&lt;- NULL\nfor(i in seq(1, 6)){\n  edgesb &lt;- c(edgesb,fcounta(i))\n  #print(edgesb)\n}\n\n\n# Create functions for batch processing\nfcountb &lt;- function(n){\n  data1 &lt;- filter(data_KEGG_type1, data_KEGG_type1$subtype == unique(data_KEGG_type1$subtype)[n])\n  result &lt;- unique(data1$PW)\nreturn(result)\n}\n\nedgesc&lt;- NULL\nfor(i in seq(1, 15)){\n  edgesc &lt;- c(edgesc,fcountb(i))\n  #print(edgesc)\n}\n\n# edges dataset\nrstat_edges_KEGG &lt;- data.frame(from = c(edges1, edges2, edges3),\n                               to = c(edgesa, edgesb, edgesc))\n\n# Creating igraph graphs\nmygraph_KEGG &lt;- graph_from_data_frame( rstat_edges_KEGG, vertices=rstat_nodes_KEGG )\n\n# plot\nggraph(mygraph_KEGG, layout = 'circlepack', weight = pvalue_log ) + # The size of the bubble corresponds to the value of the value.\n  geom_node_circle(aes(fill = NES)) +\n  theme_void()+\n  geom_node_text( aes(filter=leaf, size=pvalue_log, \n                      label = str_wrap(label,width = 10)), \n                  show.legend = FALSE) +\n  scale_size_continuous(range = c(1.5,2)) + \n  scale_fill_viridis(alpha = 0.5) +\n  ggtitle(\"KEGG pathway multi-level classification\") +\n  theme(plot.title = element_text(color=\"black\", hjust=0.5,size = 20))\n\n\n\n\nMulti-level circular packing chart\n\n\n\n\nThe image above is a circular packing chart of multi-level classification of the KEGG pathway. The size of the smallest circle represents the negative value of log10(P), and the larger the circle, the greater the correlation. The circle color represents the NES value.\nThe classification is based on the distribution channels on the KEGG official website:\nPrimary classifications: Metabolism, Genetic Information Processing, Environmental Information Processing, Cellular Processes, Organic Systems, Human Diseases, Drug Development\nSecondary classifications: For example, the five secondary classifications under Cellular Processes are: Transport and catabolism, Cell growth and death, Cellular community (eukaryotes), Cellular community (eukaryotes), and Cell motility.\n\n\n4. Interactive multi-level circular packing chart\nThe circlepackeR package allows for the creation of interactive multi-level circular packing chart.\n\n# Group border display\n# Multi-level data\ndata &lt;- data.frame(\n  root=rep(\"root\", 15),\n  group=c(rep(\"group A\",5), rep(\"group B\",5), rep(\"group C\",5)), \n  subgroup= rep(letters[1:5], each=3),\n  subsubgroup=rep(letters[1:3], 5),\n  value=sample(seq(1:15), 15)\n)\n\n# Change data format\ndata$pathString &lt;- paste(\"world\", data$group, data$subgroup, data$subsubgroup, sep = \"/\")\npopulation &lt;- as.Node(data)\n\np_inter1 &lt;- circlepackeR(population,\n                         size = \"value\", \n                         color_min = \"hsl(56,80%,80%)\", \n                         color_max = \"hsl(341,30%,40%)\")\n\np_inter1\n\n\n\nInteractive multi-level circular packing chart\n\n\nThe image above is an interactive multi-level circular packing chart, which allows for displaying group borders and zooming in and out of different group levels.\nTaking the flare dataset as an example.\n\n# All levels of border display\ndata_edge &lt;- flare$edges\ndata_edge$from &lt;- gsub(\".*\\\\.\",\"\",data_edge$from)\ndata_edge$to &lt;- gsub(\".*\\\\.\",\"\",data_edge$to)\n#head(data_edge)   # This is an edge list\n\ndata_tree &lt;- FromDataFrameNetwork(data_edge)\ndata_nested &lt;- ToDataFrameTree(data_tree, \n                               level1 = function(x) x$path[2],\n                               level2 = function(x) x$path[3],\n                               level3 = function(x) x$path[4],\n                               level4 = function(x) x$path[5])[-1,-1]\ndata_nested &lt;- na.omit(data_nested)\n\n# plot\ndata_nested$pathString &lt;- paste(\"roots\", data_nested$level1, data_nested$level2, data_nested$level3, data_nested$level4, sep = \"/\")\ndata_nested$value=1\ndata_Node &lt;- as.Node(data_nested)\np_inter2 &lt;- circlepackeR(data_Node, size = \"value\")\np_inter2\n\n\n\nTaking the flare dataset as an example\n\n\nThe image above is an interactive multi-level circular packing chart, which allows for the display of all borders and the zooming in and out of different level groups.",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Circular Packing Chart"
    ]
  },
  {
    "objectID": "Composition/CircularPacking.html#applications",
    "href": "Composition/CircularPacking.html#applications",
    "title": "Circular Packing Chart",
    "section": "Applications",
    "text": "Applications\n\n\n\n\n\n\nFigureÂ 1: Applications of circular packing chart\n\n\n\nColored circles represent the spatial framework of medicinal chemistry and are labeled with the frequencies of their frameworks. The area and color of the circles are related to the framework frequencies. Frameworks in the same cluster are grouped into gray circles. [1]",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Circular Packing Chart"
    ]
  },
  {
    "objectID": "Composition/CircularPacking.html#reference",
    "href": "Composition/CircularPacking.html#reference",
    "title": "Circular Packing Chart",
    "section": "Reference",
    "text": "Reference\n[1] Langdon SR, Brown N, Blagg J. Scaffold diversity of exemplified medicinal chemistry space. J Chem Inf Model. 2011 Sep 26;51(9):2174-85. doi: 10.1021/ci2001428. Epub 2011 Aug 31. PMID: 21877753; PMCID: PMC3180201.\n[2] Bedward M, Eppstein D, Menzel P (2023). packcircles: Circle Packing. R package version 0.3.6, https://CRAN.R-project.org/package=packcircles.\n[3] H. Wickham. ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York, 2016.\n[4] Wickham H, FranÃ§ois R, Henry L, MÃ¼ller K, Vaughan D (2023). dplyr: A Grammar of Data Manipulation. R package version 1.1.4, https://CRAN.R-project.org/package=dplyr.\n[5] Wickham H, Vaughan D, Girlich M (2024). tidyr: Tidy Messy Data. R package version 1.3.1, https://CRAN.R-project.org/package=tidyr.\n[6] Simon Garnier, Noam Ross, Robert Rudis, AntÃ´nio P. Camargo, Marco Sciaini, and CÃ©dric Scherer (2024). viridis(Lite) - Colorblind-Friendly Color Maps for R. viridis package version 0.6.5.\n[7] Gohel D, Skintzos P (2024). ggiraph: Make â€˜ggplot2â€™ Graphics Interactive. R package version 0.8.10, https://CRAN.R-project.org/package=ggiraph.\n[8] Vaidyanathan R, Xie Y, Allaire J, Cheng J, Sievert C, Russell K (2023). htmlwidgets: HTML Widgets for R. R package version 1.6.4, https://CRAN.R-project.org/package=htmlwidgets.\n[9] Pedersen T (2024). ggraph: An Implementation of Grammar of Graphics for Graphs and Networks. R package version 2.2.1, https://CRAN.R-project.org/package=ggraph.\n[10] Wickham H, Averick M, Bryan J, Chang W, McGowan LD, FranÃ§ois R, Grolemund G, Hayes A, Henry L, Hester J, Kuhn M, Pedersen TL, Miller E, Bache SM, MÃ¼ller K, Ooms J, Robinson D, Seidel DP, Spinu V, Takahashi K, Vaughan D, Wilke C, Woo K, Yutani H (2019). â€œWelcome to the tidyverse.â€ Journal of Open Source Software, 4(43), 1686. doi:10.21105/joss.01686 https://doi.org/10.21105/joss.01686.\n[11] Li X, Zhao T, Wang L, Yuan X, Liu H (2022). flare: Family of Lasso Regression. R package version 1.7.0.1, https://CRAN.R-project.org/package=flare.\n[12] Wilke C (2024). cowplot: Streamlined Plot Theme and Plot Annotations for â€˜ggplot2â€™. package version 1.1.3, https://CRAN.R-project.org/package=cowplot.\n[13] Bostock M, Froelich J (2015). circlepackeR: htmlwidget for Mike Bostock d3.js circle packing visualization. R package version 0.0.0.9000.\n[14] Glur C (2023). data.tree: General Purpose Hierarchical Data Structure. R package version 1.1.0, https://CRAN.R-project.org/package=data.tree.",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Circular Packing Chart"
    ]
  },
  {
    "objectID": "Composition/Dendrogram.html",
    "href": "Composition/Dendrogram.html",
    "title": "Dendrogram",
    "section": "",
    "text": "A dendrogram is a graphical representation of hierarchical relationships between objects. It is widely used in cluster analysis, especially hierarchical clustering, to visualize the similarity or distance between data points.\nA dendrogram is a hierarchical structure consisting of a series of nodes and branches connecting them. Each node represents a data point (or cluster), while the length of the branch indicates the similarity or distance between objects. Typically, a dendrogram starts with a single data point at the bottom and gradually merges to form larger clusters until all objects are merged into one large class. Branches represent the similarity between two clusters or objects, usually measured by a distance metric such as Euclidean distance. Shorter branches indicate greater similarity between the two objects, while longer branches indicate lower similarity. Non-leaf nodes are â€œmergedâ€ nodes generated from different data points or clusters, indicating that they have been merged into a larger class. Leaf nodes are the bottom nodes of the dendrogram and typically represent the original data points (such as samples, genes, etc.).",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Dendrogram"
    ]
  },
  {
    "objectID": "Composition/Dendrogram.html#example",
    "href": "Composition/Dendrogram.html#example",
    "title": "Dendrogram",
    "section": "Example",
    "text": "Example\n\n\n\n\n\nThis dendrogram visualizes the results of hierarchical clustering, showing the similarity of gene expression levels and cluster structure among TCGA-BRCA samples. The x-axis represents different TCGA-BRCA samples, with leaf nodes at the bottom identifying each individual sample. The y-axis represents the merge distance or similarity between different samples. In hierarchical clustering, two samples are merged into one cluster when their similarity is sufficiently high. A larger y-axis value indicates lower similarity between the two clusters or samples; conversely, a smaller value indicates higher similarity. The dendrogram shows the merging process through branches. Each branch represents a merge; the shorter the branch, the higher the similarity between the two samples. The dendrogram starts at the bottom, with each individual sample being gradually merged until a large cluster is formed. At the top of the tree, all samples are merged into a single cluster.",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Dendrogram"
    ]
  },
  {
    "objectID": "Composition/Dendrogram.html#setup",
    "href": "Composition/Dendrogram.html#setup",
    "title": "Dendrogram",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming Language: R\nDependencies: ggraph; igraph; tidyverse; collapsibleTree; dendextend\n\n\n# Install packages\nif (!requireNamespace(\"ggraph\", quietly = TRUE)) {\n  install.packages(\"ggraph\")\n}\nif (!requireNamespace(\"igraph\", quietly = TRUE)) {\n  install.packages(\"igraph\")\n}\nif (!requireNamespace(\"tidyverse\", quietly = TRUE)) {\n  install.packages(\"tidyverse\")\n}\nif (!requireNamespace(\"collapsibleTree\", quietly = TRUE)) {\n  install.packages(\"collapsibleTree\")\n}\nif (!requireNamespace(\"dendextend\", quietly = TRUE)) {\n  install.packages(\"dendextend\")\n}\n\n# Load packages\nlibrary(ggraph)\nlibrary(igraph)\nlibrary(tidyverse)\nlibrary(collapsibleTree)\nlibrary(dendextend)",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Dendrogram"
    ]
  },
  {
    "objectID": "Composition/Dendrogram.html#data-preparation",
    "href": "Composition/Dendrogram.html#data-preparation",
    "title": "Dendrogram",
    "section": "Data Preparation",
    "text": "Data Preparation\nUse the built-in R datasets warpbreaks, mtcars, USArrests, and TCGA-BRCA.star_counts.tsv from the UCSC Xena website (UCSC Xena (xenabrowser.net)).\n\n# warpbreaks\ndata(\"warpbreaks\")\nwarpbreaks &lt;- warpbreaks %&gt;%\n  mutate(breaks = as.character(breaks))\n\n# Convert nested dataframe data to side list data and then draw a tree diagram.\nedges_level1_2 &lt;- warpbreaks %&gt;%\n  select(wool, tension) %&gt;%\n  distinct() %&gt;%\n  rename(from = wool, to = tension)\n\nedges_level2_3 &lt;- warpbreaks %&gt;%\n  select(tension, breaks) %&gt;%\n  distinct() %&gt;%\n  rename(from = tension, to = breaks)\n\nedge_list &lt;- bind_rows(edges_level1_2, edges_level2_3) # merge\nedge_list_unique &lt;- edge_list[edge_list$from != \"B\",]\nedge_list_unique$to &lt;- make.unique(edge_list_unique$to)\n\n\n# Create a graph object\nmygraph_unique &lt;- graph_from_data_frame(edge_list_unique)\n\n# Hierarchical grouping\nV(mygraph_unique)$group &lt;- case_when(\n  V(mygraph_unique)$name %in% unique(warpbreaks$wool) ~ \"Group 1\", # root node wool\n  str_detect(V(mygraph_unique)$name, \"^[LMH]\") ~ \"Group 2\", # First layer of tension\n  str_detect(V(mygraph_unique)$name, \"^[0-9]\") ~ \"Group 3\", # Second layer breaks\n  TRUE ~ \"Group 4\" # Additional correction layer\n)\nV(mygraph_unique)$color &lt;- case_when(\n  V(mygraph_unique)$group == \"Group 1\" ~ \"red\",\n  V(mygraph_unique)$group == \"Group 2\" ~ \"yellow\",\n  V(mygraph_unique)$group == \"Group 3\" ~ \"green\",\n  V(mygraph_unique)$group == \"Group 4\" ~ \"blue\"\n)\n\n# mtcars\nmtcars %&gt;% \n  select(mpg, cyl, disp) %&gt;% \n  dist() %&gt;% \n  hclust() %&gt;% \n  as.dendrogram() -&gt; mtcars_dend # Clustering using 3 variables\n\n# TCGA-BRCA.star_counts.tsv\ndata &lt;- read.csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/TCGA-BRCA.star_counts.tsv\", header = TRUE, sep = \"\")\nexpression_subset &lt;- data[1:20,2:21]\ncolnames(expression_subset) &lt;- substr(colnames(data)[2:21], 6, nchar(colnames(data)[2:21]))\n\ndistance_matrix &lt;- dist(t(expression_subset), method = \"euclidean\") # Calculate Euclidean distance\ncluster_result &lt;- hclust(distance_matrix, method = \"complete\") # Hierarchical clustering using hclust\n\nsample_type &lt;- substr(colnames(expression_subset), nchar(colnames(expression_subset)), nchar(colnames(expression_subset)))\ncolors &lt;- ifelse(sample_type == \"A\", \"red\", \"blue\")\nbrca_dend &lt;- as.dendrogram(cluster_result)\nbrca_dend &lt;- brca_dend %&gt;%\n  color_labels(col = colors)",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Dendrogram"
    ]
  },
  {
    "objectID": "Composition/Dendrogram.html#visualization",
    "href": "Composition/Dendrogram.html#visualization",
    "title": "Dendrogram",
    "section": "Visualization",
    "text": "Visualization\n\n1. Tree diagram of hierarchical data\n\n1.1 Basic plot\nHierarchical tree diagrams are constructed based on known classification structures, illustrating the relationships between different levels. For example, in a corporate organizational structure, the CEOâ€™s management team is at the top of the tree, while lower-level employees are distributed across different branches of the tree according to their functions or departments. This type of tree diagram hierarchically displays the relationships between various groups, helping to understand the overall hierarchical structure.\n\nggraph(mygraph_unique, layout = 'dendrogram', circular = FALSE) + \n  geom_edge_diagonal() +\n  geom_node_point() +\n  theme_void()\n\n\n\n\nTree diagram of hierarchical data\n\n\n\n\nThe graph above, constructed using multiple variables (wool, tension, breaks) from the warpbreaks dataset, illustrates the hierarchical relationship between them. The root node is the A category of wool. The first layer represents the tension (L, M, H) levels under each wool category, and the second layer represents the breaks under each tension category. Through this tree structure, the graph clearly shows how to start from wool (fabric type), progressively refine to different levels of tension, and then to the specific details of the number of breaks.\n\n\n1.2 Custom tree diagram\nUse the circular = TRUE parameter to draw a circular tree diagram.\n\nggraph(mygraph_unique, layout = 'dendrogram', circular = TRUE) + \n  geom_edge_diagonal() +\n  theme_void() \n\n\n\n\nCustom tree diagram\n\n\n\n\nChoose different edge styles. The ggraph package contains two main functions: geom_edge_link() and geom_edge_diagonal(). The most common â€œelbowâ€ shape in tree graphs is not visible when the edge style is a straight line.\n\nggraph(mygraph_unique, layout = 'dendrogram', circular = FALSE) + \n  geom_edge_link() + \n  theme_void() \n\n\n\n\nChoose different edge styles\n\n\n\n\nUse geom_node_text and geom_node_point to add labels and nodes.\n\nggraph(mygraph_unique, layout = 'dendrogram') + \n  geom_edge_diagonal() + \n  geom_node_text(aes(label = name, filter = leaf), angle = 90, hjust = 1, nudge_y = -0.04) + \n  geom_node_point(aes(filter = leaf), alpha = 0.6) + \n  ylim(-0.5, NA) + \n  theme_void()\n\n\n\n\nAdd labels and nodes\n\n\n\n\nAdd color or shape to the treemap to show the organization of the dataset more clearly. ggraph works the same as ggplot2, allowing you to map a column of the initial dataframe to shape, color, size, or other elements.\n\nggraph(mygraph_unique, layout = 'dendrogram') + \n  geom_edge_diagonal() +\n  geom_node_text(aes(label = name, color = color, filter = leaf), angle = 90, hjust = 1, nudge_y = -0.1) +\n  geom_node_point(aes(color = color), alpha = 0.6) + \n  ylim(-0.6, NA) + \n  theme_void() +\n  theme(legend.position = \"none\")\n\n\n\n\nAdd color or shape to the tree diagram\n\n\n\n\n\n\n\n2. Interactive tree diagram\nUse the CollapsibleTree package to draw interactive tree diagrams.\n\np &lt;- collapsibleTree(warpbreaks, c(\"wool\", \"tension\", \"breaks\"))\np\n\n\n\nInteractive tree diagram\n\n\nThis diagram visualizes the warpbreaks dataset as an interactive tree diagram, categorized by the hierarchical structure of three variables: â€œwoolâ€ (wool type), â€œtension,â€ and â€œbreaksâ€ (number of breaks). Each node represents a level, and users can click to expand or collapse different nodes to view the data summary at that level. This diagram helps users understand the distribution of hierarchical data and the relationships between levels, making it suitable for displaying data with multi-level structures.\n\n\n3. Clustering dendrogram\nUse the built-in hclust() function in R to plot the graph.\n\nThe input dataset is typically a matrix, where each row represents a sample and each column represents a variable. If needed, the matrix can be transposed using the t() function to swap rows and columns.\nHierarchical clustering is performed on a square matrix (samples x sample matrix) that describes the similarity or distance between samples. These distances can be calculated using functions such as dist() (for Euclidean distance) or cor() (for correlation), depending on your problem and the characteristics of your data.\nThen, the hclust() function is used to perform hierarchical clustering, yielding a clustering result. Finally, you can use the plot() function to visualize the clustering results, such as a dendrogram, and make any necessary customizations.\n\nThe principle of hierarchical clustering is as follows: First, calculate the distance (or similarity) between samples. Next, find the minimum distance between two samples. Merge these two samples into a cluster. Use the â€œcentroidâ€ of these two objects to represent the newly formed cluster. Then, continue repeating this process until all objects have been merged into a final cluster. Different methods can be used to calculate the distance between two clusters: for example, using the maximum distance, minimum distance, average distance between two points in the cluster, or using the Ward method (the default). Different distance calculation methods will affect the clustering results.\n\n3.1 Basic tree diagram\n\nplot(cluster_result, main = \"Hierarchical Clustering of TCGA-BRCA Samples\", \n     xlab = \"Samples\", ylab = \"Height\", sub = \"\", cex = 0.8)\n\n\n\n\nBasic tree diagram\n\n\n\n\nThis figure illustrates the similarity and clustering structure among gene expression levels in the TCGA-BRCA samples.\n\n\n3.2 Zoom Group\nYou can zoom in on specific parts of the tree. Use the [[..]] operator to select the group of interest.\n\ndhc &lt;- as.dendrogram(cluster_result)\npar(mar = c(8, 4, 4, 2))\nplot(dhc[[2]], main = \"Zoom on a Part of the Dendrogram\")\n\n\n\n\nZoom Group\n\n\n\n\nThis figure presents a partial view of the hierarchical clustering results of gene expression levels in the TCGA-BRCA samples. By extracting the second part of the clustering dendrogram, the figure shows the clustering structure at a certain level. This part helps to observe the similarities between samples and the clustering process in depth, especially for the details of certain specific clusters.\n\n\n3.3 Colors and Legends\n\npar(mar = c(8, 4, 4, 2))\nplot(brca_dend, main = \"Hierarchical Clustering of TCGA-BRCA Samples\", xlab = \"\", ylab = \"\", sub = \"\", cex = 0.8)\nlegend(\"topright\", \n       legend = c(\"Tumor (A)\", \"Normal (B)\"), \n       col = c(\"red\", \"blue\"), \n       pch = 20, \n       bty = \"n\",  \n       pt.cex = 1.5, \n       cex = 0.8, \n       text.col = \"black\", \n       horiz = FALSE, \n       inset = c(0, 0.1)) # Add legend\n\n\n\n\nColors and Legends\n\n\n\n\nThis figure illustrates the hierarchical clustering results of gene expression levels in TCGA-BRCA samples. The dendrogram visually demonstrates the similarity between different samples, and the color-coded labels (red for tumor samples, blue for normal samples) show the distribution of tumor and normal samples within the clusters. The legend provides the correspondence between colors and sample types, aiding in understanding the sample classification process.\n\n\n\n4. dendextend package\nUse the dendextend package to draw clustering dendrograms.\nFirst, letâ€™s review how to build dendrograms in basic R:\n\nThe input dataset is typically a data frame, where each row represents a sample and each column represents a feature.\nThe dist() function is used to calculate the distance between samples, usually using Euclidean distance or other distance metrics suitable for the data type.\nThe hclust() function performs hierarchical clustering, grouping samples based on similarity.\n\nFinally, the plot() function is used to visualize the clustering results, directly drawing a hierarchical dendrogram to help us visually view the clustering relationships between samples.\n\n4.1 Basic tree diagram\n\npar(mar=c(7,3,1,1)) \nplot(mtcars_dend)\n\n\n\n\nBasic tree diagram\n\n\n\n\nThis figure shows the hierarchical clustering results of three variables (mpg, cyl, and disp) in the mtcars dataset. Through cluster analysis, the dendrogram in the figure clearly shows the similarity between different car samples.\n\n\n4.2 Custom tree diagram\n\n# Left image\nmtcars_dend %&gt;% \n  # Custom branches\n  set(\"branches_col\", \"grey\") %&gt;% set(\"branches_lwd\", 3) %&gt;%\n  # Custom Leaf\n  set(\"labels_col\", \"orange\") %&gt;% set(\"labels_cex\", 0.8) %&gt;%\n  plot()\n\n\n\n\nCustom tree diagram\n\n\n\n# middle image\nmtcars_dend %&gt;% \n  set(\"nodes_pch\", 19)  %&gt;% \n  set(\"nodes_cex\", 0.7) %&gt;% \n  set(\"nodes_col\", \"orange\") %&gt;% \n  plot()\n\n\n\n\nCustom tree diagram\n\n\n\n# right image\nmtcars_dend %&gt;% \n  set(\"leaves_pch\", 19)  %&gt;% \n  set(\"leaves_cex\", 0.7) %&gt;% \n  set(\"leaves_col\", \"skyblue\") %&gt;% \n  plot()\n\n\n\n\nCustom tree diagram\n\n\n\n\nThese three diagrams demonstrate different ways to customize a tree diagram, enhancing its visual appeal by modifying the color, size, and shape of branches, nodes, and leaves.\n\n\n4.3 Highlight clusters\ndendextend has some great features for highlighting tree clusters. Branches can be colored and marked based on their clustering properties, specifying the desired number of clusters. The rect.dendrogram() function even allows highlighting one or more specific clusters using rectangles.\n\npar(mar=c(1,1,1,8))\nmtcars_dend %&gt;%\n  set(\"labels_col\", value = c(\"skyblue\", \"orange\", \"grey\"), k=3) %&gt;%\n  set(\"branches_k_color\", value = c(\"skyblue\", \"orange\", \"grey\"), k = 3) %&gt;%\n  plot(horiz=TRUE, axes=FALSE)\nabline(v = 350, lty = 2)\n\n\n\n\nHighlight clusters\n\n\n\n\nThis graph horizontally displays the hierarchical clustering results of three variables (mpg, cyl, and disp) in the mtcars dataset. Different clusters are distinguished by different colors, and a specific cluster location is marked by a dashed line.\n\n# Highlight with a rectangle\npar(mar=c(9,1,1,1))\nmtcars_dend %&gt;%\n  set(\"labels_col\", value = c(\"skyblue\", \"orange\", \"grey\"), k=3) %&gt;%\n  set(\"branches_k_color\", value = c(\"skyblue\", \"orange\", \"grey\"), k = 3) %&gt;%\n  plot(axes=FALSE)\nrect.dendrogram( mtcars_dend, k=3, lty = 5, lwd = 0, x=1, col=rgb(0.1, 0.2, 0.4, 0.1) ) \n\n\n\n\nHighlight with a rectangle\n\n\n\n\nThis graph horizontally displays the hierarchical clustering results of three variables (mpg, cyl, and disp) in the mtcars dataset, highlighting specific categories with rectangles.\n\n\n4.4 Comparison with expected clustering\nComparing the obtained clusters with the expected distribution is a common task. In mtcars, the am column is a binary variable. We can use the colored_bars() function to check if this variable is consistent with the clusters we obtained.\n\nmy_colors &lt;- ifelse(mtcars$am==0, \"forestgreen\", \"green\")\n\npar(mar=c(10,1,1,1))\nmtcars_dend %&gt;%\n  set(\"labels_col\", value = c(\"skyblue\", \"orange\", \"grey\"), k=3) %&gt;%\n  set(\"branches_k_color\", value = c(\"skyblue\", \"orange\", \"grey\"), k = 3) %&gt;%\n  set(\"leaves_pch\", 19)  %&gt;% \n  set(\"nodes_cex\", 0.7) %&gt;% \n  plot(axes=FALSE)\n\ncolored_bars(colors = my_colors, dend = mtcars_dend, rowLabels = \"am\")\n\n\n\n\nComparison with expected clustering\n\n\n\n\nThis diagram illustrates a dendrogram based on hierarchical clustering, where samples (data points) are divided into different clusters and labeled with different colors and styles. The leaf nodes of the dendrogram use different colors to represent different values (0 or 1) of the am variable in the mtcars dataset, and the labeling, branch colors, etc., of each node are customized. The diagram further emphasizes the category (am) of each sample using a color bar chart.\n\n\n4.5 Comparing two tree diagrams\nThe tanglegram() function can be used to compare two dendrites. When calculating the distance matrix and running hierarchical clustering, you cannot rely solely on the default options; you need to choose according to your specific needs. Different clustering methods will produce different results, so it is important to understand and compare the differences between various methods.\n\n# Two clustering methods were used.\nd1 &lt;- USArrests %&gt;% dist() %&gt;% hclust( method=\"average\" ) %&gt;% as.dendrogram()\nd2 &lt;- USArrests %&gt;% dist() %&gt;% hclust( method=\"complete\" ) %&gt;% as.dendrogram()\n\ndl &lt;- dendlist(\n  d1 %&gt;% \n    set(\"labels_col\", value = c(\"skyblue\", \"orange\", \"grey\"), k=3) %&gt;%\n    set(\"branches_lty\", 1) %&gt;%\n    set(\"branches_k_color\", value = c(\"skyblue\", \"orange\", \"grey\"), k = 3),\n  d2 %&gt;% \n    set(\"labels_col\", value = c(\"skyblue\", \"orange\", \"grey\"), k=3) %&gt;%\n    set(\"branches_lty\", 1) %&gt;%\n    set(\"branches_k_color\", value = c(\"skyblue\", \"orange\", \"grey\"), k = 3)\n)\n\n# Merging plot\ntanglegram(dl, \n           common_subtrees_color_lines = FALSE, highlight_distinct_edges  = TRUE, highlight_branches_lwd=FALSE, \n           margin_inner=7,\n           lwd=2\n)\n\n\n\n\nComparing two tree diagrams\n\n\n\n\nThis graph compares the clustering results of two different clustering methods on the same dataset (USArrests). Two hierarchical clustering trees (d1 and d2) are merged into a single graph using dendlist(), and the differences between the two trees are displayed using the tanglegram() function. The graph highlights the different clustering branches and uses colors to distinguish the different partitions in the clustering process by the two methods. This visually shows the differences in the clustering results of the two methods and helps users understand their distinctions.",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Dendrogram"
    ]
  },
  {
    "objectID": "Composition/Dendrogram.html#applications",
    "href": "Composition/Dendrogram.html#applications",
    "title": "Dendrogram",
    "section": "Applications",
    "text": "Applications\n\n1. Basic tree diagram\n\n\n\n\n\n\nFigureÂ 1: Applications of basic tree diagram\n\n\n\nGene co-expression modules and meta-modules. A) The dendrogram shows the results of hierarchical clustering of genes in the VSP. Leaves along the branches represent gene probes. The y-axis represents the network distance determined by 1 â€“ topological overlap (TO), where values close to 0 indicate higher similarity in probe expression profiles between samples. The color blocks below represent the modules to which probes are assigned in each region of the VSP (top) and Region X (bottom). The colors of the Region X modules are set to match the VSP colors as closely as possible, so color blocks that match in both bands indicate that the VSP module is retained in Region X (e.g., pink, red, turquoise, purple). Unreserved modules: blue, greenish-yellow, yellow, and salmon. (B) The dendrogram shows the results of hierarchical clustering of VSP module characteristic genes (MEs) to examine higher-order relationships between modules. Leaves along the branches represent MEs. The y-axis represents the network distance determined by 1 â€“ correlation, where values close to 0 indicate higher similarity between the main sources of expression perturbations in the modules. (C) Heatmap showing the correlation between VSP MEs. Each row/column represents one ME, indicated by color blocks on the x and y axes. Dark red indicates a strong positive correlation, dark green indicates a strong negative correlation, and white indicates no correlation, as shown on the color scale. The cells on the diagonal are dark red because each ME is perfectly correlated with itself. (D) Color keys for all VSP modules. The same colors are used in subsequent plots. [1]\n\n\n2. Comparison with expected clustering\n\n\n\n\n\n\nFigureÂ 2: Applications of comparison with expected clustering\n\n\n\nUnsupervised results of the dendrogram algorithm applied to the expression matrix (left) and the normalized correlation matrix (Figure 3B) (right). Genes belonging to the same operon are marked with the same color. Note that the four mismatches only occur in the normalized correlation matrix (left). [2]\n\n\n3. Circular tree diagram\n\n\n\n\n\n\nFigureÂ 3: Applications of circular tree diagram\n\n\n\nOptimal dendrogram of 3,905 RefSeq viral genomes (k = 9). Lineages are colored by Baltimore classification. Circles are colored from the inside out according to different order, host, and genome size, as shown below: Ranch by Baltimore classification: dsDNA (no RNA stage), red; dsRNA, green; RT virus, pink; ssDNA, blue; ssRNA negative strand, bright blue; ssRNA positive strand, yellow. First circle, from the inside out, in order: Caudovirales, red; Herpesviruses, green; Ligamenvirales, blue; Monogavirales, orange; Nidovirales, cyan; Picornavirales, pink; Tymovirales, dark green; Unclassified, silver. Second circle, from the inside out, by host: Protists, orange; Archaea, red; Bacteria, dark green; Fungi, blue; Animals, cyan; Plants and animals, pale purple-red; Plants, pink; Environment or NA, silver. The third circle, arranged from the inside out, is by genome size: Q1, green; Q2, yellow; Q3, orange; Q4, red. [3]",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Dendrogram"
    ]
  },
  {
    "objectID": "Composition/Dendrogram.html#reference",
    "href": "Composition/Dendrogram.html#reference",
    "title": "Dendrogram",
    "section": "Reference",
    "text": "Reference\n[1] Hilliard AT, Miller JE, Horvath S, White SA. Distinct neurogenomic states in basal ganglia subregions relate differently to singing behavior in songbirds. PLoS Comput Biol. 2012;8(11):e1002773. doi: 10.1371/journal.pcbi.1002773. Epub 2012 Nov 8. PMID: 23144607; PMCID: PMC3493463.\n[2] Madi A, Friedman Y, Roth D, Regev T, Bransburg-Zabary S, Ben Jacob E. Genome holography: deciphering function-form motifs from gene expression data. PLoS One. 2008 Jul 16;3(7):e2708. doi: 10.1371/journal.pone.0002708. PMID: 18628959; PMCID: PMC2444029.\n[3] Zhang Q, Jun SR, Leuze M, Ussery D, Nookaew I. Viral Phylogenomics Using an Alignment-Free Method: A Three-Step Approach to Determine Optimal Length of k-mer. Sci Rep.Â 2017 Jan 19;7:40712. doi: 10.1038/srep40712. PMID: 28102365; PMCID: PMC5244389.\n[4] ggraph: Grammar of Graphs for ggplot2. https://cran.r-project.org/web/packages/ggraph/index.html\n[5] igraph: Network Analysis and Visualization. https://cran.r-project.org/web/packages/igraph/index.html\n[6] tidyverse: Easily Install and Load the â€˜Tidyverseâ€™. https://cran.r-project.org/web/packages/tidyverse/index.html\n[7] CollapsibleTree: Interactive Hierarchical Tree Plots. https://cran.r-project.org/web/packages/CollapsibleTree/index.html\n[8] dendextend: Extensions to Dendrogram Class. https://cran.r-project.org/web/packages/dendextend/index.html",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Dendrogram"
    ]
  },
  {
    "objectID": "Composition/Treemap.html",
    "href": "Composition/Treemap.html",
    "title": "Treemap",
    "section": "",
    "text": "A treemap, also known as a rectangular tree structure diagram, is composed of multiple nested rectangles of varying areas. The sum of the areas of all rectangles represents the overall data. The area of each smaller rectangle represents the proportion of each sub-item; the larger the rectangleâ€™s area, the larger the proportion of that sub-item within the whole.",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Treemap"
    ]
  },
  {
    "objectID": "Composition/Treemap.html#example",
    "href": "Composition/Treemap.html#example",
    "title": "Treemap",
    "section": "Example",
    "text": "Example\n\n\n\n\n\nTreemap are suitable for displaying data with hierarchical relationships and can intuitively show the comparison between peers (tree diagrams use rectangles of different colors and sizes to display the hierarchical structure of the data).",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Treemap"
    ]
  },
  {
    "objectID": "Composition/Treemap.html#setup",
    "href": "Composition/Treemap.html#setup",
    "title": "Treemap",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming Language: R\nDependencies: treemap; tidyverse; stats; DOSE\n\n\n# Install packages\nif (!requireNamespace(\"treemap\", quietly = TRUE)) {\n  install.packages(\"treemap\")\n}\nif (!requireNamespace(\"tidyverse\", quietly = TRUE)) {\n  install.packages(\"tidyverse\")\n}\nif (!requireNamespace(\"stats\", quietly = TRUE)) {\n  install.packages(\"stats\")\n}\nif (!requireNamespace(\"DOSE\", quietly = TRUE)) {\n  install.packages(\"DOSE\")\n}\n\n# Load packages\nlibrary(treemap)\nlibrary(tidyverse)\nlibrary(stats)\nlibrary(DOSE)\nlibrary(palmerpenguins)",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Treemap"
    ]
  },
  {
    "objectID": "Composition/Treemap.html#data-preparation",
    "href": "Composition/Treemap.html#data-preparation",
    "title": "Treemap",
    "section": "Data Preparation",
    "text": "Data Preparation\n\ndata_USArrests &lt;- rownames_to_column(USArrests[1:8,], \"State\")\n\ndata_swiss &lt;- swiss\n\ndata_countsub &lt;- aggregate(penguins, by=list(penguins$species, penguins$sex),length)\ndata_countsub &lt;- data_countsub[ ,1:3]\ncolnames(data_countsub) &lt;- c(\"species\", \"sex\", \"count\")\n\ndata_BP &lt;- readr::read_csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/data_BP.csv\")\ndata_BP &lt;- data_BP[order(abs(data_BP$NES), decreasing = T),]\ndata_BP &lt;- data_BP[1:13,]\n\ndata_KEGG_type &lt;- readr::read_csv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/data_KEGG.csv\")\ndata_KEGG_type$pvalue_log &lt;- -log10(data_KEGG_type$pvalue)",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Treemap"
    ]
  },
  {
    "objectID": "Composition/Treemap.html#visualization",
    "href": "Composition/Treemap.html#visualization",
    "title": "Treemap",
    "section": "Visualization",
    "text": "Visualization\n\n1. Single variable classification\n\n1.1 Color according to the label\nTaking the USArrests dataset as an example\n\ntreemap(data_USArrests, # data\n        index = \"State\", # Categorical variables\n        vSize = \"Murder\", # Categorical variable corresponding data values\n        vColor=\"State\", # The corresponding columns of color depth, here the data size is used as the corresponding\n        type = \"index\", # Color mapping method, including \"index\", \"value\", \"comp\", \"dens\", \"depth\", \"categorical\", \"color\", and \"manual\".\n        title = 'Murder', # title\n        border.col = \"grey\", # Border color\n        border.lwds = 4, # Border line width\n        fontsize.labels = 12, # Label size\n        fontcolor.labels = 'red', # Label color\n        align.labels = list(c(\"center\", \"center\")), # Tag location\n        fontface.labels = 2) # Tag fonts: 1, 2, 3, 4 represent normal, bold, italic, and bold italic fonts, respectively.\n\n\n\n\n\n\n\nFigureÂ 1: Color according to the label\n\n\n\n\n\nThe image above is a tree diagram showing the proportion of criminal arrests in different U.S. states, with each state used as the basis for coloring.\n\n\n1.2 Color according to data size\nTaking the USArrests dataset as an example\n\ntreemap(data_USArrests, \n        index = \"State\",\n        vSize = \"Murder\",\n        vColor=\"Murder\",\n        type = \"value\",\n        title = 'Murder',\n        border.col = \"grey\",\n        border.lwds = 4,\n        fontsize.labels = 12,\n        fontcolor.labels = 'red',\n        align.labels = list(c(\"center\", \"center\")),\n        fontface.labels = 2)\n\n\n\n\n\n\n\nFigureÂ 2: Color according to data size\n\n\n\n\n\nThe image above is a tree diagram showing the proportion of criminal arrests in different US states, with color coding based on the size of each data group.\nExample: Hallmark analysis data of differentially expressed genes in mouse lung tissue before and after cisplatin administration.\n\ntreemap(data_BP[1:13,], \n        index = \"BP\",\n        vSize = \"pvalue_log\",\n        vColor=\"NES\",\n        type = \"value\",\n        title = 'Biological Process',\n        border.col = \"grey\",\n        border.lwds = 4,\n        fontsize.labels = 10,\n        fontcolor.labels = 'white',\n        align.labels = list(c(\"center\", \"center\")),\n        fontface.labels = 2)\n\n\n\n\n\n\n\nFigureÂ 3: HALLMARK analysis results data\n\n\n\n\n\nThe figure above shows the results of Hallmark analysis of differentially expressed genes in mouse lung tissue before and after cisplatin administration. The size of the rectangle represents the negative value of log10(P), and the larger the rectangle, the more reliable the result. The color of the rectangle represents the NES value.\n\n\n\n2. Multivariate classification\nMulti-level grouping can be achieved using index = c(\"Group1\", \"Group2\", ...).\n\n2.1 Color matching based on data labels\nTaking the penguins dataset as an example\n\ntreemap(data_countsub, \n        index = c(\"sex\",\"species\"),\n        vSize = \"count\",\n        vColor=\"species\",\n        type = \"index\",\n        title = 'Count',\n        border.col = c(\"black\",\"white\"),\n        border.lwds = c(4,1),\n        fontsize.labels = c(18,10),\n        bg.labels=c(\"transparent\"),\n        fontcolor.labels = c('white',\"orange\"),\n        align.labels = list(c(\"left\", \"top\"),\n                            c(\"center\", \"center\")),\n        fontface.labels = c(2,3))\n\n\n\n\n\n\n\nFigureÂ 4: Color matching based on data labels\n\n\n\n\n\nThe image above shows the penguin counts in the penguins dataset, grouped by sex and species. The classification is used as the basis for coloring.\n\n\n2.2 Color according to data size\nTaking the penguins dataset as an example\n\ntreemap(data_countsub, \n        index = c(\"sex\",\"species\"),\n        vSize = \"count\",\n        vColor=\"count\",\n        type = \"value\",\n        title = 'Count',\n        border.col = c(\"black\",\"white\"),\n        border.lwds = c(4,1),\n        fontsize.labels = c(18,10),\n        bg.labels=c(\"transparent\"),\n        fontcolor.labels = c('white',\"orange\"),\n        align.labels = list(c(\"left\", \"top\"),\n                            c(\"center\", \"center\")),\n        fontface.labels = c(2,3))\n\n\n\n\n\n\n\nFigureÂ 5: Color according to data size\n\n\n\n\n\nThe image above shows the penguin counts in the penguins dataset, grouped by sex and species. The coloring is based on the count.\nThe following example uses pathway analysis data of differentially expressed genes in mouse lung tissue before and after cisplatin administration.\n\ntreemap(data_KEGG_type, \n        index = c(\"type\",\"subtype\",\"PW\"),\n        vSize = \"pvalue_log\",\n        vColor=\"NES\",\n        type = \"value\",\n        title = 'KEGG pathway analysis results data',\n        border.col = c(\"black\",\"white\",\"orange\"),\n        border.lwds = c(4,1),\n        fontsize.labels = c(18,15,10),\n        bg.labels=c(\"transparent\"),\n        fontcolor.labels = c('black',\"white\",\"orange\"),\n        align.labels = list(c(\"left\", \"top\"),\n                            c(\"center\", \"center\"),\n                            c(\"left\",\"bottom\")),\n        fontface.labels = c(2,3))\n\n\n\n\n\n\n\nFigureÂ 6: KEGG pathway analysis results data\n\n\n\n\n\nThe figure above shows the KEGG pathway analysis results for differentially expressed genes in mouse lung tissue before and after cisplatin treatment. The figure illustrates the multi-level classification of pathways. The size of the rectangle represents the negative log10(P) value, with larger rectangles indicating more reliable results. The color of the rectangles represents the Negative Estimates (NES) value.",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Treemap"
    ]
  },
  {
    "objectID": "Composition/Treemap.html#applications",
    "href": "Composition/Treemap.html#applications",
    "title": "Treemap",
    "section": "Applications",
    "text": "Applications\n\n\n\n\n\n\nFigureÂ 7: Applications of Treemap 1\n\n\n\nThe figure above shows the functional enrichment of GO biological process terms for the Î²-catenin network. The most enriched terms in the top ten clusters are shown in the dendrogram, represented by color blocks. For each term, the box size reflects the p-value for term enrichment. [1]\n\n\n\n\n\n\nFigureÂ 8: Applications of Treemap 2\n\n\n\nThe figure above shows the gene analysis of upregulated and downregulated genes. BiNGO was used to perform gene analysis on upregulated and downregulated genes. Existence arguments and associated correction p-values were passed to REVIGO, which performed a summary by removing redundant GO terms.\nA tree diagram with functional annotations associated with (a) upregulated and (b) downregulated genes was generated. [2]",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Treemap"
    ]
  },
  {
    "objectID": "Composition/Treemap.html#reference",
    "href": "Composition/Treemap.html#reference",
    "title": "Treemap",
    "section": "Reference",
    "text": "Reference\n[1] Ã‡elen Ä°, Ross KE, Arighi CN, Wu CH. Bioinformatics Knowledge Map for Analysis of Beta-Catenin Function in Cancer. PLoS One. 2015 Oct 28;10(10):e0141773. doi: 10.1371/journal.pone.0141773. PMID: 26509276; PMCID: PMC4624812.\n[2] Corley SM, Canales CP, Carmona-Mora P, Mendoza-Reinosa V, Beverdam A, Hardeman EC, Wilkins MR, Palmer SJ. RNA-Seq analysis of Gtf2ird1 knockout epidermal tissue provides potential insights into molecular mechanisms underpinning Williams-Beuren syndrome. BMC Genomics. 2016 Jun 13;17:450. doi: 10.1186/s12864-016-2801-4. PMID: 27295951; PMCID: PMC4907016.\n[3] Tennekes M (2023). treemap: Treemap Visualization. R package version 2.4-4, https://CRAN.R-project.org/package=treemap.\n[4] Wickham H, Averick M, Bryan J, Chang W, McGowan LD, FranÃ§ois R, Grolemund G, Hayes A, Henry L, Hester J, Kuhn M, Pedersen TL, Miller E, Bache SM, MÃ¼ller K, Ooms J, Robinson D, Seidel DP, Spinu V, Takahashi K, Vaughan D, Wilke C, Woo K, Yutani H (2019). â€œWelcome to the tidyverse.â€ Journal of Open Source Software, 4(43), 1686. doi:10.21105/joss.01686 https://doi.org/10.21105/joss.01686.\n[5] R Core Team (2024). R: A Language and Environment for Statistical Computing. R Foundation for Statistical Computing, Vienna, Austria. https://www.R-project.org/.",
    "crumbs": [
      "<i class='fa-solid fa-chart-pie'></i> Composition",
      "Treemap"
    ]
  },
  {
    "objectID": "Clinics/MetaForestPlot.html",
    "href": "Clinics/MetaForestPlot.html",
    "title": "Meta-Analysis Forest Plot",
    "section": "",
    "text": "A forest plot is a commonly used graphical representation in meta-analysis to visualize the results of individual studies. It displays the observed effect size, confidence interval, and weight of each study, allowing for clear comparison of results across the research.",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> ğ‚ğ‹ğˆğğˆğ‚ğ’",
      "MetaForestPlot"
    ]
  },
  {
    "objectID": "Clinics/MetaForestPlot.html#example",
    "href": "Clinics/MetaForestPlot.html#example",
    "title": "Meta-Analysis Forest Plot",
    "section": "",
    "text": "A forest plot is a commonly used graphical representation in meta-analysis to visualize the results of individual studies. It displays the observed effect size, confidence interval, and weight of each study, allowing for clear comparison of results across the research.",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> ğ‚ğ‹ğˆğğˆğ‚ğ’",
      "MetaForestPlot"
    ]
  },
  {
    "objectID": "Clinics/MetaForestPlot.html#setup",
    "href": "Clinics/MetaForestPlot.html#setup",
    "title": "Meta-Analysis Forest Plot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: meta, metafor, ggplot2, dplyr, tidyr, grid, forestplot\n\n\n# Installing packages\nif (!requireNamespace(\"meta\", quietly = TRUE)) {\n  install.packages(\"meta\")\n}\nif (!requireNamespace(\"metafor\", quietly = TRUE)) {\n  install.packages(\"metafor\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"tidyr\", quietly = TRUE)) {\n  install.packages(\"tidyr\")\n}\nif (!requireNamespace(\"grid\", quietly = TRUE)) {\n  install.packages(\"grid\")\n}\nif (!requireNamespace(\"forestplot\", quietly = TRUE)) {\n  install.packages(\"forestplot\")\n}\n\n# Load packages\nlibrary(meta)\nlibrary(metafor)\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(grid)\nlibrary(forestplot)",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> ğ‚ğ‹ğˆğğˆğ‚ğ’",
      "MetaForestPlot"
    ]
  },
  {
    "objectID": "Clinics/MetaForestPlot.html#data-preparation",
    "href": "Clinics/MetaForestPlot.html#data-preparation",
    "title": "Meta-Analysis Forest Plot",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Generate simulated data\nset.seed(2023)\nn_studies &lt;- 15\nmeta_data &lt;- tibble(\n  `Study Name` = paste(\"Study\", LETTERS[1:n_studies]),\n  `Odds Ratio` = exp(rnorm(n_studies, mean = 0.2, sd = 0.4)),\n  `Lower 95% CI` = exp(rnorm(n_studies, mean = 0.1, sd = 0.35)),\n  `Upper 95% CI` = exp(rnorm(n_studies, mean = 0.3, sd = 0.45)),\n  `Weight (%)` = runif(n_studies, 0.5, 3),\n  `Treatment Group` = sample(c(\"DrugA\", \"DrugB\"), n_studies, replace = TRUE)\n) %&gt;% \n  mutate(\n    across(c(`Odds Ratio`, `Lower 95% CI`, `Upper 95% CI`), ~round(., 2)),\n    `Weight (%)` = round(`Weight (%)`/sum(`Weight (%)`)*100, 1),\n    `Study Name` = factor(`Study Name`, levels = rev(`Study Name`))\n  ) \n\n# View the final merged dataset\nhead(meta_data)\n\n# A tibble: 6 Ã— 6\n  `Study Name` `Odds Ratio` `Lower 95% CI` `Upper 95% CI` `Weight (%)`\n  &lt;fct&gt;               &lt;dbl&gt;          &lt;dbl&gt;          &lt;dbl&gt;        &lt;dbl&gt;\n1 Study A              1.18           1.41           1.19          7.5\n2 Study B              0.82           1.36           2.4           3.3\n3 Study C              0.58           1.29           0.94          9.3\n4 Study D              1.13           1.51           1.32          9.2\n5 Study E              0.95           1.35           1.01          8.3\n6 Study F              1.89           0.96           1.11          3.4\n# â„¹ 1 more variable: `Treatment Group` &lt;chr&gt;",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> ğ‚ğ‹ğˆğğˆğ‚ğ’",
      "MetaForestPlot"
    ]
  },
  {
    "objectID": "Clinics/MetaForestPlot.html#visualization",
    "href": "Clinics/MetaForestPlot.html#visualization",
    "title": "Meta-Analysis Forest Plot",
    "section": "Visualization",
    "text": "Visualization\n\n1. Basic Plot\n\n# Basic forest plot\np &lt;-\n  ggplot(meta_data, aes(x = `Odds Ratio`, y = `Study Name`)) +\n  geom_vline(xintercept = 1, linetype = \"dashed\", color = \"grey50\") +\n  geom_errorbarh(aes(xmin = `Lower 95% CI`, xmax = `Upper 95% CI`), \n                 height = 0.15, color = \"#2c7fb8\", linewidth = 0.8) +\n  geom_point(aes(size = `Weight (%)`), shape = 18, color = \"#d95f00\") +\n  scale_x_continuous(trans = \"log\", \n                     breaks = c(0.25, 0.5, 1, 2, 4),\n                     limits = c(0.2, 5)) +\n  labs(x = \"Odds Ratio (95% CI)\", \n       y = \"\",\n       title = \"Meta-Analysis Forest Plot\",\n       subtitle = \"Random Effects Model\") +\n  theme_minimal(base_size = 12) +\n  theme(\n    panel.grid.major.y = element_blank(),\n    panel.grid.minor.x = element_blank(),\n    plot.title = element_text(face = \"bold\", hjust = 0.5),\n    plot.subtitle = element_text(hjust = 0.5, color = \"grey50\"),\n    legend.position = \"bottom\"\n  )\np\n\n\n\n\n\n\n\nFigureÂ 1: Basic Plot\n\n\n\n\n\n\n# Data Preparation ---------------------------------------------------------------\ndataset &lt;- data.frame(\nStudy_Name = c(\"ART\",\"WBC\",\"CPR\",\"DTA\",\"EPC\",\"FFT\",\"GEO\",\"HBC\",\"PTT\",\"JOK\"),\nOdds_Ratio = c(0.9, 2, 0.3, 0.4, 0.5, 1.3, 2.5, 1.6, 1.9, 1.1),\nLower_95_CI = c(0.75, 1.79, 0.18, 0.2, 0.38, 1.15, 2.41, 1.41, 1.66, 0.97),\nUpper_95_CI = c(1.05, 2.21, 0.42, 0.6, 0.62, 1.45, 2.59, 1.79, 2.14, 1.23),\nEffect_Type = factor(c('Not sig.', 'Risk', 'Protective', 'Protective', 'Protective', \n                       'Risk', 'Risk', 'Risk', 'Risk', 'Not sig.'),\n                     levels = c(\"Risk\", \"Protective\", \"Not sig.\")),\nSample_Size = c(450, 420, 390, 400, 470, 390, 400, 388, 480, 460)\n) %&gt;%  \nmutate(\n  log_OR = log(Odds_Ratio),\n  log_Lower = log(Lower_95_CI),\n  log_Upper = log(Upper_95_CI),\n  Study_Name = factor(Study_Name, levels = rev(Study_Name)))\n\n\nx_limits &lt;- c(-3.9, 2)  # Data coordinate range (left boundary to log(5)â‰ˆ1.6)\nget_npc &lt;- function(x) {\n(x - x_limits[1]) / diff(x_limits)  # Standardized coordinate transformation\n}\n\n\ncolumn_system &lt;- list(\nstudy = list(\n  data_x = -3.8, \n  npc_x = get_npc(-3.8),\n  label = \"Study\",\n  width = 1.2\n),\nevents = list(\n  data_x = -3.5,\n  npc_x = get_npc(-3.5),\n  label = \"Events\\n(Case/Control)\",\n  width = 1.8\n),\nor = list(\n  data_x = -3.1,\n  npc_x = get_npc(-3.1),\n  label = \"Odds Ratio\\n(95% CI)\",\n  width = 2.2\n),\np = list(\n  data_x = -2.7,\n  npc_x = get_npc(-2.7),\n  label = \"P Value\",\n  width = 1.2\n),\nsample = list(\n  data_x = -2.4,\n  npc_x = get_npc(-2.4),\n  label = \"Sample\\nSize\",\n  width = 1.2\n)\n)\n\n\nggplot(dataset, aes(y = Study_Name)) +\n\nannotation_custom(\n  grob = textGrob(\n    label = sapply(column_system, function(x) x$label),\n    x = unit(sapply(column_system, function(x) x$npc_x), \"npc\"),\n    y = unit(1.06, \"npc\"),\n    hjust = 0.5,\n    vjust = 0,\n    gp = gpar(\n      fontface = \"bold\", \n      fontsize = 12, \n      lineheight = 0.8,\n      col = \"black\"\n    )\n  )\n) +\n\n\n# Study Name (right aligned)\ngeom_text(\n  aes(x = column_system$study$data_x, label = Study_Name),\n  size = 3.5, \n  hjust = 1,\n  nudge_x = -0.05  # Fine-tune the position\n) +\n\n# Event rate (right aligned)\ngeom_text(\n  aes(x = column_system$events$data_x,\n      label = c(\"17/13\", \"23/18\", \"30/25\", \"10/8\", \"31/25\",\n                \"17/13\", \"23/18\", \"24/20\", \"17/12\", \"2.00/1.90\")),\n  size = 3.5, \n  hjust = 1\n) +\n\n# OR value (right aligned)\ngeom_text(\n  aes(x = column_system$or$data_x,\n      label = sprintf(\"%.2f (%.2f-%.2f)\", Odds_Ratio, Lower_95_CI, Upper_95_CI)),\n  size = 3.5,\n  hjust = 1\n) +\n\n# P value (right aligned)\ngeom_text(\n  aes(x = column_system$p$data_x,\n      label = c(\"&lt;0.001\", \"&lt;0.001\", \"0.075\", \"&lt;0.001\", \"&lt;0.001\",\n                \"&lt;0.001\", \"&lt;0.001\", \"&lt;0.001\", \"&lt;0.001\", \"0.650\")),\n  size = 3.5, \n  color = \"#d95f02\",\n  hjust = 1\n) +\n\n# Sample size (right aligned)\ngeom_text(\n  aes(x = column_system$sample$data_x, label = Sample_Size),\n  size = 3.5,\n  fontface = \"bold\",\n  hjust = 1\n) +\n\n\ngeom_vline(\n  xintercept = 0, \n  linetype = \"solid\", \n  color = \"black\", \n  linewidth = 0.8\n) +\ngeom_errorbarh(\n  aes(xmin = log_Lower, xmax = log_Upper),\n  height = 0.15, \n  color = \"grey40\", \n  linewidth = 0.8\n) +\ngeom_point(\n  aes(x = log_OR, size = Sample_Size, fill = Effect_Type),\n  shape = 21, \n  color = \"white\", \n  stroke = 1\n) +\n\n\nscale_x_continuous(\n  name = \"Odds Ratio (log scale)\",\n  breaks = log(c(0.25, 0.5, 1, 2, 4)),\n  labels = c(0.25, 0.5, 1, 2, 4),\n  limits = x_limits,\n  expand = expansion(add = c(0.1, 0.2))\n) +\nscale_size_continuous(\n  range = c(4, 10),\n  breaks = c(300, 400, 500),\n  guide = guide_legend(\n    title.position = \"top\",\n    title = \"Sample Size\",\n    nrow = 1,\n    override.aes = list(shape = 21, fill = \"grey50\")\n  )\n) +\nscale_fill_manual(\n  values = c(\n    Risk = \"#d95f02\", \n    Protective = \"#1b9e77\", \n    \"Not sig.\" = \"#7570b3\"\n  ),\n  guide = guide_legend(\n    title = NULL,\n    nrow = 1,\n    override.aes = list(size = 5)\n  )\n) +\n\n\nlabs(title = \"Multivariable Analysis of Clinical Factors\") +\ntheme_minimal(base_size = 12) +\ntheme(\n  panel.grid.major.y = element_blank(),\n  panel.grid.minor.y = element_blank(),\n  axis.title.y = element_blank(),\n  axis.text.y = element_blank(),\n  axis.ticks.y = element_blank(),\n  axis.title.x = element_text(\n    color = \"grey30\",\n    margin = margin(t = 10)\n  ),\n  axis.text.x = element_text(color = \"grey30\"),\n  plot.title = element_text(\n    hjust = 0.5, \n    face = \"bold\", \n    size = 16, \n    margin = margin(b = 20)\n  ),\n  legend.position = \"bottom\",\n  legend.box = \"horizontal\",\n  legend.spacing.x = unit(0.8, \"cm\"),\n  legend.title = element_text(size = 11),\n  legend.text = element_text(size = 10),\n  plot.margin = margin(t = 80, b = 20, l = 30, r = 30),\n  plot.background = element_rect(\n    fill = \"#f0f8ff\", \n    color = NA,\n    linewidth = 0.5\n  )\n) +\ncoord_cartesian(clip = \"off\")\n\n\n\n\n\n\n\nFigureÂ 2: Basic Plot\n\n\n\n\n\n\n\n2. Existing R packages for plotting\n\n# Forest Plot\ntest_data &lt;- data.frame(id = 1:4,\n                        coef1 = c(1, 1.59, 1.3, 1.24),\n                        coef2 = c(1, 1.7, 1.4, 1.04),\n                        low1 = c(1, 1.3, 1.1, 0.99),\n                        low2 = c(1, 1.6, 1.2, 0.7),\n                        high1 = c(1, 1.94, 1.6, 1.55),\n                        high2 = c(1, 1.8, 1.55, 1.33))\n\n# Convert into dplyr formatted data\nout_data &lt;- test_data |&gt;\n  pivot_longer(cols = everything() & -id) |&gt;\n  mutate(group = gsub(\"(.+)([12])$\", \"\\\\2\", name),\n         name = gsub(\"(.+)([12])$\", \"\\\\1\", name)) |&gt;\n  pivot_wider() |&gt;\n  group_by(id) |&gt;\n  mutate(col1 = lapply(id, \\(x) ifelse(x &lt; 4,\n                                       paste(\"Category\", id),\n                                       expression(Category &gt;= 4))),\n         col2 = lapply(1:n(), \\(i) substitute(expression(bar(x) == val),\n                                              list(val = mean(coef) |&gt; round(2)))),\n         col2 = if_else(id == 1,\n                        rep(\"ref\", n()) |&gt; as.list(),\n                        col2)) |&gt;\n  group_by(group)\n\nout_data |&gt;\n  forestplot(mean = coef,\n             lower = low,\n             upper = high,\n             labeltext = c(col1, col2),\n             title = \"Cool study\",\n             zero = c(0.98, 1.02),\n             grid = structure(c(2^-.5, 2^.5),\n                              gp = gpar(col = \"steelblue\", lty = 2)\n             ),\n             boxsize = 0.25,\n             xlab = \"The estimates\",\n             new_page = TRUE,\n             legend = c(\"Treatment\", \"Placebo\"),\n             legend_args = fpLegend(\n               pos = list(\"topright\"),\n               title = \"Group\",\n               r = unit(.1, \"snpc\"),\n               gp = gpar(col = \"#CCCCCC\", lwd = 1.5)\n             )) |&gt;\n  fp_set_style(box = c(\"royalblue\", \"gold\"),\n               line = c(\"darkblue\", \"orange\"),\n               summary = c(\"darkblue\", \"red\"))\n\n\n\n\n\n\n\nFigureÂ 3: Existing R packages for plotting",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> ğ‚ğ‹ğˆğğˆğ‚ğ’",
      "MetaForestPlot"
    ]
  },
  {
    "objectID": "Clinics/MetaForestPlot.html#application",
    "href": "Clinics/MetaForestPlot.html#application",
    "title": "Meta-Analysis Forest Plot",
    "section": "Application",
    "text": "Application\n\n1. Visualization of Meta-analysis Results\n\n\n\n\n\n\nFigureÂ 4: Applications of Meta-Analysis Forest Plot 1\n\n\n\nA forest plot, by definition, is generally a rectangular coordinate system with an invalid line perpendicular to the X-axis (usually coordinate X = 1 or 0) as the center. It uses several line segments parallel to the X-axis to represent the effect size of each study and its 95% confidence interval, and uses a diamond to represent the combined effect size and confidence interval of multiple studies. It is the most commonly used comprehensive expression form of results in meta-analysis.\n\n\n2. Results of multivariate regression analysis\n\n\n\n\n\n\nFigureÂ 5: Applications of Meta-Analysis Forest Plot 2\n\n\n\nThe forest plot is a very flexible visualization tool that can be used not only to display the results of meta-analysis, but also to display the results of univariate or multivariate regression analysis.\n\n\n3. Visualization of Gene Association Studies\n\n\n\n\n\n\nFigureÂ 6: Applications of Meta-Analysis Forest Plot 3\n\n\n\nForest map made by the TwoSampleMR package.",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> ğ‚ğ‹ğˆğğˆğ‚ğ’",
      "MetaForestPlot"
    ]
  },
  {
    "objectID": "Clinics/MetaForestPlot.html#reference",
    "href": "Clinics/MetaForestPlot.html#reference",
    "title": "Meta-Analysis Forest Plot",
    "section": "Reference",
    "text": "Reference\n[1] Lewis, S., & Clarke, M. (2001). Forest Plots: Trying to See the Wood and the Trees. BMJ, 322(7300), 1479â€“1480.DOI: 10.1136/bmj.322.7300.1479.\n[2] Higgins, J. P. T., Thomas, J., Chandler, J., et al.Â (2022). Cochrane Handbook for Systematic Reviews of Interventions (Version 6.3).\n[3] Gordon, M., & Lumley, T. (2023). forestplot: Advanced Forest Plot Using â€˜gridâ€™ Graphics (R package version 3.1.1).\n[4] Moher, D., Hopewell, S., Schulz, K. F., et al.Â (2010). CONSORT 2010 Statement: Updated Guidelines for Reporting Parallel Group Randomized Trials. Annals of Internal Medicine, 152(11), 726â€“732.DOI: 10.7326/0003-4819-152-11-201006010-00232.\n[5] Murrell, P. (2018). R Graphics (3rd ed.). Chapman & Hall/CRC.ISBN: 978-1439888417",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> ğ‚ğ‹ğˆğğˆğ‚ğ’",
      "MetaForestPlot"
    ]
  },
  {
    "objectID": "Clinics/MosaicPlot.html",
    "href": "Clinics/MosaicPlot.html",
    "title": "Mosaic Plot",
    "section": "",
    "text": "A mosaic plot shows the relationship between a pair of variables in categorical data. It works similarly to a two-way 100% stacked bar chart, but all bars have equal length on the value/scale axis and are divided into segments. You can use these two variables to examine the relationship between a category and its subcategories.",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> ğ‚ğ‹ğˆğğˆğ‚ğ’",
      "MosaicPlot"
    ]
  },
  {
    "objectID": "Clinics/MosaicPlot.html#example",
    "href": "Clinics/MosaicPlot.html#example",
    "title": "Mosaic Plot",
    "section": "",
    "text": "A mosaic plot shows the relationship between a pair of variables in categorical data. It works similarly to a two-way 100% stacked bar chart, but all bars have equal length on the value/scale axis and are divided into segments. You can use these two variables to examine the relationship between a category and its subcategories.",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> ğ‚ğ‹ğˆğğˆğ‚ğ’",
      "MosaicPlot"
    ]
  },
  {
    "objectID": "Clinics/MosaicPlot.html#setup",
    "href": "Clinics/MosaicPlot.html#setup",
    "title": "Mosaic Plot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: ggplot2, reshape2, plyr, dplyr, vcd, graphics, wesanderson\n\n\n# Install packages\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"reshape2\", quietly = TRUE)) {\n  install.packages(\"reshape2\")\n}\nif (!requireNamespace(\"plyr\", quietly = TRUE)) {\n  install.packages(\"plyr\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\nif (!requireNamespace(\"tidyr\", quietly = TRUE)) {\n  install.packages(\"tidyr\")\n}\nif (!requireNamespace(\"vcd\", quietly = TRUE)) {\n  install.packages(\"vcd\")\n}\nif (!requireNamespace(\"graphics\", quietly = TRUE)) {\n  install.packages(\"graphics\")\n}\nif (!requireNamespace(\"wesanderson\", quietly = TRUE)) {\n  install.packages(\"wesanderson\")\n}\n\n# Load packages\nlibrary(ggplot2)\nlibrary(reshape2)\nlibrary(plyr)\nlibrary(dplyr)\nlibrary(vcd)\nlibrary(graphics)\nlibrary(wesanderson)",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> ğ‚ğ‹ğˆğğˆğ‚ğ’",
      "MosaicPlot"
    ]
  },
  {
    "objectID": "Clinics/MosaicPlot.html#data-preparation",
    "href": "Clinics/MosaicPlot.html#data-preparation",
    "title": "Mosaic Plot",
    "section": "Data Preparation",
    "text": "Data Preparation\n\n# Generate simulated data\ndf &lt;- data.frame(segment = c(\"Patient1\", \"Patient2\", \"Patient3\",\"Patient4\"),\n                 \"Macrophage\" = c(2400  ,1200,  600 ,250),\n                 \"Epithelial\" = c(1000  ,900,   600,    250),\n                 \"T cells\" = c(400, 600 ,400,   250),\n                 \"B cells\" = c(200, 300 ,400,   250))\n\nmelt_df&lt;-melt(df,id=\"segment\")\n# Convert numbers to percentages\nsegpct&lt;-rowSums(df[,2:ncol(df)])\nfor (i in 1:nrow(df)){\n  for (j in 2:ncol(df)){\n    df[i,j]&lt;-df[i,j]/segpct[i]*100  \n  }\n}\n\nsegpct&lt;-segpct/sum(segpct)*100\ndf$xmax &lt;- cumsum(segpct)\ndf$xmin &lt;- (df$xmax - segpct)\n\ndfm &lt;- melt(df, id = c(\"segment\", \"xmin\", \"xmax\"),value.name=\"percentage\")\ncolnames(dfm)[ncol(dfm)]&lt;-\"percentage\"\n\n# The ddply() function uses a custom statistical function to group and calculate data.frame\ndfm1 &lt;- ddply(dfm, .(segment), transform, ymax = cumsum(percentage))\ndfm1 &lt;- ddply(dfm1, .(segment), transform,ymin = ymax - percentage)\ndfm1$xtext &lt;- with(dfm1, xmin + (xmax - xmin)/2)\ndfm1$ytext &lt;- with(dfm1, ymin + (ymax - ymin)/2)\n\n# join() function, connects two tables data.frame\ndfm2&lt;-join(melt_df, dfm1, by = c(\"segment\", \"variable\"), type = \"left\", match = \"all\")\n\n# View the final merged dataset\nhead(dfm2)\n\n   segment   variable value xmin xmax percentage ymax ymin xtext ytext\n1 Patient1 Macrophage  2400    0   40         60   60    0    20  30.0\n2 Patient2 Macrophage  1200   40   70         40   40    0    55  20.0\n3 Patient3 Macrophage   600   70   90         30   30    0    80  15.0\n4 Patient4 Macrophage   250   90  100         25   25    0    95  12.5\n5 Patient1 Epithelial  1000    0   40         25   85   60    20  72.5\n6 Patient2 Epithelial   900   40   70         30   70   40    55  55.0",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> ğ‚ğ‹ğˆğğˆğ‚ğ’",
      "MosaicPlot"
    ]
  },
  {
    "objectID": "Clinics/MosaicPlot.html#visualization",
    "href": "Clinics/MosaicPlot.html#visualization",
    "title": "Mosaic Plot",
    "section": "Visualization",
    "text": "Visualization\n\n1. Basic Plot\nUse basic functions to draw the caption and description of the image.\n\n# Basic Plot\np &lt;- ggplot() +\n  geom_rect(aes(ymin = ymin, ymax = ymax, xmin = xmin, xmax = xmax, fill = variable),dfm2,colour = \"black\") +\n  geom_text(aes(x = xtext, y = ytext,  label = value),dfm2 ,size = 4)+\n  geom_text(aes(x = xtext, y = 103, label = paste(segment)),dfm2 ,size = 4)+\n  geom_text(aes(x = 102, y = seq(12.5,100,25), label = c(\"Macrophage\",\"Epithelial\",\"T cells\",\"B cells\")), size = 4,hjust = 0)+\n  scale_x_continuous(breaks=seq(0,100,25),limits=c(0,110))+\n  theme(panel.background=element_rect(fill=\"white\",colour=NA),\n        panel.grid.major = element_line(colour = \"grey60\",size=.25,linetype =\"dotted\" ),\n        panel.grid.minor = element_line(colour = \"grey60\",size=.25,linetype =\"dotted\" ),\n        text=element_text(size=15),\n        legend.position=\"none\")\n\np\n\n\n\n\n\n\n\nFigureÂ 1: Basic Plot\n\n\n\n\n\n\n# Further beautification\n# Data reprocessing\ndfm1 &lt;- ddply(dfm, .(segment), transform, ymax = cumsum(percentage))\ndfm1 &lt;- ddply(dfm1, .(segment), transform, ymin = ymax - percentage)\n\n# Create Interval\nspacing &lt;- 1\ndfm1$ymin &lt;- dfm1$ymin + spacing * (as.numeric(factor(dfm1$variable)) - 1)\ndfm1$ymax &lt;- dfm1$ymax + spacing * (as.numeric(factor(dfm1$variable)) - 1)\n\n# Calculate text display position\ndfm1$xtext &lt;- with(dfm1, xmin + (xmax - xmin) / 2)\ndfm1$ytext &lt;- with(dfm1, ymin + (ymax - ymin) / 2)\n\n# Joining Data Frames\ndfm2 &lt;- join(melt_df, dfm1, by = c(\"segment\", \"variable\"), type = \"left\", match = \"all\")\n\np2 &lt;- ggplot() +\n  geom_rect(aes(ymin = ymin, ymax = ymax, \n                xmin = xmin + 5 * (as.numeric(factor(segment)) - 1),\n                xmax = xmax + 5 * (as.numeric(factor(segment)) - 1), \n                fill = variable),\n            dfm2, colour = \"black\") +\n  geom_text(aes(x = xtext + 5 * (as.numeric(factor(segment)) - 1),\n                y = ytext, label = value),\n            dfm2, size = 4) +\n  geom_text(aes(x = xtext + 5 * (as.numeric(factor(segment)) - 1),\n                y = max(dfm1$ymax) + spacing * 2,\n                label = paste(segment)),\n            dfm2, size = 4) +\n  geom_text(aes(x = 116, y = seq(12.5, 100, 25) + spacing * 0.5, \n                label = c(\"Macrophage\", \"Epithelial\", \"T cells\", \"B cells\")), \n            size = 4, hjust = 0) +\n  scale_x_continuous(breaks = NULL, limits = c(0, 110 + 5 * 3), expand = c(0, 0)) +  # Remove the horizontal axis\n  scale_y_continuous(breaks = NULL, limits = c(0, max(dfm1$ymax) + spacing * 3), expand = c(0, 0)) +  # Remove the vertical coordinate\n  theme(panel.background = element_rect(fill = \"white\", colour = NA),\n        panel.grid.major = element_blank(),  # Remove the grid\n        panel.grid.minor = element_blank(),\n        text = element_text(size = 15),\n        legend.position = \"none\",\n        axis.title.x = element_blank(),  # Remove the x-axis title\n        axis.title.y = element_blank(),  # Remove the y-axis title\n        axis.ticks = element_blank())  # Remove axis scale\n\np2\n\n\n\n\n\n\n\nFigureÂ 2: Further beautification\n\n\n\n\n\n\n\n2. Advanced Plot\n\n2.1 vcd package\n\n# Create a table\ntable &lt;- xtabs(value ~variable+segment, melt_df)\n\n# plot\np3 &lt;- mosaic(~segment+variable,table,shade=TRUE,legend=TRUE,color=TRUE)\n\n\n\n\n\n\n\nFigureÂ 3: vcd package\n\n\n\n\n\n\n\n2.2 graphics package\n\np4 &lt;- mosaicplot( ~segment+variable,table, color = wes_palette(\"FrenchDispatch\"),main = '')\n\n\n\n\n\n\n\nFigureÂ 4: graphics package",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> ğ‚ğ‹ğˆğğˆğ‚ğ’",
      "MosaicPlot"
    ]
  },
  {
    "objectID": "Clinics/MosaicPlot.html#application",
    "href": "Clinics/MosaicPlot.html#application",
    "title": "Mosaic Plot",
    "section": "Application",
    "text": "Application\n\n\n\n\n\n\nFigureÂ 5: Application of Mosaic Plot\n\n\n\nThis mosaic plot shows the association of specific clusters with specific tumor metastasis sites. [1]",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> ğ‚ğ‹ğˆğğˆğ‚ğ’",
      "MosaicPlot"
    ]
  },
  {
    "objectID": "Clinics/MosaicPlot.html#reference",
    "href": "Clinics/MosaicPlot.html#reference",
    "title": "Mosaic Plot",
    "section": "Reference",
    "text": "Reference\n[1] Lee H, Na KJ, Choi H. Differences in Tumor Immune Microenvironment in Metastatic Sites of Breast Cancer. Front Oncol. 2021;11:649004. Published 2021 Mar 18. doi:10.3389/fonc.2021.649004.\n[2] Friendly, M. (2002). â€œA Brief History of the Mosaic Display.â€ Journal of Computational and Graphical Statistics, 11(1), 89-107.\n[3] Meyer, D., et al.Â (2006). â€œThe Strucplot Framework: Visualizing Multi-Way Contingency Tables with vcd.â€ Journal of Statistical Software, 17(3), 1-48.\n[4] Gehlenborg, N. (2014). â€œUpSetR: An Alternative to Mosaic Plots for Visualizing Intersecting Sets.â€ Nature Methods, 11(8), 769-770.\n[5] Nowicka, M., et al.Â (2017). â€œCyTOF Workflow: Differential Discovery in High-Throughput High-Dimensional Cytometry Datasets.â€ F1000Research, 6, 748.\n[6] Wilke, C.O. (2020). â€œFundamentals of Data Visualization in Biomedicine.â€ Springer.\n[7] R Core Team (2023). â€œR: A Language and Environment for Statistical Computing.â€\n[8] Slowikowski, K. (2021). â€œggrepel: Automatically Position Non-Overlapping Text Labels in ggplot2.â€ Bioinformatics, 37(9), 1333-1334.",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> ğ‚ğ‹ğˆğğˆğ‚ğ’",
      "MosaicPlot"
    ]
  },
  {
    "objectID": "Clinics/LollipopPlot.html",
    "href": "Clinics/LollipopPlot.html",
    "title": "Lollipop Plot",
    "section": "",
    "text": "(Image by Amy Shamblen on Unsplash)\nTired of the same old bar charts? If you donâ€™t have cavities, why not turn your bar chart into a stick chart while eating a lollipop?",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> ğ‚ğ‹ğˆğğˆğ‚ğ’",
      "LollipopPlot"
    ]
  },
  {
    "objectID": "Clinics/LollipopPlot.html#example",
    "href": "Clinics/LollipopPlot.html#example",
    "title": "Lollipop Plot",
    "section": "",
    "text": "(Image by Amy Shamblen on Unsplash)\nTired of the same old bar charts? If you donâ€™t have cavities, why not turn your bar chart into a stick chart while eating a lollipop?",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> ğ‚ğ‹ğˆğğˆğ‚ğ’",
      "LollipopPlot"
    ]
  },
  {
    "objectID": "Clinics/LollipopPlot.html#setup",
    "href": "Clinics/LollipopPlot.html#setup",
    "title": "Lollipop Plot",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming language: R\nDependent packages: ggplot2, ggpubr, patchwork, dplyr\n\n\n# Installing packages\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"ggpubr\", quietly = TRUE)) {\n  install.packages(\"ggpubr\")\n}\nif (!requireNamespace(\"patchwork\", quietly = TRUE)) {\n  install.packages(\"patchwork\")\n}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) {\n  install.packages(\"dplyr\")\n}\n\n# Load packages\nlibrary(ggplot2)\nlibrary(ggpubr)\nlibrary(patchwork)\nlibrary(dplyr)",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> ğ‚ğ‹ğˆğğˆğ‚ğ’",
      "LollipopPlot"
    ]
  },
  {
    "objectID": "Clinics/LollipopPlot.html#data-preparation",
    "href": "Clinics/LollipopPlot.html#data-preparation",
    "title": "Lollipop Plot",
    "section": "Data Preparation",
    "text": "Data Preparation\nThe data are from the article by Yang et al.Â [1-2]\n\n# Loading data\ndata &lt;- read.csv('https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/lollipop_1.csv', row.names = 1) # Correlation analysis data reading\n# View the dataset\nhead(data)\n\n                cell  pvalue  cor\n1       Plasma cells 3.6e-08 0.43\n2        Eosinophils 1.1e-06 0.38\n3      B cells naive 5.8e-05 0.32\n4     Macrophages M0 9.4e-04 0.26\n5 NK cells activated 2.2e-03 0.24\n6        T cells CD8 1.3e-02 0.20\n\n\n\n# Loading data\ndata_2 &lt;- read.csv('https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/lollipop_2.csv') # Gene enrichment analysis data readout\n# View the dataset\nhead(data_2)\n\n  GO.category                  GO.Process.description..term. GO.Term.ID\n1       GO:MF                                 enzyme binding GO:0019899\n2       GO:MF                                protein binding GO:0005515\n3       GO:MF     guanyl-nucleotide exchange factor activity GO:0005085\n4       GO:MF Ras guanyl-nucleotide exchange factor activity GO:0005088\n5       GO:MF                                 GTPase binding GO:0051020\n6       GO:MF Rho guanyl-nucleotide exchange factor activity GO:0005089\n     p.value Number.of.all.known.genes.enriched.to.the.GO.term\n1 2.2252e-09                                             1,518\n2 1.7950e-08                                             6,853\n3 4.1462e-07                                               187\n4 6.2395e-07                                               118\n5 1.2078e-05                                               424\n6 1.2377e-05                                                76\n  DEGs.with.GO.annotation Number.of.DEGs.enriched.to.the.particular.GO.term\n1                     313                                                71\n2                     313                                               194\n3                     313                                                20\n4                     313                                                16\n5                     313                                                28\n6                     313                                                12\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Gene.names.engaged.in.particular.GO.term\n1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ADCY6,ALS2,ARHGAP33,ARHGAP44,ARHGEF11,ARHGEF17,ARHGEF19,ARHGEF39,ARRDC1,AXIN2,BRD4,CAVIN3,CCNF,CLEC16A,COL1A1,CUL9,DBF4B,DENND6B,DIAPH1,DIO2,DLG4,DOCK6,DPP4,EGFR,FARP2,FURIN,GAS8,GBF1,HDAC6,HDAC7,HERC2,HTT,ISG15,KANSL1,KNDC1,KSR1,MAST2,MID1,MLPH,NCOR2,NOTCH1,OBSCN,PLEKHG2,PLEKHG3,PLK1,PPP6R2,PSD2,PTPN23,RAB11FIP3,RAPGEF1,RAPGEFL1,RBBP6,RHOF,RNF40,RPTOR,SBF1,SCAF1,SGSM1,SGSM2,SH2B1,SIK1,SKI,SLC9A1,SPATA13,SRCIN1,STRN4,TP73,TRAF3,TRIO,TSPAN5,VAV2\n2 ADCY6,AKAP17A,ALOX15,ALS2,ANKRD11,ARHGAP17,ARHGAP33,ARHGAP39,ARHGAP44,ARHGEF11,ARHGEF17,ARHGEF19,ARHGEF39,ARNT2,ARRDC1,ATXN1L,AXIN2,BCL9L,BRD3,BRD4,BTBD19,BTNL9,C12H17ORF100,C1QA,C1QTNF6,CACNA1G,CAMSAP1,CASKIN1,CAVIN3,CCNF,CD59,CD79A,CDH24,CENPT,CEP131,CEP164,CEP170B,CHD2,CHD7,CHERP,CLEC16A,COL1A1,COL5A1,CREBBP,CRSP3,CRTC1,CSRP1,CUL9,DBF4B,DENND4B,DENND6B,DGKD,DIAPH1,DIO2,DLG4,DLL1,DNAH1,DOCK6,DPP4,DYNC1H1,E2F1,E2F7,EFS,EGFR,EHBP1L1,EHMT1,ELMSAN1,ENSSSCG00000035856,EP300,FARP2,FBXL18,FURIN,FXYD1,GAS7,GAS8,GBF1,GIGYF1,GIPC3,HDAC6,HDAC7,HERC2,HTT,IGSF9,INPPL1,ISG15,KANSL1,KCNQ4,KCP,KCTD7,KIF12,KIF18B,KIF1A,KIF1C,KIF21B,KIF26A,KIF7,KMT2B,KNDC1,KSR1,LARP1,LDB3,LRP5,LZTS1,MAST2,MED12,MEGF8,MID1,MLPH,MMRN1,MNT,MRAP2,MYH14,MYH3,MYH7B,MYH9,NAV2,NCOR2,NECTIN1,NOTCH1,NSD2,NUMA1,OBSCN,PAX2,PER3,PIK3R2,PLCG1,PLEKHA6,PLEKHG2,PLEKHG3,PLK1,PLXNA1,PLXNA3,PLXNB3,PPP6R2,PRDM15,PSD2,PTPN23,PTPRF,RAB11FIP3,RAPGEF1,RAPGEFL1,RBBP6,RERE,RGS2,RHOF,RNF123,RNF40,RPTOR,RSPO3,S100A9,SALL1,SARM1,SART3,SBF1,SCAF1,SEMA4C,SEMA4F,SETD5,SGSM1,SGSM2,SH2B1,SH3PXD2B,SIK1,SKI,SLC9A1,SPATA13,SPTAN1,SRCIN1,STRN4,SYNE2,SYT3,TCAP,TENM2,TLE2,TMEFF2,TONSL,TP73,TRAF3,TRANK1,TRAPPC12,TRIM66,TRIO,TRRAP,TSPAN5,TSPO,TYK2,UBR4,UNC5B,USP20,VAV2,VEGFA,WDFY3,WDR62,ZMYND8\n3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ALS2,ARHGEF11,ARHGEF17,ARHGEF19,ARHGEF39,DENND6B,DOCK6,FARP2,GBF1,KNDC1,OBSCN,PLEKHG2,PLEKHG3,PSD2,RAPGEF1,RAPGEFL1,SBF1,SPATA13,TRIO,VAV2\n4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ALS2,ARHGEF11,ARHGEF17,ARHGEF19,ARHGEF39,DENND6B,FARP2,KNDC1,OBSCN,PLEKHG2,PLEKHG3,RAPGEF1,SBF1,SPATA13,TRIO,VAV2\n5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ALS2,ARHGAP44,ARHGEF11,ARHGEF17,ARHGEF19,ARHGEF39,CLEC16A,DENND6B,DIAPH1,DOCK6,FARP2,GAS8,GBF1,KNDC1,MLPH,OBSCN,PLEKHG2,PLEKHG3,PSD2,RAB11FIP3,RAPGEF1,RAPGEFL1,SBF1,SGSM1,SGSM2,SPATA13,TRIO,VAV2\n6                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ALS2,ARHGEF11,ARHGEF17,ARHGEF19,ARHGEF39,FARP2,OBSCN,PLEKHG2,PLEKHG3,SPATA13,TRIO,VAV2",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> ğ‚ğ‹ğˆğğˆğ‚ğ’",
      "LollipopPlot"
    ]
  },
  {
    "objectID": "Clinics/LollipopPlot.html#visualization",
    "href": "Clinics/LollipopPlot.html#visualization",
    "title": "Lollipop Plot",
    "section": "Visualization",
    "text": "Visualization\n\n1. Basic Plot\nBasic stick figure showing the results of the correlation between COL17A1 gene and immune infiltration. [1]\n\n# Basic Lollipop Plot\n# Convert correlation coefficients and p-values to categorical variables\ndata$pvalue_group &lt;- cut(data$pvalue,\n                         breaks = c(0, 0.2, 0.4, 0.6,0.8, 1),\n                         labels = c(\"&lt; 0.2\",\"&lt; 0.4\",\"&lt; 0.6\",\"&lt; 0.8\",\"&lt;1\"),\n                         right=FALSE)# right=FALSEè¡¨ç¤ºè¡¨ç¤ºåŒºé—´ä¸ºå·¦é—­å³å¼€\ndata$cor_group_size &lt;- cut(abs(data$cor),# ç»å¯¹å€¼\n                      breaks = c(0, 0.1, 0.2, 0.3, 0.4, 0.5),\n                      labels = c(\"0.1\",\"0.2\",\"0.3\",\"0.4\",\"0.5\"),\n                      right=FALSE) \n# Order\ndata = data[order(data$cor),]\ndata$cell = factor(data$cell, levels = data$cell)\n\np = ggplot(data, \n           aes(x = cor, y = cell, color = pvalue_group)) +\n  scale_color_manual(name=\"pvalue\",\n                     values = c(\"#146432\", \n                                \"#4DB748\", \n                                #\"#FAA519\", # Since there is no data in this interval, comment it out.\n                                \"#FABECD\" #,\n                                #\"#FAD700\" #Since there is no data in this interval, comment it out.\n                                ))+ # Color selection of candies in lollipops\n  geom_segment(aes(x = 0, y = cell, xend = cor, yend = cell),\n               color = 'black', # Drawing of the stick in a lollipop\n               linewidth = 0.5) +\n  geom_point(aes(size = cor_group_size))+ # Drawing of candy in lollipop\n  labs(title = \"COL17A1\", # Image title\n       size = \"abs(cor)\") + # legend name\n  guides(color = \"none\")+ # Hide redundant legends\n  theme_bw()+ \n  theme(plot.title=element_text(size=8,  # title size\n                                hjust=0.5 ), # title position\n        legend.position = \"bottom\", # legend position\n        text = element_text(family = \"serif\"), # Set the font to Times New Roman\n        panel.grid = element_line(linetype = \"dotted\",color='grey')) \np\n\n\n\n\n\n\n\nFigureÂ 1: Basic Lollipop Plot\n\n\n\n\n\nNote: The figure title is the gene name, the vertical axis is the lineage number, the horizontal axis is the gene expression level, and cor is the correlation between gene expression and cell abundance. The horizontal axis represents the correlation, the magnitude represents the absolute value of the correlation, and the color represents the P value.\nTo make the lollipop chart more informative, we can add information to the right side of the chart. We already sorted the chart by p-value in the previous step. In this step, we can add text about the p-value to make the chart more readable.\n\ndata$pvalue_col &lt;- cut(data$pvalue,\n                       breaks = c(0, 0.05,1),\n                       labels = c(\"&lt; 0.05\",\"&gt; 0.05\"),\n                       right=FALSE) # Add color classification information to data\ndata$pvalue_text &lt;- ifelse(data$pvalue&gt;0.05,sprintf(\"%.3f\", data$pvalue),'&lt;0.001') # Add the text you want to draw in data\np1 = ggplot()+\n  geom_text(data,mapping = aes(x = 0, y = cell, color = pvalue_col, \n                               label = pvalue_text))+\n  scale_color_manual(name=\"\",values = c(\"red\", \"black\"))+\n  theme_void()+\n  theme(text = element_text(family = \"serif\"))+\n  guides(color=F) # remove legend\n\np|p1\n\n\n\n\n\n\n\nFigureÂ 2: Add text message\n\n\n\n\n\nNote: The title of the figure is the gene name, the vertical axis is the lineage number, the horizontal axis is the expression level of the gene, cor is the correlation between gene expression and cell abundance, where the horizontal axis is the correlation, the size is the absolute value of the correlation, the color is the P value, and the number on the right is the P value.\n\n\n2. Add legend\n\nstack_data = data.frame( x = c(\"legend\",\"legend\",\"legend\",\"legend\",\"legend\"),\n                         class = c(\"0-0.2\", \"0.2-0.4\", \"0.4-0.6\", \"0.6-0.8\",  \"0.8-1\"),\n                         color_range = c(0.2,0.2,0.2,0.2,0.2))\n\np2 &lt;- ggplot(stack_data, aes(x = x, y = color_range, fill = class)) +\n  geom_bar(stat = 'identity', position = \"stack\", width = 0.3) +\n  scale_fill_manual(name = \"P-value\",values = c(\"#146432\", \"#4DB748\", \"#FAA519\", \"#FABECD\", \"#FAD700\")) +  # Set Color\n  scale_y_continuous(breaks = seq(0, 1, by = 0.2), \n                     labels = c(\"0\",\"0.2\",\"0.4\",\"0.5\",\"0.8\",\"1.0\" ), \n                     sec.axis = sec_axis(~., breaks = seq(0, 1, by = 0.2), \n                                         labels = c(\"0\", \"0.2\", \"0.4\", \"0.6\", \"0.8\", \"1.0\"))) +  # Set the y-axis scale and move the y-axis to the right\n  labs(title = \"pvalue\")+ # Image title\n  theme_minimal() +\n  theme(axis.text.x = element_blank(),  \n        axis.title.x = element_blank(),  \n        axis.text.y = element_blank(), \n        axis.title.y = element_blank(),  \n        panel.grid = element_blank(),    \n        plot.margin = unit(c(0, 0, 0, 0), \"cm\"),  \n        axis.text.y.right = element_text(size = 12),  \n        legend.position = \"none\", \n        plot.title=element_text(size=10, \n                                hjust=0.5 ), \n        text = element_text(family = \"serif\"))\n\np|p1|p2\n\n\n\n\n\n\n\nFigureÂ 3: Add legend\n\n\n\n\n\nNote: The title of the figure is the gene name, the vertical axis is the lineage number, the horizontal axis is the expression level of the gene, cor is the correlation between gene expression and cell abundance, where the horizontal axis is the correlation, the size is the absolute value of the correlation, the color is the P value, and the number on the right is the P value.\n\n\n3. Beautify Plot\n\nlayout &lt;- c(\n  area(t = 1, l = 1, b = 1, r = 2),\n  area(t = 1, l = 3, b = 1, r = 3),\n  area(t = 1, l = 4, b = 1, r = 4)\n)\n\np + p1 + p2 +\n  plot_layout(design = layout)\n\n\n\n\n\n\n\nFigureÂ 4: Beautify Plot\n\n\n\n\n\nIf necessary, you can further beautify it using Power point or Adobe illustration.\n\n\n4. Enrichment analysis plots\n\n# Enrichment analysis lollipop plot\ndata_2 &lt;- data_2[,c(1,2,4,7)] # Only leave the information needed for drawing\ncolnames(data_2) &lt;- c(\"GO_aspect\",\"GO_term\",\"P\",\"count\") # Rename column names\ndata_2 &lt;- data_2[data_2$GO_aspect!='KEGG',] # Remove the data of KEGG enrichment analysis\n\ndata_2$Padj &lt;- p.adjust(data_2$P, method = \"BH\") # Calculate Padj using the Benjamin-Hochberg method\ndata_2$log10Padj = -log10(data_2$Padj) # Calculate -log10Padj\n\ndata_2$GO_aspect[data_2$GO_aspect==\"GO:BP\"] =\"BP\"\ndata_2$GO_aspect[data_2$GO_aspect==\"GO:CC\"] =\"CC\"\ndata_2$GO_aspect[data_2$GO_aspect==\"GO:MF\"] =\"MF\"\n\n# Group by GO_aspect, then sort each group by log10Padj and take the first 15 data\ndata_2 &lt;- data_2 %&gt;%  group_by(GO_aspect) %&gt;%\n  arrange(GO_aspect, desc(log10Padj)) %&gt;%  # Sort by log10Padj in descending order\n  slice_head(n = 15)  # Take the first 15\n\n\n# Plot\nggdotchart(data_2, x = \"GO_term\", y = \"log10Padj\",\n           color = \"GO_aspect\",                          # Display colors by group\n           palette = c(\"#090886\", \"#F90708\", \"#25821F\"), # Custom color palette\n           sorting = \"descending\",                       # Sort values in descending order\n           add = \"segments\",                             # Add a line segment from y=0 to the point\n           group = \"GO_aspect\",                          # Sort by group\n           dot.size = 8,                                 # Dot size\n           label = round(data_2$count),                  # Add mpg values as point labels\n           font.label = list(color = \"white\", size = 9, \n                             vjust = 0.5),               # Adjust label parameters\n           ggtheme = theme_pubr()                        # ggplot2 theme\n)+labs(x=NULL,y=expression(-log[10](Padj)),\n        title=NULL)\n\n\n\n\n\n\n\nFigureÂ 5: Enrichment analysis lollipop plot\n\n\n\n\n\nNote: The vertical axis is -log10Padj, the horizontal axis is GO terms, the color is GO category, and the numbers in the circles are the number of genes enriched in each GO term.",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> ğ‚ğ‹ğˆğğˆğ‚ğ’",
      "LollipopPlot"
    ]
  },
  {
    "objectID": "Clinics/LollipopPlot.html#application",
    "href": "Clinics/LollipopPlot.html#application",
    "title": "Lollipop Plot",
    "section": "Application",
    "text": "Application\n\n1. Correlation analysis\n\n\n\n\n\n\nFigureÂ 6: Correlation analysis\n\n\n\nThe application of the lollipop plot (Figure 9A in the original text) shows the results of the correlation between the COL17A1 gene and immune infiltration.[1]\n\n\n2. Gene pathway enrichment analysis\n\n\n\n\n\n\nFigureÂ 7: Gene pathway enrichment analysis\n\n\n\nThe application of the lollipop plot (Figure 3 in the original text) shows the results of GO enrichment analysis of differentially expressed genes. [2]",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> ğ‚ğ‹ğˆğğˆğ‚ğ’",
      "LollipopPlot"
    ]
  },
  {
    "objectID": "Clinics/LollipopPlot.html#reference",
    "href": "Clinics/LollipopPlot.html#reference",
    "title": "Lollipop Plot",
    "section": "Reference",
    "text": "Reference\n[1] Yang, M. Y., Ji, M. H., Shen, T., & Lei, L. (2022). Integrated Analysis Identifies Four Genes as Novel Diagnostic Biomarkers Which Correlate with Immune Infiltration in Preeclampsia. Journal of immunology research, 2022, 2373694. https://doi.org/10.1155/2022/2373694\n[2] Paukszto, L., Mikolajczyk, A., Jastrzebski, J. P., Majewska, M., Dobrzyn, K., Kiezun, M., Smolinska, N., & Kaminski, T. (2020). Transcriptome, Spliceosome and Editome Expression Patterns of the Porcine Endometrium in Response to a Single Subclinical Dose of Salmonella Enteritidis Lipopolysaccharide. International journal of molecular sciences, 21(12), 4217. https://doi.org/10.3390/ijms21124217",
    "crumbs": [
      "<i class='fa-solid fa-virus-covid'></i> ğ‚ğ‹ğˆğğˆğ‚ğ’",
      "LollipopPlot"
    ]
  },
  {
    "objectID": "Template/visualization_guidance_EN.html",
    "href": "Template/visualization_guidance_EN.html",
    "title": "Contribution_guidance",
    "section": "",
    "text": "Example guide for a visualization tutorial"
  },
  {
    "objectID": "Template/visualization_guidance_EN.html#example",
    "href": "Template/visualization_guidance_EN.html#example",
    "title": "Contribution_guidance",
    "section": "Example",
    "text": "Example\nã€Figure. Example Plotã€‘\nShow the title/diagram notes for the above example diagrams and interpret the meaning of the example diagram xy axes or other identifiers."
  },
  {
    "objectID": "Template/visualization_guidance_EN.html#setup",
    "href": "Template/visualization_guidance_EN.html#setup",
    "title": "Contribution_guidance",
    "section": "Setup",
    "text": "Setup\n\nSystem Requirements: Cross-platform (Linux/MacOS/Windows)\nProgramming Language: R\nDependencies: (Populate R packages or other resources that the visualization tutorial depends on)\n\n\n#Example Code-----\n# Installing necessary packages\nif (!requireNamespace(\"readr\", quietly = TRUE)) {\n  install.packages(\"readr\")\n}\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n}\nif (!requireNamespace(\"tidyverse\", quietly = TRUE)) {\n  install.packages(\"tidyverse\")\n}\n\n# Loading the libraries\nlibrary(readr) \nlibrary(ggplot2) \nlibrary(tidyverse)"
  },
  {
    "objectID": "Template/visualization_guidance_EN.html#data-preparation",
    "href": "Template/visualization_guidance_EN.html#data-preparation",
    "title": "Contribution_guidance",
    "section": "Data Preparation",
    "text": "Data Preparation\n\nR built-in datasets (e.g.Â iris, penguins) and biomedical related datasets (e.g.Â histology data, survival information, clinical indicators, etc.) need to be included.\nBiomedical related datasets need to be uploaded to the Bizard Tencent Cloud in order to get a link to the insertion tutorial, data from public datasets is best, and if provided by an individual/organization needs to ensure that the data can be made public. The size of the dataset should be less than 1MB.\n\n\n# Data reading and processing codes can be freely chosen to be displayed or not------\n# Read the TSV data\ndata &lt;- readr::read_tsv(\"https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/TCGA-LIHC.htseq_counts.tsv.gz\")\n\n# Filter and reshape data for the first gene TSPAN6 (Ensembl ID: ENSG00000000003.13)\ndata1 &lt;- data %&gt;%\n  filter(Ensembl_ID == \"ENSG00000000003.13\") %&gt;%\n  pivot_longer(\n    cols = -Ensembl_ID, \n    names_to = \"sample\", \n    values_to = \"expression\"\n  ) %&gt;%\n  mutate(var = \"var1\")  # Add a column to differentiate the variables\n\n# Filter and reshape data for the second gene SCYL3 (Ensembl ID: ENSG00000000457.12)\ndata2 &lt;- data %&gt;%\n  filter(Ensembl_ID == \"ENSG00000000457.12\") %&gt;%\n  pivot_longer(\n    cols = -Ensembl_ID, \n    names_to = \"sample\", \n    values_to = \"expression\"\n  ) %&gt;%\n  mutate(var = \"var2\")  # Add a column to differentiate the variables\n\n# Combine the two datasets\ndata12 &lt;- bind_rows(data1, data2)\n\n# View the final combined dataset\nhead(data12)\n\n# A tibble: 0 Ã— 4\n# â„¹ 4 variables: Ensembl_ID &lt;chr&gt;, sample &lt;chr&gt;, expression &lt;chr&gt;, var &lt;chr&gt;"
  },
  {
    "objectID": "Template/visualization_guidance_EN.html#visualization",
    "href": "Template/visualization_guidance_EN.html#visualization",
    "title": "Contribution_guidance",
    "section": "Visualization",
    "text": "Visualization\n\n1. Basic Plot\nUse the base functions to draw graphical annotations and profiles of images. e.g.@fig-BasicHist illustrates the distribution of expression levels for the TSPAN6 gene across different samples.\n\n# Basic Drawing Code Example-----\n#| label: fig-BasicHist\n#| fig-cap: \"Basic Histogram\"\n#| out.width: \"95%\"\n#| warning: false\n\n# Basic Histogram\np1 &lt;- ggplot(data1, aes(x = expression)) +\n  geom_histogram() + \n  labs(x = \"Gene Expression\", y = \"Count\")\n\np1\n\n\n\n\n\n\n\n\nSupplement the base code with important parameters that can be extended and provide the corresponding plotting code.\n\n\n\n\n\n\nTip\n\n\n\nKey Parameters: binwidth / bins\nThe binwidth or bins parameter determines how much data each bin will contain. Modifying these values can significantly affect the appearance of the histogram and the information conveyed.\n\n\n\n# Code example (with supplementary parameter `bins`)-----\n#| label: fig-bins\n#| fig-cap: \"Key Parameters: `binwidth` / `bins`\"\n#| fig.width: 8\n#| fig.heright: 2\n#| out.width: \"95%\"\n#| warning: false\n\np2_1 &lt;- ggplot(data1, aes(x = expression)) +\n  geom_histogram(bins = 30, fill = \"skyblue\", color = \"white\") +\n  ggtitle(\"Bins = 30\") + \n  labs(x = \"Gene Expression\", y = \"Count\")\n\np2_2 &lt;- ggplot(data1, aes(x = expression)) +\n  geom_histogram(bins = 50, fill = \"skyblue\", color = \"white\") +\n  ggtitle(\"Bins = 50\") + \n  labs(x = \"Gene Expression\", y = \"Count\")\n\ncowplot::plot_grid(p2_1, p2_2)\n\n\n\n\n\n\n\n\n\n\n2. More Advanced Plots (e.g.Histogram with Density Curve)\nIntroduces complex types of visualization, such as using functions that contain more custom parameters, using multiple base chart overlays, adding statistical tests, and more.\ne.g.Â The density curve provides a smooth representation of the data distribution. Unlike the histogram, which depends on the number of bins, the density curve uses kernel density estimation (KDE) to smooth the distribution. This allows a clearer understanding of the overall trend and shape of the data.\n\n# Advanced Drawing Code Example-----\n#| label: fig-DensityCurve\n#| fig-cap: \"Histogram with Density Curve\"\n#| out.width: \"95%\"\n#| warning: false\n\np1 &lt;- ggplot(data1, aes(x = expression)) +\n  geom_histogram(aes(y = after_stat(density)), bins = 30, fill = \"skyblue\", color = \"white\") +\n  geom_density(alpha = 0.2, fill = \"#FF6666\") + \n  labs(x = \"Gene Expression\", y = \"Density\")\n\np1\n\n\n\n\n\n\n\n\nOptionally you can add a detailed description of the parameters using callout-tip if you need it."
  },
  {
    "objectID": "Template/visualization_guidance_EN.html#applications",
    "href": "Template/visualization_guidance_EN.html#applications",
    "title": "Contribution_guidance",
    "section": "Applications",
    "text": "Applications\nDemonstrate the practical application of visualization charts in the biomedical literature, with the option to show basic/advanced charts separately if they are widely used in various types of biomedical literature.\ne.g.\n\n1. Applications of Basic Histogram\n\n\n\n\n\n\nFigureÂ 1: Applications of Basic Histogram\n\n\n\nFigure 9 shows the differences between the relative frequencies of human X and human Y chromosomeâ€™s histograms for n = 6. [1]\nAdditional image figure notes and source documentation information are required. A code reproduction of the figure may be added at the authorâ€™s discretion."
  },
  {
    "objectID": "Template/visualization_guidance_EN.html#reference",
    "href": "Template/visualization_guidance_EN.html#reference",
    "title": "Contribution_guidance",
    "section": "Reference",
    "text": "Reference\ne.g.Â 1. Costa, A. M., Machado, J. T., & Quelhas, M. D. (2011). Histogram-based DNA analysis for the visualization of chromosome, genome, and species information. Bioinformatics, 27(9), 1207â€“1214. https://doi.org/10.1093/bioinformatics/btr131"
  },
  {
    "objectID": "Template/visualization_guidance_EN.html#contributors",
    "href": "Template/visualization_guidance_EN.html#contributors",
    "title": "Contribution_guidance",
    "section": "Contributors",
    "text": "Contributors\n\nEditor: Yours name.\nReviewers: Reviewers name."
  }
]